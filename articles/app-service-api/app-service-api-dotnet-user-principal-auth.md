---
title: "aaaUser uwierzytelniania dla aplikacji interfejsu API w usłudze Azure App Service | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak tooprotect aplikację interfejsu API w usłudze Azure App Service, umożliwiając dostęp tooauthenticated tylko użytkowników."
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="f3e72-103">Uwierzytelnianie użytkownika dla aplikacji interfejsu API w usłudze Azure App Service</span><span class="sxs-lookup"><span data-stu-id="f3e72-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="f3e72-104">Omówienie</span><span class="sxs-lookup"><span data-stu-id="f3e72-104">Overview</span></span>
<span data-ttu-id="f3e72-105">W tym artykule opisano, jak tooprotect aplikacji interfejsu API platformy Azure, tak że tylko użytkownicy uwierzytelnieni można wywołać ją.</span><span class="sxs-lookup"><span data-stu-id="f3e72-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="f3e72-106">Witaj artykule przyjęto założenie, że znasz hello [omówienie uwierzytelniania w usłudze Azure App Service](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="f3e72-107">Dowiesz się:</span><span class="sxs-lookup"><span data-stu-id="f3e72-107">You'll learn:</span></span>

* <span data-ttu-id="f3e72-108">Jak tooconfigure dostawcę uwierzytelniania przy użyciu szczegółów dla usługi Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="f3e72-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="f3e72-109">Jak hello tooconsume chronionej aplikacji interfejsu API za pomocą [Active Directory Authentication Library (ADAL) dla języka JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="f3e72-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="f3e72-110">Witaj artykuł zawiera dwie sekcje:</span><span class="sxs-lookup"><span data-stu-id="f3e72-110">hello article contains two sections:</span></span>

* <span data-ttu-id="f3e72-111">Witaj [jak tooconfigure uwierzytelniania użytkowników w usłudze Azure App Service](#authconfig) sekcji opisano w sposób ogólny tooconfigure uwierzytelniania użytkowników w dowolnej aplikacji interfejsu API i stosuje jednakowo tooall platform obsługiwanych przez usługę App Service, w tym .NET, Node.js i Java.</span><span class="sxs-lookup"><span data-stu-id="f3e72-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="f3e72-112">Począwszy od hello [kontynuowanie samouczków aplikacji interfejsu API programu .NET hello](#tutorialstart) sekcji, hello przewodniki artykułu użytkownika przez proces konfigurowania przykładowej aplikacji przy użyciu .NET wstecz zakończenia i frontonu AngularJS, korzystającą z usługi Azure Active Directory dla użytkownika uwierzytelnianie.</span><span class="sxs-lookup"><span data-stu-id="f3e72-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="f3e72-113"><a id="authconfig"></a>Jak tooconfigure uwierzytelniania użytkowników w usłudze Azure App Service</span><span class="sxs-lookup"><span data-stu-id="f3e72-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="f3e72-114">Ta sekcja zawiera ogólne instrukcje dotyczące tooany aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="f3e72-115">Dla tooDo toohello określonych czynności .NET listy przykładowej aplikacji, przejdź zbyt[kontynuowanie samouczki dotyczące rozpoczynania pracy .NET hello](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="f3e72-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="f3e72-116">W hello [portalu Azure](https://portal.azure.com/), przejdź toohello **ustawienia** bloku aplikacji hello interfejsu API, które mają tooprotect, Znajdź hello **funkcje** sekcji, a następnie kliknij przycisk  **Uwierzytelnianie / autoryzacja**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Portal Azure uwierzytelniania/autoryzacji](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="f3e72-118">W hello **uwierzytelniania / autoryzacji** bloku, kliknij przycisk **na**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="f3e72-119">Wybierz jedną z opcji hello z hello **tootake akcji w przypadku nieuwierzytelnionego żądania** listy rozwijanej.</span><span class="sxs-lookup"><span data-stu-id="f3e72-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="f3e72-120">Jeśli chcesz tylko tooreach uwierzytelnionego połączenia aplikacji interfejsu API, wybierz jedną z hello **Zaloguj się przy użyciu...**  opcje.</span><span class="sxs-lookup"><span data-stu-id="f3e72-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="f3e72-121">Ta opcja umożliwia tooprotect hello interfejsu API aplikacji bez pisania żadnego kodu działającą w nim.</span><span class="sxs-lookup"><span data-stu-id="f3e72-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="f3e72-122">Wszystkie wywołania tooreach aplikacji interfejsu API, wybierz opcję **Zezwalaj na żądanie (żadnej akcji)**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="f3e72-123">Możesz użyć tej opcji toodirect nieuwierzytelniony wywołań tooa wybór dostawców uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="f3e72-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="f3e72-124">Po wybraniu tej opcji należy toowrite kodu toohandle autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="f3e72-125">Aby uzyskać więcej informacji, zobacz [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options) (Uwierzytelnianie i autoryzacja aplikacji interfejsu API w usłudze Azure App Service).</span><span class="sxs-lookup"><span data-stu-id="f3e72-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="f3e72-126">Wybierz co najmniej jeden hello **dostawców uwierzytelniania**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="f3e72-127">Obraz powitania zawiera opcje, które wymagają wszystkich toobe wywołań uwierzytelniony przez usługę Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Blok uwierzytelniania/autoryzacji portalu Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="f3e72-129">Po wybraniu dostawcy uwierzytelniania hello portal Wyświetla blok konfiguracji dla tego dostawcy.</span><span class="sxs-lookup"><span data-stu-id="f3e72-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="f3e72-130">Aby uzyskać szczegółowe instrukcje, które opisują sposób tooconfigure hello bloków konfiguracji dostawcy uwierzytelniania, zobacz [jak tooconfigure Logowanie usługi Azure Active Directory toouse aplikacji usługi App Service](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="f3e72-131">(łącze hello prowadzi tooan artykuł na temat usługi Azure AD, ale samym artykule hello zawiera karty, które łącze tooarticles dla hello innych dostawców uwierzytelniania).</span><span class="sxs-lookup"><span data-stu-id="f3e72-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="f3e72-132">Po zakończeniu korzystania z bloku konfiguracji dostawcy uwierzytelniania hello, kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="f3e72-133">W hello **uwierzytelniania / autoryzacji** bloku, kliknij przycisk **zapisać**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="f3e72-134">Po zakończeniu usługi aplikacji uwierzytelnia wszystkie wywołania interfejsu API przed dotarciem hello aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="f3e72-135">działają usługi uwierzytelniania Hello hello takie same dla wszystkich języków, które obsługuje usługi aplikacji, w tym .NET, Node.js i Java.</span><span class="sxs-lookup"><span data-stu-id="f3e72-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="f3e72-136">toomake uwierzytelnione wywołania interfejsu API, wywołujący hello zawiera token elementu nośnego OAuth 2.0 dostawcy uwierzytelniania hello w nagłówku autoryzacji hello żądań HTTP.</span><span class="sxs-lookup"><span data-stu-id="f3e72-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="f3e72-137">Hello token można uzyskać przy użyciu dostawcy uwierzytelniania hello zestawu SDK.</span><span class="sxs-lookup"><span data-stu-id="f3e72-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="f3e72-138"><a id="tutorialstart"></a>Kontynuowanie hello samouczków aplikacji interfejsu API programu .NET</span><span class="sxs-lookup"><span data-stu-id="f3e72-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="f3e72-139">Jeśli wykonujesz hello Node.js lub Java samouczków dotyczących aplikacji interfejsu API, Pomiń toohello kolejnym artykule [uwierzytelnianie główną usługi dla aplikacji interfejsu API](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="f3e72-140">Jeśli po hello serii samouczek platformy .NET dla aplikacji interfejsu API i został już wdrożony na powitania przykładowej aplikacji, zgodnie ze wskazówkami zawartymi w hello [pierwszy](app-service-api-dotnet-get-started.md) i [drugi](app-service-api-cors-consume-javascript.md) samouczki, Pomiń toohello [— Konfiguracja Uwierzytelnianie w aplikacji usługi i Azure AD](#azureauth) sekcji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="f3e72-141">Jeśli chcesz toofollow w tym samouczku bez pośrednictwa hello pierwszego i drugiego samouczki, hello następujące kroki, które opisano sposób uruchamiania tooget przy użyciu zautomatyzowanego procesu toodeploy hello przykładowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="f3e72-142">Witaj następujące kroki ułatwiające rozpoczęcie toohello uruchomienie tego samego punktu tak, jakby hello dwóch pierwszych samouczków, z jednym wyjątkiem: Visual Studio nie będzie już wiesz, które aplikacji sieci web lub aplikacji interfejsu API, który pobiera wdrożony każdego projektu.</span><span class="sxs-lookup"><span data-stu-id="f3e72-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="f3e72-143">Oznacza to, nie będziesz mieć dokładne instrukcje w tym samouczku, które opisują sposób toodeploy toohello prawo celów.</span><span class="sxs-lookup"><span data-stu-id="f3e72-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="f3e72-144">Jeśli nie masz doświadczenia z ustaleniem, jak kroki wdrożenia hello toodo samodzielnie, jest lepsze toofollow hello samouczek serii z hello [pierwszy samouczek](app-service-api-dotnet-get-started.md) niż toostart z tym zautomatyzowanego procesu wdrażania.</span><span class="sxs-lookup"><span data-stu-id="f3e72-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="f3e72-145">Upewnij się, że wszystkie wymagania wstępne hello na liście hello [pierwszy samouczek](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="f3e72-146">W przypadku dodawania toohello wymagania wstępne wymienione te samouczki uwierzytelniania założono, że mający doświadczenie z usługi aplikacji — aplikacje sieci web i aplikacji API apps w programie Visual Studio i hello portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="f3e72-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="f3e72-147">Kliknij hello **wdrażanie tooAzure** przycisku na powitania [plik readme repozytorium przykładowej listy tooDo](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello interfejsu API apps i hello sieci web aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="f3e72-148">Zanotuj hello grupy zasobów platformy Azure, który jest tworzony w trakcie używania tego nowsze toolook aplikacji sieci web i nazwy aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="f3e72-149">Pobieranie lub hello w klonowania [repozytorium przykładowej listy tooDo](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello kodu, który lokalnie będzie działać z programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f3e72-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="f3e72-150"><a id="azureauth"></a>Konfigurowanie uwierzytelniania w aplikacji usługi i usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="f3e72-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="f3e72-151">Masz teraz hello aplikacji uruchomionych w usłudze Azure App Service bez wymaga uwierzytelnienia użytkowników.</span><span class="sxs-lookup"><span data-stu-id="f3e72-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="f3e72-152">W tej sekcji możesz dodać uwierzytelniania, wykonując hello następujące zadania:</span><span class="sxs-lookup"><span data-stu-id="f3e72-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="f3e72-153">Skonfiguruj uwierzytelnianie usługi Azure Active Directory (Azure AD) toorequire usługi aplikacji — dla aplikacji interfejsu API warstwy środkowej hello podczas wywoływania.</span><span class="sxs-lookup"><span data-stu-id="f3e72-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="f3e72-154">Tworzenie aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="f3e72-155">Po frontonu logowania toohello AngularJS, należy skonfigurować tokenu elementu nośnego hello toosend aplikacji hello Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="f3e72-156">Jeśli wystąpiły problemy podczas hello samouczek zalecenia, zobacz hello [Rozwiązywanie problemów](#troubleshooting) sekcji na końcu hello hello samouczka.</span><span class="sxs-lookup"><span data-stu-id="f3e72-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="f3e72-157">Konfigurowanie uwierzytelniania dla aplikacji interfejsu API warstwy środkowej hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="f3e72-158">W hello [portalu Azure](https://portal.azure.com/), przejdź toohello **ustawienia** bloku aplikacji hello interfejsu API, który został utworzony dla projektu ToDoListAPI hello, Znajdź hello **funkcje** sekcji, a następnie Kliknij przycisk **uwierzytelniania / autoryzacji**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Portal Azure uwierzytelniania/autoryzacji](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="f3e72-160">W hello **uwierzytelniania / autoryzacji** bloku, kliknij przycisk **na**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="f3e72-161">W hello **tootake akcji w przypadku nieuwierzytelnionego żądania** listy rozwijanej wybierz **Zaloguj się za pomocą usługi Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="f3e72-162">Ta opcja zapewnia, że żadne żądania unauathenticated osiągną hello aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="f3e72-163">W obszarze **dostawców uwierzytelniania**, kliknij przycisk **usługi Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Blok uwierzytelniania/autoryzacji portalu Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="f3e72-165">W hello **ustawień usługi Azure Active Directory** bloku, kliknij przycisk **Express**</span><span class="sxs-lookup"><span data-stu-id="f3e72-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Opcja uwierzytelniania/autoryzacji Express portalu Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="f3e72-167">Z hello **Express** opcji usługi aplikacji może automatycznie tworzyć aplikację usługi Azure AD w usługi Azure AD [dzierżawy](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="f3e72-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="f3e72-168">Nie masz toocreate dzierżawy, ponieważ jeden ma automatycznie co konto platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="f3e72-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="f3e72-169">W obszarze **tryb zarządzania**, kliknij przycisk **Utwórz nową aplikację usługi AD** , jeśli nie została jeszcze wybrana i zwróć uwagę, wartość hello hello **tworzenie aplikacji** pole tekstowe; będzie wyszukiwanie tej usługi AAD Aplikacja w hello klasycznego portalu Azure później.</span><span class="sxs-lookup"><span data-stu-id="f3e72-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Ustawienia portalu Azure usługi Azure AD](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="f3e72-171">Azure automatycznie utworzy aplikację usługi Azure AD o nazwie wskazanych hello w dzierżawie usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="f3e72-172">Domyślnie program hello aplikacji usługi Azure AD o nazwie hello takie same jak aplikacja hello interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="f3e72-173">Jeśli wolisz, możesz wprowadzić inną nazwę.</span><span class="sxs-lookup"><span data-stu-id="f3e72-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="f3e72-174">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-174">Click **OK**.</span></span>
8. <span data-ttu-id="f3e72-175">W hello **uwierzytelniania / autoryzacji** bloku, kliknij przycisk **zapisać**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Klikanie pozycji Zapisz.](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="f3e72-177">Obecnie tylko użytkownicy w Twojej dzierżawie usługi Azure AD mogą wywoływać hello aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="f3e72-178">Opcjonalnie: Testowanie aplikacji hello interfejsu API</span><span class="sxs-lookup"><span data-stu-id="f3e72-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="f3e72-179">W przeglądarce Przejdź toohello adres URL aplikacji hello interfejsu API: w hello **aplikacji interfejsu API** bloku w hello portalu Azure, kliknij łącze hello w obszarze **adres URL**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="f3e72-180">Jesteś ekran logowania przekierowanego tooa ponieważ nieuwierzytelnione żądania nie są dozwolone w aplikacji interfejsu API hello tooreach.</span><span class="sxs-lookup"><span data-stu-id="f3e72-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="f3e72-181">Jeśli przeglądarka przejdzie do strony toohello "Pomyślnie utworzono", mogą już zarejestrowane przeglądarki hello — w takim przypadku otwórz sesję InPrivate lub Incognito okno i przejdź do adresu URL aplikacji toohello interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="f3e72-182">Zaloguj się przy użyciu poświadczeń dla użytkownika w dzierżawie usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="f3e72-183">Gdy użytkownik jest zalogowany, hello "Pomyślnie utworzono" strona zostanie wyświetlona w przeglądarce hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="f3e72-184">Zamknij hello przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f3e72-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="f3e72-185">Konfigurowanie aplikacji hello Azure AD</span><span class="sxs-lookup"><span data-stu-id="f3e72-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="f3e72-186">Podczas konfigurowania uwierzytelniania usługi Azure AD usługi aplikacji tworzona aplikacja usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="f3e72-187">Domyślnie aplikacja hello nowej usługi Azure AD został adres URL skonfigurowany tooprovide hello elementu nośnego toohello tokenu aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="f3e72-188">W tej sekcji skonfigurujesz hello Azure AD aplikacji tooprovide hello elementu nośnego tokenu toohello AngularJS frontonu zamiast bezpośrednio aplikacji interfejsu API warstwy środkowej toohello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="f3e72-189">Witaj AngularJS frontonu wyśle hello toohello token interfejsu API aplikacji, gdy wywołuje aplikację interfejsu API hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="f3e72-190">proces hello tookeep tak proste, jak to możliwe, w tym samouczku używana jednej usługi Azure AD aplikacji hello frontonu i hello aplikacji interfejsu API warstwy środkowej.</span><span class="sxs-lookup"><span data-stu-id="f3e72-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="f3e72-191">Innym rozwiązaniem jest toouse dwóch aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="f3e72-192">W takim przypadku trzeba toogive hello frontonu dla usługi Azure AD aplikacji uprawnienia toocall hello warstwy środkowej przez aplikację usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="f3e72-193">Takie podejście wieloma aplikacjami pozwoli uzyskać większą kontrolę nad warstwy tooeach uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="f3e72-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="f3e72-194">W hello [klasycznego portalu Azure](https://manage.windowsazure.com/), przejdź do zbyt**usługi Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="f3e72-195">Masz toouse hello klasycznego portalu, ponieważ niektóre ustawienia usługi Azure Active Directory, które należy uzyskać dostęp nie jest jeszcze dostępna w bieżącym portalu Azure hello tooare.</span><span class="sxs-lookup"><span data-stu-id="f3e72-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="f3e72-196">Na powitania **katalogu** kliknij dzierżawę usługi AAD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![Azure AD w klasycznym portalu](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="f3e72-198">Kliknij przycisk **aplikacji > aplikacje Moja firma jest właścicielem**, a następnie kliknij znacznik wyboru hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="f3e72-199">Można również zainstalować toorefresh hello strony toosee hello nowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="f3e72-200">Liście hello aplikacji kliknij nazwę hello hello, który Azure utworzony po włączeniu uwierzytelniania dla aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Karta aplikacje AD platformy Azure](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="f3e72-202">Kliknij pozycję **Konfiguruj**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-202">Click **Configure**.</span></span>
   
   ![Karta Konfigurowanie AD platformy Azure](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="f3e72-204">Ustaw **adres URL logowania** toohello adres URL aplikacji sieci web AngularJS, nie ma ukośników.</span><span class="sxs-lookup"><span data-stu-id="f3e72-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="f3e72-205">Na przykład: https://todolistangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="f3e72-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![Adres URL logowania](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="f3e72-207">Ustaw **adres URL odpowiedzi** toohello adres URL aplikacji sieci web, nie ma ukośników.</span><span class="sxs-lookup"><span data-stu-id="f3e72-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="f3e72-208">Na przykład: https://todolistsangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="f3e72-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="f3e72-209">Kliknij pozycję **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-209">Click **Save**.</span></span>
   
   ![Adres URL odpowiedzi](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="f3e72-211">U dołu hello hello strony, kliknij przycisk **manifest Zarządzaj > Pobierz manifest**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Pobierz manifest](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="f3e72-213">Pobierz tooa lokalizację pliku hello, gdzie można go edytować.</span><span class="sxs-lookup"><span data-stu-id="f3e72-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="f3e72-214">W pliku manifestu hello pobrane, wyszukaj hello `oauth2AllowImplicitFlow` właściwości.</span><span class="sxs-lookup"><span data-stu-id="f3e72-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="f3e72-215">Zmień wartość hello tej właściwości z `false` zbyt`true`, a następnie zapisz plik hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="f3e72-216">To ustawienie jest wymagane do uzyskania dostępu z poziomu aplikacji jednostronicowej JavaScript.</span><span class="sxs-lookup"><span data-stu-id="f3e72-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="f3e72-217">Umożliwia on hello Oauth 2.0 elementu nośnego tokenu toobe zwracane w hello fragmentu adresu URL.</span><span class="sxs-lookup"><span data-stu-id="f3e72-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="f3e72-218">Kliknij przycisk **manifest Zarządzaj > manifest przekazywania**oraz przekazywanie hello zaktualizowane w hello poprzedzających krok.</span><span class="sxs-lookup"><span data-stu-id="f3e72-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Przekaż manifestu](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="f3e72-220">Kopiuj hello **identyfikator klienta** wartość i zapisz go w innym miejscu możesz pobrać go z później.</span><span class="sxs-lookup"><span data-stu-id="f3e72-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="f3e72-221">Skonfiguruj uwierzytelnianie toouse projektu ToDoListAngular hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="f3e72-222">W tej sekcji możesz zmienić hello AngularJS frontonu tak, aby korzystała Active Directory Authentication Library (ADAL) dla tooacquire JS tokenu elementu nośnego hello zalogowanego użytkownika z usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="f3e72-223">Kod Hello włączy hello token żądania HTTP wysyłane toohello warstwy środkowej, pokazane na powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="f3e72-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Diagram uwierzytelniania użytkownika](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="f3e72-225">Należy powitania po toofiles zmiany w hello projektu ToDoListAngular.</span><span class="sxs-lookup"><span data-stu-id="f3e72-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="f3e72-226">Otwórz hello *index.cshtml* pliku.</span><span class="sxs-lookup"><span data-stu-id="f3e72-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="f3e72-227">Usuń znaczniki komentarza hello wierszy, które odwołują się hello Active Directory Authentication Library (ADAL) dla skryptów Javascript.</span><span class="sxs-lookup"><span data-stu-id="f3e72-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="f3e72-228">Otwórz hello *app/scripts/app.js* pliku.</span><span class="sxs-lookup"><span data-stu-id="f3e72-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="f3e72-229">Komentarz hello bloku kodu oznaczony jako przeznaczony do "bez uwierzytelniania" i Usuń komentarz hello bloku kodu oznaczone jako "uwierzytelniania z".</span><span class="sxs-lookup"><span data-stu-id="f3e72-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="f3e72-230">Ta zmiana odwołuje się do dostawcy uwierzytelniania ADAL JS hello i udostępnia tooit wartości konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="f3e72-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="f3e72-231">W hello następujące kroki, można ustawić wartości konfiguracji hello aplikacji interfejsu API i aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="f3e72-232">W kodzie hello, która ustawia hello `endpoints` hello zmiennej, Ustaw adres URL interfejsu API toohello adres URL aplikacji hello interfejsu API, który został utworzony dla projektu ToDoListAPI hello i ustawić hello Azure AD identyfikator toohello identyfikator klienta aplikacji skopiowany z hello klasycznego portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="f3e72-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="f3e72-233">Kod Hello jest teraz toohello podobnie poniższy przykład.</span><span class="sxs-lookup"><span data-stu-id="f3e72-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="f3e72-234">Hello zbyt wywołać`adalProvider.init`ustaw `tenant` tooyour nazwa dzierżawcy i `clientId` toosame wartość używana w poprzednim kroku hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="f3e72-235">Kod Hello jest teraz toohello podobnie poniższy przykład.</span><span class="sxs-lookup"><span data-stu-id="f3e72-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="f3e72-236">Te zmiany zbyt`app.js` zdecydować, że kod wywołujący hello i hello wywołuje interfejs API w aplikacji hello tej samej usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="f3e72-237">Otwórz hello *app/scripts/homeCtrl.js* pliku.</span><span class="sxs-lookup"><span data-stu-id="f3e72-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="f3e72-238">Komentarz hello bloku kodu oznaczony jako przeznaczony do "bez uwierzytelniania" i Usuń komentarz hello bloku kodu oznaczone jako "uwierzytelniania z".</span><span class="sxs-lookup"><span data-stu-id="f3e72-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="f3e72-239">Otwórz hello *app/scripts/indexCtrl.js* pliku.</span><span class="sxs-lookup"><span data-stu-id="f3e72-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="f3e72-240">Komentarz hello bloku kodu oznaczony jako przeznaczony do "bez uwierzytelniania" i Usuń komentarz hello bloku kodu oznaczone jako "uwierzytelniania z".</span><span class="sxs-lookup"><span data-stu-id="f3e72-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="f3e72-241">Wdrażanie tooAzure projektu ToDoListAngular hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="f3e72-242">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt ToDoListAngular hello, a następnie kliknij przycisk **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="f3e72-243">Kliknij przycisk **Opublikuj**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="f3e72-244">Visual Studio wdroży projekt hello i otwiera podstawowy adres URL przeglądarki toohello aplikacji sieci web.</span><span class="sxs-lookup"><span data-stu-id="f3e72-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="f3e72-245">Wyświetli stronę błędu 403, co jest zrozumiałe dla próba toogo tooa interfejsu API sieci Web podstawowego adresu URL w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="f3e72-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="f3e72-246">Nadal masz toomake warstwy środkowej toohello aplikacji interfejsu API zmiany przed można przetestować aplikację hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="f3e72-247">Zamknij hello przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f3e72-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="f3e72-248">Skonfiguruj uwierzytelnianie toouse projektu ToDoListAPI hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="f3e72-249">Obecnie hello wysyła projektu ToDoListAPI "*" jako hello `owner` tooToDoListDataAPI wartość.</span><span class="sxs-lookup"><span data-stu-id="f3e72-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="f3e72-250">W tej sekcji możesz zmienić identyfikator hello toosend kodu hello hello zalogowanego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="f3e72-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="f3e72-251">Wprowadź następujące zmiany w projekcie ToDoListAPI hello hello.</span><span class="sxs-lookup"><span data-stu-id="f3e72-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="f3e72-252">Otwórz hello *Controllers/ToDoListController.cs* pliku, a następnie usuń komentarz linii hello w każdej metody akcji, która ustawia `owner` toohello usługi Azure AD `NameIdentifier` wartości oświadczenia.</span><span class="sxs-lookup"><span data-stu-id="f3e72-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="f3e72-253">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="f3e72-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="f3e72-254">**Ważne**: nie Usuń komentarz kodu w hello `ToDoListDataAPI` metody, należy to zrobić później hello usługi uwierzytelniania główna samouczek.</span><span class="sxs-lookup"><span data-stu-id="f3e72-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="f3e72-255">Wdrażanie tooAzure projektu ToDoListAPI hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="f3e72-256">W **Eksploratora rozwiązań**, kliknij prawym przyciskiem myszy projekt ToDoListAPI hello, a następnie kliknij przycisk **publikowania**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="f3e72-257">Kliknij przycisk **Opublikuj**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="f3e72-258">Visual Studio wdroży projekt hello i otwiera podstawowy adres URL przeglądarki toohello aplikacji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="f3e72-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="f3e72-259">Zamknij hello przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="f3e72-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="f3e72-260">Testowanie aplikacji hello</span><span class="sxs-lookup"><span data-stu-id="f3e72-260">Test hello application</span></span>
1. <span data-ttu-id="f3e72-261">Przejdź do adresu URL toohello hello aplikacji sieci web, **przy użyciu protokołu HTTPS, a nie HTTP**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="f3e72-262">Kliknij przycisk hello **tooDo listy** kartę.</span><span class="sxs-lookup"><span data-stu-id="f3e72-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="f3e72-263">Jesteś zostanie wyświetlony monit o toolog w.</span><span class="sxs-lookup"><span data-stu-id="f3e72-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="f3e72-264">Zaloguj się za pomocą hello poświadczeń użytkownika w dzierżawie usługi AAD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="f3e72-265">Witaj **tooDo listy** zostanie wyświetlona strona.</span><span class="sxs-lookup"><span data-stu-id="f3e72-265">hello **tooDo List** page appears.</span></span>
   
   ![Strona z listą tooDo](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="f3e72-267">Nie elementów do wykonania są wyświetlane, ponieważ do tej pory wszystkie zostały one dla właściciela "*".</span><span class="sxs-lookup"><span data-stu-id="f3e72-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="f3e72-268">Teraz warstwy środkowej hello żąda elementy hello zalogowanego użytkownika, a jeszcze nie zostały utworzone.</span><span class="sxs-lookup"><span data-stu-id="f3e72-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="f3e72-269">Dodaj nowy tooverify elementy zadań do wykonania aplikacja hello działa.</span><span class="sxs-lookup"><span data-stu-id="f3e72-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="f3e72-270">W innym oknie przeglądarki Przejdź toohello Swagger URL interfejsu użytkownika dla aplikacji interfejsu API ToDoListDataAPI hello i kliknij polecenie **ToDoList > Pobierz**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="f3e72-271">Wprowadź znak gwiazdki hello `owner` parametr, a następnie kliknij przycisk **wypróbować jej możliwości**.</span><span class="sxs-lookup"><span data-stu-id="f3e72-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="f3e72-272">odpowiedź Hello pokazuje, że hello nowych elementów do wykonania ma identyfikator użytkownika hello rzeczywiste usługi Azure AD w hello właściwości Owner.</span><span class="sxs-lookup"><span data-stu-id="f3e72-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![Identyfikator właściciela w formacie JSON odpowiedzi](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="f3e72-274">Kompilowanie projektów powitania od podstaw</span><span class="sxs-lookup"><span data-stu-id="f3e72-274">Building hello projects from scratch</span></span>
<span data-ttu-id="f3e72-275">Witaj dwa projekty interfejsu API sieci Web zostały utworzone przy użyciu hello **aplikacji interfejsu API Azure** szablonu i zastąpienie hello domyślne wartości kontroler z kontrolerem listy zadań projektu.</span><span class="sxs-lookup"><span data-stu-id="f3e72-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="f3e72-276">Aby uzyskać informacje na temat za tworzenie aplikacji jednostronicowej AngularJS ze zaplecze 2 interfejsu API sieci Web, zobacz [ręce w laboratorium: tworzenie jednej strony aplikacji JEDNOSTRONICOWEJ z interfejsu API sieci Web platformy ASP.NET i Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="f3e72-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="f3e72-277">Aby uzyskać informacje na temat tooadd kod uwierzytelniania usługi Azure AD, zobacz następujące zasoby hello:</span><span class="sxs-lookup"><span data-stu-id="f3e72-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="f3e72-278">[Zabezpieczanie AngularJS pojedynczej strony aplikacji za pomocą usługi Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="f3e72-279">Wprowadzenie v1 ADAL JS</span><span class="sxs-lookup"><span data-stu-id="f3e72-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="f3e72-280">Rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="f3e72-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="f3e72-281">Upewnij się, że użytkownik nie należy mylić (warstwy środkowej) ToDoListAPI i ToDoListDataAPI (warstwy danych).</span><span class="sxs-lookup"><span data-stu-id="f3e72-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="f3e72-282">Na przykład Sprawdź, czy dodani aplikacji interfejsu API warstwy środkowej toohello uwierzytelniania, nie hello warstwy danych.</span><span class="sxs-lookup"><span data-stu-id="f3e72-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="f3e72-283">Upewnij się, że adres URL aplikacji hello AngularJS źródła kodu odwołania hello warstwy środkowej API (ToDoListAPI, nie ToDoListDataAPI) i hello poprawne identyfikator klienta usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f3e72-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="f3e72-284">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="f3e72-284">Next steps</span></span>
<span data-ttu-id="f3e72-285">W tym samouczku przedstawiono sposób toouse uwierzytelniania usługi aplikacji — dla aplikacji interfejsu API i jak toocall hello aplikacji interfejsu API za pomocą hello bibliotekę ADAL JS.</span><span class="sxs-lookup"><span data-stu-id="f3e72-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="f3e72-286">W następnym samouczku hello dowiesz się, jak za[bezpiecznego dostępu do aplikacji tooyour interfejsu API dla scenariuszy service to service](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="f3e72-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

