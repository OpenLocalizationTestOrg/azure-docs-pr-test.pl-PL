---
title: "Omówienie monitorowania bramy aplikacji Azure kondycji | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat możliwości monitorowania bramy aplikacji Azure"
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7eeba328-bb2d-4d3e-bdac-7552e7900b7f
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2016
ms.author: gwallace
ms.openlocfilehash: 899115d213e626f17e58c2e5f01313f760f9e7f4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="application-gateway-health-monitoring-overview"></a><span data-ttu-id="3b8db-103">Omówienie monitorowania kondycji bramy aplikacji</span><span class="sxs-lookup"><span data-stu-id="3b8db-103">Application Gateway health monitoring overview</span></span>

<span data-ttu-id="3b8db-104">Azure Application Gateway domyślnie monitoruje kondycję wszystkich zasobów w jej puli zaplecza i automatycznie usuwa dowolnego zasobu z puli określana jako zła.</span><span class="sxs-lookup"><span data-stu-id="3b8db-104">Azure Application Gateway by default monitors the health of all resources in its back-end pool and automatically removes any resource considered unhealthy from the pool.</span></span> <span data-ttu-id="3b8db-105">Brama aplikacji w kontynuuje monitorowanie wystąpień złej kondycji i dodaje je do dobrej kondycji puli zaplecza, gdy staną się dostępne i odpowiadać na zdarzenie sondy kondycji.</span><span class="sxs-lookup"><span data-stu-id="3b8db-105">Application Gateway continues to monitor the unhealthy instances and adds them back to the healthy back-end pool once they become available and respond to health probes.</span></span> <span data-ttu-id="3b8db-106">Brama aplikacji w wysyła sondy kondycji z tego samego portu, który jest zdefiniowany w ustawieniach protokołu HTTP zaplecza.</span><span class="sxs-lookup"><span data-stu-id="3b8db-106">Application gateway sends the health probes with the same port that is defined in the back-end HTTP settings.</span></span> <span data-ttu-id="3b8db-107">Taka konfiguracja powoduje, że sondy testuje tego samego portu, którego klienci będą stosowane do nawiązania połączenia z zapleczem.</span><span class="sxs-lookup"><span data-stu-id="3b8db-107">This configuration ensures that the probe is testing the same port that customers would be using to connect to the backend.</span></span>

![przykład sondowania bramy aplikacji][1]

<span data-ttu-id="3b8db-109">Oprócz przy użyciu sondy kondycji domyślnej funkcji monitorowania, można również dostosować sondy kondycji do własnych wymagań aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3b8db-109">In addition to using default health probe monitoring, you can also customize the health probe to suit your application's requirements.</span></span> <span data-ttu-id="3b8db-110">W tym artykule omówiono domyślnych i sondy kondycji niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="3b8db-110">In this article, both default and custom health probes are covered.</span></span>

> [!NOTE]
> <span data-ttu-id="3b8db-111">Jeśli istnieje grupa NSG podsieci bramy aplikacji, zakresy portów 65503 65534 powinien zostać otwarty w podsieci bramy aplikacji dla ruchu przychodzącego.</span><span class="sxs-lookup"><span data-stu-id="3b8db-111">If there is an NSG on Application Gateway subnet, port ranges 65503-65534 should be opened on the Application Gateway subnet for Inbound traffic.</span></span> <span data-ttu-id="3b8db-112">Te porty są wymagane dla kondycji zaplecza interfejsu API do pracy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-112">These ports are required for the backend health API to work.</span></span>

## <a name="default-health-probe"></a><span data-ttu-id="3b8db-113">Domyślnej funkcji badania kondycji</span><span class="sxs-lookup"><span data-stu-id="3b8db-113">Default health probe</span></span>

<span data-ttu-id="3b8db-114">Bramy aplikacji automatycznie konfiguruje domyślnego badania kondycji, konfigurując nie żadnej konfiguracji niestandardowej sondowania.</span><span class="sxs-lookup"><span data-stu-id="3b8db-114">An application gateway automatically configures a default health probe when you don't set up any custom probe configuration.</span></span> <span data-ttu-id="3b8db-115">Zachowanie monitorowania polega na wysłał żądanie HTTP do adresów IP skonfigurowanych dla puli zaplecza.</span><span class="sxs-lookup"><span data-stu-id="3b8db-115">The monitoring behavior works by making an HTTP request to the IP addresses configured for the back-end pool.</span></span> <span data-ttu-id="3b8db-116">Dla domyślnej sondy Jeśli ustawienia http zaplecza są skonfigurowane dla protokołu HTTPS, sondy używa protokołu HTTPS również do testowania kondycji zapleczy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-116">For default probes if the backend http settings are configured for HTTPS, the probe uses HTTPS as well to test health of the backends.</span></span>

<span data-ttu-id="3b8db-117">Na przykład: Konfigurowanie bramy aplikacji do korzystania z serwerów zaplecza, A, B i C do odbierania ruchu sieciowego HTTP na porcie 80.</span><span class="sxs-lookup"><span data-stu-id="3b8db-117">For example: You configure your application gateway to use back-end servers A, B, and C to receive HTTP network traffic on port 80.</span></span> <span data-ttu-id="3b8db-118">Monitorowanie kondycji domyślne testy trzy serwery co 30 sekund na dobrej kondycji odpowiedź HTTP.</span><span class="sxs-lookup"><span data-stu-id="3b8db-118">The default health monitoring tests the three servers every 30 seconds for a healthy HTTP response.</span></span> <span data-ttu-id="3b8db-119">Dobrej odpowiedzi HTTP ma [kod stanu](https://msdn.microsoft.com/library/aa287675.aspx) między 200 i 399.</span><span class="sxs-lookup"><span data-stu-id="3b8db-119">A healthy HTTP response has a [status code](https://msdn.microsoft.com/library/aa287675.aspx) between 200 and 399.</span></span>

<span data-ttu-id="3b8db-120">Jeśli serwer A domyślnym sprawdzaniem sondy nie powiedzie się, bramę aplikacji spowoduje usunięcie jej z puli zaplecza, a ruch sieciowy przestanie przepływać do tego serwera.</span><span class="sxs-lookup"><span data-stu-id="3b8db-120">If the default probe check fails for server A, the application gateway removes it from its back-end pool, and network traffic stops flowing to this server.</span></span> <span data-ttu-id="3b8db-121">Domyślnego badania nadal w dalszym ciągu Sprawdź, czy serwer co 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="3b8db-121">The default probe still continues to check for server A every 30 seconds.</span></span> <span data-ttu-id="3b8db-122">Gdy serwer A pomyślnie odpowiada na żądanie jednego z domyślnego badania kondycji, dodaniu wstecz dobrej kondycji do puli zaplecza i ruchu uruchamia ponownie przepływać do serwera.</span><span class="sxs-lookup"><span data-stu-id="3b8db-122">When server A responds successfully to one request from a default health probe, it is added back as healthy to the back-end pool, and traffic starts flowing to the server again.</span></span>

### <a name="default-health-probe-settings"></a><span data-ttu-id="3b8db-123">Domyślne ustawienia sondy kondycji</span><span class="sxs-lookup"><span data-stu-id="3b8db-123">Default health probe settings</span></span>

| <span data-ttu-id="3b8db-124">Właściwość sondy</span><span class="sxs-lookup"><span data-stu-id="3b8db-124">Probe property</span></span> | <span data-ttu-id="3b8db-125">Wartość</span><span class="sxs-lookup"><span data-stu-id="3b8db-125">Value</span></span> | <span data-ttu-id="3b8db-126">Opis</span><span class="sxs-lookup"><span data-stu-id="3b8db-126">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3b8db-127">Sonda adresu URL</span><span class="sxs-lookup"><span data-stu-id="3b8db-127">Probe URL</span></span> |<span data-ttu-id="3b8db-128">http://127.0.0.1:\<portu\>/</span><span class="sxs-lookup"><span data-stu-id="3b8db-128">http://127.0.0.1:\<port\>/</span></span> |<span data-ttu-id="3b8db-129">Ścieżka adresu URL</span><span class="sxs-lookup"><span data-stu-id="3b8db-129">URL path</span></span> |
| <span data-ttu-id="3b8db-130">Interwał</span><span class="sxs-lookup"><span data-stu-id="3b8db-130">Interval</span></span> |<span data-ttu-id="3b8db-131">30</span><span class="sxs-lookup"><span data-stu-id="3b8db-131">30</span></span> |<span data-ttu-id="3b8db-132">Interwał sondowania w sekundach</span><span class="sxs-lookup"><span data-stu-id="3b8db-132">Probe interval in seconds</span></span> |
| <span data-ttu-id="3b8db-133">Limit czasu</span><span class="sxs-lookup"><span data-stu-id="3b8db-133">Time-out</span></span> |<span data-ttu-id="3b8db-134">30</span><span class="sxs-lookup"><span data-stu-id="3b8db-134">30</span></span> |<span data-ttu-id="3b8db-135">Sonda limitu czasu w sekundach</span><span class="sxs-lookup"><span data-stu-id="3b8db-135">Probe time-out in seconds</span></span> |
| <span data-ttu-id="3b8db-136">Próg złej kondycji</span><span class="sxs-lookup"><span data-stu-id="3b8db-136">Unhealthy threshold</span></span> |<span data-ttu-id="3b8db-137">3</span><span class="sxs-lookup"><span data-stu-id="3b8db-137">3</span></span> |<span data-ttu-id="3b8db-138">Badania liczby ponownych prób.</span><span class="sxs-lookup"><span data-stu-id="3b8db-138">Probe retry count.</span></span> <span data-ttu-id="3b8db-139">Po kolejnych sondowania liczby awarii osiągnie próg złej kondycji serwera zaplecza jest oznaczony jako w dół.</span><span class="sxs-lookup"><span data-stu-id="3b8db-139">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!NOTE]
> <span data-ttu-id="3b8db-140">Port jest tym samym porcie ustawienia HTTP zaplecza.</span><span class="sxs-lookup"><span data-stu-id="3b8db-140">The port is the same port as the back-end HTTP settings.</span></span>

<span data-ttu-id="3b8db-141">Domyślnego badania sprawdza tylko http://127.0.0.1:\<portu\> do określenia stanu kondycji.</span><span class="sxs-lookup"><span data-stu-id="3b8db-141">The default probe looks only at http://127.0.0.1:\<port\> to determine health status.</span></span> <span data-ttu-id="3b8db-142">Jeśli trzeba skonfigurować sondy kondycji, aby przejść do niestandardowy adres URL lub zmodyfikuj inne ustawienia, należy użyć niestandardowego sond zgodnie z opisem w poniższych krokach:</span><span class="sxs-lookup"><span data-stu-id="3b8db-142">If you need to configure the health probe to go to a custom URL or modify any other settings, you must use custom probes as described in the following steps:</span></span>

## <a name="custom-health-probe"></a><span data-ttu-id="3b8db-143">Sondy kondycji niestandardowych</span><span class="sxs-lookup"><span data-stu-id="3b8db-143">Custom health probe</span></span>

<span data-ttu-id="3b8db-144">Niestandardowe sond umożliwiają mieć większą kontrolę nad monitorowanie kondycji.</span><span class="sxs-lookup"><span data-stu-id="3b8db-144">Custom probes allow you to have a more granular control over the health monitoring.</span></span> <span data-ttu-id="3b8db-145">Podczas korzystania z niestandardowego sond, można skonfigurować interwał sondowania, adres URL i ścieżki do testowania i zaakceptować przed oznaczeniem wystąpienia puli zaplecza swój stan jako niezdrowy ile odpowiedzi nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="3b8db-145">When using custom probes, you can configure the probe interval, the URL and path to test, and how many failed responses to accept before marking the back-end pool instance as unhealthy.</span></span>

### <a name="custom-health-probe-settings"></a><span data-ttu-id="3b8db-146">Ustawienia sondy kondycji niestandardowych</span><span class="sxs-lookup"><span data-stu-id="3b8db-146">Custom health probe settings</span></span>

<span data-ttu-id="3b8db-147">Poniższa tabela zawiera definicje dla właściwości sondy kondycji niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="3b8db-147">The following table provides definitions for the properties of a custom health probe.</span></span>

| <span data-ttu-id="3b8db-148">Właściwość sondy</span><span class="sxs-lookup"><span data-stu-id="3b8db-148">Probe property</span></span> | <span data-ttu-id="3b8db-149">Opis</span><span class="sxs-lookup"><span data-stu-id="3b8db-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="3b8db-150">Nazwa</span><span class="sxs-lookup"><span data-stu-id="3b8db-150">Name</span></span> |<span data-ttu-id="3b8db-151">Nazwa sondy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-151">Name of the probe.</span></span> <span data-ttu-id="3b8db-152">Ta nazwa jest używana do odwoływania się do sondowania w ustawieniach protokołu HTTP zaplecza.</span><span class="sxs-lookup"><span data-stu-id="3b8db-152">This name is used to refer to the probe in back-end HTTP settings.</span></span> |
| <span data-ttu-id="3b8db-153">Protokół</span><span class="sxs-lookup"><span data-stu-id="3b8db-153">Protocol</span></span> |<span data-ttu-id="3b8db-154">Protokół używany do wysyłania sondy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-154">Protocol used to send the probe.</span></span> <span data-ttu-id="3b8db-155">Sonda korzysta z protokołu zdefiniowanego w ustawieniach protokołu HTTP zaplecza</span><span class="sxs-lookup"><span data-stu-id="3b8db-155">The probe uses the protocol defined in the back-end HTTP settings</span></span> |
| <span data-ttu-id="3b8db-156">Host</span><span class="sxs-lookup"><span data-stu-id="3b8db-156">Host</span></span> |<span data-ttu-id="3b8db-157">Nazwa hosta, aby wysłać sondy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-157">Host name to send the probe.</span></span> <span data-ttu-id="3b8db-158">Dotyczy tylko wtedy, gdy obejmujący wiele lokacji jest skonfigurowany dla bramy aplikacji, w przeciwnym razie użyj '127.0.0.1'.</span><span class="sxs-lookup"><span data-stu-id="3b8db-158">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="3b8db-159">Ta wartość jest inna niż nazwa hosta maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="3b8db-159">This value is different from VM host name.</span></span> |
| <span data-ttu-id="3b8db-160">Ścieżka</span><span class="sxs-lookup"><span data-stu-id="3b8db-160">Path</span></span> |<span data-ttu-id="3b8db-161">Ścieżka względna sondy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-161">Relative path of the probe.</span></span> <span data-ttu-id="3b8db-162">Nieprawidłowa ścieżka rozpoczyna się od '/'.</span><span class="sxs-lookup"><span data-stu-id="3b8db-162">The valid path starts from '/'.</span></span> |
| <span data-ttu-id="3b8db-163">Interwał</span><span class="sxs-lookup"><span data-stu-id="3b8db-163">Interval</span></span> |<span data-ttu-id="3b8db-164">Interwał sondy w sekundach.</span><span class="sxs-lookup"><span data-stu-id="3b8db-164">Probe interval in seconds.</span></span> <span data-ttu-id="3b8db-165">Ta wartość jest odstęp czasu między dwa kolejne sondy.</span><span class="sxs-lookup"><span data-stu-id="3b8db-165">This value is the time interval between two consecutive probes.</span></span> |
| <span data-ttu-id="3b8db-166">Limit czasu</span><span class="sxs-lookup"><span data-stu-id="3b8db-166">Time-out</span></span> |<span data-ttu-id="3b8db-167">Badania limitu czasu w sekundach.</span><span class="sxs-lookup"><span data-stu-id="3b8db-167">Probe time-out in seconds.</span></span> <span data-ttu-id="3b8db-168">Jeśli w tym czasie limitu czasu nie odebrano prawidłowej odpowiedzi, sondy jest oznaczony jako nie powiodła się.</span><span class="sxs-lookup"><span data-stu-id="3b8db-168">If a valid response is not received within this time-out period, the probe is marked as failed.</span></span>  |
| <span data-ttu-id="3b8db-169">Próg złej kondycji</span><span class="sxs-lookup"><span data-stu-id="3b8db-169">Unhealthy threshold</span></span> |<span data-ttu-id="3b8db-170">Badania liczby ponownych prób.</span><span class="sxs-lookup"><span data-stu-id="3b8db-170">Probe retry count.</span></span> <span data-ttu-id="3b8db-171">Po kolejnych sondowania liczby awarii osiągnie próg złej kondycji serwera zaplecza jest oznaczony jako w dół.</span><span class="sxs-lookup"><span data-stu-id="3b8db-171">The back-end server is marked down after the consecutive probe failure count reaches the unhealthy threshold.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="3b8db-172">Jeśli skonfigurowano brama aplikacji w jednej lokacji, domyślnie hosta należy określać nazwy jako "127.0.0.1", chyba że w przeciwnym razie skonfigurowane w niestandardowych sondowania.</span><span class="sxs-lookup"><span data-stu-id="3b8db-172">If Application Gateway is configured for a single site, by default the Host name should be specified as '127.0.0.1', unless otherwise configured in custom probe.</span></span>
> <span data-ttu-id="3b8db-173">Dla odwołania do badania niestandardowe są wysyłane do \<protokołu\>://\<hosta\>:\<portu\>\<ścieżki\>.</span><span class="sxs-lookup"><span data-stu-id="3b8db-173">For reference a custom probe is sent to \<protocol\>://\<host\>:\<port\>\<path\>.</span></span> <span data-ttu-id="3b8db-174">Port używany będzie ten sam port, zgodnie z definicją w ustawienia HTTP zaplecza.</span><span class="sxs-lookup"><span data-stu-id="3b8db-174">The port used will be the same port as defined in the back-end HTTP settings.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3b8db-175">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="3b8db-175">Next steps</span></span>
<span data-ttu-id="3b8db-176">Po szkoleniowe dotyczące monitorowania kondycji aplikacji bramy, można skonfigurować [sondy kondycji niestandardowych](application-gateway-create-probe-portal.md) w portalu Azure lub [sondy kondycji niestandardowych](application-gateway-create-probe-ps.md) przy użyciu programu PowerShell i modelu wdrażania usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="3b8db-176">After learning about Application Gateway health monitoring, you can configure a [custom health probe](application-gateway-create-probe-portal.md) in the Azure portal or a [custom health probe](application-gateway-create-probe-ps.md) using PowerShell and the Azure Resource Manager deployment model.</span></span>

[1]: ./media/application-gateway-probe-overview/appgatewayprobe.png
