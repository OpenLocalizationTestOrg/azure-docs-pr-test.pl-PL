---
title: "skalowanie przy użyciu funkcji usługi Azure Stream Analytics & uczenie maszynowe Azure aaaJob | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak tooproperly skalowanie zadania usługi analiza strumienia (partycjonowania, ilość SU i inne) przy użyciu funkcji usługi Azure Machine Learning."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="e2b5d-103">Skalowanie zadania usługi analiza strumienia z funkcjami usługi Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="e2b5d-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="e2b5d-104">Często jest dość łatwe tooset zadania usługi analiza strumienia i uruchamiania przykładowych danych przy jego użyciu.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="e2b5d-105">Co możemy zrobić, gdy będzie trzeba toorun hello same zadania o wyższym ilość danych?</span><span class="sxs-lookup"><span data-stu-id="e2b5d-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="e2b5d-106">Wymaga to nam toounderstand jak tooconfigure hello analiza strumienia zadania, dzięki czemu mogą być skalowane.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="e2b5d-107">W tym dokumencie możemy koncentruje się na powitania specjalne aspektów skalowania usługi analiza strumienia zadań z funkcji Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="e2b5d-108">Aby uzyskać informacje dotyczące sposobu zadania usługi analiza strumienia tooscale ogólnie artykuł hello [skalowanie zadania](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="e2b5d-109">Co to jest funkcja uczenie maszynowe Azure w Stream Analytics?</span><span class="sxs-lookup"><span data-stu-id="e2b5d-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="e2b5d-110">Funkcja uczenia maszynowego w Stream Analytics może służyć jak wywołanie funkcji regularne w hello język zapytań usługi Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="e2b5d-111">Za sceny hello hello wywołania funkcji są faktycznie Usługa sieci Web systemu Azure Machine Learning żądania.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="e2b5d-112">Machine Learning w sieci web usług pomocy technicznej "przetwarzanie wsadowe" wiele wierszy, nazywanego mini partii, w hello sam sieci web wywołanie interfejsu API usługi, tooimprove ogólną przepustowość.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="e2b5d-113">Zobacz następujące artykuły, aby uzyskać więcej informacji; hello [Funkcji uczenia maszynowego azure Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) i [usługi sieci Web systemu Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="e2b5d-114">Skonfiguruj zadania usługi analiza strumienia z funkcjami uczenia maszynowego</span><span class="sxs-lookup"><span data-stu-id="e2b5d-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="e2b5d-115">Podczas konfigurowania funkcji Machine Learning zadania usługi analiza strumienia, istnieją dwa parametry tooconsider, rozmiar partii hello wywołania funkcji Machine Learning hello i hello jednostki (SUs) udostępniane zadania usługi analiza strumienia hello przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="e2b5d-116">toodetermine hello odpowiednie wartości dla nich, najpierw należy podjąć decyzję między opóźnienia i przepływności, oznacza to, opóźnienie zadania usługi analiza strumienia hello i przepływności każdego SU.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="e2b5d-117">SUs zawsze można dodać zadania tooa tooincrease przepływność również podzielone na partycje zapytań usługi Stream Analytics, chociaż dodatkowe SUs zwiększa koszt hello wykonywanym zadaniem hello.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="e2b5d-118">Dlatego jest ważne toodetermine hello *tolerancji* opóźnienia w uruchomienia zadania usługi analiza strumienia.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="e2b5d-119">Z rozmiar partii, który będzie złożone hello opóźnienie zadania usługi analiza strumienia hello naturalnie zwiększy się opóźnienie dodatkowych z żądaniami obsługi usługi Azure Machine Learning uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="e2b5d-120">Na powitania drugiej strony, zwiększyć rozmiar partii umożliwia tooprocess zadania usługi analiza strumienia hello * więcej zdarzeń o hello *tego samego numeru* z usługi Machine Learning web żądania obsługi.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="e2b5d-121">Często hello wzrost opóźnienia usługi sieci web uczenie maszynowe jest toohello podrzędna liniowy wzrost rozmiar partii, dlatego jest ważne tooconsider hello najbardziej ekonomiczne rozmiar wsadu dla usługi sieci web uczenie maszynowe w danej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="e2b5d-122">Domyślny rozmiar wsadu dla usługi sieci web hello Hello żądań wynosi 1000, a można modyfikować przy użyciu hello [interfejsu API REST usługi analiza strumienia](https://msdn.microsoft.com/library/mt653706.aspx "interfejsu API REST usługi analiza strumienia") lub hello [klienta programu PowerShell dla usługi Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "klienta programu PowerShell dla usługi Stream Analytics").</span><span class="sxs-lookup"><span data-stu-id="e2b5d-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="e2b5d-123">Po określeniu rozmiar partii ilość hello przesyłania strumieniowego jednostki (SUs) jest to możliwe, na podstawie hello liczby zdarzeń wymagane przez funkcję hello tooprocess na sekundę.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="e2b5d-124">Aby uzyskać więcej informacji na temat jednostek przesyłania strumieniowego, zobacz [Stream Analytics skalowanie zadania](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="e2b5d-125">Ogólnie rzecz biorąc istnieją 20 równoczesnych połączeń usługę sieci web uczenie maszynowe toohello co 6 SUs z tą różnicą, że zadania SU 1 i 3 zadania SU otrzyma 20 równoczesnych połączeń również.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="e2b5d-126">Na przykład jeśli szybkość danych wejściowych hello jest 200 000 zdarzeń na sekundę i pozostanie rozmiar partii hello domyślną toohello 1000 hello wynikowa sieci web usługi opóźnienia z 1000 zdarzeń mini partii jest 200 ms.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="e2b5d-127">Oznacza to, że każdy połączenia mogą wysyłać żądania 5 toohello Machine Learning web service na sekundę.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="e2b5d-128">W przypadku połączeń 20 hello zadanie usługi analiza strumienia może przetwarzać 20 000 zdarzeń w 200 MS i w związku z tym 100 000 zdarzeń na sekundę.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="e2b5d-129">Dlatego tooprocess 200 000 zdarzeń na sekundę, zadanie usługi Stream Analytics hello musi 40 równoczesnych połączeń, który wychodzi too12 SUs.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="e2b5d-130">hello żądania zadania usługi analiza strumienia hello toohello końcowy usługi sieci web uczenie maszynowe przedstawiono na poniższym wykresie Hello — co 6 SUs ma 20 równoczesnych połączeń tooMachine Learning usługi sieci web w max.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="e2b5d-131">![Skalowanie usługi Stream Analytics przykładu zadania Machine Learning funkcje 2](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "skali Stream Analytics, Machine Learning funkcje 2 zadania przykładu")</span><span class="sxs-lookup"><span data-stu-id="e2b5d-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="e2b5d-132">Ogólnie rzecz biorąc ***B*** dla rozmiaru partii ***L*** dla hello opóźnienia usługi sieci web na rozmiar partii B w milisekundach, hello przepływności zadanie usługi Stream Analytics z ***N*** SUs jest:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="e2b5d-133">![Skalowanie usługi Stream Analytics formułą funkcji Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "skalowania usługi Stream Analytics formułą funkcji Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="e2b5d-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="e2b5d-134">Dodatkowego rozważenia może być hello "max równoczesnych wywołań" na powitania po stronie usługi sieci web uczenie maszynowe, zaleca tooset to maksymalna wartość toohello (obecnie 200).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="e2b5d-135">Aby uzyskać więcej informacji na temat tego ustawienia Przejrzyj hello [artykułu skalowanie dla usługi sieci Web usługi Machine Learning](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="e2b5d-136">Przykład — analizy wskaźniki nastrojów klientów</span><span class="sxs-lookup"><span data-stu-id="e2b5d-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="e2b5d-137">Witaj poniższy przykład zawiera zadania usługi analiza strumienia z analizą wskaźniki nastrojów klientów hello funkcji Machine Learning, zgodnie z opisem w hello [samouczek integracji usługi Stream Analytics Machine Learning](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="e2b5d-138">Witaj zapytanie jest proste zapytanie pełni partycjonowanej następuje hello **wskaźniki nastrojów klientów** funkcji, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="e2b5d-139">Należy wziąć pod uwagę powitania po scenariusz; o przepustowości 10 000 tweetów na sekundę zadanie usługi Stream Analytics należy utworzyć analizy wskaźniki nastrojów klientów tooperform tweetów hello (zdarzeń).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="e2b5d-140">Przy użyciu funkcji 1 SU, to zadanie usługi Stream Analytics można toohandle stanie hello ruchu?</span><span class="sxs-lookup"><span data-stu-id="e2b5d-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="e2b5d-141">Przy użyciu hello domyślny rozmiar wsadu 1000 hello zadania powinna być tookeep stanie się przy użyciu hello danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="e2b5d-142">Dalsze hello dodać funkcji Machine Learning powinna generować ma więcej niż 1 sekunda opóźnienia, czyli hello domyślne Ogólne opóźnienie hello wskaźniki nastrojów klientów analizy usługi sieci web uczenie maszynowe (z domyślny rozmiar partii 1000).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="e2b5d-143">zadanie Stream Analytics Hello **ogólną** lub czas oczekiwania na trasie będzie zazwyczaj kilka sekund.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="e2b5d-144">Zapoznaj się z bardziej szczegółowe do tego zadania usługi analiza strumienia *szczególnie* hello wywołania funkcji Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="e2b5d-145">O rozmiar partii hello jako 1000, przepustowości 10 000 zdarzeń potrwa około 10 żądań tooweb usługi.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="e2b5d-146">Nawet w przypadku 1 SU są tooaccommodate wystarczającej liczby równoczesnych połączeń wejściowego ruchu.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="e2b5d-147">Ale co w przypadku występowania zdarzeń wejściowych hello zwiększa 100 x i zadania usługi analiza strumienia hello musi teraz tooprocess tweetów 1 000 000 na sekundę?</span><span class="sxs-lookup"><span data-stu-id="e2b5d-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="e2b5d-148">Dostępne są dwie opcje:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-148">There are two options:</span></span>

1. <span data-ttu-id="e2b5d-149">Zwiększ rozmiar partii hello, lub</span><span class="sxs-lookup"><span data-stu-id="e2b5d-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="e2b5d-150">Partycja hello strumień wejściowy tooprocess hello zdarzenia równolegle</span><span class="sxs-lookup"><span data-stu-id="e2b5d-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="e2b5d-151">Z pierwszej opcji hello hello zadania **opóźnienia** wzrośnie.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="e2b5d-152">Z drugą opcją hello SUs więcej będzie konieczne toobe obsługi administracyjnej i w związku z tym Generowanie więcej jednoczesnych żądań usług sieci web uczenie maszynowe.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="e2b5d-153">Oznacza to, że zadanie hello **koszt** wzrośnie.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="e2b5d-154">Załóżmy, że opóźnienie hello hello wskaźniki nastrojów klientów analizy usługi sieci web uczenie maszynowe jest 200 ms dla partii zdarzeń 1000 lub poniżej, 250ms partii 5000 zdarzeń, 300ms partii 10 000 zdarzeń lub 500 MS. partii 25 000 zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="e2b5d-155">Przy użyciu pierwszej opcji hello (**nie** inicjowania obsługi administracyjnej SUs więcej), rozmiar partii hello można zwiększyć za**25 000**.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="e2b5d-156">To z kolei umożliwia tooprocess zadania hello 1 000 000 zdarzeń o toohello 20 równoczesnych połączeń usługi sieci web uczenie maszynowe (z opóźnieniem 500 MS. na wywołanie).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="e2b5d-157">Dlatego hello dodatkowe opóźnienia zadanie usługi Stream Analytics hello ukończenia żądania funkcji wskaźniki nastrojów klientów toohello hello uczenia maszynowego żądania usługi sieci web może zostać zwiększona z **200 MS** za**500 MS.**.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="e2b5d-158">Jednak należy pamiętać, że rozmiar partii **nie** można zwiększyć nieograniczonej hello usług sieci web uczenie maszynowe wymaga hello rozmiar ładunku żądania 4 MB lub mniejsze sieci web limit czasu żądania usługi 100 sekund operacji.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="e2b5d-159">Przy użyciu opcji drugi hello, rozmiar partii hello pozostawiono 1000, z opóźnieniem usługi sieci web 200 MS, każda usługa sieci web toohello 20 równoczesnych połączeń będą mogli tooprocess zdarzenia 1000 * 20 * 5 = 100 000 na sekundę.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="e2b5d-160">Dlatego tooprocess 1 000 000 zdarzeń na sekundę, zadanie hello potrzebny 60 SUs.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="e2b5d-161">W porównaniu toohello pierwsza opcja, analiza strumienia zadania spowodowałoby więcej żądania sieci web usługi partii, z kolei generowania zwiększenie kosztów.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="e2b5d-162">Poniżej znajduje się tabela przepustowości hello hello zadania usługi analiza strumienia dla różnych SUs i rozmiary partii (w liczbie zdarzeń na sekundę).</span><span class="sxs-lookup"><span data-stu-id="e2b5d-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="e2b5d-163">rozmiar partii (ML opóźnienia)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-163">batch size (ML latency)</span></span> | <span data-ttu-id="e2b5d-164">500 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-164">500 (200ms)</span></span> | <span data-ttu-id="e2b5d-165">1000 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-165">1,000 (200ms)</span></span> | <span data-ttu-id="e2b5d-166">5000 (250ms)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-166">5,000 (250ms)</span></span> | <span data-ttu-id="e2b5d-167">10 000 (300ms)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-167">10,000 (300ms)</span></span> | <span data-ttu-id="e2b5d-168">25 000 (500 MS.)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="e2b5d-169">**1 SU**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-169">**1 SU**</span></span> |<span data-ttu-id="e2b5d-170">2,500</span><span class="sxs-lookup"><span data-stu-id="e2b5d-170">2,500</span></span> |<span data-ttu-id="e2b5d-171">5,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-171">5,000</span></span> |<span data-ttu-id="e2b5d-172">20,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-172">20,000</span></span> |<span data-ttu-id="e2b5d-173">30,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-173">30,000</span></span> |<span data-ttu-id="e2b5d-174">50,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-174">50,000</span></span> |
| <span data-ttu-id="e2b5d-175">**3 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-175">**3 SUs**</span></span> |<span data-ttu-id="e2b5d-176">2,500</span><span class="sxs-lookup"><span data-stu-id="e2b5d-176">2,500</span></span> |<span data-ttu-id="e2b5d-177">5,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-177">5,000</span></span> |<span data-ttu-id="e2b5d-178">20,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-178">20,000</span></span> |<span data-ttu-id="e2b5d-179">30,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-179">30,000</span></span> |<span data-ttu-id="e2b5d-180">50,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-180">50,000</span></span> |
| <span data-ttu-id="e2b5d-181">**6 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-181">**6 SUs**</span></span> |<span data-ttu-id="e2b5d-182">2,500</span><span class="sxs-lookup"><span data-stu-id="e2b5d-182">2,500</span></span> |<span data-ttu-id="e2b5d-183">5,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-183">5,000</span></span> |<span data-ttu-id="e2b5d-184">20,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-184">20,000</span></span> |<span data-ttu-id="e2b5d-185">30,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-185">30,000</span></span> |<span data-ttu-id="e2b5d-186">50,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-186">50,000</span></span> |
| <span data-ttu-id="e2b5d-187">**12 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-187">**12 SUs**</span></span> |<span data-ttu-id="e2b5d-188">5,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-188">5,000</span></span> |<span data-ttu-id="e2b5d-189">10 000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-189">10,000</span></span> |<span data-ttu-id="e2b5d-190">40,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-190">40,000</span></span> |<span data-ttu-id="e2b5d-191">60,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-191">60,000</span></span> |<span data-ttu-id="e2b5d-192">100,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-192">100,000</span></span> |
| <span data-ttu-id="e2b5d-193">**18 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-193">**18 SUs**</span></span> |<span data-ttu-id="e2b5d-194">7,500</span><span class="sxs-lookup"><span data-stu-id="e2b5d-194">7,500</span></span> |<span data-ttu-id="e2b5d-195">15,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-195">15,000</span></span> |<span data-ttu-id="e2b5d-196">60,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-196">60,000</span></span> |<span data-ttu-id="e2b5d-197">90,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-197">90,000</span></span> |<span data-ttu-id="e2b5d-198">150,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-198">150,000</span></span> |
| <span data-ttu-id="e2b5d-199">**24 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-199">**24 SUs**</span></span> |<span data-ttu-id="e2b5d-200">10 000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-200">10,000</span></span> |<span data-ttu-id="e2b5d-201">20,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-201">20,000</span></span> |<span data-ttu-id="e2b5d-202">80,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-202">80,000</span></span> |<span data-ttu-id="e2b5d-203">120,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-203">120,000</span></span> |<span data-ttu-id="e2b5d-204">200,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-204">200,000</span></span> |
| <span data-ttu-id="e2b5d-205">**…**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-205">**…**</span></span> |<span data-ttu-id="e2b5d-206">…</span><span class="sxs-lookup"><span data-stu-id="e2b5d-206">…</span></span> |<span data-ttu-id="e2b5d-207">…</span><span class="sxs-lookup"><span data-stu-id="e2b5d-207">…</span></span> |<span data-ttu-id="e2b5d-208">…</span><span class="sxs-lookup"><span data-stu-id="e2b5d-208">…</span></span> |<span data-ttu-id="e2b5d-209">…</span><span class="sxs-lookup"><span data-stu-id="e2b5d-209">…</span></span> |<span data-ttu-id="e2b5d-210">…</span><span class="sxs-lookup"><span data-stu-id="e2b5d-210">…</span></span> |
| <span data-ttu-id="e2b5d-211">**60 SUs**</span><span class="sxs-lookup"><span data-stu-id="e2b5d-211">**60 SUs**</span></span> |<span data-ttu-id="e2b5d-212">25,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-212">25,000</span></span> |<span data-ttu-id="e2b5d-213">50,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-213">50,000</span></span> |<span data-ttu-id="e2b5d-214">200,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-214">200,000</span></span> |<span data-ttu-id="e2b5d-215">300,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-215">300,000</span></span> |<span data-ttu-id="e2b5d-216">500,000</span><span class="sxs-lookup"><span data-stu-id="e2b5d-216">500,000</span></span> |

<span data-ttu-id="e2b5d-217">W razie ma już dobrą znajomość jak działają funkcje uczenia maszynowego w Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="e2b5d-218">Prawdopodobnie również rozumiesz, że zadania usługi analiza strumienia "pull" danych ze źródeł danych i każdego "wypychania" zwraca partii zdarzeń hello tooprocess zadania usługi analiza strumienia.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="e2b5d-219">Sposób ten model ściągania wpływ żądania usługi sieci web uczenie maszynowe hello?</span><span class="sxs-lookup"><span data-stu-id="e2b5d-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="e2b5d-220">Rozmiar partii hello ustawione dla funkcji Machine Learning dokładnie będzie zazwyczaj podzielna przez hello liczba zdarzeń zwróconych przez każde zadanie usługi analiza strumienia "ściągania".</span><span class="sxs-lookup"><span data-stu-id="e2b5d-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="e2b5d-221">Gdy to występuje hello usługi sieci web uczenie maszynowe zostanie wywołana partie "częściowej".</span><span class="sxs-lookup"><span data-stu-id="e2b5d-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="e2b5d-222">Jest to realizowane toonot pociągnąć za sobą opóźnienie dodatkowych zadań obciążenie w łączącego zdarzenia z toopull ściągania.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="e2b5d-223">Nowe związanych z funkcji monitorowania metryki</span><span class="sxs-lookup"><span data-stu-id="e2b5d-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="e2b5d-224">W hello obszaru Monitor zadania Stream Analytics zostały dodane trzy dodatkowe metryki dotyczące funkcji.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="e2b5d-225">Są one ŻĄDANIA funkcji, zdarzenia funkcji i ŻĄDANIA funkcji nie powiodło się, jak pokazano na rysunku hello poniżej.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="e2b5d-226">![Skalowanie analizy strumienia w usłudze Machine Learning funkcje metryki](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "analizy strumienia w usłudze Machine Learning funkcje metryki skalowania")</span><span class="sxs-lookup"><span data-stu-id="e2b5d-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="e2b5d-227">Hello są zdefiniowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-227">hello are defined as follows:</span></span>

<span data-ttu-id="e2b5d-228">**Funkcja ŻĄDANIA**: hello liczba żądań funkcji.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="e2b5d-229">**ZDARZENIA funkcji**: hello numerów zdarzeń w hello funkcji żądania.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="e2b5d-230">**Liczba NIEUDANYCH ŻĄDAŃ funkcja**: hello liczba żądań funkcji zakończonych niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="e2b5d-231">Takeaways klucza</span><span class="sxs-lookup"><span data-stu-id="e2b5d-231">Key Takeaways</span></span>
<span data-ttu-id="e2b5d-232">toosummarize hello głównych punktów, w kolejności tooscale zadanie usługi Stream Analytics za pomocą funkcji Machine Learning hello następujące elementy należy rozważyć:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="e2b5d-233">częstotliwość zdarzenia wejściowego Hello</span><span class="sxs-lookup"><span data-stu-id="e2b5d-233">hello input event rate</span></span>
2. <span data-ttu-id="e2b5d-234">Hello dopuszczalne czas oczekiwania na powitania uruchomione zadanie usługi Stream Analytics (i w związku z tym rozmiar partii hello usługi sieci web uczenie maszynowe hello żądań)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="e2b5d-235">Witaj zainicjowano obsługę administracyjną, Stream Analytics SUs i hello liczby żądań usług sieci web uczenie maszynowe (hello dodatkowych funkcji koszty związane z)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="e2b5d-236">Pełni partycjonowanej zapytań usługi Stream Analytics została użyta jako przykład.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="e2b5d-237">Jeśli potrzebna jest bardziej złożonego zapytania hello [forum usługi Azure Stream Analytics](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) jest doskonałą pomocą podczas uzyskiwania pomocy dodatkowej hello przez zespół usługi Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="e2b5d-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e2b5d-238">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="e2b5d-238">Next steps</span></span>
<span data-ttu-id="e2b5d-239">toolearn więcej informacji na temat usługi Stream Analytics, zobacz:</span><span class="sxs-lookup"><span data-stu-id="e2b5d-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="e2b5d-240">Get started using Azure Stream Analytics (Rozpoczynanie pracy z usługą Azure Stream Analytics)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="e2b5d-241">Scale Azure Stream Analytics jobs (Skalowanie zadań usługi Azure Stream Analytics)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="e2b5d-242">Azure Stream Analytics Query Language Reference (Dokumentacja dotycząca języka zapytań usługi Azure Stream Analytics)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="e2b5d-243">Azure Stream Analytics Management REST API Reference (Dokumentacja interfejsu API REST zarządzania usługą Azure Stream Analytics)</span><span class="sxs-lookup"><span data-stu-id="e2b5d-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
