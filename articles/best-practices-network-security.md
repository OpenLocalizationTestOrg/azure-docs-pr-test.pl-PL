---
title: "Najlepsze rozwiązania sieci platformy Azure | Dokumentacja firmy Microsoft"
description: "Dowiedz się, niektóre najważniejsze funkcje dostępne w systemie Azure w celu tworzenia bezpiecznego w środowiskach sieci"
services: virtual-network
documentationcenter: na
author: tracsman
manager: rossort
editor: 
ms.assetid: d169387a-1243-4867-a602-01d6f2d8a2a1
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/03/2017
ms.author: jonor
ms.openlocfilehash: fb5e399d4ab02a7f2805cc280b213bf5b44f6993
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="microsoft-cloud-services-and-network-security"></a><span data-ttu-id="4f715-103">Chmury Microsoft bezpieczeństwa usług i sieci</span><span class="sxs-lookup"><span data-stu-id="4f715-103">Microsoft cloud services and network security</span></span>
<span data-ttu-id="4f715-104">Usługi w chmurze firmy Microsoft świadczenia usług hiperskali i infrastruktury, funkcje klasy korporacyjnej oraz wiele opcji na potrzeby łączności hybrydowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-104">Microsoft cloud services deliver hyper-scale services and infrastructure, enterprise-grade capabilities, and many choices for hybrid connectivity.</span></span> <span data-ttu-id="4f715-105">Klienci mogą wybrać dostępu do tych usług za pośrednictwem Internetu lub z usługi Azure ExpressRoute, który zapewnia łączność w sieci prywatnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-105">Customers can choose to access these services either via the Internet or with Azure ExpressRoute, which provides private network connectivity.</span></span> <span data-ttu-id="4f715-106">Platforma Microsoft Azure umożliwia klientom bezproblemowo rozszerzają infrastruktury do chmury i tworzenia wielu architektur.</span><span class="sxs-lookup"><span data-stu-id="4f715-106">The Microsoft Azure platform allows customers to seamlessly extend their infrastructure into the cloud and build multi-tier architectures.</span></span> <span data-ttu-id="4f715-107">Ponadto stron trzecich można włączyć udoskonalone funkcje oferty usług zabezpieczeń oraz urządzenia wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="4f715-107">Additionally, third parties can enable enhanced capabilities by offering security services and virtual appliances.</span></span> <span data-ttu-id="4f715-108">Ten dokument zawiera omówienie architektury problemów, które klientów należy wziąć pod uwagę podczas korzystania z usługi w chmurze firmy Microsoft dostępne za pośrednictwem usługi ExpressRoute i zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-108">This white paper provides an overview of security and architectural issues that customers should consider when using Microsoft cloud services accessed via ExpressRoute.</span></span> <span data-ttu-id="4f715-109">Obejmuje ona również tworzenia bardziej bezpieczne usług w sieci wirtualnych platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-109">It also covers creating more secure services in Azure virtual networks.</span></span>

## <a name="fast-start"></a><span data-ttu-id="4f715-110">Szybki start</span><span class="sxs-lookup"><span data-stu-id="4f715-110">Fast start</span></span>
<span data-ttu-id="4f715-111">Na poniższym wykresie logiki można kierować do określonych przykład wielu metody zabezpieczeń dostępne z platformą Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-111">The following logic chart can direct you to a specific example of the many security techniques available with the Azure platform.</span></span> <span data-ttu-id="4f715-112">Krótki przewodnik można znaleźć na przykład, który najlepiej odpowiada Twoim przypadku.</span><span class="sxs-lookup"><span data-stu-id="4f715-112">For quick reference, find the example that best fits your case.</span></span> <span data-ttu-id="4f715-113">Rozwinięte wyjaśnień nadal odczytywania za pośrednictwem papieru.</span><span class="sxs-lookup"><span data-stu-id="4f715-113">For expanded explanations, continue reading through the paper.</span></span>
<span data-ttu-id="4f715-114">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="4f715-114">[![0]][0]</span></span>

[<span data-ttu-id="4f715-115">Przykład 1: Tworzenie sieci obwodowej (znanej także jako strefa DMZ, strefą zdemilitaryzowaną lub podsiecią ekranowaną) do ochrony aplikacji przy użyciu grup zabezpieczeń sieci (NSG).</span><span class="sxs-lookup"><span data-stu-id="4f715-115">Example 1: Build a perimeter network (also known as DMZ, demilitarized zone, or screened subnet) to help protect applications with network security groups (NSGs).</span></span>](#example-1-build-a-perimeter-network-to-help-protect-applications-with-nsgs)</br><span data-ttu-id="4f715-116">
[Przykład 2: Tworzenie sieci obwodowej, aby chronić aplikacje z zaporą i grup NSG.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span><span class="sxs-lookup"><span data-stu-id="4f715-116">
[Example 2: Build a perimeter network to help protect applications with a firewall and NSGs.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span></span></br><span data-ttu-id="4f715-117">
[Przykład 3: Tworzenie sieci obwodowej, aby zabezpieczyć sieć zapory, trasy zdefiniowane przez użytkownika (przez) i grupy NSG.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span><span class="sxs-lookup"><span data-stu-id="4f715-117">
[Example 3: Build a perimeter network to help protect networks with a firewall, user-defined route (UDR), and NSG.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span></span></br><span data-ttu-id="4f715-118">
[Przykład 4: Dodaj połączenie hybrydowe z urządzenia do lokacji, wirtualne wirtualnej sieci prywatnej (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span><span class="sxs-lookup"><span data-stu-id="4f715-118">
[Example 4: Add a hybrid connection with a site-to-site, virtual appliance virtual private network (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span></span></br><span data-ttu-id="4f715-119">
[Przykład 5: Dodaj połączenie hybrydowe lokacja lokacja, Brama sieci VPN platformy Azure.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span><span class="sxs-lookup"><span data-stu-id="4f715-119">
[Example 5: Add a hybrid connection with a site-to-site, Azure VPN gateway.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span></span></br><span data-ttu-id="4f715-120">
[Przykład 6: Dodaj połączenie hybrydowe z usługi ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span><span class="sxs-lookup"><span data-stu-id="4f715-120">
[Example 6: Add a hybrid connection with ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span></span></br>
<span data-ttu-id="4f715-121">Przykłady dodawania połączeń między sieciami wirtualnymi, wysokiej dostępności i łańcucha usługi zostanie dodany do tego dokumentu za pośrednictwem kilku kolejnych miesięcy.</span><span class="sxs-lookup"><span data-stu-id="4f715-121">Examples for adding connections between virtual networks, high availability, and service chaining will be added to this document over the next few months.</span></span>

## <a name="microsoft-compliance-and-infrastructure-protection"></a><span data-ttu-id="4f715-122">Ochrona zgodności i infrastruktury firmy Microsoft</span><span class="sxs-lookup"><span data-stu-id="4f715-122">Microsoft compliance and infrastructure protection</span></span>
<span data-ttu-id="4f715-123">Aby ułatwić organizacjom zapewnienia zgodności z wymaganiami krajowych, regionalnych i branżowe dotyczące zbierania i używania danych poszczególnych osób, firma Microsoft oferuje ponad 40 certyfikaty oraz poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="4f715-123">To help organizations comply with national, regional, and industry-specific requirements governing the collection and use of individuals’ data, Microsoft offers over 40 certifications and attestations.</span></span> <span data-ttu-id="4f715-124">Najbardziej kompleksowy zestaw dowolnego dostawcy usług w chmurze.</span><span class="sxs-lookup"><span data-stu-id="4f715-124">The most comprehensive set of any cloud service provider.</span></span>

<span data-ttu-id="4f715-125">Aby uzyskać więcej informacji, zobacz informacje o zgodności na [Microsoft Trust Center][TrustCenter].</span><span class="sxs-lookup"><span data-stu-id="4f715-125">For more information, see the compliance information on the [Microsoft Trust Center][TrustCenter].</span></span>

<span data-ttu-id="4f715-126">Firma Microsoft ma wyczerpującą chronić potrzebne do uruchomienia usług globalnych hiperskali infrastruktury chmury.</span><span class="sxs-lookup"><span data-stu-id="4f715-126">Microsoft has a comprehensive approach to protect cloud infrastructure needed to run hyper-scale global services.</span></span> <span data-ttu-id="4f715-127">Infrastruktury chmury firmy Microsoft obejmuje sprzętu, oprogramowania, sieci i administracyjnych i operatorów, oprócz centrów danych fizycznych.</span><span class="sxs-lookup"><span data-stu-id="4f715-127">Microsoft cloud infrastructure includes hardware, software, networks, and administrative and operations staff, in addition to the physical data centers.</span></span>

<span data-ttu-id="4f715-128">![2]</span><span class="sxs-lookup"><span data-stu-id="4f715-128">![2]</span></span>

<span data-ttu-id="4f715-129">To podejście zapewnia bardziej bezpieczną podstawę dla klientów do wdrożenia usług w chmurze firmy Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4f715-129">This approach provides a more secure foundation for customers to deploy their services in the Microsoft cloud.</span></span> <span data-ttu-id="4f715-130">Następnym krokiem jest przeznaczona dla klientów do projektowania i tworzenia Architektura zabezpieczeń, aby chronić te usługi.</span><span class="sxs-lookup"><span data-stu-id="4f715-130">The next step is for customers to design and create a security architecture to protect these services.</span></span>

## <a name="traditional-security-architectures-and-perimeter-networks"></a><span data-ttu-id="4f715-131">Tradycyjne zabezpieczenia architektury i sieci obwodowej</span><span class="sxs-lookup"><span data-stu-id="4f715-131">Traditional security architectures and perimeter networks</span></span>
<span data-ttu-id="4f715-132">Mimo że Microsoft intensywnie inwestuje ochrony infrastruktury chmury, klienci muszą również ochronę ich usługi w chmurze i grup zasobów.</span><span class="sxs-lookup"><span data-stu-id="4f715-132">Although Microsoft invests heavily in protecting the cloud infrastructure, customers must also protect their cloud services and resource groups.</span></span> <span data-ttu-id="4f715-133">Wielowarstwowe podejścia do zabezpieczeń zapewnia najlepszą ochroną.</span><span class="sxs-lookup"><span data-stu-id="4f715-133">A multilayered approach to security provides the best defense.</span></span> <span data-ttu-id="4f715-134">Strefy zabezpieczeń sieci obwodowej chroni wewnętrznych zasobów sieciowych z niezaufaną siecią.</span><span class="sxs-lookup"><span data-stu-id="4f715-134">A perimeter network security zone protects internal network resources from an untrusted network.</span></span> <span data-ttu-id="4f715-135">Sieć obwodowa odwołuje się do krawędzi lub części sieci, które znajdują się między Internet i chronionych enterprise infrastruktury IT.</span><span class="sxs-lookup"><span data-stu-id="4f715-135">A perimeter network refers to the edges or parts of the network that sit between the Internet and the protected enterprise IT infrastructure.</span></span>

<span data-ttu-id="4f715-136">W sieciach typowego przedsiębiorstwa w infrastrukturze podstawowej jest znacznie wzmocnione na strefy, z wielu warstw zabezpieczeń urządzeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-136">In typical enterprise networks, the core infrastructure is heavily fortified at the perimeters, with multiple layers of security devices.</span></span> <span data-ttu-id="4f715-137">Granica każdej warstwy składa się z urządzeniami i punkty wymuszania zasad.</span><span class="sxs-lookup"><span data-stu-id="4f715-137">The boundary of each layer consists of devices and policy enforcement points.</span></span> <span data-ttu-id="4f715-138">Każda warstwa może zawierać kombinację następujących urządzeń zabezpieczeń sieciowych: zapór, zapobiegania przeprowadzenie ataku typu "odmowa usługi" (DoS), wykrywania nieautoryzowanego dostępu lub systemy ochrony (Identyfikatory/IP) i urządzenia sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="4f715-138">Each layer can include a combination of the following network security devices: firewalls, Denial of Service (DoS) prevention, Intrusion Detection or Protection Systems (IDS/IPS), and VPN devices.</span></span> <span data-ttu-id="4f715-139">Wymuszanie zasad mogą mieć formę zasad zapory, listy kontroli dostępu (ACL) lub specyficznego routingu.</span><span class="sxs-lookup"><span data-stu-id="4f715-139">Policy enforcement can take the form of firewall policies, access control lists (ACLs), or specific routing.</span></span> <span data-ttu-id="4f715-140">Pierwszy wiersz obrony w sieci, bezpośrednio akceptować ruch przychodzący z Internetu, to kombinacja tych mechanizmów na ataki bloku i szkodliwy ruch umożliwiając dalsze uprawnionych żądań do sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-140">The first line of defense in the network, directly accepting incoming traffic from the Internet, is a combination of these mechanisms to block attacks and harmful traffic while allowing legitimate requests further into the network.</span></span> <span data-ttu-id="4f715-141">Ten ruch trasy bezpośrednio do zasobów w sieci obwodowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-141">This traffic routes directly to resources in the perimeter network.</span></span> <span data-ttu-id="4f715-142">Ten zasób może następnie "skontaktować" zasobów więcej danych w sieci, przejeżdżających przez granicę dalej do sprawdzania poprawności pierwszy.</span><span class="sxs-lookup"><span data-stu-id="4f715-142">That resource may then “talk” to resources deeper in the network, transiting the next boundary for validation first.</span></span> <span data-ttu-id="4f715-143">Warstwa peryferyjnych jest nazywany sieci obwodowej, ponieważ ta część sieci jest połączenie z Internetem, zwykle z jakiegoś ochrony po obu stronach.</span><span class="sxs-lookup"><span data-stu-id="4f715-143">The outermost layer is called the perimeter network because this part of the network is exposed to the Internet, usually with some form of protection on both sides.</span></span> <span data-ttu-id="4f715-144">Na poniższej ilustracji przedstawiono przykład sieci obwodowej pojedynczej podsieci w sieci firmowej, z dwóch granic zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-144">The following figure shows an example of a single subnet perimeter network in a corporate network, with two security boundaries.</span></span>

<span data-ttu-id="4f715-145">![3]</span><span class="sxs-lookup"><span data-stu-id="4f715-145">![3]</span></span>

<span data-ttu-id="4f715-146">Istnieje wiele architektur używaną do zaimplementowania sieci obwodowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-146">There are many architectures used to implement a perimeter network.</span></span> <span data-ttu-id="4f715-147">Te architektury mogą należeć do zakresu od modułu równoważenia obciążenia proste do sieci obwodowej wiele podsieci z różnych mechanizmów w każdej granicy bloku ruchu i ochronę głębiej warstwy sieci firmowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-147">These architectures can range from a simple load balancer to a multiple-subnet perimeter network with varied mechanisms at each boundary to block traffic and protect the deeper layers of the corporate network.</span></span> <span data-ttu-id="4f715-148">Jak jest wbudowana w sieci obwodowej zależy od specyficznych potrzeb organizacji i jej ogólnej tolerancji ryzyka.</span><span class="sxs-lookup"><span data-stu-id="4f715-148">How the perimeter network is built depends on the specific needs of the organization and its overall risk tolerance.</span></span>

<span data-ttu-id="4f715-149">Jak klienci przenoszenie obciążeń do chmur publicznych, bardzo ważne jest Obsługa architektury sieci obwodowej na platformie Azure, aby spełnić wymagania dotyczące zabezpieczeń i zgodności podobne możliwości.</span><span class="sxs-lookup"><span data-stu-id="4f715-149">As customers move their workloads to public clouds, it is critical to support similar capabilities for perimeter network architecture in Azure to meet compliance and security requirements.</span></span> <span data-ttu-id="4f715-150">Ten dokument zawiera wskazówki, w jaki sposób klienci mogą tworzyć środowisku bezpiecznej sieci na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-150">This document provides guidelines on how customers can build a secure network environment in Azure.</span></span> <span data-ttu-id="4f715-151">Skupiono się w sieci obwodowej, ale również zawiera kompleksowe omówienie wiele aspektów zabezpieczeń sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-151">It focuses on the perimeter network, but also includes a comprehensive discussion of many aspects of network security.</span></span> <span data-ttu-id="4f715-152">Następujące pytania o tej dyskusji:</span><span class="sxs-lookup"><span data-stu-id="4f715-152">The following questions inform this discussion:</span></span>

* <span data-ttu-id="4f715-153">Jak można wbudować sieci obwodowej na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="4f715-153">How can a perimeter network in Azure be built?</span></span>
* <span data-ttu-id="4f715-154">Co to są funkcje platformy Azure umożliwiających tworzenie sieci obwodowej?</span><span class="sxs-lookup"><span data-stu-id="4f715-154">What are some of the Azure features available to build the perimeter network?</span></span>
* <span data-ttu-id="4f715-155">Jak można chronić obciążeń zaplecza</span><span class="sxs-lookup"><span data-stu-id="4f715-155">How can back-end workloads be protected?</span></span>
* <span data-ttu-id="4f715-156">Jak są kontrolowane komunikację z Internetem w przypadku obciążeń na platformie Azure?</span><span class="sxs-lookup"><span data-stu-id="4f715-156">How are Internet communications controlled to the workloads in Azure?</span></span>
* <span data-ttu-id="4f715-157">Jak sieci lokalnej mogą być chronione od wdrożenia na platformie Azure?</span><span class="sxs-lookup"><span data-stu-id="4f715-157">How can the on-premises networks be protected from deployments in Azure?</span></span>
* <span data-ttu-id="4f715-158">Podczas funkcje zabezpieczeń platformy Azure natywnego powinny być używane lub innych urządzeń lub usług?</span><span class="sxs-lookup"><span data-stu-id="4f715-158">When should native Azure security features be used versus third-party appliances or services?</span></span>

<span data-ttu-id="4f715-159">Na poniższym diagramie przedstawiono różnych warstw zabezpieczeń, które platforma Azure udostępnia klientom.</span><span class="sxs-lookup"><span data-stu-id="4f715-159">The following diagram shows various layers of security Azure provides to customers.</span></span> <span data-ttu-id="4f715-160">Te warstwy są natywne w platformą Azure i funkcje zdefiniowane przez klientów:</span><span class="sxs-lookup"><span data-stu-id="4f715-160">These layers are both native in the Azure platform itself and customer-defined features:</span></span>

<span data-ttu-id="4f715-161">![4]</span><span class="sxs-lookup"><span data-stu-id="4f715-161">![4]</span></span>

<span data-ttu-id="4f715-162">Przychodzące z Internetu, przed atakami DDoS Azure pomaga chronić przed atakami na dużą skalę przed Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-162">Inbound from the Internet, Azure DDoS helps protect against large-scale attacks against Azure.</span></span> <span data-ttu-id="4f715-163">Kolejna warstwa jest zdefiniowany przez klienta publicznych adresów IP (punkty końcowe), które są używane do ustalenia, jaki ruch mogą przechodzić do sieci wirtualnej usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="4f715-163">The next layer is customer-defined public IP addresses (endpoints), which are used to determine which traffic can pass through the cloud service to the virtual network.</span></span> <span data-ttu-id="4f715-164">Azure macierzystego wirtualnego izolacji sieci zapewnia pełnej izolacji od innych sieci i czy ruch przepływa tylko za pośrednictwem ścieżki użytkownika skonfigurowane i.</span><span class="sxs-lookup"><span data-stu-id="4f715-164">Native Azure virtual network isolation ensures complete isolation from all other networks and that traffic only flows through user configured paths and methods.</span></span> <span data-ttu-id="4f715-165">Tych ścieżek i metody są następnej warstwy, których grup NSG, przez i wirtualnych urządzeń sieciowych może służyć do tworzenia granic zabezpieczeń do wdrożenia aplikacji w sieci chronionej ochrony.</span><span class="sxs-lookup"><span data-stu-id="4f715-165">These paths and methods are the next layer, where NSGs, UDR, and network virtual appliances can be used to create security boundaries to protect the application deployments in the protected network.</span></span>

<span data-ttu-id="4f715-166">Następna sekcja zawiera omówienie sieci wirtualnych platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-166">The next section provides an overview of Azure virtual networks.</span></span> <span data-ttu-id="4f715-167">Te sieci wirtualne są tworzone przez klientów i są w ich wdrożonych obciążeń podłączonych do.</span><span class="sxs-lookup"><span data-stu-id="4f715-167">These virtual networks are created by customers, and are what their deployed workloads are connected to.</span></span> <span data-ttu-id="4f715-168">Sieci wirtualne są podstawy wszystkich sieci funkcje zabezpieczeń wymagane do ustanowienia sieci obwodowej, aby chronić wdrożenia klienta na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-168">Virtual networks are the basis of all the network security features required to establish a perimeter network to protect customer deployments in Azure.</span></span>

## <a name="overview-of-azure-virtual-networks"></a><span data-ttu-id="4f715-169">Omówienie sieci wirtualnych platformy Azure</span><span class="sxs-lookup"><span data-stu-id="4f715-169">Overview of Azure virtual networks</span></span>
<span data-ttu-id="4f715-170">Zanim ruch internetowy może uzyskać dostęp do sieci wirtualnych platformy Azure, istnieją dwie warstwy zabezpieczeń związane z platformą Azure:</span><span class="sxs-lookup"><span data-stu-id="4f715-170">Before Internet traffic can get to the Azure virtual networks, there are two layers of security inherent to the Azure platform:</span></span>

1.    <span data-ttu-id="4f715-171">**Ochrona przed atakami DDoS**: ochrona przed atakami DDoS to warstwa Azure sieci fizycznej, która chroni przed atakami na dużą skalę internetowego platformą Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-171">**DDoS protection**: DDoS protection is a layer of the Azure physical network that protects the Azure platform itself from large-scale Internet-based attacks.</span></span> <span data-ttu-id="4f715-172">Tego rodzaju ataki umożliwia wielu węzłów "bot" próbując przeciąży usługi internetowe.</span><span class="sxs-lookup"><span data-stu-id="4f715-172">These attacks use multiple “bot” nodes in an attempt to overwhelm an Internet service.</span></span> <span data-ttu-id="4f715-173">Platforma Azure ma niezawodne siatki ochrony przed atakami DDoS na wszystkie połączenia przychodzące, wychodzące i Azure między regionu.</span><span class="sxs-lookup"><span data-stu-id="4f715-173">Azure has a robust DDoS protection mesh on all inbound, outbound, and cross-Azure region connectivity.</span></span> <span data-ttu-id="4f715-174">Ta warstwa ochrony przed atakami DDoS nie ma żadnych atrybutów można konfigurować użytkowników i nie jest dostępna dla klienta.</span><span class="sxs-lookup"><span data-stu-id="4f715-174">This DDoS protection layer has no user configurable attributes and is not accessible to the customer.</span></span> <span data-ttu-id="4f715-175">Warstwę ochrony przed atakami DDoS chroni Azure jako platformę przed atakami na dużą skalę, również monitoruje ruchu wyjściowego powiązane i regionu Azure między ruchu.</span><span class="sxs-lookup"><span data-stu-id="4f715-175">The DDoS protection layer protects Azure as a platform from large-scale attacks, it also monitors out-bound traffic and cross-Azure region traffic.</span></span> <span data-ttu-id="4f715-176">Przy użyciu sieci wirtualnych urządzeń w sieci wirtualnej, dodatkowe warstwy odporności można skonfigurować klienta przed mniejszych ataki skalowania, które nie rzeczy przed wyjazdem ochrony na poziomie platformy.</span><span class="sxs-lookup"><span data-stu-id="4f715-176">Using network virtual appliances on the VNet, additional layers of resilience can be configured by the customer against a smaller scale attack that doesn't trip the platform level protection.</span></span> <span data-ttu-id="4f715-177">Przykład DDoS w akcji; Jeśli internetowy adres IP zaatakowany przez na dużą skalę ataków DDoS, Azure może wykryć źródeł ataków i wyczyść ataku ruchu przed osiągnięciem jego przeznaczenia.</span><span class="sxs-lookup"><span data-stu-id="4f715-177">An example of DDoS in action; if an internet facing IP address was attacked by a large-scale DDoS attack, Azure would detect the sources of the attacks and scrub the offending traffic before it reached its intended destination.</span></span> <span data-ttu-id="4f715-178">W większości przypadków zaatakowane punkt końcowy nie ma wpływu na atak.</span><span class="sxs-lookup"><span data-stu-id="4f715-178">In almost all cases, the attacked endpoint isn't affected by the attack.</span></span> <span data-ttu-id="4f715-179">W rzadkich przypadkach, że punkt końcowy ma wpływ żaden ruch ma wpływ na inne punkty końcowe, tylko zaatakowane punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="4f715-179">In the rare cases that an endpoint is affected, no traffic is affected to other endpoints, only the attacked endpoint.</span></span> <span data-ttu-id="4f715-180">W związku z tym innych klientów i usług zobaczy bez wpływu na tym ataki.</span><span class="sxs-lookup"><span data-stu-id="4f715-180">Thus other customers and services would see no impact from that attack.</span></span> <span data-ttu-id="4f715-181">Należy pamiętać tylko potrzebuje na dużą skalę ataków Azure DDoS.</span><span class="sxs-lookup"><span data-stu-id="4f715-181">It's critical to note that Azure DDoS is only looking for large-scale attacks.</span></span> <span data-ttu-id="4f715-182">Istnieje możliwość, że określone usługi można przeciążony przed przekroczenia progów ochrony na poziomie platformy.</span><span class="sxs-lookup"><span data-stu-id="4f715-182">It is possible that your specific service could be overwhelmed before the platform level protection thresholds are exceeded.</span></span> <span data-ttu-id="4f715-183">Na przykład witryny sieci web na jednym serwerze A0 IIS, można podjąć w trybie offline takiego ataku przed zagrożeniem platformy Azure poziom ochrony przed atakami DDoS.</span><span class="sxs-lookup"><span data-stu-id="4f715-183">For example, a web site on a single A0 IIS server, could be taken offline by a DDoS attack before Azure platform level DDoS protection registered a threat.</span></span>

2.  <span data-ttu-id="4f715-184">**Publiczne adresy IP**: publicznego adresu IP adresów (włączonych za pomocą punktów końcowych usługi, publiczny adres IP adresy bramy aplikacji i innych funkcji platformy Azure, które są dostępne do publicznego adresu IP z Internetem kierowane do zasobu) Zezwalaj usługi w chmurze lub zasobu grupy mają publiczne adresy Internet IP i portów.</span><span class="sxs-lookup"><span data-stu-id="4f715-184">**Public IP Addresses**: Public IP addresses (enabled via service endpoints, Public IP addresses, Application Gateway, and other Azure features that present a public IP address to the internet routed to your resource) allow cloud services or resource groups to have public Internet IP addresses and ports exposed.</span></span> <span data-ttu-id="4f715-185">Punkt końcowy używa translatora adresów sieciowych (NAT) do kierowania ruchem wewnętrzny adres i port na sieć wirtualna platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-185">The endpoint uses Network Address Translation (NAT) to route traffic to the internal address and port on the Azure virtual network.</span></span> <span data-ttu-id="4f715-186">Ta ścieżka jest podstawowy sposób dla zewnętrznego ruchu do przekazania do sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-186">This path is the primary way for external traffic to pass into the virtual network.</span></span> <span data-ttu-id="4f715-187">Publiczne adresy IP są konfigurowane w celu określenia, jaki ruch jest przekazywany w i jak i gdzie jest translacja do sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-187">The Public IP addresses are configurable to determine which traffic is passed in, and how and where it's translated on to the virtual network.</span></span>

<span data-ttu-id="4f715-188">Gdy ruch osiągnie sieci wirtualnej, istnieje wiele funkcji, które są dostarczane do odtwarzania.</span><span class="sxs-lookup"><span data-stu-id="4f715-188">Once traffic reaches the virtual network, there are many features that come into play.</span></span> <span data-ttu-id="4f715-189">Sieci wirtualne Azure są podstawę dla klientów dołączyć ich obciążeń i których dotyczy podstawowych zabezpieczeń na poziomie sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-189">Azure virtual networks are the foundation for customers to attach their workloads and where basic network-level security applies.</span></span> <span data-ttu-id="4f715-190">Sieci prywatnej (w nakładce sieci wirtualnej) jest na platformie Azure dla klientów o następujące funkcje i właściwości:</span><span class="sxs-lookup"><span data-stu-id="4f715-190">It is a private network (a virtual network overlay) in Azure for customers with the following features and characteristics:</span></span>

* <span data-ttu-id="4f715-191">**Izolacja ruchu**: sieć wirtualna jest granica izolacji ruchu na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-191">**Traffic isolation**: A virtual network is the traffic isolation boundary on the Azure platform.</span></span> <span data-ttu-id="4f715-192">Maszynach wirtualnych (VM) w jednej sieci wirtualnej nie może komunikować się bezpośrednio do maszyn wirtualnych w innej sieci wirtualnej, nawet jeśli obie sieci wirtualne są tworzone przez tego samego klienta.</span><span class="sxs-lookup"><span data-stu-id="4f715-192">Virtual machines (VMs) in one virtual network cannot communicate directly to VMs in a different virtual network, even if both virtual networks are created by the same customer.</span></span> <span data-ttu-id="4f715-193">Izolacja jest krytyczne właściwość, która zapewnia klienta maszyn wirtualnych i komunikacja pozostanie prywatnej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-193">Isolation is a critical property that ensures customer VMs and communication remains private within a virtual network.</span></span>

>[!NOTE]
><span data-ttu-id="4f715-194">Izolacja ruchu odnosi się tylko do ruchu *przychodzących* do sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-194">Traffic isolation refers only to traffic *inbound* to the virtual network.</span></span> <span data-ttu-id="4f715-195">Domyślnie ruch wychodzący z sieci wirtualnej z Internetem jest dozwolona, ale w razie potrzeby przez grupy NSG można zapobiec.</span><span class="sxs-lookup"><span data-stu-id="4f715-195">By default outbound traffic from the VNet to the internet is allowed, but can be prevented if desired by NSGs.</span></span>
>
>

* <span data-ttu-id="4f715-196">**Topologia wielowarstwowa**: sieci wirtualne umożliwiają klientom Definiowanie topologii wielowarstwowej przydzielając podsieci i wyznaczenie przestrzeni adresowych osobne dla różnych elementów lub "warstwy" ich obciążeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-196">**Multi-tier topology**: Virtual networks allow customers to define multi-tier topology by allocating subnets and designating separate address spaces for different elements or “tiers” of their workloads.</span></span> <span data-ttu-id="4f715-197">Tych grup logicznych i topologii umożliwiają klientom Definiowanie zasad dostępu różnych na podstawie typów obciążenia, a także kontrolować ruch między warstwami.</span><span class="sxs-lookup"><span data-stu-id="4f715-197">These logical groupings and topologies enable customers to define different access policy based on the workload types, and also control traffic flows between the tiers.</span></span>
* <span data-ttu-id="4f715-198">**Łączność między lokalizacjami**: klientów może nawiązać łączności między lokalizacjami między sieci wirtualnej i wieloma lokacjami lokalnymi lub innych sieci wirtualnych na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-198">**Cross-premises connectivity**: Customers can establish cross-premises connectivity between a virtual network and multiple on-premises sites or other virtual networks in Azure.</span></span> <span data-ttu-id="4f715-199">Do utworzenia połączenia, klienci mogą użyć sieci wirtualnej komunikacji równorzędnej, bram sieci VPN platformy Azure, wirtualnych urządzeń sieciowych innych firm lub ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4f715-199">To construct a connection, customers can use VNet Peering, Azure VPN Gateways, third-party network virtual appliances, or ExpressRoute.</span></span> <span data-ttu-id="4f715-200">Azure obsługuje za pomocą standardowych protokołów IPsec i IKE i prywatne połączenie ExpressRoute sieci VPN typu lokacja lokacja (S2S).</span><span class="sxs-lookup"><span data-stu-id="4f715-200">Azure supports site-to-site (S2S) VPNs using standard IPsec/IKE protocols and ExpressRoute private connectivity.</span></span>
* <span data-ttu-id="4f715-201">**Grupa NSG** umożliwia klientom tworzenie zasady (kontroli dostępu ACL) na żądanym poziomie szczegółowości: sieci interfejsy poszczególnych maszyn wirtualnych i podsieci wirtualne.</span><span class="sxs-lookup"><span data-stu-id="4f715-201">**NSG** allows customers to create rules (ACLs) at the desired level of granularity: network interfaces, individual VMs, or virtual subnets.</span></span> <span data-ttu-id="4f715-202">Klientów można kontrolować dostęp przez zezwalanie na dostęp lub odmawianie komunikacji między obciążeń w ramach sieci wirtualnej, od systemów w sieci klienta za pośrednictwem łączności między lokalizacjami lub bezpośrednia komunikacja z Internetem.</span><span class="sxs-lookup"><span data-stu-id="4f715-202">Customers can control access by permitting or denying communication between the workloads within a virtual network, from systems on customer’s networks via cross-premises connectivity, or direct Internet communication.</span></span>
* <span data-ttu-id="4f715-203">**PRZEZ** i **przesyłania dalej protokołu IP** umożliwiają klientom Definiowanie ścieżki komunikacji między warstwami innej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-203">**UDR** and **IP Forwarding** allow customers to define the communication paths between different tiers within a virtual network.</span></span> <span data-ttu-id="4f715-204">Klienci mogą wdrażać zaporą, Identyfikatory/adresów IP i inne urządzenia wirtualnego oraz kierować ruchem sieciowym za pomocą tych urządzeń zabezpieczeń do wymuszania zasad granic zabezpieczeń, inspekcji i inspekcji.</span><span class="sxs-lookup"><span data-stu-id="4f715-204">Customers can deploy a firewall, IDS/IPS, and other virtual appliances, and route network traffic through these security appliances for security boundary policy enforcement, auditing, and inspection.</span></span>
* <span data-ttu-id="4f715-205">**Sieci wirtualnych urządzeń** w portalu Azure Marketplace: urządzenia zabezpieczeń, takie jak zapory, moduły równoważenia obciążenia i Identyfikatory/adresów IP są dostępne w portalu Azure Marketplace i Galeria obrazów maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-205">**Network virtual appliances** in the Azure Marketplace: Security appliances such as firewalls, load balancers, and IDS/IPS are available in the Azure Marketplace and the VM Image Gallery.</span></span> <span data-ttu-id="4f715-206">Klienci mogą wdrożyć te urządzenia w sieciach wirtualnych, a w szczególności na ich granic zabezpieczeń (w tym podsieci sieci obwodowej) do ukończenia bezpiecznym środowisku wielowarstwowych sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-206">Customers can deploy these appliances into their virtual networks, and specifically, at their security boundaries (including the perimeter network subnets) to complete a multi-tiered secure network environment.</span></span>

<span data-ttu-id="4f715-207">Z tych funkcji i możliwości przykładem sposobu architektury sieci obwodowej mogła zostać zbudowana na platformie Azure jest poniższym diagramie:</span><span class="sxs-lookup"><span data-stu-id="4f715-207">With these features and capabilities, one example of how a perimeter network architecture could be constructed in Azure is the following diagram:</span></span>

<span data-ttu-id="4f715-208">![5]</span><span class="sxs-lookup"><span data-stu-id="4f715-208">![5]</span></span>

## <a name="perimeter-network-characteristics-and-requirements"></a><span data-ttu-id="4f715-209">Właściwości sieci obwodowej i wymagania</span><span class="sxs-lookup"><span data-stu-id="4f715-209">Perimeter network characteristics and requirements</span></span>
<span data-ttu-id="4f715-210">Sieci obwodowej jest to fronton sieci bezpośrednio relacje komunikacji z Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-210">The perimeter network is the front end of the network, directly interfacing communication from the Internet.</span></span> <span data-ttu-id="4f715-211">Pakiety przychodzące powinny przepływać przez urządzenia zabezpieczeń, takie jak zapory, Identyfikatory oraz adresów IP, zanim dotrze do serwerów zaplecza.</span><span class="sxs-lookup"><span data-stu-id="4f715-211">The incoming packets should flow through the security appliances, such as the firewall, IDS, and IPS, before reaching the back-end servers.</span></span> <span data-ttu-id="4f715-212">Pakiety powiązane z Internetu od obciążeń można również przepływać przez urządzenia zabezpieczeń w sieci obwodowej do wymuszania zasad inspekcji i celów inspekcji przed opuszczeniem sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-212">Internet-bound packets from the workloads can also flow through the security appliances in the perimeter network for policy enforcement, inspection, and auditing purposes, before leaving the network.</span></span> <span data-ttu-id="4f715-213">Ponadto sieci obwodowej może obsługiwać bramy sieci VPN między lokalizacjami między sieci wirtualne klienta i sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-213">Additionally, the perimeter network can host cross-premises VPN gateways between customer virtual networks and on-premises networks.</span></span>

### <a name="perimeter-network-characteristics"></a><span data-ttu-id="4f715-214">Właściwości sieci obwodowej</span><span class="sxs-lookup"><span data-stu-id="4f715-214">Perimeter network characteristics</span></span>
<span data-ttu-id="4f715-215">Tworzenie odwołań na poprzedniej ilustracji, niektóre właściwości sieci obwodowej dobrej są następujące:</span><span class="sxs-lookup"><span data-stu-id="4f715-215">Referencing the previous figure, some of the characteristics of a good perimeter network are as follows:</span></span>

* <span data-ttu-id="4f715-216">Internetowy:</span><span class="sxs-lookup"><span data-stu-id="4f715-216">Internet-facing:</span></span>
  * <span data-ttu-id="4f715-217">Samej podsieci sieci obwodowej jest skierowane do Internetu, bezpośrednio komunikacji z Internetem.</span><span class="sxs-lookup"><span data-stu-id="4f715-217">The perimeter network subnet itself is Internet-facing, directly communicating with the Internet.</span></span>
  * <span data-ttu-id="4f715-218">Publiczne adresy IP, adresy VIP i/lub punktów końcowych usługi przekazać ruch internetowy do sieci frontonu i urządzeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-218">Public IP addresses, VIPs, and/or service endpoints pass Internet traffic to the front-end network and devices.</span></span>
  * <span data-ttu-id="4f715-219">Ruch przychodzący z Internetu przechodzi przez urządzenia zabezpieczeń przed innymi zasobami w sieci frontonu.</span><span class="sxs-lookup"><span data-stu-id="4f715-219">Inbound traffic from the Internet passes through security devices before other resources on the front-end network.</span></span>
  * <span data-ttu-id="4f715-220">Włączenie zabezpieczeń dla ruchu wychodzącego ruchu przechodzi przez urządzeń zabezpieczeń, co stanowi ostatni krok przed przekazaniem do Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-220">If outbound security is enabled, traffic passes through security devices, as the final step, before passing to the Internet.</span></span>
* <span data-ttu-id="4f715-221">Sieć chroniona:</span><span class="sxs-lookup"><span data-stu-id="4f715-221">Protected network:</span></span>
  * <span data-ttu-id="4f715-222">Brak bezpośrednią ścieżkę z Internetu do podstawowej infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="4f715-222">There is no direct path from the Internet to the core infrastructure.</span></span>
  * <span data-ttu-id="4f715-223">Kanały w infrastrukturze podstawowej muszą przejść za pomocą urządzeń zabezpieczeń, takich jak grupy NSG, zapory lub urządzenia sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="4f715-223">Channels to the core infrastructure must traverse through security devices such as NSGs, firewalls, or VPN devices.</span></span>
  * <span data-ttu-id="4f715-224">Inne urządzenia nie musi zestawiania Internet i infrastrukturze podstawowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-224">Other devices must not bridge Internet and the core infrastructure.</span></span>
  * <span data-ttu-id="4f715-225">Urządzenia zabezpieczeń na skierowane do Internetu i sieci chronionego ukierunkowane granic sieci obwodowej (na przykład dwa zapory ikony na poprzedniej ilustracji) może być faktycznie pojedynczego urządzenia wirtualnego przy użyciu reguł zróżnicowanych lub interfejsów dla każdej granicy.</span><span class="sxs-lookup"><span data-stu-id="4f715-225">Security devices on both the Internet-facing and the protected network facing boundaries of the perimeter network (for example, the two firewall icons shown in the previous figure) may actually be a single virtual appliance with differentiated rules or interfaces for each boundary.</span></span> <span data-ttu-id="4f715-226">Na przykład jeden urządzenie fizyczne, logicznie rozdzielone, obsługi obciążenia dla obu granic sieci obwodowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-226">For example, one physical device, logically separated, handling the load for both boundaries of the perimeter network.</span></span>
* <span data-ttu-id="4f715-227">Inne typowe wskazówki i ograniczenia:</span><span class="sxs-lookup"><span data-stu-id="4f715-227">Other common practices and constraints:</span></span>
  * <span data-ttu-id="4f715-228">Obciążeń nie mogą przechowywać newralgicznych danych biznesowych.</span><span class="sxs-lookup"><span data-stu-id="4f715-228">Workloads must not store business critical information.</span></span>
  * <span data-ttu-id="4f715-229">Aktualizacje konfiguracji sieci obwodowej i wdrożeń i dostępu są ograniczone do tylko autoryzowani administratorzy.</span><span class="sxs-lookup"><span data-stu-id="4f715-229">Access and updates to perimeter network configurations and deployments are limited to only authorized administrators.</span></span>

### <a name="perimeter-network-requirements"></a><span data-ttu-id="4f715-230">Wymagania dotyczące sieci obwodowej</span><span class="sxs-lookup"><span data-stu-id="4f715-230">Perimeter network requirements</span></span>
<span data-ttu-id="4f715-231">Aby włączyć tę charakterystykę, zgodna z tymi wytycznymi na wymagania dotyczące sieci wirtualnej do zaimplementowania sieci obwodowej powiodło się:</span><span class="sxs-lookup"><span data-stu-id="4f715-231">To enable these characteristics, follow these guidelines on virtual network requirements to implement a successful perimeter network:</span></span>

* <span data-ttu-id="4f715-232">**Architektura podsieci:** Określ sieć wirtualną tak, aby w całej podsieci dedykowanego jako sieci obwodowej, oddzielona od innych podsieci w tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-232">**Subnet architecture:** Specify the virtual network such that an entire subnet is dedicated as the perimeter network, separated from other subnets in the same virtual network.</span></span> <span data-ttu-id="4f715-233">Ta separacja zapewnia ruchem między siecią obwodową i innych przepływów warstw wewnętrznego lub prywatnego podsieci za pośrednictwem zapory lub urządzenia wirtualnego Identyfikatory/adresów IP.</span><span class="sxs-lookup"><span data-stu-id="4f715-233">This separation ensures the traffic between the perimeter network and other internal or private subnet tiers flows through a firewall or IDS/IPS virtual appliance.</span></span>  <span data-ttu-id="4f715-234">Trasy zdefiniowane przez użytkownika w podsieciach granic są wymagane do przesyłania tego ruchu do urządzenia wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="4f715-234">User-defined routes on the boundary subnets are required to forward this traffic to the virtual appliance.</span></span>
* <span data-ttu-id="4f715-235">**Grupa NSG:** samej podsieci sieci obwodowej powinno być otwarte, aby umożliwić komunikację z Internetem, ale nie oznacza klientów należy pomijanie grup NSG.</span><span class="sxs-lookup"><span data-stu-id="4f715-235">**NSG:** The perimeter network subnet itself should be open to allow communication with the Internet, but that does not mean customers should be bypassing NSGs.</span></span> <span data-ttu-id="4f715-236">Wykonaj typowe wskazówki dotyczące zabezpieczeń, aby zminimalizować powierzchni sieci, połączenie z Internetem.</span><span class="sxs-lookup"><span data-stu-id="4f715-236">Follow common security practices to minimize the network surfaces exposed to the Internet.</span></span> <span data-ttu-id="4f715-237">Zablokowanie zakresów adresów zdalnych dozwolony dostęp do wdrożeń lub określonej aplikacji protokoły i porty, które są otwarte.</span><span class="sxs-lookup"><span data-stu-id="4f715-237">Lock down the remote address ranges allowed to access the deployments or the specific application protocols and ports that are open.</span></span> <span data-ttu-id="4f715-238">Może to być sytuacji, w których pełną blokowanie nie jest możliwe.</span><span class="sxs-lookup"><span data-stu-id="4f715-238">There may be circumstances, however, in which a complete lock-down is not possible.</span></span> <span data-ttu-id="4f715-239">Na przykład, jeśli klienci mają zewnętrznej witryny sieci Web na platformie Azure, sieci obwodowej powinna zezwalać na przychodzące żądania sieci web z publicznych adresów IP, ale należy otwierać tylko porty aplikacji sieci web: ruch TCP na porcie 80 i/lub TCP na porcie 443.</span><span class="sxs-lookup"><span data-stu-id="4f715-239">For example, if customers have an external website in Azure, the perimeter network should allow the incoming web requests from any public IP addresses, but should only open the web application ports: TCP on port 80 and/or TCP on port 443.</span></span>
* <span data-ttu-id="4f715-240">**Tabela routingu:** samej podsieci sieci obwodowej mogła komunikować się bezpośrednio z Internetem, ale nie należy zezwalać bezpośrednia komunikacja do i z tyłu zakończenia lub lokalnej sieci bez przechodzenia przez zaporę lub zabezpieczeń urządzenia.</span><span class="sxs-lookup"><span data-stu-id="4f715-240">**Routing table:** The perimeter network subnet itself should be able to communicate to the Internet directly, but should not allow direct communication to and from the back end or on-premises networks without going through a firewall or security appliance.</span></span>
* <span data-ttu-id="4f715-241">**Konfiguracja urządzenia zabezpieczeń:** do routingu i inspekcję pakietów między siecią obwodową i pozostałej części chronionej sieci, urządzenia zabezpieczeń, takie jak zapory, Identyfikatory, i adresy IP urządzeń mogą być wieloadresowych.</span><span class="sxs-lookup"><span data-stu-id="4f715-241">**Security appliance configuration:** To route and inspect packets between the perimeter network and the rest of the protected networks, the security appliances such as firewall, IDS, and IPS devices may be multi-homed.</span></span> <span data-ttu-id="4f715-242">Mogą mieć oddzielnych kart sieciowych dla sieci obwodowej i podsieci wewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="4f715-242">They may have separate NICs for the perimeter network and the back-end subnets.</span></span> <span data-ttu-id="4f715-243">Karty sieciowe w sieci obwodowej komunikują się bezpośrednio do i z Internetu, z odpowiednich grup NSG i tabelę routingu w sieci obwodowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-243">The NICs in the perimeter network communicate directly to and from the Internet, with the corresponding NSGs and the perimeter network routing table.</span></span> <span data-ttu-id="4f715-244">Karty sieciowe, nawiązywanie połączeń z podsieciami zaplecza więcej ograniczonym grup NSG i tabelach routingu odpowiednie podsieci wewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="4f715-244">The NICs connecting to the back-end subnets have more restricted NSGs and routing tables of the corresponding back-end subnets.</span></span>
* <span data-ttu-id="4f715-245">**Funkcje urządzenia zabezpieczeń:** urządzenia zabezpieczeń wdrożonego w sieci obwodowej zwykle wykonać następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="4f715-245">**Security appliance functionality:** The security appliances deployed in the perimeter network typically perform the following functionality:</span></span>
  * <span data-ttu-id="4f715-246">Zapora: Wymuszania reguł zapory lub zasady kontroli dostępu dla żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="4f715-246">Firewall: Enforcing firewall rules or access control policies for the incoming requests.</span></span>
  * <span data-ttu-id="4f715-247">Zagrożenia i zapobiegania: wykrywanie i zmniejszenia złośliwych ataków z Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-247">Threat detection and prevention: Detecting and mitigating malicious attacks from the Internet.</span></span>
  * <span data-ttu-id="4f715-248">Inspekcja i rejestrowanie: Obsługa szczegółowe dzienniki inspekcji i analizy.</span><span class="sxs-lookup"><span data-stu-id="4f715-248">Auditing and logging: Maintaining detailed logs for auditing and analysis.</span></span>
  * <span data-ttu-id="4f715-249">Odwrotny serwer proxy: przekierowywanie żądań przychodzących do odpowiednich serwerów zaplecza.</span><span class="sxs-lookup"><span data-stu-id="4f715-249">Reverse proxy: Redirecting the incoming requests to the corresponding back-end servers.</span></span> <span data-ttu-id="4f715-250">Przekierowanie obejmuje mapowania i zwykle translacji adresów docelowych na urządzeniach z frontonu zapory na adresy serwerów zaplecza.</span><span class="sxs-lookup"><span data-stu-id="4f715-250">This redirection involves mapping and translating the destination addresses on the front-end devices, typically firewalls, to the back-end server addresses.</span></span>
  * <span data-ttu-id="4f715-251">Przekazuj serwera proxy: zapewnianie NAT i przeprowadzania inspekcji dla komunikacji inicjowane przy użyciu sieci wirtualnej z Internetem.</span><span class="sxs-lookup"><span data-stu-id="4f715-251">Forward proxy: Providing NAT and performing auditing for communication initiated from within the virtual network to the Internet.</span></span>
  * <span data-ttu-id="4f715-252">Router: Przesyłania ruchu przychodzącego i różnych podsieci w sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-252">Router: Forwarding incoming and cross-subnet traffic inside the virtual network.</span></span>
  * <span data-ttu-id="4f715-253">Urządzenia sieci VPN: działający jako bramy sieci VPN między lokalizacjami dla połączenia sieci VPN między lokalizacjami między sieciami lokalnymi klientów i sieci wirtualnych platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-253">VPN device: Acting as the cross-premises VPN gateways for cross-premises VPN connectivity between customer on-premises networks and Azure virtual networks.</span></span>
  * <span data-ttu-id="4f715-254">Serwer sieci VPN: akceptowanie klientów sieci VPN nawiązywania połączenia z sieciami wirtualnymi platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-254">VPN server: Accepting VPN clients connecting to Azure virtual networks.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-255">Zachowaj oddzielne następujących dwóch grup: osób autoryzowany dostęp do narzędzi zabezpieczeń sieci obwodowej i osoby autoryzowane jako administratorzy programowanie, wdrożenia i działania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-255">Keep the following two groups separate: the individuals authorized to access the perimeter network security gear and the individuals authorized as application development, deployment, or operations administrators.</span></span> <span data-ttu-id="4f715-256">Oddzieleniu tych grup umożliwia podział obowiązków i uniemożliwia jedna osoba z pominięciem aplikacji, zabezpieczeń i kontroli zabezpieczeń sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-256">Keeping these groups separate allows for a segregation of duties and prevents a single person from bypassing both applications security and network security controls.</span></span>
>
>

### <a name="questions-to-be-asked-when-building-network-boundaries"></a><span data-ttu-id="4f715-257">Pytania pojawi się pytanie, podczas tworzenia granic sieci</span><span class="sxs-lookup"><span data-stu-id="4f715-257">Questions to be asked when building network boundaries</span></span>
<span data-ttu-id="4f715-258">W tej sekcji chyba że wyraźnie wymienionych termin "sieci" odwołuje się do prywatnej sieci wirtualnych platformy Azure utworzonych przez administratora subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="4f715-258">In this section, unless specifically mentioned, the term "networks" refers to private Azure virtual networks created by a subscription administrator.</span></span> <span data-ttu-id="4f715-259">Termin nie odwołuje się do podstawowej sieci fizycznej w obrębie platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-259">The term doesn't refer to the underlying physical networks within Azure.</span></span>

<span data-ttu-id="4f715-260">Ponadto sieci wirtualnych platformy Azure są często używane do rozszerzania sieci tradycyjnych, lokalnie.</span><span class="sxs-lookup"><span data-stu-id="4f715-260">Also, Azure virtual networks are often used to extend traditional on-premises networks.</span></span> <span data-ttu-id="4f715-261">Istnieje możliwość uwzględnienia lokacja lokacja lub ExpressRoute hybrydowych rozwiązań sieciowych z architektury sieci obwodowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-261">It is possible to incorporate either site-to-site or ExpressRoute hybrid networking solutions with perimeter network architectures.</span></span> <span data-ttu-id="4f715-262">To łącze hybrydowego jest ważną kwestią tworzenia granic zabezpieczeń sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-262">This hybrid link is an important consideration in building network security boundaries.</span></span>

<span data-ttu-id="4f715-263">Następujące trzy pytania są krytyczne odpowiadać, gdy tworzysz sieci z siecią obwodową a wielu granic zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-263">The following three questions are critical to answer when you're building a network with a perimeter network and multiple security boundaries.</span></span>

#### <a name="1-how-many-boundaries-are-needed"></a><span data-ttu-id="4f715-264">1) ile granice są potrzebne?</span><span class="sxs-lookup"><span data-stu-id="4f715-264">1) How many boundaries are needed?</span></span>
<span data-ttu-id="4f715-265">Pierwszy punkt decyzji jest decyzji o tym, jak wiele granic zabezpieczeń są potrzebne w danej sytuacji:</span><span class="sxs-lookup"><span data-stu-id="4f715-265">The first decision point is to decide how many security boundaries are needed in a given scenario:</span></span>

* <span data-ttu-id="4f715-266">Pojedyncza granica: w sieci obwodowej frontonu sieci wirtualnej od Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-266">A single boundary: One on the front-end perimeter network, between the virtual network and the Internet.</span></span>
* <span data-ttu-id="4f715-267">Granice dwóch: jeden po stronie Internetu sieci obwodowej, a drugi między podsieci sieci obwodowej i podsieci zaplecza w sieci wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-267">Two boundaries: One on the Internet side of the perimeter network, and another between the perimeter network subnet and the back-end subnets in the Azure virtual networks.</span></span>
* <span data-ttu-id="4f715-268">Trzy granice: na stronie Internetu w sieci obwodowej, między siecią obwodową a podsieci wewnętrznej, a drugi między podsieciami zaplecza i sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-268">Three boundaries: One on the Internet side of the perimeter network, one between the perimeter network and back-end subnets, and one between the back-end subnets and the on-premises network.</span></span>
* <span data-ttu-id="4f715-269">Granice N: Numer zmiennej.</span><span class="sxs-lookup"><span data-stu-id="4f715-269">N boundaries: A variable number.</span></span> <span data-ttu-id="4f715-270">W zależności od wymagań dotyczących zabezpieczeń jest nieograniczona liczba granic zabezpieczeń, które mogą być stosowane w danej sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-270">Depending on security requirements, there is no limit to the number of security boundaries that can be applied in a given network.</span></span>

<span data-ttu-id="4f715-271">Liczba i typ potrzebne różnią się granic na podstawie tolerancji ryzyka firmy i danego scenariusza implementowana.</span><span class="sxs-lookup"><span data-stu-id="4f715-271">The number and type of boundaries needed vary based on a company’s risk tolerance and the specific scenario being implemented.</span></span> <span data-ttu-id="4f715-272">Ta decyzja często staje się wraz z wielu grup w organizacji, często tym zespół ryzyka i zgodności, sieć i zespołu platformy i zespół deweloperów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-272">This decision is often made together with multiple groups within an organization, often including a risk and compliance team, a network and platform team, and an application development team.</span></span> <span data-ttu-id="4f715-273">Osobom wiedzę na temat zabezpieczeń, dane związane i technologie używane powinny mieć powiedzieć w tej decyzji w celu zapewnienia zasobów odpowiednich ustawień zabezpieczeń dla poszczególnych implementacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-273">People with knowledge of security, the data involved, and the technologies being used should have a say in this decision to ensure the appropriate security stance for each implementation.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-274">Użyj najmniejszą liczbę granice, które spełniają wymagania dotyczące zabezpieczeń w danej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-274">Use the smallest number of boundaries that satisfy the security requirements for a given situation.</span></span> <span data-ttu-id="4f715-275">Z granice więcej operacji i rozwiązywanie problemów może być trudniejsze, a także zarządzania obciążenie związane z zarządzaniem wiele zasad granic wraz z upływem czasu.</span><span class="sxs-lookup"><span data-stu-id="4f715-275">With more boundaries, operations and troubleshooting can be more difficult, as well as the management overhead involved with managing the multiple boundary policies over time.</span></span> <span data-ttu-id="4f715-276">Jednak za mało granic zwiększenie ryzyka.</span><span class="sxs-lookup"><span data-stu-id="4f715-276">However, insufficient boundaries increase risk.</span></span> <span data-ttu-id="4f715-277">Znajdowanie saldo jest krytyczna.</span><span class="sxs-lookup"><span data-stu-id="4f715-277">Finding the balance is critical.</span></span>
>
>

<span data-ttu-id="4f715-278">![6]</span><span class="sxs-lookup"><span data-stu-id="4f715-278">![6]</span></span>

<span data-ttu-id="4f715-279">Powyższej ilustracji przedstawiono ogólny widok sieci granicznej zabezpieczeń trzy.</span><span class="sxs-lookup"><span data-stu-id="4f715-279">The preceding figure shows a high-level view of a three security boundary network.</span></span> <span data-ttu-id="4f715-280">Granice należą do zakresu od sieci obwodowej i Internetu, Azure frontonu i zaplecza prywatne podsieci i podsieci wewnętrznej platformy Azure i lokalnymi sieci firmowej.</span><span class="sxs-lookup"><span data-stu-id="4f715-280">The boundaries are between the perimeter network and the Internet, the Azure front-end and back-end private subnets, and the Azure back-end subnet and the on-premises corporate network.</span></span>

#### <a name="2-where-are-the-boundaries-located"></a><span data-ttu-id="4f715-281">2) granice lokalizację?</span><span class="sxs-lookup"><span data-stu-id="4f715-281">2) Where are the boundaries located?</span></span>
<span data-ttu-id="4f715-282">Liczba granic są decyzję, gdzie ich wdrażania po następnym podjęcie decyzji.</span><span class="sxs-lookup"><span data-stu-id="4f715-282">Once the number of boundaries are decided, where to implement them is the next decision point.</span></span> <span data-ttu-id="4f715-283">Zazwyczaj są trzy opcje:</span><span class="sxs-lookup"><span data-stu-id="4f715-283">There are generally three choices:</span></span>

* <span data-ttu-id="4f715-284">Przy użyciu Internetowych usług pośredniczących (na przykład oparte na chmurze Zapora aplikacji sieci Web, który nie został omówiony w niniejszym dokumencie)</span><span class="sxs-lookup"><span data-stu-id="4f715-284">Using an Internet-based intermediary service (for example, a cloud-based Web application firewall, which is not discussed in this document)</span></span>
* <span data-ttu-id="4f715-285">Przy użyciu funkcji macierzystego i/lub wirtualnych urządzeń sieciowych na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="4f715-285">Using native features and/or network virtual appliances in Azure</span></span>
* <span data-ttu-id="4f715-286">Za pomocą urządzeń fizycznych w sieci lokalnej</span><span class="sxs-lookup"><span data-stu-id="4f715-286">Using physical devices on the on-premises network</span></span>

<span data-ttu-id="4f715-287">W sieciach czysto Azure opcje są natywnego funkcje platformy Azure (na przykład równoważenia obciążenia Azure) lub wirtualnych urządzeń sieciowych z ekosystemem partnerów sformatowanego platformy Azure (na przykład zapory Check Point).</span><span class="sxs-lookup"><span data-stu-id="4f715-287">On purely Azure networks, the options are native Azure features (for example, Azure Load Balancers) or network virtual appliances from the rich partner ecosystem of Azure (for example, Check Point firewalls).</span></span>

<span data-ttu-id="4f715-288">Jeśli granica jest potrzebny platformy Azure i siecią lokalną, urządzenia zabezpieczeń może znajdować się po obu stronach połączenia (lub obu stronach).</span><span class="sxs-lookup"><span data-stu-id="4f715-288">If a boundary is needed between Azure and an on-premises network, the security devices can reside on either side of the connection (or both sides).</span></span> <span data-ttu-id="4f715-289">W związku z tym decyzji muszą być wprowadzane w lokalizacji do umieszczenia koło zębate zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-289">Thus a decision must be made on the location to place security gear.</span></span>

<span data-ttu-id="4f715-290">Na poprzedniej ilustracji sieci Internet granicznej granice przodu do tyłu zakończenia całkowicie znajdują się w obrębie platformy Azure i musi być natywnego funkcje platformy Azure lub sieci wirtualnych urządzeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-290">In the previous figure, the Internet-to-perimeter network and the front-to-back-end boundaries are entirely contained within Azure, and must be either native Azure features or network virtual appliances.</span></span> <span data-ttu-id="4f715-291">Urządzenia zabezpieczeń w granicach platformy Azure (podsieci zaplecza) i sieci firmowej można Azure po stronie lub stronie lokalnymi lub nawet kombinację urządzeń po obu stronach.</span><span class="sxs-lookup"><span data-stu-id="4f715-291">Security devices on the boundary between Azure (back-end subnet) and the corporate network could be either on the Azure side or the on-premises side, or even a combination of devices on both sides.</span></span> <span data-ttu-id="4f715-292">Może to być istotne zalety i wady do obu opcji, które należy rozważyć poważnie.</span><span class="sxs-lookup"><span data-stu-id="4f715-292">There can be significant advantages and disadvantages to either option that must be seriously considered.</span></span>

<span data-ttu-id="4f715-293">Na przykład przy użyciu istniejącego sprzętu fizycznego zabezpieczeń po stronie sieci lokalnej ma tę zaletę, że niezbędna jest żadnych nowych narzędzi.</span><span class="sxs-lookup"><span data-stu-id="4f715-293">For example, using existing physical security gear on the on-premises network side has the advantage that no new gear is needed.</span></span> <span data-ttu-id="4f715-294">Wystarczy ponownej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="4f715-294">It just needs reconfiguration.</span></span> <span data-ttu-id="4f715-295">Jednak wadą jest to, że cały ruch musi wrócić z platformy Azure do sieci lokalnej, aby była widoczna narzędzi zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-295">The disadvantage, however, is that all traffic must come back from Azure to the on-premises network to be seen by the security gear.</span></span> <span data-ttu-id="4f715-296">W związku z tym ruchu Azure do platformy Azure może pociągnąć za sobą znaczne opóźnienia i wpłynąć na wydajność aplikacji i środowisko, jeśli była powrotem wymuszenie sieci lokalnej w celu wymuszenia zasad zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-296">Thus Azure-to-Azure traffic could incur significant latency, and affect application performance and user experience, if it was forced back to the on-premises network for security policy enforcement.</span></span>

#### <a name="3-how-are-the-boundaries-implemented"></a><span data-ttu-id="4f715-297">3) granice implementowania?</span><span class="sxs-lookup"><span data-stu-id="4f715-297">3) How are the boundaries implemented?</span></span>
<span data-ttu-id="4f715-298">Każdej granicy zabezpieczeń najprawdopodobniej będzie miała wymagania różne możliwości (na przykład identyfikatorów i reguły zapory po stronie Internetu sieci obwodowej, ale tylko listy ACL między siecią obwodową a podsieci wewnętrznej).</span><span class="sxs-lookup"><span data-stu-id="4f715-298">Each security boundary will likely have different capability requirements (for example, IDS and firewall rules on the Internet side of the perimeter network, but only ACLs between the perimeter network and back-end subnet).</span></span> <span data-ttu-id="4f715-299">Przy wyborze, na którym urządzenie (lub urządzenia, ile) do użycia zależy od wymagań scenariusza i zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-299">Deciding on which device (or how many devices) to use depends on the scenario and security requirements.</span></span> <span data-ttu-id="4f715-300">W poniższej sekcji Przykłady 1, 2 i 3 omówiono niektóre opcje, które mogłyby zostać użyte.</span><span class="sxs-lookup"><span data-stu-id="4f715-300">In the following section, examples 1, 2, and 3 discuss some options that could be used.</span></span> <span data-ttu-id="4f715-301">Przegląd funkcji natywnego sieć platformy Azure i dostępnej na platformie Azure z ekosystemem partnerów urządzeń zawiera wiele opcji do rozwiązania praktycznie dowolne scenariusza.</span><span class="sxs-lookup"><span data-stu-id="4f715-301">Reviewing the Azure native network features and the devices available in Azure from the partner ecosystem shows the myriad options available to solve virtually any scenario.</span></span>

<span data-ttu-id="4f715-302">Inną kwestią implementacji klucza jest sposób nawiązywania połączenia z siecią lokalną przy użyciu platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-302">Another key implementation decision point is how to connect the on-premises network with Azure.</span></span> <span data-ttu-id="4f715-303">Należy użyć Azure wirtualnej bramy lub urządzenie wirtualne sieci?</span><span class="sxs-lookup"><span data-stu-id="4f715-303">Should you use the Azure virtual gateway or a network virtual appliance?</span></span> <span data-ttu-id="4f715-304">Te opcje omówiono bardziej szczegółowo w następnej sekcji (przykłady 4, 5 i 6).</span><span class="sxs-lookup"><span data-stu-id="4f715-304">These options are discussed in greater detail in the following section (examples 4, 5, and 6).</span></span>

<span data-ttu-id="4f715-305">Ponadto ruchu między sieciami wirtualnymi w obrębie platformy Azure mogą być wymagane.</span><span class="sxs-lookup"><span data-stu-id="4f715-305">Additionally, traffic between virtual networks within Azure may be needed.</span></span> <span data-ttu-id="4f715-306">Te scenariusze zostaną dodane w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="4f715-306">These scenarios will be added in the future.</span></span>

<span data-ttu-id="4f715-307">Jeśli znasz już odpowiedzi na pytania Wstecz [szybkiego startu](#fast-start) sekcji mogą ułatwić identyfikację, przykłady, które są najbardziej odpowiednie dla danego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="4f715-307">Once you know the answers to the previous questions, the [Fast Start](#fast-start) section can help identify which examples are most appropriate for a given scenario.</span></span>

## <a name="examples-building-security-boundaries-with-azure-virtual-networks"></a><span data-ttu-id="4f715-308">Przykłady: Tworzenie granic zabezpieczeń z sieci wirtualnych platformy Azure</span><span class="sxs-lookup"><span data-stu-id="4f715-308">Examples: Building security boundaries with Azure virtual networks</span></span>
### <a name="example-1-build-a-perimeter-network-to-help-protect-applications-with-nsgs"></a><span data-ttu-id="4f715-309">Przykład 1 kompilacji sieci obwodowej, aby pomóc w ochronie aplikacji za pomocą grup NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-309">Example 1 Build a perimeter network to help protect applications with NSGs</span></span>
<span data-ttu-id="4f715-310">[Powrót do szybki start](#fast-start) | [szczegółowy kompilacji instrukcje w tym przykładzie][Example1]</span><span class="sxs-lookup"><span data-stu-id="4f715-310">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example1]</span></span>

<span data-ttu-id="4f715-311">[![7]][7]</span><span class="sxs-lookup"><span data-stu-id="4f715-311">[![7]][7]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-312">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-312">Environment description</span></span>
<span data-ttu-id="4f715-313">W tym przykładzie jest subskrypcji, która zawiera następujące zasoby:</span><span class="sxs-lookup"><span data-stu-id="4f715-313">In this example, there is a subscription that contains the following resources:</span></span>

- <span data-ttu-id="4f715-314">Pojedyncza grupa zasobów</span><span class="sxs-lookup"><span data-stu-id="4f715-314">A single resource group</span></span>
- <span data-ttu-id="4f715-315">Sieć wirtualną z dwiema podsieciami: "FrontEnd" i "Wewnętrzna"</span><span class="sxs-lookup"><span data-stu-id="4f715-315">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
- <span data-ttu-id="4f715-316">Grupy zabezpieczeń sieci jest stosowany do obu podsieci</span><span class="sxs-lookup"><span data-stu-id="4f715-316">A Network Security Group that is applied to both subnets</span></span>
- <span data-ttu-id="4f715-317">Windows server, który reprezentuje serwer sieci web aplikacji ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-317">A Windows server that represents an application web server (“IIS01”)</span></span>
- <span data-ttu-id="4f715-318">Dwa serwery systemu Windows, które reprezentują serwery zaplecza aplikacji ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="4f715-318">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
- <span data-ttu-id="4f715-319">Windows server, który reprezentuje serwer DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-319">A Windows server that represents a DNS server (“DNS01”)</span></span>
- <span data-ttu-id="4f715-320">Publicznego adresu IP skojarzonego z serwerem sieci web aplikacji</span><span class="sxs-lookup"><span data-stu-id="4f715-320">A public IP associated with the application web server</span></span>

<span data-ttu-id="4f715-321">Skrypty i szablonu usługi Azure Resource Manager, zobacz [szczegółowe instrukcje kompilacji][Example1].</span><span class="sxs-lookup"><span data-stu-id="4f715-321">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example1].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="4f715-322">Opis grupy NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-322">NSG description</span></span>
<span data-ttu-id="4f715-323">W tym przykładzie grupy NSG jest wbudowana i następnie ładowane przy użyciu sześciu reguł.</span><span class="sxs-lookup"><span data-stu-id="4f715-323">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-324">Ogólnie rzecz biorąc należy utworzyć określone zasady "Zezwalaj" najpierw, a następnie bardziej ogólnym reguły "Deny".</span><span class="sxs-lookup"><span data-stu-id="4f715-324">Generally speaking, you should create your specific “Allow” rules first, followed by the more generic “Deny” rules.</span></span> <span data-ttu-id="4f715-325">Podana wartość priorytetu decyduje, jakie reguły są sprawdzane jako pierwsze.</span><span class="sxs-lookup"><span data-stu-id="4f715-325">The given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="4f715-326">Po znalezieniu ruchu do zastosowania do określonej reguły nie dalsze reguły są sprawdzane.</span><span class="sxs-lookup"><span data-stu-id="4f715-326">Once traffic is found to apply to a specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="4f715-327">Reguły NSG można zastosować w ruchu przychodzącego lub wychodzącego kierunku (z punktu widzenia podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-327">NSG rules can apply in either the inbound or outbound direction (from the perspective of the subnet).</span></span>
>
>

<span data-ttu-id="4f715-328">Deklaratywnie są tworzone następujące reguły dla ruchu przychodzącego:</span><span class="sxs-lookup"><span data-stu-id="4f715-328">Declaratively, the following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="4f715-329">Wewnętrzny ruch DNS (port 53) jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-329">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="4f715-330">Ruch protokołu RDP (port 3389) z Internetu do żadnej maszyny wirtualnej jest dozwolony.</span><span class="sxs-lookup"><span data-stu-id="4f715-330">RDP traffic (port 3389) from the Internet to any Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="4f715-331">Ruch HTTP (port 80) z Internetu do serwera sieci web (IIS01) jest dozwolony.</span><span class="sxs-lookup"><span data-stu-id="4f715-331">HTTP traffic (port 80) from the Internet to web server (IIS01) is allowed.</span></span>
4. <span data-ttu-id="4f715-332">Cały ruch (wszystkie porty) z IIS01 do AppVM1 jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-332">Any traffic (all ports) from IIS01 to AppVM1 is allowed.</span></span>
5. <span data-ttu-id="4f715-333">Odmowa cały ruch (wszystkie porty) z Internetu do całej sieci wirtualnej (obie podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-333">Any traffic (all ports) from the Internet to the entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="4f715-334">Odmowa cały ruch (wszystkie porty) z podsieci frontonu do podsieci wewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="4f715-334">Any traffic (all ports) from the front-end subnet to the back-end subnet is denied.</span></span>

<span data-ttu-id="4f715-335">Przy użyciu tych reguł powiązany z każdej podsieci, jeśli żądanie HTTP zostało przychodzące z Internetu do serwera sieci web, obie zasady 3 (Zezwalaj) i 5 (odmówić go) powinna zostać zastosowana.</span><span class="sxs-lookup"><span data-stu-id="4f715-335">With these rules bound to each subnet, if an HTTP request was inbound from the Internet to the web server, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="4f715-336">Jednak ponieważ reguła 3 ma wyższy priorytet, tylko będą miały zastosowania i reguły 5 nie przybyły do odtwarzania.</span><span class="sxs-lookup"><span data-stu-id="4f715-336">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="4f715-337">W związku z tym żądania HTTP będą dozwolone na serwerze sieci web.</span><span class="sxs-lookup"><span data-stu-id="4f715-337">Thus the HTTP request would be allowed to the web server.</span></span> <span data-ttu-id="4f715-338">Jeśli ten sam ruch próbował uzyskać dostęp do serwera DNS01, zasada 5 (odmówić go) może być pierwszym do zastosowania, a ruch będzie niedozwolone do przekazania na serwer.</span><span class="sxs-lookup"><span data-stu-id="4f715-338">If that same traffic was trying to reach the DNS01 server, rule 5 (deny) would be the first to apply, and the traffic would not be allowed to pass to the server.</span></span> <span data-ttu-id="4f715-339">Reguła 6 (odmówić go) — bloki podsieci frontonu z rozmowie z podsieci zaplecza (z wyjątkiem dozwolonego ruchu w regułach 1 i 4).</span><span class="sxs-lookup"><span data-stu-id="4f715-339">Rule 6 (deny) blocks the front-end subnet from talking to the back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="4f715-340">Ten zestaw reguł chroni sieci wewnętrznej, w przypadku, gdy osoba atakująca obniża aplikacji sieci web na frontonie.</span><span class="sxs-lookup"><span data-stu-id="4f715-340">This rule-set protects the back-end network in case an attacker compromises the web application on the front end.</span></span> <span data-ttu-id="4f715-341">Osoba atakująca może mieć ograniczony dostęp do sieci "chronionych" zaplecza (tylko dla zasobów udostępniane na serwerze AppVM01).</span><span class="sxs-lookup"><span data-stu-id="4f715-341">The attacker would have limited access to the back-end “protected” network (only to resources exposed on the AppVM01 server).</span></span>

<span data-ttu-id="4f715-342">Brak domyślnej regule wychodzącej, która umożliwia ruchu wychodzącego do Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-342">There is a default outbound rule that allows traffic out to the Internet.</span></span> <span data-ttu-id="4f715-343">Na przykład firma Microsoft zezwala na ruch wychodzący i nie modyfikowanie reguł wychodzących.</span><span class="sxs-lookup"><span data-stu-id="4f715-343">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="4f715-344">Do blokowania ruchu w obu kierunkach, routing zdefiniowane przez użytkownika jest wymagana (Zobacz przykład 3).</span><span class="sxs-lookup"><span data-stu-id="4f715-344">To lock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-345">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-345">Conclusion</span></span>
<span data-ttu-id="4f715-346">W tym przykładzie jest względnie proste i bezpośrednie sposobem izolowanie podsieci wewnętrznej z ruchu przychodzącego.</span><span class="sxs-lookup"><span data-stu-id="4f715-346">This example is a relatively simple and straightforward way of isolating the back-end subnet from inbound traffic.</span></span> <span data-ttu-id="4f715-347">Aby uzyskać więcej informacji, zobacz [szczegółowe instrukcje kompilacji][Example1].</span><span class="sxs-lookup"><span data-stu-id="4f715-347">For more information, see the [detailed build instructions][Example1].</span></span> <span data-ttu-id="4f715-348">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-348">These instructions include:</span></span>

* <span data-ttu-id="4f715-349">Sposób tworzenia tej sieci obwodowej z klasycznym skryptów programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-349">How to build this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-350">Sposób tworzenia tej sieci obwodowej z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-350">How to build this perimeter network with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-351">Szczegółowy opis każdego polecenia NSG.</span><span class="sxs-lookup"><span data-stu-id="4f715-351">Detailed descriptions of each NSG command.</span></span>
* <span data-ttu-id="4f715-352">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch jest dozwolony lub zabroniony w każdej warstwie.</span><span class="sxs-lookup"><span data-stu-id="4f715-352">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>


### <a name="example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs"></a><span data-ttu-id="4f715-353">Przykład 2 kompilacji sieci obwodowej, aby chronić aplikacje z zaporą i grupy NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-353">Example 2 Build a perimeter network to help protect applications with a firewall and NSGs</span></span>
<span data-ttu-id="4f715-354">[Powrót do szybki start](#fast-start) | [szczegółowy kompilacji instrukcje w tym przykładzie][Example2]</span><span class="sxs-lookup"><span data-stu-id="4f715-354">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example2]</span></span>

<span data-ttu-id="4f715-355">[![8]][8]</span><span class="sxs-lookup"><span data-stu-id="4f715-355">[![8]][8]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-356">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-356">Environment description</span></span>
<span data-ttu-id="4f715-357">W tym przykładzie jest subskrypcji, która zawiera następujące zasoby:</span><span class="sxs-lookup"><span data-stu-id="4f715-357">In this example, there is a subscription that contains the following resources:</span></span>

* <span data-ttu-id="4f715-358">Pojedyncza grupa zasobów</span><span class="sxs-lookup"><span data-stu-id="4f715-358">A single resource group</span></span>
* <span data-ttu-id="4f715-359">Sieć wirtualną z dwiema podsieciami: "FrontEnd" i "Wewnętrzna"</span><span class="sxs-lookup"><span data-stu-id="4f715-359">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
* <span data-ttu-id="4f715-360">Grupy zabezpieczeń sieci jest stosowany do obu podsieci</span><span class="sxs-lookup"><span data-stu-id="4f715-360">A Network Security Group that is applied to both subnets</span></span>
* <span data-ttu-id="4f715-361">Urządzenie wirtualne sieci, w tym przypadku a zapory, podłączone do podsieci frontonu</span><span class="sxs-lookup"><span data-stu-id="4f715-361">A network virtual appliance, in this case a firewall, connected to the front-end subnet</span></span>
* <span data-ttu-id="4f715-362">Windows server, który reprezentuje serwer sieci web aplikacji ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-362">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="4f715-363">Dwa serwery systemu Windows, które reprezentują serwery zaplecza aplikacji ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="4f715-363">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="4f715-364">Windows server, który reprezentuje serwer DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-364">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="4f715-365">Skrypty i szablonu usługi Azure Resource Manager, zobacz [szczegółowe instrukcje kompilacji][Example2].</span><span class="sxs-lookup"><span data-stu-id="4f715-365">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example2].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="4f715-366">Opis grupy NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-366">NSG description</span></span>
<span data-ttu-id="4f715-367">W tym przykładzie grupy NSG jest wbudowana i następnie ładowane przy użyciu sześciu reguł.</span><span class="sxs-lookup"><span data-stu-id="4f715-367">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-368">Ogólnie rzecz biorąc należy utworzyć określone zasady "Zezwalaj" najpierw, a następnie bardziej ogólnym reguły "Deny".</span><span class="sxs-lookup"><span data-stu-id="4f715-368">Generally speaking, you should create your specific “Allow” rules first, followed by the more generic “Deny” rules.</span></span> <span data-ttu-id="4f715-369">Podana wartość priorytetu decyduje, jakie reguły są sprawdzane jako pierwsze.</span><span class="sxs-lookup"><span data-stu-id="4f715-369">The given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="4f715-370">Po znalezieniu ruchu do zastosowania do określonej reguły nie dalsze reguły są sprawdzane.</span><span class="sxs-lookup"><span data-stu-id="4f715-370">Once traffic is found to apply to a specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="4f715-371">Reguły NSG można zastosować w ruchu przychodzącego lub wychodzącego kierunku (z punktu widzenia podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-371">NSG rules can apply in either the inbound or outbound direction (from the perspective of the subnet).</span></span>
>
>

<span data-ttu-id="4f715-372">Deklaratywnie są tworzone następujące reguły dla ruchu przychodzącego:</span><span class="sxs-lookup"><span data-stu-id="4f715-372">Declaratively, the following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="4f715-373">Wewnętrzny ruch DNS (port 53) jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-373">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="4f715-374">Ruch protokołu RDP (port 3389) z Internetu do żadnej maszyny wirtualnej jest dozwolony.</span><span class="sxs-lookup"><span data-stu-id="4f715-374">RDP traffic (port 3389) from the Internet to any Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="4f715-375">Cały ruch Internet (wszystkie porty) do sieci (zapora) urządzenia wirtualnego jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-375">Any Internet traffic (all ports) to the network virtual appliance (firewall) is allowed.</span></span>
4. <span data-ttu-id="4f715-376">Cały ruch (wszystkie porty) z IIS01 do AppVM1 jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-376">Any traffic (all ports) from IIS01 to AppVM1 is allowed.</span></span>
5. <span data-ttu-id="4f715-377">Odmowa cały ruch (wszystkie porty) z Internetu do całej sieci wirtualnej (obie podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-377">Any traffic (all ports) from the Internet to the entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="4f715-378">Odmowa cały ruch (wszystkie porty) z podsieci frontonu do podsieci wewnętrznej.</span><span class="sxs-lookup"><span data-stu-id="4f715-378">Any traffic (all ports) from the front-end subnet to the back-end subnet is denied.</span></span>

<span data-ttu-id="4f715-379">Przy użyciu tych reguł powiązany z każdej podsieci, jeśli żądanie HTTP zostało przychodzące z Internetu do zapory obie zasady 3 (Zezwalaj) i 5 (odmówić go) powinna zostać zastosowana.</span><span class="sxs-lookup"><span data-stu-id="4f715-379">With these rules bound to each subnet, if an HTTP request was inbound from the Internet to the firewall, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="4f715-380">Jednak ponieważ reguła 3 ma wyższy priorytet, tylko będą miały zastosowania i reguły 5 nie przybyły do odtwarzania.</span><span class="sxs-lookup"><span data-stu-id="4f715-380">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="4f715-381">W związku z tym żądania HTTP mogliby zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-381">Thus the HTTP request would be allowed to the firewall.</span></span> <span data-ttu-id="4f715-382">Jeśli ten sam ruch próbował uzyskać dostęp do serwera IIS01, nawet jeśli komputer jest w tej podsieci frontonu, zasada 5 (odmówić go) powinna zostać zastosowana, a ruch będzie niedozwolone do przekazania na serwer.</span><span class="sxs-lookup"><span data-stu-id="4f715-382">If that same traffic was trying to reach the IIS01 server, even though it’s on the front-end subnet, rule 5 (deny) would apply, and the traffic would not be allowed to pass to the server.</span></span> <span data-ttu-id="4f715-383">Reguła 6 (odmówić go) — bloki podsieci frontonu z rozmowie z podsieci zaplecza (z wyjątkiem dozwolonego ruchu w regułach 1 i 4).</span><span class="sxs-lookup"><span data-stu-id="4f715-383">Rule 6 (deny) blocks the front-end subnet from talking to the back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="4f715-384">Ten zestaw reguł chroni sieci wewnętrznej, w przypadku, gdy osoba atakująca obniża aplikacji sieci web na frontonie.</span><span class="sxs-lookup"><span data-stu-id="4f715-384">This rule-set protects the back-end network in case an attacker compromises the web application on the front end.</span></span> <span data-ttu-id="4f715-385">Osoba atakująca może mieć ograniczony dostęp do sieci "chronionych" zaplecza (tylko dla zasobów udostępniane na serwerze AppVM01).</span><span class="sxs-lookup"><span data-stu-id="4f715-385">The attacker would have limited access to the back-end “protected” network (only to resources exposed on the AppVM01 server).</span></span>

<span data-ttu-id="4f715-386">Brak domyślnej regule wychodzącej, która umożliwia ruchu wychodzącego do Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-386">There is a default outbound rule that allows traffic out to the Internet.</span></span> <span data-ttu-id="4f715-387">Na przykład firma Microsoft zezwala na ruch wychodzący i nie modyfikowanie reguł wychodzących.</span><span class="sxs-lookup"><span data-stu-id="4f715-387">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="4f715-388">Do blokowania ruchu w obu kierunkach, routing zdefiniowane przez użytkownika jest wymagana (Zobacz przykład 3).</span><span class="sxs-lookup"><span data-stu-id="4f715-388">To lock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="firewall-rule-description"></a><span data-ttu-id="4f715-389">Opis reguły zapory</span><span class="sxs-lookup"><span data-stu-id="4f715-389">Firewall rule description</span></span>
<span data-ttu-id="4f715-390">W zaporze powinny być tworzone zasady przekazywania.</span><span class="sxs-lookup"><span data-stu-id="4f715-390">On the firewall, forwarding rules should be created.</span></span> <span data-ttu-id="4f715-391">Ponieważ w tym przykładzie tylko kieruje ruch internetowy w powiązany z zapory, a następnie do serwera sieci web tylko jednego przekazującego sieci translacji adresów (NAT) jest wymagany regułę.</span><span class="sxs-lookup"><span data-stu-id="4f715-391">Since this example only routes Internet traffic in-bound to the firewall and then to the web server, only one forwarding network address translation (NAT) rule is needed.</span></span>

<span data-ttu-id="4f715-392">Reguła przekazywania akceptuje dowolny źródłowy dla ruchu przychodzącego adres, który trafienia zapory próba nawiązania połączenia HTTP (port 80 i 443 dla protokołu HTTPS).</span><span class="sxs-lookup"><span data-stu-id="4f715-392">The forwarding rule accepts any inbound source address that hits the firewall trying to reach HTTP (port 80 or 443 for HTTPS).</span></span> <span data-ttu-id="4f715-393">Ma ona wysyłane poza interfejsu lokalnego zapory i Przekierowanie do serwera sieci web z adresem IP 10.0.1.5.</span><span class="sxs-lookup"><span data-stu-id="4f715-393">It's sent out of the firewall’s local interface and redirected to the web server with the IP Address of 10.0.1.5.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-394">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-394">Conclusion</span></span>
<span data-ttu-id="4f715-395">W tym przykładzie jest względnie łatwe ochronie aplikacji za pomocą zapory i izolowanie podsieci wewnętrznej z ruchu przychodzącego.</span><span class="sxs-lookup"><span data-stu-id="4f715-395">This example is a relatively straightforward way of protecting your application with a firewall and isolating the back-end subnet from inbound traffic.</span></span> <span data-ttu-id="4f715-396">Aby uzyskać więcej informacji, zobacz [szczegółowe instrukcje kompilacji][Example2].</span><span class="sxs-lookup"><span data-stu-id="4f715-396">For more information, see the [detailed build instructions][Example2].</span></span> <span data-ttu-id="4f715-397">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-397">These instructions include:</span></span>

* <span data-ttu-id="4f715-398">Sposób tworzenia tej sieci obwodowej z klasycznym skryptów programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-398">How to build this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-399">Jak utworzyć w tym przykładzie z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-399">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-400">Szczegółowy opis każdego polecenia i zapory reguły NSG.</span><span class="sxs-lookup"><span data-stu-id="4f715-400">Detailed descriptions of each NSG command and firewall rule.</span></span>
* <span data-ttu-id="4f715-401">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch jest dozwolony lub zabroniony w każdej warstwie.</span><span class="sxs-lookup"><span data-stu-id="4f715-401">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg"></a><span data-ttu-id="4f715-402">Przykład 3 kompilacji sieci obwodowej, aby zabezpieczyć sieć zapory i przez i grupy NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-402">Example 3 Build a perimeter network to help protect networks with a firewall and UDR and NSG</span></span>
<span data-ttu-id="4f715-403">[Powrót do szybki start](#fast-start) | [szczegółowy kompilacji instrukcje w tym przykładzie][Example3]</span><span class="sxs-lookup"><span data-stu-id="4f715-403">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example3]</span></span>

<span data-ttu-id="4f715-404">[![9]][9]</span><span class="sxs-lookup"><span data-stu-id="4f715-404">[![9]][9]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-405">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-405">Environment description</span></span>
<span data-ttu-id="4f715-406">W tym przykładzie jest subskrypcji, która zawiera następujące zasoby:</span><span class="sxs-lookup"><span data-stu-id="4f715-406">In this example, there is a subscription that contains the following resources:</span></span>

* <span data-ttu-id="4f715-407">Pojedyncza grupa zasobów</span><span class="sxs-lookup"><span data-stu-id="4f715-407">A single resource group</span></span>
* <span data-ttu-id="4f715-408">Sieć wirtualną przy użyciu trzech podsieci: "SecNet", "Fronton" i "Wewnętrzna"</span><span class="sxs-lookup"><span data-stu-id="4f715-408">A virtual network with three subnets: “SecNet”, “FrontEnd”, and “BackEnd”</span></span>
* <span data-ttu-id="4f715-409">Urządzenie wirtualne sieci, w tym przypadku a zapory, połączony z podsiecią SecNet</span><span class="sxs-lookup"><span data-stu-id="4f715-409">A network virtual appliance, in this case a firewall, connected to the SecNet subnet</span></span>
* <span data-ttu-id="4f715-410">Windows server, który reprezentuje serwer sieci web aplikacji ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-410">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="4f715-411">Dwa serwery systemu Windows, które reprezentują serwery zaplecza aplikacji ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="4f715-411">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="4f715-412">Windows server, który reprezentuje serwer DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="4f715-412">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="4f715-413">Skrypty i szablonu usługi Azure Resource Manager, zobacz [szczegółowe instrukcje kompilacji][Example3].</span><span class="sxs-lookup"><span data-stu-id="4f715-413">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example3].</span></span>

#### <a name="udr-description"></a><span data-ttu-id="4f715-414">Opis elementu przez</span><span class="sxs-lookup"><span data-stu-id="4f715-414">UDR description</span></span>
<span data-ttu-id="4f715-415">Domyślnie następujące trasy systemowe są zdefiniowane jako:</span><span class="sxs-lookup"><span data-stu-id="4f715-415">By default, the following system routes are defined as:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.0.0/16}     VNETLocal                            Active   Default    
         {0.0.0.0/0}       Internet                             Active   Default    
         {10.0.0.0/8}      Null                                 Active   Default    
         {100.64.0.0/10}   Null                                 Active   Default    
         {172.16.0.0/12}   Null                                 Active   Default    
         {192.168.0.0/16}  Null                                 Active   Default

<span data-ttu-id="4f715-416">VNETLocal jest zawsze prefiksy adresów zdefiniowanych, wchodzące w skład sieci wirtualnej dla określonej sieci (czyli jego zmiany z sieci wirtualnej do sieci wirtualnej, w zależności od tego, jak zdefiniowano każdej określonej sieci wirtualnej).</span><span class="sxs-lookup"><span data-stu-id="4f715-416">The VNETLocal is always one or more defined address prefixes that make up the virtual network for that specific network (that is, it changes from virtual network to virtual network, depending on how each specific virtual network is defined).</span></span> <span data-ttu-id="4f715-417">Pozostałe tras systemowych są statyczne i domyślne określonych w tabeli.</span><span class="sxs-lookup"><span data-stu-id="4f715-417">The remaining system routes are static and default as indicated in the table.</span></span>

<span data-ttu-id="4f715-418">W tym przykładzie dwie tabele routingu są tworzone, jeden dla podsieci frontonu i zaplecza.</span><span class="sxs-lookup"><span data-stu-id="4f715-418">In this example, two routing tables are created, one each for the front-end and back-end subnets.</span></span> <span data-ttu-id="4f715-419">Każda tabela została załadowana z tras statycznych, które są odpowiednie dla danej podsieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-419">Each table is loaded with static routes appropriate for the given subnet.</span></span> <span data-ttu-id="4f715-420">W tym przykładzie każda tabela zawiera trzy tras, na których kierować cały ruch (0.0.0.0/0) za pośrednictwem zapory (następnego przeskoku = adres IP urządzenia wirtualnego):</span><span class="sxs-lookup"><span data-stu-id="4f715-420">In this example, each table has three routes that direct all traffic (0.0.0.0/0) through the firewall (Next hop = Virtual Appliance IP address):</span></span>

1. <span data-ttu-id="4f715-421">Ruchu w podsieci lokalnej z następnego przeskoku określone, aby zezwolić na ruch podsieci lokalnej ominąć zaporę.</span><span class="sxs-lookup"><span data-stu-id="4f715-421">Local subnet traffic with no Next Hop defined to allow local subnet traffic to bypass the firewall.</span></span>
2. <span data-ttu-id="4f715-422">Ruchu w sieci wirtualnej z przeskoku dalej zdefiniowany jako zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-422">Virtual network traffic with a Next Hop defined as firewall.</span></span> <span data-ttu-id="4f715-423">Ta następnego przeskoku przesłania domyślna reguła, która umożliwia lokalne ruchu w sieci wirtualnej do routingu bezpośredniego.</span><span class="sxs-lookup"><span data-stu-id="4f715-423">This next hop overrides the default rule that allows local virtual network traffic to route directly.</span></span>
3. <span data-ttu-id="4f715-424">Cały ruch pozostałych (0/0) z przeskoku dalej zdefiniowany jako zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-424">All remaining traffic (0/0) with a Next Hop defined as the firewall.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-425">W przypadku komunikacji podsieci lokalnej podziały przez nie ma wpisu podsieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-425">Not having the local subnet entry in the UDR breaks local subnet communications.</span></span>
>
> * <span data-ttu-id="4f715-426">W naszym przykładzie 10.0.1.0/24 wskazujący VNETLocal jest krytyczny!</span><span class="sxs-lookup"><span data-stu-id="4f715-426">In our example, 10.0.1.0/24 pointing to VNETLocal is critical!</span></span> <span data-ttu-id="4f715-427">Bez tego pakietu, pozostawiając serwera sieci Web (10.0.1.4) przeznaczone na inny serwer lokalny (na przykład) 10.0.1.25 wystąpi błąd, ponieważ będą wysyłane do analizę NVA.</span><span class="sxs-lookup"><span data-stu-id="4f715-427">Without it, packet leaving the Web Server (10.0.1.4) destined to another local server (for example) 10.0.1.25 will fail as they will be sent to the NVA.</span></span> <span data-ttu-id="4f715-428">Analizę NVA wysyła go do podsieci, a podsieć zostanie ponownie do NVA w pętli nieskończonej.</span><span class="sxs-lookup"><span data-stu-id="4f715-428">The NVA will send it to the subnet, and the subnet will resend it to the NVA in an infinite loop.</span></span>
> * <span data-ttu-id="4f715-429">Ryzyko Pętla routingu są zwykle wyższe, na urządzeniach z wieloma kartami sieciowymi podłączonymi do oddzielania podsieci, która jest często tradycyjnych, lokalnie urządzeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-429">The chances of a routing loop are typically higher on appliances with multiple NICs that are connected to separate subnets, which is often of traditional, on-premises appliances.</span></span>
>
>

<span data-ttu-id="4f715-430">Po utworzeniu tabele routingu, musi być powiązana z ich podsieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-430">Once the routing tables are created, they must be bound to their subnets.</span></span> <span data-ttu-id="4f715-431">Podsieci frontonu tabeli routingu, raz utworzony i powiązany z podsiecią wyglądałyby tak jak te dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="4f715-431">The front-end subnet routing table, once created and bound to the subnet, would look like this output:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.1.0/24}     VNETLocal                            Active
         {10.0.0.0/16}     VirtualAppliance 10.0.0.4            Active    
         {0.0.0.0/0}       VirtualAppliance 10.0.0.4            Active

> [!NOTE]
> <span data-ttu-id="4f715-432">Teraz można zastosować przez do podsieci bramy, na którym jest połączony z obwodem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4f715-432">UDR can now be applied to the gateway subnet on which the ExpressRoute circuit is connected.</span></span>
>
> <span data-ttu-id="4f715-433">Przykłady sposobu włączania sieci obwodowej za pomocą programu ExpressRoute lub lokacja lokacja sieci przedstawiono w przykładach 3 i 4.</span><span class="sxs-lookup"><span data-stu-id="4f715-433">Examples of how to enable your perimeter network with ExpressRoute or site-to-site networking are shown in examples 3 and 4.</span></span>
>
>

#### <a name="ip-forwarding-description"></a><span data-ttu-id="4f715-434">Opis usługi przesyłania dalej protokołu IP</span><span class="sxs-lookup"><span data-stu-id="4f715-434">IP Forwarding description</span></span>
<span data-ttu-id="4f715-435">Przekazywanie adresów IP jest przez funkcję pomocnika.</span><span class="sxs-lookup"><span data-stu-id="4f715-435">IP Forwarding is a companion feature to UDR.</span></span> <span data-ttu-id="4f715-436">Przekazywanie adresów IP to ustawienie na urządzenie wirtualne, które pozwala na odbieranie ruchu kierowanego nie specjalnie do urządzenia, a następnie przesyła ten ruch do końcowego miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="4f715-436">IP Forwarding is a setting on a virtual appliance that allows it to receive traffic not specifically addressed to the appliance, and then forward that traffic to its ultimate destination.</span></span>

<span data-ttu-id="4f715-437">Na przykład jeśli AppVM01 wysyła żądanie do serwera DNS01, przez może kierować ruchem tej zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-437">For example, if AppVM01 makes a request to the DNS01 server, UDR would route this traffic to the firewall.</span></span> <span data-ttu-id="4f715-438">Z przesyłania dalej protokołu IP włączone ruchu dla miejsca docelowego DNS01 (10.0.2.4) jest akceptowane przez urządzenia (10.0.0.4) i następnie przekazywane do końcowego miejsca docelowego (10.0.2.4).</span><span class="sxs-lookup"><span data-stu-id="4f715-438">With IP Forwarding enabled, the traffic for the DNS01 destination (10.0.2.4) is accepted by the appliance (10.0.0.4) and then forwarded to its ultimate destination (10.0.2.4).</span></span> <span data-ttu-id="4f715-439">Bez przekazywania adresów IP jest włączona Zapora ruch może nie zostać zaakceptowane przez urządzenia, mimo że tabeli tras ma zapory w następnym skoku.</span><span class="sxs-lookup"><span data-stu-id="4f715-439">Without IP Forwarding enabled on the firewall, traffic would not be accepted by the appliance even though the route table has the firewall as the next hop.</span></span> <span data-ttu-id="4f715-440">Aby korzystać z urządzenia wirtualnego, bardzo ważne jest należy pamiętać o włączeniu wraz z przez przesyłania dalej protokołu IP.</span><span class="sxs-lookup"><span data-stu-id="4f715-440">To use a virtual appliance, it’s critical to remember to enable IP Forwarding along with UDR.</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="4f715-441">Opis grupy NSG</span><span class="sxs-lookup"><span data-stu-id="4f715-441">NSG description</span></span>
<span data-ttu-id="4f715-442">W tym przykładzie grupa NSG jest wbudowana i następnie ładowane przy użyciu jednej reguły.</span><span class="sxs-lookup"><span data-stu-id="4f715-442">In this example, an NSG group is built and then loaded with a single rule.</span></span> <span data-ttu-id="4f715-443">Ta grupa jest następnie powiązać tylko z podsieci frontonu i zaplecza (nie SecNet).</span><span class="sxs-lookup"><span data-stu-id="4f715-443">This group is then bound only to the front-end and back-end subnets (not the SecNet).</span></span> <span data-ttu-id="4f715-444">Deklaratywnie budowanego następującą regułę:</span><span class="sxs-lookup"><span data-stu-id="4f715-444">Declaratively the following rule is being built:</span></span>

* <span data-ttu-id="4f715-445">Odmowa cały ruch (wszystkie porty) z Internetu do całej sieci wirtualnej (wszystkie podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-445">Any traffic (all ports) from the Internet to the entire virtual network (all subnets) is denied.</span></span>

<span data-ttu-id="4f715-446">Mimo że grupy NSG są używane w tym przykładzie, głównym celem jest jako dodatkowej warstwy obrony przed ręcznej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="4f715-446">Although NSGs are used in this example, its main purpose is as a secondary layer of defense against manual misconfiguration.</span></span> <span data-ttu-id="4f715-447">Celem jest Blokuj cały ruch przychodzący z Internetu do frontonu lub zaplecza podsieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-447">The goal is to block all inbound traffic from the Internet to either the front-end or back-end subnets.</span></span> <span data-ttu-id="4f715-448">Ruch powinny przepływać tylko za pośrednictwem podsieci SecNet do zapory (i następnie w razie potrzeby do podsieci frontonu lub zaplecza).</span><span class="sxs-lookup"><span data-stu-id="4f715-448">Traffic should only flow through the SecNet subnet to the firewall (and then, if appropriate, on to the front-end or back-end subnets).</span></span> <span data-ttu-id="4f715-449">Plus przy użyciu reguł przez w miejscu, dowolnego ruchu, który należy do podsieci frontonu lub zaplecza może być kierowane limit do zapory (dzięki użyciu przez).</span><span class="sxs-lookup"><span data-stu-id="4f715-449">Plus, with the UDR rules in place, any traffic that did make it into the front-end or back-end subnets would be directed out to the firewall (thanks to UDR).</span></span> <span data-ttu-id="4f715-450">Zapora będzie wyświetlać ten ruch asymetrycznego przepływu i spowoduje pominięcie ruchu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="4f715-450">The firewall would see this traffic as an asymmetric flow and would drop the outbound traffic.</span></span> <span data-ttu-id="4f715-451">W związku z tym są trzy warstwy zabezpieczeń, ochrony podsieci:</span><span class="sxs-lookup"><span data-stu-id="4f715-451">Thus there are three layers of security protecting the subnets:</span></span>

* <span data-ttu-id="4f715-452">Nie publiczny adres IP frontonu lub wewnętrznej bazy danych kart sieciowych.</span><span class="sxs-lookup"><span data-stu-id="4f715-452">No Public IP addresses on any FrontEnd or BackEnd NICs.</span></span>
* <span data-ttu-id="4f715-453">Grupy NSG zezwalających na ruch z Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-453">NSGs denying traffic from the Internet.</span></span>
* <span data-ttu-id="4f715-454">Ruch asymetrycznego usunięcie zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-454">The firewall dropping asymmetric traffic.</span></span>

<span data-ttu-id="4f715-455">Jeden punkt interesujące dotyczące grupy NSG, w tym przykładzie jest zawiera tylko jedną regułę, czyli odrzucanie ruch internetowy do całej sieci wirtualnej, w tym podsieci zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-455">One interesting point regarding the NSG in this example is that it contains only one rule, which is to deny Internet traffic to the entire virtual network, including the Security subnet.</span></span> <span data-ttu-id="4f715-456">Jednak ponieważ grupa NSG jest powiązany tylko z podsieci frontonu i zaplecza, reguła nie jest przetwarzana na ruch przychodzący z podsiecią zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-456">However, since the NSG is only bound to the front-end and back-end subnets, the rule isn’t processed on traffic inbound to the Security subnet.</span></span> <span data-ttu-id="4f715-457">W związku z tym ruch przechodzi do podsieci zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-457">As a result, traffic flows to the Security subnet.</span></span>

#### <a name="firewall-rules"></a><span data-ttu-id="4f715-458">Reguły zapory</span><span class="sxs-lookup"><span data-stu-id="4f715-458">Firewall rules</span></span>
<span data-ttu-id="4f715-459">W zaporze powinny być tworzone zasady przekazywania.</span><span class="sxs-lookup"><span data-stu-id="4f715-459">On the firewall, forwarding rules should be created.</span></span> <span data-ttu-id="4f715-460">Ponieważ Zapora jest blokowanie lub przekazywania wszystkich przychodzące, wychodzące i ruchu w sieci wirtualnej w obrębie, wiele reguł zapory są wymagane.</span><span class="sxs-lookup"><span data-stu-id="4f715-460">Since the firewall is blocking or forwarding all inbound, outbound, and intra-virtual network traffic, many firewall rules are needed.</span></span> <span data-ttu-id="4f715-461">Ponadto cały ruch przychodzący trafień usługi zabezpieczeń publicznego adresu IP (na różnych portów), do przetworzenia przez zaporę.</span><span class="sxs-lookup"><span data-stu-id="4f715-461">Also, all inbound traffic hits the Security Service public IP address (on different ports), to be processed by the firewall.</span></span> <span data-ttu-id="4f715-462">Najlepszym rozwiązaniem jest diagram logiczny przepływów przed rozpoczęciem konfigurowania podsieci i reguły zapory, aby uniknąć zmian później.</span><span class="sxs-lookup"><span data-stu-id="4f715-462">A best practice is to diagram the logical flows before setting up the subnets and firewall rules, to avoid rework later.</span></span> <span data-ttu-id="4f715-463">Poniższa ilustracja jest widok logiczny reguły zapory, w tym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="4f715-463">The following figure is a logical view of the firewall rules for this example:</span></span>

<span data-ttu-id="4f715-464">![10]</span><span class="sxs-lookup"><span data-stu-id="4f715-464">![10]</span></span>

> [!NOTE]
> <span data-ttu-id="4f715-465">Oparte na urządzenie wirtualne sieci używana, porty zarządzania różnią się.</span><span class="sxs-lookup"><span data-stu-id="4f715-465">Based on the Network Virtual Appliance used, the management ports vary.</span></span> <span data-ttu-id="4f715-466">W tym przykładzie zapory NextGen Barracuda odwołuje się, który używa portów 22, 801 i 807.</span><span class="sxs-lookup"><span data-stu-id="4f715-466">In this example, a Barracuda NextGen Firewall is referenced, which uses ports 22, 801, and 807.</span></span> <span data-ttu-id="4f715-467">Zajrzyj do dokumentacji dostawcy urządzenia, aby znaleźć odpowiednie porty używane do zarządzania urządzeniami używana.</span><span class="sxs-lookup"><span data-stu-id="4f715-467">Consult the appliance vendor documentation to find the exact ports used for management of the device being used.</span></span>
>
>

#### <a name="firewall-rules-description"></a><span data-ttu-id="4f715-468">Opis reguł zapory</span><span class="sxs-lookup"><span data-stu-id="4f715-468">Firewall rules description</span></span>
<span data-ttu-id="4f715-469">Na powyższym diagramie logiczne podsieci zabezpieczeń nie jest wyświetlane, ponieważ Zapora jest tylko zasobów tej podsieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-469">In the preceding logical diagram, the security subnet is not shown because the firewall is the only resource on that subnet.</span></span> <span data-ttu-id="4f715-470">Diagram jest pokazywany reguły zapory i sposób ich logicznie akceptować lub odrzucać przepływów ruchu sieciowego, nie rzeczywistej ścieżce routingiem.</span><span class="sxs-lookup"><span data-stu-id="4f715-470">The diagram is showing the firewall rules and how they logically allow or deny traffic flows, not the actual routed path.</span></span> <span data-ttu-id="4f715-471">Ponadto zewnętrzne porty wybrany na potrzeby ruchu protokołu RDP są wyższe ranged portów (8014 — 8026) i wybrano słabo uzgodnić z ostatnich dwóch oktety lokalny adres IP dla czytelności łatwiejsze (na przykład adres serwera lokalnego 10.0.1.4 jest skojarzony z portu zewnętrznego 8014).</span><span class="sxs-lookup"><span data-stu-id="4f715-471">Also, the external ports selected for the RDP traffic are higher ranged ports (8014 – 8026) and were selected to loosely align with the last two octets of the local IP address for easier readability (for example, local server address 10.0.1.4 is associated with external port 8014).</span></span> <span data-ttu-id="4f715-472">Wszystkie porty wyższej niekolidujących, mogą zostać wykorzystane.</span><span class="sxs-lookup"><span data-stu-id="4f715-472">Any higher non-conflicting ports, however, could be used.</span></span>

<span data-ttu-id="4f715-473">W tym przykładzie potrzebne są nam siedem typów zasad:</span><span class="sxs-lookup"><span data-stu-id="4f715-473">For this example, we need seven types of rules:</span></span>

* <span data-ttu-id="4f715-474">Reguły zewnętrzne (dla ruchu przychodzącego):</span><span class="sxs-lookup"><span data-stu-id="4f715-474">External rules (for inbound traffic):</span></span>
  1. <span data-ttu-id="4f715-475">Reguły zapory zarządzania: ten przekierowania aplikacji reguła zezwala na ruch do przekazania do portów zarządzania urządzenie wirtualne sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-475">Firewall management rule: This App Redirect rule allows traffic to pass to the management ports of the network virtual appliance.</span></span>
  2. <span data-ttu-id="4f715-476">Zasady protokołu RDP (na każdym serwerze z systemem Windows): Zezwalaj na zarządzanie poszczególnych serwerów za pomocą protokołu RDP te cztery reguły (po jednym dla każdego serwera).</span><span class="sxs-lookup"><span data-stu-id="4f715-476">RDP rules (for each Windows server): These four rules (one for each server) allow management of the individual servers via RDP.</span></span> <span data-ttu-id="4f715-477">Cztery reguły protokołu RDP może również zostać zwinięty w jednej reguły, w zależności od możliwości urządzenie wirtualne sieci używane.</span><span class="sxs-lookup"><span data-stu-id="4f715-477">The four RDP rules could also be collapsed into one rule, depending on the capabilities of the network virtual appliance being used.</span></span>
  3. <span data-ttu-id="4f715-478">Reguły ruchu aplikacji: istnieją dwa z tych zasad, pierwszy dla ruchu frontonu sieci web, a drugi dla ruchu w sieci wewnętrznej (na przykład serwer sieci web do warstwy danych).</span><span class="sxs-lookup"><span data-stu-id="4f715-478">Application traffic rules: There are two of these rules, the first for the front-end web traffic, and the second for the back-end traffic (for example, web server to data tier).</span></span> <span data-ttu-id="4f715-479">Konfiguracja tych zasad jest zależna od architektury sieci (w którym są umieszczane serwerów) i przepływów ruchu (kierunku przepływów ruchu sieciowego i portów, do których są używane).</span><span class="sxs-lookup"><span data-stu-id="4f715-479">The configuration of these rules depends on the network architecture (where your servers are placed) and traffic flows (which direction the traffic flows, and which ports are used).</span></span>
     * <span data-ttu-id="4f715-480">Pierwsza reguła zezwala na ruch rzeczywisty aplikacji do serwera aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-480">The first rule allows the actual application traffic to reach the application server.</span></span> <span data-ttu-id="4f715-481">Zezwalaj na inne zasady zabezpieczeń i zarządzania, reguły ruchu aplikacji są co Zezwalaj użytkowników zewnętrznych lub usług w celu uzyskania dostępu do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4f715-481">While the other rules allow for security and management, application traffic rules are what allow external users or services to access the applications.</span></span> <span data-ttu-id="4f715-482">Ten przykład jest jednym serwerze sieci web na porcie 80.</span><span class="sxs-lookup"><span data-stu-id="4f715-482">For this example, there is a single web server on port 80.</span></span> <span data-ttu-id="4f715-483">W związku z tym pojedynczą aplikacji regułę zapory przekierowuje ruch przychodzący do zewnętrznego adresu IP do sieci web serwerów wewnętrzny adres IP.</span><span class="sxs-lookup"><span data-stu-id="4f715-483">Thus a single firewall application rule redirects inbound traffic to the external IP, to the web servers internal IP address.</span></span> <span data-ttu-id="4f715-484">Sesja przekierowywania ruchu czy translacji za pośrednictwem translatora adresów Sieciowych do wewnętrznego serwera.</span><span class="sxs-lookup"><span data-stu-id="4f715-484">The redirected traffic session would be translated via NAT to the internal server.</span></span>
     * <span data-ttu-id="4f715-485">Drugą regułę jest zaplecza reguły zezwalającej na serwerze sieci web komunikował się z serwerem AppVM01 (ale nie AppVM02) za pomocą dowolnego portu.</span><span class="sxs-lookup"><span data-stu-id="4f715-485">The second rule is the back-end rule to allow the web server to talk to the AppVM01 server (but not AppVM02) via any port.</span></span>
* <span data-ttu-id="4f715-486">Reguły wewnętrzne (dla ruchu w sieci wirtualnej w obrębie)</span><span class="sxs-lookup"><span data-stu-id="4f715-486">Internal rules (for intra-virtual network traffic)</span></span>
  1. <span data-ttu-id="4f715-487">Ruch wychodzący do Internetu reguły: Ta reguła zezwala na ruch z żadną siecią do przekazania do wybranych sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-487">Outbound to Internet rule: This rule allows traffic from any network to pass to the selected networks.</span></span> <span data-ttu-id="4f715-488">Ta reguła jest zwykle domyślna reguła już w zaporze, ale w stanie wyłączenia.</span><span class="sxs-lookup"><span data-stu-id="4f715-488">This rule is usually a default rule already on the firewall, but in a disabled state.</span></span> <span data-ttu-id="4f715-489">Ta reguła powinna być włączona w tym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="4f715-489">This rule should be enabled for this example.</span></span>
  2. <span data-ttu-id="4f715-490">Reguła DNS: Ta reguła zezwala tylko na ruch DNS (port 53) do przekazania do serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="4f715-490">DNS rule: This rule allows only DNS (port 53) traffic to pass to the DNS server.</span></span> <span data-ttu-id="4f715-491">Dla tego środowiska większość ruchu z frontonu do wewnętrznej jest zablokowany.</span><span class="sxs-lookup"><span data-stu-id="4f715-491">For this environment, most traffic from the front end to the back end is blocked.</span></span> <span data-ttu-id="4f715-492">Ta zasada umożliwia w szczególności DNS z żadnych podsieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="4f715-492">This rule specifically allows DNS from any local subnet.</span></span>
  3. <span data-ttu-id="4f715-493">Podsieci do reguły podsieci: Ta reguła jest umożliwienie dowolnego serwera w podsieci wewnętrznej w celu połączenia z serwerem z podsieci frontonu (ale nie odwrotnie).</span><span class="sxs-lookup"><span data-stu-id="4f715-493">Subnet to subnet rule: This rule is to allow any server on the back-end subnet to connect to any server on the front-end subnet (but not the reverse).</span></span>
* <span data-ttu-id="4f715-494">Reguła awaryjnego (dla ruchu, który nie spełnia żadnego z poprzedniej):</span><span class="sxs-lookup"><span data-stu-id="4f715-494">Fail-safe rule (for traffic that doesn’t meet any of the previous):</span></span>
  1. <span data-ttu-id="4f715-495">Odmów wszystkie reguły ruchu: Ta reguła odmowy zawsze powinna być końcowego reguły (pod względem priorytetu) oraz jako takie Jeśli przepływ ruchu, nie pasuje do żadnego z poprzedniego zasady zostanie usunięte przez tę regułę.</span><span class="sxs-lookup"><span data-stu-id="4f715-495">Deny all traffic rule: This deny rule should always be the final rule (in terms of priority), and as such if a traffic flow fails to match any of the preceding rules it is dropped by this rule.</span></span> <span data-ttu-id="4f715-496">Ta reguła jest regułą domyślnego i zwykle w miejscu i aktywne.</span><span class="sxs-lookup"><span data-stu-id="4f715-496">This rule is a default rule and usually in-place and active.</span></span> <span data-ttu-id="4f715-497">Nie zmiany zwykle są niezbędne do tej reguły.</span><span class="sxs-lookup"><span data-stu-id="4f715-497">No modifications are usually needed to this rule.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-498">Na drugą regułę ruchu aplikacji do uproszczenia w tym przykładzie każdy port jest dozwolone.</span><span class="sxs-lookup"><span data-stu-id="4f715-498">On the second application traffic rule, to simplify this example, any port is allowed.</span></span> <span data-ttu-id="4f715-499">W rzeczywistym scenariuszu najbardziej określonego portu i zakresy adresów należy zmniejszyć obszar ataków tej reguły.</span><span class="sxs-lookup"><span data-stu-id="4f715-499">In a real scenario, the most specific port and address ranges should be used to reduce the attack surface of this rule.</span></span>
>
>

<span data-ttu-id="4f715-500">Po utworzeniu poprzednich zasad, należy przejrzeć priorytet każdej reguły, aby upewnić się, ruch jest dozwolony lub zabroniony zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="4f715-500">Once the previous rules are created, it’s important to review the priority of each rule to ensure traffic is allowed or denied as desired.</span></span> <span data-ttu-id="4f715-501">Na przykład reguły są w kolejności priorytetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-501">For this example, the rules are in priority order.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-502">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-502">Conclusion</span></span>
<span data-ttu-id="4f715-503">W tym przykładzie jest bardziej złożonych ale ukończyć sposób ochrony i izolowania sieci niż w poprzednich przykładach.</span><span class="sxs-lookup"><span data-stu-id="4f715-503">This example is a more complex but complete way of protecting and isolating the network than the previous examples.</span></span> <span data-ttu-id="4f715-504">(Przykład 2 chroni tylko aplikacji i przykład 1 po prostu wyodrębnia podsieci).</span><span class="sxs-lookup"><span data-stu-id="4f715-504">(Example 2 protects just the application, and Example 1 just isolates subnets).</span></span> <span data-ttu-id="4f715-505">Ten projekt umożliwia monitorowanie ruchu w obu kierunkach i chroni nie tylko serwer aplikacji dla ruchu przychodzącego, ale wymusza zasady zabezpieczeń sieci dla wszystkich serwerów w tej sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-505">This design allows for monitoring traffic in both directions, and protects not just the inbound application server but enforces network security policy for all servers on this network.</span></span> <span data-ttu-id="4f715-506">Ponadto w zależności od urządzenia używane pełne ruchu inspekcji i świadomości można osiągnąć.</span><span class="sxs-lookup"><span data-stu-id="4f715-506">Also, depending on the appliance used, full traffic auditing and awareness can be achieved.</span></span> <span data-ttu-id="4f715-507">Aby uzyskać więcej informacji, zobacz [szczegółowe instrukcje kompilacji][Example3].</span><span class="sxs-lookup"><span data-stu-id="4f715-507">For more information, see the [detailed build instructions][Example3].</span></span> <span data-ttu-id="4f715-508">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-508">These instructions include:</span></span>

* <span data-ttu-id="4f715-509">Jak utworzyć ten przykład sieci obwodowej z klasycznym skryptów programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-509">How to build this example perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-510">Jak utworzyć w tym przykładzie z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-510">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-511">Szczegółowe opisy każdej przez NSG polecenia, a reguły zapory.</span><span class="sxs-lookup"><span data-stu-id="4f715-511">Detailed descriptions of each UDR, NSG command, and firewall rule.</span></span>
* <span data-ttu-id="4f715-512">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch jest dozwolony lub zabroniony w każdej warstwie.</span><span class="sxs-lookup"><span data-stu-id="4f715-512">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn"></a><span data-ttu-id="4f715-513">Przykład 4 Dodaj połączenie hybrydowe z lokacja lokacja, wirtualne urządzenia sieci VPN</span><span class="sxs-lookup"><span data-stu-id="4f715-513">Example 4 Add a hybrid connection with a site-to-site, virtual appliance VPN</span></span>
<span data-ttu-id="4f715-514">[Powrót do szybki start](#fast-start) | Szczegółowe instrukcje kompilacji jest dostępny wkrótce</span><span class="sxs-lookup"><span data-stu-id="4f715-514">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="4f715-515">[![11]][11]</span><span class="sxs-lookup"><span data-stu-id="4f715-515">[![11]][11]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-516">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-516">Environment description</span></span>
<span data-ttu-id="4f715-517">Sieci hybrydowe przy użyciu urządzenie wirtualne sieci (NVA) można dodać do dowolnego typu sieci obwodowej, opisane w przykładach 1, 2 lub 3.</span><span class="sxs-lookup"><span data-stu-id="4f715-517">Hybrid networking using a network virtual appliance (NVA) can be added to any of the perimeter network types described in examples 1, 2, or 3.</span></span>

<span data-ttu-id="4f715-518">Jak pokazano na poprzedniej ilustracji, połączenie sieci VPN za pośrednictwem Internetu (site-to-site) jest używana sieć wirtualna platformy Azure za pośrednictwem NVA nawiązać połączenia z siecią lokalną.</span><span class="sxs-lookup"><span data-stu-id="4f715-518">As shown in the previous figure, a VPN connection over the Internet (site-to-site) is used to connect an on-premises network to an Azure virtual network via an NVA.</span></span>

> [!NOTE]
> <span data-ttu-id="4f715-519">Jeśli używasz usługi ExpressRoute z włączoną opcją publicznej komunikacji równorzędnej platformy Azure, należy utworzyć tras statycznych.</span><span class="sxs-lookup"><span data-stu-id="4f715-519">If you use ExpressRoute with the Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="4f715-520">Tej trasy statyczne powinny kierować na adres IP sieci VPN NVA firmowej Internetu, a nie za pośrednictwem połączenia ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4f715-520">This static route should route to the NVA VPN IP address out your corporate Internet and not via the ExpressRoute connection.</span></span> <span data-ttu-id="4f715-521">Translator adresów Sieciowych wymaganych opcji Azure publicznej komunikacji równorzędnej ExpressRoute mogą być dzielone sesji sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="4f715-521">The NAT required on the ExpressRoute Azure Public Peering option can break the VPN session.</span></span>
>
>

<span data-ttu-id="4f715-522">Po umieszczeniu sieć VPN w miejscu analizę NVA staje się Centrum dla wszystkich sieci i podsieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-522">Once the VPN is in place, the NVA becomes the central hub for all networks and subnets.</span></span> <span data-ttu-id="4f715-523">Zasady przekazywania zapory określają przepływów ruchu sieciowego, które są dozwolone są tłumaczone za pośrednictwem translatora adresów Sieciowych, są przekierowywane albo są usuwane (nawet w przypadku przepływów ruchu sieciowego między siecią lokalną a platformą Azure).</span><span class="sxs-lookup"><span data-stu-id="4f715-523">The firewall forwarding rules determine which traffic flows are allowed, are translated via NAT, are redirected, or are dropped (even for traffic flows between the on-premises network and Azure).</span></span>

<span data-ttu-id="4f715-524">Ruch należy rozważyć dokładnie, jak mogą być optymalizowane lub ograniczone przez ten wzorzec projektowania, w zależności od konkretnych przypadek użycia.</span><span class="sxs-lookup"><span data-stu-id="4f715-524">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="4f715-525">Przy użyciu wbudowanych w przykładzie 3 środowiska, a następnie dodanie połączenia sieciowego hybrydowego sieci VPN typu lokacja lokacja, tworzy następującego projektu:</span><span class="sxs-lookup"><span data-stu-id="4f715-525">Using the environment built in example 3, and then adding a site-to-site VPN hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="4f715-526">[![12]][12]</span><span class="sxs-lookup"><span data-stu-id="4f715-526">[![12]][12]</span></span>

<span data-ttu-id="4f715-527">Router lokalny lub innego urządzenia sieciowego, zgodny z Twojej NVA dla sieci VPN, byłoby klienta sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="4f715-527">The on-premises router, or any other network device that is compatible with your NVA for VPN, would be the VPN client.</span></span> <span data-ttu-id="4f715-528">To fizyczne urządzenie będzie odpowiedzialny za inicjowanie i utrzymywania połączenia sieci VPN, z Twojego NVA.</span><span class="sxs-lookup"><span data-stu-id="4f715-528">This physical device would be responsible for initiating and maintaining the VPN connection with your NVA.</span></span>

<span data-ttu-id="4f715-529">Logicznie do NVA sieci wygląda cztery oddzielne "strefy zabezpieczeń" z zasadami na NVA jest podstawowym Dyrektor ruchu między tych stref:</span><span class="sxs-lookup"><span data-stu-id="4f715-529">Logically to the NVA, the network looks like four separate “security zones” with the rules on the NVA being the primary director of traffic between these zones:</span></span>

<span data-ttu-id="4f715-530">![13]</span><span class="sxs-lookup"><span data-stu-id="4f715-530">![13]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-531">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-531">Conclusion</span></span>
<span data-ttu-id="4f715-532">Dodanie połączenia sieciowego hybrydowego site-to-site VPN do sieci wirtualnej platformy Azure można rozszerzyć sieć lokalną na platformie Azure w bezpieczny sposób.</span><span class="sxs-lookup"><span data-stu-id="4f715-532">The addition of a site-to-site VPN hybrid network connection to an Azure virtual network can extend the on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="4f715-533">Korzystając z połączenia sieci VPN, ruchu są szyfrowane i kieruje za pośrednictwem Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-533">In using a VPN connection, your traffic is encrypted and routes via the Internet.</span></span> <span data-ttu-id="4f715-534">Analizę NVA w tym przykładzie zapewnia centralnej lokalizacji, aby wymusić i zarządzania zasadami zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4f715-534">The NVA in this example provides a central location to enforce and manage the security policy.</span></span> <span data-ttu-id="4f715-535">Aby uzyskać więcej informacji zobacz instrukcje szczegółowe kompilacji (nadchodzącego).</span><span class="sxs-lookup"><span data-stu-id="4f715-535">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="4f715-536">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-536">These instructions include:</span></span>

* <span data-ttu-id="4f715-537">Jak utworzyć ten przykład sieci obwodowej za pomocą skryptów środowiska PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-537">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-538">Jak utworzyć w tym przykładzie z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-538">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-539">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch przechodzi przez ten projekt.</span><span class="sxs-lookup"><span data-stu-id="4f715-539">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway"></a><span data-ttu-id="4f715-540">Przykład 5 Dodaj połączenie hybrydowe z bramą sieci VPN platformy Azure do lokacji,</span><span class="sxs-lookup"><span data-stu-id="4f715-540">Example 5 Add a hybrid connection with a site-to-site, Azure VPN gateway</span></span>
<span data-ttu-id="4f715-541">[Powrót do szybki start](#fast-start) | Szczegółowe instrukcje kompilacji jest dostępny wkrótce</span><span class="sxs-lookup"><span data-stu-id="4f715-541">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="4f715-542">[![14]][14]</span><span class="sxs-lookup"><span data-stu-id="4f715-542">[![14]][14]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-543">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-543">Environment description</span></span>
<span data-ttu-id="4f715-544">Sieci hybrydowe przy użyciu bramy sieci VPN platformy Azure można dodać do dowolnego typu sieci obwodowej opisanego w przykładach 1 lub 2.</span><span class="sxs-lookup"><span data-stu-id="4f715-544">Hybrid networking using an Azure VPN gateway can be added to either perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="4f715-545">Jak pokazano na poprzedniej ilustracji, połączenie sieci VPN za pośrednictwem Internetu (site-to-site) służy do połączyć sieć lokalną sieć wirtualną Azure za pośrednictwem bramy sieci VPN platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-545">As shown in the preceding figure, a VPN connection over the Internet (site-to-site) is used to connect an on-premises network to an Azure virtual network via an Azure VPN gateway.</span></span>

> [!NOTE]
> <span data-ttu-id="4f715-546">Jeśli używasz usługi ExpressRoute z włączoną opcją publicznej komunikacji równorzędnej platformy Azure, należy utworzyć tras statycznych.</span><span class="sxs-lookup"><span data-stu-id="4f715-546">If you use ExpressRoute with the Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="4f715-547">Tej trasy statyczne powinny kierować na adres IP sieci VPN NVA firmowej Internetu, a nie za pośrednictwem sieci WAN ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4f715-547">This  static route should route to the NVA VPN IP address out your corporate Internet and not via the ExpressRoute WAN.</span></span> <span data-ttu-id="4f715-548">Translator adresów Sieciowych wymaganych opcji Azure publicznej komunikacji równorzędnej ExpressRoute mogą być dzielone sesji sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="4f715-548">The NAT required on the ExpressRoute Azure Public Peering option can break the VPN session.</span></span>
>
>

<span data-ttu-id="4f715-549">Na poniższej ilustracji przedstawiono dwie krawędzie sieci, w tym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="4f715-549">The following figure shows the two network edges in this example.</span></span> <span data-ttu-id="4f715-550">Na pierwszym krawędzi przepływów ruchu sieciowego dla sieci w obrębie platformy Azure i platformy Azure i Internet kontrolę NVA i grup NSG.</span><span class="sxs-lookup"><span data-stu-id="4f715-550">On the first edge, the NVA and NSGs control traffic flows for intra-Azure networks and between Azure and the Internet.</span></span> <span data-ttu-id="4f715-551">Drugi krawędź jest brama sieci VPN platformy Azure krawędzi oddzielne sieci między lokalną i platformą Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-551">The second edge is the Azure VPN gateway, which is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="4f715-552">Ruch należy rozważyć dokładnie, jak mogą być optymalizowane lub ograniczone przez ten wzorzec projektowania, w zależności od konkretnych przypadek użycia.</span><span class="sxs-lookup"><span data-stu-id="4f715-552">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="4f715-553">Przy użyciu środowiska wbudowane w przykładzie 1, a następnie dodanie połączenia sieciowego hybrydowego sieci VPN typu lokacja lokacja, tworzy następującego projektu:</span><span class="sxs-lookup"><span data-stu-id="4f715-553">Using the environment built in example 1, and then adding a site-to-site VPN hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="4f715-554">[![15]][15]</span><span class="sxs-lookup"><span data-stu-id="4f715-554">[![15]][15]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-555">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-555">Conclusion</span></span>
<span data-ttu-id="4f715-556">Dodanie połączenia sieciowego hybrydowego site-to-site VPN do sieci wirtualnej platformy Azure można rozszerzyć sieć lokalną na platformie Azure w bezpieczny sposób.</span><span class="sxs-lookup"><span data-stu-id="4f715-556">The addition of a site-to-site VPN hybrid network connection to an Azure virtual network can extend the on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="4f715-557">Za pomocą natywnego bramy sieci VPN platformy Azure, ruchu jest IPSec szyfrowane i tras za pośrednictwem Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-557">Using the native Azure VPN gateway, your traffic is IPSec encrypted and routes via the Internet.</span></span> <span data-ttu-id="4f715-558">Ponadto przy użyciu bramy sieci VPN platformy Azure zapewniają to opcja tanie (nie dodatkowych licencji koszt tak jak w przypadku innych firm NVAs).</span><span class="sxs-lookup"><span data-stu-id="4f715-558">Also, using the Azure VPN gateway can provide a lower-cost option (no additional licensing cost as with third-party NVAs).</span></span> <span data-ttu-id="4f715-559">Ta opcja jest najbardziej ekonomiczne w przykładzie 1, gdzie są używane nie NVA.</span><span class="sxs-lookup"><span data-stu-id="4f715-559">This option is most economical in example 1, where no NVA is used.</span></span> <span data-ttu-id="4f715-560">Aby uzyskać więcej informacji zobacz instrukcje szczegółowe kompilacji (nadchodzącego).</span><span class="sxs-lookup"><span data-stu-id="4f715-560">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="4f715-561">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-561">These instructions include:</span></span>

* <span data-ttu-id="4f715-562">Jak utworzyć ten przykład sieci obwodowej za pomocą skryptów środowiska PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-562">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-563">Jak utworzyć w tym przykładzie z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-563">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-564">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch przechodzi przez ten projekt.</span><span class="sxs-lookup"><span data-stu-id="4f715-564">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-6-add-a-hybrid-connection-with-expressroute"></a><span data-ttu-id="4f715-565">Przykład 6 Dodaj połączenie hybrydowe z usługi ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="4f715-565">Example 6 Add a hybrid connection with ExpressRoute</span></span>
<span data-ttu-id="4f715-566">[Powrót do szybki start](#fast-start) | Szczegółowe instrukcje kompilacji jest dostępny wkrótce</span><span class="sxs-lookup"><span data-stu-id="4f715-566">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="4f715-567">[![16]][16]</span><span class="sxs-lookup"><span data-stu-id="4f715-567">[![16]][16]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="4f715-568">Opis elementu środowiska</span><span class="sxs-lookup"><span data-stu-id="4f715-568">Environment description</span></span>
<span data-ttu-id="4f715-569">Sieci hybrydowe przy użyciu połączenia prywatnej komunikacji równorzędnej ExpressRoute można dodać do dowolnego typu sieci obwodowej opisanego w przykładach 1 lub 2.</span><span class="sxs-lookup"><span data-stu-id="4f715-569">Hybrid networking using an ExpressRoute private peering connection can be added to either perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="4f715-570">Jak pokazano na poprzedniej ilustracji, prywatnej komunikacji równorzędnej ExpressRoute zawiera bezpośrednie połączenie między siecią lokalną a sieci wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-570">As shown in the preceding figure, ExpressRoute private peering provides a direct connection between your on-premises network and the Azure virtual network.</span></span> <span data-ttu-id="4f715-571">Ruch transits sieci dostawcy usług i sieci Microsoft Azure, nie ingerując w Internecie.</span><span class="sxs-lookup"><span data-stu-id="4f715-571">Traffic transits only the service provider network and the Microsoft Azure network, never touching the Internet.</span></span>

> [!TIP]
> <span data-ttu-id="4f715-572">Przy użyciu usługi ExpressRoute przechowuje ruchu w sieci firmowej z Internetu.</span><span class="sxs-lookup"><span data-stu-id="4f715-572">Using ExpressRoute keeps corporate network traffic off the Internet.</span></span> <span data-ttu-id="4f715-573">Pozwala także umów dotyczących poziomu usług z dostawcy usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4f715-573">It also allows for service level agreements from your ExpressRoute provider.</span></span> <span data-ttu-id="4f715-574">Brama Azure można przekazać do 10 GB/s z usługi ExpressRoute, z sieci VPN typu lokacja lokacja, maksymalną przepływność bramy Azure jest 200 MB/s.</span><span class="sxs-lookup"><span data-stu-id="4f715-574">The Azure Gateway can pass up to 10 Gbps with ExpressRoute, whereas with site-to-site VPNs, the Azure Gateway maximum throughput is 200 Mbps.</span></span>
>
>

<span data-ttu-id="4f715-575">Jak pokazano na poniższym diagramie, po wybraniu tej opcji środowiska ma teraz dwie krawędzie sieci.</span><span class="sxs-lookup"><span data-stu-id="4f715-575">As seen in the following diagram, with this option the environment now has two network edges.</span></span> <span data-ttu-id="4f715-576">NVA i NSG kontroli przepływów ruchu sieciowego dla sieci w obrębie platformy Azure i Azure od Internetu, gdy brama jest krawędzi oddzielne sieci między lokalną i platformą Azure.</span><span class="sxs-lookup"><span data-stu-id="4f715-576">The NVA and NSG control traffic flows for intra-Azure networks and between Azure and the Internet, while the gateway is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="4f715-577">Ruch należy rozważyć dokładnie, jak mogą być optymalizowane lub ograniczone przez ten wzorzec projektowania, w zależności od konkretnych przypadek użycia.</span><span class="sxs-lookup"><span data-stu-id="4f715-577">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="4f715-578">Przy użyciu środowiska wbudowane w przykładzie 1, a następnie dodanie połączenia sieciowego hybrydowego usługi ExpressRoute, tworzy następującego projektu:</span><span class="sxs-lookup"><span data-stu-id="4f715-578">Using the environment built in example 1, and then adding an ExpressRoute hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="4f715-579">[![17]][17]</span><span class="sxs-lookup"><span data-stu-id="4f715-579">[![17]][17]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="4f715-580">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="4f715-580">Conclusion</span></span>
<span data-ttu-id="4f715-581">Dodanie połączenia sieciowego w komunikacji równorzędnej ExpressRoute prywatnego można rozszerzyć sieć lokalną na platformie Azure w bezpieczny, dolna opóźnienia nowszego wykonywania sposób.</span><span class="sxs-lookup"><span data-stu-id="4f715-581">The addition of an ExpressRoute Private Peering network connection can extend the on-premises network into Azure in a secure, lower latency, higher performing manner.</span></span> <span data-ttu-id="4f715-582">Ponadto za pomocą natywnego bramy Azure, jak w poniższym przykładzie zapewnia opcję tanie (Brak dodatkowych licencjonowania, podobnie jak w przypadku innych firm NVAs).</span><span class="sxs-lookup"><span data-stu-id="4f715-582">Also, using the native Azure Gateway, as in this example, provides a lower-cost option (no additional licensing as with third-party NVAs).</span></span> <span data-ttu-id="4f715-583">Aby uzyskać więcej informacji zobacz instrukcje szczegółowe kompilacji (nadchodzącego).</span><span class="sxs-lookup"><span data-stu-id="4f715-583">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="4f715-584">Instrukcje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="4f715-584">These instructions include:</span></span>

* <span data-ttu-id="4f715-585">Jak utworzyć ten przykład sieci obwodowej za pomocą skryptów środowiska PowerShell.</span><span class="sxs-lookup"><span data-stu-id="4f715-585">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="4f715-586">Jak utworzyć w tym przykładzie z szablonem usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="4f715-586">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="4f715-587">Scenariusze przepływu ruchu szczegółowe, przedstawiający sposób ruch przechodzi przez ten projekt.</span><span class="sxs-lookup"><span data-stu-id="4f715-587">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

## <a name="references"></a><span data-ttu-id="4f715-588">Dokumentacja</span><span class="sxs-lookup"><span data-stu-id="4f715-588">References</span></span>
### <a name="helpful-websites-and-documentation"></a><span data-ttu-id="4f715-589">Przydatne witryn sieci Web i dokumentacji</span><span class="sxs-lookup"><span data-stu-id="4f715-589">Helpful websites and documentation</span></span>
* <span data-ttu-id="4f715-590">Dostęp do platformy Azure z usługą Azure Resource Manager:</span><span class="sxs-lookup"><span data-stu-id="4f715-590">Access Azure with Azure Resource Manager:</span></span>
* <span data-ttu-id="4f715-591">Uzyskiwanie dostępu do platformy Azure przy użyciu programu PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span><span class="sxs-lookup"><span data-stu-id="4f715-591">Accessing Azure with PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span></span>
* <span data-ttu-id="4f715-592">Dokumentacja sieci wirtualnych: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span><span class="sxs-lookup"><span data-stu-id="4f715-592">Virtual networking documentation: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span></span>
* <span data-ttu-id="4f715-593">Dokumentacja grupy zabezpieczeń sieci: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span><span class="sxs-lookup"><span data-stu-id="4f715-593">Network security group documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span></span>
* <span data-ttu-id="4f715-594">Zdefiniowane przez użytkownika routingu dokumentacji: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span><span class="sxs-lookup"><span data-stu-id="4f715-594">User-defined routing documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span></span>
* <span data-ttu-id="4f715-595">Azure bram wirtualnego: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span><span class="sxs-lookup"><span data-stu-id="4f715-595">Azure virtual gateways: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span></span>
* <span data-ttu-id="4f715-596">Sieci VPN typu lokacja lokacja: [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="4f715-596">Site-to-Site VPNs: [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span></span>
* <span data-ttu-id="4f715-597">Dokumentacja usługi ExpressRoute (należy sprawdzić w sekcji "Wprowadzenie" i "How"): [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span><span class="sxs-lookup"><span data-stu-id="4f715-597">ExpressRoute documentation (be sure to check out the “Getting Started” and “How To” sections): [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span></span>

<!--Image References-->
<span data-ttu-id="4f715-598">[0]: ./media/best-practices-network-security/flowchart.png "Schemat blokowy opcji zabezpieczeń"</span><span class="sxs-lookup"><span data-stu-id="4f715-598">[0]: ./media/best-practices-network-security/flowchart.png "Security Options Flowchart"</span></span>
<span data-ttu-id="4f715-599">[2]: ./media/best-practices-network-security/azuresecurityfeatures.png "funkcje zabezpieczeń platformy azure"</span><span class="sxs-lookup"><span data-stu-id="4f715-599">[2]: ./media/best-practices-network-security/azuresecurityfeatures.png "Azure Security Features"</span></span>
<span data-ttu-id="4f715-600">[3]: ./media/best-practices-network-security/dmzcorporate.png "DMZ A w sieci firmowej"</span><span class="sxs-lookup"><span data-stu-id="4f715-600">[3]: ./media/best-practices-network-security/dmzcorporate.png "A DMZ in a Corporate network"</span></span>
<span data-ttu-id="4f715-601">[4]: ./media/best-practices-network-security/azuresecurityarchitecture.png "architektury zabezpieczeń platformy azure"</span><span class="sxs-lookup"><span data-stu-id="4f715-601">[4]: ./media/best-practices-network-security/azuresecurityarchitecture.png "Azure Security Architecture"</span></span>
<span data-ttu-id="4f715-602">[5]: ./media/best-practices-network-security/dmzazure.png "DMZ w sieci wirtualnej platformy Azure"</span><span class="sxs-lookup"><span data-stu-id="4f715-602">[5]: ./media/best-practices-network-security/dmzazure.png "A DMZ in an Azure Virtual Network"</span></span>
<span data-ttu-id="4f715-603">[6]: ./media/best-practices-network-security/dmzhybrid.png "sieci hybrydowe za pomocą trzech granic zabezpieczeń"</span><span class="sxs-lookup"><span data-stu-id="4f715-603">[6]: ./media/best-practices-network-security/dmzhybrid.png "Hybrid Network with Three Security Boundaries"</span></span>
<span data-ttu-id="4f715-604">[7]: ./media/best-practices-network-security/example1design.png "Przychodzący DMZ z grupy NSG"</span><span class="sxs-lookup"><span data-stu-id="4f715-604">[7]: ./media/best-practices-network-security/example1design.png "Inbound DMZ with NSG"</span></span>
<span data-ttu-id="4f715-605">[8]: ./media/best-practices-network-security/example2design.png "Przychodzący DMZ NVA i grupy NSG"</span><span class="sxs-lookup"><span data-stu-id="4f715-605">[8]: ./media/best-practices-network-security/example2design.png "Inbound DMZ with NVA and NSG"</span></span>
<span data-ttu-id="4f715-606">[9]: ./media/best-practices-network-security/example3design.png "Dwukierunkowe DMZ NVA, NSG i przez"</span><span class="sxs-lookup"><span data-stu-id="4f715-606">[9]: ./media/best-practices-network-security/example3design.png "Bi-directional DMZ with NVA, NSG, and UDR"</span></span>
<span data-ttu-id="4f715-607">[10]: ./media/best-practices-network-security/example3firewalllogical.png "widok logiczny reguł zapory"</span><span class="sxs-lookup"><span data-stu-id="4f715-607">[10]: ./media/best-practices-network-security/example3firewalllogical.png "Logical View of the Firewall Rules"</span></span>
<span data-ttu-id="4f715-608">[11]: ./media/best-practices-network-security/example3designoptions.png "DMZ z NVA połączonych sieci hybrydowe"</span><span class="sxs-lookup"><span data-stu-id="4f715-608">[11]: ./media/best-practices-network-security/example3designoptions.png "DMZ with NVA Connected Hybrid Network"</span></span>
<span data-ttu-id="4f715-609">[12]: ./media/best-practices-network-security/example4designs2s.png "DMZ z NVA nawiązano połączenie przy użyciu sieci VPN lokacja lokacja"</span><span class="sxs-lookup"><span data-stu-id="4f715-609">[12]: ./media/best-practices-network-security/example4designs2s.png "DMZ with NVA Connected Using a Site-to-Site VPN"</span></span>
<span data-ttu-id="4f715-610">[13]: ./media/best-practices-network-security/example4networklogical.png "sieci logicznej z punktu widzenia NVA"</span><span class="sxs-lookup"><span data-stu-id="4f715-610">[13]: ./media/best-practices-network-security/example4networklogical.png "Logical Network from NVA Perspective"</span></span>
<span data-ttu-id="4f715-611">[14]: ./media/best-practices-network-security/example5designoptions.png "DMZ Azure bramy połączonej sieci hybrydowe lokacja lokacja"</span><span class="sxs-lookup"><span data-stu-id="4f715-611">[14]: ./media/best-practices-network-security/example5designoptions.png "DMZ with Azure Gateway Connected Site-to-Site Hybrid Network"</span></span>
<span data-ttu-id="4f715-612">[15]: ./media/best-practices-network-security/example5designs2s.png "DMZ Azure bramy przy użyciu sieci VPN lokacja lokacja"</span><span class="sxs-lookup"><span data-stu-id="4f715-612">[15]: ./media/best-practices-network-security/example5designs2s.png "DMZ with Azure Gateway Using Site-to-Site VPN"</span></span>
<span data-ttu-id="4f715-613">[16]: ./media/best-practices-network-security/example6designoptions.png "DMZ Azure bramy połączonej sieci hybrydowe usługi ExpressRoute"</span><span class="sxs-lookup"><span data-stu-id="4f715-613">[16]: ./media/best-practices-network-security/example6designoptions.png "DMZ with Azure Gateway Connected ExpressRoute Hybrid Network"</span></span>
<span data-ttu-id="4f715-614">[17]: ./media/best-practices-network-security/example6designexpressroute.png "DMZ Azure bramy przy użyciu połączenia ExpressRoute"</span><span class="sxs-lookup"><span data-stu-id="4f715-614">[17]: ./media/best-practices-network-security/example6designexpressroute.png "DMZ with Azure Gateway Using an ExpressRoute Connection"</span></span>

<!--Link References-->
[TrustCenter]: https://azure.microsoft.com/support/trust-center/compliance/
[Example1]: ./virtual-network/virtual-networks-dmz-nsg.md
[Example2]: ./virtual-network/virtual-networks-dmz-nsg-fw-asm.md
[Example3]: ./virtual-network/virtual-networks-dmz-nsg-fw-udr-asm.md
[Example4]: ./virtual-network/virtual-networks-hybrid-s2s-nva-asm.md
[Example5]: ./virtual-network/virtual-networks-hybrid-s2s-agw-asm.md
[Example6]: ./virtual-network/virtual-networks-hybrid-expressroute-asm.md
[Example7]: ./virtual-network/virtual-networks-vnet2vnet-direct-asm.md
[Example8]: ./virtual-network/virtual-networks-vnet2vnet-transit-asm.md
