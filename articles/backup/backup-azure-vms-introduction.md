---
title: aaaPlanning infrastruktury kopii zapasowych maszyn wirtualnych na platformie Azure | Dokumentacja firmy Microsoft
description: "Ważne uwagi dotyczące planowania tooback zapasowych maszyn wirtualnych na platformie Azure"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "Wykonaj kopię zapasową maszyn wirtualnych, kopii zapasowych maszyn wirtualnych"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="8bd4f-104">Planowanie infrastruktury kopii zapasowych maszyny wirtualnej na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="8bd4f-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="8bd4f-105">Ten artykuł zawiera wydajności i zasobów sugestie toohelp zaplanować infrastrukturę kopii zapasowej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="8bd4f-106">Definiuje również kluczowych aspektów usługi Kopia zapasowa hello; te aspekty może mieć decydujące znaczenie dla określenia architektury, planowanie pojemności i planowania.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="8bd4f-107">Jeśli znasz [przygotować środowisko](backup-azure-vms-prepare.md), planowania jest hello następnego kroku, przed rozpoczęciem [tooback zapasowych maszyn wirtualnych](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="8bd4f-108">Aby uzyskać więcej informacji o maszynach wirtualnych platformy Azure, zobacz hello [dokumentacji maszyn wirtualnych](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="8bd4f-109">Jak Azure wykonywanie kopii zapasowych maszyn wirtualnych?</span><span class="sxs-lookup"><span data-stu-id="8bd4f-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="8bd4f-110">Gdy hello usługi Kopia zapasowa Azure inicjuje zadania tworzenia kopii zapasowej w czasie hello zaplanowane, wyzwala hello zapasowy numer wewnętrzny tootake migawki punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="8bd4f-111">Witaj usługi Kopia zapasowa Azure korzysta hello _VMSnapshot_ rozszerzenia w systemie Windows i hello _VMSnapshotLinux_ rozszerzenia w systemie Linux.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="8bd4f-112">Podczas tworzenia kopii zapasowej maszyny Wirtualnej pierwszej hello zainstalowano rozszerzenia Hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="8bd4f-113">rozszerzenie hello tooinstall, musi być uruchomiona hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="8bd4f-114">Jeśli hello maszyna wirtualna nie jest uruchomiona, hello usługi Kopia zapasowa tworzy migawkę hello bazowy magazynu (ponieważ nie zapisy aplikacji występuje podczas powitalne zatrzymaniu maszyny Wirtualnej).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="8bd4f-115">Podczas wykonywania migawki maszyn wirtualnych systemu Windows, usługi Kopia zapasowa hello koordynuje z tooget usługi kopiowania woluminów w tle (VSS) hello spójne migawek dysków maszyny wirtualnej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="8bd4f-116">Jeśli tworzysz kopię zapasową maszyn wirtualnych systemu Linux, można napisać własne niestandardowe skrypty tooensure spójności podczas wykonywania migawki maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="8bd4f-117">Szczegółowe informacje na temat wywoływania tych skryptów znajdują się w dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="8bd4f-118">Witaj usługi Kopia zapasowa Azure wykonuje migawkę hello, hello danych po toohello przekazanych magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="8bd4f-119">wydajność toomaximize hello usługa identyfikuje i transferuje tylko hello bloki danych, które uległy zmianie od czasu poprzedniej kopii zapasowej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Architektura kopii zapasowych maszyny wirtualnej platformy Azure](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="8bd4f-121">Po ukończeniu transferu danych hello hello migawka zostanie usunięta i utworzenia punktu odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="8bd4f-122">Podczas procesu tworzenia kopii zapasowej hello kopia zapasowa Azure nie zawiera maszyny wirtualnej toohello dysku tymczasowego hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="8bd4f-123">Aby uzyskać więcej informacji, zobacz hello blog na [magazyn tymczasowy](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="8bd4f-124">Ponieważ kopia zapasowa Azure przyjmuje migawki poziom miejsca do magazynowania i operacje transferu migawki toovault, nie należy zmieniać klucze konta magazynu hello zakończenie hello zadanie tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="8bd4f-125">Dla maszyn wirtualnych w warstwie premium skopiowane hello migawki toostorage konta.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="8bd4f-126">Jest to toomake się upewnić, że usługa Kopia zapasowa Azure pobiera wystarczające IOPS transferowania danych toovault.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="8bd4f-127">To dodatkowe kopię magazynu jest pobierana zgodnie z harmonogramem hello przydzielony rozmiar maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="8bd4f-128">Spójność danych</span><span class="sxs-lookup"><span data-stu-id="8bd4f-128">Data consistency</span></span>
<span data-ttu-id="8bd4f-129">Tworzenie kopii zapasowej i przywracanie krytyczne dane biznesowe jest skomplikowany hello fakt, że krytyczne dane biznesowe musi kopii zapasowej podczas aplikacji hello, które wywołują powitalne danych są uruchomione.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="8bd4f-130">tooaddress, kopia zapasowa Azure obsługuje spójnych z aplikacją kopii zapasowych dla systemu Windows i maszyn wirtualnych systemu Linux</span><span class="sxs-lookup"><span data-stu-id="8bd4f-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="8bd4f-131">Maszyna wirtualna z systemem Windows</span><span class="sxs-lookup"><span data-stu-id="8bd4f-131">Windows VM</span></span>
<span data-ttu-id="8bd4f-132">Kopia zapasowa Azure przejmuje VSS pełnych kopii zapasowych maszyn wirtualnych systemu Windows (Dowiedz się więcej o [pełna kopia zapasowa VSS](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="8bd4f-133">tooenable VSS skopiowanie kopii zapasowych, powitania po zestawie toobe potrzeb klucza rejestru na powitania maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="8bd4f-134">Maszyny wirtualne z systemem Linux</span><span class="sxs-lookup"><span data-stu-id="8bd4f-134">Linux VMs</span></span>
<span data-ttu-id="8bd4f-135">Kopia zapasowa Azure zapewnia platformę skryptów.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="8bd4f-136">tooensure spójności aplikacji, podczas tworzenia kopii zapasowej maszyn wirtualnych systemu Linux, Utwórz niestandardowe skrypty przed i po skrypty, które kontroli przepływu pracy tworzenia kopii zapasowej hello i środowiska.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="8bd4f-137">Kopia zapasowa Azure wywołuje skrypt wstępne hello przed wykonaniem migawki maszyny Wirtualnej hello i wywołuje skrypt po powitania po zakończeniu zadania migawki maszyny Wirtualnej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="8bd4f-138">Aby uzyskać więcej informacji, zobacz [aplikacji spójne wirtualna kopii zapasowych przy użyciu skryptów przed i po skrypt](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="8bd4f-139">Kopia zapasowa Azure wywołuje tylko hello zapisywane klienta przed i po skryptów.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="8bd4f-140">Jeśli hello skryptów przed i po skryptów zostanie wykonane pomyślnie, kopia zapasowa Azure oznacza punkt odzyskiwania hello jako aplikacji spójne.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="8bd4f-141">Jednak powitania klienta jest odpowiedzialny hello spójności aplikacji, korzystając z niestandardowych skryptów.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="8bd4f-142">W następującej tabeli opisano typy hello warunków spójności i hello wystąpić w podczas tworzenia kopii zapasowej maszyny Wirtualnej platformy Azure i przywrócić procedur.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="8bd4f-143">Spójność</span><span class="sxs-lookup"><span data-stu-id="8bd4f-143">Consistency</span></span> | <span data-ttu-id="8bd4f-144">Na podstawie usługi VSS</span><span class="sxs-lookup"><span data-stu-id="8bd4f-144">VSS-based</span></span> | <span data-ttu-id="8bd4f-145">Objaśnienie i szczegóły</span><span class="sxs-lookup"><span data-stu-id="8bd4f-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8bd4f-146">Spójność aplikacji</span><span class="sxs-lookup"><span data-stu-id="8bd4f-146">Application consistency</span></span> |<span data-ttu-id="8bd4f-147">Tak dla systemu Windows</span><span class="sxs-lookup"><span data-stu-id="8bd4f-147">Yes for Windows</span></span>|<span data-ttu-id="8bd4f-148">Spójność aplikacji jest idealne dla obciążeń, zapewnia, że:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="8bd4f-149">Witaj wirtualna *rozruch*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="8bd4f-150">Brak *nie uszkodzenie*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-150">There is *no corruption*.</span></span> <li><span data-ttu-id="8bd4f-151">Brak *bez utraty danych*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-151">There is *no data loss*.</span></span><li> <span data-ttu-id="8bd4f-152">dane Hello są aplikacji toohello spójne, która używa danych hello poprzez włączenie aplikacji hello w czasie hello kopii zapasowej — za pomocą usługi VSS lub poprzedzającego utworzenie kopii zapasowej lub używanego po skryptu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="8bd4f-153">*Maszyny wirtualne systemu Windows*-obciążeń najbardziej firmy Microsoft ma składniki zapisywania usługi VSS, które wykonują akcje specyficznego dla obciążenia powiązanych toodata spójności.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="8bd4f-154">Na przykład Microsoft SQL Server ma składnik zapisywania usługi VSS, które powodują, czy plik dziennika transakcji hello zapisy toohello i hello bazy danych są wykonywane prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="8bd4f-155">Kopii zapasowych maszyny Wirtualnej systemu Windows Azure, toocreate punktów odzyskiwania zapewniających spójność aplikacji hello zapasowy numer wewnętrzny należy wywołać przepływu pracy usługi VSS hello i on zostać ukończona przed wykonaniem migawki maszyny Wirtualnej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="8bd4f-156">Witaj maszyny Wirtualnej Azure migawki toobe dokładne składniki zapisywania usługi VSS hello wszystkich aplikacji w maszynie Wirtualnej platformy Azure należy wykonać również.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="8bd4f-157">(Dowiedz się hello [podstawy VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) i Poznaj głębokość szczegóły hello [jej działania](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="8bd4f-158">*Maszyny wirtualne systemu Linux*— klienci mogą wykonywać [spójności aplikacji niestandardowych skryptów przed i po skryptu tooensure](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="8bd4f-159">Spójności systemu plików</span><span class="sxs-lookup"><span data-stu-id="8bd4f-159">File-system consistency</span></span> |<span data-ttu-id="8bd4f-160">Tak — w przypadku komputerów z systemem Windows</span><span class="sxs-lookup"><span data-stu-id="8bd4f-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="8bd4f-161">Istnieją dwa scenariusze, w którym hello punkt odzyskiwania może być *systemu plików spójne*:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="8bd4f-162">Tworzenie kopii zapasowych maszyn wirtualnych systemu Linux na platformie Azure, bez wstępnie przygotowany-script/po-script lub jeśli wstępnie przygotowany-script/po-script nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="8bd4f-163">Błąd VSS podczas tworzenia kopii zapasowej dla maszyn wirtualnych systemu Windows na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="8bd4f-164">W obu przypadkach hello najlepsze, którą można wykonać jest tooensure który:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="8bd4f-165">Witaj wirtualna *rozruch*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="8bd4f-166">Brak *nie uszkodzenie*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-166">There is *no corruption*.</span></span><li><span data-ttu-id="8bd4f-167">Brak *bez utraty danych*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="8bd4f-168">Aplikacje muszą mechanizm tooimplement własnych "konfigurowania" hello przywrócić danych.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="8bd4f-169">Spójność awarii</span><span class="sxs-lookup"><span data-stu-id="8bd4f-169">Crash consistency</span></span> |<span data-ttu-id="8bd4f-170">Nie</span><span class="sxs-lookup"><span data-stu-id="8bd4f-170">No</span></span> |<span data-ttu-id="8bd4f-171">Ta sytuacja jest równoważne tooa maszyny wirtualnej występuje "awarii" (za pośrednictwem zmiennego lub stałego reset).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="8bd4f-172">Spójność awarii zwykle odbywa się podczas zamykania hello Azure maszyny wirtualnej w czasie hello kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="8bd4f-173">Punkt odzyskiwania spójna w razie awarii zapewnia żadnych gwarancji wokół hello spójności danych hello na nośniku magazynowania hello — albo z punktu widzenia hello hello systemu operacyjnego lub aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="8bd4f-174">Tylko dane hello, która już istnieje na dysku hello w czasie hello kopii zapasowej zostaną zebrane i kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="8bd4f-175">Gdy są zazwyczaj żadnych gwarancji, hello uruchomieniem systemu operacyjnego, a następnie sprawdzając dysku procedury, takich jak narzędzia chkdsk, toofix błędy uszkodzenia.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="8bd4f-176">Wszystkie dane w pamięci lub zapisy, które nie zostały przeniesione toohello dysku zostaną utracone.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="8bd4f-177">aplikacji Hello zazwyczaj wynika z mechanizm weryfikacji w przypadku wycofywania danych wymaga toobe gotowe.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="8bd4f-178">Na przykład jeśli dziennik transakcji hello ma wpisów, które nie są dostępne w bazie danych hello, następnie hello oprogramowanie bazy danych nie wycofanie dopóki dane hello są spójne.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="8bd4f-179">W przypadku danych zostanie rozmieszczona na wielu dyskach wirtualnych (takich jak woluminy łączone), punkt odzyskiwania spójna w razie awarii zapewnia żadnych gwarancji pod kątem poprawności hello hello danych.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="8bd4f-180">Wydajności i użycia zasobów</span><span class="sxs-lookup"><span data-stu-id="8bd4f-180">Performance and resource utilization</span></span>
<span data-ttu-id="8bd4f-181">Podobnie jak oprogramowanie kopii zapasowej jest wdrożony lokalnymi należy zaplanować pojemności i wykorzystania zasobów potrzeby podczas tworzenia kopii zapasowych maszyn wirtualnych na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="8bd4f-182">Witaj [magazyn Azure ogranicza](../azure-subscription-service-limits.md#storage-limits) zdefiniuj wpływ obciążeń toorunning toostructure wirtualna wdrożeń tooget maksymalną wydajność co najmniej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="8bd4f-183">Należy zwrócić uwagę toohello, który ogranicza następujące usługi Azure Storage, podczas planowania wydajności tworzenia kopii zapasowych:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="8bd4f-184">Maksymalna liczba wyjście na konto magazynu</span><span class="sxs-lookup"><span data-stu-id="8bd4f-184">Max egress per storage account</span></span>
* <span data-ttu-id="8bd4f-185">Całkowita liczba żądań stawka za transakcje konta magazynu</span><span class="sxs-lookup"><span data-stu-id="8bd4f-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="8bd4f-186">Limity konta magazynu</span><span class="sxs-lookup"><span data-stu-id="8bd4f-186">Storage account limits</span></span>
<span data-ttu-id="8bd4f-187">Dane kopii zapasowej skopiowane z konta magazynu, dodaje toohello operacje wejścia/wyjścia na sekundę (IOPS) i transfer danych wychodzących (lub przepływności) metryki hello konta magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="8bd4f-188">At hello sam maszyny czasu, wirtualne zużywają również IOPS i przepustowość.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="8bd4f-189">Celem Hello jest tooensure kopii zapasowej i ruch maszyny wirtualnej nie może przekraczać swoje limity konta magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="8bd4f-190">Liczba dysków</span><span class="sxs-lookup"><span data-stu-id="8bd4f-190">Number of disks</span></span>
<span data-ttu-id="8bd4f-191">proces tworzenia kopii zapasowej Hello możliwie jak najszybciej próbuje toocomplete zadania tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="8bd4f-192">W ten sposób zużywa można dowolną liczbą zasobów.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="8bd4f-193">Jednak wszystkie operacje We/Wy są ograniczone przez hello *przepływność docelowy dla pojedynczego obiektu Blob*, która ma ograniczenie 60 MB na sekundę.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="8bd4f-194">Szybko, proces tworzenia kopii zapasowej hello próbuje — w toomaximize próba tooback hello wirtualna dysków zapasowych *równolegle*.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="8bd4f-195">Jeśli maszyna wirtualna ma cztery dyski, usługa hello podejmuje próby tooback się wszystkie cztery dyski równolegle.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="8bd4f-196">Witaj **liczba dysków** tworzona kopia zapasowa, jest hello najważniejszym czynnikiem umożliwiającym określenie ruch kopii zapasowej konta magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="8bd4f-197">Harmonogram tworzenia kopii zapasowych</span><span class="sxs-lookup"><span data-stu-id="8bd4f-197">Backup schedule</span></span>
<span data-ttu-id="8bd4f-198">Dodatkowy czynnik, który ma wpływ na wydajność jest hello **harmonogram tworzenia kopii zapasowych**.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="8bd4f-199">Jeśli możesz skonfigurować zasady hello, wszystkie maszyny wirtualne kopie zapasowe są tworzone na powitania sam czas zaplanowano zakleszczenie ruchu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="8bd4f-200">proces tworzenia kopii zapasowej Hello prób tooback się wszystkie dyski równolegle.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="8bd4f-201">tooreduce hello kopii zapasowej ruchu z konta magazynu, wykonywanie kopii zapasowych różnych maszyn wirtualnych różnych porze dnia hello, bez nakładania się.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="8bd4f-202">Planowanie pojemności</span><span class="sxs-lookup"><span data-stu-id="8bd4f-202">Capacity planning</span></span>
<span data-ttu-id="8bd4f-203">Zestawienie hello poprzedniej czynników, należy tooplan na potrzeby użycia konta magazynu hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="8bd4f-204">Pobierz hello [pojemności kopii zapasowej maszyny Wirtualnej, arkusz kalkulacyjny programu Excel planowania](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello wpływ dysku i harmonogram tworzenia kopii zapasowych wyborów.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="8bd4f-205">Przepustowość kopii zapasowej</span><span class="sxs-lookup"><span data-stu-id="8bd4f-205">Backup throughput</span></span>
<span data-ttu-id="8bd4f-206">Dla każdego dysku tworzona kopia zapasowa Azure Backup odczytuje hello bloków na dysku hello i magazyny hello tylko zmienione dane (przyrostowej kopii zapasowej).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="8bd4f-207">Hello poniższej tabeli przedstawiono wartości przepływności usługi Kopia zapasowa hello średnia.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="8bd4f-208">Przy użyciu hello następujące dane, można oszacować, że hello ilość czasu wymagane tooback zapasowej dysku na dany rozmiar.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="8bd4f-209">Operacja tworzenia kopii zapasowej</span><span class="sxs-lookup"><span data-stu-id="8bd4f-209">Backup operation</span></span> | <span data-ttu-id="8bd4f-210">Najlepszym przepływności</span><span class="sxs-lookup"><span data-stu-id="8bd4f-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="8bd4f-211">Początkowa kopia zapasowa</span><span class="sxs-lookup"><span data-stu-id="8bd4f-211">Initial backup</span></span> |<span data-ttu-id="8bd4f-212">160 MB/s</span><span class="sxs-lookup"><span data-stu-id="8bd4f-212">160 Mbps</span></span> |
| <span data-ttu-id="8bd4f-213">Przyrostowej kopii zapasowej (DR)</span><span class="sxs-lookup"><span data-stu-id="8bd4f-213">Incremental backup (DR)</span></span> |<span data-ttu-id="8bd4f-214">640 MB/s</span><span class="sxs-lookup"><span data-stu-id="8bd4f-214">640 Mbps</span></span> <br><br> <span data-ttu-id="8bd4f-215">Przepływność porzucania znacznie zmiana hello dane (wymagające toobe kopię zapasową) są rozsyłane na powitania dysku.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="8bd4f-216">Łączny czas tworzenia kopii zapasowej maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="8bd4f-216">Total VM backup time</span></span>
<span data-ttu-id="8bd4f-217">Podczas gdy większość czasu tworzenia kopii zapasowej hello jest poświęcony na odczytywanie i kopiowanie danych, innych operacji współtworzenia tooback całkowity czas potrzebny toohello zapasowej maszyny Wirtualnej:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="8bd4f-218">Czas potrzebny zbyt[Zainstaluj lub zaktualizuj zapasowy numer wewnętrzny hello](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="8bd4f-219">Czas migawki jest tootrigger czas poświęcony na powitania migawki.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="8bd4f-220">Migawki są wyzwalane toohello Zamknij zaplanowane wykonywania kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="8bd4f-221">Czas oczekiwania w kolejce.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-221">Queue wait time.</span></span> <span data-ttu-id="8bd4f-222">Ponieważ usługa kopii zapasowej hello przetwarza kopii zapasowych z wielu klientów, kopiując dane kopii zapasowej z kopii zapasowej migawki toohello lub usług odzyskiwania magazynu może nie rozpocząć się natychmiast.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="8bd4f-223">W godzinach szczytu obciążenia oczekiwania hello można stretch się tooeight liczba godzin korzystania z powodu toohello liczbę kopii zapasowych przetwarzane.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="8bd4f-224">Jednak całkowity czas tworzenia kopii zapasowej hello maszyny Wirtualnej jest krótszy niż 24 godziny dla zasad tworzenia kopii zapasowych codziennie.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="8bd4f-225">Czas transferu danych, czas potrzebny do utworzenia kopii zapasowej toocompute hello przyrostowe zmiany z poprzedniej kopii zapasowej usług i przenieść magazyn toovault tych zmian.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="8bd4f-226">Dlaczego mam obserwowania longer(>12 hours) kopii zapasowej czas?</span><span class="sxs-lookup"><span data-stu-id="8bd4f-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="8bd4f-227">Kopia zapasowa składa się z dwóch faz: tworzenie migawek i przesyłania hello magazynu toohello migawki.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="8bd4f-228">optymalizuje Hello usługi Kopia zapasowa dla magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="8bd4f-229">Podczas przenoszenia hello migawki danych tooa magazynu, usługa hello tylko przesyła zmiany przyrostowe z hello poprzednią migawkę.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="8bd4f-230">toodetermine hello przyrostowe zmiany hello usługi oblicza sumę kontrolną hello hello bloków.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="8bd4f-231">Zmiana bloku bloku hello jest rozpoznawany jako toobe bloku, wysyłane toohello magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="8bd4f-232">Następnie ćwiczenia usługi hello dalsze do każdego hello zidentyfikować bloków, wyszukiwanie tootransfer danych hello toominimize możliwości.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="8bd4f-233">Po przeprowadzeniu oceny wszystkie zmienione bloki, usługa hello łączy hello zmiany i wysyła je toohello magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="8bd4f-234">W niektórych starszych aplikacji małe, pofragmentowane zapisy nie są optymalne dla magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="8bd4f-235">Jeśli migawki hello zawiera wiele małych, pofragmentowane zapisy, usługa hello spędza dodatkowy czas przetwarzania danych hello napisane przez aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="8bd4f-236">Witaj zalecane bloku zapisu aplikacji z platformy Azure, w przypadku aplikacji uruchamianych wewnątrz hello maszyny Wirtualnej, jest co najmniej 8 KB.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="8bd4f-237">Jeśli aplikacja korzysta z bloku mniej niż 8 KB, odbywa się wydajność tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="8bd4f-238">Aby uzyskać pomoc dotyczącą dostrajania wydajności tworzenia kopii zapasowych tooimprove aplikacji, zobacz [Dostrajanie aplikacji, aby uzyskać optymalną wydajność z usługą Azure storage](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="8bd4f-239">Chociaż artykuł hello na wydajność tworzenia kopii zapasowej używa przykłady magazynu Premium, wskazówki hello dotyczy dyski magazynu w warstwie standardowa.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="8bd4f-240">Przywracanie całkowity czas</span><span class="sxs-lookup"><span data-stu-id="8bd4f-240">Total restore time</span></span>
<span data-ttu-id="8bd4f-241">Operacja przywracania składa się z dwóch zadań main sub: kopiowanie danych z konta magazynu hello magazynu toohello wybranego klienta i tworzenie maszyny wirtualnej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="8bd4f-242">Kopiowanie danych z magazynu hello zależy od tego, gdzie hello kopie zapasowe są wewnętrznie przechowywane na platformie Azure i przechowywania konta magazynu powitania klienta.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="8bd4f-243">Czas poświęcony na toocopy danych zależy od:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="8bd4f-244">Czas — oczekiwania w kolejce ponieważ hello usługa przetwarza przywrócić zadania z wielu klientów na powitania tym samym czasie, przywracanie żądania są umieszczone w kolejce.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="8bd4f-245">Czas — kopiowania danych dane są kopiowane z konta magazynu hello magazynu toohello klienta.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="8bd4f-246">Przywróć czas zależy od IOPS i pobiera przepływności usługi Kopia zapasowa Azure na koncie magazynu wybrane powitania klienta.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="8bd4f-247">tooreduce hello kopiowanie czas podczas procesu przywracania hello, wybierz konto magazynu nie został załadowany z innych aplikacji zapisami i odczytami.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="8bd4f-248">Najlepsze praktyki</span><span class="sxs-lookup"><span data-stu-id="8bd4f-248">Best practices</span></span>
<span data-ttu-id="8bd4f-249">Sugerujemy następujące te wskazówki podczas konfigurowania kopii zapasowych maszyn wirtualnych:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="8bd4f-250">Nie zaplanować więcej niż 10 klasycznych maszyn wirtualnych z hello takie same w chmurze usługi tooback na powitania tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="8bd4f-251">Jeśli chcesz tooback się wiele maszyn wirtualnych z tej samej usługi w chmurze, przesunąć godziny rozpoczęcia tworzenia kopii zapasowej hello o godzinę.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="8bd4f-252">Nie należy planować więcej niż 40 tooback maszyn wirtualnych się na powitania tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="8bd4f-253">Planowanie kopii zapasowych maszyn wirtualnych podczas godziny poza szczytem.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="8bd4f-254">Ten sposób hello usługi Kopia zapasowa używa IOPS do przesyłania danych z powitania klienta magazynu konta toohello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="8bd4f-255">Upewnij się, że zasady są stosowane na maszynach wirtualnych umieszczonych na różnych kont magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="8bd4f-256">Zalecamy nie więcej niż 20 całkowita liczba dysków z konta magazynu pojedynczego chronione za pomocą hello sam harmonogram tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="8bd4f-257">Jeśli masz ponad 20 dysków na koncie magazynu rozkładu tych maszyn wirtualnych między wieloma zasadami tooget hello wymagane IOPS fazie transfer hello hello procesu tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="8bd4f-258">Nie należy przywracać maszyny Wirtualnej z systemem na koncie magazynu toosame magazynu Premium.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="8bd4f-259">Jeśli proces operacji przywracania hello pokrywa się z operacją tworzenia kopii zapasowej hello, zmniejsza hello dostępne IOPS dla kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="8bd4f-260">Dla kopii zapasowej maszyny Wirtualnej — wersja Premium upewnij się, że dysków premium hostów ma co najmniej 50% wolnego miejsca do przemieszczania migawki do pomyślnego utworzenia kopii zapasowej konto magazynu.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="8bd4f-261">Upewnij się, że ta wersja języka python na maszynach wirtualnych systemu Linux włączone dla kopii zapasowej jest 2.7</span><span class="sxs-lookup"><span data-stu-id="8bd4f-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="8bd4f-262">Szyfrowanie danych</span><span class="sxs-lookup"><span data-stu-id="8bd4f-262">Data encryption</span></span>
<span data-ttu-id="8bd4f-263">Kopia zapasowa Azure nie szyfruje danych jako część procesu tworzenia kopii zapasowej hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="8bd4f-264">Jednak można zaszyfrować dane w ramach hello maszyny Wirtualnej i Utwórz kopię zapasową hello chronione dane bezproblemowo (Dowiedz się więcej o [tworzenie kopii zapasowych danych zaszyfrowanych](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="8bd4f-265">Obliczanie kosztu hello wystąpienia chronione</span><span class="sxs-lookup"><span data-stu-id="8bd4f-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="8bd4f-266">Maszyny wirtualne platformy Azure, których kopie zapasowe są tworzone za pomocą usługi Kopia zapasowa Azure podlegają zbyt[cennikiem usługi Kopia zapasowa Azure](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="8bd4f-267">Hello obliczania chronione wystąpienia jest oparta na powitania *rzeczywiste* rozmiarze hello maszynę wirtualną, która jest równa sumie hello wszystkie dane hello w maszynie wirtualnej hello — z wyjątkiem hello "zasobu dysku".</span><span class="sxs-lookup"><span data-stu-id="8bd4f-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="8bd4f-268">Cennik wykonywanie kopii zapasowych maszyn wirtualnych jest *nie* hello maksymalny obsługiwany rozmiar maszyn wirtualnych toohello dołączone dysku danych.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="8bd4f-269">Cennik jest oparta na hello rzeczywiste dane przechowywane w hello dysku danych.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="8bd4f-270">Podobnie rachunku magazynu kopii zapasowych hello jest oparta na powitania ilość danych przechowywanych w kopia zapasowa Azure, czyli hello sumę hello rzeczywiste dane w każdym punkcie odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="8bd4f-271">Na przykład zająć A2 standardowy rozmiar maszyny wirtualnej, która ma dwa dyski dodatkowe dane o maksymalnym rozmiarze 1 TB.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="8bd4f-272">Witaj poniższej tabeli przedstawiono hello rzeczywiste dane przechowywane na każdym z tych dysków:</span><span class="sxs-lookup"><span data-stu-id="8bd4f-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="8bd4f-273">Typ dysku</span><span class="sxs-lookup"><span data-stu-id="8bd4f-273">Disk type</span></span> | <span data-ttu-id="8bd4f-274">Maksymalny rozmiar</span><span class="sxs-lookup"><span data-stu-id="8bd4f-274">Max size</span></span> | <span data-ttu-id="8bd4f-275">Rzeczywiste dane.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8bd4f-276">Dysk systemu operacyjnego</span><span class="sxs-lookup"><span data-stu-id="8bd4f-276">Operating system disk</span></span> |<span data-ttu-id="8bd4f-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-277">1023 GB</span></span> |<span data-ttu-id="8bd4f-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-278">17 GB</span></span> |
| <span data-ttu-id="8bd4f-279">Dysk lokalny / zasobu dysku</span><span class="sxs-lookup"><span data-stu-id="8bd4f-279">Local disk / Resource disk</span></span> |<span data-ttu-id="8bd4f-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-280">135 GB</span></span> |<span data-ttu-id="8bd4f-281">5 GB (nie uwzględniony w kopii zapasowej)</span><span class="sxs-lookup"><span data-stu-id="8bd4f-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="8bd4f-282">Dysk danych 1</span><span class="sxs-lookup"><span data-stu-id="8bd4f-282">Data disk 1</span></span> |<span data-ttu-id="8bd4f-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-283">1023 GB</span></span> |<span data-ttu-id="8bd4f-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-284">30 GB</span></span> |
| <span data-ttu-id="8bd4f-285">Dysk z danymi 2</span><span class="sxs-lookup"><span data-stu-id="8bd4f-285">Data disk 2</span></span> |<span data-ttu-id="8bd4f-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-286">1023 GB</span></span> |<span data-ttu-id="8bd4f-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="8bd4f-287">0 GB</span></span> |

<span data-ttu-id="8bd4f-288">Witaj *rzeczywiste* rozmiar maszyny wirtualnej hello jest w tym przypadku 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="8bd4f-289">Ten rozmiar chronione wystąpienia (47 GB) staje się hello podstawę rachunek miesięczny hello.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="8bd4f-290">Jako hello ilości danych na maszynie wirtualnej hello rozwojem rozmiar chronione wystąpienia hello używane przy zmianach rozliczeń odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="8bd4f-291">Nie można uruchomić rozliczeń, aż do zakończenia hello pierwszym pomyślnym utworzeniu kopii.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="8bd4f-292">W tym momencie rozpoczyna się hello rozliczeń dla magazynu i chronione wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="8bd4f-293">Karta będzie kontynuowane tak długo, jak istnieje *dowolnej kopii zapasowej danych przechowywanych w magazynie* hello maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="8bd4f-294">Jeśli użytkownik zaprzestanie ochrony na maszynie wirtualnej hello, ale dane kopii zapasowej maszyny wirtualnej istnieje w magazynie, nadal rozliczeń.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="8bd4f-295">Rozliczeń dla określonej maszyny wirtualnej zatrzymuje tylko wtedy, gdy ochrona powitalnych jest zatrzymana *i* wszystkie dane kopii zapasowej zostaną usunięte.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="8bd4f-296">Po zatrzymaniu ochrony i nie istnieją aktywne zadania tworzenia kopii zapasowej, rozmiar chronione wystąpienia hello używany dla rachunek miesięczny hello staje się rozmiar hello hello ostatniego pomyślnego kopii zapasowej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="8bd4f-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="8bd4f-297">Pytania?</span><span class="sxs-lookup"><span data-stu-id="8bd4f-297">Questions?</span></span>
<span data-ttu-id="8bd4f-298">Jeśli masz pytania lub w przypadku dowolnej funkcji, które chcesz toosee uwzględnione, [Prześlij nam opinię](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="8bd4f-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8bd4f-299">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="8bd4f-299">Next steps</span></span>
* [<span data-ttu-id="8bd4f-300">Tworzenie kopii zapasowych maszyn wirtualnych</span><span class="sxs-lookup"><span data-stu-id="8bd4f-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="8bd4f-301">Zarządzanie kopiami zapasowymi maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="8bd4f-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="8bd4f-302">Przywracanie maszyn wirtualnych</span><span class="sxs-lookup"><span data-stu-id="8bd4f-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="8bd4f-303">Rozwiązywanie problemów kopii zapasowej maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="8bd4f-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
