---
title: "Rozwiązywanie problemów z powolne kopii zapasowej plików i folderów w usłudze Kopia zapasowa Azure | Dokumentacja firmy Microsoft"
description: "Zawiera wskazówki dotyczące rozwiązywania problemów, aby ułatwić diagnozowanie przyczyn problemów z wydajnością kopia zapasowa Azure"
services: backup
documentationcenter: 
author: genlin
manager: cshepard
editor: 
ms.assetid: e379180a-db13-4e0c-90e4-28e5dd6f5b14
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 1688846957df3fbf0df747a6cd2a94b481d851b4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-slow-backup-of-files-and-folders-in-azure-backup"></a><span data-ttu-id="28a6d-103">Rozwiązywanie problemów związanych z powolnym tworzeniem kopii zapasowych plików i folderów w usłudze Azure Backup</span><span class="sxs-lookup"><span data-stu-id="28a6d-103">Troubleshoot slow backup of files and folders in Azure Backup</span></span>
<span data-ttu-id="28a6d-104">Ten artykuł zawiera wskazówki dotyczące rozwiązywania problemów, aby ułatwić diagnozowanie przyczynę niską wydajność tworzenia kopii zapasowej plików i folderów podczas korzystania z usługi Kopia zapasowa Azure.</span><span class="sxs-lookup"><span data-stu-id="28a6d-104">This article provides troubleshooting guidance to help you diagnose the cause of slow backup performance for files and folders when you're using Azure Backup.</span></span> <span data-ttu-id="28a6d-105">Gdy agenta kopii zapasowej Azure umożliwia tworzenie kopii zapasowych plików, proces tworzenia kopii zapasowej może trwać dłużej, niż oczekiwano.</span><span class="sxs-lookup"><span data-stu-id="28a6d-105">When you use the Azure Backup agent to back up files, the backup process might take longer than expected.</span></span> <span data-ttu-id="28a6d-106">To opóźnienie może być spowodowany przez jedną lub więcej z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="28a6d-106">This delay might be caused by one or more of the following:</span></span>

* [<span data-ttu-id="28a6d-107">Na komputerze, na którym jest tworzona kopia zapasowa, brak wąskich gardeł wydajności.</span><span class="sxs-lookup"><span data-stu-id="28a6d-107">There are performance bottlenecks on the computer that’s being backed up.</span></span>](#cause1)
* [<span data-ttu-id="28a6d-108">Inny proces lub oprogramowanie antywirusowe jest zakłócać proces tworzenia kopii zapasowej Azure.</span><span class="sxs-lookup"><span data-stu-id="28a6d-108">Another process or antivirus software is interfering with the Azure Backup process.</span></span>](#cause2)
* [<span data-ttu-id="28a6d-109">Agent kopii zapasowej jest uruchomiony na maszynie wirtualnej platformy Azure (VM).</span><span class="sxs-lookup"><span data-stu-id="28a6d-109">The Backup agent is running on an Azure virtual machine (VM).</span></span>](#cause3)  
* [<span data-ttu-id="28a6d-110">W przypadku tworzenia kopii zapasowej dużą liczbą plików (w milionach).</span><span class="sxs-lookup"><span data-stu-id="28a6d-110">You're backing up a large number (millions) of files.</span></span>](#cause4)

<span data-ttu-id="28a6d-111">Przed rozpoczęciem rozwiązywania problemów, firma Microsoft zaleca pobraniu i zainstalowaniu [najnowsza wersja agenta usługi Kopia zapasowa Azure](http://aka.ms/azurebackup_agent).</span><span class="sxs-lookup"><span data-stu-id="28a6d-111">Before you start troubleshooting issues, we recommend that you download and install the [latest Azure Backup agent](http://aka.ms/azurebackup_agent).</span></span> <span data-ttu-id="28a6d-112">Wykonujemy częste aktualizacje agenta kopii zapasowej, aby rozwiązać problemy z różnych, Dodaj funkcje i zwiększyć wydajność.</span><span class="sxs-lookup"><span data-stu-id="28a6d-112">We make frequent updates to the Backup agent to fix various issues, add features, and improve performance.</span></span>

<span data-ttu-id="28a6d-113">Ponadto zdecydowanie zaleca się przejrzenie [usługi Kopia zapasowa Azure — często zadawane pytania](backup-azure-backup-faq.md) się upewnić, że nie występują pewne typowe problemy z konfiguracją.</span><span class="sxs-lookup"><span data-stu-id="28a6d-113">We also strongly recommend that you review the [Azure Backup service FAQ](backup-azure-backup-faq.md) to make sure you're not experiencing any of the common configuration issues.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

<a id="cause1"></a>

## <a name="cause-performance-bottlenecks-on-the-computer"></a><span data-ttu-id="28a6d-114">Przyczyna: Wąskich gardeł wydajności na komputerze</span><span class="sxs-lookup"><span data-stu-id="28a6d-114">Cause: Performance bottlenecks on the computer</span></span>
<span data-ttu-id="28a6d-115">Wąskie gardła na komputerze, na którym jest tworzona kopia zapasowa może powodować opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="28a6d-115">Bottlenecks on the computer that's being backed up can cause delays.</span></span> <span data-ttu-id="28a6d-116">Na przykład komputera możliwość odczytu lub zapisu na dysku lub dostępną przepustowość do przesyłania danych za pośrednictwem sieci, może spowodować wąskich gardeł.</span><span class="sxs-lookup"><span data-stu-id="28a6d-116">For example, the computer's ability to read or write to disk, or available bandwidth to send data over the network, can cause bottlenecks.</span></span>

<span data-ttu-id="28a6d-117">System Windows oferuje wbudowane narzędzie, które jest nazywany [monitora wydajności](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon), aby wykryć te wąskich gardeł.</span><span class="sxs-lookup"><span data-stu-id="28a6d-117">Windows provides a built-in tool that's called [Performance Monitor](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) to detect these bottlenecks.</span></span>

<span data-ttu-id="28a6d-118">Poniżej przedstawiono niektóre liczniki wydajności i zakresy, które mogą pomóc w zdiagnozowaniu wąskich gardeł optymalne kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="28a6d-118">Here are some performance counters and ranges that can be helpful in diagnosing bottlenecks for optimal backups.</span></span>

| <span data-ttu-id="28a6d-119">Licznik</span><span class="sxs-lookup"><span data-stu-id="28a6d-119">Counter</span></span> | <span data-ttu-id="28a6d-120">Stan</span><span class="sxs-lookup"><span data-stu-id="28a6d-120">Status</span></span> |
| --- | --- |
| <span data-ttu-id="28a6d-121">Dysk logiczny (dysk fizyczny)--% bezczynności</span><span class="sxs-lookup"><span data-stu-id="28a6d-121">Logical Disk(Physical Disk)--%idle</span></span> |<span data-ttu-id="28a6d-122">• 100% w stanie bezczynności do 50% bezczynności = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-122">• 100% idle to 50% idle = Healthy</span></span></br><span data-ttu-id="28a6d-123">• 49% bezczynności 20% bezczynności = ostrzeżenia lub monitora</span><span class="sxs-lookup"><span data-stu-id="28a6d-123">• 49% idle to 20% idle = Warning or Monitor</span></span></br><span data-ttu-id="28a6d-124">• 19% bezczynności 0% bezczynności = krytyczne lub specyfikacji z</span><span class="sxs-lookup"><span data-stu-id="28a6d-124">• 19% idle to 0% idle = Critical or Out of Spec</span></span> |
| <span data-ttu-id="28a6d-125">Dysk logiczny (dysk fizyczny)--% średni</span><span class="sxs-lookup"><span data-stu-id="28a6d-125">Logical Disk(Physical Disk)--%Avg.</span></span> <span data-ttu-id="28a6d-126">S odczytu lub zapisu na dysku</span><span class="sxs-lookup"><span data-stu-id="28a6d-126">Disk Sec Read or Write</span></span> |<span data-ttu-id="28a6d-127">• 0,001 ms 0,015 MS = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-127">• 0.001 ms to 0.015 ms  = Healthy</span></span></br><span data-ttu-id="28a6d-128">• 0,015 ms 0,025 MS = ostrzeżenia lub monitora</span><span class="sxs-lookup"><span data-stu-id="28a6d-128">• 0.015 ms to 0.025 ms = Warning or Monitor</span></span></br><span data-ttu-id="28a6d-129">• 0.026 ms lub już = krytyczne lub specyfikacji z</span><span class="sxs-lookup"><span data-stu-id="28a6d-129">• 0.026 ms or longer = Critical or Out of Spec</span></span> |
| <span data-ttu-id="28a6d-130">Dysk logiczny (dysk fizyczny) — bieżąca długość kolejki dysku (dla wszystkich wystąpień)</span><span class="sxs-lookup"><span data-stu-id="28a6d-130">Logical Disk(Physical Disk)--Current Disk Queue Length (for all instances)</span></span> |<span data-ttu-id="28a6d-131">80 żądań przez więcej niż 6 minut</span><span class="sxs-lookup"><span data-stu-id="28a6d-131">80 requests for more than 6 minutes</span></span> |
| <span data-ttu-id="28a6d-132">Pamięć — Bajty z systemem innym niż puli stronicowanej</span><span class="sxs-lookup"><span data-stu-id="28a6d-132">Memory--Pool Non Paged Bytes</span></span> |<span data-ttu-id="28a6d-133">• Mniej niż 60% puli używane = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-133">• Less than 60% of pool consumed = Healthy</span></span><br><span data-ttu-id="28a6d-134">• 61% do 80% puli używane = ostrzeżenia lub monitora</span><span class="sxs-lookup"><span data-stu-id="28a6d-134">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="28a6d-135">• Większa niż 80% puli używane = krytyczne lub specyfikacji z</span><span class="sxs-lookup"><span data-stu-id="28a6d-135">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="28a6d-136">Pamięć — Bajty w puli stronicowanej</span><span class="sxs-lookup"><span data-stu-id="28a6d-136">Memory--Pool Paged Bytes</span></span> |<span data-ttu-id="28a6d-137">• Mniej niż 60% puli używane = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-137">• Less than 60% of pool consumed = Healthy</span></span></br><span data-ttu-id="28a6d-138">• 61% do 80% puli używane = ostrzeżenia lub monitora</span><span class="sxs-lookup"><span data-stu-id="28a6d-138">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="28a6d-139">• Większa niż 80% puli używane = krytyczne lub specyfikacji z</span><span class="sxs-lookup"><span data-stu-id="28a6d-139">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="28a6d-140">Pamięć — dostępnego w megabajtach</span><span class="sxs-lookup"><span data-stu-id="28a6d-140">Memory--Available Megabytes</span></span> |<span data-ttu-id="28a6d-141">• 50% pamięci lub więcej = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-141">• 50% of free memory available or more = Healthy</span></span></br><span data-ttu-id="28a6d-142">• 25% pamięci = monitora</span><span class="sxs-lookup"><span data-stu-id="28a6d-142">• 25% of free memory available = Monitor</span></span></br><span data-ttu-id="28a6d-143">• 10% pamięci = ostrzeżenie</span><span class="sxs-lookup"><span data-stu-id="28a6d-143">• 10% of free memory available = Warning</span></span></br><span data-ttu-id="28a6d-144">• Mniej niż 100 MB lub 5% wolnej pamięci = krytyczne lub specyfikacji z</span><span class="sxs-lookup"><span data-stu-id="28a6d-144">• Less than 100 MB or 5% of free memory available = Critical or Out of Spec</span></span> |
| <span data-ttu-id="28a6d-145">Procesor —\%czas procesora (wszystkie wystąpienia)</span><span class="sxs-lookup"><span data-stu-id="28a6d-145">Processor--\%Processor Time (all instances)</span></span> |<span data-ttu-id="28a6d-146">• Mniej niż 60% używane = w dobrej kondycji</span><span class="sxs-lookup"><span data-stu-id="28a6d-146">• Less than 60% consumed = Healthy</span></span></br><span data-ttu-id="28a6d-147">• od 61 do 90% używane = Monitor lub Uwaga</span><span class="sxs-lookup"><span data-stu-id="28a6d-147">• 61% to 90% consumed = Monitor or Caution</span></span></br><span data-ttu-id="28a6d-148">• od 91 do 100% używane = krytyczne</span><span class="sxs-lookup"><span data-stu-id="28a6d-148">• 91% to 100% consumed = Critical</span></span> |

> [!NOTE]
> <span data-ttu-id="28a6d-149">Jeśli okaże się, że infrastruktura jest dziedziczonej z istotnymi elementami, firma Microsoft zaleca defragmentację dysków regularnie w celu zapewnienia lepszej wydajności.</span><span class="sxs-lookup"><span data-stu-id="28a6d-149">If you determine that the infrastructure is the culprit, we recommend that you defragment the disks regularly for better performance.</span></span>
>
>

<a id="cause2"></a>

## <a name="cause-another-process-or-antivirus-software-interfering-with-azure-backup"></a><span data-ttu-id="28a6d-150">Przyczyna: Inny proces lub zakłócać kopia zapasowa Azure oprogramowanie antywirusowe</span><span class="sxs-lookup"><span data-stu-id="28a6d-150">Cause: Another process or antivirus software interfering with Azure Backup</span></span>
<span data-ttu-id="28a6d-151">Firma Microsoft przedstawiono kilka wystąpień, gdy inne procesy w systemie Windows ma negatywny wpływ na wydajność procesu agenta usługi Kopia zapasowa Azure.</span><span class="sxs-lookup"><span data-stu-id="28a6d-151">We've seen several instances where other processes in the Windows system have negatively affected performance of the Azure Backup agent process.</span></span> <span data-ttu-id="28a6d-152">Na przykład używania zarówno agenta usługi Kopia zapasowa Azure, jak i inny program, aby utworzyć kopię zapasową danych lub oprogramowanie antywirusowe jest uruchomiona, jest zablokowany na plikach do wykonania kopii zapasowej wielokrotność blokuje na plików może spowodować rywalizacji.</span><span class="sxs-lookup"><span data-stu-id="28a6d-152">For example, if you use both the Azure Backup agent and another program to back up data, or if antivirus software is running and has a lock on files to be backed up, the multiple locks on files might cause contention.</span></span> <span data-ttu-id="28a6d-153">W takiej sytuacji kopii zapasowej może zakończyć się niepowodzeniem lub zadanie może trwać dłużej, niż oczekiwano.</span><span class="sxs-lookup"><span data-stu-id="28a6d-153">In this situation, the backup might fail, or the job might take longer than expected.</span></span>

<span data-ttu-id="28a6d-154">Najlepsze w tym scenariuszu zaleca się wyłączyć kopii zapasowej program aby zobaczyć, czy zmiany czasu tworzenia kopii zapasowych agenta kopii zapasowej Azure.</span><span class="sxs-lookup"><span data-stu-id="28a6d-154">The best recommendation in this scenario is to turn off the other backup program to see whether the backup time for the Azure Backup agent changes.</span></span> <span data-ttu-id="28a6d-155">Zwykle upewniając się, że wiele zadań tworzenia kopii zapasowej nie są uruchomione w tym samym czasie jest wystarczające, aby nie wpływały na siebie.</span><span class="sxs-lookup"><span data-stu-id="28a6d-155">Usually, making sure that multiple backup jobs are not running at the same time is sufficient to prevent them from affecting each other.</span></span>

<span data-ttu-id="28a6d-156">Programy antywirusowe zaleca się, można wykluczyć następujące pliki i lokalizacje:</span><span class="sxs-lookup"><span data-stu-id="28a6d-156">For antivirus programs, we recommend that you exclude the following files and locations:</span></span>

* <span data-ttu-id="28a6d-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe jako proces</span><span class="sxs-lookup"><span data-stu-id="28a6d-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe as a process</span></span>
* <span data-ttu-id="28a6d-158">C:\Program Files\Microsoft Azure Recovery Services Agent\ folderów</span><span class="sxs-lookup"><span data-stu-id="28a6d-158">C:\Program Files\Microsoft Azure Recovery Services Agent\ folders</span></span>
* <span data-ttu-id="28a6d-159">Pliki tymczasowe lokalizacji (Jeśli nie używasz standardowego lokalizacji)</span><span class="sxs-lookup"><span data-stu-id="28a6d-159">Scratch location (if you're not using the standard location)</span></span>

<a id="cause3"></a>

## <a name="cause-backup-agent-running-on-an-azure-virtual-machine"></a><span data-ttu-id="28a6d-160">Przyczyna: Kopia zapasowa agenta uruchomionego na maszynie wirtualnej platformy Azure</span><span class="sxs-lookup"><span data-stu-id="28a6d-160">Cause: Backup agent running on an Azure virtual machine</span></span>
<span data-ttu-id="28a6d-161">Jeśli korzystasz z agenta kopii zapasowej na maszynie Wirtualnej, wydajność będzie mniejsza niż po uruchomieniu go na komputerze fizycznym.</span><span class="sxs-lookup"><span data-stu-id="28a6d-161">If you're running the Backup agent on a VM, performance will be slower than when you run it on a physical machine.</span></span> <span data-ttu-id="28a6d-162">Oczekiwano z powodu ograniczeń IOPS.</span><span class="sxs-lookup"><span data-stu-id="28a6d-162">This is expected due to IOPS limitations.</span></span>  <span data-ttu-id="28a6d-163">Jednak aby zoptymalizować wydajność przełączając dysków z danymi, które są tworzona kopia zapasowa Azure Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="28a6d-163">However, you can optimize the performance by switching the data drives that are being backed up to Azure Premium Storage.</span></span> <span data-ttu-id="28a6d-164">Pracujemy nad rozwiązywania tego problemu i poprawki będą dostępne w przyszłej wersji.</span><span class="sxs-lookup"><span data-stu-id="28a6d-164">We're working on fixing this issue, and the fix will be available in a future release.</span></span>

<a id="cause4"></a>

## <a name="cause-backing-up-a-large-number-millions-of-files"></a><span data-ttu-id="28a6d-165">Przyczyna: Tworzenie kopii zapasowej dużą liczbą plików (w milionach)</span><span class="sxs-lookup"><span data-stu-id="28a6d-165">Cause: Backing up a large number (millions) of files</span></span>
<span data-ttu-id="28a6d-166">Przenoszenie dużej ilości danych będzie trwało dłużej niż przenoszenie mniejsza ilość danych.</span><span class="sxs-lookup"><span data-stu-id="28a6d-166">Moving a large volume of data will take longer than moving a smaller volume of data.</span></span> <span data-ttu-id="28a6d-167">W niektórych przypadkach czas tworzenia kopii zapasowej dotyczy nie tylko rozmiar danych, ale liczba plików lub folderów.</span><span class="sxs-lookup"><span data-stu-id="28a6d-167">In some cases, backup time is related to not only the size of the data, but also the number of files or folders.</span></span> <span data-ttu-id="28a6d-168">Jest to szczególnie istotne, gdy tworzona jest kopia zapasowa miliony małych plików (w bajtach kilka do kilku kilobajtów).</span><span class="sxs-lookup"><span data-stu-id="28a6d-168">This is especially true when millions of small files (a few bytes to a few kilobytes) are being backed up.</span></span>

<span data-ttu-id="28a6d-169">Dzieje się tak, ponieważ w przypadku tworzenia kopii zapasowej danych i przenoszenia go do platformy Azure, Azure jest jednocześnie skatalogowania plików.</span><span class="sxs-lookup"><span data-stu-id="28a6d-169">This behavior occurs because while you're backing up the data and moving it to Azure, Azure is simultaneously cataloging your files.</span></span> <span data-ttu-id="28a6d-170">W niektórych scenariuszach rzadkich operacji katalogu może potrwać dłużej niż oczekiwano.</span><span class="sxs-lookup"><span data-stu-id="28a6d-170">In some rare scenarios, the catalog operation might take longer than expected.</span></span>

<span data-ttu-id="28a6d-171">Następujących wskaźników ułatwią zrozumienie wąskie gardło i odpowiednio działają w następnych krokach:</span><span class="sxs-lookup"><span data-stu-id="28a6d-171">The following indicators can help you understand the bottleneck and accordingly work on the next steps:</span></span>

* <span data-ttu-id="28a6d-172">**Interfejs użytkownika jest wyświetlany postęp do transferu danych**.</span><span class="sxs-lookup"><span data-stu-id="28a6d-172">**UI is showing progress for the data transfer**.</span></span> <span data-ttu-id="28a6d-173">Nadal transferu danych.</span><span class="sxs-lookup"><span data-stu-id="28a6d-173">The data is still being transferred.</span></span> <span data-ttu-id="28a6d-174">Przepustowość sieci lub rozmiar danych mogą być przyczyną opóźnień.</span><span class="sxs-lookup"><span data-stu-id="28a6d-174">The network bandwidth or the size of data might be causing delays.</span></span>
* <span data-ttu-id="28a6d-175">**Interfejs użytkownika nie jest wyświetlany postęp do transferu danych**.</span><span class="sxs-lookup"><span data-stu-id="28a6d-175">**UI is not showing progress for the data transfer**.</span></span> <span data-ttu-id="28a6d-176">Otwórz dzienniki w Agent\Temp usług odzyskiwania Azure C:\Microsoft lokalizacji, a następnie wyszukaj polecenie wpisu FileProvider::EndData w dziennikach.</span><span class="sxs-lookup"><span data-stu-id="28a6d-176">Open the logs located at C:\Microsoft Azure Recovery Services Agent\Temp, and then check for the FileProvider::EndData entry in the logs.</span></span> <span data-ttu-id="28a6d-177">Ten wpis oznacza, że Zakończono transfer danych jest przeprowadzana operacja katalogu.</span><span class="sxs-lookup"><span data-stu-id="28a6d-177">This entry signifies that the data transfer finished and the catalog operation is happening.</span></span> <span data-ttu-id="28a6d-178">Nie Anuluj zadania tworzenia kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="28a6d-178">Don't cancel the backup jobs.</span></span> <span data-ttu-id="28a6d-179">Zamiast tego należy zaczekać nieco dłużej na zakończenie operacji katalogu.</span><span class="sxs-lookup"><span data-stu-id="28a6d-179">Instead, wait a little longer for the catalog operation to finish.</span></span> <span data-ttu-id="28a6d-180">Jeśli problem będzie się powtarzać, skontaktuj się z [pomocy technicznej platformy Azure](https://portal.azure.com/#create/Microsoft.Support).</span><span class="sxs-lookup"><span data-stu-id="28a6d-180">If the problem persists, contact [Azure support](https://portal.azure.com/#create/Microsoft.Support).</span></span>
