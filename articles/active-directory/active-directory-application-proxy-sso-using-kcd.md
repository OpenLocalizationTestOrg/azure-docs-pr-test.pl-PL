---
title: "aaaSingle logowania jednokrotnego przy użyciu serwera Proxy aplikacji | Dokumentacja firmy Microsoft"
description: "Opisano, jak tooprovide logowanie jednokrotne przy użyciu serwera Proxy aplikacji usługi Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="2818a-103">Ograniczone delegowanie protokołu Kerberos dla aplikacji tooyour rejestracji jednokrotnej z serwerem Proxy aplikacji</span><span class="sxs-lookup"><span data-stu-id="2818a-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="2818a-104">Zapewnia rejestrację jednokrotną dla lokalnych aplikacji opublikowanych przy użyciu serwera Proxy aplikacji, które są zabezpieczone przy użyciu zintegrowanego uwierzytelniania systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="2818a-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="2818a-105">Te aplikacje wymagają biletu protokołu Kerberos dla dostępu.</span><span class="sxs-lookup"><span data-stu-id="2818a-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="2818a-106">Serwer Proxy aplikacji używa delegowanie ograniczone protokołu Kerberos (KCD) toosupport tych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="2818a-107">Można włączyć aplikacji tooyour rejestracji jednokrotnej, przy użyciu zintegrowanego uwierzytelniania systemu Windows (IWA) przez nadanie uprawnień łączniki serwera Proxy aplikacji w usłudze Active Directory tooimpersonate użytkowników.</span><span class="sxs-lookup"><span data-stu-id="2818a-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="2818a-108">łączniki Hello Użyj toosend to uprawnienie i odbierać tokeny w ich imieniu.</span><span class="sxs-lookup"><span data-stu-id="2818a-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="2818a-109">Jak rejestracji jednokrotnej z KCD działa</span><span class="sxs-lookup"><span data-stu-id="2818a-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="2818a-110">Ten diagram opisano przepływ hello, gdy użytkownik próbuje tooaccess aplikacji lokalnej, która używa funkcji IWA.</span><span class="sxs-lookup"><span data-stu-id="2818a-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Diagram przepływu uwierzytelniania firmy Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="2818a-112">Witaj, użytkownik wprowadza hello aplikacji lokalnych hello tooaccess adresu URL za pośrednictwem serwera Proxy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="2818a-113">Serwer Proxy aplikacji przekierowuje hello żądania tooAzure AD uwierzytelniania usługi toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="2818a-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="2818a-114">W tym momencie usługi Azure AD stosuje odpowiednie uwierzytelnianie, a zasady autoryzacji, takie jak uwierzytelnianie wieloskładnikowe.</span><span class="sxs-lookup"><span data-stu-id="2818a-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="2818a-115">Jeśli użytkownik hello jest weryfikowane, usługi Azure AD tworzy token i wysyła je toohello użytkownika.</span><span class="sxs-lookup"><span data-stu-id="2818a-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="2818a-116">Użytkownik Hello przekazuje token tooApplication powitania serwera Proxy.</span><span class="sxs-lookup"><span data-stu-id="2818a-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="2818a-117">Serwer Proxy aplikacji weryfikuje hello token i pobiera hello główną nazwę użytkownika (UPN) z niego, a następnie wysyła hello żądania, hello UPN, hello toohello nazwy usługi (SPN) łącznika za pośrednictwem uwierzytelnionego dually bezpiecznego kanału.</span><span class="sxs-lookup"><span data-stu-id="2818a-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="2818a-118">Hello łącznika przeprowadza negocjowanie delegowanie ograniczone protokołu Kerberos (KCD) z hello lokalnego AD personifikacji hello użytkownika tooget aplikacji token toohello protokołu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="2818a-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="2818a-119">Usługi Active Directory wysyła hello token protokołu Kerberos dla toohello aplikacji hello łącznika.</span><span class="sxs-lookup"><span data-stu-id="2818a-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="2818a-120">Witaj łącznika wysyła hello oryginalnego żądania toohello serwera aplikacji, za pomocą hello token protokołu Kerberos, który otrzymał z usługi AD.</span><span class="sxs-lookup"><span data-stu-id="2818a-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="2818a-121">Aplikacja Hello wysyła hello odpowiedzi toohello łącznik, który jest następnie zwracany toohello serwera Proxy aplikacji usługi, a na koniec toohello użytkownika.</span><span class="sxs-lookup"><span data-stu-id="2818a-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="2818a-122">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="2818a-122">Prerequisites</span></span>
<span data-ttu-id="2818a-123">Przed rozpoczęciem pracy z logowanie jednokrotne dla aplikacji IWA, upewnij się, środowisko jest gotowe z hello następujące ustawienia i konfiguracje:</span><span class="sxs-lookup"><span data-stu-id="2818a-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="2818a-124">Aplikacji, takich jak aplikacje sieci Web programu SharePoint są ustawione toouse zintegrowane uwierzytelnianie systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="2818a-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="2818a-125">Aby uzyskać więcej informacji, zobacz [włączyć obsługę uwierzytelniania Kerberos](https://technet.microsoft.com/library/dd759186.aspx), lub dla programu SharePoint, zobacz [planowanie uwierzytelniania Kerberos w programie SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="2818a-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="2818a-126">Wszystkie Twoje aplikacje mają [główne nazwy usług](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="2818a-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="2818a-127">uruchomione powitania serwera Hello łącznika i powitania serwera z systemem aplikacji hello są przyłączone do domeny i część hello tej samej domenie lub domenach ufających.</span><span class="sxs-lookup"><span data-stu-id="2818a-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="2818a-128">Aby uzyskać więcej informacji dotyczących przyłączania do domeny, zobacz [przyłączyć komputer tooa domeny](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="2818a-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="2818a-129">Witaj serwerem hello łącznika ma atrybutu TokenGroupsGlobalAndUniversal hello tooread dostępu dla użytkowników.</span><span class="sxs-lookup"><span data-stu-id="2818a-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="2818a-130">To ustawienie domyślne może negatywnie przez ograniczenie funkcjonalności hello środowiska zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="2818a-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="2818a-131">Konfigurowanie usługi Active Directory</span><span class="sxs-lookup"><span data-stu-id="2818a-131">Configure Active Directory</span></span>
<span data-ttu-id="2818a-132">Konfiguracja usługi Active Directory Hello różni, hello w zależności od tego, czy łącznik serwera Proxy aplikacji, a serwer aplikacji hello znajdują się w tej samej domenie lub nie.</span><span class="sxs-lookup"><span data-stu-id="2818a-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="2818a-133">Łącznik i serwera aplikacji hello — w tej samej domenie</span><span class="sxs-lookup"><span data-stu-id="2818a-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="2818a-134">W usłudze Active Directory, przejdź zbyt**narzędzia** > **użytkownicy i komputery**.</span><span class="sxs-lookup"><span data-stu-id="2818a-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="2818a-135">Wybierz serwer hello systemem hello łącznika.</span><span class="sxs-lookup"><span data-stu-id="2818a-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="2818a-136">Kliknij prawym przyciskiem myszy i wybierz **właściwości** > **delegowania**.</span><span class="sxs-lookup"><span data-stu-id="2818a-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="2818a-137">Wybierz **Ufaj temu komputerowi w delegowania toospecified tylko usług**.</span><span class="sxs-lookup"><span data-stu-id="2818a-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="2818a-138">W obszarze **toowhich usług to konto może okazywać delegowane poświadczenia** dodać wartość hello hello tożsamością SPN serwera aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="2818a-139">Dzięki temu użytkownicy tooimpersonate łącznika serwera Proxy aplikacji hello w usłudze AD dla aplikacji hello zdefiniowane na liście hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Zrzut ekranu okna właściwości SVR łącznika](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="2818a-141">Łącznik i serwera aplikacji w różnych domenach</span><span class="sxs-lookup"><span data-stu-id="2818a-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="2818a-142">Aby uzyskać listę wymagań wstępnych dotyczących pracy z KCD między domenami, zobacz [ograniczone delegowanie protokołu Kerberos między domenami](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="2818a-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="2818a-143">Użyj hello `principalsallowedtodelegateto` właściwość hello łącznika serwera tooenable powitania serwera Proxy aplikacji toodelegate hello łącznika serwera.</span><span class="sxs-lookup"><span data-stu-id="2818a-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="2818a-144">Serwer aplikacji Hello `sharepointserviceaccount` i delegowanie serwera hello jest `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="2818a-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="2818a-145">W systemie Windows 2012 R2 Użyj tego kodu na przykład:</span><span class="sxs-lookup"><span data-stu-id="2818a-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="2818a-146">Sharepointserviceaccount może być konto komputera SPS hello lub konta usługi, które hello SPS działa puli aplikacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="2818a-147">Konfigurowanie rejestracji jednokrotnej</span><span class="sxs-lookup"><span data-stu-id="2818a-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="2818a-148">Publikowanie aplikacji zgodnie z instrukcjami toohello opisanego w [publikowania aplikacji za pomocą serwera Proxy aplikacji](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="2818a-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="2818a-149">Upewnij się, że tooselect **usługi Azure Active Directory** jako hello **metoda uwierzytelniania wstępnego**.</span><span class="sxs-lookup"><span data-stu-id="2818a-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="2818a-150">Po wyświetleniu aplikacji hello listy aplikacji przedsiębiorstwa, zaznacz go i kliknij **logowanie jednokrotne**.</span><span class="sxs-lookup"><span data-stu-id="2818a-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="2818a-151">Ustaw zbyt hello logowania jednokrotnego w tryb jednego**zintegrowane uwierzytelnianie systemu Windows**.</span><span class="sxs-lookup"><span data-stu-id="2818a-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="2818a-152">Wprowadź hello **wewnętrzny SPN aplikacji** powitania serwera aplikacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="2818a-153">W tym przykładzie hello SPN dla opublikowanych aplikacji jest http/www.contoso.com. Ten toobe potrzeb SPN liście hello usług toowhich hello łącznika może okazywać delegowane poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="2818a-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="2818a-154">Wybierz hello **delegowane tożsamości logowania** dla toouse łącznika hello w imieniu użytkowników.</span><span class="sxs-lookup"><span data-stu-id="2818a-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="2818a-155">Aby uzyskać więcej informacji, zobacz [Praca z różnych lokalnymi i tożsamościami w chmurze](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="2818a-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Konfiguracja zaawansowanych aplikacji](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="2818a-157">Logowanie Jednokrotne dla aplikacji z systemem innym niż Windows</span><span class="sxs-lookup"><span data-stu-id="2818a-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="2818a-158">Hello przepływ delegowania protokołu Kerberos w serwera Proxy aplikacji usługi Azure AD rozpoczyna się, gdy usługa Azure AD uwierzytelnia użytkownika hello w chmurze hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="2818a-159">Po hello żądanie dociera lokalnymi, hello aplikacji serwera Proxy Azure AD connector wystawia biletu protokołu Kerberos w imieniu użytkownika hello przez interakcji z hello lokalnej usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2818a-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="2818a-160">Ten proces jest określony tooas, delegowanie ograniczone protokołu Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="2818a-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="2818a-161">W hello następnej fazy, żądanie zostanie wysłane toohello wewnętrznej bazy danych aplikacji przy użyciu tego biletu protokołu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="2818a-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="2818a-162">Istnieje kilka protokołów, które definiują sposób toosend takich żądań.</span><span class="sxs-lookup"><span data-stu-id="2818a-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="2818a-163">Większość serwerów z systemem innym niż Windows oczekiwać Negotiate/SPNego, która jest teraz obsługiwana na serwera Proxy aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2818a-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="2818a-164">Aby uzyskać więcej informacji o protokole Kerberos, zobacz [wszystkie mają tooknow o protokołu Kerberos ograniczonego delegowania (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="2818a-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="2818a-165">Aplikacje systemu Windows bez zwykle użytkownika nazwy użytkowników lub nazwy konta SAM zamiast domeny adresów e-mail.</span><span class="sxs-lookup"><span data-stu-id="2818a-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="2818a-166">Tej sytuacji tooyour aplikacji, należy tooconfigure hello delegowane logowania tożsamości pola tooconnect Twojej tożsamości aplikacji w chmurze tożsamości tooyour.</span><span class="sxs-lookup"><span data-stu-id="2818a-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="2818a-167">Praca z różnych lokalnymi i tożsamościami w chmurze</span><span class="sxs-lookup"><span data-stu-id="2818a-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="2818a-168">Serwer Proxy aplikacji zakłada, że użytkownicy mają dokładnie hello tej samej tożsamości w chmurze hello i lokalnych.</span><span class="sxs-lookup"><span data-stu-id="2818a-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="2818a-169">Jeśli nie jest to przypadek hello, można nadal służy KCD dla logowania jednokrotnego.</span><span class="sxs-lookup"><span data-stu-id="2818a-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="2818a-170">Skonfiguruj **delegowane tożsamości logowania** dla każdego toospecify aplikacji powinny być używane tożsamość, podczas wykonywania logowania jednokrotnego.</span><span class="sxs-lookup"><span data-stu-id="2818a-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="2818a-171">Ta funkcja umożliwia wiele organizacji, które mają różne lokalnymi i w chmurze tożsamości toohave rejestracji Jednokrotnej z aplikacji tooon lokalne powitania w chmurze bez konieczności hello użytkowników tooenter różne nazwy użytkowników i hasła.</span><span class="sxs-lookup"><span data-stu-id="2818a-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="2818a-172">Dotyczy to również organizacjom który:</span><span class="sxs-lookup"><span data-stu-id="2818a-172">This includes organizations that:</span></span>

* <span data-ttu-id="2818a-173">Wewnętrznie mają kilka domen (joe@us.contoso.com, joe@eu.contoso.com) i w chmurze hello pojedynczej domeny (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="2818a-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="2818a-174">Wewnętrznie mają nazwy domeny bez obsługi routingu (joe@contoso.usa) i prawnych w chmurze hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="2818a-175">Nie używaj nazw domen wewnętrznie (Jan)</span><span class="sxs-lookup"><span data-stu-id="2818a-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="2818a-176">Użyj innych aliasów lokalnych i w chmurze hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="2818a-177">Na przykład joe-johns@contoso.com vs.joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="2818a-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="2818a-178">Dzięki serwerowi Proxy aplikacji można wybrać które tożsamości toouse tooobtain hello biletu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="2818a-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="2818a-179">To ustawienie jest na aplikację.</span><span class="sxs-lookup"><span data-stu-id="2818a-179">This setting is per application.</span></span> <span data-ttu-id="2818a-180">Niektóre z tych opcji nadają się do systemów, które nie akceptują format adresu e-mail, inne są zaprojektowane dla alternatywnej nazwy logowania.</span><span class="sxs-lookup"><span data-stu-id="2818a-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Zrzut ekranu parametr tożsamości delegowanego logowania](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="2818a-182">Jeśli używana jest tożsamość delegowanego logowania, wartość hello nie muszą być unikatowe we wszystkich domenach hello lub lasom w organizacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="2818a-183">Aby uniknąć tego problemu, należy publikowania aplikacji, te dwa razy przy użyciu dwóch różnych grup łącznika.</span><span class="sxs-lookup"><span data-stu-id="2818a-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="2818a-184">Ponieważ każda aplikacja ma odbiorców innego użytkownika, możesz ponadto dołączyć do jego łączniki tooa inną domenę.</span><span class="sxs-lookup"><span data-stu-id="2818a-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="2818a-185">Konfigurowanie logowania jednokrotnego dla różnych tożsamości</span><span class="sxs-lookup"><span data-stu-id="2818a-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="2818a-186">Konfigurowanie ustawień usługi Azure AD Connect tożsamość główna hello jest adresem e-mail hello (poczta).</span><span class="sxs-lookup"><span data-stu-id="2818a-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="2818a-187">Jest to realizowane jako część hello dostosowania procesu, zmieniając hello **główna nazwa użytkownika** w hello ustawień synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="2818a-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="2818a-188">Te ustawienia określają również, jak użytkownicy logują się tooOffice365, Windows10 urządzenia i inne aplikacje, które używają usługi Azure AD jako magazynu ich tożsamości.</span><span class="sxs-lookup"><span data-stu-id="2818a-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="2818a-189">![Identyfikowanie użytkowników zrzut ekranu — Lista rozwijana główna nazwa użytkownika](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="2818a-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="2818a-190">W ustawieniach konfiguracji aplikacji hello aplikacji hello chcesz toomodify, wybierz opcję hello **delegowane tożsamości logowania** toobe używany:</span><span class="sxs-lookup"><span data-stu-id="2818a-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="2818a-191">Nazwa główna użytkownika (na przykład joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="2818a-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="2818a-192">Alternatywna nazwa główna użytkownika (na przykład joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="2818a-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="2818a-193">Nazwa użytkownika, część główna nazwa użytkownika (na przykład Jan)</span><span class="sxs-lookup"><span data-stu-id="2818a-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="2818a-194">Część nazwy użytkownika alternatywna nazwa główna użytkownika (na przykład joed)</span><span class="sxs-lookup"><span data-stu-id="2818a-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="2818a-195">Nazwa konta SAM lokalnymi (zależy od konfiguracji kontrolera domeny hello)</span><span class="sxs-lookup"><span data-stu-id="2818a-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="2818a-196">Rozwiązywanie problemów z logowania jednokrotnego dla różnych tożsamości</span><span class="sxs-lookup"><span data-stu-id="2818a-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="2818a-197">Jeśli występuje błąd w hello procesu logowania jednokrotnego, wydaje się w dzienniku zdarzeń maszyny łącznika hello zgodnie z objaśnieniem w [Rozwiązywanie problemów](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="2818a-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="2818a-198">Jednak w niektórych przypadkach hello pomyślnie wysłaniu żądania toohello zaplecza aplikacji podczas odpowiada tej aplikacji w różnych odpowiedzi HTTP.</span><span class="sxs-lookup"><span data-stu-id="2818a-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="2818a-199">Rozwiązywanie problemów z tych przypadkach należy zacząć od badanie numer zdarzenia 24029 na maszynie łącznika hello w dzienniku zdarzeń w sesji serwera Proxy aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="2818a-200">pole "użytkownika" hello w ramach szczegółów zdarzenia hello zostanie Hello tożsamości użytkownika, którego użyto do delegowania.</span><span class="sxs-lookup"><span data-stu-id="2818a-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="2818a-201">Wybierz tooturn na dziennika sesji **wyświetlanie analityczne i debugowania dzienniki** w menu Widok podglądu zdarzeń hello.</span><span class="sxs-lookup"><span data-stu-id="2818a-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2818a-202">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="2818a-202">Next steps</span></span>

* [<span data-ttu-id="2818a-203">Jak tooconfigure toouse aplikacji serwera Proxy aplikacji ograniczone delegowanie protokołu Kerberos</span><span class="sxs-lookup"><span data-stu-id="2818a-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="2818a-204">Rozwiązywanie problemów, które masz problem z serwerem Proxy aplikacji</span><span class="sxs-lookup"><span data-stu-id="2818a-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="2818a-205">Najnowsze wiadomości powitania i aktualizacji, zapoznaj się z hello [Blog dotyczący serwera Proxy aplikacji](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="2818a-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

