---
title: "aaaEnable tooSharePoint dostępu zdalnego z serwera Proxy aplikacji usługi Azure AD | Dokumentacja firmy Microsoft"
description: "Obejmuje hello podstawy temat toointegrate lokalnego serwera programu SharePoint z serwera Proxy aplikacji usługi Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/21/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: 6ab413462fcaf387e150449df9c97505c4108bcf
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="enable-remote-access-toosharepoint-with-azure-ad-application-proxy"></a><span data-ttu-id="e6eb1-103">Włącz tooSharePoint dostępu zdalnego z serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="e6eb1-103">Enable remote access tooSharePoint with Azure AD Application Proxy</span></span>

<span data-ttu-id="e6eb1-104">W tym artykule omówiono sposób toointegrate lokalnego serwera programu SharePoint przy użyciu serwera Proxy aplikacji usługi Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-104">This article discusses how toointegrate an on-premises SharePoint server with Azure Active Directory (Azure AD) Application Proxy.</span></span>

<span data-ttu-id="e6eb1-105">tooenable tooSharePoint dostępu zdalnego z serwera Proxy aplikacji usługi Azure AD, należy wykonać hello sekcje w tym artykule krok po kroku.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-105">tooenable remote access tooSharePoint with Azure AD Application Proxy, follow hello sections in this article step by step.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e6eb1-106">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="e6eb1-106">Prerequisites</span></span>

<span data-ttu-id="e6eb1-107">W tym artykule założono, że już programu SharePoint 2013 lub nowszej w danym środowisku.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-107">This article assumes that you already have SharePoint 2013 or newer in your environment.</span></span> <span data-ttu-id="e6eb1-108">Ponadto należy wziąć pod uwagę następujące wymagania wstępne hello:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-108">In addition, consider hello following prerequisites:</span></span>

* <span data-ttu-id="e6eb1-109">SharePoint obejmuje natywnej obsługi protokołu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-109">SharePoint includes native Kerberos support.</span></span> <span data-ttu-id="e6eb1-110">W związku z tym użytkownicy, którzy uzyskują dostęp do wewnętrznych witryn zdalnie za pośrednictwem serwera Proxy aplikacji usługi Azure AD można założyć toohave rejestracji jednokrotnej (SSO) wystąpić.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-110">Therefore, users who are accessing internal sites remotely through Azure AD Application Proxy can assume toohave a single sign-on (SSO) experience.</span></span>

* <span data-ttu-id="e6eb1-111">Należy toomake kilka serwera SharePoint tooyour zmian konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-111">You need toomake a few configuration changes tooyour SharePoint server.</span></span> <span data-ttu-id="e6eb1-112">Firma Microsoft zaleca używanie środowiska przemieszczania.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-112">We recommend using a staging environment.</span></span> <span data-ttu-id="e6eb1-113">W ten sposób można dokonać aktualizacji tooyour najpierw przemieszczania serwera i następnie ułatwienia testowania cyklu przed przejściem do środowiska produkcyjnego.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-113">This way, you can make updates tooyour staging server first, and then facilitate a testing cycle before going into production.</span></span>

* <span data-ttu-id="e6eb1-114">Przyjęto założenie, że już skonfigurowano protokół SSL dla programu SharePoint, ponieważ firma Microsoft wymaga protokołu SSL na powitania opublikowany adresu URL.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-114">We assume that you have already set up SSL for SharePoint, because we require SSL on hello published URL.</span></span> <span data-ttu-id="e6eb1-115">Należy toohave włączony protokół SSL w witrynie wewnętrzny tooensure czy łącza są wysyłane/prawidłowo zamapowane.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-115">You need toohave SSL enabled on your internal site, tooensure that links are sent/mapped correctly.</span></span> <span data-ttu-id="e6eb1-116">Jeśli nie skonfigurowano protokół SSL, zobacz [skonfigurować protokół SSL dla programu SharePoint 2013](https://blogs.msdn.microsoft.com/fabdulwahab/2013/01/20/configure-ssl-for-sharepoint-2013) instrukcje.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-116">If you haven't configured SSL, see [Configure SSL for SharePoint 2013](https://blogs.msdn.microsoft.com/fabdulwahab/2013/01/20/configure-ssl-for-sharepoint-2013) for instructions.</span></span> <span data-ttu-id="e6eb1-117">Upewnij się również, tym hello łącznika maszyny zaufania hello certyfikat wystawiane.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-117">Also, make sure that hello connector machine trusts hello certificate that you issue.</span></span> <span data-ttu-id="e6eb1-118">(hello certyfikat nie musi toobe publicznie wydanych).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-118">(hello certificate does not need toobe publicly issued.)</span></span>

## <a name="step-1-set-up-single-sign-on-toosharepoint"></a><span data-ttu-id="e6eb1-119">Krok 1: Konfigurowanie tooSharePoint rejestracji jednokrotnej</span><span class="sxs-lookup"><span data-stu-id="e6eb1-119">Step 1: Set up single sign-on tooSharePoint</span></span>

<span data-ttu-id="e6eb1-120">Naszym klientom mają hello najlepszych funkcji rejestracji jednokrotnej dla swoich aplikacji zaplecza programu SharePoint server w takim przypadku.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-120">Our customers want hello best SSO experience for their back-end applications, SharePoint server in this case.</span></span> <span data-ttu-id="e6eb1-121">Ten częsty scenariusz usługi Azure AD hello użytkownik jest uwierzytelniany tylko raz, ponieważ nie zostanie wyświetlony monit dla uwierzytelniania ponownie.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-121">In this common Azure AD scenario, hello user is authenticated only once, because they will not be prompted for authentication again.</span></span>

<span data-ttu-id="e6eb1-122">Dla aplikacji lokalnych, które wymagają lub uwierzytelniania systemu Windows można osiągnąć logowania jednokrotnego przy użyciu protokołu uwierzytelniania Kerberos hello i funkcję ograniczonego delegowania protokołu Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-122">For on-premises applications that require or use Windows authentication, you can achieve SSO by using hello Kerberos authentication protocol and a feature called Kerberos constrained delegation (KCD).</span></span> <span data-ttu-id="e6eb1-123">Delegowanie KCD, po skonfigurowaniu umożliwia tooobtain łącznika serwera Proxy aplikacji hello systemu windows biletu/token dla użytkownika, nawet jeśli hello użytkownik nie zalogował się tooWindows bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-123">KCD, when configured, allows hello Application Proxy connector tooobtain a windows ticket/token for a user, even if hello user hasn’t signed in tooWindows directly.</span></span> <span data-ttu-id="e6eb1-124">toolearn więcej informacji na temat KCD, zobacz [omówienie delegowania ograniczonego protokołu Kerberos](https://technet.microsoft.com/library/jj553400.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-124">toolearn more about KCD, see [Kerberos Constrained Delegation Overview](https://technet.microsoft.com/library/jj553400.aspx).</span></span>

<span data-ttu-id="e6eb1-125">tooset się KCD programu SharePoint server, użyj procedury hello powitania po kolejnych sekcjach:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-125">tooset up KCD for a SharePoint server, use hello procedures in hello following sequential sections:</span></span>

### <a name="ensure-that-sharepoint-is-running-under-a-service-account"></a><span data-ttu-id="e6eb1-126">Upewnij się, że SharePoint działa w ramach konta usługi</span><span class="sxs-lookup"><span data-stu-id="e6eb1-126">Ensure that SharePoint is running under a service account</span></span>

<span data-ttu-id="e6eb1-127">Najpierw upewnij się, że SharePoint działa w ramach konta usługi zdefiniowanych — system lokalny, Usługa lokalna lub Usługa sieciowa.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-127">First, make sure that SharePoint is running under a defined service account--not local system, local service, or network service.</span></span> <span data-ttu-id="e6eb1-128">W tym tak, aby dołączyć prawidłowe konto tooa nazwy podmiotu zabezpieczeń (SPN) usługi.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-128">Do this so that you can attach service principal names (SPNs) tooa valid account.</span></span> <span data-ttu-id="e6eb1-129">Nazwy SPN są jak hello protokołu Kerberos identyfikuje różnych usług.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-129">SPNs are how hello Kerberos protocol identifies different services.</span></span> <span data-ttu-id="e6eb1-130">I będzie konieczne hello konta nowsze hello tooconfigure KCD.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-130">And you will need hello account later tooconfigure hello KCD.</span></span>

<span data-ttu-id="e6eb1-131">tooensure witryn uruchomionych na koncie usługi zdefiniowane, należy wykonać hello następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-131">tooensure that your sites are running under a defined service account, perform hello following steps:</span></span>

1. <span data-ttu-id="e6eb1-132">Otwórz hello **Administracja centralna programu SharePoint 2013** lokacji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-132">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e6eb1-133">Przejdź za**zabezpieczeń** i wybierz **Konfigurowanie kont usług**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-133">Go too**Security** and select **Configure service accounts**.</span></span>
3. <span data-ttu-id="e6eb1-134">Wybierz **— SharePoint — 80. pula aplikacji sieci Web**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-134">Select **Web Application Pool - SharePoint - 80**.</span></span> <span data-ttu-id="e6eb1-135">Opcje Hello mogą być nieco inne na podstawie nazwy hello puli sieci web, lub jeśli hello puli sieci web używa protokołu SSL, domyślnie.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-135">hello options may be slightly different based on hello name of your web pool, or if hello web pool uses SSL by default.</span></span>

  ![Opcje dotyczące konfigurowania konta usługi](./media/application-proxy-remote-sharepoint/remote-sharepoint-service-web-application.png)

4. <span data-ttu-id="e6eb1-137">Jeśli **wybierz konto dla tego składnika** jest **Usługa lokalna** lub **usługi sieciowej**, należy toocreate konta.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-137">If **Select an account for this component** is **Local Service** or **Network Service**, you need toocreate an account.</span></span> <span data-ttu-id="e6eb1-138">Jeśli nie, zakończeniu i przenieść toohello następnej sekcji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-138">If not, you're finished and can move toohello next section.</span></span>
5. <span data-ttu-id="e6eb1-139">Wybierz **rejestrowanie nowego zarządzanego konta**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-139">Select **Register new managed account**.</span></span> <span data-ttu-id="e6eb1-140">Po utworzeniu konta, musisz ustawić **puli aplikacji sieci Web** przed użyciem hello konta.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-140">After your account is created, you must set **Web Application Pool** before you can use hello account.</span></span>

> [!NOTE]
<span data-ttu-id="e6eb1-141">Należy toohave a wcześniej utworzone konto usługi Azure AD dla usługi hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-141">You need toohave a previously created Azure AD account for hello service.</span></span> <span data-ttu-id="e6eb1-142">Zalecamy, aby umożliwić automatyczne zmienianie hasła.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-142">We suggest that you allow for an automatic password change.</span></span> <span data-ttu-id="e6eb1-143">Aby uzyskać więcej informacji o hello pełny zestaw kroków i rozwiązywanie problemów, zobacz [skonfigurować automatyczne zmienianie hasła w programie SharePoint 2013](https://technet.microsoft.com/library/ff724280.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-143">For more information about hello full set of steps and troubleshooting issues, see [Configure automatic password change in SharePoint 2013](https://technet.microsoft.com/library/ff724280.aspx).</span></span>

### <a name="configure-sharepoint-for-kerberos"></a><span data-ttu-id="e6eb1-144">Konfigurowanie programu SharePoint dla protokołu Kerberos</span><span class="sxs-lookup"><span data-stu-id="e6eb1-144">Configure SharePoint for Kerberos</span></span>

<span data-ttu-id="e6eb1-145">Użyj KCD tooperform pojedynczego logowania jednokrotnego toohello programu SharePoint server, a to działa tylko przy użyciu protokołu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-145">You use KCD tooperform single sign-on toohello SharePoint server, and this works only with Kerberos.</span></span>

<span data-ttu-id="e6eb1-146">tooconfigure witryny programu SharePoint do uwierzytelniania protokołu Kerberos:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-146">tooconfigure your SharePoint site for Kerberos authentication:</span></span>

1. <span data-ttu-id="e6eb1-147">Otwórz hello **Administracja centralna programu SharePoint 2013** lokacji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-147">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e6eb1-148">Przejdź za**Zarządzanie aplikacjami**, wybierz pozycję **zarządzania aplikacjami sieci web**i wybierz pozycję witryny programu SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-148">Go too**Application Management**, select **Manage web applications**, and select your SharePoint site.</span></span> <span data-ttu-id="e6eb1-149">W tym przykładzie jest **SharePoint — 80**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-149">In this example, it is **SharePoint - 80**.</span></span>

  ![Wybieranie hello witryny programu SharePoint](./media/application-proxy-remote-sharepoint/remote-sharepoint-manage-web-applications.png)

3. <span data-ttu-id="e6eb1-151">Kliknij przycisk **dostawców uwierzytelniania** na powitania narzędzi.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-151">Click **Authentication Providers** on hello toolbar.</span></span>
4. <span data-ttu-id="e6eb1-152">W hello **dostawców uwierzytelniania** kliknij **strefa domyślna** tooview hello ustawienia.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-152">In hello **Authentication Providers** box, click **Default Zone** tooview hello settings.</span></span>
5. <span data-ttu-id="e6eb1-153">W hello **Edytuj uwierzytelnianie** okno dialogowe pola, przewiń w dół, aż zostanie wyświetlony **typy uwierzytelniania oświadczeń** i upewnij się, że oba **włączyć uwierzytelnianie systemu Windows** i  **Zintegrowane uwierzytelnianie systemu Windows** są wybrane.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-153">In hello **Edit Authentication** dialog box, scroll down until you see **Claims Authentication Types** and ensure that both **Enable Windows Authentication** and **Integrated Windows Authentication** are selected.</span></span>
6. <span data-ttu-id="e6eb1-154">Upewnij się, że w polu listy rozwijanej hello **Negotiate (Kerberos)** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-154">In hello drop-down box, make sure that **Negotiate (Kerberos)** is selected.</span></span>

  ![Okno dialogowe Edytowanie uwierzytelniania](./media/application-proxy-remote-sharepoint/remote-sharepoint-service-edit-authentication.png)

7. <span data-ttu-id="e6eb1-156">U dołu hello hello **Edytuj uwierzytelnianie** okno dialogowe, kliknij przycisk **zapisać**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-156">At hello bottom of hello **Edit Authentication** dialog box, click **Save**.</span></span>

### <a name="set-a-service-principal-name-for-hello-sharepoint-service-account"></a><span data-ttu-id="e6eb1-157">Ustaw nazwę główną usługi dla hello konto usługi programu SharePoint</span><span class="sxs-lookup"><span data-stu-id="e6eb1-157">Set a service principal name for hello SharePoint service account</span></span>

<span data-ttu-id="e6eb1-158">Przed skonfigurowaniem hello KCD należy usługi SharePoint hello tooidentify uruchomione jako konto usługi hello, który został skonfigurowany.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-158">Before you configure hello KCD, you need tooidentify hello SharePoint service running as hello service account that you've configured.</span></span> <span data-ttu-id="e6eb1-159">Można to zrobić przez ustawienie Nazwa SPN.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-159">You do this by setting an SPN.</span></span> <span data-ttu-id="e6eb1-160">Aby uzyskać więcej informacji, zobacz [główne nazwy usług](https://technet.microsoft.com/library/cc961723.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-160">For more information, see [Service Principal Names](https://technet.microsoft.com/library/cc961723.aspx).</span></span>

<span data-ttu-id="e6eb1-161">format nazwy SPN Hello jest:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-161">hello SPN format is:</span></span>

```
<service class>/<host>:<port>
```

<span data-ttu-id="e6eb1-162">Format nazwy SPN hello:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-162">In hello SPN format:</span></span>

* <span data-ttu-id="e6eb1-163">_usługi klasy_ jest unikatową nazwą hello usługi.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-163">_service class_ is a unique name for hello service.</span></span> <span data-ttu-id="e6eb1-164">Dla programu SharePoint, możesz użyć **HTTP**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-164">For SharePoint, you use **HTTP**.</span></span>

* <span data-ttu-id="e6eb1-165">_host_ jest hello FQDN lub nazwę NetBIOS hello hosta, który hello usługa jest uruchomiona na.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-165">_host_ is hello fully qualified domain or NetBIOS name of hello host that hello service is running on.</span></span> <span data-ttu-id="e6eb1-166">Witryny programu SharePoint ten tekst może być konieczne toobe hello adres URL witryny hello, w zależności od wersji hello usług IIS, którego używasz.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-166">For a SharePoint site, this text might need toobe hello URL of hello site, depending on hello version of IIS that you're using.</span></span>

* <span data-ttu-id="e6eb1-167">_port_ jest opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-167">_port_ is optional.</span></span>

<span data-ttu-id="e6eb1-168">Jeśli hello nazwę FQDN serwera SharePoint hello jest:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-168">If hello FQDN of hello SharePoint server is:</span></span>

```
sharepoint.demo.o365identity.us
```

<span data-ttu-id="e6eb1-169">Następnie hello SPN jest:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-169">Then hello SPN is:</span></span>

```
HTTP/ sharepoint.demo.o365identity.us demo
```

<span data-ttu-id="e6eb1-170">Konieczne może również tooset SPN dla określonych witryn na serwerze.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-170">You might also need tooset SPNs for specific sites on your server.</span></span> <span data-ttu-id="e6eb1-171">Aby uzyskać więcej informacji, zobacz [uwierzytelnianie Kerberos skonfigurować](https://technet.microsoft.com/library/cc263449(v=office.12).aspx).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-171">For more information, see [Configure Kerberos authentication](https://technet.microsoft.com/library/cc263449(v=office.12).aspx).</span></span> <span data-ttu-id="e6eb1-172">Należy zwrócić szczególną uwagę toohello sekcji "Tworzenie główne nazwy usług dla aplikacji sieci Web przy użyciu uwierzytelniania Kerberos."</span><span class="sxs-lookup"><span data-stu-id="e6eb1-172">Pay close attention toohello section "Create Service Principal Names for your Web applications using Kerberos authentication."</span></span>

<span data-ttu-id="e6eb1-173">Hello najprościej tooset SPN jest toofollow hello SPN formatów, które mogą być już dostępne dla witryny.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-173">hello easiest way for you tooset SPNs is toofollow hello SPN formats that may already be present for your sites.</span></span> <span data-ttu-id="e6eb1-174">Skopiuj te tooregister SPN konta usługi hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-174">Copy those SPNs tooregister against hello service account.</span></span> <span data-ttu-id="e6eb1-175">toodo to:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-175">toodo this:</span></span>

1. <span data-ttu-id="e6eb1-176">Przeglądaj witrynę toohello z hello SPN z innego komputera.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-176">Browse toohello site with hello SPN from another machine.</span></span>
 <span data-ttu-id="e6eb1-177">Gdy hello odpowiedniego zbioru bilety Kerberos są buforowane na powitania maszyny.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-177">When you do, hello relevant set of Kerberos tickets is cached on hello machine.</span></span> <span data-ttu-id="e6eb1-178">Bilety zawierają hello SPN hello lokacji docelowej, które zostały wybrane.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-178">These tickets contain hello SPN of hello target site that you browsed to.</span></span>

2. <span data-ttu-id="e6eb1-179">Hello SPN dla tej lokacji można pobierać za pomocą narzędzie [Klist](http://web.mit.edu/kerberos/krb5-devel/doc/user/user_commands/klist.html).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-179">You can pull hello SPN for that site by using a tool called [Klist](http://web.mit.edu/kerberos/krb5-devel/doc/user/user_commands/klist.html).</span></span> <span data-ttu-id="e6eb1-180">W oknie polecenia działającej w hello tego samego kontekstu jako użytkownik hello hello używanych witryn w przeglądarce hello, uruchom hello następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-180">In a command window that's running in hello same context as hello user who accessed hello site in hello browser, run hello following command:</span></span>
```
Klist
```
<span data-ttu-id="e6eb1-181">Klist zwraca zbiór hello docelowej nazw SPN.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-181">Klist then returns hello set of target SPNs.</span></span> <span data-ttu-id="e6eb1-182">W tym przykładzie wartość hello wyróżnione jest hello głównej nazwy usługi, które ma potrzebne:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-182">In this example, hello highlighted value is hello SPN that's needed:</span></span>

  ![Przykład Klist wyników](./media/application-proxy-remote-sharepoint/remote-sharepoint-target-service.png)

4. <span data-ttu-id="e6eb1-184">Teraz, gdy masz hello głównej nazwy usługi, należy się upewnić, że został on poprawnie skonfigurowany na koncie usługi hello skonfigurowanego dla aplikacji sieci web hello wcześniej toomake.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-184">Now that you have hello SPN, you need toomake sure that it's configured correctly on hello service account that you set up for hello web application earlier.</span></span> <span data-ttu-id="e6eb1-185">Uruchom następujące polecenie w wierszu polecenia hello jako administrator domeny hello hello:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-185">Run hello following command from hello command prompt as an administrator of hello domain:</span></span>

 ```
 setspn -S http/sharepoint.demo.o365identity.us demo\sp_svc
 ```

 <span data-ttu-id="e6eb1-186">To polecenie ustawia hello SPN dla usługi SharePoint hello konta uruchomiony jako _demo\sp_svc_.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-186">This command sets hello SPN for hello SharePoint service account running as _demo\sp_svc_.</span></span>

 <span data-ttu-id="e6eb1-187">Zastąp _http/sharepoint.demo.o365identity.us_ z hello SPN serwera i _demo\sp_svc_ z kontem usługi hello w danym środowisku.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-187">Replace _http/sharepoint.demo.o365identity.us_ with hello SPN for your server and _demo\sp_svc_ with hello service account in your environment.</span></span> <span data-ttu-id="e6eb1-188">polecenia Setspn Hello wyszukuje hello SPN, przed dodaniem go.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-188">hello Setspn command searches for hello SPN before it adds it.</span></span> <span data-ttu-id="e6eb1-189">W takim przypadku można napotkać **zduplikowane wartości nazwy SPN** błędu.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-189">In this case, you might see a **Duplicate SPN Value** error.</span></span> <span data-ttu-id="e6eb1-190">Jeśli zostanie wyświetlony ten błąd, upewnij się, że wartość hello jest skojarzony z kontem usługi hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-190">If you see this error, make sure that hello value is associated with hello service account.</span></span>

<span data-ttu-id="e6eb1-191">Możesz zweryfikować tego hello dodania nazwy SPN, uruchamiając polecenia Setspn hello z opcją -l hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-191">You can verify that hello SPN was added by running hello Setspn command with hello -l option.</span></span> <span data-ttu-id="e6eb1-192">toolearn więcej informacji na temat tego polecenia, zobacz [Setspn](https://technet.microsoft.com/library/cc731241.aspx).</span><span class="sxs-lookup"><span data-stu-id="e6eb1-192">toolearn more about this command, see [Setspn](https://technet.microsoft.com/library/cc731241.aspx).</span></span>

### <a name="ensure-that-hello-connector-is-set-as-a-trusted-delegate-toosharepoint"></a><span data-ttu-id="e6eb1-193">Upewnij się, że ten łącznik hello jest ustawiony jako tooSharePoint zaufanych delegata</span><span class="sxs-lookup"><span data-stu-id="e6eb1-193">Ensure that hello connector is set as a trusted delegate tooSharePoint</span></span>

<span data-ttu-id="e6eb1-194">Witaj KCD należy skonfigurować, tak aby hello usługi serwera Proxy aplikacji usługi Azure AD można delegować usługi SharePoint toohello tożsamości użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-194">Configure hello KCD so that hello Azure AD Application Proxy service can delegate user identities toohello SharePoint service.</span></span> <span data-ttu-id="e6eb1-195">Aby to zrobić, włączenie łącznika serwera Proxy aplikacji hello biletów Kerberos tooretrieve dla użytkowników, którzy zostali uwierzytelnieni w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-195">You do this by enabling hello Application Proxy connector tooretrieve Kerberos tickets for your users who have been authenticated in Azure AD.</span></span> <span data-ttu-id="e6eb1-196">Następnie ten serwer aplikacji docelowej toohello kontekstu hello lub SharePoint w takim przypadku.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-196">Then that server passes hello context toohello target application, or SharePoint in this case.</span></span>

<span data-ttu-id="e6eb1-197">Witaj tooconfigure KCD, powtórz hello następujące kroki dla każdego komputera łącznika:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-197">tooconfigure hello KCD, repeat hello following steps for each connector machine:</span></span>

1. <span data-ttu-id="e6eb1-198">Zaloguj się jako tooa administratora domeny, kontrolera domeny, a następnie otwórz **użytkownicy usługi Active Directory i komputery**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-198">Log in as a domain administrator tooa DC, and then open **Active Directory Users and Computers**.</span></span>
2. <span data-ttu-id="e6eb1-199">Znajdź hello komputera, na którym hello łącznika jest uruchomiona na.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-199">Find hello computer that hello connector is running on.</span></span> <span data-ttu-id="e6eb1-200">W tym przykładzie go ma hello sam serwer programu SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-200">In this example, it's hello same SharePoint server.</span></span>
3. <span data-ttu-id="e6eb1-201">Kliknij dwukrotnie ikonę hello komputer, a następnie kliknij przycisk hello **delegowania** kartę.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-201">Double-click hello computer, and then click hello **Delegation** tab.</span></span>
4. <span data-ttu-id="e6eb1-202">Upewnij się, że ustawienia delegowania hello są ustawiane za**Ufaj temu komputerowi w toohello delegowania określonych usług tylko**, a następnie wybierz **Użyj dowolnego protokołu uwierzytelniania**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-202">Ensure that hello delegation settings are set too**Trust this computer for delegation toohello specified services only**, and then select **Use any authentication protocol**.</span></span>

  ![Ustawienia delegowania](./media/application-proxy-remote-sharepoint/remote-sharepoint-delegation-box.png)

5. <span data-ttu-id="e6eb1-204">Kliknij przycisk hello **Dodaj** , kliknij **użytkowników lub komputerów**i Znajdź hello konta usługi.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-204">Click hello **Add** button, click **Users or Computers**, and locate hello service account.</span></span>

  ![Dodawanie hello SPN konta usługi hello](./media/application-proxy-remote-sharepoint/remote-sharepoint-users-computers.png)

6. <span data-ttu-id="e6eb1-206">Hello listy nazw SPN wybierz hello został utworzony wcześniej hello konta usługi.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-206">In hello list of SPNs, select hello one that you created earlier for hello service account.</span></span>
7. <span data-ttu-id="e6eb1-207">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-207">Click **OK**.</span></span> <span data-ttu-id="e6eb1-208">Kliknij przycisk **OK** ponownie toosave hello zmiany.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-208">Click **OK** again toosave hello changes.</span></span>

## <a name="step-2-enable-remote-access-toosharepoint"></a><span data-ttu-id="e6eb1-209">Krok 2: Włączanie tooSharePoint dostępu zdalnego</span><span class="sxs-lookup"><span data-stu-id="e6eb1-209">Step 2: Enable remote access tooSharePoint</span></span>

<span data-ttu-id="e6eb1-210">Została włączona programu SharePoint dla protokołu Kerberos i skonfigurowana KCD, możesz gotowe tooset się tooSharePoint rejestracji jednokrotnej.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-210">Now that you’ve enabled SharePoint for Kerberos and configured KCD, you're ready tooset up single sign-on tooSharePoint.</span></span> <span data-ttu-id="e6eb1-211">Następnie z łącznika hello można opublikować hello farmy programu SharePoint dla dostępu zdalnego za pośrednictwem serwera Proxy aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-211">Then from hello connector, you can publish hello SharePoint farm for remote access through Azure AD Application Proxy.</span></span>

<span data-ttu-id="e6eb1-212">Witaj tooperform następujące kroki, należy toobe członkiem hello rola administratora globalnego w organizacji konta usługi Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-212">tooperform hello following steps, you need toobe a member of hello Global Administrator Role in your organization's Azure Active Directory account.</span></span>

1. <span data-ttu-id="e6eb1-213">Zaloguj się toohello [portalu Azure](https://manage.windowsazure.com) i Znajdź dzierżawy usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-213">Sign in toohello [Azure portal](https://manage.windowsazure.com) and find your Azure AD tenant.</span></span>
2. <span data-ttu-id="e6eb1-214">Kliknij przycisk **aplikacji**, a następnie kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-214">Click **Applications**, and then click **Add**.</span></span>
3. <span data-ttu-id="e6eb1-215">Wybierz pozycję **Opublikuj aplikację dostępną spoza sieci**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-215">Select **Publish an application that will be accessible from outside your network**.</span></span> <span data-ttu-id="e6eb1-216">Jeśli nie widzisz tej opcji upewnij się, że masz Azure AD podstawowa lub Premium, skonfiguruj w dzierżawie powitalnych.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-216">If you don’t see this option, make sure that you have Azure AD Basic or Premium set up in hello tenant.</span></span>
4. <span data-ttu-id="e6eb1-217">Wykonaj każdą z opcji hello w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-217">Complete each of hello options as follows:</span></span>
 * <span data-ttu-id="e6eb1-218">**Nazwa**: Użyj żadnej wartości, które mają — na przykład **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-218">**Name**: Use any value that you want--for example, **SharePoint**.</span></span>
 * <span data-ttu-id="e6eb1-219">**Wewnętrzny adres URL**: jest to adres URL witryny SharePoint hello hello wewnętrznie, takich jak **https://SharePoint/**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-219">**Internal URL**: This is hello URL of hello SharePoint site internally, such as **https://SharePoint/**.</span></span> <span data-ttu-id="e6eb1-220">W tym przykładzie, upewnij się, że toouse **https**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-220">In this example, make sure toouse **https**.</span></span>
 * <span data-ttu-id="e6eb1-221">**Metoda uwierzytelniania wstępnego**: Wybierz **usługi Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-221">**Preauthentication Method**: Select **Azure Active Directory**.</span></span>

  ![Opcje dodawania aplikacji](./media/application-proxy-remote-sharepoint/remote-sharepoint-add-application.png)

5. <span data-ttu-id="e6eb1-223">Po opublikowaniu aplikacji hello kliknij hello **Konfiguruj** kartę.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-223">After hello app is published, click hello **Configure** tab.</span></span>
6. <span data-ttu-id="e6eb1-224">Przewiń w dół opcji toohello **translacji adresów URL w nagłówkach**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-224">Scroll down toohello option **Translate URL in Headers**.</span></span> <span data-ttu-id="e6eb1-225">Witaj, wartość domyślna to **tak**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-225">hello default value is **YES**.</span></span> <span data-ttu-id="e6eb1-226">Zmień ją za**nr**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-226">Change it too**NO**.</span></span>

 <span data-ttu-id="e6eb1-227">SharePoint używa hello _nagłówek hosta_ toolook wartość hello witrynę.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-227">SharePoint uses hello _Host Header_ value toolook up hello site.</span></span> <span data-ttu-id="e6eb1-228">Generuje on również linki, na podstawie tej wartości.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-228">It also generates links based on this value.</span></span> <span data-ttu-id="e6eb1-229">Efekt netto Hello jest toomake się, że każde łącze, które generuje programu SharePoint jest opublikowane adres URL, który jest ustawiony prawidłowo toouse hello zewnętrznego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-229">hello net effect is toomake sure that any link that SharePoint generates is a published URL that is correctly set toouse hello external URL.</span></span> <span data-ttu-id="e6eb1-230">Ustawienie wartości hello zbyt**tak** również umożliwia hello łącznika tooforward hello żądania toohello zaplecza aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-230">Setting hello value too**YES** also enables hello connector tooforward hello request toohello back-end application.</span></span> <span data-ttu-id="e6eb1-231">Jednak ustawienie wartości hello zbyt**nr** oznacza, że hello łącznik nie będzie wysyłać hello nazwy wewnętrznej hosta.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-231">However, setting hello value too**NO** means that hello connector will not send hello internal host name.</span></span> <span data-ttu-id="e6eb1-232">Zamiast tego łącznika hello wysyła nagłówek hosta hello hello opublikowanych aplikacji zaplecza toohello adresu URL.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-232">Instead, hello connector sends hello host header as hello published URL toohello back-end application.</span></span>

 <span data-ttu-id="e6eb1-233">Tooensure również, że SharePoint akceptuje ten adres URL należy toocomplete jeden dodatkowych czynności konfiguracyjnych na powitania serwera programu SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-233">Also, tooensure that SharePoint accepts this URL, you need toocomplete one more configuration on hello SharePoint server.</span></span> <span data-ttu-id="e6eb1-234">Należy to zrobić w następnej sekcji hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-234">You'll do that in hello next section.</span></span>

7. <span data-ttu-id="e6eb1-235">Zmień **metody uwierzytelniania wewnętrznego** za**zintegrowane uwierzytelnianie systemu Windows**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-235">Change **Internal Authentication Method** too**Integrated Windows Authentication**.</span></span> <span data-ttu-id="e6eb1-236">Jeśli dzierżawy usługi Azure AD używa nazwy UPN w chmurze hello, która różni się od hello UPN lokalnie, należy pamiętać o tooupdate **delegowane tożsamości logowania** również.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-236">If your Azure AD tenant uses a UPN in hello cloud that's different from hello UPN on-premises, remember tooupdate **Delegated Login Identity** as well.</span></span>
8. <span data-ttu-id="e6eb1-237">Ustaw **wewnętrzny SPN aplikacji** toohello wartość ustawiona wcześniej.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-237">Set **Internal Application SPN** toohello value that you set earlier.</span></span> <span data-ttu-id="e6eb1-238">Na przykład użyć **http/sharepoint.demo.o365identity.us**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-238">For example, use **http/sharepoint.demo.o365identity.us**.</span></span>
9. <span data-ttu-id="e6eb1-239">Przypisz tooyour aplikacji hello użytkowników docelowych.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-239">Assign hello application tooyour target users.</span></span>

<span data-ttu-id="e6eb1-240">Aplikacja powinna wyglądać podobnie toohello poniższy przykład:</span><span class="sxs-lookup"><span data-stu-id="e6eb1-240">Your application should look similar toohello following example:</span></span>

  ![Zakończono aplikacji](./media/application-proxy-remote-sharepoint/remote-sharepoint-internal-application-spn.png)

## <a name="step-3-ensure-that-sharepoint-knows-about-hello-external-url"></a><span data-ttu-id="e6eb1-242">Krok 3: Upewnij się, że zna hello zewnętrznego adresu URL programu SharePoint</span><span class="sxs-lookup"><span data-stu-id="e6eb1-242">Step 3: Ensure that SharePoint knows about hello external URL</span></span>

<span data-ttu-id="e6eb1-243">Z ostatnich tooensure krok, który programu SharePoint można znaleźć hello witryny opartej na powitania zewnętrzny adres URL, dzięki czemu będą zawierały łącza na podstawie tego zewnętrznego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-243">Your last step tooensure that SharePoint can find hello site based on hello external URL, so that it will render links based on that external URL.</span></span> <span data-ttu-id="e6eb1-244">W tym celu Konfigurowanie mapowań dostępu alternatywnego hello witryny programu SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-244">You do this by configuring alternate access mappings for hello SharePoint site.</span></span>

1. <span data-ttu-id="e6eb1-245">Otwórz hello **Administracja centralna programu SharePoint 2013** lokacji.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-245">Open hello **SharePoint 2013 Central Administration** site.</span></span>
2. <span data-ttu-id="e6eb1-246">W obszarze **ustawienia systemu**, wybierz pozycję **Konfigurowanie mapowań dostępu alternatywnego**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-246">Under **System Settings**, select **Configure Alternate Access Mappings**.</span></span>

 <span data-ttu-id="e6eb1-247">Spowoduje to otwarcie hello **mapowań dostępu alternatywnego** pole.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-247">This opens hello **Alternate Access Mappings** box.</span></span>

  ![Pole mapowań dostępu alternatywnego](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access1.png)

3. <span data-ttu-id="e6eb1-249">Hello listy rozwijanej obok **kolekcji mapowania dostępu alternatywnego**, wybierz pozycję **zmiany alternatywnego dostępu mapowania kolekcji**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-249">In hello drop-down list beside **Alternate Access Mapping Collection**, select **Change Alternate Access Mapping Collection**.</span></span>
4. <span data-ttu-id="e6eb1-250">Wybierz lokację — na przykład **SharePoint — 80**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-250">Select your site--for example, **SharePoint - 80**.</span></span>

  ![Wybieranie lokacji](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access2.png)

5. <span data-ttu-id="e6eb1-252">Można wybrać tooadd hello opublikowany adresu URL jako wewnętrzny adres URL lub publiczny adres URL.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-252">You can choose tooadd hello published URL as either an internal URL or a public URL.</span></span> <span data-ttu-id="e6eb1-253">W tym przykładzie używa publicznego adresu URL jako hello ekstranetu.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-253">This example uses a public URL as hello extranet.</span></span>
6. <span data-ttu-id="e6eb1-254">Kliknij przycisk **Edytuj publiczne adresy URL** w hello **ekstranet** ścieżki, a następnie wprowadź hello ścieżkę hello opublikowane aplikacji, jak w poprzednim kroku hello.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-254">Click **Edit Public URLs** in hello **Extranet** path, and then enter hello path for hello published application, as in hello previous step.</span></span> <span data-ttu-id="e6eb1-255">Na przykład wprowadź **https://sharepoint-iddemo.msappproxy.net**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-255">For example, enter **https://sharepoint-iddemo.msappproxy.net**.</span></span>

  ![Wprowadzanie ścieżki hello](./media/application-proxy-remote-sharepoint/remote-sharepoint-alternate-access3.png)

7. <span data-ttu-id="e6eb1-257">Kliknij pozycję **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-257">Click **Save**.</span></span>

 <span data-ttu-id="e6eb1-258">Można teraz uzyskać dostęp do witryny programu SharePoint hello zewnętrznie za pośrednictwem serwera Proxy aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e6eb1-258">You can now access hello SharePoint site externally via Azure AD Application Proxy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e6eb1-259">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="e6eb1-259">Next steps</span></span>

- [<span data-ttu-id="e6eb1-260">Jak tooprovide bezpiecznego dostępu zdalnego tooon lokalnej aplikacji</span><span class="sxs-lookup"><span data-stu-id="e6eb1-260">How tooprovide secure remote access tooon-premises applications</span></span>](active-directory-application-proxy-get-started.md)
- [<span data-ttu-id="e6eb1-261">Zrozumienie łączniki serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="e6eb1-261">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
- [<span data-ttu-id="e6eb1-262">Publikowanie programu SharePoint 2016 i Office Online serwera za pomocą serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="e6eb1-262">Publishing SharePoint 2016 and Office Online Server with Azure AD Application Proxy</span></span>](https://blogs.technet.microsoft.com/dawiese/2016/06/09/publishing-sharepoint-2016-and-office-online-server-with-azure-ad-application-proxy/)
