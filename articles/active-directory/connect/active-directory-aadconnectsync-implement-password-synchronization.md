---
title: "Implementowanie synchronizacji haseł z synchronizacji Azure AD Connect | Dokumentacja firmy Microsoft"
description: "Zawiera informacje o sposobie działania synchronizacji haseł i sposobu konfigurowania."
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 05f16c3e-9d23-45dc-afca-3d0fa9dbf501
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: db9b1578a235be9018fc1985cc75a0a05ee47b3a
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="implement-password-synchronization-with-azure-ad-connect-sync"></a><span data-ttu-id="afb8f-103">Implementowanie synchronizacji haseł z synchronizacji Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="afb8f-103">Implement password synchronization with Azure AD Connect sync</span></span>
<span data-ttu-id="afb8f-104">Ten artykuł zawiera informacje potrzebne do synchronizacji haseł użytkowników z lokalnego wystąpienia usługi Active Directory do wystąpienia usługi Azure Active Directory (Azure AD) oparte na chmurze.</span><span class="sxs-lookup"><span data-stu-id="afb8f-104">This article provides information that you need to synchronize your user passwords from an on-premises Active Directory instance to a cloud-based Azure Active Directory (Azure AD) instance.</span></span>

## <a name="what-is-password-synchronization"></a><span data-ttu-id="afb8f-105">Co to jest synchronizacja haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-105">What is password synchronization</span></span>
<span data-ttu-id="afb8f-106">Prawdopodobieństwo, że jest blokowane pracę z powodu zapomniane hasło jest powiązany z liczbę różnych haseł należy pamiętać.</span><span class="sxs-lookup"><span data-stu-id="afb8f-106">The probability that you're blocked from getting your work done due to a forgotten password is related to the number of different passwords you need to remember.</span></span> <span data-ttu-id="afb8f-107">Więcej haseł należy należy pamiętać, że większe prawdopodobieństwo zapomnieć jeden.</span><span class="sxs-lookup"><span data-stu-id="afb8f-107">The more passwords you need to remember, the higher the probability to forget one.</span></span> <span data-ttu-id="afb8f-108">Pytania i wywołania dotyczące resetowania hasła i inne problemy związane z hasłem popytu najwięcej zasobów pomocy technicznej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-108">Questions and calls about password resets and other password-related issues demand the most helpdesk resources.</span></span>

<span data-ttu-id="afb8f-109">Synchronizacja haseł to funkcja używana do synchronizacji haseł użytkowników z lokalnego wystąpienia usługi Active Directory na platformie Azure opartej na chmurze wystąpienia usługi AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-109">Password synchronization is a feature used to synchronize user passwords from an on-premises Active Directory instance to a cloud-based Azure AD instance.</span></span>
<span data-ttu-id="afb8f-110">Ta funkcja służy do logowania do usługi Azure AD, takie jak usługi Office 365, Microsoft Intune CRM Online i Azure Active Directory Domain Services (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="afb8f-110">Use this feature to sign in to Azure AD services like Office 365, Microsoft Intune, CRM Online, and Azure Active Directory Domain Services (Azure AD DS).</span></span> <span data-ttu-id="afb8f-111">Możesz logować się do usługi przy użyciu tego samego hasła, używanego do logowania się na lokalnym wystąpieniem usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-111">You sign in to the service by using the same password you use to sign in to your on-premises Active Directory instance.</span></span>

![Co to jest program Azure AD Connect](./media/active-directory-aadconnectsync-implement-password-synchronization/arch1.png)

<span data-ttu-id="afb8f-113">Dzięki zmniejszeniu liczby haseł, użytkownicy muszą zachować do co najmniej jeden.</span><span class="sxs-lookup"><span data-stu-id="afb8f-113">By reducing the number of passwords, your users need to maintain to just one.</span></span> <span data-ttu-id="afb8f-114">Synchronizacja haseł ułatwia:</span><span class="sxs-lookup"><span data-stu-id="afb8f-114">Password synchronization helps you to:</span></span>

* <span data-ttu-id="afb8f-115">Zwiększenie produktywności użytkowników.</span><span class="sxs-lookup"><span data-stu-id="afb8f-115">Improve the productivity of your users.</span></span>
* <span data-ttu-id="afb8f-116">Obniżyć koszty pomocy technicznej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-116">Reduce your helpdesk costs.</span></span>  

<span data-ttu-id="afb8f-117">Ponadto jeśli zdecydujesz się używać [federacji z usługi Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), można opcjonalnie skonfigurować synchronizacji haseł jako zapasowy na wypadek awarii infrastruktury usług AD FS.</span><span class="sxs-lookup"><span data-stu-id="afb8f-117">Also, if you decide to use [Federation with Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), you can optionally set up password synchronization as a backup in case your AD FS infrastructure fails.</span></span>

<span data-ttu-id="afb8f-118">Synchronizacja haseł to rozszerzenie funkcji synchronizacji katalogu implementowane przez synchronizacja programu Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="afb8f-118">Password synchronization is an extension to the directory synchronization feature implemented by Azure AD Connect sync.</span></span> <span data-ttu-id="afb8f-119">Aby korzystać z synchronizacji haseł w danym środowisku, musisz:</span><span class="sxs-lookup"><span data-stu-id="afb8f-119">To use password synchronization in your environment, you need to:</span></span>

* <span data-ttu-id="afb8f-120">Instalowanie usługi Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="afb8f-120">Install Azure AD Connect.</span></span>  
* <span data-ttu-id="afb8f-121">Skonfigurować synchronizację katalogów między lokalnym wystąpieniem usługi Active Directory i wystąpienie usługi Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-121">Configure directory synchronization between your on-premises Active Directory instance and your Azure Active Directory instance.</span></span>
* <span data-ttu-id="afb8f-122">Włączanie synchronizacji haseł.</span><span class="sxs-lookup"><span data-stu-id="afb8f-122">Enable password synchronization.</span></span>

<span data-ttu-id="afb8f-123">Aby uzyskać więcej informacji, zobacz [Integrowanie tożsamości lokalnych z usługą Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="afb8f-123">For more details, see [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

> [!NOTE]
> <span data-ttu-id="afb8f-124">Aby uzyskać więcej informacji na temat usługi Azure Active Directory Domain Services skonfigurowany dla FIPS i synchronizacja haseł, zobacz "synchronizacji haseł i FIPS" w dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="afb8f-124">For more details about Azure Active Directory Domain Services configured for FIPS and password synchronization, see "Password synchronization and FIPS" later in this article.</span></span>
>
>

## <a name="how-password-synchronization-works"></a><span data-ttu-id="afb8f-125">Opis działania synchronizacji haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-125">How password synchronization works</span></span>
<span data-ttu-id="afb8f-126">Domeny usługi Active Directory są przechowywane hasła w postaci reprezentację wartość skrótu hasła rzeczywistego użytkownika.</span><span class="sxs-lookup"><span data-stu-id="afb8f-126">The Active Directory domain service stores passwords in the form of a hash value representation of the actual user password.</span></span> <span data-ttu-id="afb8f-127">Wartość skrótu jest wynikiem jednokierunkowej funkcji matematycznych ( *algorytmem wyznaczania wartości skrótu*).</span><span class="sxs-lookup"><span data-stu-id="afb8f-127">A hash value is a result of a one-way mathematical function (the *hashing algorithm*).</span></span> <span data-ttu-id="afb8f-128">Nie istnieje metoda można przywrócić wynik jednokierunkowa funkcja wersji tekstowego hasła.</span><span class="sxs-lookup"><span data-stu-id="afb8f-128">There is no method to revert the result of a one-way function to the plain text version of a password.</span></span> <span data-ttu-id="afb8f-129">Nie można użyć skrótu hasła do logowania się w sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-129">You cannot use a password hash to sign in to your on-premises network.</span></span>

<span data-ttu-id="afb8f-130">Aby synchronizować hasła, synchronizacja programu Azure AD Connect wyodrębnia z skrót hasła z lokalnego wystąpienia usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-130">To synchronize your password, Azure AD Connect sync extracts your password hash from the on-premises Active Directory instance.</span></span> <span data-ttu-id="afb8f-131">Przetwarzanie dodatkowych zabezpieczeń są stosowane do skrótu hasła przed jest zsynchronizowany z usługą uwierzytelniania usługi Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-131">Extra security processing is applied to the password hash before it is synchronized to the Azure Active Directory authentication service.</span></span> <span data-ttu-id="afb8f-132">Hasła są synchronizowane na poszczególnych użytkowników i w kolejności chronologicznej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-132">Passwords are synchronized on a per-user basis and in chronological order.</span></span>

<span data-ttu-id="afb8f-133">Przepływ danych rzeczywistych proces synchronizacji haseł jest podobny do synchronizacji danych użytkownika, takich jak DisplayName lub adresy E-mail.</span><span class="sxs-lookup"><span data-stu-id="afb8f-133">The actual data flow of the password synchronization process is similar to the synchronization of user data such as DisplayName or Email Addresses.</span></span> <span data-ttu-id="afb8f-134">Jednak hasła są synchronizowane częściej niż okno synchronizacji katalogu standard dla innych atrybutów.</span><span class="sxs-lookup"><span data-stu-id="afb8f-134">However, passwords are synchronized more frequently than the standard directory synchronization window for other attributes.</span></span> <span data-ttu-id="afb8f-135">Proces synchronizacji haseł jest uruchamiany co 2 minuty.</span><span class="sxs-lookup"><span data-stu-id="afb8f-135">The password synchronization process runs every 2 minutes.</span></span> <span data-ttu-id="afb8f-136">Nie można zmodyfikować częstotliwości tego procesu.</span><span class="sxs-lookup"><span data-stu-id="afb8f-136">You cannot modify the frequency of this process.</span></span> <span data-ttu-id="afb8f-137">Po zsynchronizowaniu hasła, zastępuje on istniejące hasło chmury.</span><span class="sxs-lookup"><span data-stu-id="afb8f-137">When you synchronize a password, it overwrites the existing cloud password.</span></span>

<span data-ttu-id="afb8f-138">Przy pierwszym włączeniu funkcji synchronizacji haseł, wykonuje wstępnej synchronizacji haseł wszystkich użytkowników w zakresie.</span><span class="sxs-lookup"><span data-stu-id="afb8f-138">The first time you enable the password synchronization feature, it performs an initial synchronization of the passwords of all in-scope users.</span></span> <span data-ttu-id="afb8f-139">Nie można jawnie definiować podzbiór hasła użytkownika, które mają być synchronizowane.</span><span class="sxs-lookup"><span data-stu-id="afb8f-139">You cannot explicitly define a subset of user passwords that you want to synchronize.</span></span>

<span data-ttu-id="afb8f-140">Jeśli zmienisz hasło lokalne, zaktualizowanego hasła są synchronizowane, często w ciągu kilku minut.</span><span class="sxs-lookup"><span data-stu-id="afb8f-140">When you change an on-premises password, the updated password is synchronized, most often in a matter of minutes.</span></span>
<span data-ttu-id="afb8f-141">Funkcja synchronizacji hasła ma automatycznie ponawiać próby synchronizacji nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="afb8f-141">The password synchronization feature automatically retries failed synchronization attempts.</span></span> <span data-ttu-id="afb8f-142">Jeśli wystąpi błąd podczas próby synchronizować hasła, błąd jest rejestrowany w podglądu zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="afb8f-142">If an error occurs during an attempt to synchronize a password, an error is logged in your event viewer.</span></span>

<span data-ttu-id="afb8f-143">Synchronizacja hasła nie ma wpływu na użytkownika, który jest aktualnie zalogowany.</span><span class="sxs-lookup"><span data-stu-id="afb8f-143">The synchronization of a password has no impact on the user  who is currently signed in.</span></span>
<span data-ttu-id="afb8f-144">Zmiany hasła zsynchronizowane, która występuje, gdy użytkownik jest zalogowany do usługi w chmurze nie występuje od razu w bieżącej sesji usługi chmury.</span><span class="sxs-lookup"><span data-stu-id="afb8f-144">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you are signed in to a cloud service.</span></span> <span data-ttu-id="afb8f-145">Jednakże gdy usługa w chmurze, należy uwierzytelnić się ponownie, należy podać nowe hasło.</span><span class="sxs-lookup"><span data-stu-id="afb8f-145">However, when the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

<span data-ttu-id="afb8f-146">Użytkownik musi wprowadzić poświadczenia firmowe po raz drugi do uwierzytelniania usługi Azure AD, niezależnie od tego, czy ich nastąpiło zalogowanie do sieci firmowej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-146">A user must enter their corporate credentials a second time to authenticate to Azure AD, regardless of whether they're signed in to their corporate network.</span></span> <span data-ttu-id="afb8f-147">Wzorzec te można zminimalizować, jednak jeśli użytkownik wybierze Keep mnie podpisany w pole wyboru (KMSI) podczas logowania.</span><span class="sxs-lookup"><span data-stu-id="afb8f-147">These pattern can be minimized, however, if the user selects the Keep me signed in (KMSI) check box at sign in.</span></span> <span data-ttu-id="afb8f-148">Wybranie tej opcji ustawia plik cookie sesji omija uwierzytelniania krótki okres.</span><span class="sxs-lookup"><span data-stu-id="afb8f-148">This selection sets a session cookie that bypasses authentication for a short period.</span></span> <span data-ttu-id="afb8f-149">Zachowanie KMSI można włączona lub wyłączona przez administratora usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-149">KMSI behavior can be enabled or disabled by the Azure AD administrator.</span></span>

> [!NOTE]
> <span data-ttu-id="afb8f-150">Synchronizacja haseł jest obsługiwana tylko dla typu obiektu użytkownika w usłudze Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-150">Password sync is only supported for the object type user in Active Directory.</span></span> <span data-ttu-id="afb8f-151">Nie jest obsługiwana dla typu obiektu iNetOrgPerson.</span><span class="sxs-lookup"><span data-stu-id="afb8f-151">It is not supported for the iNetOrgPerson object type.</span></span>

### <a name="detailed-description-of-how-password-synchronization-works"></a><span data-ttu-id="afb8f-152">Szczegółowy opis działania synchronizacji haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-152">Detailed description of how password synchronization works</span></span>
<span data-ttu-id="afb8f-153">Poniżej przedstawiono szczegółowy opis działania synchronizacji haseł od usługi Active Directory i Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-153">The following describes in-depth how password synchronization works between Active Directory and Azure AD.</span></span>

![Przepływ szczegółowe hasła](./media/active-directory-aadconnectsync-implement-password-synchronization/arch3.png)


1. <span data-ttu-id="afb8f-155">Co dwie minuty, agent synchronizacji haseł na serwerze AD Connect żądań skrótów haseł przechowywanych (atrybut unicodePwd) z kontrolera domeny za pomocą standardowego [MS DRSR](https://msdn.microsoft.com/library/cc228086.aspx) używane do synchronizowania danych między protokołu replikacji Kontrolery domeny.</span><span class="sxs-lookup"><span data-stu-id="afb8f-155">Every two minutes, the password synchronization agent on the AD Connect server requests stored password hashes (the unicodePwd attribute) from a DC via the standard [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replication protocol used to synchronize data between DCs.</span></span> <span data-ttu-id="afb8f-156">Konto usługi musi mieć replikować zmiany katalogu i replikować katalogu zmiany wszystkich AD uprawnienia (domyślnie w instalacji) do uzyskania wartości skrótu hasła.</span><span class="sxs-lookup"><span data-stu-id="afb8f-156">The service account must have Replicate Directory Changes and Replicate Directory Changes All AD permissions (granted by default on installation) to obtain the password hashes.</span></span>
2. <span data-ttu-id="afb8f-157">Przed wysłaniem, kontroler domeny szyfruje MD4 skrót hasła przy użyciu klucza, który jest [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) skrótu klucza sesji RPC i soli.</span><span class="sxs-lookup"><span data-stu-id="afb8f-157">Before sending, the DC encrypts the MD4 password hash by using a key that is a [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash of the RPC session key and a salt.</span></span> <span data-ttu-id="afb8f-158">Następnie wysyła wynik do agent synchronizacji haseł za pośrednictwem wywołania RPC.</span><span class="sxs-lookup"><span data-stu-id="afb8f-158">It then sends the result to the password synchronization agent over RPC.</span></span> <span data-ttu-id="afb8f-159">Kontroler domeny również przekazuje soli agent synchronizacji przy użyciu protokołu replikacji kontrolera domeny, agent będzie można odszyfrować koperty.</span><span class="sxs-lookup"><span data-stu-id="afb8f-159">The DC also passes the salt to the synchronization agent by using the DC replication protocol, so the agent will be able to decrypt the envelope.</span></span>
3.  <span data-ttu-id="afb8f-160">Agent synchronizacji haseł po zaszyfrowanych koperty używa [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) i soli do wygenerowania klucza do odszyfrowywania odebranych danych do oryginalnego formatu MD4.</span><span class="sxs-lookup"><span data-stu-id="afb8f-160">After the password synchronization agent has the encrypted envelope, it uses [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) and the salt to generate a key to decrypt the received data back to its original MD4 format.</span></span> <span data-ttu-id="afb8f-161">W żadnym punkcie agent synchronizacji haseł ma dostęp do hasła w postaci zwykłego tekstu.</span><span class="sxs-lookup"><span data-stu-id="afb8f-161">At no point does the password synchronization agent have access to the clear text password.</span></span> <span data-ttu-id="afb8f-162">Użyj agent synchronizacji haseł MD5 obejmuje wyłącznie zgodność z protokołem replikacji z kontrolerem domeny i jest używana tylko na lokalne między kontrolerem domeny i agent synchronizacji haseł.</span><span class="sxs-lookup"><span data-stu-id="afb8f-162">The password synchronization agent’s use of MD5 is strictly for replication protocol compatibility with the DC, and it is only used on premises between the DC and the password synchronization agent.</span></span>
4.  <span data-ttu-id="afb8f-163">Agent synchronizacji haseł rozszerza wartość skrótu hasła binarne 16-bajtowych 64 bajtów konwertując pierwszy skrót na ciąg szesnastkowy 32-bajtowych, następnie konwertując tego ciągu z powrotem do binarną, używając kodowania UTF-16.</span><span class="sxs-lookup"><span data-stu-id="afb8f-163">The password synchronization agent expands the 16-byte binary password hash to 64 bytes by first converting the hash to a 32-byte hexadecimal string, then converting this string back into binary with UTF-16 encoding.</span></span>
5.  <span data-ttu-id="afb8f-164">Agent synchronizacji haseł dodaje soli, składające się soli długość 10-bajtowych, do pliku binarnego 64-bajtowych, aby jeszcze lepiej chronić oryginalnego wyznaczania wartości skrótu.</span><span class="sxs-lookup"><span data-stu-id="afb8f-164">The password synchronization agent adds a salt, consisting of a 10-byte length salt, to the 64-byte binary to further protect the original hash.</span></span>
6.  <span data-ttu-id="afb8f-165">Agent synchronizacji haseł następnie łączy skrót MD4 plus soli i danych wejściowych do [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) funkcji.</span><span class="sxs-lookup"><span data-stu-id="afb8f-165">The password synchronization agent then combines the MD4 hash plus salt, and inputs it into the [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) function.</span></span> <span data-ttu-id="afb8f-166">iteracje 1000 [HMAC SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) kluczem algorytmu wyznaczania wartości skrótu jest używany.</span><span class="sxs-lookup"><span data-stu-id="afb8f-166">1000 iterations of the [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) keyed hashing algorithm is used.</span></span> 
7.  <span data-ttu-id="afb8f-167">Agent synchronizacji haseł przyjmuje wynikowy skrót 32-bajtowych, łączy zarówno soli i liczby iteracji SHA256 do niego (na potrzeby używania przez usługę Azure AD), a następnie przesyła ciąg z usługi Azure AD Connect do usługi Azure AD przy użyciu protokołu SSL.</span><span class="sxs-lookup"><span data-stu-id="afb8f-167">The password synchronization agent takes the resulting 32-byte hash, concatenates both the salt and the number of SHA256 iterations to it (for use by Azure AD), then transmits the string from Azure AD Connect to Azure AD over SSL.</span></span></br> 
8.  <span data-ttu-id="afb8f-168">Gdy użytkownik próbuje zalogować się do usługi Azure AD i wprowadza swoje hasło, hasło jest uruchamiane za pomocą tego samego MD4 + ziarna + PBKDF2 + HMAC SHA256 procesu.</span><span class="sxs-lookup"><span data-stu-id="afb8f-168">When a user attempts to sign in to Azure AD and enters their password, the password is run through the same MD4+salt+PBKDF2+HMAC-SHA256 process.</span></span> <span data-ttu-id="afb8f-169">Jeśli wynikowy skrót zgodny skrótu przechowywane w usłudze Azure AD, użytkownik wprowadził prawidłowe hasło i zostanie uwierzytelniony.</span><span class="sxs-lookup"><span data-stu-id="afb8f-169">If the resulting hash matches the hash stored in Azure AD, the user has entered the correct password and is authenticated.</span></span> 

>[!Note] 
><span data-ttu-id="afb8f-170">Oryginalny skrót MD4 nie są przesyłane do usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-170">The original MD4 hash is not transmitted to Azure AD.</span></span> <span data-ttu-id="afb8f-171">Zamiast tego są przesyłane skrót SHA256 wyznaczania wartości skrótu MD4 oryginalnego.</span><span class="sxs-lookup"><span data-stu-id="afb8f-171">Instead, the SHA256 hash of the original MD4 hash is transmitted.</span></span> <span data-ttu-id="afb8f-172">W związku z tym Jeśli skrót przechowywane w usłudze Azure AD są uzyskiwane, nie można użyć w ataku pass--hash lokalnymi.</span><span class="sxs-lookup"><span data-stu-id="afb8f-172">As a result, if the hash stored in Azure AD is obtained, it cannot be used in an on-premises pass-the-hash attack.</span></span>

### <a name="how-password-synchronization-works-with-azure-active-directory-domain-services"></a><span data-ttu-id="afb8f-173">Opis działania synchronizacji haseł z usług domenowych Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="afb8f-173">How password synchronization works with Azure Active Directory Domain Services</span></span>
<span data-ttu-id="afb8f-174">Umożliwia także funkcji synchronizacji haseł można zsynchronizować hasła lokalnego do [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="afb8f-174">You can also use the password synchronization feature to synchronize your on-premises passwords to [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span></span> <span data-ttu-id="afb8f-175">W tym scenariuszu wystąpienia usługi Azure Active Directory Domain Services uwierzytelnia użytkowników w chmurze z wszystkich metod dostępnych w lokalnym wystąpieniu usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-175">In this scenario, the Azure Active Directory Domain Services instance authenticates your users in the cloud with all the methods available in your on-premises Active Directory instance.</span></span> <span data-ttu-id="afb8f-176">Środowisko w tym scenariuszu jest podobny do sposobu używania narzędzia migracji usługi Active Directory (ADMT) w środowisku lokalnym.</span><span class="sxs-lookup"><span data-stu-id="afb8f-176">The experience of this scenario is similar to using the Active Directory Migration Tool (ADMT) in an on-premises environment.</span></span>

### <a name="security-considerations"></a><span data-ttu-id="afb8f-177">Zagadnienia związane z zabezpieczeniami</span><span class="sxs-lookup"><span data-stu-id="afb8f-177">Security considerations</span></span>
<span data-ttu-id="afb8f-178">Podczas synchronizacji haseł wersji tekstowego hasła nie jest widoczne dla funkcji synchronizacji haseł do usługi Azure AD, ani dla żadnej z powiązanymi usługami.</span><span class="sxs-lookup"><span data-stu-id="afb8f-178">When synchronizing passwords, the plain-text version of your password is not exposed to the password synchronization feature, to Azure AD, or any of the associated services.</span></span>

<span data-ttu-id="afb8f-179">Uwierzytelnianie użytkownika ma miejsce przed usługi Azure AD, a nie na wystąpieniu usługi Active Directory w organizacji.</span><span class="sxs-lookup"><span data-stu-id="afb8f-179">User authentication takes place against Azure AD rather than against the organization's own Active Directory instance.</span></span> <span data-ttu-id="afb8f-180">Jeśli Twoja organizacja ma problemów dotyczących danych hasła w żadnym tworzą, pozostawiając lokalnej instalacji programu, należy wziąć pod uwagę fakt, że dane hasło SHA256 przechowywane w usłudze Azure AD — skrót oryginalnego wyznaczania wartości skrótu MD4 — jest znacznie bezpieczniejsze niż co to jest przechowywane w usłudze Active Directory.</span><span class="sxs-lookup"><span data-stu-id="afb8f-180">If your organization has concerns about password data in any form leaving the premises, consider the fact that the SHA256 password data stored in Azure AD--a hash of the original MD4 hash--is significantly more secure than what is stored in Active Directory.</span></span> <span data-ttu-id="afb8f-181">Co więcej ponieważ nie można odszyfrować ten skrót SHA256, uniemożliwiający przywrócone do środowiska usługi Active Directory w firmie i widoczne jako prawidłowego użytkownika hasła w ataku typu pass--hash.</span><span class="sxs-lookup"><span data-stu-id="afb8f-181">Further, because this SHA256 hash cannot be decrypted, it cannot be brought back to the organization's Active Directory environment and presented as a valid user password in a pass-the-hash attack.</span></span>





### <a name="password-policy-considerations"></a><span data-ttu-id="afb8f-182">Zagadnienia dotyczące zasad haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-182">Password policy considerations</span></span>
<span data-ttu-id="afb8f-183">Istnieją dwa typy zasad haseł, których dotyczy Włączanie synchronizacji haseł:</span><span class="sxs-lookup"><span data-stu-id="afb8f-183">There are two types of password policies that are affected by enabling password synchronization:</span></span>

* <span data-ttu-id="afb8f-184">Zasady złożoności haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-184">Password complexity policy</span></span>
* <span data-ttu-id="afb8f-185">Zasady wygasania haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-185">Password expiration policy</span></span>

#### <a name="password-complexity-policy"></a><span data-ttu-id="afb8f-186">Zasady złożoności haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-186">Password complexity policy</span></span>  
<span data-ttu-id="afb8f-187">Po włączeniu synchronizacji haseł zasady złożoności haseł w lokalnym wystąpieniu usługi Active Directory zastępują zasady złożoności w chmurze na potrzeby zsynchronizowanych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="afb8f-187">When password synchronization is enabled, the password complexity policies in your on-premises Active Directory instance override complexity policies in the cloud for synchronized users.</span></span> <span data-ttu-id="afb8f-188">Możliwość używania wszystkich prawidłowy haseł z lokalnym wystąpieniem usługi Active Directory dostępu do usług Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-188">You can use all of the valid passwords from your on-premises Active Directory instance to access Azure AD services.</span></span>

> [!NOTE]
> <span data-ttu-id="afb8f-189">Hasła użytkowników, które są tworzone bezpośrednio w chmurze podlegają nadal zasady haseł zgodnie z definicją w chmurze.</span><span class="sxs-lookup"><span data-stu-id="afb8f-189">Passwords for users that are created directly in the cloud are still subject to password policies as defined in the cloud.</span></span>

#### <a name="password-expiration-policy"></a><span data-ttu-id="afb8f-190">Zasady wygasania haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-190">Password expiration policy</span></span>  
<span data-ttu-id="afb8f-191">Jeśli użytkownik znajduje się w zakresie synchronizacji haseł, hasło konta chmury jest ustawiony na *nigdy nie wygasa*.</span><span class="sxs-lookup"><span data-stu-id="afb8f-191">If a user is in the scope of password synchronization, the cloud account password is set to *Never Expire*.</span></span>

<span data-ttu-id="afb8f-192">Możesz logować się do usługi w chmurze przy użyciu hasła zsynchronizowane, który wygasł w środowisku lokalnym.</span><span class="sxs-lookup"><span data-stu-id="afb8f-192">You can continue to sign in to your cloud services by using a synchronized password that is expired in your on-premises environment.</span></span> <span data-ttu-id="afb8f-193">Hasło chmury jest aktualizowany przy następnym zmienić hasło w środowisku lokalnym.</span><span class="sxs-lookup"><span data-stu-id="afb8f-193">Your cloud password is updated the next time you change the password in the on-premises environment.</span></span>

#### <a name="account-expiration"></a><span data-ttu-id="afb8f-194">Okres ważności konta</span><span class="sxs-lookup"><span data-stu-id="afb8f-194">Account expiration</span></span>
<span data-ttu-id="afb8f-195">Jeśli organizacja używa atrybutu accountExpires jako część Zarządzanie kontami użytkowników, należy pamiętać, że ten atrybut nie jest zsynchronizowany z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-195">If your organization uses the accountExpires attribute as part of user account management, be aware that this attribute is not synchronized to Azure AD.</span></span> <span data-ttu-id="afb8f-196">W związku z tym wygasłe konto usługi Active Directory w środowisku skonfigurowana z synchronizacją hasła pozostaje aktywna w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-196">As a result, an expired Active Directory account in an environment configured for password synchronization will still be active in Azure AD.</span></span> <span data-ttu-id="afb8f-197">Zaleca się, że wygasł konto akcji przepływu pracy powinno spowodować skrypt programu PowerShell, które wyłączają konta usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-197">We recommend that if the account is expired, a workflow action should trigger a PowerShell script that disables the user's Azure AD account.</span></span> <span data-ttu-id="afb8f-198">Z drugiej strony gdy konto jest włączona, wystąpienie usługi Azure AD powinna być włączona.</span><span class="sxs-lookup"><span data-stu-id="afb8f-198">Conversely, when the account is turned on, the Azure AD instance should be turned on.</span></span>

### <a name="overwrite-synchronized-passwords"></a><span data-ttu-id="afb8f-199">Zastąp synchronizowane hasła</span><span class="sxs-lookup"><span data-stu-id="afb8f-199">Overwrite synchronized passwords</span></span>
<span data-ttu-id="afb8f-200">Administrator może ręcznie zresetować hasło przy użyciu programu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="afb8f-200">An administrator can manually reset your password by using Windows PowerShell.</span></span>

<span data-ttu-id="afb8f-201">W takim przypadku nowe hasło zastępuje synchronizowane hasła, a wszystkie zasady haseł zdefiniowane w chmurze są stosowane do nowego hasła.</span><span class="sxs-lookup"><span data-stu-id="afb8f-201">In this case, the new password overrides your synchronized password, and all password policies defined in the cloud are applied to the new password.</span></span>

<span data-ttu-id="afb8f-202">Jeśli zmienisz hasło lokalne ponownie nowe hasło jest zsynchronizowany z chmurą i zastępuje on ręcznie zaktualizowanego hasła.</span><span class="sxs-lookup"><span data-stu-id="afb8f-202">If you change your on-premises password again, the new password is synchronized to the cloud, and it overrides the manually updated password.</span></span>

<span data-ttu-id="afb8f-203">Synchronizacja hasła nie ma wpływu na użytkowników platformy Azure, który jest zalogowany.</span><span class="sxs-lookup"><span data-stu-id="afb8f-203">The synchronization of a password has no impact on the Azure user who is signed in.</span></span> <span data-ttu-id="afb8f-204">Zmiany hasła zsynchronizowane, która występuje, gdy użytkownik jest zalogowany do usługi w chmurze nie występuje od razu w bieżącej sesji usługi chmury.</span><span class="sxs-lookup"><span data-stu-id="afb8f-204">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you're signed in to a cloud service.</span></span> <span data-ttu-id="afb8f-205">KMSI rozszerza czas trwania tej różnicy.</span><span class="sxs-lookup"><span data-stu-id="afb8f-205">KMSI extends the duration of this difference.</span></span> <span data-ttu-id="afb8f-206">Gdy usługa w chmurze, należy uwierzytelnić się ponownie, należy podać nowe hasło.</span><span class="sxs-lookup"><span data-stu-id="afb8f-206">When the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

### <a name="additional-advantages"></a><span data-ttu-id="afb8f-207">Dodatkowe korzyści</span><span class="sxs-lookup"><span data-stu-id="afb8f-207">Additional advantages</span></span>

- <span data-ttu-id="afb8f-208">Ogólnie rzecz biorąc synchronizacja haseł jest prostsza do zaimplementowania niż usługi federacyjnej.</span><span class="sxs-lookup"><span data-stu-id="afb8f-208">Generally, password synchronization is simpler to implement than a federation service.</span></span> <span data-ttu-id="afb8f-209">Nie wymaga żadnych dodatkowych serwerów i eliminuje zależność od usługi federacyjnej wysokiej dostępności do uwierzytelniania użytkowników.</span><span class="sxs-lookup"><span data-stu-id="afb8f-209">It doesn't require any additional servers, and eliminates dependence on a highly available federation service to authenticate users.</span></span> 
- <span data-ttu-id="afb8f-210">Synchronizację haseł można również włączyć oprócz federacji.</span><span class="sxs-lookup"><span data-stu-id="afb8f-210">Password synchronization can also be enabled in addition to federation.</span></span> <span data-ttu-id="afb8f-211">Mogą być używane jako rezerwowe, jeśli usługi federacyjnej ulegnie awarii.</span><span class="sxs-lookup"><span data-stu-id="afb8f-211">It may be used as a fallback if your federation service experiences an outage.</span></span>












## <a name="enable-password-synchronization"></a><span data-ttu-id="afb8f-212">Włączanie synchronizacji haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-212">Enable password synchronization</span></span>
<span data-ttu-id="afb8f-213">Po zainstalowaniu usługi Azure AD Connect przy użyciu **ustawień ekspresowych** opcji synchronizacji haseł jest automatycznie włączone.</span><span class="sxs-lookup"><span data-stu-id="afb8f-213">When you install Azure AD Connect by using the **Express Settings** option, password synchronization is automatically enabled.</span></span> <span data-ttu-id="afb8f-214">Aby uzyskać więcej informacji, zobacz [wprowadzenie do korzystania z usługi Azure AD Connect przy użyciu ustawień ekspresowych](active-directory-aadconnect-get-started-express.md).</span><span class="sxs-lookup"><span data-stu-id="afb8f-214">For more details, see [Getting started with Azure AD Connect using express settings](active-directory-aadconnect-get-started-express.md).</span></span>

<span data-ttu-id="afb8f-215">Jeśli używasz ustawienia niestandardowe, po zainstalowaniu usługi Azure AD Connect, synchronizacja haseł jest dostępne na stronie logowania użytkownika.</span><span class="sxs-lookup"><span data-stu-id="afb8f-215">If you use custom settings when you install Azure AD Connect, password synchronization is available on the user sign-in page.</span></span> <span data-ttu-id="afb8f-216">Aby uzyskać więcej informacji, zobacz [Instalacja niestandardowa programu Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="afb8f-216">For more details, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Włączanie synchronizacji haseł](./media/active-directory-aadconnectsync-implement-password-synchronization/usersignin.png)

### <a name="password-synchronization-and-fips"></a><span data-ttu-id="afb8f-218">Synchronizacja haseł i FIPS</span><span class="sxs-lookup"><span data-stu-id="afb8f-218">Password synchronization and FIPS</span></span>
<span data-ttu-id="afb8f-219">Jeśli serwer został zablokowany zgodnie z przetwarzania Standard FIPS (Federal Information), MD5 jest wyłączone.</span><span class="sxs-lookup"><span data-stu-id="afb8f-219">If your server has been locked down according to Federal Information Processing Standard (FIPS), then MD5 is disabled.</span></span>

<span data-ttu-id="afb8f-220">**Aby włączyć MD5, aby synchronizować hasła, wykonaj następujące czynności:**</span><span class="sxs-lookup"><span data-stu-id="afb8f-220">**To enable MD5 for password synchronization, perform the following steps:**</span></span>

1. <span data-ttu-id="afb8f-221">Przejdź do Sync\Bin %programfiles%\Azure AD.</span><span class="sxs-lookup"><span data-stu-id="afb8f-221">Go to %programfiles%\Azure AD Sync\Bin.</span></span>
2. <span data-ttu-id="afb8f-222">Otwórz miiserver.exe.config.</span><span class="sxs-lookup"><span data-stu-id="afb8f-222">Open miiserver.exe.config.</span></span>
3. <span data-ttu-id="afb8f-223">Przejdź do węzła konfiguracji/runtime na końcu pliku.</span><span class="sxs-lookup"><span data-stu-id="afb8f-223">Go to the configuration/runtime node at the end of the file.</span></span>
4. <span data-ttu-id="afb8f-224">Dodaj następującego węzła:`<enforceFIPSPolicy enabled="false"/>`</span><span class="sxs-lookup"><span data-stu-id="afb8f-224">Add the following node: `<enforceFIPSPolicy enabled="false"/>`</span></span>
5. <span data-ttu-id="afb8f-225">Zapisz zmiany.</span><span class="sxs-lookup"><span data-stu-id="afb8f-225">Save your changes.</span></span>

<span data-ttu-id="afb8f-226">Odwołanie ta Wstawka kodu jest jak go powinna wyglądać:</span><span class="sxs-lookup"><span data-stu-id="afb8f-226">For reference, this snippet is what it should look like:</span></span>

```
    <configuration>
        <runtime>
            <enforceFIPSPolicy enabled="false"/>
        </runtime>
    </configuration>
```

<span data-ttu-id="afb8f-227">Aby uzyskać informacje o zabezpieczeniach i FIPS, zobacz [zgodności AAD Sync hasła, szyfrowania i FIPS](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span><span class="sxs-lookup"><span data-stu-id="afb8f-227">For information about security and FIPS, see [AAD Password Sync, encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span></span>

## <a name="troubleshoot-password-synchronization"></a><span data-ttu-id="afb8f-228">Rozwiązywanie problemów z synchronizacją haseł</span><span class="sxs-lookup"><span data-stu-id="afb8f-228">Troubleshoot password synchronization</span></span>
<span data-ttu-id="afb8f-229">Jeśli masz problemy z synchronizacją haseł, zobacz [Rozwiązywanie problemów z synchronizacją hasła](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="afb8f-229">If you have problems with password synchronization, see [Troubleshoot password synchronization](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="afb8f-230">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="afb8f-230">Next steps</span></span>
* [<span data-ttu-id="afb8f-231">Synchronizacja programu Azure AD Connect: Dostosowywanie opcji synchronizacji</span><span class="sxs-lookup"><span data-stu-id="afb8f-231">Azure AD Connect sync: Customizing synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="afb8f-232">Integrowanie tożsamości lokalnych z usługą Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="afb8f-232">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
