---
title: 'Azure AD Connect: Uaktualnianie z poprzedniej wersji | Dokumentacja firmy Microsoft'
description: "W tym artykule wyjaśniono różnych metod do uaktualnienia do najnowszej wersji programu Azure Active Directory Connect, w tym uaktualnienia w miejscu i migracji kierunku."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 31f084d8-2b89-478c-9079-76cf92e6618f
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 52fd9375c71c42feaf87f4a0f4220e1cb3889e63
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-upgrade-from-a-previous-version-to-the-latest"></a><span data-ttu-id="10275-103">Azure AD Connect: Uaktualnianie z poprzedniej wersji do najnowszej wersji</span><span class="sxs-lookup"><span data-stu-id="10275-103">Azure AD Connect: Upgrade from a previous version to the latest</span></span>
<span data-ttu-id="10275-104">W tym temacie opisano różne metody, których można użyć, aby uaktualnić instalację Połącz usługi Azure Active Directory (Azure AD) do najnowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="10275-104">This topic describes the different methods that you can use to upgrade your Azure Active Directory (Azure AD) Connect installation to the latest release.</span></span> <span data-ttu-id="10275-105">Zaleca się pozostawienie samodzielnie bieżącego z wersjami programu Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="10275-105">We recommend that you keep yourself current with the releases of Azure AD Connect.</span></span> <span data-ttu-id="10275-106">Możesz również użyć kroki opisane w [migracji w kierunku](#swing-migration) sekcji podczas wprowadzania istotne zmiany konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="10275-106">You also use the steps in the [Swing migration](#swing-migration) section when you make a substantial configuration change.</span></span>

<span data-ttu-id="10275-107">Jeśli chcesz uaktualnić narzędzia DirSync, zobacz [uaktualnienie z narzędzia Azure AD sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="10275-107">If you want to upgrade from DirSync, see [Upgrade from Azure AD sync tool (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) instead.</span></span>

<span data-ttu-id="10275-108">Istnieje kilka różnych strategie, których można użyć do uaktualnienia usługi Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="10275-108">There are a few different strategies that you can use to upgrade Azure AD Connect.</span></span>

| <span data-ttu-id="10275-109">Metoda</span><span class="sxs-lookup"><span data-stu-id="10275-109">Method</span></span> | <span data-ttu-id="10275-110">Opis</span><span class="sxs-lookup"><span data-stu-id="10275-110">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="10275-111">Automatycznie uaktualnianie</span><span class="sxs-lookup"><span data-stu-id="10275-111">Automatic upgrade</span></span>](active-directory-aadconnect-feature-automatic-upgrade.md) |<span data-ttu-id="10275-112">Jest to najprostsza dla klientów z instalacji ekspresowej.</span><span class="sxs-lookup"><span data-stu-id="10275-112">This is the easiest method for customers with an express installation.</span></span> |
| [<span data-ttu-id="10275-113">Uaktualnienie w miejscu</span><span class="sxs-lookup"><span data-stu-id="10275-113">In-place upgrade</span></span>](#in-place-upgrade) |<span data-ttu-id="10275-114">Jeśli pojedynczy serwer, możesz uaktualnić instalację w miejscu na tym samym serwerze.</span><span class="sxs-lookup"><span data-stu-id="10275-114">If you have a single server, you can upgrade the installation in-place on the same server.</span></span> |
| [<span data-ttu-id="10275-115">Zasięg migracji</span><span class="sxs-lookup"><span data-stu-id="10275-115">Swing migration</span></span>](#swing-migration) |<span data-ttu-id="10275-116">Przy użyciu dwóch serwerów Przygotuj jeden z serwerów z nowej wersji lub konfiguracji i zmienić aktywnego serwera, gdy wszystko jest gotowe.</span><span class="sxs-lookup"><span data-stu-id="10275-116">With two servers, you can prepare one of the servers with the new release or configuration, and change the active server when you're ready.</span></span> |

<span data-ttu-id="10275-117">Aby uzyskać informacje o uprawnieniach, zobacz [uprawnienia wymagane do uaktualnienia](active-directory-aadconnect-accounts-permissions.md#upgrade).</span><span class="sxs-lookup"><span data-stu-id="10275-117">For permissions information, see the [permissions required for an upgrade](active-directory-aadconnect-accounts-permissions.md#upgrade).</span></span>

> [!NOTE]
> <span data-ttu-id="10275-118">Po włączeniu nowy serwer Azure AD Connect w taki sposób, aby uruchomić synchronizację zmian z usługą Azure AD musi nie wycofasz przy użyciu narzędzia DirSync i Azure AD Sync.</span><span class="sxs-lookup"><span data-stu-id="10275-118">After you've enabled your new Azure AD Connect server to start synchronizing changes to Azure AD, you must not roll back to using DirSync or Azure AD Sync.</span></span> <span data-ttu-id="10275-119">Powrót do starszych klientów, w tym narzędzia DirSync i Azure AD Sync subskrypcji z usługi Azure AD Connect nie jest obsługiwana i może prowadzić do problemów, takich jak utraty danych w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="10275-119">Downgrading from Azure AD Connect to legacy clients, including DirSync and Azure AD Sync, isn't supported and can lead to issues such as data loss in Azure AD.</span></span>

## <a name="in-place-upgrade"></a><span data-ttu-id="10275-120">Uaktualnienie w miejscu</span><span class="sxs-lookup"><span data-stu-id="10275-120">In-place upgrade</span></span>
<span data-ttu-id="10275-121">Uaktualnienie w miejscu działa w przypadku przenoszenia z usługi Azure AD Sync lub Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="10275-121">An in-place upgrade works for moving from Azure AD Sync or Azure AD Connect.</span></span> <span data-ttu-id="10275-122">Ta funkcja nie działa z narzędzia DirSync lub rozwiązanie z programu Forefront Identity Manager (FIM) + Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="10275-122">It doesn't work for moving from DirSync or for a solution with Forefront Identity Manager (FIM) + Azure AD Connector.</span></span>

<span data-ttu-id="10275-123">Ta metoda jest preferowana pojedynczego serwera i mniejsza niż około 100 000 obiektów.</span><span class="sxs-lookup"><span data-stu-id="10275-123">This method is preferred when you have a single server and less than about 100,000 objects.</span></span> <span data-ttu-id="10275-124">W przypadku zmiany reguły synchronizacji out-of-box pełny import i pełną synchronizację wystąpić po uaktualnieniu.</span><span class="sxs-lookup"><span data-stu-id="10275-124">If there are any changes to the out-of-box sync rules, a full import and full synchronization occur after the upgrade.</span></span> <span data-ttu-id="10275-125">Ta metoda gwarantuje, że nowa konfiguracja jest stosowane do wszystkich istniejących obiektów w systemie.</span><span class="sxs-lookup"><span data-stu-id="10275-125">This method ensures that the new configuration is applied to all existing objects in the system.</span></span> <span data-ttu-id="10275-126">Uruchom ten może potrwać kilka godzin w zależności od liczby obiektów, które znajdują się w zakresie aparatu synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="10275-126">This run might take a few hours, depending on the number of objects that are in scope of the sync engine.</span></span> <span data-ttu-id="10275-127">Harmonogram synchronizacji normalne różnicowych (co domyślnie synchronizuje co 30 minut) jest wstrzymana, ale nadal synchronizacji haseł.</span><span class="sxs-lookup"><span data-stu-id="10275-127">The normal delta synchronization scheduler (which synchronizes every 30 minutes by default) is suspended, but password synchronization continues.</span></span> <span data-ttu-id="10275-128">Należy rozważyć sposób uaktualnienia w miejscu weekend.</span><span class="sxs-lookup"><span data-stu-id="10275-128">You might consider doing the in-place upgrade during a weekend.</span></span> <span data-ttu-id="10275-129">W przypadku wydania żadnych zmian do konfiguracji out-of-box z nowej usługi Azure AD Connect, następnie import/synchronizacji różnicowej normalne uruchamia zamiast tego.</span><span class="sxs-lookup"><span data-stu-id="10275-129">If there are no changes to the out-of-box configuration with the new Azure AD Connect release, then a normal delta import/sync starts instead.</span></span>  
![Uaktualnienie w miejscu](./media/active-directory-aadconnect-upgrade-previous-version/inplaceupgrade.png)

<span data-ttu-id="10275-131">Jeśli wprowadzono zmiany do reguły synchronizacji out-of-box te reguły są ustawiane powrót do konfiguracji domyślnej na uaktualnienie.</span><span class="sxs-lookup"><span data-stu-id="10275-131">If you've made changes to the out-of-box synchronization rules, then these rules are set back to the default configuration on upgrade.</span></span> <span data-ttu-id="10275-132">Aby upewnić się, że konfigurację jest przechowywana między uaktualnień, upewnij się, wprowadzić zmiany, ponieważ są one opisane w [najlepsze rozwiązania dotyczące zmieniania konfiguracji domyślnej](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="10275-132">To make sure that your configuration is kept between upgrades, make sure that you make changes as they're described in [Best practices for changing the default configuration](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span></span>

<span data-ttu-id="10275-133">Podczas uaktualniania w miejscu, mogą występować zmian wprowadzonych, które wymagają działań określonych synchronizacji (w tym kroki pełny Import i pełną synchronizację) ma być wykonywana po zakończeniu uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="10275-133">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed after upgrade completes.</span></span> <span data-ttu-id="10275-134">Odroczenie takich działań, zapoznaj się z rozdziałem [jak mają być odroczone pełną synchronizację po uaktualnieniu](#how-to-defer-full-synchronization-after-upgrade).</span><span class="sxs-lookup"><span data-stu-id="10275-134">To defer such activities, refer to section [How to defer full synchronization after upgrade](#how-to-defer-full-synchronization-after-upgrade).</span></span>

## <a name="swing-migration"></a><span data-ttu-id="10275-135">Migracja typu swing</span><span class="sxs-lookup"><span data-stu-id="10275-135">Swing migration</span></span>
<span data-ttu-id="10275-136">Jeśli masz złożone wdrożenia lub wiele obiektów, może być niemożliwe do uaktualnienie w miejscu na żywo w systemie.</span><span class="sxs-lookup"><span data-stu-id="10275-136">If you have a complex deployment or many objects, it might be impractical to do an in-place upgrade on the live system.</span></span> <span data-ttu-id="10275-137">W przypadku niektórych klientów ten proces może potrwać kilka dni — i w tym czasie nie zmiany różnicowe są przetwarzane.</span><span class="sxs-lookup"><span data-stu-id="10275-137">For some customers, this process might take multiple days--and during this time, no delta changes are processed.</span></span> <span data-ttu-id="10275-138">Tej metody można użyć również, gdy ma być istotne zmiany w konfiguracji i chcesz wypróbować je przed ich jest przypisany do chmury.</span><span class="sxs-lookup"><span data-stu-id="10275-138">You can also use this method when you plan to make substantial changes to your configuration and you want to try them out before they're pushed to the cloud.</span></span>

<span data-ttu-id="10275-139">Zalecaną metodą tych scenariuszy jest migrację zasięg.</span><span class="sxs-lookup"><span data-stu-id="10275-139">The recommended method for these scenarios is to use a swing migration.</span></span> <span data-ttu-id="10275-140">Należy (co najmniej) dwa serwery — jeden serwer aktywnego i jeden serwer tymczasowej.</span><span class="sxs-lookup"><span data-stu-id="10275-140">You need (at least) two servers--one active server and one staging server.</span></span> <span data-ttu-id="10275-141">Aktywnego serwera (blue linia ciągła na poniższej ilustracji przedstawiono) jest odpowiedzialny za obciążenia active w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="10275-141">The active server (shown with solid blue lines in the following picture) is responsible for the active production load.</span></span> <span data-ttu-id="10275-142">Serwerze (przedstawiono linie przerywane purpurowa) jest przygotowywane za pomocą nowej wersji lub konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="10275-142">The staging server (shown with dashed purple lines) is prepared with the new release or configuration.</span></span> <span data-ttu-id="10275-143">Gdy będzie gotowy pełni, ten serwer jest uaktywniona.</span><span class="sxs-lookup"><span data-stu-id="10275-143">When it's fully ready, this server is made active.</span></span> <span data-ttu-id="10275-144">Poprzednie active serwer, który teraz ma starą wersję lub konfiguracji zainstalowane, staje się na serwerze i jest uaktualniany.</span><span class="sxs-lookup"><span data-stu-id="10275-144">The previous active server, which now has the old version or configuration installed, is made into the staging server and is upgraded.</span></span>

<span data-ttu-id="10275-145">Dwa serwery, możesz użyć innej wersji.</span><span class="sxs-lookup"><span data-stu-id="10275-145">The two servers can use different versions.</span></span> <span data-ttu-id="10275-146">Na przykład aktywnego serwera, który planujesz zlikwidować można użyć usługi Azure AD Sync, a nowy serwer przemieszczania można używać usługi Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="10275-146">For example, the active server that you plan to decommission can use Azure AD Sync, and the new staging server can use Azure AD Connect.</span></span> <span data-ttu-id="10275-147">Jeśli używasz migracji zasięg umożliwiające tworzenie nowej konfiguracji jest dobrym pomysłem jest mają takie same jak wersje na dwóch serwerach.</span><span class="sxs-lookup"><span data-stu-id="10275-147">If you use swing migration to develop a new configuration, it's a good idea to have the same versions on the two servers.</span></span>  
![Serwer przemieszczania](./media/active-directory-aadconnect-upgrade-previous-version/stagingserver1.png)

> [!NOTE]
> <span data-ttu-id="10275-149">Niektórzy klienci wolą trzech lub czterech serwerów dla tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="10275-149">Some customers prefer to have three or four servers for this scenario.</span></span> <span data-ttu-id="10275-150">Po uaktualnieniu serwera przemieszczania nie masz kopii zapasowej serwera dla [odzyskiwania po awarii](active-directory-aadconnectsync-operations.md#disaster-recovery).</span><span class="sxs-lookup"><span data-stu-id="10275-150">When the staging server is upgraded, you don't have a backup server for [disaster recovery](active-directory-aadconnectsync-operations.md#disaster-recovery).</span></span> <span data-ttu-id="10275-151">Przy użyciu trzech lub czterech serwerów można przygotować jednego zestawu serwerów podstawowych/w gotowości w nowej wersji, który zapewnia, że jest zawsze serwerze tymczasowym, który jest gotowy do przejęcia.</span><span class="sxs-lookup"><span data-stu-id="10275-151">With three or four servers, you can prepare one set of primary/standby servers with the new version, which ensures that there is always a staging server that's ready to take over.</span></span>

<span data-ttu-id="10275-152">Te kroki są również działać można przenieść z programu Azure AD Sync lub rozwiązania z FIM + Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="10275-152">These steps also work to move from Azure AD Sync or a solution with FIM + Azure AD Connector.</span></span> <span data-ttu-id="10275-153">Te kroki nie działają narzędzia DirSync, ale tego samego zasięg migracji (nazywanych również wdrożenie równoległe) jest metoda o kroki dla narzędzia DirSync w [uaktualnienia usługi Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="10275-153">These steps don't work for DirSync, but the same swing migration method (also called parallel deployment) with steps for DirSync is in [Upgrade Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span></span>

### <a name="use-a-swing-migration-to-upgrade"></a><span data-ttu-id="10275-154">Użyj opcji migracji do uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="10275-154">Use a swing migration to upgrade</span></span>
1. <span data-ttu-id="10275-155">Jeśli używasz usługi Azure AD Connect na obu serwerach i Zaplanuj tylko wprowadzanie zmian, upewnij się, że konfiguracja aktywnego serwera i serwerze są zarówno przy użyciu tej samej wersji.</span><span class="sxs-lookup"><span data-stu-id="10275-155">If you use Azure AD Connect on both servers and plan to only make a configuration change, make sure that your active server and staging server are both using the same version.</span></span> <span data-ttu-id="10275-156">Który ułatwia to porównać później.</span><span class="sxs-lookup"><span data-stu-id="10275-156">That makes it easier to compare differences later.</span></span> <span data-ttu-id="10275-157">Jeśli uaktualniasz z programu Azure AD Sync, te serwery mają różne wersje.</span><span class="sxs-lookup"><span data-stu-id="10275-157">If you're upgrading from Azure AD Sync, then these servers have different versions.</span></span> <span data-ttu-id="10275-158">Jeśli uaktualniasz ze starszej wersji programu Azure AD Connect, zaleca się uruchomić przy użyciu dwóch serwerów, które korzystają z tej samej wersji, ale nie jest to wymagane.</span><span class="sxs-lookup"><span data-stu-id="10275-158">If you're upgrading from an older version of Azure AD Connect, it's a good idea to start with the two servers that are using the same version, but it's not required.</span></span>
2. <span data-ttu-id="10275-159">Jeśli wprowadzono niestandardowej konfiguracji tymczasowej serwera nie ma go, wykonaj kroki opisane w temacie [Przenieś Konfiguracja niestandardowa z aktywnego serwera na serwerze](#move-custom-configuration-from-active-to-staging-server).</span><span class="sxs-lookup"><span data-stu-id="10275-159">If you've made a custom configuration and your staging server doesn't have it, follow the steps under [Move a custom configuration from the active server to the staging server](#move-custom-configuration-from-active-to-staging-server).</span></span>
3. <span data-ttu-id="10275-160">Jeśli uaktualniasz z wcześniejszych wersji programu Azure AD Connect, należy uaktualnić serwer przemieszczania do najnowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="10275-160">If you're upgrading from an earlier release of Azure AD Connect, upgrade the staging server to the latest version.</span></span> <span data-ttu-id="10275-161">Jeśli przenosisz z narzędzia Azure AD Sync, zainstaluj Azure AD Connect na serwerze tymczasowe.</span><span class="sxs-lookup"><span data-stu-id="10275-161">If you're moving from Azure AD Sync, then install Azure AD Connect on your staging server.</span></span>
4. <span data-ttu-id="10275-162">Let aparatu synchronizacji, uruchom na serwerze tymczasowe pełny import i pełną synchronizację.</span><span class="sxs-lookup"><span data-stu-id="10275-162">Let the sync engine run full import and full synchronization on your staging server.</span></span>
5. <span data-ttu-id="10275-163">Sprawdź, czy nowa konfiguracja nie spowodować nieoczekiwane zmiany przy użyciu kroki opisane w temacie "Zweryfikuj" w [Weryfikowanie konfiguracji serwera](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="10275-163">Verify that the new configuration didn't cause any unexpected changes by using the steps under "Verify" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span> <span data-ttu-id="10275-164">Jeśli coś nie jest zgodnie z oczekiwaniami, napraw go, uruchom importowania i synchronizacji oraz zweryfikować danych, dopóki wygląd, wykonując następujące kroki.</span><span class="sxs-lookup"><span data-stu-id="10275-164">If something isn't as expected, correct it, run the import and sync, and verify the data until it looks good, by following the steps.</span></span>
6. <span data-ttu-id="10275-165">Przełącz przemieszczania serwera active server.</span><span class="sxs-lookup"><span data-stu-id="10275-165">Switch the staging server to be the active server.</span></span> <span data-ttu-id="10275-166">To jest ostatni krok "Przełącznika active server" w [Weryfikowanie konfiguracji serwera](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="10275-166">This is the final step "Switch active server" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span>
7. <span data-ttu-id="10275-167">Jeśli uaktualniasz Azure AD Connect, należy uaktualnić serwer, który jest teraz w trybie przejściowym do najnowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="10275-167">If you're upgrading Azure AD Connect, upgrade the server that's now in staging mode to the latest release.</span></span> <span data-ttu-id="10275-168">Wykonaj te same czynności co przed można pobrać danych i konfiguracji uaktualniony.</span><span class="sxs-lookup"><span data-stu-id="10275-168">Follow the same steps as before to get the data and configuration upgraded.</span></span> <span data-ttu-id="10275-169">Po uaktualnieniu z programu Azure AD Sync, możesz teraz wyłączyć i zlikwidować stary serwer.</span><span class="sxs-lookup"><span data-stu-id="10275-169">If you upgraded from Azure AD Sync, you can now turn off and decommission your old server.</span></span>

### <a name="move-a-custom-configuration-from-the-active-server-to-the-staging-server"></a><span data-ttu-id="10275-170">Przenieś Konfiguracja niestandardowa z aktywnego serwera na serwerze</span><span class="sxs-lookup"><span data-stu-id="10275-170">Move a custom configuration from the active server to the staging server</span></span>
<span data-ttu-id="10275-171">Zostały wprowadzone zmiany konfiguracji do aktywnego serwera, należy upewnić się, że te same zmiany są stosowane na serwerze.</span><span class="sxs-lookup"><span data-stu-id="10275-171">If you've made configuration changes to the active server, you need to make sure that the same changes are applied to the staging server.</span></span> <span data-ttu-id="10275-172">Aby ułatwić to przeniesienie, można użyć [Dokumentatora konfiguracji usługi Azure AD Connect](https://github.com/Microsoft/AADConnectConfigDocumenter).</span><span class="sxs-lookup"><span data-stu-id="10275-172">To help with this move, you can use the [Azure AD Connect configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter).</span></span>

<span data-ttu-id="10275-173">Można przenieść synchronizacji niestandardowych reguł został utworzony przy użyciu programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="10275-173">You can move the custom sync rules that you've created by using PowerShell.</span></span> <span data-ttu-id="10275-174">Należy najpierw zastosować inne zmiany tak samo we wszystkich systemach, i nie można migrować zmiany.</span><span class="sxs-lookup"><span data-stu-id="10275-174">You must apply other changes the same way on both systems, and you can't migrate the changes.</span></span> <span data-ttu-id="10275-175">[Dokumentatora konfiguracji](https://github.com/Microsoft/AADConnectConfigDocumenter) ułatwia porównanie tych dwóch systemów, aby się upewnić, że są one identyczne.</span><span class="sxs-lookup"><span data-stu-id="10275-175">The [configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter) can help you comparing the two systems to make sure they are identical.</span></span> <span data-ttu-id="10275-176">Narzędzie może również pomóc w automatyzacji w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="10275-176">The tool can also help in automating the steps found in this section.</span></span>

<span data-ttu-id="10275-177">Należy skonfigurować w taki sam sposób następujących czynności na obu serwerach:</span><span class="sxs-lookup"><span data-stu-id="10275-177">You need to configure the following things the same way on both servers:</span></span>

* <span data-ttu-id="10275-178">Połączenie do tego samego lasów</span><span class="sxs-lookup"><span data-stu-id="10275-178">Connection to the same forests</span></span>
* <span data-ttu-id="10275-179">Domeny i jednostki Organizacyjnej filtrowania</span><span class="sxs-lookup"><span data-stu-id="10275-179">Any domain and OU filtering</span></span>
* <span data-ttu-id="10275-180">Tej samej funkcji opcjonalnych, takich jak synchronizacja haseł i zapisywania zwrotnego haseł</span><span class="sxs-lookup"><span data-stu-id="10275-180">The same optional features, such as password sync and password writeback</span></span>

<span data-ttu-id="10275-181">**Przenoszenie reguł niestandardowych**</span><span class="sxs-lookup"><span data-stu-id="10275-181">**Move custom synchronization rules**</span></span>  
<span data-ttu-id="10275-182">Aby przenieść reguł niestandardowych, wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="10275-182">To move custom synchronization rules, do the following:</span></span>

1. <span data-ttu-id="10275-183">Otwórz **Edytor reguł synchronizacji** aktywnego serwera.</span><span class="sxs-lookup"><span data-stu-id="10275-183">Open **Synchronization Rules Editor** on your active server.</span></span>
2. <span data-ttu-id="10275-184">Wybierz regułę niestandardową.</span><span class="sxs-lookup"><span data-stu-id="10275-184">Select a custom rule.</span></span> <span data-ttu-id="10275-185">Kliknij przycisk **wyeksportować**.</span><span class="sxs-lookup"><span data-stu-id="10275-185">Click **Export**.</span></span> <span data-ttu-id="10275-186">Spowoduje to wyświetlenie okna Notatnika.</span><span class="sxs-lookup"><span data-stu-id="10275-186">This brings up a Notepad window.</span></span> <span data-ttu-id="10275-187">Zapisz plik tymczasowy z rozszerzeniem nazwy PS1.</span><span class="sxs-lookup"><span data-stu-id="10275-187">Save the temporary file with a PS1 extension.</span></span> <span data-ttu-id="10275-188">Dzięki temu skrypt programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="10275-188">This makes it a PowerShell script.</span></span> <span data-ttu-id="10275-189">Skopiuj plik PS1 na serwerze.</span><span class="sxs-lookup"><span data-stu-id="10275-189">Copy the PS1 file to the staging server.</span></span>  
   <span data-ttu-id="10275-190">![Wyeksportowanie reguły synchronizacji](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span><span class="sxs-lookup"><span data-stu-id="10275-190">![Sync rule export](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span></span>
3. <span data-ttu-id="10275-191">GUID łącznika różni się na serwerze i należy ją zmienić.</span><span class="sxs-lookup"><span data-stu-id="10275-191">The Connector GUID is different on the staging server, and you must change it.</span></span> <span data-ttu-id="10275-192">Aby uzyskać identyfikator GUID, uruchom **Edytor reguł synchronizacji**, wybierz jedną z reguł out-of-box, które reprezentują ten sam system połączony, a następnie kliknij przycisk **wyeksportować**.</span><span class="sxs-lookup"><span data-stu-id="10275-192">To get the GUID, start **Synchronization Rules Editor**, select one of the out-of-box rules that represent the same connected system, and click **Export**.</span></span> <span data-ttu-id="10275-193">Identyfikator GUID w pliku PS1 Zamień na identyfikator GUID z serwera przemieszczenia.</span><span class="sxs-lookup"><span data-stu-id="10275-193">Replace the GUID in your PS1 file with the GUID from the staging server.</span></span>
4. <span data-ttu-id="10275-194">W wierszu programu PowerShell Uruchom plik PS1.</span><span class="sxs-lookup"><span data-stu-id="10275-194">In a PowerShell prompt, run the PS1 file.</span></span> <span data-ttu-id="10275-195">Spowoduje to utworzenie reguły niestandardowe synchronizacji na serwerze.</span><span class="sxs-lookup"><span data-stu-id="10275-195">This creates the custom synchronization rule on the staging server.</span></span>
5. <span data-ttu-id="10275-196">Powtórz tę czynność dla wszystkich reguł niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="10275-196">Repeat this for all your custom rules.</span></span>

## <a name="how-to-defer-full-synchronization-after-upgrade"></a><span data-ttu-id="10275-197">Jak mają być odroczone pełną synchronizację po uaktualnieniu</span><span class="sxs-lookup"><span data-stu-id="10275-197">How to defer full synchronization after upgrade</span></span>
<span data-ttu-id="10275-198">Podczas uaktualniania w miejscu, mogą występować zmian wprowadzonych, które wymagają działań określonych synchronizacji (w tym kroki pełny Import i pełną synchronizację) do wykonania.</span><span class="sxs-lookup"><span data-stu-id="10275-198">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed.</span></span> <span data-ttu-id="10275-199">Na przykład, wymagają zmian schematu łącznika **pełny import** wymagają zmian reguły synchronizacji krok i out-of-box **pełnej synchronizacji** krok ma być wykonywana na zainfekowanym łączników.</span><span class="sxs-lookup"><span data-stu-id="10275-199">For example, connector schema changes require **full import** step and out-of-box synchronization rule changes require **full synchronization** step to be executed on affected connectors.</span></span> <span data-ttu-id="10275-200">Podczas uaktualniania, Azure AD Connect Określa, jakie działania synchronizacji są wymagane i zapisuje je jako *zastępuje*.</span><span class="sxs-lookup"><span data-stu-id="10275-200">During upgrade, Azure AD Connect determines what synchronization activities are required and records them as *overrides*.</span></span> <span data-ttu-id="10275-201">W poniższych cyklu synchronizacji harmonogram synchronizacji przejmuje te zastąpienia i je wykonuje.</span><span class="sxs-lookup"><span data-stu-id="10275-201">In the following synchronization cycle, the synchronization scheduler picks up these overrides and executes them.</span></span> <span data-ttu-id="10275-202">Gdy przesłonięcie jest prawidłowo wykonane, zostanie ono usunięte.</span><span class="sxs-lookup"><span data-stu-id="10275-202">Once an override is successfully executed, it is removed.</span></span>

<span data-ttu-id="10275-203">Mogą wystąpić sytuacje, w których nie chcesz te zastąpienia została wykonana, natychmiast po uaktualnieniu.</span><span class="sxs-lookup"><span data-stu-id="10275-203">There may be situations where you do not want these overrides to take place immediately after upgrade.</span></span> <span data-ttu-id="10275-204">Na przykład masz wiele obiektów synchronizowanych i ma następujące kroki synchronizacji występuje po godzinach.</span><span class="sxs-lookup"><span data-stu-id="10275-204">For example, you have numerous synchronized objects and you would like these synchronization steps to occur after business hours.</span></span> <span data-ttu-id="10275-205">Aby usunąć te zastąpienia:</span><span class="sxs-lookup"><span data-stu-id="10275-205">To remove these overrides:</span></span>

1. <span data-ttu-id="10275-206">Podczas uaktualniania **Usuń zaznaczenie pola wyboru** opcję **Uruchom proces synchronizacji, po zakończeniu konfiguracji**.</span><span class="sxs-lookup"><span data-stu-id="10275-206">During upgrade, **uncheck** the option **Start the synchronization process when configuration completes**.</span></span> <span data-ttu-id="10275-207">To powoduje wyłączenie harmonogramu synchronizacji i zapobiega cykl synchronizacji miejsce automatycznie usunięcia zastąpień.</span><span class="sxs-lookup"><span data-stu-id="10275-207">This disables the synchronization scheduler and prevents synchronization cycle from taking place automatically before the overrides are removed.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync01.png)

2. <span data-ttu-id="10275-209">Po zakończeniu uaktualniania, uruchom następujące polecenie cmdlet, aby dowiedzieć się, jakie zastąpienia zostały dodane:`Get-ADSyncSchedulerConnectorOverride | fl`</span><span class="sxs-lookup"><span data-stu-id="10275-209">After upgrade completes, run the following cmdlet to find out what overrides have been added: `Get-ADSyncSchedulerConnectorOverride | fl`</span></span>

   >[!NOTE]
   > <span data-ttu-id="10275-210">Zastąpienia są specyficzne dla łącznika.</span><span class="sxs-lookup"><span data-stu-id="10275-210">The overrides are connector-specific.</span></span> <span data-ttu-id="10275-211">W poniższym przykładzie krok pełny Import i pełną synchronizację zostały dodane do obu lokalną AD Connector i łącznika usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="10275-211">In the following example, Full Import step and Full Synchronization step have been added to both the on-premises AD Connector and Azure AD Connector.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync02.png)

3. <span data-ttu-id="10275-213">Należy zanotować istniejących zastąpień, które zostały dodane.</span><span class="sxs-lookup"><span data-stu-id="10275-213">Note down the existing overrides that have been added.</span></span>
   
4. <span data-ttu-id="10275-214">Aby usunąć zastąpień dla pełny import i pełną synchronizację łącznika dowolnego, uruchom następujące polecenie cmdlet:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span><span class="sxs-lookup"><span data-stu-id="10275-214">To remove the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span></span>

   <span data-ttu-id="10275-215">Aby usunąć zastąpień dla wszystkich łączników, uruchom następujący skrypt programu PowerShell:</span><span class="sxs-lookup"><span data-stu-id="10275-215">To remove the overrides on all connectors, execute the following PowerShell script:</span></span>

   ```
   foreach ($connectorOverride in Get-ADSyncSchedulerConnectorOverride)
   {
       Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier $connectorOverride.ConnectorIdentifier.Guid -FullSyncRequired $false -FullImportRequired $false
   }
   ```

5. <span data-ttu-id="10275-216">Aby wznowić harmonogram, uruchom następujące polecenie cmdlet:`Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="10275-216">To resume the scheduler, run the following cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>

   >[!IMPORTANT]
   > <span data-ttu-id="10275-217">Pamiętaj, aby wykonać kroki wymagane synchronizacji najwcześniejszą wygodne.</span><span class="sxs-lookup"><span data-stu-id="10275-217">Remember to execute the required synchronization steps at your earliest convenience.</span></span> <span data-ttu-id="10275-218">Możesz ręcznie wykonać te czynności przy użyciu Menedżera usługi synchronizacji lub dodać zastąpienia powrotem przy użyciu polecenia cmdlet Set-ADSyncSchedulerConnectorOverride.</span><span class="sxs-lookup"><span data-stu-id="10275-218">You can either manually execute these steps using the Synchronization Service Manager or add the overrides back using the Set-ADSyncSchedulerConnectorOverride cmdlet.</span></span>

<span data-ttu-id="10275-219">Aby dodać zastąpień dla pełny import i pełną synchronizację łącznika dowolnego, uruchom następujące polecenie cmdlet:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span><span class="sxs-lookup"><span data-stu-id="10275-219">To add the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet:  `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span></span>

## <a name="next-steps"></a><span data-ttu-id="10275-220">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="10275-220">Next steps</span></span>
<span data-ttu-id="10275-221">Dowiedz się więcej o [integrowanie tożsamości lokalnych z usługą Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="10275-221">Learn more about [integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
