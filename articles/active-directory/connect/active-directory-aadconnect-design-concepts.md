---
title: "Azure AD Connect: Zagadnienia dotyczące projektowania | Dokumentacja firmy Microsoft"
description: "W tym temacie szczegółowo niektórych obszarach projektowania implementacji"
services: active-directory
documentationcenter: 
author: billmath
manager: femila
editor: 
ms.assetid: 4114a6c0-f96a-493c-be74-1153666ce6c9
ms.service: active-directory
ms.custom: azure-ad-connect
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: f23443d438c95a784f655fb9a5f20dfcf37be189
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-design-concepts"></a><span data-ttu-id="3dd7c-103">Azure AD Connect: Zagadnienia dotyczące projektowania</span><span class="sxs-lookup"><span data-stu-id="3dd7c-103">Azure AD Connect: Design concepts</span></span>
<span data-ttu-id="3dd7c-104">Celem tego tematu jest do opisywania obszarów, które muszą być uważane za pośrednictwem podczas projektu implementacji programu Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-104">The purpose of this topic is to describe areas that must be thought through during the implementation design of Azure AD Connect.</span></span> <span data-ttu-id="3dd7c-105">Ten temat jest nowości w niektórych obszarach i tych pojęć krótko opisano w innych tematach również.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-105">This topic is a deep dive on certain areas and these concepts are briefly described in other topics as well.</span></span>

## <a name="sourceanchor"></a><span data-ttu-id="3dd7c-106">sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="3dd7c-106">sourceAnchor</span></span>
<span data-ttu-id="3dd7c-107">Atrybut sourceAnchor jest zdefiniowany jako *atrybutu niezmienialny w okresie istnienia obiektu*.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-107">The sourceAnchor attribute is defined as *an attribute immutable during the lifetime of an object*.</span></span> <span data-ttu-id="3dd7c-108">Identyfikuje obiekt jako tego samego obiektu lokalnej i w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-108">It uniquely identifies an object as being the same object on-premises and in Azure AD.</span></span> <span data-ttu-id="3dd7c-109">Ten atrybut jest również nazywany **nazwę immutableId** i obie nazwy są używane wymienne.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-109">The attribute is also called **immutableId** and the two names are used interchangeable.</span></span>

<span data-ttu-id="3dd7c-110">Niezmienne, word, który jest "nie można zmienić", ważne jest, aby w tym temacie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-110">The word immutable, that is "cannot be changed", is important to this topic.</span></span> <span data-ttu-id="3dd7c-111">Ponieważ wartość tego atrybutu nie można zmienić po ustawieniu, należy wybrać projekt, który obsługuje danego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-111">Since this attribute’s value cannot be changed after it has been set, it is important to pick a design that supports your scenario.</span></span>

<span data-ttu-id="3dd7c-112">Ten atrybut jest używany w następujących scenariuszach:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-112">The attribute is used for the following scenarios:</span></span>

* <span data-ttu-id="3dd7c-113">Gdy nowy serwer aparatu synchronizacji jest skompilowany lub ponownie skompilowany od scenariusza odzyskiwania po awarii, ten atrybut łączy istniejące obiekty w usłudze Azure AD z obiektami lokalnymi.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-113">When a new sync engine server is built, or rebuilt after a disaster recovery scenario, this attribute links existing objects in Azure AD with objects on-premises.</span></span>
* <span data-ttu-id="3dd7c-114">Po przełączeniu z tożsamością tylko na chmurze do modelu synchronizowanych tożsamości następnie ten atrybut umożliwia obiektów w istniejących obiektach "twardych match" w usłudze Azure AD z lokalnymi obiektami.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-114">If you move from a cloud-only identity to a synchronized identity model, then this attribute allows objects to "hard match" existing objects in Azure AD with on-premises objects.</span></span>
* <span data-ttu-id="3dd7c-115">Jeśli używasz federacyjnego, a następnie ten atrybut razem z **userPrincipalName** jest używany w oświadczeń do unikatowego identyfikowania użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-115">If you use federation, then this attribute together with the **userPrincipalName** is used in the claim to uniquely identify a user.</span></span>

<span data-ttu-id="3dd7c-116">W tym temacie wspomniana sourceAnchor tylko w odniesieniu do użytkowników.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-116">This topic only talks about sourceAnchor as it relates to users.</span></span> <span data-ttu-id="3dd7c-117">Te same zasady dotyczą wszystkich typów obiektów, ale tego problemu jest zwykle problemem jest tylko dla użytkowników.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-117">The same rules apply to all object types, but it is only for users this problem usually is a concern.</span></span>

### <a name="selecting-a-good-sourceanchor-attribute"></a><span data-ttu-id="3dd7c-118">Wybranie atrybutu sourceAnchor dobra</span><span class="sxs-lookup"><span data-stu-id="3dd7c-118">Selecting a good sourceAnchor attribute</span></span>
<span data-ttu-id="3dd7c-119">Wartość atrybutu, należy wykonać następujące reguły:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-119">The attribute value must follow the following rules:</span></span>

* <span data-ttu-id="3dd7c-120">Zawierać mniej niż 60 znaków</span><span class="sxs-lookup"><span data-stu-id="3dd7c-120">Be less than 60 characters in length</span></span>
  * <span data-ttu-id="3dd7c-121">Kodowania i liczone jak znaki 3 znaki nie są a-z, A-Z i 0-9</span><span class="sxs-lookup"><span data-stu-id="3dd7c-121">Characters not being a-z, A-Z, or 0-9 are encoded and counted as 3 characters</span></span>
* <span data-ttu-id="3dd7c-122">Zawiera znaki specjalne: &#92;!</span><span class="sxs-lookup"><span data-stu-id="3dd7c-122">Not contain a special character: &#92; !</span></span> <span data-ttu-id="3dd7c-123"># $ % & * + / = ?</span><span class="sxs-lookup"><span data-stu-id="3dd7c-123"># $ % & * + / = ?</span></span> <span data-ttu-id="3dd7c-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span><span class="sxs-lookup"><span data-stu-id="3dd7c-124">^ &#96; { } | ~ < > ( ) ' ; : , [ ] " @ _</span></span>
* <span data-ttu-id="3dd7c-125">Musi być globalnie unikatowa</span><span class="sxs-lookup"><span data-stu-id="3dd7c-125">Must be globally unique</span></span>
* <span data-ttu-id="3dd7c-126">Musi być ciągiem, liczbą całkowitą lub danych binarnych</span><span class="sxs-lookup"><span data-stu-id="3dd7c-126">Must be either a string, integer, or binary</span></span>
* <span data-ttu-id="3dd7c-127">Nie powinna być oparta na nazwę użytkownika, te zmiany</span><span class="sxs-lookup"><span data-stu-id="3dd7c-127">Should not be based on user's name, these changes</span></span>
* <span data-ttu-id="3dd7c-128">Nie powinny być uwzględniana wielkość liter i uniknąć wartości, które mogą różnić się wielkością liter</span><span class="sxs-lookup"><span data-stu-id="3dd7c-128">Should not be case-sensitive and avoid values that may vary by case</span></span>
* <span data-ttu-id="3dd7c-129">Powinien być przypisany podczas tworzenia obiektu</span><span class="sxs-lookup"><span data-stu-id="3dd7c-129">Should be assigned when the object is created</span></span>

<span data-ttu-id="3dd7c-130">Jeśli wybrane sourceAnchor nie jest typu String, następnie Azure AD Connect Base64Encode wartość atrybutu, aby upewnić się, znaki specjalne są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-130">If the selected sourceAnchor is not of type string, then Azure AD Connect Base64Encode the attribute value to ensure no special characters appear.</span></span> <span data-ttu-id="3dd7c-131">Użycie innego serwera federacyjnego niż usługi AD FS, upewnij się, serwer może również Base64Encode atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-131">If you use another federation server than ADFS, make sure your server can also Base64Encode the attribute.</span></span>

<span data-ttu-id="3dd7c-132">Atrybut sourceAnchor jest rozróżniana wielkość liter.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-132">The sourceAnchor attribute is case-sensitive.</span></span> <span data-ttu-id="3dd7c-133">Wartość "JanNowak" nie jest taka sama jak "JanNowak".</span><span class="sxs-lookup"><span data-stu-id="3dd7c-133">A value of “JohnDoe” is not the same as “johndoe”.</span></span> <span data-ttu-id="3dd7c-134">Ale nie powinien mieć dwa różne obiekty z różnicą tylko wielkością liter.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-134">But you should not have two different objects with only a difference in case.</span></span>

<span data-ttu-id="3dd7c-135">Jeśli masz jednego lasu w infrastrukturze lokalnej, następnie należy użyć atrybutu jest **objectGUID**.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-135">If you have a single forest on-premises, then the attribute you should use is **objectGUID**.</span></span> <span data-ttu-id="3dd7c-136">Dotyczy to również atrybut używane w przypadku użycia ustawień ekspresowych w programie Azure AD Connect, a także atrybutu używane przez narzędzie DirSync.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-136">This is also the attribute used when you use express settings in Azure AD Connect and also the attribute used by DirSync.</span></span>

<span data-ttu-id="3dd7c-137">Jeśli masz wiele lasów i nie przenoś użytkowników między lasami i domenami, następnie **objectGUID** jest właściwego atrybutu nawet w tym przypadku.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-137">If you have multiple forests and do not move users between forests and domains, then **objectGUID** is a good attribute to use even in this case.</span></span>

<span data-ttu-id="3dd7c-138">Jeśli użytkownicy są przenoszone między lasami i domenami, następnie należy znaleźć atrybut, który nie ulega zmianie lub mogą zostać przeniesione z użytkownikami podczas przenoszenia.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-138">If you move users between forests and domains, then you must find an attribute that does not change or can be moved with the users during the move.</span></span> <span data-ttu-id="3dd7c-139">Zalecanym podejściem jest wprowadzenie syntetycznych atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-139">A recommended approach is to introduce a synthetic attribute.</span></span> <span data-ttu-id="3dd7c-140">Atrybut, który można umieścić element, który wygląda na to odpowiednia może być identyfikatorem GUID.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-140">An attribute that could hold something that looks like a GUID would be suitable.</span></span> <span data-ttu-id="3dd7c-141">Podczas tworzenia obiektu nowego identyfikatora GUID jest tworzony i dołączana do użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-141">During object creation, a new GUID is created and stamped on the user.</span></span> <span data-ttu-id="3dd7c-142">Reguły niestandardowe synchronizacji można utworzyć na serwerze aparatu synchronizacji, aby utworzyć tę wartość na podstawie **objectGUID** i zaktualizuj w DODAJE wybranego atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-142">A custom sync rule can be created in the sync engine server to create this value based on the **objectGUID** and update the selected attribute in ADDS.</span></span> <span data-ttu-id="3dd7c-143">Podczas przenoszenia obiektu, upewnij się, że również skopiuj zawartość tej wartości.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-143">When you move the object, make sure to also copy the content of this value.</span></span>

<span data-ttu-id="3dd7c-144">Innym rozwiązaniem jest wybierz istniejący atrybut, których znasz nie ulega zmianie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-144">Another solution is to pick an existing attribute you know does not change.</span></span> <span data-ttu-id="3dd7c-145">Często używane atrybuty obejmują **identyfikator pracownika**.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-145">Commonly used attributes include **employeeID**.</span></span> <span data-ttu-id="3dd7c-146">Należy wziąć pod uwagę atrybut, który zawiera litery, aby upewnić się, że można zmienić bez możliwości przypadku (wielkie i małe litery), wartość atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-146">If you consider an attribute that contains letters, make sure there is no chance the case (upper case vs. lower case) can change for the attribute's value.</span></span> <span data-ttu-id="3dd7c-147">Złe atrybuty, które nie powinny być używane obejmują tych atrybutów o tej nazwie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-147">Bad attributes that should not be used include those attributes with the name of the user.</span></span> <span data-ttu-id="3dd7c-148">Unieważnienie lub rozwodu Oczekiwano nazwy do zmiany, co nie jest dozwolone dla tego atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-148">In a marriage or divorce, the name is expected to change, which is not allowed for this attribute.</span></span> <span data-ttu-id="3dd7c-149">Dotyczy to również jedną z przyczyn Dlaczego atrybutów, takich jak **userPrincipalName**, **poczty**, i **targetAddress** nie są jeszcze można wybrać w Kreatorze instalacji Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-149">This is also one reason why attributes such as **userPrincipalName**, **mail**, and **targetAddress** are not even possible to select in the Azure AD Connect installation wizard.</span></span> <span data-ttu-id="3dd7c-150">Te atrybuty również zawierać "@" znak, który jest niedozwolony w sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-150">Those attributes also contain the "@" character, which is not allowed in the sourceAnchor.</span></span>

### <a name="changing-the-sourceanchor-attribute"></a><span data-ttu-id="3dd7c-151">Zmiana atrybutu sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="3dd7c-151">Changing the sourceAnchor attribute</span></span>
<span data-ttu-id="3dd7c-152">Wartość atrybutu sourceAnchor nie można zmienić po utworzeniu obiektu w usłudze Azure AD i tożsamość jest zsynchronizowana.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-152">The sourceAnchor attribute value cannot be changed after the object has been created in Azure AD and the identity is synchronized.</span></span>

<span data-ttu-id="3dd7c-153">Z tego powodu następujące ograniczenia są stosowane do programu Azure AD Connect:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-153">For this reason, the following restrictions apply to Azure AD Connect:</span></span>

* <span data-ttu-id="3dd7c-154">Atrybut sourceAnchor można ustawić tylko podczas instalacji początkowej.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-154">The sourceAnchor attribute can only be set during initial installation.</span></span> <span data-ttu-id="3dd7c-155">Jeśli uruchomisz Kreatora instalacji, ta opcja jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-155">If you rerun the installation wizard, this option is read-only.</span></span> <span data-ttu-id="3dd7c-156">Jeśli potrzebujesz zmienić to ustawienie, należy odinstalować i zainstalować ponownie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-156">If you need to change this setting, then you must uninstall and reinstall.</span></span>
* <span data-ttu-id="3dd7c-157">Zainstalowanie innego serwera Azure AD Connect, a następnie należy wybrać jako korzystał już z tego samego atrybutu sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-157">If you install another Azure AD Connect server, then you must select the same sourceAnchor attribute as previously used.</span></span> <span data-ttu-id="3dd7c-158">Jeśli wcześniej została przy użyciu narzędzia DirSync i przenieść do programu Azure AD Connect, a następnie należy użyć **objectGUID** ponieważ jest używane przez narzędzie DirSync atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-158">If you have earlier been using DirSync and move to Azure AD Connect, then you must use **objectGUID** since that is the attribute used by DirSync.</span></span>
* <span data-ttu-id="3dd7c-159">Jeśli wartość dla elementu sourceAnchor zostało zmienione po obiektu zostały wyeksportowane do usługi Azure AD, a następnie Azure AD Connect synchronizacji wygeneruje błąd i nie zezwala na zmiany w obiekt przed problem został rozwiązany i sourceAnchor zostanie zmieniona w katalogu źródłowym.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-159">If the value for sourceAnchor is changed after the object has been exported to Azure AD, then Azure AD Connect sync throws an error and does not allow any more changes on that object before the issue has been fixed and the sourceAnchor is changed back in the source directory.</span></span>

## <a name="using-msds-consistencyguid-as-sourceanchor"></a><span data-ttu-id="3dd7c-160">Przy użyciu msDS-ConsistencyGuid jako sourceAnchor</span><span class="sxs-lookup"><span data-stu-id="3dd7c-160">Using msDS-ConsistencyGuid as sourceAnchor</span></span>
<span data-ttu-id="3dd7c-161">Domyślnie program Azure AD Connect (wersja 1.1.486.0 i starszych) używa objectGUID jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-161">By default, Azure AD Connect (version 1.1.486.0 and older) uses objectGUID as the sourceAnchor attribute.</span></span> <span data-ttu-id="3dd7c-162">Atrybut ObjectGUID jest generowanych przez system.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-162">ObjectGUID is system-generated.</span></span> <span data-ttu-id="3dd7c-163">Nie można określić jego wartości podczas tworzenia lokalnych obiektów usługi AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-163">You cannot specify its value when creating on-premises AD objects.</span></span> <span data-ttu-id="3dd7c-164">Jak opisano w sekcji [sourceAnchor](#sourceanchor), istnieją scenariusze, w którym należy określić wartość sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-164">As explained in section [sourceAnchor](#sourceanchor), there are scenarios where you need to specify the sourceAnchor value.</span></span> <span data-ttu-id="3dd7c-165">Jeśli scenariusze są stosowane do użytkownika, należy użyć można skonfigurować atrybut AD (na przykład msDS-ConsistencyGuid) jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-165">If the scenarios are applicable to you, you must use a configurable AD attribute (for example, msDS-ConsistencyGuid) as the sourceAnchor attribute.</span></span>

<span data-ttu-id="3dd7c-166">Azure AD Connect (wersja 1.1.524.0 oraz po) ułatwia teraz użycie msDS-ConsistencyGuid jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-166">Azure AD Connect (version 1.1.524.0 and after) now facilitates the use of msDS-ConsistencyGuid as sourceAnchor attribute.</span></span> <span data-ttu-id="3dd7c-167">Podczas korzystania z tej funkcji Azure AD Connect automatycznie konfiguruje reguły synchronizacji do:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-167">When using this feature, Azure AD Connect automatically configures the synchronization rules to:</span></span>

1. <span data-ttu-id="3dd7c-168">Użyj msDS-ConsistencyGuid jako atrybut sourceAnchor obiektów użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-168">Use msDS-ConsistencyGuid as the sourceAnchor attribute for User objects.</span></span> <span data-ttu-id="3dd7c-169">Atrybut ObjectGUID jest używana do innych obiektów.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-169">ObjectGUID is used for other object types.</span></span>

2. <span data-ttu-id="3dd7c-170">Dla żadnej podanej lokalnych użytkowników usługi AD obiektu, którego atrybut msDS-ConsistencyGuid nie jest wypełniony, Azure zapisy AD Connect, jego wartość objectGUID z powrotem do atrybutu msDS-ConsistencyGuid w lokalnej usłudze Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-170">For any given on-premises AD User object whose msDS-ConsistencyGuid attribute isn't populated, Azure AD Connect writes its objectGUID value back to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span> <span data-ttu-id="3dd7c-171">Po atrybutu msDS-ConsistencyGuid zostanie wypełnione, Azure AD Connect następnie eksportuje obiektu do usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-171">After the msDS-ConsistencyGuid attribute is populated, Azure AD Connect then exports the object to Azure AD.</span></span>

>[!NOTE]
> <span data-ttu-id="3dd7c-172">Raz lokalnego obiektu usługi Active Directory jest importowany do usługi Azure AD Connect (który jest zaimportowany do przestrzeni łącznika usługi AD i w magazynie Metaverse), nie można już zmienić jej wartość sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-172">Once an on-premises AD object is imported into Azure AD Connect (that is, imported into the AD Connector Space and projected into the Metaverse), you cannot change its sourceAnchor value anymore.</span></span> <span data-ttu-id="3dd7c-173">Aby określić wartość sourceAnchor podane lokalnymi AD obiektów, skonfiguruj jego atrybut msDS-ConsistencyGuid przed ich zaimportowaniem do usługi Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-173">To specify the sourceAnchor value for a given on-premises AD object, configure its msDS-ConsistencyGuid attribute before it is imported into Azure AD Connect.</span></span>

### <a name="permission-required"></a><span data-ttu-id="3dd7c-174">Wymagane uprawnienia</span><span class="sxs-lookup"><span data-stu-id="3dd7c-174">Permission required</span></span>
<span data-ttu-id="3dd7c-175">Ta funkcja działała konto usług AD DS, używane do synchronizowania z lokalną usługą Active Directory musi mieć przyznane uprawnienia zapisu do atrybutu msDS-ConsistencyGuid w lokalnej usłudze Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-175">For this feature to work, the AD DS account used to synchronize with on-premises Active Directory must be granted write permission to the msDS-ConsistencyGuid attribute in on-premises Active Directory.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature---new-installation"></a><span data-ttu-id="3dd7c-176">Jak włączyć funkcję ConsistencyGuid — nowa instalacja</span><span class="sxs-lookup"><span data-stu-id="3dd7c-176">How to enable the ConsistencyGuid feature - New installation</span></span>
<span data-ttu-id="3dd7c-177">Użycie ConsistencyGuid jako sourceAnchor można włączyć podczas instalacji nowego.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-177">You can enable the use of ConsistencyGuid as sourceAnchor during new installation.</span></span> <span data-ttu-id="3dd7c-178">W tej sekcji omówiono zarówno Express, jak i niestandardowe instalacji w szczegółach.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-178">This section covers both Express and Custom installation in details.</span></span>

  >[!NOTE]
  > <span data-ttu-id="3dd7c-179">Tylko nowsze wersje programu Azure AD Connect (1.1.524.0 oraz po) obsługuje korzystanie z ConsistencyGuid jako sourceAnchor podczas instalacji nowego.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-179">Only newer versions of Azure AD Connect (1.1.524.0 and after) supports the use of ConsistencyGuid as sourceAnchor during new installation.</span></span>

### <a name="how-to-enable-the-consistencyguid-feature"></a><span data-ttu-id="3dd7c-180">Jak włączyć funkcję ConsistencyGuid</span><span class="sxs-lookup"><span data-stu-id="3dd7c-180">How to enable the ConsistencyGuid feature</span></span>
<span data-ttu-id="3dd7c-181">Obecnie funkcję można włączyć tylko podczas nowej instalacji usługi Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-181">Currently, the feature can only be enabled during new Azure AD Connect installation only.</span></span>

#### <a name="express-installation"></a><span data-ttu-id="3dd7c-182">Instalacja ekspresowa</span><span class="sxs-lookup"><span data-stu-id="3dd7c-182">Express Installation</span></span>
<span data-ttu-id="3dd7c-183">Podczas instalacji programu Azure AD Connect z trybem Express, Kreator Azure AD Connect automatycznie określa najbardziej odpowiedni atrybut AD ma być używana jako atrybut sourceAnchor przy użyciu z następującą logiką:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-183">When installing Azure AD Connect with Express mode, the Azure AD Connect wizard automatically determines the most appropriate AD attribute to use as the sourceAnchor attribute using the following logic:</span></span>

* <span data-ttu-id="3dd7c-184">Po pierwsze Kreator Azure AD Connect wysyła zapytanie do dzierżawy usługi Azure AD można pobrać atrybutu AD używane jako atrybut sourceAnchor w poprzedniej instalacji usługi Azure AD Connect (jeśli istnieje).</span><span class="sxs-lookup"><span data-stu-id="3dd7c-184">First, the Azure AD Connect wizard queries your Azure AD tenant to retrieve the AD attribute used as the sourceAnchor attribute in the previous Azure AD Connect installation (if any).</span></span> <span data-ttu-id="3dd7c-185">Jeśli te informacje są dostępne, Azure AD Connect używa tego samego atrybutu AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-185">If this information is available, Azure AD Connect uses the same AD attribute.</span></span>

  >[!NOTE]
  > <span data-ttu-id="3dd7c-186">Tylko nowsze wersje programu Azure AD Connect (1.1.524.0 oraz po) magazynów informacje w dzierżawie usługi Azure AD ten atrybut sourceAnchor jest używany podczas instalacji.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-186">Only newer versions of Azure AD Connect (1.1.524.0 and after) stores information in your Azure AD tenant about the sourceAnchor attribute used during installation.</span></span> <span data-ttu-id="3dd7c-187">Starsze wersje programu Azure AD Connect, czy nie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-187">Older versions of Azure AD Connect do not.</span></span>

* <span data-ttu-id="3dd7c-188">Jeśli informacje o atrybut sourceAnchor jest niedostępna, Kreator sprawdza, czy stan atrybutu msDS-ConsistencyGuid w lokalnej usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-188">If information about the sourceAnchor attribute used isn't available, the wizard checks the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="3dd7c-189">Jeśli ten atrybut nie jest skonfigurowana dla dowolnego obiektu w katalogu, kreator użyje msDS-ConsistencyGuid jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-189">If the attribute isn't configured on any object in the directory, the wizard uses the msDS-ConsistencyGuid as the sourceAnchor attribute.</span></span> <span data-ttu-id="3dd7c-190">Jeśli ten atrybut został skonfigurowany w co najmniej jednego obiektu w katalogu, Kreator zawiera atrybut jest używany przez inne aplikacje i nie nadaje się jako atrybut sourceAnchor...</span><span class="sxs-lookup"><span data-stu-id="3dd7c-190">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and is not suitable as sourceAnchor attribute...</span></span>

* <span data-ttu-id="3dd7c-191">W takim przypadku Kreator powraca do korzystania objectGUID jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-191">In which case, the wizard falls back to using objectGUID as the sourceAnchor attribute.</span></span>

* <span data-ttu-id="3dd7c-192">Gdy atrybut sourceAnchor jest decyzję, kreator zapisuje informacje w dzierżawie usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-192">Once the sourceAnchor attribute is decided, the wizard stores the information in your Azure AD tenant.</span></span> <span data-ttu-id="3dd7c-193">Informacje będą używane w przyszłości instalacji programu Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-193">The information will be used by future installation of Azure AD Connect.</span></span>

<span data-ttu-id="3dd7c-194">Po zakończeniu instalacji ekspresowej, Kreator informuje, atrybut, którego została pobrana jako atrybut zakotwiczenia źródła.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-194">Once Express installation completes, the wizard informs you which attribute has been picked as the Source Anchor attribute.</span></span>

![Kreator informuje pobrane dla elementu sourceAnchor atrybutów AD](./media/active-directory-aadconnect-design-concepts/consistencyGuid-01.png)

#### <a name="custom-installation"></a><span data-ttu-id="3dd7c-196">Instalacja niestandardowa</span><span class="sxs-lookup"><span data-stu-id="3dd7c-196">Custom installation</span></span>
<span data-ttu-id="3dd7c-197">Podczas instalacji programu Azure AD Connect z trybem niestandardowe, podczas konfigurowania atrybutu sourceAnchor Kreatora programu Azure AD Connect będzie oferuje dwie opcje:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-197">When installing Azure AD Connect with Custom mode, the Azure AD Connect wizard provides two options when configuring sourceAnchor attribute:</span></span>

![Instalacja niestandardowa - sourceAnchor konfiguracji](./media/active-directory-aadconnect-design-concepts/consistencyGuid-02.png)

| <span data-ttu-id="3dd7c-199">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="3dd7c-199">Setting</span></span> | <span data-ttu-id="3dd7c-200">Opis</span><span class="sxs-lookup"><span data-stu-id="3dd7c-200">Description</span></span> |
| --- | --- |
| <span data-ttu-id="3dd7c-201">Pozwól, aby platforma Azure zarządzała zakotwiczeniem źródła</span><span class="sxs-lookup"><span data-stu-id="3dd7c-201">Let Azure manage the source anchor for me</span></span> | <span data-ttu-id="3dd7c-202">Wybierz tę opcję, jeśli chcesz, aby usługa Azure AD wybierała ten atrybut za Ciebie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-202">Select this option if you want Azure AD to pick the attribute for you.</span></span> <span data-ttu-id="3dd7c-203">Jeśli wybierzesz tę opcję, Kreator Azure AD Connect stosuje takie same [logiki wybór atrybutu sourceAnchor używane podczas instalacji ekspresowej](#express-installation).</span><span class="sxs-lookup"><span data-stu-id="3dd7c-203">If you select this option, Azure AD Connect wizard applies the same [sourceAnchor attribute selection logic used during Express installation](#express-installation).</span></span> <span data-ttu-id="3dd7c-204">Podobnie jak Instalacja ekspresowa, Kreator informuje o atrybut, którego została pobrana jako atrybut zakotwiczenia źródła po zakończeniu instalacji niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-204">Similar to Express installation, the wizard informs you which attribute has been picked as the Source Anchor attribute after Custom installation completes.</span></span> |
| <span data-ttu-id="3dd7c-205">Określony atrybut</span><span class="sxs-lookup"><span data-stu-id="3dd7c-205">A specific attribute</span></span> | <span data-ttu-id="3dd7c-206">Wybierz tę opcję, jeśli chcesz określić istniejący atrybut usługi AD jako atrybut sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-206">Select this option if you wish to specify an existing AD attribute as the sourceAnchor attribute.</span></span> |

### <a name="how-to-enable-the-consistencyguid-feature---existing-deployment"></a><span data-ttu-id="3dd7c-207">Jak włączyć funkcję ConsistencyGuid - istniejącego wdrożenia</span><span class="sxs-lookup"><span data-stu-id="3dd7c-207">How to enable the ConsistencyGuid feature - Existing deployment</span></span>
<span data-ttu-id="3dd7c-208">Jeśli masz istniejące wdrożenie usługi Azure AD Connect, za pomocą objectGUID jako atrybut zakotwiczenia źródła, możesz przełączyć go do zamiast ConsistencyGuid.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-208">If you have an existing Azure AD Connect deployment which is using objectGUID as the Source Anchor attribute, you can switch it to using ConsistencyGuid instead.</span></span>

>[!NOTE]
> <span data-ttu-id="3dd7c-209">Tylko nowsze wersje programu Azure AD Connect (1.1.552.0 oraz po) obsługuje przełączania ObjectGuid ConsistencyGuid jako atrybut zakotwiczenia źródła.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-209">Only newer versions of Azure AD Connect (1.1.552.0 and after) supports switching from ObjectGuid to ConsistencyGuid as the Source Anchor attribute.</span></span>

<span data-ttu-id="3dd7c-210">Aby przełączyć się z objectGUID ConsistencyGuid jako atrybut zakotwiczenia źródła:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-210">To switch from objectGUID to ConsistencyGuid as the Source Anchor attribute:</span></span>

1. <span data-ttu-id="3dd7c-211">Uruchom Kreatora programu Azure AD Connect i kliknij przycisk **Konfiguruj** aby przejść do ekranu zadań.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-211">Start the Azure AD Connect wizard and click **Configure** to go to the Tasks screen.</span></span>

2. <span data-ttu-id="3dd7c-212">Wybierz **Konfiguruj zakotwiczenia źródła** zadań opcję i kliknij przycisk **dalej**.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-212">Select the **Configure Source Anchor** task option and click **Next**.</span></span>

   ![Włącz ConsistencyGuid dla istniejącego wdrożenia — krok 2](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment01.png)

3. <span data-ttu-id="3dd7c-214">Wprowadź swoje poświadczenia usługi Azure AD administratora, a następnie kliknij przycisk **dalej**.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-214">Enter your Azure AD Administrator credentials and click **Next**.</span></span>

4. <span data-ttu-id="3dd7c-215">Kreator Azure AD Connect analizuje stan atrybutu msDS-ConsistencyGuid w lokalnej usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-215">Azure AD Connect wizard analyzes the state of the msDS-ConsistencyGuid attribute in your on-premises Active Directory.</span></span> <span data-ttu-id="3dd7c-216">Jeśli ten atrybut nie jest skonfigurowana dla dowolnego obiektu w katalogu, Azure AD Connect stwierdza, że żadna inna aplikacja używa obecnie atrybut i jest bezpieczne używać go jako atrybut zakotwiczenia źródła.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-216">If the attribute isn't configured on any object in the directory, Azure AD Connect concludes that no other application is currently using the attribute and is safe to use it as the Source Anchor attribute.</span></span> <span data-ttu-id="3dd7c-217">Kliknij przycisk **dalej** aby kontynuować.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-217">Click **Next** to continue.</span></span>

   ![Włącz ConsistencyGuid dla istniejącego wdrożenia — krok 4](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment02.png)

5. <span data-ttu-id="3dd7c-219">W **gotowe do konfiguracji** kliknij **Konfiguruj** aby zmiany konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-219">In the **Ready to Configure** screen, click **Configure** to make the configuration change.</span></span>

   ![Włącz ConsistencyGuid dla istniejącego wdrożenia — krok 5](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment03.png)

6. <span data-ttu-id="3dd7c-221">Po zakończeniu konfiguracji kreatora wskazuje, że ten atrybut msDS-ConsistencyGuid jest teraz używany jako atrybut zakotwiczenia źródła.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-221">Once the configuration completes, the wizard indicates that msDS-ConsistencyGuid is now being used as the Source Anchor attribute.</span></span>

   ![Włącz ConsistencyGuid dla istniejącego wdrożenia — krok 6](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeployment04.png)

<span data-ttu-id="3dd7c-223">Podczas analizy (krok 4) Jeśli ten atrybut jest skonfigurowany w co najmniej jednego obiektu w katalogu, Kreator stwierdza, ten atrybut jest używany przez inną aplikację i zwraca błąd, jak pokazano na poniższym diagramie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-223">During the analysis (step 4), if the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by another application and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="3dd7c-224">Jeśli masz pewność, że ten atrybut nie jest używane przez istniejące aplikacje, należy skontaktować się z obsługą informacji dotyczących Pomiń błąd.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-224">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![Włącz ConsistencyGuid dla istniejącego wdrożenia — błąd](./media/active-directory-aadconnect-design-concepts/consistencyguidexistingdeploymenterror.png)

### <a name="impact-on-ad-fs-or-third-party-federation-configuration"></a><span data-ttu-id="3dd7c-226">Wpływ na usługi AD FS lub konfiguracji federacyjne innych firm</span><span class="sxs-lookup"><span data-stu-id="3dd7c-226">Impact on AD FS or third-party federation configuration</span></span>
<span data-ttu-id="3dd7c-227">Jeśli używasz usługi Azure AD Connect do zarządzania lokalnymi wdrożenia usług AD FS, Azure AD Connect automatycznie aktualizuje reguł oświadczeń, aby użyć tego samego atrybutu AD jako sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-227">If you are using Azure AD Connect to manage on-premises AD FS deployment, the Azure AD Connect automatically updates the claim rules to use the same AD attribute as sourceAnchor.</span></span> <span data-ttu-id="3dd7c-228">Dzięki temu, że oświadczenia nazwę ImmutableID generowanych przez usługi AD FS jest zgodne z wartościami sourceAnchor wyeksportowane do usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-228">This ensures that the ImmutableID claim generated by ADFS is consistent with the sourceAnchor values exported to Azure AD.</span></span>

<span data-ttu-id="3dd7c-229">Jeśli zarządzasz usług AD FS poza Azure AD Connect lub serwery federacyjne innych firm jest używany do uwierzytelniania, należy ręcznie zaktualizować reguły oświadczeń nazwę ImmutableID oświadczenia były spójne z wartościami sourceAnchor wyeksportowane do usługi Azure AD, zgodnie z opisem w sekcji artykule [reguł oświadczeń Modyfikuj AD FS](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span><span class="sxs-lookup"><span data-stu-id="3dd7c-229">If you are managing AD FS outside of Azure AD Connect or you are using third-party federation servers for authentication, you must manually update the claim rules for ImmutableID claim to be consistent with the sourceAnchor values exported to Azure AD as described in article section [Modify AD FS claim rules](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-federation-management#modclaims).</span></span> <span data-ttu-id="3dd7c-230">Po zakończeniu instalacji, Kreator zwraca następujące ostrzeżenie:</span><span class="sxs-lookup"><span data-stu-id="3dd7c-230">The wizard returns the following warning after installation completes:</span></span>

![Konfiguracja federacyjnego innych firm](./media/active-directory-aadconnect-design-concepts/consistencyGuid-03.png)

### <a name="adding-new-directories-to-existing-deployment"></a><span data-ttu-id="3dd7c-232">Dodawanie nowych katalogów do istniejącego wdrożenia</span><span class="sxs-lookup"><span data-stu-id="3dd7c-232">Adding new directories to existing deployment</span></span>
<span data-ttu-id="3dd7c-233">Załóżmy, że wdrożono Azure AD Connect z włączoną funkcją ConsistencyGuid, a teraz chcesz dodać innego katalogu do wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-233">Suppose you have deployed Azure AD Connect with the ConsistencyGuid feature enabled, and now you would like to add another directory to the deployment.</span></span> <span data-ttu-id="3dd7c-234">Podczas próby dodania katalogu, Kreator Azure AD Connect sprawdza stan atrybutu mSDS-ConsistencyGuid w katalogu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-234">When you try to add the directory, Azure AD Connect wizard checks the state of the mSDS-ConsistencyGuid attribute in the directory.</span></span> <span data-ttu-id="3dd7c-235">Jeśli ten atrybut został skonfigurowany w co najmniej jednego obiektu w katalogu, Kreator stwierdza, ten atrybut jest używany przez inne aplikacje i zwraca błąd, jak pokazano na poniższym diagramie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-235">If the attribute is configured on one or more objects in the directory, the wizard concludes the attribute is being used by other applications and returns an error as illustrated in the diagram below.</span></span> <span data-ttu-id="3dd7c-236">Jeśli masz pewność, że ten atrybut nie jest używane przez istniejące aplikacje, należy skontaktować się z obsługą informacji dotyczących Pomiń błąd.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-236">If you are certain that the attribute isn't used by existing applications, you need to contact Support for information on how to suppress the error.</span></span>

![Dodawanie nowych katalogów do istniejącego wdrożenia](./media/active-directory-aadconnect-design-concepts/consistencyGuid-04.png)

## <a name="azure-ad-sign-in"></a><span data-ttu-id="3dd7c-238">Azure AD logowania</span><span class="sxs-lookup"><span data-stu-id="3dd7c-238">Azure AD sign-in</span></span>
<span data-ttu-id="3dd7c-239">Podczas integracji katalogu lokalnego z usługą Azure AD, ważne jest, aby zrozumieć, jak ustawienia synchronizacji wpływa na sposób użytkownik zostanie uwierzytelniony.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-239">While integrating your on-premises directory with Azure AD, it is important to understand how the synchronization settings can affect the way user authenticates.</span></span> <span data-ttu-id="3dd7c-240">Usługi Azure AD używa userPrincipalName (UPN) w celu uwierzytelnienia użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-240">Azure AD uses userPrincipalName (UPN) to authenticate the user.</span></span> <span data-ttu-id="3dd7c-241">Jednak po zsynchronizowaniu użytkowników, musisz wybrać atrybut służący do wartości userPrincipalName uważnie.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-241">However, when you synchronize your users, you must choose the attribute to be used for value of userPrincipalName carefully.</span></span>

### <a name="choosing-the-attribute-for-userprincipalname"></a><span data-ttu-id="3dd7c-242">Wybieranie atrybutu userPrincipalName</span><span class="sxs-lookup"><span data-stu-id="3dd7c-242">Choosing the attribute for userPrincipalName</span></span>
<span data-ttu-id="3dd7c-243">Podczas wybierania atrybutu zapewniające powinno wartość UPN do użycia w przypadku platformy Azure</span><span class="sxs-lookup"><span data-stu-id="3dd7c-243">When you are selecting the attribute for providing the value of UPN to be used in Azure one should ensure</span></span>

* <span data-ttu-id="3dd7c-244">Wartości atrybutów odpowiada składni UPN (RFC 822), który znajduje się powinna mieć ona formatusername@domain</span><span class="sxs-lookup"><span data-stu-id="3dd7c-244">The attribute values conform to the UPN syntax (RFC 822), that is it should be of the format username@domain</span></span>
* <span data-ttu-id="3dd7c-245">Sufiks w wartości pasuje do jednej z zweryfikowanych domen niestandardowych w usłudze Azure AD</span><span class="sxs-lookup"><span data-stu-id="3dd7c-245">The suffix in the values matches to one of the verified custom domains in Azure AD</span></span>

<span data-ttu-id="3dd7c-246">W ustawieniach ekspresowych zakładanego wybór dla atrybutu jest userPrincipalName.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-246">In express settings, the assumed choice for the attribute is userPrincipalName.</span></span> <span data-ttu-id="3dd7c-247">Jeśli atrybut userPrincipalName nie zawiera wartości chcesz użytkownikom logowanie do platformy Azure, a następnie należy wybrać **Instalacja niestandardowa**.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-247">If the userPrincipalName attribute does not contain the value you want your users to sign in to Azure, then you must choose **Custom Installation**.</span></span>

### <a name="custom-domain-state-and-upn"></a><span data-ttu-id="3dd7c-248">Stan domeny niestandardowe i UPN</span><span class="sxs-lookup"><span data-stu-id="3dd7c-248">Custom domain state and UPN</span></span>
<span data-ttu-id="3dd7c-249">Koniecznie upewnij się, że jest zweryfikowanej domeny dla sufiks głównej nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-249">It is important to ensure that there is a verified domain for the UPN suffix.</span></span>

<span data-ttu-id="3dd7c-250">Jan jest użytkownikiem w domenie contoso.com.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-250">John is a user in contoso.com.</span></span> <span data-ttu-id="3dd7c-251">Ma Jan do użycia z lokalną nazwą UPN john@contoso.com logować się do platformy Azure po zsynchronizowaniu użytkowników do Twojej contoso.onmicrosoft.com katalogu usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-251">You want John to use the on-premises UPN john@contoso.com to sign in to Azure after you have synced users to your Azure AD directory contoso.onmicrosoft.com.</span></span> <span data-ttu-id="3dd7c-252">Aby to zrobić, należy dodać i zweryfikować domeny contoso.com jako domeny niestandardowej w usłudze Azure AD, przed rozpoczęciem synchronizowania użytkowników.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-252">To do so, you need to add and verify contoso.com as a custom domain in Azure AD before you can start syncing the users.</span></span> <span data-ttu-id="3dd7c-253">Jeśli sufiks nazwy UPN John, na przykład contoso.com, nie odpowiada zweryfikowanej domeny w usłudze Azure AD, następnie usługi Azure AD zastępuje sufiks nazwy UPN contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-253">If the UPN suffix of John, for example contoso.com, does not match a verified domain in Azure AD, then Azure AD replaces the UPN suffix with contoso.onmicrosoft.com.</span></span>

### <a name="non-routable-on-premises-domains-and-upn-for-azure-ad"></a><span data-ttu-id="3dd7c-254">UPN dla usługi Azure AD i lokalnej obsługi routingu domen</span><span class="sxs-lookup"><span data-stu-id="3dd7c-254">Non-routable on-premises domains and UPN for Azure AD</span></span>
<span data-ttu-id="3dd7c-255">Niektóre organizacje mają nierutowalny domen, takich jak contoso.local lub prostego domen jak contoso.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-255">Some organizations have non-routable domains, like contoso.local, or simple single label domains like contoso.</span></span> <span data-ttu-id="3dd7c-256">Nie jest możliwe zweryfikować domeny bez obsługi routingu w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-256">You are not able to verify a non-routable domain in Azure AD.</span></span> <span data-ttu-id="3dd7c-257">Azure AD Connect można synchronizację zweryfikowanej domeny w usłudze Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-257">Azure AD Connect can sync to only a verified domain in Azure AD.</span></span> <span data-ttu-id="3dd7c-258">Podczas tworzenia katalogu usługi Azure AD, tworzy domenę routingu, która staje się domyślną domenę usługi Azure AD na przykład contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-258">When you create an Azure AD directory, it creates a routable domain that becomes default domain for your Azure AD for example, contoso.onmicrosoft.com.</span></span> <span data-ttu-id="3dd7c-259">W związku z tym staje się zweryfikowanie innej domeny routingu w takiej sytuacji, w przypadku, gdy nie chcesz synchronizować domyślnej domeny onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-259">Therefore, it becomes necessary to verify any other routable domain in such a scenario in case you don't want to sync to the default onmicrosoft.com domain.</span></span>

<span data-ttu-id="3dd7c-260">Odczyt [Dodawanie niestandardowej nazwy domeny do usługi Azure Active Directory](../active-directory-add-domain.md) uzyskać więcej informacji dotyczących dodawania i weryfikowania domeny.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-260">Read [Add your custom domain name to Azure Active Directory](../active-directory-add-domain.md) for more info on adding and verifying domains.</span></span>

<span data-ttu-id="3dd7c-261">Wykrywa Azure AD Connect, jeśli są uruchomione w środowisku domeny bez obsługi routingu i będzie odpowiednio ostrzegać z wyprzedzeniem korzystanie z ustawień ekspresowych.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-261">Azure AD Connect detects if you are running in a non-routable domain environment and would appropriately warn you from going ahead with express settings.</span></span> <span data-ttu-id="3dd7c-262">Jeśli pracujesz w domenie bez obsługi routingu, następnie prawdopodobnie nazwy UPN użytkowników zbyt ma sufiksy bez obsługi routingu.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-262">If you are operating in a non-routable domain, then it is likely that the UPN of the users have non-routable suffixes too.</span></span> <span data-ttu-id="3dd7c-263">Na przykład, jeśli używane do uruchamiania contoso.local, Azure AD Connect sugeruje można użyć ustawienia niestandardowe, a nie przy użyciu ustawień ekspresowych.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-263">For example, if you are running under contoso.local, Azure AD Connect suggests you to use custom settings rather than using express settings.</span></span> <span data-ttu-id="3dd7c-264">Za pomocą ustawień niestandardowych, będą mogli określać atrybut, które mają być używane jako nazwy UPN do logowania do platformy Azure po zsynchronizowaniu użytkowników do usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3dd7c-264">Using custom settings, you are able to specify the attribute that should be used as UPN to sign in to Azure after the users are synced to Azure AD.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3dd7c-265">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="3dd7c-265">Next steps</span></span>
<span data-ttu-id="3dd7c-266">Dowiedz się więcej na temat [integrowania tożsamości lokalnych z usługą Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="3dd7c-266">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
