---
title: Azure Active Directory w wersji 2.0 zakresy, uprawnienia i zgody | Dokumentacja firmy Microsoft
description: "Opis autoryzacji w punktu końcowego v2.0 usługi Azure AD, w tym zakresy, uprawnienia i zgody."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 8f98cbf0-a71d-4e34-babf-e644ad9ff423
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 04869a7627ecb3e6a0d11733fae7da2ecb04ed51
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="scopes-permissions-and-consent-in-the-azure-active-directory-v20-endpoint"></a><span data-ttu-id="defde-103">Zakresy, uprawnienia i zgody w punkcie końcowym v2.0 usługi Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="defde-103">Scopes, permissions, and consent in the Azure Active Directory v2.0 endpoint</span></span>
<span data-ttu-id="defde-104">Aplikacje do zintegrowania z usługą Azure Active Directory (Azure AD) wykonaj modelu autoryzacji, która zapewnia użytkownikom kontrolę nad jak aplikacja może uzyskiwać dostępu do danych.</span><span class="sxs-lookup"><span data-stu-id="defde-104">Apps that integrate with Azure Active Directory (Azure AD) follow an authorization model that gives users control over how an app can access their data.</span></span> <span data-ttu-id="defde-105">Implementacja v2.0 modelu autoryzacji została zaktualizowana i zmienia sposób aplikacji musi współdziałać z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="defde-105">The v2.0 implementation of the authorization model has been updated, and it changes how an app must interact with Azure AD.</span></span> <span data-ttu-id="defde-106">W tym artykule opisano podstawowe pojęcia tego modelu autoryzacji, w tym zakresy, uprawnienia i zgody.</span><span class="sxs-lookup"><span data-stu-id="defde-106">This article covers the basic concepts of this authorization model, including scopes, permissions, and consent.</span></span>

> [!NOTE]
> <span data-ttu-id="defde-107">Punktu końcowego v2.0 nie obsługuje wszystkich scenariuszy Azure Active Directory i funkcji.</span><span class="sxs-lookup"><span data-stu-id="defde-107">The v2.0 endpoint does not support all Azure Active Directory scenarios and features.</span></span> <span data-ttu-id="defde-108">Aby ustalić, czy należy używać punktu końcowego v2.0, przeczytaj o [ograniczenia v2.0](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="defde-108">To determine whether you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
>
>

## <a name="scopes-and-permissions"></a><span data-ttu-id="defde-109">Zakresy i uprawnień</span><span class="sxs-lookup"><span data-stu-id="defde-109">Scopes and permissions</span></span>
<span data-ttu-id="defde-110">Azure AD implementuje [OAuth 2.0](active-directory-v2-protocols.md) protokołu autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="defde-110">Azure AD implements the [OAuth 2.0](active-directory-v2-protocols.md) authorization protocol.</span></span> <span data-ttu-id="defde-111">OAuth 2.0 jest to metoda, za pomocą którego aplikacji innych firm mają dostęp do zasobów sieci web hostowanych w imieniu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="defde-111">OAuth 2.0 is a method through which a third-party app can access web-hosted resources on behalf of a user.</span></span> <span data-ttu-id="defde-112">Dowolnego zasobu hostowanych w sieci web, która integruje się z usługą Azure AD ma identyfikator zasobu, lub *aplikacji identyfikator URI*.</span><span class="sxs-lookup"><span data-stu-id="defde-112">Any web-hosted resource that integrates with Azure AD has a resource identifier, or *Application ID URI*.</span></span> <span data-ttu-id="defde-113">Na przykład zasobów hostowanych w sieci web firmy Microsoft są między innymi:</span><span class="sxs-lookup"><span data-stu-id="defde-113">For example, some of Microsoft's web-hosted resources include:</span></span>

* <span data-ttu-id="defde-114">Office 365 Unified poczty interfejsu API:`https://outlook.office.com`</span><span class="sxs-lookup"><span data-stu-id="defde-114">The Office 365 Unified Mail API: `https://outlook.office.com`</span></span>
* <span data-ttu-id="defde-115">W przypadku interfejsu API programu Graph usługi Azure AD:`https://graph.windows.net`</span><span class="sxs-lookup"><span data-stu-id="defde-115">The Azure AD Graph API: `https://graph.windows.net`</span></span>
* <span data-ttu-id="defde-116">Program Microsoft Graph:`https://graph.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="defde-116">Microsoft Graph: `https://graph.microsoft.com`</span></span>

<span data-ttu-id="defde-117">To samo dotyczy dla wszystkich zasobów innych firm, które zostały zintegrowane z usługą Azure AD.</span><span class="sxs-lookup"><span data-stu-id="defde-117">The same is true for any third-party resources that have integrated with Azure AD.</span></span> <span data-ttu-id="defde-118">Żadnego z tych zasobów również definiować zestaw uprawnień, które mogą służyć do dzielenia funkcjonalność tego zasobu na mniejsze fragmenty.</span><span class="sxs-lookup"><span data-stu-id="defde-118">Any of these resources also can define a set of permissions that can be used to divide the functionality of that resource into smaller chunks.</span></span> <span data-ttu-id="defde-119">Na przykład [Microsoft Graph](https://graph.microsoft.io) ma określone uprawnienia do wykonywania następujących zadań, między innymi:</span><span class="sxs-lookup"><span data-stu-id="defde-119">As an example, [Microsoft Graph](https://graph.microsoft.io) has defined permissions to do the following tasks, among others:</span></span>

* <span data-ttu-id="defde-120">Przeczytaj kalendarza użytkownika</span><span class="sxs-lookup"><span data-stu-id="defde-120">Read a user's calendar</span></span>
* <span data-ttu-id="defde-121">Zapis do kalendarza użytkownika</span><span class="sxs-lookup"><span data-stu-id="defde-121">Write to a user's calendar</span></span>
* <span data-ttu-id="defde-122">Wysyłaj pocztę jako użytkownik</span><span class="sxs-lookup"><span data-stu-id="defde-122">Send mail as a user</span></span>

<span data-ttu-id="defde-123">Zdefiniowanie tych typów uprawnień, zasób ma precyzyjną kontrolę nad jego danych i jak dane są widoczne.</span><span class="sxs-lookup"><span data-stu-id="defde-123">By defining these types of permissions, the resource has fine-grained control over its data and how the data is exposed.</span></span> <span data-ttu-id="defde-124">Aplikacji innych firm mogą żądać tych uprawnień przez użytkownika aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-124">A third-party app can request these permissions from an app user.</span></span> <span data-ttu-id="defde-125">Użytkownik aplikacji musi zatwierdzić uprawnienia, zanim aplikacja może działać w imieniu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="defde-125">The app user must approve the permissions before the app can act on the user's behalf.</span></span> <span data-ttu-id="defde-126">Według segmentu zasobu funkcje na mniejsze zestawy uprawnień, aplikacje innych firm mogą być tworzone na żądanie tylko określone uprawnienia, które są niezbędne do wykonywania ich funkcji.</span><span class="sxs-lookup"><span data-stu-id="defde-126">By chunking the resource's functionality into smaller permission sets, third-party apps can be built to request only the specific permissions that they need to perform their function.</span></span> <span data-ttu-id="defde-127">Użytkownicy aplikacji mogą poznać, dokładnie tak jak aplikacja będzie używać swoich danych i może być większa pewność, że aplikacja nie zachowuje się ze złośliwymi działaniami.</span><span class="sxs-lookup"><span data-stu-id="defde-127">App users can know exactly how an app will use their data, and they can be more confident that the app is not behaving with malicious intent.</span></span>

<span data-ttu-id="defde-128">W usłudze Azure AD i OAuth, tego rodzaju uprawnienia są nazywane *zakresy*.</span><span class="sxs-lookup"><span data-stu-id="defde-128">In Azure AD and OAuth, these types of permissions are called *scopes*.</span></span> <span data-ttu-id="defde-129">One również są nazywane *oAuth2Permissions*.</span><span class="sxs-lookup"><span data-stu-id="defde-129">They also sometimes are referred to as *oAuth2Permissions*.</span></span> <span data-ttu-id="defde-130">Zakres jest reprezentowana w usłudze Azure AD jako wartość ciągu.</span><span class="sxs-lookup"><span data-stu-id="defde-130">A scope is represented in Azure AD as a string value.</span></span> <span data-ttu-id="defde-131">W ramach przykładu Microsoft Graph, jest wartość zakresu dla każdego uprawnienia:</span><span class="sxs-lookup"><span data-stu-id="defde-131">Continuing with the Microsoft Graph example, the scope value for each permission is:</span></span>

* <span data-ttu-id="defde-132">Przeczytaj kalendarza użytkownika za pomocą`Calendar.Read`</span><span class="sxs-lookup"><span data-stu-id="defde-132">Read a user's calendar by using `Calendar.Read`</span></span>
* <span data-ttu-id="defde-133">Zapis do kalendarza użytkownika za pomocą`Mail.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="defde-133">Write to a user's calendar by using `Mail.ReadWrite`</span></span>
* <span data-ttu-id="defde-134">Wysyłania wiadomości e-mail jako użytkownika przy użyciu przez`Mail.Send`</span><span class="sxs-lookup"><span data-stu-id="defde-134">Send mail as a user using by `Mail.Send`</span></span>

<span data-ttu-id="defde-135">Aplikacji mogą żądać tych uprawnień, określając zakresów w żądaniach wysyłanych do punktu końcowego v2.0.</span><span class="sxs-lookup"><span data-stu-id="defde-135">An app can request these permissions by specifying the scopes in requests to the v2.0 endpoint.</span></span>

## <a name="openid-connect-scopes"></a><span data-ttu-id="defde-136">Zakresy OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="defde-136">OpenID Connect scopes</span></span>
<span data-ttu-id="defde-137">V2.0 wdrażania protokołu OpenID Connect ma kilka dobrze zdefiniowany zakresy, które nie mają zastosowanie do określonego zasobu: `openid`, `email`, `profile`, i `offline_access`.</span><span class="sxs-lookup"><span data-stu-id="defde-137">The v2.0 implementation of OpenID Connect has a few well-defined scopes that do not apply to a specific resource: `openid`, `email`, `profile`, and `offline_access`.</span></span>

### <a name="openid"></a><span data-ttu-id="defde-138">openid</span><span class="sxs-lookup"><span data-stu-id="defde-138">openid</span></span>
<span data-ttu-id="defde-139">Jeśli aplikacja przeprowadza logowania za pomocą [OpenID Connect](active-directory-v2-protocols.md), należy go zażądać `openid` zakresu.</span><span class="sxs-lookup"><span data-stu-id="defde-139">If an app performs sign-in by using [OpenID Connect](active-directory-v2-protocols.md), it must request the `openid` scope.</span></span> <span data-ttu-id="defde-140">`openid` Zakresu wyświetlane na stronie zgoda konta pracy jako uprawnienie "Logowanie się w" oraz na osobiste strony zgody konto Microsoft jako uprawnienie "Wyświetl swój profil i łączenie z aplikacjami i usługami za pomocą konta Microsoft".</span><span class="sxs-lookup"><span data-stu-id="defde-140">The `openid` scope shows on the work account consent page as the "Sign you in" permission, and on the personal Microsoft account consent page as the "View your profile and connect to apps and services using your Microsoft account" permission.</span></span> <span data-ttu-id="defde-141">Z tego uprawnienia, aplikacja może odbierać Unikatowy identyfikator dla użytkownika w postaci `sub` oświadczeń.</span><span class="sxs-lookup"><span data-stu-id="defde-141">With this permission, an app can receive a unique identifier for the user in the form of the `sub` claim.</span></span> <span data-ttu-id="defde-142">Udostępnia również aplikacji uprawnień dostępu do punktu końcowego informacje o użytkowniku.</span><span class="sxs-lookup"><span data-stu-id="defde-142">It also gives the app access to the UserInfo endpoint.</span></span> <span data-ttu-id="defde-143">`openid` Zakresu pozwala na token punktu końcowego v2.0 uzyskać tokeny Identyfikatora, które mogą być używane do zabezpieczenia połączenia HTTP między poszczególnymi składnikami aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-143">The `openid` scope can be used at the v2.0 token endpoint to acquire ID tokens, which can be used to secure HTTP calls between different components of an app.</span></span>

### <a name="email"></a><span data-ttu-id="defde-144">Adres e-mail</span><span class="sxs-lookup"><span data-stu-id="defde-144">email</span></span>
<span data-ttu-id="defde-145">`email` Zakresu, może być używany z `openid` zakresu i innych.</span><span class="sxs-lookup"><span data-stu-id="defde-145">The `email` scope can be used with the `openid` scope and any others.</span></span> <span data-ttu-id="defde-146">Daje dostęp do aplikacji do użytkownika podstawowego adresu e-mail w postaci `email` oświadczeń.</span><span class="sxs-lookup"><span data-stu-id="defde-146">It gives the app access to the user's primary email address in the form of the `email` claim.</span></span> <span data-ttu-id="defde-147">`email` Oświadczenia jest uwzględniona w tokenu, tylko wtedy, gdy adres e-mail jest skojarzony z konta użytkownika, które nie zawsze jest wielkość liter.</span><span class="sxs-lookup"><span data-stu-id="defde-147">The `email` claim is included in a token only if an email address is associated with the user account, which is not always the case.</span></span> <span data-ttu-id="defde-148">Gdy jest używana funkcja `email` zakresu, aplikacja powinna być przygotowana do obsługi przypadek, w którym `email` oświadczenia nie istnieje w tokenie.</span><span class="sxs-lookup"><span data-stu-id="defde-148">If it uses the `email` scope, your app should be prepared to handle a case in which the `email` claim does not exist in the token.</span></span>

### <a name="profile"></a><span data-ttu-id="defde-149">Profil</span><span class="sxs-lookup"><span data-stu-id="defde-149">profile</span></span>
<span data-ttu-id="defde-150">`profile` Zakresu, może być używany z `openid` zakresu i innych.</span><span class="sxs-lookup"><span data-stu-id="defde-150">The `profile` scope can be used with the `openid` scope and any others.</span></span> <span data-ttu-id="defde-151">Daje dostęp do aplikacji znacznej ilości informacji o użytkowniku.</span><span class="sxs-lookup"><span data-stu-id="defde-151">It gives the app access to a substantial amount of information about the user.</span></span> <span data-ttu-id="defde-152">Informacje, które mogą uzyskać dostęp obejmuje, ale nie jest ograniczona do użytkownika imię, nazwisko preferowanych nazwy użytkownika i identyfikator obiektu.</span><span class="sxs-lookup"><span data-stu-id="defde-152">The information it can access includes, but is not limited to, the user's given name, surname, preferred username, and object ID.</span></span> <span data-ttu-id="defde-153">Aby uzyskać pełną listę dostępnych w parametrze id_tokens oświadczeń profilu określonego użytkownika, zobacz [v2.0 tokeny odwołanie](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="defde-153">For a complete list of the profile claims available in the id_tokens parameter for a specific user, see the [v2.0 tokens reference](active-directory-v2-tokens.md).</span></span>

### <a name="offlineaccess"></a><span data-ttu-id="defde-154">offline_access</span><span class="sxs-lookup"><span data-stu-id="defde-154">offline_access</span></span>
<span data-ttu-id="defde-155">[ `offline_access` Zakres](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) pozwala aplikacji dostęp do zasobów w imieniu użytkownika przez dłuższy czas.</span><span class="sxs-lookup"><span data-stu-id="defde-155">The [`offline_access` scope](http://openid.net/specs/openid-connect-core-1_0.html#OfflineAccess) gives your app access to resources on behalf of the user for an extended time.</span></span> <span data-ttu-id="defde-156">Na stronie pracy konta zgody ten zakres jest wyświetlany jako uprawnień "W każdej chwili uzyskać dostęp do danych".</span><span class="sxs-lookup"><span data-stu-id="defde-156">On the work account consent page, this scope appears as the "Access your data anytime" permission.</span></span> <span data-ttu-id="defde-157">Na osobiste strony zgody konta Microsoft jest widoczny jako uprawnień "W każdej chwili dostęp do informacji".</span><span class="sxs-lookup"><span data-stu-id="defde-157">On the personal Microsoft account consent page, it appears as the "Access your info anytime" permission.</span></span> <span data-ttu-id="defde-158">Jeśli użytkownik zaakceptuje `offline_access` zakresu, aplikacja może odbierać tokeny odświeżania z punktu końcowego tokenu w wersji 2.0.</span><span class="sxs-lookup"><span data-stu-id="defde-158">When a user approves the `offline_access` scope, your app can receive refresh tokens from the v2.0 token endpoint.</span></span> <span data-ttu-id="defde-159">Tokeny odświeżania są długotrwałe.</span><span class="sxs-lookup"><span data-stu-id="defde-159">Refresh tokens are long-lived.</span></span> <span data-ttu-id="defde-160">Aplikację można uzyskać nowe tokeny dostępu, zgodnie z tych starszych wygaśnie.</span><span class="sxs-lookup"><span data-stu-id="defde-160">Your app can get new access tokens as older ones expire.</span></span>

<span data-ttu-id="defde-161">Jeśli aplikacja nie żąda `offline_access` zakresu, nie będziesz otrzymywać tokenów odświeżania.</span><span class="sxs-lookup"><span data-stu-id="defde-161">If your app does not request the `offline_access` scope, it won't receive refresh tokens.</span></span> <span data-ttu-id="defde-162">Oznacza to, że gdy zrealizować kod autoryzacji w [przepływu kodu autoryzacji protokołu OAuth 2.0](active-directory-v2-protocols.md), otrzymasz tylko token dostępu z `/token` punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="defde-162">This means that when you redeem an authorization code in the [OAuth 2.0 authorization code flow](active-directory-v2-protocols.md), you'll receive only an access token from the `/token` endpoint.</span></span> <span data-ttu-id="defde-163">Token dostępu jest ważny przez krótki czas.</span><span class="sxs-lookup"><span data-stu-id="defde-163">The access token is valid for a short time.</span></span> <span data-ttu-id="defde-164">Token dostępu zwykle wygaśnie w ciągu godziny.</span><span class="sxs-lookup"><span data-stu-id="defde-164">The access token usually expires in one hour.</span></span> <span data-ttu-id="defde-165">AT, że punkt, Twoja aplikacja powinna przekieruje użytkownika z powrotem do `/authorize` punktu końcowego, aby uzyskać nowy kod autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="defde-165">At that point, your app needs to redirect the user back to the `/authorize` endpoint to get a new authorization code.</span></span> <span data-ttu-id="defde-166">Podczas tego przekierowania, w zależności od typu aplikacji użytkownik może być konieczne ponowne wprowadzenie poświadczeń lub ponownie wyrażenia zgody na uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="defde-166">During this redirect, depending on the type of app, the user might need to enter their credentials again or consent again to permissions.</span></span>

<span data-ttu-id="defde-167">Aby uzyskać więcej informacji o sposobie pobrania i używania tokenów odświeżania, zobacz [referencyjne protokołu v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="defde-167">For more information about how to get and use refresh tokens, see the [v2.0 protocol reference](active-directory-v2-protocols.md).</span></span>

## <a name="requesting-individual-user-consent"></a><span data-ttu-id="defde-168">Żąda zgody użytkownika</span><span class="sxs-lookup"><span data-stu-id="defde-168">Requesting individual user consent</span></span>
<span data-ttu-id="defde-169">W [OpenID Connect i OAuth 2.0](active-directory-v2-protocols.md) żądania autoryzacji, aplikację można zażądać uprawnień, należy za pomocą `scope` parametr zapytania.</span><span class="sxs-lookup"><span data-stu-id="defde-169">In an [OpenID Connect or OAuth 2.0](active-directory-v2-protocols.md) authorization request, an app can request the permissions it needs by using the `scope` query parameter.</span></span> <span data-ttu-id="defde-170">Na przykład po zalogowaniu użytkownika do aplikacji, aplikacja wysyła żądanie, takich jak w poniższym przykładzie (podziałami wierszy dodane dla czytelności):</span><span class="sxs-lookup"><span data-stu-id="defde-170">For example, when a user signs in to an app, the app sends a request like the following example (with line breaks added for legibility):</span></span>

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=
https%3A%2F%2Fgraph.microsoft.com%2Fcalendar.read%20
https%3A%2F%2Fgraph.microsoft.com%2Fmail.send
&state=12345
```

<span data-ttu-id="defde-171">`scope` Parametr jest rozdzielonej spacjami listy zakresy, których żąda aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-171">The `scope` parameter is a space-separated list of scopes that the app is requesting.</span></span> <span data-ttu-id="defde-172">Każdego zakresu jest wskazane przez dołączenie identyfikatora zasobu (aplikacji identyfikator URI) wartość zakresu.</span><span class="sxs-lookup"><span data-stu-id="defde-172">Each scope is indicated by appending the scope value to the resource's identifier (the Application ID URI).</span></span> <span data-ttu-id="defde-173">W przykładzie żądania aplikacji wymaga zgody na odczytywanie kalendarza użytkownika i wysyłania wiadomości e-mail w imieniu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="defde-173">In the request example, the app needs permission to read the user's calendar and send mail as the user.</span></span>

<span data-ttu-id="defde-174">Gdy użytkownik wprowadzi poświadczeń, punktu końcowego v2.0 sprawdza pasującego rekordu *zgody użytkownika*.</span><span class="sxs-lookup"><span data-stu-id="defde-174">After the user enters their credentials, the v2.0 endpoint checks for a matching record of *user consent*.</span></span> <span data-ttu-id="defde-175">Jeśli użytkownik zgodził się nie do dowolnego zasobu w przeszłości, punktu końcowego v2.0 pyta użytkownika w celu przyznania żądanych uprawnień.</span><span class="sxs-lookup"><span data-stu-id="defde-175">If the user has not consented to any of the requested permissions in the past, the v2.0 endpoint asks the user to grant the requested permissions.</span></span>

![Zgody konto robocze](../../media/active-directory-v2-flows/work_account_consent.png)

<span data-ttu-id="defde-177">Gdy użytkownik zatwierdza uprawnienia, zgody zostaje zarejestrowana, dzięki czemu użytkownik nie musi ponownie wyrazić zgodę na kolejne konta logowania.</span><span class="sxs-lookup"><span data-stu-id="defde-177">When the user approves the permission, the consent is recorded so that the user doesn't have to consent again on subsequent account sign-ins.</span></span>

## <a name="requesting-consent-for-an-entire-tenant"></a><span data-ttu-id="defde-178">Żąda zgody dla całego dzierżawcy</span><span class="sxs-lookup"><span data-stu-id="defde-178">Requesting consent for an entire tenant</span></span>
<span data-ttu-id="defde-179">Często gdy organizacja zakupi licencji lub subskrypcji dla aplikacji, organizacja chce pełni udostępniania aplikacji dla swoich pracowników.</span><span class="sxs-lookup"><span data-stu-id="defde-179">Often, when an organization purchases a license or subscription for an application, the organization wants to fully provision the application for its employees.</span></span> <span data-ttu-id="defde-180">W ramach tego procesu administrator może udzielić zgody dla aplikacji, aby działać w imieniu dowolnego pracownika.</span><span class="sxs-lookup"><span data-stu-id="defde-180">As part of this process, an administrator can grant consent for the application to act on behalf of any employee.</span></span> <span data-ttu-id="defde-181">Jeśli Administrator przydziela zgody na cały dzierżawy, pracownicy organizacji nie będą widzieć strony zgody dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-181">If the admin grants consent for the entire tenant, the organization's employees won't see a consent page for the application.</span></span>

<span data-ttu-id="defde-182">Aby poprosić o zgodę dla wszystkich użytkowników w dzierżawie, punktu końcowego zgody administratora może używać aplikacja.</span><span class="sxs-lookup"><span data-stu-id="defde-182">To request consent for all users in a tenant, your app can use the admin consent endpoint.</span></span>

## <a name="admin-restricted-scopes"></a><span data-ttu-id="defde-183">Ograniczonym zakresów</span><span class="sxs-lookup"><span data-stu-id="defde-183">Admin-restricted scopes</span></span>
<span data-ttu-id="defde-184">Można podać niektóre wysokiego poziomu uprawnień w ekosystemie Microsoft *ograniczonym*.</span><span class="sxs-lookup"><span data-stu-id="defde-184">Some high-privilege permissions in the Microsoft ecosystem can be set to *admin-restricted*.</span></span> <span data-ttu-id="defde-185">Przykłady tego rodzaju zakresy obejmują następujące uprawnienia:</span><span class="sxs-lookup"><span data-stu-id="defde-185">Examples of these kinds of scopes include the following permissions:</span></span>

* <span data-ttu-id="defde-186">Odczytuj dane katalogu organizacji za pomocą`Directory.Read`</span><span class="sxs-lookup"><span data-stu-id="defde-186">Read an organization's directory data by using `Directory.Read`</span></span>
* <span data-ttu-id="defde-187">Zapis danych katalogu w organizacji za pomocą`Directory.ReadWrite`</span><span class="sxs-lookup"><span data-stu-id="defde-187">Write data to an organization's directory by using `Directory.ReadWrite`</span></span>
* <span data-ttu-id="defde-188">Przeczytaj przy użyciu grup zabezpieczeń w katalogu organizacji`Groups.Read.All`</span><span class="sxs-lookup"><span data-stu-id="defde-188">Read security groups in an organization's directory by using `Groups.Read.All`</span></span>

<span data-ttu-id="defde-189">Mimo że użytkownika klienta może umożliwić aplikacji dostęp do danych tego rodzaju, użytkowników w organizacji są ograniczone z udzielanie dostępu do tego samego zestawu poufne dane firmy.</span><span class="sxs-lookup"><span data-stu-id="defde-189">Although a consumer user might grant an application access to this kind of data, organizational users are restricted from granting access to the same set of sensitive company data.</span></span> <span data-ttu-id="defde-190">Jeśli aplikacja żąda dostępu do jednego z tych uprawnień z organizacji użytkownika, użytkownik otrzymuje komunikat o błędzie z informacją, że nie masz uprawnień do wyrażenia zgody na uprawnienia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-190">If your application requests access to one of these permissions from an organizational user, the user receives an error message that says they are not authorized to consent to your app's permissions.</span></span>

<span data-ttu-id="defde-191">Jeśli aplikacja wymaga dostępu do ograniczonym zakresy dla organizacji, należy zażądać ich bezpośrednio z administratorem firmy, również przy użyciu punktu końcowego zgody administratora, opisane w dalszej części.</span><span class="sxs-lookup"><span data-stu-id="defde-191">If your app requires access to admin-restricted scopes for organizations, you should request them directly from a company administrator, also by using the admin consent endpoint, described next.</span></span>

<span data-ttu-id="defde-192">Administrator przydziela te uprawnienia za pośrednictwem punktu końcowego zgody administratora, będzie udzielany zgody dla wszystkich użytkowników w dzierżawie.</span><span class="sxs-lookup"><span data-stu-id="defde-192">When an administrator grants these permissions via the admin consent endpoint, consent is granted for all users in the tenant.</span></span>

## <a name="using-the-admin-consent-endpoint"></a><span data-ttu-id="defde-193">Przy użyciu punktu końcowego zgody administratora</span><span class="sxs-lookup"><span data-stu-id="defde-193">Using the admin consent endpoint</span></span>
<span data-ttu-id="defde-194">Jeśli wykonujesz te kroki, aplikację można zbierać uprawnienia dla wszystkich użytkowników w dzierżawie, łącznie z ograniczonym zakresów.</span><span class="sxs-lookup"><span data-stu-id="defde-194">If you follow these steps, your app can gather permissions for all users in a tenant, including admin-restricted scopes.</span></span> <span data-ttu-id="defde-195">Aby zobaczyć przykładowy kod, który implementuje kroki, zobacz [próbki ograniczonym zakresy](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span><span class="sxs-lookup"><span data-stu-id="defde-195">To see a code sample that implements the steps, see the [admin-restricted scopes sample](https://github.com/Azure-Samples/active-directory-dotnet-admin-restricted-scopes-v2).</span></span>

### <a name="request-the-permissions-in-the-app-registration-portal"></a><span data-ttu-id="defde-196">Żądanie uprawnienia w portalu rejestracji aplikacji</span><span class="sxs-lookup"><span data-stu-id="defde-196">Request the permissions in the app registration portal</span></span>
1. <span data-ttu-id="defde-197">Przejdź do aplikacji w [portalu rejestracji aplikacji](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), lub [Utwórz aplikację](active-directory-v2-app-registration.md) Jeśli jeszcze.</span><span class="sxs-lookup"><span data-stu-id="defde-197">Go to your application in the [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList), or [create an app](active-directory-v2-app-registration.md) if you haven't already.</span></span>
2. <span data-ttu-id="defde-198">Zlokalizuj **Microsoft Graph uprawnienia** sekcji, a następnie Dodaj uprawnienia wymagane przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="defde-198">Locate the **Microsoft Graph Permissions** section, and then add the permissions that your app requires.</span></span>
3. <span data-ttu-id="defde-199">Upewnij się, że **zapisać** rejestracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-199">Make sure you **Save** the app registration.</span></span>

### <a name="recommended-sign-the-user-in-to-your-app"></a><span data-ttu-id="defde-200">Zalecane: Zalogować użytkownika do aplikacji</span><span class="sxs-lookup"><span data-stu-id="defde-200">Recommended: Sign the user in to your app</span></span>
<span data-ttu-id="defde-201">Zazwyczaj podczas kompilowania aplikacji korzystającej z punktu końcowego zgody administratora, aplikacja musi strony lub widok, w którym administrator może zatwierdzić uprawnienia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-201">Typically, when you build an application that uses the admin consent endpoint, the app needs a page or view in which the admin can approve the app's permissions.</span></span> <span data-ttu-id="defde-202">Ta strona może być część przepływu rejestracji aplikacji, część ustawień aplikacji lub może być dedykowany przepływu "connect".</span><span class="sxs-lookup"><span data-stu-id="defde-202">This page can be part of the app's sign-up flow, part of the app's settings, or it can be a dedicated "connect" flow.</span></span> <span data-ttu-id="defde-203">W wielu przypadkach warto dla aplikacji pokazać to "Połącz" widoku tylko wtedy, gdy użytkownik jest zalogowany za pomocą służbowego konta Microsoft.</span><span class="sxs-lookup"><span data-stu-id="defde-203">In many cases, it makes sense for the app to show this "connect" view only after a user has signed in with a work or school Microsoft account.</span></span>

<span data-ttu-id="defde-204">Po zalogowaniu użytkownika do aplikacji, należy zidentyfikować organizacji, do którego należy administrator, przed monitem o zatwierdzenie wystarczających uprawnień.</span><span class="sxs-lookup"><span data-stu-id="defde-204">When you sign the user in to your app, you can identify the organization to which the admin belongs before asking them to approve the necessary permissions.</span></span> <span data-ttu-id="defde-205">Chociaż nie niezbędne, ułatwia tworzenie bardziej intuicyjne środowisko dla użytkowników w organizacji.</span><span class="sxs-lookup"><span data-stu-id="defde-205">Although not strictly necessary, it can help you create a more intuitive experience for your organizational users.</span></span> <span data-ttu-id="defde-206">Aby zalogować się użytkownik, wykonaj naszych [samouczki protocol w wersji 2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="defde-206">To sign the user in, follow our [v2.0 protocol tutorials](active-directory-v2-protocols.md).</span></span>

### <a name="request-the-permissions-from-a-directory-admin"></a><span data-ttu-id="defde-207">Zażądaj uprawnień od administratora katalogu</span><span class="sxs-lookup"><span data-stu-id="defde-207">Request the permissions from a directory admin</span></span>
<span data-ttu-id="defde-208">Gdy wszystko jest gotowe zażądać uprawnień od administratora Twojej organizacji, można przekierować użytkownika do v2.0 *punktu końcowego zgody administratora*.</span><span class="sxs-lookup"><span data-stu-id="defde-208">When you're ready to request permissions from your organization's admin, you can redirect the user to the v2.0 *admin consent endpoint*.</span></span>

```
// Line breaks are for legibility only.

GET https://login.microsoftonline.com/{tenant}/adminconsent?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&state=12345
&redirect_uri=http://localhost/myapp/permissions
```

```
// Pro tip: Try pasting the below request in a browser!
```

```
https://login.microsoftonline.com/common/adminconsent?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&state=12345&redirect_uri=http://localhost/myapp/permissions
```

| <span data-ttu-id="defde-209">Parametr</span><span class="sxs-lookup"><span data-stu-id="defde-209">Parameter</span></span> | <span data-ttu-id="defde-210">Warunek</span><span class="sxs-lookup"><span data-stu-id="defde-210">Condition</span></span> | <span data-ttu-id="defde-211">Opis</span><span class="sxs-lookup"><span data-stu-id="defde-211">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="defde-212">Dzierżawy</span><span class="sxs-lookup"><span data-stu-id="defde-212">tenant</span></span> |<span data-ttu-id="defde-213">Wymagane</span><span class="sxs-lookup"><span data-stu-id="defde-213">Required</span></span> |<span data-ttu-id="defde-214">Dzierżawca katalogu, który chcesz zażądać uprawnień.</span><span class="sxs-lookup"><span data-stu-id="defde-214">The directory tenant that you want to request permission from.</span></span> <span data-ttu-id="defde-215">Można podać w formacie przyjaznej nazwy lub identyfikatora GUID.</span><span class="sxs-lookup"><span data-stu-id="defde-215">Can be provided in GUID or friendly name format.</span></span> |
| <span data-ttu-id="defde-216">client_id</span><span class="sxs-lookup"><span data-stu-id="defde-216">client_id</span></span> |<span data-ttu-id="defde-217">Wymagane</span><span class="sxs-lookup"><span data-stu-id="defde-217">Required</span></span> |<span data-ttu-id="defde-218">Identyfikator aplikacji, która [portalu rejestracji aplikacji](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) przypisany do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-218">The Application ID that the [Application Registration Portal](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList) assigned to your app.</span></span> |
| <span data-ttu-id="defde-219">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="defde-219">redirect_uri</span></span> |<span data-ttu-id="defde-220">Wymagane</span><span class="sxs-lookup"><span data-stu-id="defde-220">Required</span></span> |<span data-ttu-id="defde-221">Identyfikator URI przekierowania w miejscu odpowiedź do wysłania dla aplikacji do obsługi.</span><span class="sxs-lookup"><span data-stu-id="defde-221">The redirect URI where you want the response to be sent for your app to handle.</span></span> <span data-ttu-id="defde-222">Dokładnie musi odpowiadać jeden przekierowania URI, który został zarejestrowany w portalu rejestracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-222">It must exactly match one of the redirect URIs that you registered in the app registration portal.</span></span> |
| <span data-ttu-id="defde-223">state</span><span class="sxs-lookup"><span data-stu-id="defde-223">state</span></span> |<span data-ttu-id="defde-224">Zalecane</span><span class="sxs-lookup"><span data-stu-id="defde-224">Recommended</span></span> |<span data-ttu-id="defde-225">Wartość zawarte w żądaniu zwracana w odpowiedzi tokenu.</span><span class="sxs-lookup"><span data-stu-id="defde-225">A value included in the request that will also be returned in the token response.</span></span> <span data-ttu-id="defde-226">Można go ciągiem żadnej zawartości, który ma.</span><span class="sxs-lookup"><span data-stu-id="defde-226">It can be a string of any content you want.</span></span> <span data-ttu-id="defde-227">Umożliwia kodowanie informacje o stanie użytkownika w aplikacji przed wystąpieniem żądania uwierzytelniania, takich jak strony lub widoku, które znajdowały się w stan.</span><span class="sxs-lookup"><span data-stu-id="defde-227">Use the state to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |

<span data-ttu-id="defde-228">W tym momencie usługi Azure AD wymaga administrator dzierżawy może zalogować się do wykonania żądania.</span><span class="sxs-lookup"><span data-stu-id="defde-228">At this point, Azure AD requires a tenant administrator to sign in to complete the request.</span></span> <span data-ttu-id="defde-229">Administrator musi zatwierdzić wszystkie uprawnienia, które żądanej aplikacji w portalu rejestracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="defde-229">The administrator is asked to approve all the permissions that you have requested for your app in the app registration portal.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="defde-230">Odpowiedź oznaczająca Powodzenie</span><span class="sxs-lookup"><span data-stu-id="defde-230">Successful response</span></span>
<span data-ttu-id="defde-231">Jeśli administrator zatwierdza uprawnień dla aplikacji, odpowiedź oznaczająca Powodzenie wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="defde-231">If the admin approves the permissions for your app, the successful response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?tenant=a8990e1f-ff32-408a-9f8e-78d3b9139b95&state=state=12345&admin_consent=True
```

| <span data-ttu-id="defde-232">Parametr</span><span class="sxs-lookup"><span data-stu-id="defde-232">Parameter</span></span> | <span data-ttu-id="defde-233">Opis</span><span class="sxs-lookup"><span data-stu-id="defde-233">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="defde-234">Dzierżawy</span><span class="sxs-lookup"><span data-stu-id="defde-234">tenant</span></span> |<span data-ttu-id="defde-235">Dzierżawy katalogu, który uprawnień aplikacji żądał, w formacie GUID.</span><span class="sxs-lookup"><span data-stu-id="defde-235">The directory tenant that granted your application the permissions it requested, in GUID format.</span></span> |
| <span data-ttu-id="defde-236">state</span><span class="sxs-lookup"><span data-stu-id="defde-236">state</span></span> |<span data-ttu-id="defde-237">Wartość zawarte w żądaniu, które również zostaną zwrócone w odpowiedzi tokenu.</span><span class="sxs-lookup"><span data-stu-id="defde-237">A value included in the request that also will be returned in the token response.</span></span> <span data-ttu-id="defde-238">Można go ciągiem żadnej zawartości, który ma.</span><span class="sxs-lookup"><span data-stu-id="defde-238">It can be a string of any content you want.</span></span> <span data-ttu-id="defde-239">Stan jest używany do kodowania informacje o stanie użytkownika w aplikacji, przed wystąpieniem żądania uwierzytelniania, takich jak strony lub widok, które były na.</span><span class="sxs-lookup"><span data-stu-id="defde-239">The state is used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="defde-240">admin_consent</span><span class="sxs-lookup"><span data-stu-id="defde-240">admin_consent</span></span> |<span data-ttu-id="defde-241">Zostanie ustawiona do **true**.</span><span class="sxs-lookup"><span data-stu-id="defde-241">Will be set to **true**.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="defde-242">Odpowiedzi na błąd</span><span class="sxs-lookup"><span data-stu-id="defde-242">Error response</span></span>
<span data-ttu-id="defde-243">Jeśli administrator nie zatwierdzenia uprawnień dla aplikacji, nie powiodło się odpowiedzi wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="defde-243">If the admin does not approve the permissions for your app, the failed response looks like this:</span></span>

```
GET http://localhost/myapp/permissions?error=permission_denied&error_description=The+admin+canceled+the+request
```

| <span data-ttu-id="defde-244">Parametr</span><span class="sxs-lookup"><span data-stu-id="defde-244">Parameter</span></span> | <span data-ttu-id="defde-245">Opis</span><span class="sxs-lookup"><span data-stu-id="defde-245">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="defde-246">error</span><span class="sxs-lookup"><span data-stu-id="defde-246">error</span></span> |<span data-ttu-id="defde-247">Ciąg kodu błędu, który może służyć do klasyfikowania typy błędów występujących i może służyć do reagowania na błędy.</span><span class="sxs-lookup"><span data-stu-id="defde-247">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="defde-248">error_description</span><span class="sxs-lookup"><span data-stu-id="defde-248">error_description</span></span> |<span data-ttu-id="defde-249">Komunikat o błędzie, które mogą ułatwić dewelopera Określ przyczynę błędu.</span><span class="sxs-lookup"><span data-stu-id="defde-249">A specific error message that can help a developer identify the root cause of an error.</span></span> |

<span data-ttu-id="defde-250">Po otrzymaniu pomyślnej odpowiedzi z punktu końcowego zgody administratora, aplikację zyskały zażądała uprawnienia.</span><span class="sxs-lookup"><span data-stu-id="defde-250">After you've received a successful response from the admin consent endpoint, your app has gained the permissions it requested.</span></span> <span data-ttu-id="defde-251">Następnie może żądać tokenu dla żądanego zasobu.</span><span class="sxs-lookup"><span data-stu-id="defde-251">Next, you can request a token for the resource you want.</span></span>

## <a name="using-permissions"></a><span data-ttu-id="defde-252">Korzystając z uprawnień</span><span class="sxs-lookup"><span data-stu-id="defde-252">Using permissions</span></span>
<span data-ttu-id="defde-253">Po użytkownik wyraża zgodę na uprawnień dla aplikacji, aplikacji, mogą uzyskiwać tokeny dostępu, które reprezentują aplikacji uprawnień dostępu do zasobu w niektórych pojemności.</span><span class="sxs-lookup"><span data-stu-id="defde-253">After the user consents to permissions for your app, your app can acquire access tokens that represent your app's permission to access a resource in some capacity.</span></span> <span data-ttu-id="defde-254">Token dostępu można używać tylko do jednego zasobu, ale zakodowanych w tokenie dostępu jest uprawnienie każdej aplikacji ma przyznane dla tego zasobu.</span><span class="sxs-lookup"><span data-stu-id="defde-254">An access token can be used only for a single resource, but encoded inside the access token is every permission that your app has been granted for that resource.</span></span> <span data-ttu-id="defde-255">Uzyskanie tokenu dostępu, aplikacji ułatwia żądania tokenu punktu końcowego v2.0, jak to:</span><span class="sxs-lookup"><span data-stu-id="defde-255">To acquire an access token, your app can make a request to the v2.0 token endpoint, like this:</span></span>

```
POST common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/json

{
    "grant_type": "authorization_code",
    "client_id": "6731de76-14a6-49ae-97bc-6eba6914391e",
    "scope": "https://outlook.office.com/mail.read https://outlook.office.com/mail.send",
    "code": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq..."
    "redirect_uri": "https://localhost/myapp",
    "client_secret": "zc53fwe80980293klaj9823"  // NOTE: Only required for web apps
}
```

<span data-ttu-id="defde-256">W żądaniach HTTP do zasobu, można użyć tokenu dostępu.</span><span class="sxs-lookup"><span data-stu-id="defde-256">You can use the resulting access token in HTTP requests to the resource.</span></span> <span data-ttu-id="defde-257">Wskazuje on, niezawodnie do zasobu czy aplikacja ma odpowiednie uprawnienia do wykonywania określonych zadań.</span><span class="sxs-lookup"><span data-stu-id="defde-257">It reliably indicates to the resource that your app has the proper permission to perform a specific task.</span></span>  

<span data-ttu-id="defde-258">Aby uzyskać więcej informacji na temat protokołu OAuth 2.0 oraz pobieranie tokenów dostępu, zobacz [odwołania protokół punktu końcowego v2.0](active-directory-v2-protocols.md).</span><span class="sxs-lookup"><span data-stu-id="defde-258">For more information about the OAuth 2.0 protocol and how to get access tokens, see the [v2.0 endpoint protocol reference](active-directory-v2-protocols.md).</span></span>
