---
title: "Zagadnienia dotyczące zabezpieczeń dla serwera Proxy aplikacji usługi Azure AD | Dokumentacja firmy Microsoft"
description: "Obejmuje zagadnienia dotyczące zabezpieczeń dla przy użyciu serwera Proxy aplikacji usługi Azure AD"
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: c6ead651133eb17fd55f7567cdb14dc3bcd64245
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="security-considerations-for-accessing-apps-remotely-with-azure-ad-application-proxy"></a><span data-ttu-id="bea0b-103">Zagadnienia dotyczące zabezpieczeń w celu uzyskania dostępu do aplikacji zdalnie z serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="bea0b-103">Security considerations for accessing apps remotely with Azure AD Application Proxy</span></span>

<span data-ttu-id="bea0b-104">W tym artykule opisano, jak serwer Proxy usługi Azure Active Directory aplikacji udostępnia usługa bezpiecznego publikowania i zdalny dostęp do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-104">This article explains how Azure Active Directory Application Proxy provides a secure service for publishing and accessing your applications remotely.</span></span>

<span data-ttu-id="bea0b-105">Na poniższym diagramie przedstawiono sposób usługi Azure AD zapewnia bezpieczny dostęp zdalny do aplikacji lokalnych.</span><span class="sxs-lookup"><span data-stu-id="bea0b-105">The following diagram shows how Azure AD enables secure remote access to your on-premises applications.</span></span>

 ![Diagram bezpieczny dostęp zdalny za pośrednictwem serwera Proxy aplikacji usługi Azure AD](./media/application-proxy-security-considerations/secure-remote-access.png)

## <a name="security-benefits"></a><span data-ttu-id="bea0b-107">Korzyści w zakresie zabezpieczeń</span><span class="sxs-lookup"><span data-stu-id="bea0b-107">Security benefits</span></span>

<span data-ttu-id="bea0b-108">Serwer Proxy aplikacji usługi Azure AD zapewnia następujące korzyści zabezpieczeń:</span><span class="sxs-lookup"><span data-stu-id="bea0b-108">Azure AD Application Proxy offers the following security benefits:</span></span>

### <a name="authenticated-access"></a><span data-ttu-id="bea0b-109">Uwierzytelniony dostęp</span><span class="sxs-lookup"><span data-stu-id="bea0b-109">Authenticated access</span></span> 

<span data-ttu-id="bea0b-110">Jeśli chcesz użyć usługi Azure Active Directory wstępnego uwierzytelniania, następnie tylko uwierzytelnionego połączenia można uzyskać dostęp do sieci.</span><span class="sxs-lookup"><span data-stu-id="bea0b-110">If you choose to use Azure Active Directory preauthentication, then only authenticated connections can access your network.</span></span>

<span data-ttu-id="bea0b-111">Serwer Proxy aplikacji usługi Azure AD zależy od usługi Azure AD usługi tokenu zabezpieczającego (STS) do wszystkich uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-111">Azure AD Application Proxy relies on the Azure AD security token service (STS) for all authentication.</span></span>  <span data-ttu-id="bea0b-112">Wstępnego uwierzytelniania, ze swej natury blokuje znaczących anonimowe ataki, ponieważ tylko uwierzytelnionych tożsamości można uzyskać dostępu do aplikacji zaplecza.</span><span class="sxs-lookup"><span data-stu-id="bea0b-112">Preauthentication, by its very nature, blocks a significant number of anonymous attacks, because only authenticated identities can access the back-end application.</span></span>

<span data-ttu-id="bea0b-113">Jeśli wybierzesz Passthrough jako metody uwierzytelniania wstępnego nie pobieraj takich korzyści.</span><span class="sxs-lookup"><span data-stu-id="bea0b-113">If you choose Passthrough as your preauthentication method, you don't get this benefit.</span></span> 

### <a name="conditional-access"></a><span data-ttu-id="bea0b-114">Dostęp warunkowy</span><span class="sxs-lookup"><span data-stu-id="bea0b-114">Conditional access</span></span>

<span data-ttu-id="bea0b-115">Bardziej zaawansowane funkcje kontroli zasad należy zastosować przed ustanowiono połączenia z siecią.</span><span class="sxs-lookup"><span data-stu-id="bea0b-115">Apply richer policy controls before connections to your network are established.</span></span>

<span data-ttu-id="bea0b-116">Z [dostępu warunkowego](active-directory-conditional-access-azuread-connected-apps.md), można definiować ograniczenia, w jaki ruch jest dozwolony dostęp do Twojej aplikacji zaplecza.</span><span class="sxs-lookup"><span data-stu-id="bea0b-116">With [conditional access](active-directory-conditional-access-azuread-connected-apps.md), you can define restrictions on what traffic is allowed to access your back-end applications.</span></span> <span data-ttu-id="bea0b-117">Można utworzyć zasady, które ograniczają logowania na podstawie lokalizacji, siły uwierzytelniania i profil użytkownika ryzyka.</span><span class="sxs-lookup"><span data-stu-id="bea0b-117">You can create policies that restrict sign-ins based on location, strength of authentication, and user risk profile.</span></span>

<span data-ttu-id="bea0b-118">Dostęp warunkowy umożliwia również konfigurowanie zasad uwierzytelniania wieloskładnikowego, dodawanie dodatkową warstwę zabezpieczeń do użytkownika uwierzytelnienia użytkownika.</span><span class="sxs-lookup"><span data-stu-id="bea0b-118">You can also use conditional access to configure Multi-Factor Authentication policies, adding another layer of security to your user authentications.</span></span> 

### <a name="traffic-termination"></a><span data-ttu-id="bea0b-119">Zakończenie ruchu</span><span class="sxs-lookup"><span data-stu-id="bea0b-119">Traffic termination</span></span>

<span data-ttu-id="bea0b-120">Cały ruch zakończeniem w chmurze.</span><span class="sxs-lookup"><span data-stu-id="bea0b-120">All traffic is terminated in the cloud.</span></span>

<span data-ttu-id="bea0b-121">Ponieważ serwer Proxy aplikacji usługi Azure AD jest wstecznego serwera proxy, cały ruch do zaplecza aplikacji jest kończona na usługę.</span><span class="sxs-lookup"><span data-stu-id="bea0b-121">Because Azure AD Application Proxy is a reverse-proxy, all traffic to back-end applications is terminated at the service.</span></span> <span data-ttu-id="bea0b-122">Sesja może pobrać przywróciła tylko na serwerze zaplecza, co oznacza, że serwerów zaplecza nie są widoczne dla ruchu HTTP na bezpośrednie.</span><span class="sxs-lookup"><span data-stu-id="bea0b-122">The session can get reestablished only with the back-end server, which means that your back-end servers are not exposed to direct HTTP traffic.</span></span> <span data-ttu-id="bea0b-123">Ta konfiguracja oznacza lepszej ochrony przed atakami ukierunkowanymi.</span><span class="sxs-lookup"><span data-stu-id="bea0b-123">This configuration means that you are better protected from targeted attacks.</span></span>

### <a name="all-access-is-outbound"></a><span data-ttu-id="bea0b-124">Dostęp jest wychodzący</span><span class="sxs-lookup"><span data-stu-id="bea0b-124">All access is outbound</span></span> 

<span data-ttu-id="bea0b-125">Nie trzeba otworzyć połączenia przychodzące do sieci firmowej.</span><span class="sxs-lookup"><span data-stu-id="bea0b-125">You don't need to open inbound connections to the corporate network.</span></span>

<span data-ttu-id="bea0b-126">Łączniki serwera Proxy aplikacji należy używać tylko na połączenia wychodzące do usługi serwera Proxy aplikacji usługi Azure AD, co oznacza, że nie istnieje potrzeba aby otworzyć porty zapory dla połączeń przychodzących.</span><span class="sxs-lookup"><span data-stu-id="bea0b-126">Application Proxy connectors only use outbound connections to the Azure AD Application Proxy service, which means that there is no need to open firewall ports for incoming connections.</span></span> <span data-ttu-id="bea0b-127">Serwery proxy tradycyjnych wymagane sieci obwodowej (znanej także jako *DMZ*, *strefą zdemilitaryzowaną*, lub *podsiecią ekranowaną*) i zezwolenie na dostęp do nieuwierzytelnione połączenia na brzegu sieci.</span><span class="sxs-lookup"><span data-stu-id="bea0b-127">Traditional proxies required a perimeter network (also known as *DMZ*, *demilitarized zone*, or *screened subnet*) and allowed access to unauthenticated connections at the network edge.</span></span> <span data-ttu-id="bea0b-128">Ten scenariusz wymaga wiele dodatkowych inwestycji w produktach zapory aplikacji sieci web do analizowania ruchu i oferują ochronę dodanie do środowiska.</span><span class="sxs-lookup"><span data-stu-id="bea0b-128">This scenario required many additional investments in web application firewall products to analyze traffic and offer addition protections to the environment.</span></span> <span data-ttu-id="bea0b-129">Przy użyciu serwera Proxy aplikacji nie wymagają sieci obwodowej, ponieważ wszystkie połączenia są wychodzących i odbywać za pośrednictwem bezpiecznego kanału.</span><span class="sxs-lookup"><span data-stu-id="bea0b-129">With Application Proxy, you don't need a perimeter network because all connections are outbound and take place over a secure channel.</span></span>

<span data-ttu-id="bea0b-130">Aby uzyskać więcej informacji na temat łączników, zobacz [łączniki serwera Proxy aplikacji usługi AD zrozumieć Azure](application-proxy-understand-connectors.md).</span><span class="sxs-lookup"><span data-stu-id="bea0b-130">For more information about connectors, see [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md).</span></span>

### <a name="cloud-scale-analytics-and-machine-learning"></a><span data-ttu-id="bea0b-131">Analizy skali chmury i uczenia maszynowego</span><span class="sxs-lookup"><span data-stu-id="bea0b-131">Cloud-scale analytics and machine learning</span></span> 

<span data-ttu-id="bea0b-132">Pobierz najnowocześniejsze zabezpieczenia.</span><span class="sxs-lookup"><span data-stu-id="bea0b-132">Get cutting-edge security protection.</span></span>

<span data-ttu-id="bea0b-133">Ponieważ jest częścią usługi Azure Active Directory, mogą korzystać z serwera Proxy aplikacji [Azure AD Identity Protection](active-directory-identityprotection.md), machine learning-driven analizy i danych z programu Microsoft Security Response Center i jednostki.</span><span class="sxs-lookup"><span data-stu-id="bea0b-133">Because it's part of Azure Active Directory, Application Proxy can leverage [Azure AD Identity Protection](active-directory-identityprotection.md), with machine learning-driven intelligence and data from the Microsoft Security Response Center and Digital Crimes Unit.</span></span> <span data-ttu-id="bea0b-134">Razem możemy aktywne identyfikowanie złamany kont i zapewniają ochronę w czasie rzeczywistym z logowania o wysokim ryzyku. Firma Microsoft uwzględniać wiele czynników, takich jak dostęp z zainfekowanych urządzeń przez nadanie sieci i lokalizacje nietypowe i prawdopodobne.</span><span class="sxs-lookup"><span data-stu-id="bea0b-134">Together we proactively identify compromised accounts and offer real-time protection from high-risk sign-ins. We take into account numerous factors, such as access from infected devices, through anonymizing networks, and from atypical and unlikely locations.</span></span>

<span data-ttu-id="bea0b-135">Wiele z tych raportów i zdarzenia są już dostępne za pośrednictwem interfejsu API dla integracji z informacji o zabezpieczeniach i systemami zarządzania (SIEM) zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="bea0b-135">Many of these reports and events are already available through an API for integration with your security information and event management (SIEM) systems.</span></span>

### <a name="remote-access-as-a-service"></a><span data-ttu-id="bea0b-136">Dostęp zdalny w trybie usługi</span><span class="sxs-lookup"><span data-stu-id="bea0b-136">Remote access as a service</span></span>

<span data-ttu-id="bea0b-137">Nie trzeba martwić się o zachowaniu i stosowanie poprawek serwerów lokalnych.</span><span class="sxs-lookup"><span data-stu-id="bea0b-137">You don’t have to worry about maintaining and patching on-premises servers.</span></span>

<span data-ttu-id="bea0b-138">Konta nadal atakowany oprogramowania dla dużej liczby ataków.</span><span class="sxs-lookup"><span data-stu-id="bea0b-138">Unpatched software still accounts for a large number of attacks.</span></span> <span data-ttu-id="bea0b-139">Serwer Proxy aplikacji usługi Azure AD jest usługi Internet skalowania, która jest właścicielem firmy Microsoft, dzięki czemu zawsze uzyskać najnowsze poprawki zabezpieczeń i aktualizacje.</span><span class="sxs-lookup"><span data-stu-id="bea0b-139">Azure AD Application Proxy is an Internet-scale service that Microsoft owns, so you always get the latest security patches and upgrades.</span></span>

<span data-ttu-id="bea0b-140">Aby zwiększyć bezpieczeństwo aplikacji opublikowanych przez serwer Proxy aplikacji usługi Azure AD, firma Microsoft zablokować robotów przez przeszukiwarkę sieci web do indeksowania i archiwizowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-140">To improve the security of applications published by Azure AD Application Proxy, we block web crawler robots from indexing and archiving your applications.</span></span> <span data-ttu-id="bea0b-141">Zawsze robota przez przeszukiwarkę sieci web próbuje pobrać ustawienia robota opublikowanej aplikacji, serwer Proxy aplikacji odpowiedzi z plikiem robots.txt, która obejmuje `User-agent: * Disallow: /`.</span><span class="sxs-lookup"><span data-stu-id="bea0b-141">Each time a web crawler robot tries to retrieve the robot's settings for a published app, Application Proxy replies with a robots.txt file that includes `User-agent: * Disallow: /`.</span></span>

## <a name="under-the-hood"></a><span data-ttu-id="bea0b-142">Kulisy</span><span class="sxs-lookup"><span data-stu-id="bea0b-142">Under the hood</span></span>

<span data-ttu-id="bea0b-143">Serwer Proxy aplikacji usługi Azure AD składa się z dwóch części:</span><span class="sxs-lookup"><span data-stu-id="bea0b-143">Azure AD Application Proxy consists of two parts:</span></span>

* <span data-ttu-id="bea0b-144">Usługa oparta na chmurze: ta usługa działa na platformie Azure i jest, w których są wykonane połączeń zewnętrznych klienta/użytkownika.</span><span class="sxs-lookup"><span data-stu-id="bea0b-144">The cloud-based service: This service runs in Azure, and is where the external client/user connections are made.</span></span>
* <span data-ttu-id="bea0b-145">[Łącznik lokalnego](application-proxy-understand-connectors.md): składnik lokalnego łącznika nasłuchuje żądań z serwera Proxy aplikacji usługi Azure AD połączenia usługi i dojść do wewnętrznych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-145">[The on-premises connector](application-proxy-understand-connectors.md): An on-premises component, the connector listens for requests from the Azure AD Application Proxy service and handles connections to the internal applications.</span></span> 

<span data-ttu-id="bea0b-146">Przepływ między łącznika i usługę serwera Proxy aplikacji jest ustanawiane po:</span><span class="sxs-lookup"><span data-stu-id="bea0b-146">A flow between the connector and the Application Proxy service is established when:</span></span>

* <span data-ttu-id="bea0b-147">Najpierw skonfigurowano łącznik.</span><span class="sxs-lookup"><span data-stu-id="bea0b-147">The connector is first set up.</span></span>
* <span data-ttu-id="bea0b-148">Łącznik pobiera informacje o konfiguracji z serwera Proxy aplikacji usługi.</span><span class="sxs-lookup"><span data-stu-id="bea0b-148">The connector pulls configuration information from the Application Proxy service.</span></span>
* <span data-ttu-id="bea0b-149">Użytkownik uzyskuje dostęp do opublikowanej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-149">A user accesses a published application.</span></span>

>[!NOTE]
><span data-ttu-id="bea0b-150">Cała komunikacja odbywa się za pośrednictwem protokołu SSL, a pochodzą zawsze na łącznika serwera Proxy aplikacji usługi.</span><span class="sxs-lookup"><span data-stu-id="bea0b-150">All communications occur over SSL, and they always originate at the connector to the Application Proxy service.</span></span> <span data-ttu-id="bea0b-151">Usługa jest tylko ruchu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="bea0b-151">The service is outbound only.</span></span>

<span data-ttu-id="bea0b-152">Łącznik korzysta z certyfikatu klienta do uwierzytelniania serwera Proxy aplikacji usługi dla prawie wszystkich wywołań.</span><span class="sxs-lookup"><span data-stu-id="bea0b-152">The connector uses a client certificate to authenticate to the Application Proxy service for nearly all calls.</span></span> <span data-ttu-id="bea0b-153">Jedynym wyjątkiem od tego procesu jest kroku konfiguracji początkowej, gdy zostanie nawiązane certyfikatu klienta.</span><span class="sxs-lookup"><span data-stu-id="bea0b-153">The only exception to this process is the initial setup step, where the client certificate is established.</span></span>

### <a name="installing-the-connector"></a><span data-ttu-id="bea0b-154">Instalowanie łącznika</span><span class="sxs-lookup"><span data-stu-id="bea0b-154">Installing the connector</span></span>

<span data-ttu-id="bea0b-155">Jeśli najpierw skonfigurowano łącznik następujące zdarzenia przepływu miejsce:</span><span class="sxs-lookup"><span data-stu-id="bea0b-155">When the connector is first set up, the following flow events take place:</span></span>

1. <span data-ttu-id="bea0b-156">Rejestracja łącznika z usługą odbywa się w ramach instalacji łącznika.</span><span class="sxs-lookup"><span data-stu-id="bea0b-156">The connector registration to the service happens as part of the installation of the connector.</span></span> <span data-ttu-id="bea0b-157">Użytkownicy są monitowani o wprowadzenie poświadczeń administratora usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea0b-157">Users are prompted to enter their Azure AD admin credentials.</span></span> <span data-ttu-id="bea0b-158">Token z tego uwierzytelnienia zostanie przedstawiony w usłudze usługi serwera Proxy aplikacji usługi Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bea0b-158">The token acquired from this authentication is then presented to the Azure AD Application Proxy service.</span></span>
2. <span data-ttu-id="bea0b-159">Usługa Serwer Proxy aplikacji oblicza tokenu.</span><span class="sxs-lookup"><span data-stu-id="bea0b-159">The Application Proxy service evaluates the token.</span></span> <span data-ttu-id="bea0b-160">Gwarantuje, że użytkownik jest administratorem przedsiębiorstwa w ramach dzierżawy, który token został wystawiony dla.</span><span class="sxs-lookup"><span data-stu-id="bea0b-160">It ensures that the user is a company administrator within the tenant that the token was issued for.</span></span> <span data-ttu-id="bea0b-161">Jeśli użytkownik nie jest administratorem, proces zostanie zakończony.</span><span class="sxs-lookup"><span data-stu-id="bea0b-161">If the user is not an administrator, the process is terminated.</span></span>
3. <span data-ttu-id="bea0b-162">Łącznik generuje żądanie certyfikatu klienta i przekazuje je, wraz z token do serwera Proxy aplikacji usługi.</span><span class="sxs-lookup"><span data-stu-id="bea0b-162">The connector generates a client certificate request and passes it, along with the token, to the Application Proxy service.</span></span> <span data-ttu-id="bea0b-163">Usługa z kolei weryfikuje token i podpisuje żądanie certyfikatu klienta.</span><span class="sxs-lookup"><span data-stu-id="bea0b-163">The service in turn verifies the token and signs the client certificate request.</span></span>
4. <span data-ttu-id="bea0b-164">Łącznik korzysta z certyfikatu klienta dla przyszłych komunikacji z usługą serwera Proxy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-164">The connector uses the client certificate for future communication with the Application Proxy service.</span></span>
5. <span data-ttu-id="bea0b-165">Łącznik wykonuje początkowej ściągania danych konfiguracji systemu przez usługę za pomocą swojego certyfikatu klienta, a jest teraz gotowa do sporządzenia żądania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-165">The connector performs an initial pull of the system configuration data from the service using its client certificate, and it is now ready to take requests.</span></span>

### <a name="updating-the-configuration-settings"></a><span data-ttu-id="bea0b-166">Aktualizowanie ustawień konfiguracji</span><span class="sxs-lookup"><span data-stu-id="bea0b-166">Updating the configuration settings</span></span>

<span data-ttu-id="bea0b-167">Zawsze, gdy usługa serwera Proxy aplikacji aktualizuje ustawienia konfiguracji, następujące zdarzenia przepływu miejsce:</span><span class="sxs-lookup"><span data-stu-id="bea0b-167">Whenever the Application Proxy service updates the configuration settings, the following flow events take place:</span></span>

1. <span data-ttu-id="bea0b-168">Łącznik nawiązuje połączenie z punktem końcowym konfiguracji w ramach usługi Serwer Proxy aplikacji za pomocą swojego certyfikatu klienta.</span><span class="sxs-lookup"><span data-stu-id="bea0b-168">The connector connects to the configuration endpoint within the Application Proxy service by using its client certificate.</span></span>
2. <span data-ttu-id="bea0b-169">Po sprawdzeniu poprawności certyfikatu klienta usługi Serwer Proxy aplikacji zwraca dane konfiguracji łącznika (na przykład łącznik grupą, których łącznik powinien być częścią).</span><span class="sxs-lookup"><span data-stu-id="bea0b-169">After the client certificate has been validated, the Application Proxy service returns configuration data to the connector (for example, the connector group that the connector should be part of).</span></span>
3. <span data-ttu-id="bea0b-170">Jeśli bieżący certyfikat jest więcej niż 180 dni, łącznik generuje żądania nowego certyfikatu, które skutecznie aktualizuje certyfikat klienta na 180 dni.</span><span class="sxs-lookup"><span data-stu-id="bea0b-170">If the current certificate is more than 180 days old, the connector generates a new certificate request, which effectively updates the client certificate every 180 days.</span></span>

### <a name="accessing-published-applications"></a><span data-ttu-id="bea0b-171">Uzyskiwanie dostępu do opublikowanych aplikacji</span><span class="sxs-lookup"><span data-stu-id="bea0b-171">Accessing published applications</span></span>

<span data-ttu-id="bea0b-172">Gdy użytkownicy uzyskują dostęp do opublikowanej aplikacji, następujące zdarzenia miejsce między usługą Serwer Proxy aplikacji i łącznika serwera Proxy aplikacji:</span><span class="sxs-lookup"><span data-stu-id="bea0b-172">When users access a published application, the following events take place between the Application Proxy service and the Application Proxy connector:</span></span>

1. [<span data-ttu-id="bea0b-173">Usługa uwierzytelnia użytkownika dla aplikacji</span><span class="sxs-lookup"><span data-stu-id="bea0b-173">The service authenticates the user for the app</span></span>](#the-service-checks-the-configuration-settings-for-the-app)
2. [<span data-ttu-id="bea0b-174">Usługa umieszcza żądania w kolejce łącznika</span><span class="sxs-lookup"><span data-stu-id="bea0b-174">The service places a request in the connector queue</span></span>](#The-service-places-a-request-in-the-connector-queue)
3. [<span data-ttu-id="bea0b-175">Łącznik przetworzy żądanie z kolejki</span><span class="sxs-lookup"><span data-stu-id="bea0b-175">A connector processes the request from the queue</span></span>](#the-connector-receives-the-request-from-the-queue)
4. [<span data-ttu-id="bea0b-176">Łącznik czeka na odpowiedź</span><span class="sxs-lookup"><span data-stu-id="bea0b-176">The connector waits for a response</span></span>](#the-connector-waits-for-a-response)
5. [<span data-ttu-id="bea0b-177">Usługa strumieni danych do użytkownika</span><span class="sxs-lookup"><span data-stu-id="bea0b-177">The service streams data to the user</span></span>](#the-service-streams-data-to-the-user)

<span data-ttu-id="bea0b-178">Aby dowiedzieć się więcej na temat co ma miejsce w każdej z tych kroków, Zachowaj odczytu.</span><span class="sxs-lookup"><span data-stu-id="bea0b-178">To learn more about what takes place in each of these steps, keep reading.</span></span>


#### <a name="1-the-service-authenticates-the-user-for-the-app"></a><span data-ttu-id="bea0b-179">1. Usługa uwierzytelnia użytkownika dla aplikacji</span><span class="sxs-lookup"><span data-stu-id="bea0b-179">1. The service authenticates the user for the app</span></span>

<span data-ttu-id="bea0b-180">Jeśli skonfigurowano aplikację do używania Passthrough jako metody uwierzytelniania wstępnego, są pomijane kroki opisane w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-180">If you configured the app to use Passthrough as its preauthentication method, the steps in this section are skipped.</span></span>

<span data-ttu-id="bea0b-181">Po skonfigurowaniu aplikacji preauthenticate z usługą Azure AD, użytkownicy są przekierowywani do usługi STS Azure AD do uwierzytelniania i przeprowadzać następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="bea0b-181">If you configured the app to preauthenticate with Azure AD, users are redirected to the Azure AD STS to authenticate, and the following steps take place:</span></span>

1. <span data-ttu-id="bea0b-182">Serwer Proxy aplikacji sprawdza, czy wszystkie wymagania dotyczące zasad dostępu warunkowego dla określonej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-182">Application Proxy checks for any conditional access policy requirements for the specific application.</span></span> <span data-ttu-id="bea0b-183">Ten krok zapewnia, że użytkownik został przypisany do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-183">This step ensures that the user has been assigned to the application.</span></span> <span data-ttu-id="bea0b-184">Jeśli wymagana jest weryfikacja dwuetapowa, sekwencji uwierzytelniania monitu o drugiej metody uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-184">If two-step verification is required, the authentication sequence prompts the user for a second authentication method.</span></span>

2. <span data-ttu-id="bea0b-185">Po upływie wszystkie testy, programu Azure AD STS wystawia podpisany token aplikacji i przekierowuje użytkownika z powrotem do serwera Proxy aplikacji usługi.</span><span class="sxs-lookup"><span data-stu-id="bea0b-185">After all checks have passed, the Azure AD STS issues a signed token for the application and redirects the user back to the Application Proxy service.</span></span>

3. <span data-ttu-id="bea0b-186">Serwer Proxy aplikacji sprawdza, czy token został wystawiony dla Popraw aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-186">Application Proxy verifies that the token was issued to correct the application.</span></span> <span data-ttu-id="bea0b-187">Inne kontrole wykonuje również, takich jak sprawdzeniu, czy token został podpisany przez usługę Azure AD i jest nadal w oknie prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="bea0b-187">It performs other checks also, such as ensuring that the token was signed by Azure AD, and that it is still within the valid window.</span></span>

4. <span data-ttu-id="bea0b-188">Ustawia serwera Proxy aplikacji wystąpił pliku cookie uwierzytelniania szyfrowanego, aby wskazać, że do uwierzytelniania do aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-188">Application Proxy sets an encrypted authentication cookie to indicate that authentication to the application has occurred.</span></span> <span data-ttu-id="bea0b-189">Plik cookie zawiera znacznik czasu wygaśnięcia, oparty na token z usługi Azure AD i innych danych, takie jak nazwa użytkownika, na podstawie uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-189">The cookie includes an expiration timestamp that's based on the token from Azure AD and other data, such as the user name that the authentication is based on.</span></span> <span data-ttu-id="bea0b-190">Plik cookie jest zaszyfrowany przy użyciu klucza prywatnego znany tylko usługi Serwer Proxy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-190">The cookie is encrypted with a private key known only to the Application Proxy service.</span></span>

5. <span data-ttu-id="bea0b-191">Serwer Proxy aplikacji przekierowuje użytkownika do pierwotnie żądanego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="bea0b-191">Application Proxy redirects the user back to the originally requested URL.</span></span>

<span data-ttu-id="bea0b-192">W przypadku niepowodzenia dowolnej części kroki wstępnego uwierzytelniania użytkownika, żądanie zostanie odrzucone i użytkownika jest wyświetlany komunikat informujący o źródła problemu.</span><span class="sxs-lookup"><span data-stu-id="bea0b-192">If any part of the preauthentication steps fails, the user’s request is denied, and the user is shown a message indicating the source of the problem.</span></span>


#### <a name="2-the-service-places-a-request-in-the-connector-queue"></a><span data-ttu-id="bea0b-193">2. Usługa umieszcza żądania w kolejce łącznika</span><span class="sxs-lookup"><span data-stu-id="bea0b-193">2. The service places a request in the connector queue</span></span>

<span data-ttu-id="bea0b-194">Łączniki nie zamykaj wychodzące połączenie z usługą serwera Proxy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-194">Connectors keep an outbound connection open to the Application Proxy service.</span></span> <span data-ttu-id="bea0b-195">Gdy nadejdzie żądanie, usługa kolejkuje żądanie na jednym z otwartych połączeń dla łącznika do pobrania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-195">When a request comes in, the service queues up the request on one of the open connections for the connector to pick up.</span></span>

<span data-ttu-id="bea0b-196">Żądanie zawiera elementy z aplikacji, takich jak nagłówki żądania, danych z zaszyfrowanego pliku cookie użytkownika, dzięki czemu żądania i identyfikator żądania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-196">The request includes items from the application, such as the request headers, data from the encrypted cookie, the user making the request, and the request ID.</span></span> <span data-ttu-id="bea0b-197">Mimo że wysłaniu danych z zaszyfrowanego pliku cookie z żądaniem nie jest samego pliku cookie uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="bea0b-197">Although data from the encrypted cookie is sent with the request, the authentication cookie itself is not.</span></span>

#### <a name="3-the-connector-processes-the-request-from-the-queue"></a><span data-ttu-id="bea0b-198">3. Łącznik przetworzy żądanie z kolejki.</span><span class="sxs-lookup"><span data-stu-id="bea0b-198">3. The connector processes the request from the queue.</span></span> 

<span data-ttu-id="bea0b-199">Na podstawie żądania, serwer Proxy aplikacji wykonuje jeden z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="bea0b-199">Based on the request, Application Proxy performs one of the following actions:</span></span>

* <span data-ttu-id="bea0b-200">Jeśli żądanie jest prostą operacją (na przykład, Brak danych w treści, ponieważ jest z RESTful *UZYSKAĆ* żądania), łącznik nawiązuje połączenie wewnętrzne zasobu docelowego i czeka na odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="bea0b-200">If the request is a simple operation (for example, there is no data within the body as is with a RESTful *GET* request), the connector makes a connection to the target internal resource and then waits for a response.</span></span>

* <span data-ttu-id="bea0b-201">Jeśli żądanie ma danych skojarzonych z nim w treści (na przykład RESTful *POST* operacji), łącznik nawiązuje wychodzące połączenie przy użyciu certyfikatu klienta do wystąpienia serwera Proxy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="bea0b-201">If the request has data associated with it in the body (for example, a RESTful *POST* operation), the connector makes an outbound connection by using the client certificate to the Application Proxy instance.</span></span> <span data-ttu-id="bea0b-202">Powoduje to połączenie żądania danych i Otwórz połączenie do zasobów wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="bea0b-202">It makes this connection to request the data and open a connection to the internal resource.</span></span> <span data-ttu-id="bea0b-203">Po otrzymaniu żądania z łącznika usługi Serwer Proxy aplikacji rozpoczyna się akceptowanie zawartości od użytkownika i przekazuje dane do łącznika.</span><span class="sxs-lookup"><span data-stu-id="bea0b-203">After it receives the request from the connector, the Application Proxy service begins accepting content from the user and forwards data to the connector.</span></span> <span data-ttu-id="bea0b-204">Łącznik, z kolei przesyła dane do zasobów wewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="bea0b-204">The connector, in turn, forwards the data to the internal resource.</span></span>

#### <a name="4-the-connector-waits-for-a-response"></a><span data-ttu-id="bea0b-205">4. Łącznik czeka na odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="bea0b-205">4. The connector waits for a response.</span></span>

<span data-ttu-id="bea0b-206">Po zakończeniu żądań i przekazywanie całej zawartości wewnętrznej łącznik czeka na odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="bea0b-206">After the request and transmission of all content to the back end is complete, the connector waits for a response.</span></span>

<span data-ttu-id="bea0b-207">Po otrzymaniu odpowiedzi łącznika sprawia, że wychodzące połączenie z usługą serwera Proxy aplikacji, aby powrócić szczegółów nagłówka i rozpocząć przesyłanie strumieniowe danych zwrotnych.</span><span class="sxs-lookup"><span data-stu-id="bea0b-207">After it receives a response, the connector makes an outbound connection to the Application Proxy service, to return the header details and begin streaming the return data.</span></span>

#### <a name="5-the-service-streams-data-to-the-user"></a><span data-ttu-id="bea0b-208">5. Usługa strumieni danych do użytkownika.</span><span class="sxs-lookup"><span data-stu-id="bea0b-208">5. The service streams data to the user.</span></span> 

<span data-ttu-id="bea0b-209">Przetwarza aplikacji może występować w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="bea0b-209">Some processing of the application may occur here.</span></span> <span data-ttu-id="bea0b-210">Jeśli skonfigurowano serwer Proxy aplikacji do tłumaczenia nagłówków lub adresy URL w aplikacji, przetwarzanie odbywa się zgodnie z potrzebami w tym kroku.</span><span class="sxs-lookup"><span data-stu-id="bea0b-210">If you configured Application Proxy to translate headers or URLs in your application, that processing happens as needed during this step.</span></span>


## <a name="next-steps"></a><span data-ttu-id="bea0b-211">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="bea0b-211">Next steps</span></span>

[<span data-ttu-id="bea0b-212">Zagadnienia dotyczące topologii sieci przy użyciu serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="bea0b-212">Network topology considerations when using Azure AD Application Proxy</span></span>](application-proxy-network-topology-considerations.md)

[<span data-ttu-id="bea0b-213">Zrozumienie łączniki serwera Proxy aplikacji usługi Azure AD</span><span class="sxs-lookup"><span data-stu-id="bea0b-213">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
