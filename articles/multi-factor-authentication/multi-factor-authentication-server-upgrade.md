---
title: "Uaktualnianie serwera usługi MFA aaaAzure | Dokumentacja firmy Microsoft"
description: "Kroki i wskazówki dotyczące tooupgrade powitania serwera usługi Azure Multi-Factor Authentication tooa nowszej wersji."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 50bb8ac3-5559-4d8b-a96a-799a74978b14
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/16/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: aaa8d400e0e5f1c6be3a6d22cde6dd893ef4d546
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="upgrade-toohello-latest-azure-multi-factor-authentication-server"></a><span data-ttu-id="26312-103">Uaktualnij toohello najnowsze serwera usługi Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="26312-103">Upgrade toohello latest Azure Multi-Factor Authentication Server</span></span>

<span data-ttu-id="26312-104">W tym artykule przedstawiono hello proces uaktualniania serwera usługi Azure Multi-Factor Authentication (MFA) w wersji 6.0 lub nowszej.</span><span class="sxs-lookup"><span data-stu-id="26312-104">This article walks you through hello process of upgrading Azure Multi-Factor Authentication (MFA) Server v6.0 or higher.</span></span> <span data-ttu-id="26312-105">Tooupgrade stara wersja hello PhoneFactor Agent, należy odwoływać się za[hello uaktualnienia tooAzure PhoneFactor Agent serwera Multi-Factor Authentication](multi-factor-authentication-get-started-server-upgrade.md).</span><span class="sxs-lookup"><span data-stu-id="26312-105">If you need tooupgrade an old version of hello PhoneFactor Agent, refer too[Upgrade hello PhoneFactor Agent tooAzure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server-upgrade.md).</span></span>

<span data-ttu-id="26312-106">W przypadku uaktualniania z 6.x lub starsze toov7.x lub nowszej, wszystkie składniki zmienić too.NET .NET 2.0 4.5.</span><span class="sxs-lookup"><span data-stu-id="26312-106">If you're upgrading from v6.x or older toov7.x or newer, all components change from .NET 2.0 too.NET 4.5.</span></span> <span data-ttu-id="26312-107">Wszystkie składniki wymagają programu Microsoft Visual C++ 2015 Redistributable Update 1 lub nowszej.</span><span class="sxs-lookup"><span data-stu-id="26312-107">All components also require Microsoft Visual C++ 2015 Redistributable Update 1 or higher.</span></span> <span data-ttu-id="26312-108">powitania serwera usługi MFA Instalator instaluje obie hello x86 i x64 wersje tych składników, jeśli jeszcze nie są zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="26312-108">hello MFA Server installer installs both hello x86 and x64 versions of these components if they aren't already installed.</span></span> <span data-ttu-id="26312-109">Hello portalu użytkowników i Mobile App Web Service, uruchom na osobnych serwerach, należy najpierw tooinstall pakiety przed rozpoczęciem uaktualniania tych składników.</span><span class="sxs-lookup"><span data-stu-id="26312-109">If hello User Portal and Mobile App Web Service run on separate servers, you need tooinstall those packages before upgrading those components.</span></span> <span data-ttu-id="26312-110">Możesz wyszukać najnowszą aktualizację programu Microsoft Visual C++ 2015 Redistributable hello na powitania [Microsoft Download Center](https://www.microsoft.com/en-us/download/).</span><span class="sxs-lookup"><span data-stu-id="26312-110">You can search for hello latest Microsoft Visual C++ 2015 Redistributable update on hello [Microsoft Download Center](https://www.microsoft.com/en-us/download/).</span></span> 

## <a name="install-hello-latest-version-of-azure-mfa-server"></a><span data-ttu-id="26312-111">Zainstaluj najnowszą wersję powitania serwera usługi Azure MFA</span><span class="sxs-lookup"><span data-stu-id="26312-111">Install hello latest version of Azure MFA Server</span></span>

1. <span data-ttu-id="26312-112">Użyj instrukcji hello w [hello pobierania serwera usługi Azure Multi-Factor Authentication](multi-factor-authentication-get-started-server.md#download-the-azure-multi-factor-authentication-server) tooget hello najnowszą wersję powitania serwera usługi Azure MFA.</span><span class="sxs-lookup"><span data-stu-id="26312-112">Use hello instructions in [Download hello Azure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server.md#download-the-azure-multi-factor-authentication-server) tooget hello latest version of hello Azure MFA Server.</span></span>
2. <span data-ttu-id="26312-113">Wykonaj kopię zapasową pliku danych serwera usługi MFA hello znajdujący się w C:\Program Files\Multi-Factor Authentication Server\Data\PhoneFactor.pfdata (lokalizacja hello instalacja domyślna przyjmuje) na serwerze głównym usługi MFA.</span><span class="sxs-lookup"><span data-stu-id="26312-113">Make a backup of hello MFA Server data file located at C:\Program Files\Multi-Factor Authentication Server\Data\PhoneFactor.pfdata (assuming hello default install location) on your master MFA Server.</span></span>
3. <span data-ttu-id="26312-114">Po uruchomieniu wielu serwerów w celu zapewnienia wysokiej dostępności, zmień systemy klienckie hello uwierzytelniających toohello serwera usługi MFA, tak aby ich Zatrzymaj przesyłanie ruchu toohello serwerów, które uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="26312-114">If you run multiple servers for high availability, change hello client systems that authenticate toohello MFA Server so that they stop sending traffic toohello servers that are upgrading.</span></span> <span data-ttu-id="26312-115">Jeśli używasz usługi równoważenia obciążenia, usuwany jest serwer usługi MFA z usługi równoważenia obciążenia hello, hello uaktualniania, a następnie dodaj powitania serwera do farmy hello.</span><span class="sxs-lookup"><span data-stu-id="26312-115">If you use a load balancer, remove a MFA Server from hello load balancer, do hello upgrade, and then add hello server back into hello farm.</span></span>
4. <span data-ttu-id="26312-116">Uruchom Instalatora nowe hello na każdym serwerze usługi MFA.</span><span class="sxs-lookup"><span data-stu-id="26312-116">Run hello new installer on each MFA Server.</span></span> <span data-ttu-id="26312-117">Serwery podrzędne należy najpierw uaktualnić, ponieważ może odczytywać hello replikowana przez główny hello starego pliku danych.</span><span class="sxs-lookup"><span data-stu-id="26312-117">Upgrade subordinate servers first because they can read hello old data file being replicated by hello master.</span></span> 

  <span data-ttu-id="26312-118">Nie trzeba toouninstall bieżącego serwera usługi MFA przed uruchomiony Instalator hello.</span><span class="sxs-lookup"><span data-stu-id="26312-118">You do not need toouninstall your current MFA Server before running hello installer.</span></span> <span data-ttu-id="26312-119">Instalator Hello przeprowadza uaktualnienie w miejscu.</span><span class="sxs-lookup"><span data-stu-id="26312-119">hello installer performs an in-place upgrade.</span></span> <span data-ttu-id="26312-120">Hello ścieżka instalacji jest pobierana z rejestru hello z poprzedniej instalacji hello, więc instaluje w hello sam lokalizacji (na przykład C:\Program Files\Multi-Factor Authentication Server).</span><span class="sxs-lookup"><span data-stu-id="26312-120">hello installation path is picked up from hello registry from hello previous installation, so it installs in hello same location (for example, C:\Program Files\Multi-Factor Authentication Server).</span></span> 
  
5. <span data-ttu-id="26312-121">Jeśli zostanie wyświetlony monit o tooinstall Microsoft Visual C++ 2015 Redistributable aktualizacji pakietu, należy zaakceptować monit o hello.</span><span class="sxs-lookup"><span data-stu-id="26312-121">If you're prompted tooinstall a Microsoft Visual C++ 2015 Redistributable update package, accept hello prompt.</span></span> <span data-ttu-id="26312-122">Obie hello x86 i x64 wersje pakietów hello są zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="26312-122">Both hello x86 and x64 versions of hello package are installed.</span></span>
5. <span data-ttu-id="26312-123">Jeśli używasz hello zestawu SDK usług sieci Web, zostanie wyświetlony monit tooinstall hello nowego zestawu SDK usług sieci Web.</span><span class="sxs-lookup"><span data-stu-id="26312-123">If you use hello Web Service SDK, you are prompted tooinstall hello new Web Service SDK.</span></span> <span data-ttu-id="26312-124">Po zainstalowaniu hello nowego zestawu SDK usług sieci Web, upewnij się, że nazwa katalogu wirtualnego tego hello odpowiada hello wcześniej zainstalowane katalogu wirtualnego (na przykład MultiFactorAuthWebServiceSdk).</span><span class="sxs-lookup"><span data-stu-id="26312-124">When you install hello new Web Service SDK, make sure that hello virtual directory name matches hello previously installed virtual directory (for example, MultiFactorAuthWebServiceSdk).</span></span>
6. <span data-ttu-id="26312-125">Powtórz kroki hello na wszystkich serwerach podrzędnych.</span><span class="sxs-lookup"><span data-stu-id="26312-125">Repeat hello steps on all subordinate servers.</span></span> <span data-ttu-id="26312-126">Podwyższ poziom jednego z hello podwładnych toobe hello nowy wzorzec, a następnie uaktualnienia hello starego serwera głównego.</span><span class="sxs-lookup"><span data-stu-id="26312-126">Promote one of hello subordinates toobe hello new master, then upgrade hello old master server.</span></span> 

## <a name="upgrade-hello-user-portal"></a><span data-ttu-id="26312-127">Uaktualnij hello portalu użytkowników</span><span class="sxs-lookup"><span data-stu-id="26312-127">Upgrade hello User Portal</span></span>

1. <span data-ttu-id="26312-128">Wykonaj kopię zapasową pliku web.config hello, który znajduje się w katalogu wirtualnego hello hello lokalizacji instalacji portalu użytkowników (na przykład C:\inetpub\wwwroot\MultiFactorAuth).</span><span class="sxs-lookup"><span data-stu-id="26312-128">Make a backup of hello web.config file that is in hello virtual directory of hello User Portal installation location (for example, C:\inetpub\wwwroot\MultiFactorAuth).</span></span> <span data-ttu-id="26312-129">Wszelkie zmiany dokonane toohello motyw domyślny, należy wykonać kopię zapasową hello App_Themes\Default również folder.</span><span class="sxs-lookup"><span data-stu-id="26312-129">If any changes were made toohello default theme, make a backup of hello App_Themes\Default folder as well.</span></span> <span data-ttu-id="26312-130">Jest lepsze toocreate kopię hello domyślny folder i utworzyć nową kompozycję niż toochange hello domyślny motyw.</span><span class="sxs-lookup"><span data-stu-id="26312-130">It is better toocreate a copy of hello Default folder and create a new theme than toochange hello Default theme.</span></span>
2. <span data-ttu-id="26312-131">Jeśli hello Portal użytkowników jest uruchamiany na powitania tym samym serwerze, ponieważ hello inne składniki serwera usługi MFA hello instalacji serwera usługi MFA żąda hello tooupdate Portal użytkowników.</span><span class="sxs-lookup"><span data-stu-id="26312-131">If hello User Portal runs on hello same server as hello other MFA Server components, hello MFA Server installation prompts you tooupdate hello User Portal.</span></span> <span data-ttu-id="26312-132">Akceptowanie monitu hello i zainstaluj aktualizację portalu użytkowników hello.</span><span class="sxs-lookup"><span data-stu-id="26312-132">Accept hello prompt and install hello User Portal update.</span></span> <span data-ttu-id="26312-133">Sprawdź, czy nazwa katalogu wirtualnego tego hello odpowiada hello wcześniej zainstalowane katalogu wirtualnego (na przykład MultiFactorAuth).</span><span class="sxs-lookup"><span data-stu-id="26312-133">Check that hello virtual directory name matches hello previously installed virtual directory (for example, MultiFactorAuth).</span></span>
3. <span data-ttu-id="26312-134">W przypadku hello Portal użytkowników na osobnym serwerze, plik MultiFactorAuthenticationUserPortalSetup64.msi hello kopiowania z hello zainstalować lokalizację hello serwerów MFA i umieść je na serwer sieci web portalu użytkowników hello.</span><span class="sxs-lookup"><span data-stu-id="26312-134">If hello User Portal is on its own server, copy hello MultiFactorAuthenticationUserPortalSetup64.msi file from hello install location of one of hello MFA Servers and put it onto hello User Portal web server.</span></span> <span data-ttu-id="26312-135">Uruchom Instalatora hello.</span><span class="sxs-lookup"><span data-stu-id="26312-135">Run hello installer.</span></span> 

  <span data-ttu-id="26312-136">Jeśli wystąpi błąd określania, "Microsoft Visual C++ 2015 Redistributable Update 1 lub nowszy jest wymagany," Pobierz i zainstaluj najnowszy pakiet aktualizacji hello z hello [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="26312-136">If an error occurs stating, "Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required," download and install hello latest update package from hello [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="26312-137">Należy zainstalować obie wersje x86 i x64 hello.</span><span class="sxs-lookup"><span data-stu-id="26312-137">Install both hello x86 and x64 versions.</span></span>

4. <span data-ttu-id="26312-138">Po zaktualizowaniu portalu użytkownika jest zainstalowane oprogramowanie hello porównać hello kopii zapasowej pliku web.config, wprowadzone w kroku 1 z hello nowy plik web.config.</span><span class="sxs-lookup"><span data-stu-id="26312-138">After hello updated User Portal software is installed, compare hello web.config backup you made in step 1 with hello new web.config file.</span></span> <span data-ttu-id="26312-139">Jeśli nie istnieją żadne nowe atrybuty w pliku web.config nowe hello, skopiowany hello katalog wirtualny toooverwrite hello nowej kopii zapasowej pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="26312-139">If no new attributes exist in hello new web.config, copy your backup web.config into hello virtual directory toooverwrite hello new one.</span></span> <span data-ttu-id="26312-140">Innym rozwiązaniem jest toocopy/Wklej hello appSettings wartości i hello adres URL zestawu SDK usługi sieci Web z pliku kopii zapasowej hello do nowego pliku web.config hello.</span><span class="sxs-lookup"><span data-stu-id="26312-140">Another option is toocopy/paste hello appSettings values and hello Web Service SDK URL from hello backup file into hello new web.config.</span></span>

<span data-ttu-id="26312-141">Jeśli masz hello Portal użytkowników na wielu serwerach, powtórz hello instalacji na wszystkich z nich.</span><span class="sxs-lookup"><span data-stu-id="26312-141">If you have hello User Portal on multiple servers, repeat hello installation on all of them.</span></span> 


## <a name="upgrade-hello-mobile-app-web-service"></a><span data-ttu-id="26312-142">Uaktualnij hello Mobile App Web Service</span><span class="sxs-lookup"><span data-stu-id="26312-142">Upgrade hello Mobile App Web Service</span></span>

1. <span data-ttu-id="26312-143">Wykonaj kopię zapasową pliku web.config hello, który znajduje się w katalogu wirtualnego hello hello lokalizacji instalacji usługi Mobile App Web Service (na przykład C:\inetpub\wwwroot\app lub C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService).</span><span class="sxs-lookup"><span data-stu-id="26312-143">Make a backup of hello web.config file that is in hello virtual directory of hello Mobile App Web Service installation location (for example, C:\inetpub\wwwroot\app or C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService).</span></span>
2. <span data-ttu-id="26312-144">Kopiuj hello MultiFactorAuthenticationMobileAppWebServiceSetup64.msi plik z hello lokalizacji hello serwerów MFA instalacji i umieść je na serwer sieci web rejestracji aplikacji mobilnej hello.</span><span class="sxs-lookup"><span data-stu-id="26312-144">Copy hello MultiFactorAuthenticationMobileAppWebServiceSetup64.msi file from hello install location of hello MFA Servers and put it onto hello Mobile App registration web server.</span></span>
3. <span data-ttu-id="26312-145">Uruchom Instalatora hello.</span><span class="sxs-lookup"><span data-stu-id="26312-145">Run hello installer.</span></span> 

  <span data-ttu-id="26312-146">Jeśli wystąpi błąd informujący, że program Microsoft Visual C++ 2015 Redistributable Update 1 lub nowszy jest wymagany, Pobierz i zainstaluj najnowszy pakiet aktualizacji hello z hello [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="26312-146">If an error occurs stating that Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required, download and install hello latest update package from hello [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="26312-147">Należy zainstalować obie wersje x86 i x64 hello.</span><span class="sxs-lookup"><span data-stu-id="26312-147">Install both hello x86 and x64 versions.</span></span>

4. <span data-ttu-id="26312-148">Po zainstalowaniu oprogramowania Mobile App Web Service hello zaktualizowane Porównaj plik web.config hello utworzono kopię zapasową w kroku 1 z hello nowy plik web.config.</span><span class="sxs-lookup"><span data-stu-id="26312-148">After hello updated Mobile App Web Service software installs, compare hello web.config file that was backed up in step 1 with hello new web.config file.</span></span> <span data-ttu-id="26312-149">Jeśli nie istnieją żadne nowe atrybuty w pliku web.config nowe hello, możesz skopiować zapisanego pliku web.config wrócić do katalogu wirtualnego hello i zastąpić hello nową.</span><span class="sxs-lookup"><span data-stu-id="26312-149">If no new attributes exist in hello new web.config, you can copy your saved web.config back into hello virtual directory and overwrite hello new one.</span></span> <span data-ttu-id="26312-150">Innym rozwiązaniem jest toocopy/Wklej hello appSettings wartości i hello adres URL zestawu SDK usługi sieci Web z pliku kopii zapasowej hello do nowego pliku web.config hello.</span><span class="sxs-lookup"><span data-stu-id="26312-150">Another option is toocopy/paste hello appSettings values and hello Web Service SDK URL from hello backup file into hello new web.config.</span></span>

<span data-ttu-id="26312-151">Jeśli masz hello Mobile App Web Service na wielu serwerach, powtórz hello instalacji na wszystkich z nich.</span><span class="sxs-lookup"><span data-stu-id="26312-151">If you have hello Mobile App Web Service on multiple servers, repeat hello installation on all of them.</span></span> 

## <a name="upgrade-hello-ad-fs-adapters"></a><span data-ttu-id="26312-152">Uaktualnij hello AD FS kart</span><span class="sxs-lookup"><span data-stu-id="26312-152">Upgrade hello AD FS Adapters</span></span>


### <a name="if-mfa-runs-on-different-servers-than-ad-fs"></a><span data-ttu-id="26312-153">Jeśli uwierzytelnianie wieloskładnikowe jest uruchomiony na różnych serwerach niż usługi AD FS</span><span class="sxs-lookup"><span data-stu-id="26312-153">If MFA runs on different servers than AD FS</span></span>

<span data-ttu-id="26312-154">Te instrukcje stosowane tylko wtedy, jeśli serwer Multi-Factor Authentication należy uruchomić niezależnie od serwerów usług AD FS.</span><span class="sxs-lookup"><span data-stu-id="26312-154">These instructions only apply if you run Multi-Factor Authentication Server separately from your AD FS servers.</span></span> <span data-ttu-id="26312-155">Jeśli obie usługi są uruchamiane hello samych serwerów, Pomiń tę sekcję i przejdź toohello kroki instalacji.</span><span class="sxs-lookup"><span data-stu-id="26312-155">If both services run on hello same servers, skip this section and go toohello installation steps.</span></span> 

1. <span data-ttu-id="26312-156">Zapisz kopię pliku MultiFactorAuthenticationAdfsAdapter.config hello, który został zarejestrowany w usługach AD FS lub eksportu przy użyciu następującego polecenia programu PowerShell hello konfiguracji hello: `Export-AdfsAuthenticationProviderConfigurationData -Name [adapter name] -FilePath [path tooconfig file]`.</span><span class="sxs-lookup"><span data-stu-id="26312-156">Save a copy of hello MultiFactorAuthenticationAdfsAdapter.config file that was registered in AD FS, or export hello configuration using hello following PowerShell command: `Export-AdfsAuthenticationProviderConfigurationData -Name [adapter name] -FilePath [path tooconfig file]`.</span></span> <span data-ttu-id="26312-157">Nazwa karty Hello jest "Element WindowsAzureMultiFactorAuthentication" lub "AzureMfaServerAuthentication" w zależności od wersji hello wcześniej zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="26312-157">hello adapter name is either "WindowsAzureMultiFactorAuthentication" or "AzureMfaServerAuthentication" depending on hello version previously installed.</span></span>
2. <span data-ttu-id="26312-158">Skopiuj następujące pliki z powitania serwera usługi MFA instalacji lokalizacji toohello AD FS serwerów hello:</span><span class="sxs-lookup"><span data-stu-id="26312-158">Copy hello following files from hello MFA Server installation location toohello AD FS servers:</span></span>

  - <span data-ttu-id="26312-159">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span><span class="sxs-lookup"><span data-stu-id="26312-159">MultiFactorAuthenticationAdfsAdapterSetup64.msi</span></span>
  - <span data-ttu-id="26312-160">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="26312-160">Register-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
  - <span data-ttu-id="26312-161">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span><span class="sxs-lookup"><span data-stu-id="26312-161">Unregister-MultiFactorAuthenticationAdfsAdapter.ps1</span></span>
  - <span data-ttu-id="26312-162">MultiFactorAuthenticationAdfsAdapter.config</span><span class="sxs-lookup"><span data-stu-id="26312-162">MultiFactorAuthenticationAdfsAdapter.config</span></span>

3. <span data-ttu-id="26312-163">Edytowanie skryptu hello Register-MultiFactorAuthenticationAdfsAdapter.ps1 przez dodanie `-ConfigurationFilePath [path]` toohello koniec hello `Register-AdfsAuthenticationProvider` polecenia.</span><span class="sxs-lookup"><span data-stu-id="26312-163">Edit hello Register-MultiFactorAuthenticationAdfsAdapter.ps1 script by adding `-ConfigurationFilePath [path]` toohello end of hello `Register-AdfsAuthenticationProvider` command.</span></span> <span data-ttu-id="26312-164">Zastąp *[ścieżka]* z toohello pełną ścieżkę hello MultiFactorAuthenticationAdfsAdapter.config lub pliku konfiguracji hello wyeksportowane hello poprzedniego kroku.</span><span class="sxs-lookup"><span data-stu-id="26312-164">Replace *[path]* with hello full path toohello MultiFactorAuthenticationAdfsAdapter.config file or hello configuration file exported in hello previous step.</span></span> 

  <span data-ttu-id="26312-165">Sprawdź atrybuty hello w nowych toosee MultiFactorAuthenticationAdfsAdapter.config hello spełniające hello starego pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="26312-165">Check hello attributes in hello new MultiFactorAuthenticationAdfsAdapter.config toosee if they match hello old config file.</span></span> <span data-ttu-id="26312-166">Jeśli wszystkie atrybuty zostały dodane lub usunięte w nowej wersji hello, skopiować hello wartości atrybutów z hello starego konfiguracji pliku toohello nową lub zmodyfikować hello starego toomatch pliku konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="26312-166">If any attributes were added or removed in hello new version, copy hello attribute values from hello old configuration file toohello new one or modify hello old configuration file toomatch.</span></span>

### <a name="install-new-ad-fs-adapters"></a><span data-ttu-id="26312-167">Zainstaluj nowe karty usług AD FS</span><span class="sxs-lookup"><span data-stu-id="26312-167">Install new AD FS adapters</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="26312-168">Użytkownicy nie będą wymagane tooperform weryfikacji dwuetapowej etapach 3 – 8 przedstawione w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="26312-168">Your users will not be required tooperform two-step verification during steps 3-8 of this section.</span></span> <span data-ttu-id="26312-169">Jeśli masz usługi AD FS w wielu klastrów, można usunąć, uaktualniania i przywracanie poszczególnych klastrów w hello farmy niezależnie od hello inne klastry tooavoid przestoju.</span><span class="sxs-lookup"><span data-stu-id="26312-169">If you have AD FS configured in multiple clusters, you can remove, upgrade, and restore each cluster in hello farm independently of hello other clusters tooavoid downtime.</span></span>

1. <span data-ttu-id="26312-170">Usuń niektóre serwery usług AD FS z hello farmy.</span><span class="sxs-lookup"><span data-stu-id="26312-170">Remove some AD FS servers from hello farm.</span></span> <span data-ttu-id="26312-171">Zaktualizuj te serwery podczas hello, które nadal działają inne osoby.</span><span class="sxs-lookup"><span data-stu-id="26312-171">Update these servers while hello others are still running.</span></span>
2. <span data-ttu-id="26312-172">Zainstaluj nowy adapter AD FS hello na każdym serwerze usunięte z hello AD FS farmy.</span><span class="sxs-lookup"><span data-stu-id="26312-172">Install hello new AD FS adapter on each server removed from hello AD FS farm.</span></span> <span data-ttu-id="26312-173">Jeśli powitania serwera usługi MFA jest zainstalowany na każdym serwerze usług AD FS, możesz je zaktualizować za pomocą serwera usługi MFA Witaj, Administratorze UX.</span><span class="sxs-lookup"><span data-stu-id="26312-173">If hello MFA Server is installed on each AD FS server, you can update through hello MFA Server admin UX.</span></span> <span data-ttu-id="26312-174">W przeciwnym razie należy zaktualizować, uruchamiając MultiFactorAuthenticationAdfsAdapterSetup64.msi.</span><span class="sxs-lookup"><span data-stu-id="26312-174">Otherwise, update by running MultiFactorAuthenticationAdfsAdapterSetup64.msi.</span></span> 

  <span data-ttu-id="26312-175">Jeśli wystąpi błąd określania, "Microsoft Visual C++ 2015 Redistributable Update 1 lub nowszy jest wymagany," Pobierz i zainstaluj najnowszy pakiet aktualizacji hello z hello [Microsoft Download Center](https://www.microsoft.com/download/).</span><span class="sxs-lookup"><span data-stu-id="26312-175">If an error occurs stating, "Microsoft Visual C++ 2015 Redistributable Update 1 or higher is required," download and install hello latest update package from hello [Microsoft Download Center](https://www.microsoft.com/download/).</span></span> <span data-ttu-id="26312-176">Należy zainstalować obie wersje x86 i x64 hello.</span><span class="sxs-lookup"><span data-stu-id="26312-176">Install both hello x86 and x64 versions.</span></span>

3. <span data-ttu-id="26312-177">Przejdź za**usług AD FS** > **zasady uwierzytelniania** > **Edytuj globalne zasady uwierzytelniania Wieloskładnikowa**.</span><span class="sxs-lookup"><span data-stu-id="26312-177">Go too**AD FS** > **Authentication Policies** > **Edit Global MultiFactor Authentication Policy**.</span></span> <span data-ttu-id="26312-178">Usuń zaznaczenie pola wyboru **element WindowsAzureMultiFactorAuthentication** lub **AzureMFAServerAuthentication** (w zależności od hello zainstalowaną bieżącą wersję).</span><span class="sxs-lookup"><span data-stu-id="26312-178">Uncheck **WindowsAzureMultiFactorAuthentication** or **AzureMFAServerAuthentication** (depending on hello current version installed).</span></span> 

  <span data-ttu-id="26312-179">Po wykonaniu tego kroku weryfikację dwuetapową, za pomocą serwera usługi MFA jest niedostępna w tym klastrze usług AD FS dopiero po wykonaniu kroku 8.</span><span class="sxs-lookup"><span data-stu-id="26312-179">Once this step is complete, two-step verification through MFA Server is not available in this AD FS cluster until you complete step 8.</span></span>

4. <span data-ttu-id="26312-180">Wyrejestrowywanie hello starszej wersji hello AD FS karty, uruchamiając skrypt programu PowerShell Unregister-MultiFactorAuthenticationAdfsAdapter.ps1 hello.</span><span class="sxs-lookup"><span data-stu-id="26312-180">Unregister hello older version of hello AD FS adapter by running hello Unregister-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell script.</span></span> <span data-ttu-id="26312-181">Upewnij się, że hello *— nazwa* parametr ("Element WindowsAzureMultiFactorAuthentication" lub "AzureMFAServerAuthentication") odpowiada nazwie hello, który był wyświetlany w kroku 3.</span><span class="sxs-lookup"><span data-stu-id="26312-181">Ensure that hello *-Name* parameter (either “WindowsAzureMultiFactorAuthentication” or "AzureMFAServerAuthentication") matches hello name that was displayed in step 3.</span></span> <span data-ttu-id="26312-182">Dotyczy to serwery tooall hello tego samego AD FS klastra, ponieważ konfiguracja centralnych.</span><span class="sxs-lookup"><span data-stu-id="26312-182">This applies tooall servers in hello same AD FS cluster since there is a central configuration.</span></span>
5. <span data-ttu-id="26312-183">Zarejestruj nowy adapter AD FS hello za pomocą skryptu PowerShell Register-MultiFactorAuthenticationAdfsAdapter.ps1 hello.</span><span class="sxs-lookup"><span data-stu-id="26312-183">Register hello new AD FS adapter by running hello Register-MultiFactorAuthenticationAdfsAdapter.ps1 PowerShell script.</span></span> <span data-ttu-id="26312-184">Dotyczy to serwery tooall hello tego samego AD FS klastra, ponieważ konfiguracja centralnych.</span><span class="sxs-lookup"><span data-stu-id="26312-184">This applies tooall servers in hello same AD FS cluster since there is a central configuration.</span></span>
6. <span data-ttu-id="26312-185">Witaj ponownego uruchomienia usług AD FS na każdym serwerze usunięte z hello farma usług AD FS.</span><span class="sxs-lookup"><span data-stu-id="26312-185">Restart hello AD FS service on each server removed from hello AD FS farm.</span></span>
7. <span data-ttu-id="26312-186">Dodaj, Usuń hello hello farmy serwerów i serwerów hello zaktualizowane kopii toohello AD FS farmy.</span><span class="sxs-lookup"><span data-stu-id="26312-186">Add hello updated servers back toohello AD FS farm and remove hello other servers from hello farm.</span></span>
8. <span data-ttu-id="26312-187">Przejdź za**usług AD FS** > **zasady uwierzytelniania** > **Edytuj globalne zasady uwierzytelniania Wieloskładnikowa**.</span><span class="sxs-lookup"><span data-stu-id="26312-187">Go too**AD FS** > **Authentication Policies** > **Edit Global MultiFactor Authentication Policy**.</span></span> <span data-ttu-id="26312-188">Sprawdź **AzureMfaServerAuthentication**.</span><span class="sxs-lookup"><span data-stu-id="26312-188">Check **AzureMfaServerAuthentication**.</span></span>
9. <span data-ttu-id="26312-189">Powtórz krok 2 tooupdate hello serwerów, teraz są usuwane z hello AD FS farmy i ponownie uruchom program hello AD FS usługi na tych serwerach.</span><span class="sxs-lookup"><span data-stu-id="26312-189">Repeat step 2 tooupdate hello servers now removed from hello AD FS farm and restart hello AD FS service on those servers.</span></span>
10. <span data-ttu-id="26312-190">Dodaj tych serwerów do farmy hello usług AD FS.</span><span class="sxs-lookup"><span data-stu-id="26312-190">Add those servers back into hello AD FS farm.</span></span>

## <a name="next-steps"></a><span data-ttu-id="26312-191">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="26312-191">Next steps</span></span>

- <span data-ttu-id="26312-192">Pobierz przykłady [zaawansowanych scenariuszy z usługi Azure Multi-Factor Authentication i sieci VPN innych firm](multi-factor-authentication-advanced-vpn-configurations.md)</span><span class="sxs-lookup"><span data-stu-id="26312-192">Get examples of [Advanced scenarios with Azure Multi-Factor Authentication and third-party VPNs](multi-factor-authentication-advanced-vpn-configurations.md)</span></span>

- [<span data-ttu-id="26312-193">Synchronizowanie serwera usługi MFA z usługi Active Directory systemu Windows Server</span><span class="sxs-lookup"><span data-stu-id="26312-193">Synchronize MFA Server with Windows Server Active Directory</span></span>](multi-factor-authentication-get-started-server-dirint.md)

- <span data-ttu-id="26312-194">[Skonfiguruj uwierzytelnianie systemu Windows](multi-factor-authentication-get-started-server-windows.md) dla aplikacji</span><span class="sxs-lookup"><span data-stu-id="26312-194">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications</span></span>
