---
title: "aaaConfigure hello rozszerzenia usługi Azure MFA NPS | Dokumentacja firmy Microsoft"
description: "Po zainstalowaniu rozszerzenia serwera NPS hello, wykonaj następujące kroki dla konfiguracji zaawansowanej, takich jak listę dozwolonych podobnej IP i nazwy UPN zastąpienia."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="5732a-103">Zaawansowane opcje konfiguracji hello rozszerzenia serwera NPS uwierzytelnianie wieloskładnikowe</span><span class="sxs-lookup"><span data-stu-id="5732a-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="5732a-104">Witaj rozszerzenia serwera zasad sieciowych (NPS) obejmuje funkcje usługi Azure Multi-Factor Authentication oparte na chmurze infrastruktury lokalnej.</span><span class="sxs-lookup"><span data-stu-id="5732a-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="5732a-105">W tym artykule założono, że już zostały zainstalowane rozszerzenia hello i ma teraz tooknow jak wymaga rozszerzenia hello toocustomize dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="5732a-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="5732a-106">Alternatywnego Identyfikatora logowania</span><span class="sxs-lookup"><span data-stu-id="5732a-106">Alternate login ID</span></span>

<span data-ttu-id="5732a-107">Ponieważ hello rozszerzenia serwera NPS łączy tooboth lokalnie i w chmurze katalogów, mogą wystąpić problem, gdy nie są zgodne hello nazwy w chmurze hello sieci lokalnych głównych nazw użytkowników (UPN).</span><span class="sxs-lookup"><span data-stu-id="5732a-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="5732a-108">toosolve ten problem, użyj logowania alternatywnych identyfikatorów.</span><span class="sxs-lookup"><span data-stu-id="5732a-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="5732a-109">W ramach hello rozszerzenia serwera zasad Sieciowych można wyznaczyć toobe atrybut usługi Active Directory używany zamiast hello UPN dla usługi Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="5732a-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="5732a-110">Umożliwia to możesz tooprotect zasobami lokalnymi w trakcie weryfikacji dwuetapowej bez modyfikowania nazwy UPN użytkownika lokalnego.</span><span class="sxs-lookup"><span data-stu-id="5732a-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="5732a-111">alternatywne nazwy logowania tooconfigure identyfikatory, przejdź za`HKLM\SOFTWARE\Microsoft\AzureMfa` i edytować hello następujące wartości rejestru:</span><span class="sxs-lookup"><span data-stu-id="5732a-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="5732a-112">Nazwa</span><span class="sxs-lookup"><span data-stu-id="5732a-112">Name</span></span> | <span data-ttu-id="5732a-113">Typ</span><span class="sxs-lookup"><span data-stu-id="5732a-113">Type</span></span> | <span data-ttu-id="5732a-114">Wartość domyślna</span><span class="sxs-lookup"><span data-stu-id="5732a-114">Default value</span></span> | <span data-ttu-id="5732a-115">Opis</span><span class="sxs-lookup"><span data-stu-id="5732a-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="5732a-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="5732a-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="5732a-117">Ciąg</span><span class="sxs-lookup"><span data-stu-id="5732a-117">string</span></span> | <span data-ttu-id="5732a-118">pusty</span><span class="sxs-lookup"><span data-stu-id="5732a-118">Empty</span></span> | <span data-ttu-id="5732a-119">Wyznaczanie hello nazwa atrybutu usługi Active Directory, które mają toouse zamiast hello głównej nazwy użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5732a-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="5732a-120">Ten atrybut jest używany jako atrybut AlternateLoginId hello.</span><span class="sxs-lookup"><span data-stu-id="5732a-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="5732a-121">Jeśli ta wartość rejestru jest ustawiona tooa [nieprawidłowy atrybut usługi Active Directory](https://msdn.microsoft.com/library/ms675090.aspx) (na przykład poczty lub nazwa wyświetlana), następnie wartość atrybutu hello jest używany zamiast nazwy UPN użytkownika hello do uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="5732a-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="5732a-122">Jeśli ta wartość rejestru jest pusty lub nie skonfigurowane, następnie AlternateLoginId jest wyłączone i nazwy UPN użytkownika hello jest używany do uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="5732a-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="5732a-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="5732a-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="5732a-124">Wartość logiczna</span><span class="sxs-lookup"><span data-stu-id="5732a-124">boolean</span></span> | <span data-ttu-id="5732a-125">False</span><span class="sxs-lookup"><span data-stu-id="5732a-125">False</span></span> | <span data-ttu-id="5732a-126">Użyj tej flagi tooforce hello korzystania z wykazu globalnego dla wyszukiwań LDAP podczas wyszukiwania AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="5732a-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="5732a-127">Konfigurowanie kontrolera domeny jako wykazu globalnego, Dodaj hello AlternateLoginId atrybutu toohello wykazu globalnego, a następnie włącz tej flagi.</span><span class="sxs-lookup"><span data-stu-id="5732a-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="5732a-128">Skonfigurowanie (nie jest pusty), LDAP_LOOKUP_FORESTS **ta flaga jest wymuszana jako true**, niezależnie od wartości hello hello ustawienie rejestru.</span><span class="sxs-lookup"><span data-stu-id="5732a-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="5732a-129">W takim przypadku hello rozszerzenia serwera NPS wymaga toobe wykazu globalnego hello skonfigurowana z atrybutem AlternateLoginId powitania dla każdego lasu.</span><span class="sxs-lookup"><span data-stu-id="5732a-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="5732a-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="5732a-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="5732a-131">Ciąg</span><span class="sxs-lookup"><span data-stu-id="5732a-131">string</span></span> | <span data-ttu-id="5732a-132">pusty</span><span class="sxs-lookup"><span data-stu-id="5732a-132">Empty</span></span> | <span data-ttu-id="5732a-133">Podaj Rozdzielana średnikami lista toosearch lasów.</span><span class="sxs-lookup"><span data-stu-id="5732a-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="5732a-134">Na przykład *contoso.com;foobar.com*. Jeśli ta wartość rejestru jest skonfigurowany, hello rozszerzenia serwera NPS wielokrotnie powtarzane wyszukuje wszystkich lasach hello hello kolejności, w jakiej zostały wymienione i zwraca hello pierwszego pomyślnego AlternateLoginId wartość.</span><span class="sxs-lookup"><span data-stu-id="5732a-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="5732a-135">Jeśli ta wartość rejestru nie jest skonfigurowane, wyszukiwanie AlternateLoginId hello jest zamkniętej toohello bieżącej domeny.</span><span class="sxs-lookup"><span data-stu-id="5732a-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="5732a-136">tootroubleshoot problemy z logowaniem alternatywnych identyfikatorów, użyj hello zalecane kroki [alternatywny błędy identyfikator logowania](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="5732a-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="5732a-137">Wyjątki IP</span><span class="sxs-lookup"><span data-stu-id="5732a-137">IP exceptions</span></span>

<span data-ttu-id="5732a-138">Jeśli potrzebujesz toomonitor dostępności serwera, takich jak Jeśli moduły równoważenia obciążenia Sprawdź serwerów, które są uruchomione przed wysłaniem obciążeń, nie ma tych toobe kontroli zablokowane przez weryfikację żądania.</span><span class="sxs-lookup"><span data-stu-id="5732a-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="5732a-139">Zamiast tego Utwórz listę adresów IP, które są używane przez konta usług i wyłączyć wymagania uwierzytelniania wieloskładnikowego dla tej listy.</span><span class="sxs-lookup"><span data-stu-id="5732a-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="5732a-140">Lista dozwolonych adresów IP tooconfigure go za`HKLM\SOFTWARE\Microsoft\AzureMfa` i skonfigurować hello następujące wartości rejestru:</span><span class="sxs-lookup"><span data-stu-id="5732a-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="5732a-141">Nazwa</span><span class="sxs-lookup"><span data-stu-id="5732a-141">Name</span></span> | <span data-ttu-id="5732a-142">Typ</span><span class="sxs-lookup"><span data-stu-id="5732a-142">Type</span></span> | <span data-ttu-id="5732a-143">Wartość domyślna</span><span class="sxs-lookup"><span data-stu-id="5732a-143">Default value</span></span> | <span data-ttu-id="5732a-144">Opis</span><span class="sxs-lookup"><span data-stu-id="5732a-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="5732a-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="5732a-145">IP_WHITELIST</span></span> | <span data-ttu-id="5732a-146">Ciąg</span><span class="sxs-lookup"><span data-stu-id="5732a-146">string</span></span> | <span data-ttu-id="5732a-147">pusty</span><span class="sxs-lookup"><span data-stu-id="5732a-147">Empty</span></span> | <span data-ttu-id="5732a-148">Podaj Rozdzielana średnikami lista adresów IP.</span><span class="sxs-lookup"><span data-stu-id="5732a-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="5732a-149">Obejmują hello adresy IP maszyn, których pochodzą żądania obsługi, takie jak hello serwera NAS lub sieć VPN.</span><span class="sxs-lookup"><span data-stu-id="5732a-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="5732a-150">Zakresy adresów IP to podsieci nie są obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="5732a-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="5732a-151">Na przykład *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="5732a-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="5732a-152">Gdy nadejdzie żądanie z adresu IP w dozwolonych hello, weryfikację dwuetapową zostało pominięte.</span><span class="sxs-lookup"><span data-stu-id="5732a-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="5732a-153">Witaj lista dozwolonych adresów IP jest porównywany toohello adres IP, który znajduje się w hello *ratNASIPAddress* atrybutu hello żądań RADIUS.</span><span class="sxs-lookup"><span data-stu-id="5732a-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="5732a-154">Gdy nadejdzie żądanie usługi RADIUS bez atrybutu ratNASIPAddress hello hello następujące ostrzeżenie jest rejestrowane: "Dozwolonych P_WHITE_LIST_WARNING::IP zostanie zignorowany ponieważ brakuje źródłowy adres IP, w żądaniu RADIUS w atrybucie NasIpAddress."</span><span class="sxs-lookup"><span data-stu-id="5732a-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="5732a-155">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="5732a-155">Next steps</span></span>

[<span data-ttu-id="5732a-156">Komunikatami o błędach z hello rozszerzenia serwera NPS uwierzytelnianie wieloskładnikowe Azure</span><span class="sxs-lookup"><span data-stu-id="5732a-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
