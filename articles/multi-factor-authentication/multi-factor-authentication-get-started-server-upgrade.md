---
title: "Uaktualnianie narzędzia PhoneFactor do serwera Azure MFA | Microsoft Docs"
description: Rozpoczynanie pracy z serwerem Azure MFA podczas uaktualniania ze starszej wersji agenta PhoneFactor.
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
editor: yossib
ms.assetid: 42838ff7-bdf2-4d06-bacc-b3839a00cd76
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/06/2017
ms.author: kgremban
ms.openlocfilehash: 7ab7e693909f807781744ae53eed75d425096590
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="upgrade-the-phonefactor-agent-to-azure-multi-factor-authentication-server"></a><span data-ttu-id="d2221-103">Uaktualnianie agenta PhoneFactor do serwera Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="d2221-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="d2221-104">Aby uaktualnić agenta PhoneFactor (w wersji 5.x lub starszej) do serwera Azure Multi-Factor Authentication, najpierw odinstaluj agenta PhoneFactor i powiązane z nim składniki.</span><span class="sxs-lookup"><span data-stu-id="d2221-104">To upgrade the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span></span> <span data-ttu-id="d2221-105">Następnie można zainstalować serwer Multi-Factor Authentication i powiązane z nim składniki.</span><span class="sxs-lookup"><span data-stu-id="d2221-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span></span>

## <a name="uninstall-the-phonefactor-agent"></a><span data-ttu-id="d2221-106">Odinstalowywanie agenta PhoneFactor</span><span class="sxs-lookup"><span data-stu-id="d2221-106">Uninstall the PhoneFactor Agent</span></span>

1. <span data-ttu-id="d2221-107">Najpierw należy utworzyć kopię zapasową pliku danych PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="d2221-107">First, back up the PhoneFactor data file.</span></span> <span data-ttu-id="d2221-108">Domyślna lokalizacja instalacji to C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span><span class="sxs-lookup"><span data-stu-id="d2221-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span></span>

2. <span data-ttu-id="d2221-109">Jeśli zainstalowano portal użytkowników:</span><span class="sxs-lookup"><span data-stu-id="d2221-109">If the User Portal is installed:</span></span>
  1. <span data-ttu-id="d2221-110">Przejdź do folderu instalacji i utwórz kopię zapasową pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-110">Navigate to the install folder and back up the web.config file.</span></span> <span data-ttu-id="d2221-111">Domyślna lokalizacja instalacji to C:\inetpub\wwwroot\PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="d2221-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span></span>

  2. <span data-ttu-id="d2221-112">Jeśli do portalu dodano niestandardowe kompozycje, należy wykonać kopię zapasową niestandardowego folderu poniżej katalogu C:\inetpub\wwwroot\PhoneFactor\App_Themes.</span><span class="sxs-lookup"><span data-stu-id="d2221-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span></span>

  3. <span data-ttu-id="d2221-113">Odinstaluj portal użytkowników za pośrednictwem agenta PhoneFactor (opcja dostępna tylko wtedy, gdy jest zainstalowany na tym samym serwerze co agent PhoneFactor) lub za pomocą modułu Programy i funkcje systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d2221-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span></span>

3. <span data-ttu-id="d2221-114">Jeśli zainstalowana jest usługa sieci Web aplikacji mobilnej:</span><span class="sxs-lookup"><span data-stu-id="d2221-114">If the Mobile App Web Service is installed:</span></span>

  1. <span data-ttu-id="d2221-115">Przejdź do folderu instalacyjnego i utwórz kopię zapasową pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-115">Go to the install folder and back up the web.config file.</span></span> <span data-ttu-id="d2221-116">Domyślna lokalizacja instalacji to C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span><span class="sxs-lookup"><span data-stu-id="d2221-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span></span>

  2. <span data-ttu-id="d2221-117">Odinstaluj usługę sieci Web aplikacji mobilnej za pośrednictwem modułu Programy i funkcje systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d2221-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span></span>

4. <span data-ttu-id="d2221-118">Jeśli zainstalowano zestaw SDK usługi sieci Web, należy go odinstalować za pomocą agenta PhoneFactor lub za pośrednictwem modułu Programy i funkcje systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d2221-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span></span>

5. <span data-ttu-id="d2221-119">Odinstaluj agenta PhoneFactor za pośrednictwem modułu Programy i funkcje systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="d2221-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span></span>

## <a name="install-the-multi-factor-authentication-server"></a><span data-ttu-id="d2221-120">Instalowanie serwera Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="d2221-120">Install the Multi-Factor Authentication Server</span></span>

<span data-ttu-id="d2221-121">Ścieżka instalacji jest pobierana z rejestru z poprzedniej instalacji agenta PhoneFactor, dlatego instalacji należy dokonać w tej samej lokalizacji (np. C:\Program Files\PhoneFactor).</span><span class="sxs-lookup"><span data-stu-id="d2221-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (for example, C:\Program Files\PhoneFactor).</span></span> <span data-ttu-id="d2221-122">Nowe instalacje mają inne domyślne ścieżki instalacji (np. C:\Program Files\Multi-Factor Authentication Server).</span><span class="sxs-lookup"><span data-stu-id="d2221-122">New installations have a different default install path (for example, C:\Program Files\Multi-Factor Authentication Server).</span></span> <span data-ttu-id="d2221-123">Plik danych pozostawiony przez poprzedniego agenta PhoneFactor należy uaktualnić podczas instalacji, aby po zainstalowaniu nowego serwera Multi-Factor Authentication określeni wcześniej użytkownicy i ustawienia nadal były dostępne.</span><span class="sxs-lookup"><span data-stu-id="d2221-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span></span>

1. <span data-ttu-id="d2221-124">Jeśli zostanie wyświetlony monit, uaktywnij serwer Multi-Factor Authentication i upewnij się, że jest przypisany do odpowiedniej grupy replikacji.</span><span class="sxs-lookup"><span data-stu-id="d2221-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span></span>

2. <span data-ttu-id="d2221-125">Jeśli wcześniej zainstalowano zestaw SDK usługi sieci Web, należy zainstalować nowy zestaw SDK usługi sieci Web za pomocą interfejsu użytkownika serwera Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="d2221-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="d2221-126">Domyślną nazwą katalogu wirtualnego jest teraz **MultiFactorAuthWebServiceSdk** zamiast **PhoneFactorWebServiceSdk**.</span><span class="sxs-lookup"><span data-stu-id="d2221-126">The default virtual directory name is now **MultiFactorAuthWebServiceSdk** instead of **PhoneFactorWebServiceSdk**.</span></span> <span data-ttu-id="d2221-127">Jeśli chcesz użyć poprzedniej nazwy, musisz podczas instalacji zmienić nazwę katalogu wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="d2221-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="d2221-128">W przeciwnym razie, jeśli zezwolisz procesowi instalacji na użycie nowej nazwy domyślnej, trzeba będzie zmienić adres URL w każdej aplikacji, która odwołuje się do zestawu SDK usługi internetowej, takiej jak portal użytkowników i usługa internetowa aplikacji mobilnej, aby wskazywała na poprawną lokalizację.</span><span class="sxs-lookup"><span data-stu-id="d2221-128">Otherwise, if you allow the install to use the new default name, you have to change the URL in any applications that reference the Web Service SDK (like the User Portal and Mobile App Web Service) to point at the correct location.</span></span>

3. <span data-ttu-id="d2221-129">Jeśli wcześniej zainstalowano portal użytkowników na tym serwerze agenta PhoneFactor, zainstaluj nowy portal użytkowników usługi Multi-Factor Authentication za pomocą interfejsu użytkownika serwera Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="d2221-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="d2221-130">Domyślną nazwą katalogu wirtualnego jest teraz **MultiFactorAuth** zamiast **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="d2221-130">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="d2221-131">Jeśli chcesz użyć poprzedniej nazwy, musisz podczas instalacji zmienić nazwę katalogu wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="d2221-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="d2221-132">W przeciwnym razie, jeśli zezwolisz procesowi instalacji na użycie nowej nazwy domyślnej, musisz kliknąć ikonę Portal użytkowników na serwerze Multi-Factor Authentication i zaktualizować adres URL portalu użytkowników na karcie Ustawienia.</span><span class="sxs-lookup"><span data-stu-id="d2221-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span>

4. <span data-ttu-id="d2221-133">Jeśli portal użytkowników i/lub usługa sieci Web aplikacji mobilnej zostały wcześniej zainstalowane na innym serwerze z agenta PhoneFactor:</span><span class="sxs-lookup"><span data-stu-id="d2221-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span></span>

  1. <span data-ttu-id="d2221-134">Przejdź do lokalizacji instalacji (np. C:\Program Files\PhoneFactor) i skopiuj jeden lub więcej plików instalacyjnych na inny serwer.</span><span class="sxs-lookup"><span data-stu-id="d2221-134">Go to the install location (for example, C:\Program Files\PhoneFactor) and copy one or more installers to the other server.</span></span> <span data-ttu-id="d2221-135">Zarówno dla portalu użytkowników, jak i dla usługi sieci Web aplikacji mobilnej istnieją instalatory w wersji 32-bitowej i 64-bitowej.</span><span class="sxs-lookup"><span data-stu-id="d2221-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span></span> <span data-ttu-id="d2221-136">Mają one nazwy MultiFactorAuthenticationUserPortalSetupXX.msi i MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="d2221-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

  2. <span data-ttu-id="d2221-137">Aby zainstalować portal użytkowników na serwerze sieci Web, otwórz wiersz polecenia jako administrator i uruchom instalatora MultiFactorAuthenticationUserPortalSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="d2221-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span></span>

    <span data-ttu-id="d2221-138">Domyślną nazwą katalogu wirtualnego jest teraz **MultiFactorAuth** zamiast **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="d2221-138">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="d2221-139">Jeśli chcesz użyć poprzedniej nazwy, musisz podczas instalacji zmienić nazwę katalogu wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="d2221-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="d2221-140">W przeciwnym razie, jeśli zezwolisz procesowi instalacji na użycie nowej nazwy domyślnej, musisz kliknąć ikonę Portal użytkowników na serwerze Multi-Factor Authentication i zaktualizować adres URL portalu użytkowników na karcie Ustawienia.</span><span class="sxs-lookup"><span data-stu-id="d2221-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span> <span data-ttu-id="d2221-141">Istniejących użytkowników trzeba poinformować o nowym adresie URL.</span><span class="sxs-lookup"><span data-stu-id="d2221-141">Existing users need to be informed of the new URL.</span></span>

  3. <span data-ttu-id="d2221-142">Przejdź do lokalizacji instalacji portalu użytkowników (np. C:\inetpub\wwwroot\MultiFactorAuth) i otwórz do edycji plik web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-142">Go to the User Portal install location (for example, C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span></span> <span data-ttu-id="d2221-143">Z oryginalnego pliku web.config, który został umieszczony w kopii zapasowej przed uaktualnieniem, skopiuj wartości z sekcji appSettings i applicationSettings do nowego pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-143">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span></span> <span data-ttu-id="d2221-144">Jeśli nowa domyślna nazwa katalogu wirtualnego została zachowana podczas instalacji zestawu SDK usługi sieci Web, zmień adres URL w sekcji applicationSettings, aby wskazywał poprawną lokalizację.</span><span class="sxs-lookup"><span data-stu-id="d2221-144">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="d2221-145">Jeśli w poprzednim pliku web.config zostały zmienione inne wartości domyślne, zastosuj te same zmiany w nowym pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-145">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

  4. <span data-ttu-id="d2221-146">Aby zainstalować usługę sieci Web aplikacji mobilnej na serwerze sieci Web, otwórz wiersz polecenia jako administrator i uruchom instalatora MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="d2221-146">To install the Mobile App Web Service on the web server, open a command prompt as an administrator and run the MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

    <span data-ttu-id="d2221-147">Domyślną nazwą katalogu wirtualnego jest teraz **MultiFactorAuthMobileAppWebService** zamiast **PhoneFactorPhoneAppWebService**.</span><span class="sxs-lookup"><span data-stu-id="d2221-147">The default virtual directory name is now **MultiFactorAuthMobileAppWebService** instead of **PhoneFactorPhoneAppWebService**.</span></span> <span data-ttu-id="d2221-148">Jeśli chcesz użyć poprzedniej nazwy, musisz podczas instalacji zmienić nazwę katalogu wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="d2221-148">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="d2221-149">Można wybrać krótszą nazwę, aby ułatwić użytkownikom końcowym wpisywanie jej w urządzeniach przenośnych.</span><span class="sxs-lookup"><span data-stu-id="d2221-149">You may want to choose a shorter name to make it easy for end users to type in on their mobile devices.</span></span> <span data-ttu-id="d2221-150">W przeciwnym razie, jeśli zezwolisz procesowi instalacji na użycie nowej nazwy domyślnej, kliknij ikonę aplikację mobilnej na serwerze Multi-Factor Authentication i zaktualizuj adres URL usługi sieci Web aplikacji mobilnej.</span><span class="sxs-lookup"><span data-stu-id="d2221-150">Otherwise, if you allow the install to use the new default name, you should click the Mobile App icon in the Multi-Factor Authentication Server and update the Mobile App Web Service URL.</span></span>

  5. <span data-ttu-id="d2221-151">Przejdź do lokalizacji instalacji usługi internetowej aplikacji mobilnej (np. C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) i otwórz do edycji plik web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-151">Go to the Mobile App Web Service install location (for example, C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) and edit the web.config file.</span></span> <span data-ttu-id="d2221-152">Z oryginalnego pliku web.config, który został umieszczony w kopii zapasowej przed uaktualnieniem, skopiuj wartości z sekcji appSettings i applicationSettings do nowego pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-152">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span></span> <span data-ttu-id="d2221-153">Jeśli nowa domyślna nazwa katalogu wirtualnego została zachowana podczas instalacji zestawu SDK usługi sieci Web, zmień adres URL w sekcji applicationSettings, aby wskazywał poprawną lokalizację.</span><span class="sxs-lookup"><span data-stu-id="d2221-153">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="d2221-154">Jeśli w poprzednim pliku web.config zostały zmienione inne wartości domyślne, zastosuj te same zmiany w nowym pliku web.config.</span><span class="sxs-lookup"><span data-stu-id="d2221-154">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d2221-155">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="d2221-155">Next steps</span></span>

- <span data-ttu-id="d2221-156">[Zainstaluj portal użytkowników](multi-factor-authentication-get-started-portal.md) dla serwera Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="d2221-156">[Install the users portal](multi-factor-authentication-get-started-portal.md) for the Azure Multi-Factor Authentication Server.</span></span>

- <span data-ttu-id="d2221-157">[Skonfiguruj uwierzytelnianie systemu Windows](multi-factor-authentication-get-started-server-windows.md) dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="d2221-157">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications.</span></span> 
