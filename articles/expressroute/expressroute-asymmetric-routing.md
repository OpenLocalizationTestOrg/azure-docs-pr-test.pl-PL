---
title: aaaAsymmetric routing | Dokumentacja firmy Microsoft
description: "W tym artykule przedstawiono hello problemów, które klient może sprostać asymetrycznego routingu w sieci z wielu docelowego tooa łącza."
documentationcenter: na
services: expressroute
author: osamazia
manager: carmonm
editor: 
ms.assetid: a754bff9-95c9-44b5-9796-377fc21e8322
ms.service: expressroute
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/10/2016
ms.author: osamam
ms.openlocfilehash: 01a16242437a3674dcfe27b074911a829a6c1abd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="asymmetric-routing-with-multiple-network-paths"></a><span data-ttu-id="bae56-103">Routing asymetryczny z wieloma ścieżkami sieciowymi</span><span class="sxs-lookup"><span data-stu-id="bae56-103">Asymmetric routing with multiple network paths</span></span>
<span data-ttu-id="bae56-104">W tym artykule wyjaśniono, jak ruch sieciowy w obie strony może podążać różnymi trasami w przypadku dostępności wielu ścieżek między miejscem źródłowym i docelowym.</span><span class="sxs-lookup"><span data-stu-id="bae56-104">This article explains how forward and return network traffic might take different routes when multiple paths are available between network source and destination.</span></span>

<span data-ttu-id="bae56-105">Jego ważne toounderstand dwa pojęcia toounderstand asymetrycznego routingu.</span><span class="sxs-lookup"><span data-stu-id="bae56-105">It's important toounderstand two concepts toounderstand asymmetric routing.</span></span> <span data-ttu-id="bae56-106">Co jest efektem hello wiele ścieżek sieci.</span><span class="sxs-lookup"><span data-stu-id="bae56-106">One is hello effect of multiple network paths.</span></span> <span data-ttu-id="bae56-107">Witaj innych jest sposób urządzenia, takie jak zapory, Zachowaj stan.</span><span class="sxs-lookup"><span data-stu-id="bae56-107">hello other is how devices, like a firewall, keep state.</span></span> <span data-ttu-id="bae56-108">Tego rodzaju urządzenia są nazywane urządzeniami stanowymi.</span><span class="sxs-lookup"><span data-stu-id="bae56-108">These types of devices are called stateful devices.</span></span> <span data-ttu-id="bae56-109">Kombinacja te dwa czynniki tworzy w sieci, do której ruch jest porzucone przez urządzenie stanowe, ponieważ hello stanowe urządzenia nie wykrył, że ruchu sieciowego pochodzi z urządzenia hello scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="bae56-109">A combination of these two factors creates scenarios in which network traffic is dropped by a stateful device because hello stateful device didn't detect that traffic originated with hello device itself.</span></span>

## <a name="multiple-network-paths"></a><span data-ttu-id="bae56-110">Wiele ścieżek sieciowych</span><span class="sxs-lookup"><span data-stu-id="bae56-110">Multiple network paths</span></span>
<span data-ttu-id="bae56-111">Gdy sieci przedsiębiorstwa ma tylko jedną toohello link, który przechodzi przez Internet za pośrednictwem swojego usługodawcy internetowego, wszystkie tooand ruchu z hello Internet hello tej samej ścieżce.</span><span class="sxs-lookup"><span data-stu-id="bae56-111">When an enterprise network has only one link toohello Internet through their Internet service provider, all traffic tooand from hello Internet travels hello same path.</span></span> <span data-ttu-id="bae56-112">Często firm zakupu wielu obwody jako nadmiarowe ścieżki, tooimprove sieci przestojów.</span><span class="sxs-lookup"><span data-stu-id="bae56-112">Often, companies purchase multiple circuits, as redundant paths, tooimprove network uptime.</span></span> <span data-ttu-id="bae56-113">W takim przypadku jego możliwe, że ruchu przechodzącego spoza sieci hello, toohello Internet, przesyłany przez jedno łącze i hello zwracać ruch przechodzi przez różne łącza.</span><span class="sxs-lookup"><span data-stu-id="bae56-113">When this happens, it's possible that traffic that goes outside of hello network, toohello Internet, goes through one link, and hello return traffic goes through a different link.</span></span> <span data-ttu-id="bae56-114">Jest to często określane mianem routingu asymetrycznego.</span><span class="sxs-lookup"><span data-stu-id="bae56-114">This is commonly known as asymmetric routing.</span></span> <span data-ttu-id="bae56-115">W asymetrycznego routingu odwrotnej ruchu sieciowego ma inną ścieżkę z oryginalnego przepływu hello.</span><span class="sxs-lookup"><span data-stu-id="bae56-115">In asymmetric routing, reverse network traffic takes a different path from hello original flow.</span></span>

![Sieć z wieloma ścieżkami](./media/expressroute-asymmetric-routing/AsymmetricRouting3.png)

<span data-ttu-id="bae56-117">Mimo że nastąpi to przede wszystkim na powitania Internet, asymetrycznego routingu również ma zastosowanie kombinacji tooother wiele ścieżek.</span><span class="sxs-lookup"><span data-stu-id="bae56-117">Although it primarily occurs on hello Internet, asymmetric routing also applies tooother combinations of multiple paths.</span></span> <span data-ttu-id="bae56-118">Dotyczy, na przykład zarówno ścieżka Internet tooan i ścieżki prywatnej, która go toohello tego samego miejsca docelowego, a toomultiple ścieżek prywatne, które go toohello tego samego miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="bae56-118">It applies, for example, both tooan Internet path and a private path that go toohello same destination, and toomultiple private paths that go toohello same destination.</span></span>

<span data-ttu-id="bae56-119">Każdy router na sposób hello, z toodestination źródła oblicza hello najlepsze ścieżki tooreach miejsca docelowego.</span><span class="sxs-lookup"><span data-stu-id="bae56-119">Each router along hello way, from source toodestination, computes hello best path tooreach a destination.</span></span> <span data-ttu-id="bae56-120">Witaj routera najlepsze możliwe ścieżki opiera się na dwie główne czynniki:</span><span class="sxs-lookup"><span data-stu-id="bae56-120">hello router's determination of best possible path is based on two main factors:</span></span>

* <span data-ttu-id="bae56-121">Routing między sieciami zewnętrznymi opiera się na protokole routingu o nazwie Border Gateway Protocol (BGP).</span><span class="sxs-lookup"><span data-stu-id="bae56-121">Routing between external networks is based on a routing protocol, Border Gateway Protocol (BGP).</span></span> <span data-ttu-id="bae56-122">Protokół BGP pobiera anonsów sąsiadów i uruchamia je na kolejnych kroków toodetermine hello najlepsze ścieżki toohello przeznaczone docelowego.</span><span class="sxs-lookup"><span data-stu-id="bae56-122">BGP takes advertisements from neighbors and runs them through a series of steps toodetermine hello best path toohello intended destination.</span></span> <span data-ttu-id="bae56-123">Ścieżka najlepsze hello są przechowywane w tabeli routingu.</span><span class="sxs-lookup"><span data-stu-id="bae56-123">It stores hello best path in its routing table.</span></span>
* <span data-ttu-id="bae56-124">Długość Hello maskę podsieci skojarzoną z trasy wpływ ścieżki routingu.</span><span class="sxs-lookup"><span data-stu-id="bae56-124">hello length of a subnet mask associated with a route influences routing paths.</span></span> <span data-ttu-id="bae56-125">Router odbiera kilka anonsów dla hello tego samego adresu IP, ale o różnych masek podsieci, hello router preferuje hello anonsu z maską podsieci dłużej ponieważ uwzględniono więcej określoną trasę.</span><span class="sxs-lookup"><span data-stu-id="bae56-125">If a router receives multiple advertisements for hello same IP address but with different subnet masks, hello router prefers hello advertisement with a longer subnet mask because it's considered a more specific route.</span></span>

## <a name="stateful-devices"></a><span data-ttu-id="bae56-126">Urządzenia stanowe</span><span class="sxs-lookup"><span data-stu-id="bae56-126">Stateful devices</span></span>
<span data-ttu-id="bae56-127">Routery przyjrzeć się nagłówek IP hello pakietu do celów routingu.</span><span class="sxs-lookup"><span data-stu-id="bae56-127">Routers look at hello IP header of a packet for routing purposes.</span></span> <span data-ttu-id="bae56-128">Niektóre urządzenia Szukaj trudniejsze wewnątrz hello pakietu.</span><span class="sxs-lookup"><span data-stu-id="bae56-128">Some devices look even deeper inside hello packet.</span></span> <span data-ttu-id="bae56-129">Zazwyczaj te urządzenia sprawdzają nagłówki warstwy 4 (protokół TCP lub UDP), a nawet warstwy 7 (warstwa aplikacji).</span><span class="sxs-lookup"><span data-stu-id="bae56-129">Typically, these devices look at Layer4 (Transmission Control Protocol, or TCP; or User Datagram Protocol, or UDP), or even Layer7 (Application Layer) headers.</span></span> <span data-ttu-id="bae56-130">Urządzenia te to urządzenia zabezpieczające lub urządzenia optymalizujące przepustowość.</span><span class="sxs-lookup"><span data-stu-id="bae56-130">These kinds of devices are either security devices or bandwidth-optimization devices.</span></span> 

<span data-ttu-id="bae56-131">Zapora jest typowym przykładem urządzenia stanowego.</span><span class="sxs-lookup"><span data-stu-id="bae56-131">A firewall is a common example of a stateful device.</span></span> <span data-ttu-id="bae56-132">Zapora zezwala lub nie zezwala toopass pakietów, za pomocą ich interfejsów na podstawie różnych pól, takie jak protokół, port TCP/UDP i nagłówków adresu URL.</span><span class="sxs-lookup"><span data-stu-id="bae56-132">A firewall allows or denies a packet toopass through its interfaces based on various fields such as protocol, TCP/UDP port, and URL headers.</span></span> <span data-ttu-id="bae56-133">Ten poziom inspekcję pakietów umieszcza przy dużym obciążenia na urządzeniu hello przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="bae56-133">This level of packet inspection puts a heavy processing load on hello device.</span></span> <span data-ttu-id="bae56-134">wydajność tooimprove hello Zapora sprawdza hello pierwszego pakietu przepływu.</span><span class="sxs-lookup"><span data-stu-id="bae56-134">tooimprove performance, hello firewall inspects hello first packet of a flow.</span></span> <span data-ttu-id="bae56-135">Jeśli umożliwia tooproceed pakietów hello zachowuje hello przepływ informacji w tabeli stanu.</span><span class="sxs-lookup"><span data-stu-id="bae56-135">If it allows hello packet tooproceed, it keeps hello flow information in its state table.</span></span> <span data-ttu-id="bae56-136">Wszystkie kolejne pakiety powiązane toothis przepływu dozwolone są oparte na powitania wstępnego określenia.</span><span class="sxs-lookup"><span data-stu-id="bae56-136">All subsequent packets related toothis flow are allowed based on hello initial determination.</span></span> <span data-ttu-id="bae56-137">Pakiet jest częścią istniejącego przepływu może przyjeździe hello zapory.</span><span class="sxs-lookup"><span data-stu-id="bae56-137">A packet that is part of an existing flow might arrive at hello firewall.</span></span> <span data-ttu-id="bae56-138">Jeśli Zapora hello nie ma poprzedniego stanu informacji o jego, zapory hello porzuca pakietów hello.</span><span class="sxs-lookup"><span data-stu-id="bae56-138">If hello firewall has no prior state information about it, hello firewall drops hello packet.</span></span>

## <a name="asymmetric-routing-with-expressroute"></a><span data-ttu-id="bae56-139">Routing asymetryczny przy użyciu usługi ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="bae56-139">Asymmetric routing with ExpressRoute</span></span>
<span data-ttu-id="bae56-140">Po podłączeniu tooMicrosoft za pośrednictwem usługi Azure ExpressRoute, takie jak zmiany sieci to:</span><span class="sxs-lookup"><span data-stu-id="bae56-140">When you connect tooMicrosoft through Azure ExpressRoute, your network changes like this:</span></span>

* <span data-ttu-id="bae56-141">Masz wiele tooMicrosoft łącza.</span><span class="sxs-lookup"><span data-stu-id="bae56-141">You have multiple links tooMicrosoft.</span></span> <span data-ttu-id="bae56-142">Jedno łącze jest istniejące połączenie internetowe, a hello innych odbywa się za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-142">One link is your existing Internet connection, and hello other is via ExpressRoute.</span></span> <span data-ttu-id="bae56-143">Niektóre tooMicrosoft ruchu może przejść przez hello internetowych, ale Wróć za pośrednictwem usługi ExpressRoute, albo na odwrót.</span><span class="sxs-lookup"><span data-stu-id="bae56-143">Some traffic tooMicrosoft might go through hello Internet but come back via ExpressRoute, or vice versa.</span></span>
* <span data-ttu-id="bae56-144">Usługa ExpressRoute zapewnia bardziej szczegółowe adresy IP.</span><span class="sxs-lookup"><span data-stu-id="bae56-144">You receive more specific IP addresses via ExpressRoute.</span></span> <span data-ttu-id="bae56-145">Tak dla ruchu z Twojej sieci tooMicrosoft dla usług oferowanych przez usługi ExpressRoute, routery zawsze wybierasz ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-145">So, for traffic from your network tooMicrosoft for services offered via ExpressRoute, routers always prefer ExpressRoute.</span></span>

<span data-ttu-id="bae56-146">toounderstand hello wpływ mają te dwie zmiany w sieci, teraz należy wziąć pod uwagę kilka scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="bae56-146">toounderstand hello effect these two changes have on a network, let’s consider some scenarios.</span></span> <span data-ttu-id="bae56-147">Na przykład masz tylko jedną toohello obwodu Internet i korzystać z wszystkich usług firmy Microsoft za pośrednictwem hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-147">As an example, you have only one circuit toohello Internet and you consume all Microsoft services via hello Internet.</span></span> <span data-ttu-id="bae56-148">Witaj ruch z sieci traverses tooMicrosoft i z powrotem hello tego samego łącza internetowego i przechodzi przez zaporę Windows hello.</span><span class="sxs-lookup"><span data-stu-id="bae56-148">hello traffic from your network tooMicrosoft and back traverses hello same Internet link and passes through hello firewall.</span></span> <span data-ttu-id="bae56-149">rejestruje zapory Hello hello przepływu widzi hello pierwszego pakietu i zwracać pakiety są dozwolone, ponieważ przepływ hello istnieje w tabeli stanu hello.</span><span class="sxs-lookup"><span data-stu-id="bae56-149">hello firewall records hello flow as it sees hello first packet and return packets are allowed because hello flow exists in hello state table.</span></span>

![Routing asymetryczny przy użyciu usługi ExpressRoute](./media/expressroute-asymmetric-routing/AsymmetricRouting1.png)

<span data-ttu-id="bae56-151">Załóżmy teraz, że usługa ExpressRoute została włączona i korzystasz z usług oferowanych przez firmę Microsoft za jej pośrednictwem.</span><span class="sxs-lookup"><span data-stu-id="bae56-151">Then, you turn on ExpressRoute and consume services offered by Microsoft over ExpressRoute.</span></span> <span data-ttu-id="bae56-152">Innych usług firmy Microsoft są używane przez hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-152">All other services from Microsoft are consumed over hello Internet.</span></span> <span data-ttu-id="bae56-153">Możesz wdrożyć oddzielny zapory na Twojej krawędzi, który jest połączony tooExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-153">You deploy a separate firewall at your edge that is connected tooExpressRoute.</span></span> <span data-ttu-id="bae56-154">Microsoft anonsuje dokładniej prefiksy tooyour sieci za pośrednictwem usługi do określonych usług.</span><span class="sxs-lookup"><span data-stu-id="bae56-154">Microsoft advertises more specific prefixes tooyour network over ExpressRoute for specific services.</span></span> <span data-ttu-id="bae56-155">Infrastrukturę routingu wybiera ExpressRoute jako hello preferowaną ścieżką dla tych prefiksów.</span><span class="sxs-lookup"><span data-stu-id="bae56-155">Your routing infrastructure chooses ExpressRoute as hello preferred path for those prefixes.</span></span> <span data-ttu-id="bae56-156">Jeśli Twoje publicznego tooMicrosoft adresy IP są nie prowadzi anonsowania za pośrednictwem usługi ExpressRoute, Microsoft komunikuje się z publicznych adresów IP, za pośrednictwem hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-156">If you are not advertising your public IP addresses tooMicrosoft over ExpressRoute, Microsoft communicates with your public IP addresses via hello Internet.</span></span> <span data-ttu-id="bae56-157">Ruch do przodu z Twojej sieci tooMicrosoft używa usługi ExpressRoute i odwrotnej ruch od firmy Microsoft używa hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-157">Forward traffic from your network tooMicrosoft uses ExpressRoute, and reverse traffic from Microsoft uses hello Internet.</span></span> <span data-ttu-id="bae56-158">Gdy hello zapory na krawędzi hello widzi pakiet odpowiedzi dla przepływu, który nie zostanie znaleziona w tabeli stanu hello, porzuca hello zwracany ruchu.</span><span class="sxs-lookup"><span data-stu-id="bae56-158">When hello firewall at hello edge sees a response packet for a flow that it does not find in hello state table, it drops hello return traffic.</span></span>

<span data-ttu-id="bae56-159">Jeśli wybierzesz hello toouse puli tego samego translatora adresów sieciowych (NAT) dla usługi ExpressRoute i hello Internet, zobaczysz podobne problemy klientom Witaj w sieci, w prywatnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="bae56-159">If you choose toouse hello same network address translation (NAT) pool for ExpressRoute and for hello Internet, you'll see similar issues with hello clients in your network on private IP addresses.</span></span> <span data-ttu-id="bae56-160">Żądania dla usług takich jak Windows Update przejść za pomocą hello Internet, ponieważ adresy IP dla tych usług nie są rozgłaszane za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-160">Requests for services like Windows Update go via hello Internet because IP addresses for these services are not advertised via ExpressRoute.</span></span> <span data-ttu-id="bae56-161">Jednak ruch zwracany hello wróci za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-161">However, hello return traffic comes back via ExpressRoute.</span></span> <span data-ttu-id="bae56-162">Jeśli Microsoft otrzymuje adres IP z hello tej samej maski podsieci z hello Internet i ExpressRoute, ExpressRoute go preferuje hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-162">If Microsoft receives an IP address with hello same subnet mask from hello Internet and ExpressRoute, it prefers ExpressRoute over hello Internet.</span></span> <span data-ttu-id="bae56-163">Jeśli zapora lub innego urządzenia stanowych, które znajduje się na krawędzi Twojej sieci i ukierunkowane ExpressRoute nie ma wcześniejszych informacji o hello przepływu, porzuca pakietów hello, które należą toothat przepływu.</span><span class="sxs-lookup"><span data-stu-id="bae56-163">If a firewall or another stateful device that is on your network edge and facing ExpressRoute has no prior information about hello flow, it drops hello packets that belong toothat flow.</span></span>

## <a name="asymmetric-routing-solutions"></a><span data-ttu-id="bae56-164">Rozwiązania w zakresie routingu asymetrycznego</span><span class="sxs-lookup"><span data-stu-id="bae56-164">Asymmetric routing solutions</span></span>
<span data-ttu-id="bae56-165">Masz dwie główne opcje toosolve hello problem asymetrycznego routingu.</span><span class="sxs-lookup"><span data-stu-id="bae56-165">You have two main options toosolve hello problem of asymmetric routing.</span></span> <span data-ttu-id="bae56-166">Jest za pośrednictwem routingu i hello innych jest za pomocą opartego na źródle translatora adresów Sieciowych (SNAT).</span><span class="sxs-lookup"><span data-stu-id="bae56-166">One is through routing, and hello other is by using source-based NAT (SNAT).</span></span>

### <a name="routing"></a><span data-ttu-id="bae56-167">Routing</span><span class="sxs-lookup"><span data-stu-id="bae56-167">Routing</span></span>
<span data-ttu-id="bae56-168">Upewnij się, czy łącza sieci (rozległej WAN) rozległej anonsowany tooappropriate publiczne adresy IP.</span><span class="sxs-lookup"><span data-stu-id="bae56-168">Ensure that your public IP addresses are advertised tooappropriate wide area network (WAN) links.</span></span> <span data-ttu-id="bae56-169">Na przykład jeśli chcesz toouse hello Internet ruchu uwierzytelniania i ExpressRoute dla ruchu poczty nie powinien anonsują publiczne adresy IP usługi Active Directory Federation Services (AD FS) za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-169">For example, if you want toouse hello Internet for authentication traffic and ExpressRoute for your mail traffic, you should not advertise your Active Directory Federation Services (AD FS) public IP addresses over ExpressRoute.</span></span> <span data-ttu-id="bae56-170">Podobnie, upewnij się, nie tooexpose usługi lokalnej adresy tooIP serwera usług AD FS, które hello router odebrał za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-170">Similarly, be sure not tooexpose an on-premises AD FS server tooIP addresses that hello router receives over ExpressRoute.</span></span> <span data-ttu-id="bae56-171">Trasy odebranych za pośrednictwem usługi ExpressRoute są bardziej szczegółowe, więc finalizowania ExpressRoute hello preferowaną ścieżką dla tooMicrosoft ruchu uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="bae56-171">Routes received over ExpressRoute are more specific so they make ExpressRoute hello preferred path for authentication traffic tooMicrosoft.</span></span> <span data-ttu-id="bae56-172">Wywołuje to asymetryczny routing.</span><span class="sxs-lookup"><span data-stu-id="bae56-172">This causes asymmetric routing.</span></span>

<span data-ttu-id="bae56-173">Jeśli chcesz toouse ExpressRoute do uwierzytelniania, upewnij się, że są anonsowanie publiczne adresy IP usług AD FS, za pośrednictwem usługi ExpressRoute bez translatora adresów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="bae56-173">If you want toouse ExpressRoute for authentication, make sure that you are advertising AD FS public IP addresses over ExpressRoute without NAT.</span></span> <span data-ttu-id="bae56-174">Dzięki temu ruch, który pochodzi od firmy Microsoft i przechodzi tooan w lokalnym serwera usług AD FS przechodzi przez usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-174">This way, traffic that originates from Microsoft and goes tooan on-premises AD FS server goes over ExpressRoute.</span></span> <span data-ttu-id="bae56-175">Zwracany ruch od klienta tooMicrosoft wykorzystuje ExpressRoute, ponieważ jego trasy preferowane hello za pośrednictwem Internetu hello.</span><span class="sxs-lookup"><span data-stu-id="bae56-175">Return traffic from customer tooMicrosoft uses ExpressRoute because it's hello preferred route over hello Internet.</span></span>

### <a name="source-based-nat"></a><span data-ttu-id="bae56-176">Translator adresów sieciowych oparty na źródle</span><span class="sxs-lookup"><span data-stu-id="bae56-176">Source-based NAT</span></span>
<span data-ttu-id="bae56-177">Innym sposobem rozwiązania problemów z routingiem asymetrycznym jest translator adresów sieciowych oparty na źródle (SNAT).</span><span class="sxs-lookup"><span data-stu-id="bae56-177">Another way of solving asymmetric routing issues is by using SNAT.</span></span> <span data-ttu-id="bae56-178">Na przykład można mieć nie anonsowanych hello publiczny adres IP serwera Simple Mail Transfer Protocol (SMTP) lokalnymi ExpressRoute ponieważ planujesz hello toouse Internet dla tego typu komunikacji.</span><span class="sxs-lookup"><span data-stu-id="bae56-178">For example, you have not advertised hello public IP address of an on-premises Simple Mail Transfer Protocol (SMTP) server over ExpressRoute because you intend toouse hello Internet for this type of communication.</span></span> <span data-ttu-id="bae56-179">Żądanie, które pochodzą z firmą Microsoft, a następnie przechodzi tooyour w lokalnym hello Internet przechodzi przez serwer SMTP.</span><span class="sxs-lookup"><span data-stu-id="bae56-179">A request that originates with Microsoft and then goes tooyour on-premises SMTP server traverses hello Internet.</span></span> <span data-ttu-id="bae56-180">Możesz SNAT hello przychodzącego żądania tooan wewnętrznego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="bae56-180">You SNAT hello incoming request tooan internal IP address.</span></span> <span data-ttu-id="bae56-181">Ruch odwrotnej z serwera SMTP hello przechodzi toohello zaporą brzegową (który jest używany dla translatora adresów Sieciowych) zamiast za pośrednictwem usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-181">Reverse traffic from hello SMTP server goes toohello edge firewall (which you use for NAT) instead of through ExpressRoute.</span></span> <span data-ttu-id="bae56-182">ruch zwracany Hello powraca za pośrednictwem hello Internet.</span><span class="sxs-lookup"><span data-stu-id="bae56-182">hello return traffic goes back via hello Internet.</span></span>

![Konfiguracja translatora adresów sieciowych opartych na źródle](./media/expressroute-asymmetric-routing/AsymmetricRouting2.png)

## <a name="asymmetric-routing-detection"></a><span data-ttu-id="bae56-184">Wykrywanie routingu asymetrycznego</span><span class="sxs-lookup"><span data-stu-id="bae56-184">Asymmetric routing detection</span></span>
<span data-ttu-id="bae56-185">Traceroute jest hello najlepsze sposób toomake się upewnić, że ruchu sieciowego przechodzi przez hello oczekiwano ścieżki.</span><span class="sxs-lookup"><span data-stu-id="bae56-185">Traceroute is hello best way toomake sure that your network traffic is traversing hello expected path.</span></span> <span data-ttu-id="bae56-186">Jeśli ruch z sieci lokalnej SMTP server tooMicrosoft tootake hello Internet ścieżki, hello oczekiwanych traceroute pochodzi z tooOffice serwera SMTP hello 365.</span><span class="sxs-lookup"><span data-stu-id="bae56-186">If you expect traffic from your on-premises SMTP server tooMicrosoft tootake hello Internet path, hello expected traceroute is from hello SMTP server tooOffice 365.</span></span> <span data-ttu-id="bae56-187">wynik Hello weryfikuje ruchu w rzeczywistości opuszcza sieci kierunku hello Internet, a nie do usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="bae56-187">hello result validates that traffic is indeed leaving your network toward hello Internet and not toward ExpressRoute.</span></span>

