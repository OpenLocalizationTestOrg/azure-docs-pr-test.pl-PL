---
title: "aaaMultiple adresów VIP usługi równoważenia obciążenia Azure | Dokumentacja firmy Microsoft"
description: "Omówienie wielu adresów VIP modułu równoważenia obciążenia Azure"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: e186e1248e7d187e7efd0668dc3244465ce3e156
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="993d3-103">Obsługa wielu adresów VIP dla usługi Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="993d3-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="993d3-104">Moduł równoważenia obciążenia Azure umożliwia tooload zrównoważyć usług w wielu portów i/lub wiele adresów IP.</span><span class="sxs-lookup"><span data-stu-id="993d3-104">Azure Load Balancer allows you tooload balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="993d3-105">Możesz użyć obciążenia publicznych oraz wewnętrznych równoważenia definicje tooload saldo przepływów zestawu maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="993d3-105">You can use public and internal load balancer definitions tooload balance flows across a set of VMs.</span></span>

<span data-ttu-id="993d3-106">W tym artykule opisano podstawy hello tej możliwości, ważne pojęcia i ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="993d3-106">This article describes hello fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="993d3-107">Jeśli planujesz usług tooexpose tylko na jeden adres IP, można znaleźć uproszczony instrukcje dotyczące [publicznego](load-balancer-get-started-internet-portal.md) lub [wewnętrzny](load-balancer-get-started-ilb-arm-portal.md) konfiguracji usługi równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-107">If you only intend tooexpose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="993d3-108">Dodawanie wielu adresów VIP jest przyrostowe tooa pojedynczą konfiguracją adresu VIP.</span><span class="sxs-lookup"><span data-stu-id="993d3-108">Adding Multiple VIPs is incremental tooa single VIP configuration.</span></span> <span data-ttu-id="993d3-109">Przy użyciu pojęcia hello w tym artykule, możesz rozszerzyć uproszczona konfiguracja w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="993d3-109">Using hello concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="993d3-110">Podczas definiowania modułu równoważenia obciążenia Azure frontonu i wewnętrznej bazy danych konfiguracji są połączone z zasadami.</span><span class="sxs-lookup"><span data-stu-id="993d3-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="993d3-111">Hello sondy kondycji przywoływany przez regułę hello jest używany toodetermine nowych przepływów są wysyłane tooa węzła w puli zaplecza hello.</span><span class="sxs-lookup"><span data-stu-id="993d3-111">hello health probe referenced by hello rule is used toodetermine how new flows are sent tooa node in hello backend pool.</span></span> <span data-ttu-id="993d3-112">frontonu Hello jest zdefiniowany przez wirtualnego adresu IP (VIP), czyli krotka 3 składającej się z adresu IP (wewnętrzny lub publiczny), protokół transportu (UDP lub TCP) i numer portu.</span><span class="sxs-lookup"><span data-stu-id="993d3-112">hello frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="993d3-113">Adres IP na Azure wirtualnej karty Sieciowej podłączony tooa maszyn wirtualnych w puli zaplecza hello jest DIP.</span><span class="sxs-lookup"><span data-stu-id="993d3-113">A DIP is an IP address on an Azure virtual NIC attached tooa VM in hello backend pool.</span></span>

<span data-ttu-id="993d3-114">w poniższej tabeli Hello zawiera niektóre przykładowe konfiguracje serwera sieci Web:</span><span class="sxs-lookup"><span data-stu-id="993d3-114">hello following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="993d3-115">VIP</span><span class="sxs-lookup"><span data-stu-id="993d3-115">VIP</span></span> | <span data-ttu-id="993d3-116">Adres IP</span><span class="sxs-lookup"><span data-stu-id="993d3-116">IP address</span></span> | <span data-ttu-id="993d3-117">Protokół</span><span class="sxs-lookup"><span data-stu-id="993d3-117">protocol</span></span> | <span data-ttu-id="993d3-118">port</span><span class="sxs-lookup"><span data-stu-id="993d3-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="993d3-119">1</span><span class="sxs-lookup"><span data-stu-id="993d3-119">1</span></span> |<span data-ttu-id="993d3-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-120">65.52.0.1</span></span> |<span data-ttu-id="993d3-121">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-121">TCP</span></span> |<span data-ttu-id="993d3-122">80</span><span class="sxs-lookup"><span data-stu-id="993d3-122">80</span></span> |
| <span data-ttu-id="993d3-123">2</span><span class="sxs-lookup"><span data-stu-id="993d3-123">2</span></span> |<span data-ttu-id="993d3-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-124">65.52.0.1</span></span> |<span data-ttu-id="993d3-125">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-125">TCP</span></span> |<span data-ttu-id="993d3-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="993d3-126">*8080*</span></span> |
| <span data-ttu-id="993d3-127">3</span><span class="sxs-lookup"><span data-stu-id="993d3-127">3</span></span> |<span data-ttu-id="993d3-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-128">65.52.0.1</span></span> |<span data-ttu-id="993d3-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="993d3-129">*UDP*</span></span> |<span data-ttu-id="993d3-130">80</span><span class="sxs-lookup"><span data-stu-id="993d3-130">80</span></span> |
| <span data-ttu-id="993d3-131">4</span><span class="sxs-lookup"><span data-stu-id="993d3-131">4</span></span> |<span data-ttu-id="993d3-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="993d3-132">*65.52.0.2*</span></span> |<span data-ttu-id="993d3-133">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-133">TCP</span></span> |<span data-ttu-id="993d3-134">80</span><span class="sxs-lookup"><span data-stu-id="993d3-134">80</span></span> |

<span data-ttu-id="993d3-135">Witaj tabeli przedstawiono cztery różne frontends.</span><span class="sxs-lookup"><span data-stu-id="993d3-135">hello table shows four different frontends.</span></span> <span data-ttu-id="993d3-136">Frontends #1, #2 i #3 są pojedynczego wirtualnego adresu IP z wielu reguł.</span><span class="sxs-lookup"><span data-stu-id="993d3-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="993d3-137">Witaj tego samego adresu IP jest używana, ale hello portu lub protokół jest różne dla każdego serwera sieci Web.</span><span class="sxs-lookup"><span data-stu-id="993d3-137">hello same IP address is used but hello port or protocol is different for each frontend.</span></span> <span data-ttu-id="993d3-138">Frontends #1 i #4 są przykładem wieloma wirtualnymi adresami IP, gdzie hello tego samego serwera sieci Web protokół i port są ponownie między wieloma wirtualnymi adresami IP.</span><span class="sxs-lookup"><span data-stu-id="993d3-138">Frontends #1 and #4 are an example of Multiple VIPs, where hello same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="993d3-139">Moduł równoważenia obciążenia Azure zapewnia elastyczność podczas definiowania reguł równoważenia obciążenia hello.</span><span class="sxs-lookup"><span data-stu-id="993d3-139">Azure Load Balancer provides flexibility in defining hello load balancing rules.</span></span> <span data-ttu-id="993d3-140">Reguła deklaruje, jak adres i port na powitania serwera sieci Web jest mapowanych toohello docelowy adres i port hello wewnętrznej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="993d3-140">A rule declares how an address and port on hello frontend is mapped toohello destination address and port on hello backend.</span></span> <span data-ttu-id="993d3-141">Określa, czy porty wewnętrznej bazy danych są ponownie przez zasady, zależy od typu hello hello reguły.</span><span class="sxs-lookup"><span data-stu-id="993d3-141">Whether or not backend ports are reused across rules depends on hello type of hello rule.</span></span> <span data-ttu-id="993d3-142">Każdy typ reguły ma szczególne wymagania, które mogą mieć wpływ na projekt konfiguracji i badania hosta.</span><span class="sxs-lookup"><span data-stu-id="993d3-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="993d3-143">Istnieją dwa typy zasad:</span><span class="sxs-lookup"><span data-stu-id="993d3-143">There are two types of rules:</span></span>

1. <span data-ttu-id="993d3-144">ponowne użycie Hello domyślną regułę z portem nie wewnętrznej bazy danych</span><span class="sxs-lookup"><span data-stu-id="993d3-144">hello default rule with no backend port reuse</span></span>
2. <span data-ttu-id="993d3-145">Hello pływający adres IP reguły, gdzie są ponownie używane porty wewnętrznej bazy danych</span><span class="sxs-lookup"><span data-stu-id="993d3-145">hello Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="993d3-146">Moduł równoważenia obciążenia Azure umożliwia toomix reguły oba typy hello tej samej konfiguracji usługi równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-146">Azure Load Balancer allows you toomix both rule types on hello same load balancer configuration.</span></span> <span data-ttu-id="993d3-147">Moduł równoważenia obciążenia Hello można używać ich równocześnie dla danej maszyny Wirtualnej lub dowolnej kombinacji pod warunkiem przestrzegania ograniczeń hello hello reguły.</span><span class="sxs-lookup"><span data-stu-id="993d3-147">hello load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by hello constraints of hello rule.</span></span> <span data-ttu-id="993d3-148">Typ reguły, który można wybrać, zależy od hello wymagań Twojej aplikacji i hello złożoności obsługi tej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="993d3-148">Which rule type you choose depends on hello requirements of your application and hello complexity of supporting that configuration.</span></span> <span data-ttu-id="993d3-149">Należy ocenić, jakie typy reguł są najlepsze w przypadku danego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="993d3-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="993d3-150">Firma Microsoft Poznaj te dodatkowe scenariusze, zaczynając od hello domyślne zachowanie.</span><span class="sxs-lookup"><span data-stu-id="993d3-150">We explore these scenarios further by starting with hello default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="993d3-151">Typ #1 reguły: nie ponownemu portu zaplecza</span><span class="sxs-lookup"><span data-stu-id="993d3-151">Rule type #1: No backend port reuse</span></span>

![Ilustracja z wieloma wirtualnymi adresami IP](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="993d3-153">W tym scenariuszu frontonu hello wirtualne adresy IP są konfigurowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="993d3-153">In this scenario, hello frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="993d3-154">VIP</span><span class="sxs-lookup"><span data-stu-id="993d3-154">VIP</span></span> | <span data-ttu-id="993d3-155">Adres IP</span><span class="sxs-lookup"><span data-stu-id="993d3-155">IP address</span></span> | <span data-ttu-id="993d3-156">Protokół</span><span class="sxs-lookup"><span data-stu-id="993d3-156">protocol</span></span> | <span data-ttu-id="993d3-157">port</span><span class="sxs-lookup"><span data-stu-id="993d3-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-159">1</span><span class="sxs-lookup"><span data-stu-id="993d3-159">1</span></span> |<span data-ttu-id="993d3-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-160">65.52.0.1</span></span> |<span data-ttu-id="993d3-161">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-161">TCP</span></span> |<span data-ttu-id="993d3-162">80</span><span class="sxs-lookup"><span data-stu-id="993d3-162">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-164">2</span><span class="sxs-lookup"><span data-stu-id="993d3-164">2</span></span> |<span data-ttu-id="993d3-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="993d3-165">*65.52.0.2*</span></span> |<span data-ttu-id="993d3-166">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-166">TCP</span></span> |<span data-ttu-id="993d3-167">80</span><span class="sxs-lookup"><span data-stu-id="993d3-167">80</span></span> |

<span data-ttu-id="993d3-168">Witaj DIP jest hello docelowym hello ruchu przychodzącego przepływu.</span><span class="sxs-lookup"><span data-stu-id="993d3-168">hello DIP is hello destination of hello inbound flow.</span></span> <span data-ttu-id="993d3-169">W puli zaplecza hello każda maszyna wirtualna przedstawia usługę hello żądanego na unikatowy portu na DIP.</span><span class="sxs-lookup"><span data-stu-id="993d3-169">In hello backend pool, each VM exposes hello desired service on a unique port on a DIP.</span></span> <span data-ttu-id="993d3-170">Ta usługa jest skojarzony z frontonu hello za pośrednictwem definicji reguły.</span><span class="sxs-lookup"><span data-stu-id="993d3-170">This service is associated with hello frontend through a rule definition.</span></span>

<span data-ttu-id="993d3-171">Definiujemy dwie reguły:</span><span class="sxs-lookup"><span data-stu-id="993d3-171">We define two rules:</span></span>

| <span data-ttu-id="993d3-172">Reguła</span><span class="sxs-lookup"><span data-stu-id="993d3-172">Rule</span></span> | <span data-ttu-id="993d3-173">Mapa frontonu</span><span class="sxs-lookup"><span data-stu-id="993d3-173">Map frontend</span></span> | <span data-ttu-id="993d3-174">toobackend puli</span><span class="sxs-lookup"><span data-stu-id="993d3-174">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="993d3-175">1</span><span class="sxs-lookup"><span data-stu-id="993d3-175">1</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="993d3-177">VIP1:80</span></span> |![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="993d3-179">DIP1:80,</span></span> ![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="993d3-181">DIP2:80</span></span> |
| <span data-ttu-id="993d3-182">2</span><span class="sxs-lookup"><span data-stu-id="993d3-182">2</span></span> |![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="993d3-184">VIP2:80</span></span> |![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="993d3-186">DIP1:81,</span></span> ![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="993d3-188">DIP2:81</span></span> |

<span data-ttu-id="993d3-189">Mapowanie pełną Hello w usłudze równoważenia obciążenia Azure jest teraz w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="993d3-189">hello complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="993d3-190">Reguła</span><span class="sxs-lookup"><span data-stu-id="993d3-190">Rule</span></span> | <span data-ttu-id="993d3-191">Adres VIP IP</span><span class="sxs-lookup"><span data-stu-id="993d3-191">VIP IP address</span></span> | <span data-ttu-id="993d3-192">Protokół</span><span class="sxs-lookup"><span data-stu-id="993d3-192">protocol</span></span> | <span data-ttu-id="993d3-193">port</span><span class="sxs-lookup"><span data-stu-id="993d3-193">port</span></span> | <span data-ttu-id="993d3-194">Element docelowy</span><span class="sxs-lookup"><span data-stu-id="993d3-194">Destination</span></span> | <span data-ttu-id="993d3-195">port</span><span class="sxs-lookup"><span data-stu-id="993d3-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Reguły](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-197">1</span><span class="sxs-lookup"><span data-stu-id="993d3-197">1</span></span> |<span data-ttu-id="993d3-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-198">65.52.0.1</span></span> |<span data-ttu-id="993d3-199">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-199">TCP</span></span> |<span data-ttu-id="993d3-200">80</span><span class="sxs-lookup"><span data-stu-id="993d3-200">80</span></span> |<span data-ttu-id="993d3-201">Adres IP DIP</span><span class="sxs-lookup"><span data-stu-id="993d3-201">DIP IP Address</span></span> |<span data-ttu-id="993d3-202">80</span><span class="sxs-lookup"><span data-stu-id="993d3-202">80</span></span> |
| ![Reguły](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-204">2</span><span class="sxs-lookup"><span data-stu-id="993d3-204">2</span></span> |<span data-ttu-id="993d3-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="993d3-205">65.52.0.2</span></span> |<span data-ttu-id="993d3-206">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-206">TCP</span></span> |<span data-ttu-id="993d3-207">80</span><span class="sxs-lookup"><span data-stu-id="993d3-207">80</span></span> |<span data-ttu-id="993d3-208">Adres IP DIP</span><span class="sxs-lookup"><span data-stu-id="993d3-208">DIP IP Address</span></span> |<span data-ttu-id="993d3-209">81</span><span class="sxs-lookup"><span data-stu-id="993d3-209">81</span></span> |

<span data-ttu-id="993d3-210">Każda reguła musi mieć przepływ z unikatowych kombinacji adresu IP i port docelowy.</span><span class="sxs-lookup"><span data-stu-id="993d3-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="993d3-211">Przez zróżnicowanie port docelowy hello hello przepływu wiele reguł można dostarczać toohello przepływów tego samego DIP na różnych portów.</span><span class="sxs-lookup"><span data-stu-id="993d3-211">By varying hello destination port of hello flow, multiple rules can deliver flows toohello same DIP on different ports.</span></span>

<span data-ttu-id="993d3-212">Sondy kondycji są zawsze ukierunkowanej toohello DIP maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="993d3-212">Health probes are always directed toohello DIP of a VM.</span></span> <span data-ttu-id="993d3-213">Należy zapewnić, że czy Twoje sondowania odzwierciedla hello kondycję hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="993d3-213">You must ensure you that your probe reflects hello health of hello VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="993d3-214">Typ #2 reguły: ponowne użycie portu zaplecza przy użyciu pływającego adresu IP</span><span class="sxs-lookup"><span data-stu-id="993d3-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="993d3-215">Moduł równoważenia obciążenia Azure zapewnia elastyczność hello portu frontonu hello tooreuse między wieloma wirtualnymi adresami IP, niezależnie od typu reguły hello używane.</span><span class="sxs-lookup"><span data-stu-id="993d3-215">Azure Load Balancer provides hello flexibility tooreuse hello frontend port across multiple VIPs regardless of hello rule type used.</span></span> <span data-ttu-id="993d3-216">Ponadto niektóre scenariusze aplikacji preferowane lub wymagają hello sam port używany przez wiele wystąpień aplikacji na jednej maszynie Wirtualnej w puli zaplecza hello toobe.</span><span class="sxs-lookup"><span data-stu-id="993d3-216">Additionally, some application scenarios prefer or require hello same port toobe used by multiple application instances on a single VM in hello backend pool.</span></span> <span data-ttu-id="993d3-217">Typowe przykłady ponownemu portu obejmują klastrowanie wysokiej dostępności, sieci wirtualnych urządzeń i udostępnia wiele TLS punktów końcowych bez ponownego szyfrowania.</span><span class="sxs-lookup"><span data-stu-id="993d3-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="993d3-218">Jeśli chcesz portu zaplecza hello tooreuse przez wiele reguł, należy włączyć pływającego adresu IP w definicji reguły hello.</span><span class="sxs-lookup"><span data-stu-id="993d3-218">If you want tooreuse hello backend port across multiple rules, you must enable Floating IP in hello rule definition.</span></span>

<span data-ttu-id="993d3-219">Zmienny adres IP jest częścią co to jest znany jako bezpośrednie serwer zwraca DSR ().</span><span class="sxs-lookup"><span data-stu-id="993d3-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="993d3-220">DSR składa się z dwóch części: Topologia przepływu i adresów IP schematu mapowania.</span><span class="sxs-lookup"><span data-stu-id="993d3-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="993d3-221">Na poziomie platformy usługi równoważenia obciążenia Azure zawsze działa w topologii przepływu DSR niezależnie od tego, czy pływający adres IP jest włączone.</span><span class="sxs-lookup"><span data-stu-id="993d3-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="993d3-222">Oznacza to, że hello część ruchu wychodzącego przepływu zawsze ma tooflow poprawnie ponownie zapisane bezpośrednio wstecz toohello pochodzenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-222">This means that hello outbound part of a flow is always correctly rewritten tooflow directly back toohello origin.</span></span>

<span data-ttu-id="993d3-223">Z typem reguły domyślne hello Azure udostępnia tradycyjne schemat mapowania adresów IP dla łatwość użycia z równoważeniem obciążenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-223">With hello default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="993d3-224">Włączanie pływający adres IP zmienia tooallow schemat mapowania adresów IP hello dodatkowe elastyczność jak wyjaśniono poniżej.</span><span class="sxs-lookup"><span data-stu-id="993d3-224">Enabling Floating IP changes hello IP address mapping scheme tooallow for additional flexibility as explained below.</span></span>

<span data-ttu-id="993d3-225">powitania po diagram przedstawia tej konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="993d3-225">hello following diagram illustrates this configuration:</span></span>

![Ilustracja z wieloma wirtualnymi adresami IP](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="993d3-227">W tym scenariuszu dla każdej maszyny Wirtualnej w puli zaplecza hello ma trzy interfejsów sieciowych:</span><span class="sxs-lookup"><span data-stu-id="993d3-227">For this scenario, every VM in hello backend pool has three network interfaces:</span></span>

* <span data-ttu-id="993d3-228">DIP: wirtualnej karty Sieciowej skojarzonych z hello maszyny Wirtualnej (Konfiguracja IP zasobów kart platformy Azure)</span><span class="sxs-lookup"><span data-stu-id="993d3-228">DIP: a Virtual NIC associated with hello VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="993d3-229">Adres VIP1: interfejsu sprzężenia zwrotnego gościu systemu operacyjnego, który jest skonfigurowany z adresem IP adresu VIP1</span><span class="sxs-lookup"><span data-stu-id="993d3-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="993d3-230">VIP2: interfejsu sprzężenia zwrotnego gościu systemu operacyjnego, który jest skonfigurowany z adresem IP VIP2</span><span class="sxs-lookup"><span data-stu-id="993d3-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="993d3-231">Konfiguracja Hello interfejsów logicznej hello jest wykonywana w ramach system operacyjny gościa hello.</span><span class="sxs-lookup"><span data-stu-id="993d3-231">hello configuration of hello logical interfaces is performed within hello guest OS.</span></span> <span data-ttu-id="993d3-232">Ta konfiguracja nie jest wykonywane lub zarządzane przez usługę Azure.</span><span class="sxs-lookup"><span data-stu-id="993d3-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="993d3-233">Bez tej konfiguracji reguły hello nie będzie działać.</span><span class="sxs-lookup"><span data-stu-id="993d3-233">Without this configuration, hello rules will not function.</span></span> <span data-ttu-id="993d3-234">Definicje sondy kondycji Użyj hello DIP hello maszyny Wirtualnej, a nie hello logicznych adresu VIP.</span><span class="sxs-lookup"><span data-stu-id="993d3-234">Health probe definitions use hello DIP of hello VM rather than hello logical VIP.</span></span> <span data-ttu-id="993d3-235">W związku z tym usługi podać sondowania odpowiedzi na port DIP odzwierciedlenia stanu hello hello usług oferowanych w systemie hello logicznych adresu VIP.</span><span class="sxs-lookup"><span data-stu-id="993d3-235">Therefore, your service must provide probe responses on a DIP port that reflect hello status of hello service offered on hello logical VIP.</span></span>

<span data-ttu-id="993d3-236">Załóżmy, że hello tej samej konfiguracji serwera sieci Web, jak w poprzednim scenariuszu hello:</span><span class="sxs-lookup"><span data-stu-id="993d3-236">Let's assume hello same frontend configuration as in hello previous scenario:</span></span>

| <span data-ttu-id="993d3-237">VIP</span><span class="sxs-lookup"><span data-stu-id="993d3-237">VIP</span></span> | <span data-ttu-id="993d3-238">Adres IP</span><span class="sxs-lookup"><span data-stu-id="993d3-238">IP address</span></span> | <span data-ttu-id="993d3-239">Protokół</span><span class="sxs-lookup"><span data-stu-id="993d3-239">protocol</span></span> | <span data-ttu-id="993d3-240">port</span><span class="sxs-lookup"><span data-stu-id="993d3-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-242">1</span><span class="sxs-lookup"><span data-stu-id="993d3-242">1</span></span> |<span data-ttu-id="993d3-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-243">65.52.0.1</span></span> |<span data-ttu-id="993d3-244">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-244">TCP</span></span> |<span data-ttu-id="993d3-245">80</span><span class="sxs-lookup"><span data-stu-id="993d3-245">80</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-247">2</span><span class="sxs-lookup"><span data-stu-id="993d3-247">2</span></span> |<span data-ttu-id="993d3-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="993d3-248">*65.52.0.2*</span></span> |<span data-ttu-id="993d3-249">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-249">TCP</span></span> |<span data-ttu-id="993d3-250">80</span><span class="sxs-lookup"><span data-stu-id="993d3-250">80</span></span> |

<span data-ttu-id="993d3-251">Definiujemy dwie reguły:</span><span class="sxs-lookup"><span data-stu-id="993d3-251">We define two rules:</span></span>

| <span data-ttu-id="993d3-252">Reguła</span><span class="sxs-lookup"><span data-stu-id="993d3-252">Rule</span></span> | <span data-ttu-id="993d3-253">Mapa frontonu</span><span class="sxs-lookup"><span data-stu-id="993d3-253">Map frontend</span></span> | <span data-ttu-id="993d3-254">toobackend puli</span><span class="sxs-lookup"><span data-stu-id="993d3-254">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="993d3-255">1</span><span class="sxs-lookup"><span data-stu-id="993d3-255">1</span></span> |![Reguły](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="993d3-257">VIP1:80</span></span> |![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-259">VIP1:80 (w VM1 i maszyny VM2)</span><span class="sxs-lookup"><span data-stu-id="993d3-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="993d3-260">2</span><span class="sxs-lookup"><span data-stu-id="993d3-260">2</span></span> |![Reguły](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="993d3-262">VIP2:80</span></span> |![wewnętrznej bazy danych](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-264">VIP2:80 (w VM1 i maszyny VM2)</span><span class="sxs-lookup"><span data-stu-id="993d3-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="993d3-265">Hello w poniższej tabeli przedstawiono pełną mapowania hello w hello usługi równoważenia obciążenia:</span><span class="sxs-lookup"><span data-stu-id="993d3-265">hello following table shows hello complete mapping in hello load balancer:</span></span>

| <span data-ttu-id="993d3-266">Reguła</span><span class="sxs-lookup"><span data-stu-id="993d3-266">Rule</span></span> | <span data-ttu-id="993d3-267">Adres VIP IP</span><span class="sxs-lookup"><span data-stu-id="993d3-267">VIP IP address</span></span> | <span data-ttu-id="993d3-268">Protokół</span><span class="sxs-lookup"><span data-stu-id="993d3-268">protocol</span></span> | <span data-ttu-id="993d3-269">port</span><span class="sxs-lookup"><span data-stu-id="993d3-269">port</span></span> | <span data-ttu-id="993d3-270">Element docelowy</span><span class="sxs-lookup"><span data-stu-id="993d3-270">Destination</span></span> | <span data-ttu-id="993d3-271">port</span><span class="sxs-lookup"><span data-stu-id="993d3-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="993d3-273">1</span><span class="sxs-lookup"><span data-stu-id="993d3-273">1</span></span> |<span data-ttu-id="993d3-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="993d3-274">65.52.0.1</span></span> |<span data-ttu-id="993d3-275">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-275">TCP</span></span> |<span data-ttu-id="993d3-276">80</span><span class="sxs-lookup"><span data-stu-id="993d3-276">80</span></span> |<span data-ttu-id="993d3-277">identyczny VIP (65.52.0.1)</span><span class="sxs-lookup"><span data-stu-id="993d3-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="993d3-278">identyczny VIP (80)</span><span class="sxs-lookup"><span data-stu-id="993d3-278">same as VIP (80)</span></span> |
| ![VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="993d3-280">2</span><span class="sxs-lookup"><span data-stu-id="993d3-280">2</span></span> |<span data-ttu-id="993d3-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="993d3-281">65.52.0.2</span></span> |<span data-ttu-id="993d3-282">TCP</span><span class="sxs-lookup"><span data-stu-id="993d3-282">TCP</span></span> |<span data-ttu-id="993d3-283">80</span><span class="sxs-lookup"><span data-stu-id="993d3-283">80</span></span> |<span data-ttu-id="993d3-284">identyczny VIP (65.52.0.2)</span><span class="sxs-lookup"><span data-stu-id="993d3-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="993d3-285">identyczny VIP (80)</span><span class="sxs-lookup"><span data-stu-id="993d3-285">same as VIP (80)</span></span> |

<span data-ttu-id="993d3-286">docelowy Hello hello przepływu ruchu przychodzącego jest adresu hello VIP w interfejsie sprzężenia zwrotnego hello w hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="993d3-286">hello destination of hello inbound flow is hello VIP address on hello loopback interface in hello VM.</span></span> <span data-ttu-id="993d3-287">Każda reguła musi mieć przepływ z unikatowych kombinacji adresu IP i port docelowy.</span><span class="sxs-lookup"><span data-stu-id="993d3-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="993d3-288">Zróżnicowanie hello docelowy adres IP przepływu hello jest możliwe w ponownemu portu hello tej samej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="993d3-288">By varying hello destination IP address of hello flow, port reuse is possible on hello same VM.</span></span> <span data-ttu-id="993d3-289">Usługa jest narażonych toohello modułu równoważenia obciążenia przez powiązanie jego adres IP i port interfejsu sprzężenia zwrotnego odpowiednich hello toohello VIP w.</span><span class="sxs-lookup"><span data-stu-id="993d3-289">Your service is exposed toohello load balancer by binding it toohello VIP’s IP address and port of hello respective loopback interface.</span></span>

<span data-ttu-id="993d3-290">Zwróć uwagę, w tym przykładzie nie zmienia hello port docelowy.</span><span class="sxs-lookup"><span data-stu-id="993d3-290">Notice that this example does not change hello destination port.</span></span> <span data-ttu-id="993d3-291">Mimo że jest to scenariusz pływającego adresu IP, usługi równoważenia obciążenia Azure obsługuje również definiowanie port docelowy reguły toorewrite hello wewnętrznej bazy danych i toomake on inny niż port docelowy hello frontonu.</span><span class="sxs-lookup"><span data-stu-id="993d3-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule toorewrite hello backend destination port and toomake it different from hello frontend destination port.</span></span>

<span data-ttu-id="993d3-292">Hello typ reguły pływający adres IP jest foundation hello kilka wzorców konfiguracji usługi równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-292">hello Floating IP rule type is hello foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="993d3-293">Przykładem, która jest obecnie dostępna jest hello [funkcji SQL AlwaysOn z wiele odbiorników](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="993d3-293">One example that is currently available is hello [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="993d3-294">Wraz z upływem czasu firma Microsoft będzie dokumentu jeden z tych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="993d3-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="993d3-295">Ograniczenia</span><span class="sxs-lookup"><span data-stu-id="993d3-295">Limitations</span></span>

* <span data-ttu-id="993d3-296">Wielu konfiguracji adresów VIP są obsługiwane tylko z maszyn wirtualnych IaaS.</span><span class="sxs-lookup"><span data-stu-id="993d3-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="993d3-297">Witaj pływający adres IP reguły aplikacji musi być hello DIP przepływów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="993d3-297">With hello Floating IP rule, your application must use hello DIP for outbound flows.</span></span> <span data-ttu-id="993d3-298">Aplikacji wiąże adres VIP toohello skonfigurowane dla interfejsu sprzężenia zwrotnego hello w system operacyjny gościa hello, następnie SNAT nie jest dostępne toorewrite hello wychodzącego przepływu i hello przepływu nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="993d3-298">If your application binds toohello VIP address configured on hello loopback interface in hello guest OS, then SNAT is not available toorewrite hello outbound flow and hello flow fails.</span></span>
* <span data-ttu-id="993d3-299">Publiczne adresy IP mają wpływ na rozliczenia.</span><span class="sxs-lookup"><span data-stu-id="993d3-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="993d3-300">Aby uzyskać więcej informacji, zobacz [cennik adresu IP](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="993d3-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="993d3-301">Zastosuj limity subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="993d3-301">Subscription limits apply.</span></span> <span data-ttu-id="993d3-302">Aby uzyskać więcej informacji, zobacz [usługi limity](../azure-subscription-service-limits.md#networking-limits) szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="993d3-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
