---
title: "aaaDesigning wysokiej dostępności aplikacji przy użyciu magazynu geograficznie nadmiarowego Azure dostęp do odczytu (RA-GRS) | Dokumentacja firmy Microsoft"
description: "Jak tooarchitect magazynu Azure RA-GRS toouse aplikacją wysokiej dostępności, elastyczne wystarczającej liczby awarii toohandle."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: e4a9fe7ef33eecd894408b3c1ef59920a248d1bd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="23651-103">Projektowanie wysokiej dostępności aplikacji przy użyciu RA-GRS</span><span class="sxs-lookup"><span data-stu-id="23651-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="23651-104">Typową funkcją infrastruktury opartej na chmurze jest zapewniają platformy wysokiej dostępności do obsługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="23651-105">Deweloperzy aplikacji opartych na chmurze należy wziąć pod uwagę dokładnie sposób tooleverage to użytkownicy tootheir platformy toodeliver aplikacje o wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="23651-105">Developers of cloud-based applications must consider carefully how tooleverage this platform toodeliver highly available applications tootheir users.</span></span> <span data-ttu-id="23651-106">Ten artykuł dotyczy w szczególności sposób deweloperzy mogą używać hello Azure magazynu dostęp do odczytu z magazynu geograficznie nadmiarowego magazynu (RA-GRS) toomake ich więcej dostępnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-106">This article focuses specifically on how developers can use hello Azure Storage Read Access Geo Redundant Storage (RA-GRS) toomake their applications more available.</span></span>

<span data-ttu-id="23651-107">Istnieją cztery opcje nadmiarowości — LRS (magazyn lokalnie nadmiarowy), ZRS (strefy nadmiarowego magazynu), GRS (magazyn geograficznie nadmiarowy) i RA-GRS (magazyn geograficznie nadmiarowy dostęp do odczytu).</span><span class="sxs-lookup"><span data-stu-id="23651-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="23651-108">Zamierzamy toodiscuss GRS i RA-GRS, w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="23651-108">We are going toodiscuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="23651-109">W wypadku magazynu GRS trzy kopie danych są przechowywane w regionie podstawowym hello wybranej podczas konfigurowania hello konta magazynu.</span><span class="sxs-lookup"><span data-stu-id="23651-109">With GRS, three copies of your data are kept in hello primary region you selected when setting up hello storage account.</span></span> <span data-ttu-id="23651-110">Trzy dodatkowe kopie są obsługiwane asynchronicznie w regionie pomocniczym określony przez platformę Azure.</span><span class="sxs-lookup"><span data-stu-id="23651-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="23651-111">RA-GRS jest odpowiednikiem GRS Witaj, z wyjątkiem tego, czy masz dostęp do odczytu toohello pomocniczej kopii.</span><span class="sxs-lookup"><span data-stu-id="23651-111">RA-GRS is hello same thing as GRS except that you have read access toohello secondary copy.</span></span> <span data-ttu-id="23651-112">Aby uzyskać więcej informacji na temat hello różnych opcji nadmiarowość magazynu Azure, zobacz [replikacja usługi Azure Storage](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="23651-112">For more information about hello different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="23651-113">Witaj replikacji artykuł opisuje również skojarzenie hello hello regionów podstawowego i pomocniczego.</span><span class="sxs-lookup"><span data-stu-id="23651-113">hello replication article also shows hello pairings of hello primary and secondary regions.</span></span>

<span data-ttu-id="23651-114">Dostępne są zawarte w tym artykule i łącze tooa kompletnego przykładu na końcu hello, który można pobrać i uruchomić wstawki kodu.</span><span class="sxs-lookup"><span data-stu-id="23651-114">There are code snippets included in this article, and a link tooa complete sample at hello end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="23651-115">Najważniejsze funkcje RA-GRS</span><span class="sxs-lookup"><span data-stu-id="23651-115">Key features of RA-GRS</span></span>

<span data-ttu-id="23651-116">Przed omawianiu jak toouse magazynu RA-GRS, umożliwia porozmawiać na temat jego właściwości i zachowania.</span><span class="sxs-lookup"><span data-stu-id="23651-116">Before we talk about how toouse RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="23651-117">Magazyn Azure przechowuje tylko do odczytu kopię hello dane, które są przechowywane w Twoim regionie podstawowym w regionie pomocniczym; jak wspomniano powyżej, usługa Magazyn hello Określa lokalizację hello region pomocniczy hello.</span><span class="sxs-lookup"><span data-stu-id="23651-117">Azure Storage maintains a read-only copy of hello data you store in your primary region in a secondary region; as noted above, hello storage service determines hello location of hello secondary region.</span></span>

* <span data-ttu-id="23651-118">kopia tylko do odczytu Hello jest [ostatecznie spójne](https://en.wikipedia.org/wiki/Eventual_consistency) z danymi hello w regionie podstawowym hello.</span><span class="sxs-lookup"><span data-stu-id="23651-118">hello read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with hello data in hello primary region.</span></span>

* <span data-ttu-id="23651-119">Dla obiektów blob, tabel i kolejek, można zbadać hello region pomocniczy dla *czas ostatniej synchronizacji* wartość, która informuje, wystąpienia hello ostatniej replikacji z regionu pomocniczego hello toohello głównej.</span><span class="sxs-lookup"><span data-stu-id="23651-119">For blobs, tables, and queues, you can query hello secondary region for a *Last Sync Time* value that tells you when hello last replication from hello primary toohello secondary region occurred.</span></span> <span data-ttu-id="23651-120">(To nie jest obsługiwana dla usługi Magazyn plików Azure, która nie ma RA-GRS nadmiarowości w tej chwili.)</span><span class="sxs-lookup"><span data-stu-id="23651-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="23651-121">Z danych hello w regionie podstawowym lub pomocniczym albo hello służy hello toointeract biblioteki klienta usługi Storage.</span><span class="sxs-lookup"><span data-stu-id="23651-121">You can use hello Storage Client Library toointeract with hello data in either hello primary or secondary region.</span></span> <span data-ttu-id="23651-122">Możesz również przekierować odczytu automatycznie żądań toohello regionu pomocniczego, jeśli upłynie limit czasu żądania odczytu toohello regionu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="23651-122">You can also redirect read requests automatically toohello secondary region if a read request toohello primary region times out.</span></span>

* <span data-ttu-id="23651-123">Jeśli jest to główna kwestia wpływu na dostępność hello hello danych w regionie podstawowym hello, hello Azure zespołu mogą wyzwalać geograficznie-trybu failover, w takim przypadku hello wpisy DNS wskazujący regionu podstawowego toohello będzie region pomocniczy toohello toopoint zmienione.</span><span class="sxs-lookup"><span data-stu-id="23651-123">If there is a major issue affecting hello accessibility of hello data in hello primary region, hello Azure team may trigger a geo-failover, at which point hello DNS entries pointing toohello primary region will be changed toopoint toohello secondary region.</span></span>

* <span data-ttu-id="23651-124">W przypadku awarię replikacji geograficznej — warstwa Azure będzie wybierz nową lokalizację dodatkowej hello danych toothat lokalizację replikację, a następnie punktu hello dodatkowej tooit wpisy DNS.</span><span class="sxs-lookup"><span data-stu-id="23651-124">If a geo-failover occurs, Azure will select a new secondary location and replicate hello data toothat location, then point hello secondary DNS entries tooit.</span></span> <span data-ttu-id="23651-125">pomocniczy punkt końcowy Hello będą niedostępne do momentu zakończenia konta magazynu hello replikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-125">hello secondary endpoint will be unavailable until hello storage account has finished replicating.</span></span> <span data-ttu-id="23651-126">Aby uzyskać więcej informacji, zobacz [jakie toodo w przypadku wystąpienia awarii usługi Azure Storage](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="23651-126">For more information, please see [What toodo if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="23651-127">Zagadnienia dotyczące projektowania aplikacji przy użyciu RA-GRS</span><span class="sxs-lookup"><span data-stu-id="23651-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="23651-128">głównym celem niniejszego artykułu Hello jest tooshow należy jak toodesign aplikacji, która będzie toofunction (chociaż są w ograniczonym zakresie), nawet w przypadku hello poważnej awarii w danych pierwotnych hello Centrum.</span><span class="sxs-lookup"><span data-stu-id="23651-128">hello main purpose of this article is tooshow you how toodesign an application that will continue toofunction (albeit in a limited capacity) even in hello event of a major disaster at hello primary data center.</span></span> <span data-ttu-id="23651-129">W tym celu o problemów długotrwałe lub przejściowy toohandle aplikacji, na których przełączanie tooread z regionu pomocniczego hello, gdy występuje problem, a następnie ponowne włączenie, gdy regionu podstawowego hello jest ponownie dostępna.</span><span class="sxs-lookup"><span data-stu-id="23651-129">You do this by having your application toohandle transient or long-running issues by switching tooread from hello secondary region while there is a problem, and switching back when hello primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="23651-130">Przy użyciu ostatecznie spójność danych</span><span class="sxs-lookup"><span data-stu-id="23651-130">Using eventually consistent data</span></span>

<span data-ttu-id="23651-131">To rozwiązanie proponowanych zakłada, że jej zgadzasz tooreturn co może być aplikacja wywołująca toohello stare dane.</span><span class="sxs-lookup"><span data-stu-id="23651-131">This proposed solution assumes that it is okay tooreturn what could be stale data toohello calling application.</span></span> <span data-ttu-id="23651-132">Ponieważ dane dodatkowej hello jest ostatecznie spójne, jest możliwe, że hello dane zostały zapisane toohello podstawowy, ale toohello aktualizacji hello dodatkowej miał nie zakończyło się replikowanie podczas regionu podstawowego hello stał się niedostępny.</span><span class="sxs-lookup"><span data-stu-id="23651-132">Because hello secondary data is eventually consistent, it is possible that hello data was written toohello primary but hello update toohello secondary had not finished replicating when hello primary region became inaccessible.</span></span>

<span data-ttu-id="23651-133">Na przykład klienta można przesłać aktualizacji, który zakończy się pomyślnie, a następnie hello podstawowego można Przejdź w dół, zanim hello aktualizacji jest propagowany toohello dodatkowej.</span><span class="sxs-lookup"><span data-stu-id="23651-133">For example, your customer could submit an update that is successful, and then hello primary could go down before hello update is propagated toohello secondary.</span></span> <span data-ttu-id="23651-134">W tym przypadku jeśli powitania klienta następnie prosi tooread hello ponownie danych, on odbiera dane starych hello zamiast hello zaktualizowane dane.</span><span class="sxs-lookup"><span data-stu-id="23651-134">In this case, if hello customer then asks tooread hello data back, he receives hello stale data instead of hello updated data.</span></span> <span data-ttu-id="23651-135">Jeśli jest to dopuszczalne, a jeśli tak, należy zdecydować, w jaki sposób będzie wiadomości powitania klienta.</span><span class="sxs-lookup"><span data-stu-id="23651-135">You must decide if this is acceptable, and if so, how you will message hello customer.</span></span> <span data-ttu-id="23651-136">Zobaczysz, jak toocheck hello czas ostatniej synchronizacji na powitania danych pomocniczych w dalszej części tego artykułu toosee Jeśli dodatkowej hello jest aktualny.</span><span class="sxs-lookup"><span data-stu-id="23651-136">You'll see how toocheck hello Last Sync Time on hello secondary data later in this article toosee if hello secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="23651-137">Obsługa usług oddzielnie lub wszystkich elementów</span><span class="sxs-lookup"><span data-stu-id="23651-137">Handling services separately or all together</span></span>

<span data-ttu-id="23651-138">Podczas, gdy jest to prawdopodobnie nie jest możliwe dla toobecome jedna usługa jest niedostępna podczas hello inne usługi są nadal pełni funkcjonalne.</span><span class="sxs-lookup"><span data-stu-id="23651-138">While not likely, it is possible for one service toobecome unavailable while hello other services are still fully functional.</span></span> <span data-ttu-id="23651-139">Użytkownik może dojście hello prób i trybie tylko do odczytu dla każdego obsługi oddzielnie (obiekty BLOB, kolejek, tabel) lub może obsłużyć ponownych prób objęty dla wszystkich usług magazynu hello razem.</span><span class="sxs-lookup"><span data-stu-id="23651-139">You can handle hello retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all hello storage services together.</span></span>

<span data-ttu-id="23651-140">Na przykład użycie kolejek i obiektów blob w aplikacji, można wyłączyć tooput błędy powtarzający operację toohandle oddzielny kod dla każdego z nich.</span><span class="sxs-lookup"><span data-stu-id="23651-140">For example, if you use queues and blobs in your application, you may decide tooput in separate code toohandle retryable errors for each of these.</span></span> <span data-ttu-id="23651-141">Następnie Jeśli ponowna próba możesz pobrać z usługi blob hello, ale nadal działa usługa kolejki hello, jest ograniczona tylko hello część aplikacji, która obsługuje obiekty BLOB.</span><span class="sxs-lookup"><span data-stu-id="23651-141">Then if you get a retry from hello blob service, but hello queue service is still working, only hello part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="23651-142">Jeśli zdecydujesz toohandle wszystkie usługi magazynu ponowi próbę objęty i wywołanie usługi blob toohello zwraca błąd powtarzający operację, a następnie żądań tooboth hello obiektu blob usługi i kolejki hello jest ograniczona.</span><span class="sxs-lookup"><span data-stu-id="23651-142">If you decide toohandle all storage service retries generically and a call toohello blob service returns a retryable error, then requests tooboth hello blob service and hello queue service will be impacted.</span></span>

<span data-ttu-id="23651-143">Ostatecznie zależy od stopnia złożoności hello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-143">Ultimately, this depends on hello complexity of your application.</span></span> <span data-ttu-id="23651-144">Może się okazać nie toohandle hello błędów przez usługę, ale zamiast tego tooredirect żądania dla wszystkich usług toohello dodatkowej region magazynu odczytu i uruchomienia aplikacji hello w trybie tylko do odczytu, w przypadku wykrycia problemu z dowolnej usługi magazynu w regionie podstawowym hello.</span><span class="sxs-lookup"><span data-stu-id="23651-144">You may decide not toohandle hello failures by service, but instead tooredirect read requests for all storage services toohello secondary region and run hello application in read-only mode when you detect a problem with any storage service in hello primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="23651-145">Inne zagadnienia</span><span class="sxs-lookup"><span data-stu-id="23651-145">Other considerations</span></span>

<span data-ttu-id="23651-146">Są one hello innych kwestii, które omówimy hello dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="23651-146">These are hello other considerations we will discuss in hello rest of this article.</span></span>

*   <span data-ttu-id="23651-147">Obsługa ponownych prób przy użyciu wzorca wyłącznika hello żądań odczytu</span><span class="sxs-lookup"><span data-stu-id="23651-147">Handling retries of read requests using hello Circuit Breaker pattern</span></span>

*   <span data-ttu-id="23651-148">Po pewnym czasie spójności danych i hello czas ostatniej synchronizacji</span><span class="sxs-lookup"><span data-stu-id="23651-148">Eventually-consistent data and hello Last Sync Time</span></span>

*   <span data-ttu-id="23651-149">Testowanie</span><span class="sxs-lookup"><span data-stu-id="23651-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="23651-150">Uruchamiania aplikacji w trybie tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="23651-150">Running your application in read-only mode</span></span>

<span data-ttu-id="23651-151">toouse magazynu RA-GRS, musi być żądaniami odczytu stanie toohandle zarówno nie powiodło się i nieudane żądania aktualizacji (z aktualizacji w takim przypadku oznacza wstawiania, aktualizacji i usunięć).</span><span class="sxs-lookup"><span data-stu-id="23651-151">toouse RA-GRS storage, you must be able toohandle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="23651-152">Jeśli hello centrum danych podstawowych kończy się niepowodzeniem, przeczytaj żądania mogą być przekierowane toohello centrum danych dodatkowej, ale nie żądań aktualizacji, ponieważ dodatkowej hello jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-152">If hello primary data center fails, read requests can be redirected toohello secondary data center, but update requests cannot because hello secondary is read only.</span></span> <span data-ttu-id="23651-153">Z tego powodu należy niektórych toorun sposób aplikację w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-153">For this reason, you need some way toorun your application in read-only mode.</span></span>

<span data-ttu-id="23651-154">Na przykład można ustawić flagi, który będzie sprawdzany przed przesłaniem usługi magazynu toohello żądania aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="23651-154">For example, you can set a flag that will be checked before submitting any update requests toohello storage service.</span></span> <span data-ttu-id="23651-155">Jeśli jedno z żądań aktualizacji hello pochodzi za pośrednictwem, możesz pominąć go i zwraca klienta toohello właściwą odpowiedź.</span><span class="sxs-lookup"><span data-stu-id="23651-155">When one of hello update requests comes through, you can skip it and return an appropriate response toohello customer.</span></span> <span data-ttu-id="23651-156">Możesz nawet mają toodisable całkowicie niektórych funkcji, dopóki nie zostanie rozwiązany hello problem i Powiadom użytkowników, że te funkcje są tymczasowo niedostępne.</span><span class="sxs-lookup"><span data-stu-id="23651-156">You may even want toodisable certain features altogether until hello problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="23651-157">Jeśli zdecydujesz oddzielnie toohandle błędów dla każdej usługi, należy również toohandle hello możliwości toorun aplikację w trybie tylko do odczytu przez usługę.</span><span class="sxs-lookup"><span data-stu-id="23651-157">If you decide toohandle errors for each service separately, you will also need toohandle hello ability toorun your application in read-only mode by service.</span></span> <span data-ttu-id="23651-158">Może mieć flagi tylko do odczytu dla wszystkich usług, które mogą być włączone, a następnie wyłączone, a uchwyt hello odpowiednie flagi w odpowiednich miejscach hello w kodzie.</span><span class="sxs-lookup"><span data-stu-id="23651-158">You could have read-only flags for each service that can be enabled and disabled and handle hello appropriate flag in hello appropriate places in your code.</span></span>

<span data-ttu-id="23651-159">Trwa toorun stanie aplikacji w trybie tylko do odczytu ma inny korzyści po stronie — udostępnia tooensure możliwości hello ograniczoną funkcjonalność podczas uaktualniania najważniejszych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-159">Being able toorun your application in read-only mode has another side benefit – it gives you hello ability tooensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="23651-160">Możesz wyzwolić toorun Twojej aplikacji w trybie tylko do odczytu trybu i toohello punktu dodatkowej centrum danych, zapewnienie, że nikt nie korzysta z hello danych w regionie podstawowym hello podczas nawiązywania uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="23651-160">You can trigger your application toorun in read-only mode and point toohello secondary data center, ensuring nobody is accessing hello data in hello primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="23651-161">Obsługa aktualizacji w trybie tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="23651-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="23651-162">Istnieje wiele sposobów aktualizacji toohandle żądań w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-162">There are many ways toohandle update requests when running in read-only mode.</span></span> <span data-ttu-id="23651-163">Firma Microsoft nie obejmuje to kompleksowe, ale ogólnie rzecz biorąc, istnieje kilka wzorców, które należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="23651-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="23651-164">Można odpowiadać tooyour użytkownika i poinformuj go, że nie są obecnie akceptuje aktualizacje.</span><span class="sxs-lookup"><span data-stu-id="23651-164">You can respond tooyour user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="23651-165">Na przykład system zarządzania kontaktami można włączyć informacje kontaktowe tooaccess klientów, ale nie aktualizowanie.</span><span class="sxs-lookup"><span data-stu-id="23651-165">For example, a contact management system could enable customers tooaccess contact information but not make updates.</span></span>

2.  <span data-ttu-id="23651-166">Można umieścić w kolejce aktualizacje w innym regionie.</span><span class="sxs-lookup"><span data-stu-id="23651-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="23651-167">W takim przypadku czy zapisu tooa kolejki żądań oczekujących aktualizacji w innym regionie i mieć tooprocess sposób te żądania po centrum danych podstawowych hello przejściu do trybu online ponownie.</span><span class="sxs-lookup"><span data-stu-id="23651-167">In this case, you would write your pending update requests tooa queue in a different region, and then have a way tooprocess those requests after hello primary data center comes online again.</span></span> <span data-ttu-id="23651-168">W tym scenariuszu należy udostępnić powitania klienta aktualizację hello żądanie przebywa w kolejce do późniejszego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="23651-168">In this scenario, you should let hello customer know that hello update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="23651-169">Aktualizacje można napisać tooa konta magazynu w innym regionie.</span><span class="sxs-lookup"><span data-stu-id="23651-169">You can write your updates tooa storage account in another region.</span></span> <span data-ttu-id="23651-170">Jeśli centrum danych podstawowych hello wraca do trybu online, możesz korzystać toomerge sposób aktualizacje do danych pierwotnych hello, w zależności od struktury hello hello danych.</span><span class="sxs-lookup"><span data-stu-id="23651-170">Then when hello primary data center comes back online, you can have a way toomerge those updates into hello primary data, depending on hello structure of hello data.</span></span> <span data-ttu-id="23651-171">Na przykład w przypadku tworzenia oddzielnych plików z sygnaturą daty/godziny w nazwie hello, możesz skopiować te pliki regionu podstawowego toohello Wstecz.</span><span class="sxs-lookup"><span data-stu-id="23651-171">For example, if you are creating separate files with a date/time stamp in hello name, you can copy those files back toohello primary region.</span></span> <span data-ttu-id="23651-172">Działa to w przypadku niektórych obciążeń, takich jak dane rejestrowania i iOT.</span><span class="sxs-lookup"><span data-stu-id="23651-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="23651-173">Obsługa ponownych prób</span><span class="sxs-lookup"><span data-stu-id="23651-173">Handling retries</span></span>

<span data-ttu-id="23651-174">Jak ustalić, które błędy są powtarzający operację?</span><span class="sxs-lookup"><span data-stu-id="23651-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="23651-175">Jest to określane za pomocą biblioteki klienta usługi storage hello.</span><span class="sxs-lookup"><span data-stu-id="23651-175">This is determined by hello storage client library.</span></span> <span data-ttu-id="23651-176">Na przykład błąd 404 (nie znaleziono zasobu) nie jest powtarzający operację, ponieważ ponawianie próby jego nie jest prawdopodobnie tooresult w Powodzenie.</span><span class="sxs-lookup"><span data-stu-id="23651-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely tooresult in success.</span></span> <span data-ttu-id="23651-177">Na powitania drugiej strony, 500 Błąd jest powtarzający operację, ponieważ jest to błąd serwera i po prostu może być to problem przejściowy.</span><span class="sxs-lookup"><span data-stu-id="23651-177">On hello other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="23651-178">Aby uzyskać więcej informacji, zapoznaj się z hello [Otwórz kod źródłowy hello klasy ExponentialRetry](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) w hello biblioteki klienta usługi storage platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="23651-178">For more details, check out hello [open source code for hello ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in hello .NET storage client library.</span></span> <span data-ttu-id="23651-179">(Poszukaj hello metody ShouldRetry).</span><span class="sxs-lookup"><span data-stu-id="23651-179">(Look for hello ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="23651-180">Żądań odczytu</span><span class="sxs-lookup"><span data-stu-id="23651-180">Read requests</span></span>

<span data-ttu-id="23651-181">Żądań odczytu może być przekierowane toosecondary magazynu, jeśli występuje problem z magazynem podstawowego.</span><span class="sxs-lookup"><span data-stu-id="23651-181">Read requests can be redirected toosecondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="23651-182">Jak zanotowane powyżej w [przy użyciu ostatecznie spójności danych](#using-eventually-consistent-data), musi być akceptowalne dla twojej aplikacji toopotentially odczytu stare dane.</span><span class="sxs-lookup"><span data-stu-id="23651-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application toopotentially read stale data.</span></span> <span data-ttu-id="23651-183">Jeśli używasz hello magazynu klienta biblioteki tooaccess danych RA-GRS, można określić zachowanie ponawiania hello żądania odczytu, ustawiając wartość hello **LocationMode** tooone właściwości hello następującego:</span><span class="sxs-lookup"><span data-stu-id="23651-183">If you are using hello storage client library tooaccess RA-GRS data, you can specify hello retry behavior of a read request by setting a value for hello **LocationMode** property tooone of hello following:</span></span>

*   <span data-ttu-id="23651-184">**PrimaryOnly** (hello domyślne)</span><span class="sxs-lookup"><span data-stu-id="23651-184">**PrimaryOnly** (hello default)</span></span>

*   <span data-ttu-id="23651-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="23651-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="23651-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="23651-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="23651-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="23651-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="23651-188">Podczas ustawiania hello **LocationMode** za**PrimaryThenSecondary**, jeśli jest to początkowa hello odczytu podstawowy punkt końcowy toohello żądanie zakończy się niepowodzeniem z powodu błędu powtarzającego operację, powitania klienta automatycznie tworzy innego odczytu żądanie toohello dodatkowej punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="23651-188">When you set hello **LocationMode** too**PrimaryThenSecondary**, if hello initial read request toohello primary endpoint fails with a retryable error, hello client automatically makes another read request toohello secondary endpoint.</span></span> <span data-ttu-id="23651-189">Jeśli błąd hello jest limit czasu serwera, następnie powitania klienta będzie mieć toowait dla hello tooexpire limitu czasu przed odbierze błąd powtarzający operację z hello usługi.</span><span class="sxs-lookup"><span data-stu-id="23651-189">If hello error is a server timeout, then hello client will have toowait for hello timeout tooexpire before it receives a retryable error from hello service.</span></span>

<span data-ttu-id="23651-190">Istnieją dwa podstawowe scenariusze tooconsider podczas wybierania się jak Błąd powtarzający operację tooa toorespond:</span><span class="sxs-lookup"><span data-stu-id="23651-190">There are basically two scenarios tooconsider when you are deciding how toorespond tooa retryable error:</span></span>

*   <span data-ttu-id="23651-191">Jest to problem izolowane i podstawowy punkt końcowy toohello kolejne żądania nie zwróci błąd powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="23651-191">This is an isolated problem and subsequent requests toohello primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="23651-192">Przykładem gdy taka sytuacja może wystąpić jest błąd sieci.</span><span class="sxs-lookup"><span data-stu-id="23651-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="23651-193">W tym scenariuszu istnieje żadne pogorszenie wydajności znaczących w o **LocationMode** ustawić także**PrimaryThenSecondary** jak tylko dzieje się rzadko.</span><span class="sxs-lookup"><span data-stu-id="23651-193">In this scenario, there is no significant performance penalty in having **LocationMode** set too**PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="23651-194">Jest to problem z co najmniej jednym hello usług magazynu w regionie podstawowym hello i wszystkie kolejne żądania toothat w regionie podstawowym hello są błędy powtarzający operację prawdopodobnie tooreturn w danym okresie czasu.</span><span class="sxs-lookup"><span data-stu-id="23651-194">This is a problem with at least one of hello storage services in hello primary region and all subsequent requests toothat service in hello primary region are likely tooreturn retryable errors for a period of time.</span></span> <span data-ttu-id="23651-195">Na przykład jest całkowicie niedostępne hello regionu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="23651-195">An example of this is if hello primary region is completely inaccessible.</span></span>

    <span data-ttu-id="23651-196">W tym scenariuszu istnieje spadek wydajności, ponieważ wszystkich żądań odczytu zostanie najpierw spróbuj hello podstawowy punkt końcowy, poczekaj, aż hello tooexpire limitu czasu, a następnie przełączyć toohello dodatkowej punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="23651-196">In this scenario, there is a performance penalty because all your read requests will try hello primary endpoint first, wait for hello timeout tooexpire, then switch toohello secondary endpoint.</span></span>

<span data-ttu-id="23651-197">W tych sytuacjach należy zidentyfikować z trwającej problem z punktem końcowym głównej hello i wysłać wszystkich żądań odczytu bezpośrednio hello toohello dodatkowej punktu końcowego, ustawiając **LocationMode** właściwości zbyt **SecondaryOnly**.</span><span class="sxs-lookup"><span data-stu-id="23651-197">For these scenarios, you should identify that there is an ongoing issue with hello primary endpoint and send all read requests directly toohello secondary endpoint by setting hello **LocationMode** property too**SecondaryOnly**.</span></span> <span data-ttu-id="23651-198">W tej chwili możesz również zmienić toorun aplikacji hello w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-198">At this time, you should also change hello application toorun in read-only mode.</span></span> <span data-ttu-id="23651-199">Takie podejście jest nazywany hello [wzorzec wyłącznika](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="23651-199">This approach is known as hello [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="23651-200">Żądań aktualizacji</span><span class="sxs-lookup"><span data-stu-id="23651-200">Update requests</span></span>

<span data-ttu-id="23651-201">wzorzec wyłącznika Hello może być również zastosowane tooupdate żądań.</span><span class="sxs-lookup"><span data-stu-id="23651-201">hello Circuit Breaker pattern can also be applied tooupdate requests.</span></span> <span data-ttu-id="23651-202">Jednak żądania aktualizacji nie może być przekierowany toosecondary magazynu, który jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-202">However, update requests cannot be redirected toosecondary storage, which is read-only.</span></span> <span data-ttu-id="23651-203">Dla tych wymagań, należy pozostawić hello **LocationMode** właściwość zbyt**PrimaryOnly** (hello domyślną).</span><span class="sxs-lookup"><span data-stu-id="23651-203">For these requests, you should leave hello **LocationMode** property set too**PrimaryOnly** (hello default).</span></span> <span data-ttu-id="23651-204">toohandle te błędy można zastosować żądania metryki toothese — na przykład 10 błędów w wierszu — i po spełnieniu Twojej próg przełączać aplikacji hello w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-204">toohandle these errors, you can apply a metric toothese requests – such as 10 failures in a row – and when your threshold is met, switch hello application into read-only mode.</span></span> <span data-ttu-id="23651-205">Można użyć tych samych metod dla zwracania tryb tooupdate, jak te opisane poniżej w następnej sekcji hello o wzorcu wyłącznika hello hello.</span><span class="sxs-lookup"><span data-stu-id="23651-205">You can use hello same methods for returning tooupdate mode as those described below in hello next section about hello Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="23651-206">Wzorzec wyłącznika</span><span class="sxs-lookup"><span data-stu-id="23651-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="23651-207">Przy użyciu wzorca wyłącznika hello w aplikacji może uniemożliwić ich ponowną próbą wykonania operacji, który jest prawdopodobnie toofail wielokrotnie.</span><span class="sxs-lookup"><span data-stu-id="23651-207">Using hello Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely toofail repeatedly.</span></span> <span data-ttu-id="23651-208">Dzięki temu toorun toocontinue aplikacji hello, a nie zajmuje czasu podczas operacji hello jest wykładniczo ponowione.</span><span class="sxs-lookup"><span data-stu-id="23651-208">It allows hello application toocontinue toorun rather than taking up time while hello operation is retried exponentially.</span></span> <span data-ttu-id="23651-209">Ta funkcja wykrywa także gdy stałe błędów hello, w którym aplikacja hello czasu można hello spróbuj ponownie wykonać operację.</span><span class="sxs-lookup"><span data-stu-id="23651-209">It also detects when hello fault has been fixed, at which time hello application can try hello operation again.</span></span>

### <a name="how-tooimplement-hello-circuit-breaker-pattern"></a><span data-ttu-id="23651-210">Jak tooimplement hello wzorzec wyłącznika</span><span class="sxs-lookup"><span data-stu-id="23651-210">How tooimplement hello circuit breaker pattern</span></span>

<span data-ttu-id="23651-211">tooidentify czy bieżące problem z podstawowy punkt końcowy, można monitorować, jak często klient hello wystąpią błędy powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="23651-211">tooidentify that there is an ongoing problem with a primary endpoint, you can monitor how frequently hello client encounters retryable errors.</span></span> <span data-ttu-id="23651-212">Ponieważ każdy przypadek jest inny, masz toodecide na powitania próg mają toouse dla hello decyzji tooswitch toohello dodatkowej endpoint i uruchamiania aplikacji hello w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-212">Because each case is different, you have toodecide on hello threshold you want toouse for hello decision tooswitch toohello secondary endpoint and run hello application in read-only mode.</span></span> <span data-ttu-id="23651-213">Można na przykład określić tooperform hello przełącznika, jeśli występują błędy 10 w wiersz, w którym nie sukcesów.</span><span class="sxs-lookup"><span data-stu-id="23651-213">For example, you could decide tooperform hello switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="23651-214">Innym przykładem jest tooswitch, jeśli 90% hello żądań w okresie 2-minutowy nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="23651-214">Another example is tooswitch if 90% of hello requests in a 2-minute period fail.</span></span>

<span data-ttu-id="23651-215">W przypadku hello pierwszego scenariusza może po prostu przechowuje licznika niepowodzeń hello i w przypadku powodzenia przed osiągnięciem hello toozero wstecz liczba maksymalna, ustaw hello.</span><span class="sxs-lookup"><span data-stu-id="23651-215">For hello first scenario, you can simply keep a count of hello failures, and if there is a success before reaching hello maximum, set hello count back toozero.</span></span> <span data-ttu-id="23651-216">W scenariuszu drugi hello jednokierunkowej tooimplement jest toouse hello MemoryCache obiektu (.NET).</span><span class="sxs-lookup"><span data-stu-id="23651-216">For hello second scenario, one way tooimplement it is toouse hello MemoryCache object (in .NET).</span></span> <span data-ttu-id="23651-217">Dla każdego żądania dodać pamięć podręczną toohello niż CacheItem., ustawić hello wartość toosuccess (1) lub zakończyć się niepowodzeniem (0) i ustawić minut too2 czas wygaśnięcia powitania od teraz (lub niezależnie od jest Twoje ograniczenia czasu).</span><span class="sxs-lookup"><span data-stu-id="23651-217">For each request, add a CacheItem toohello cache, set hello value toosuccess (1) or fail (0), and set hello expiration time too2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="23651-218">Po osiągnięciu czas wygaśnięcia wpisu hello wpis zostanie automatycznie usunięta.</span><span class="sxs-lookup"><span data-stu-id="23651-218">When an entry's expiration time is reached, hello entry is automatically removed.</span></span> <span data-ttu-id="23651-219">Zapewni to stopniowe okna 2-minutowy.</span><span class="sxs-lookup"><span data-stu-id="23651-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="23651-220">Zawsze, gdy należy Usługa Magazyn toohello żądania można najpierw za pomocą zapytań Linq między hello MemoryCache obiektu toocalculate hello procent powodzenia sumowanie wartości hello i podział według liczby hello.</span><span class="sxs-lookup"><span data-stu-id="23651-220">Each time you make a request toohello storage service, you first use a Linq query across hello MemoryCache object toocalculate hello percent success by summing hello values and dividing by hello count.</span></span> <span data-ttu-id="23651-221">Jeśli procent powodzenia hello spadnie poniżej progu, niektóre (na przykład 10%), należy skonfigurować hello **LocationMode** właściwości dla żądań odczytu zbyt**SecondaryOnly** i przełączanie aplikacji hello w trybie tylko do odczytu przed kontynuowanie.</span><span class="sxs-lookup"><span data-stu-id="23651-221">When hello percent success drops below some threshold (such as 10%), set hello **LocationMode** property for read requests too**SecondaryOnly** and switch hello application into read-only mode before continuing.</span></span>

<span data-ttu-id="23651-222">Próg Hello błędów użyto toodetermine toomake hello przełącznika może się różnić od usługi tooservice w aplikacji, więc należy rozważyć, dzięki czemu można konfigurować parametry.</span><span class="sxs-lookup"><span data-stu-id="23651-222">hello threshold of errors used toodetermine when toomake hello switch may vary from service tooservice in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="23651-223">Jest to również w przypadku, gdy oddzielnie zdecydujesz toohandle błędów powtarzający operację z każdej usługi lub jako jedna, zgodnie z opisem wcześniej.</span><span class="sxs-lookup"><span data-stu-id="23651-223">This is also where you decide toohandle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="23651-224">Kolejnym zagadnieniem są jak toohandle wiele wystąpień aplikacji i jakie toodo podczas wykrywania błędów powtarzający operację w każdym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="23651-224">Another consideration is how toohandle multiple instances of an application, and what toodo when you detect retryable errors in each instance.</span></span> <span data-ttu-id="23651-225">Na przykład może być uruchomiony z załadować samego aplikacji hello 20 maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="23651-225">For example, you may have 20 VMs running with hello same application loaded.</span></span> <span data-ttu-id="23651-226">Czy można obsługiwać każde wystąpienie osobno?</span><span class="sxs-lookup"><span data-stu-id="23651-226">Do you handle each instance separately?</span></span> <span data-ttu-id="23651-227">Jeśli jedno wystąpienie rozpoczyna się problemy, chcesz toolimit hello odpowiedzi toojust tego jedno wystąpienie lub chcesz tootry toohave wszystkich wystąpień odpowiadają w hello sam sposób, jeśli jedno wystąpienie ma problem?</span><span class="sxs-lookup"><span data-stu-id="23651-227">If one instance starts having problems, do you want toolimit hello response toojust that one instance, or do you want tootry toohave all instances respond in hello same way when one instance has a problem?</span></span> <span data-ttu-id="23651-228">Obsługa wystąpień hello oddzielnie jest znacznie prostsze niż w trakcie odpowiedź hello toocoordinate między nimi, ale jak to zrobić zależy od architektury aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-228">Handling hello instances separately is much simpler than trying toocoordinate hello response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-hello-error-frequency"></a><span data-ttu-id="23651-229">Opcje monitorowania hello częstotliwość błędów</span><span class="sxs-lookup"><span data-stu-id="23651-229">Options for monitoring hello error frequency</span></span>

<span data-ttu-id="23651-230">Możliwe są trzy główne monitorowania hello częstotliwość ponownych prób w regionie podstawowym hello w kolejności toodetermine, gdy tooswitch w regionie pomocniczym toohello i zmień hello toorun aplikacji w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-230">You have three main options for monitoring hello frequency of retries in hello primary region in order toodetermine when tooswitch over toohello secondary region and change hello application toorun in read-only mode.</span></span>

*   <span data-ttu-id="23651-231">Dodaj obsługę hello [ **ponawianie** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) zdarzeń na powitania [ **elementu OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) obiekt przekazywania żądań magazynu tooyour — jest to hello Metoda wyświetlane w tym artykule i używane w hello towarzyszące próbki.</span><span class="sxs-lookup"><span data-stu-id="23651-231">Add a handler for hello [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on hello [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass tooyour storage requests – this is hello method displayed in this article and used in hello accompanying sample.</span></span> <span data-ttu-id="23651-232">Te zdarzenia wyzwalać zawsze, gdy klient hello ponawia próbę żądania, umożliwiając jak często tootrack powitania klienta napotka powtarzający operację błędów na podstawowy punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="23651-232">These events fire whenever hello client retries a request, enabling you tootrack how often hello client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in hello primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="23651-233">W hello [ **Evaluate** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) metody w zasadach niestandardowych ponownych prób, można uruchomić niestandardowego kodu przy każdym ponowna próba ma miejsce.</span><span class="sxs-lookup"><span data-stu-id="23651-233">In hello [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="23651-234">W przypadku dodawania toorecording przypadku ponowna próba takim również zapewnia hello możliwości toomodify Twojego zachowanie ponów próbę.</span><span class="sxs-lookup"><span data-stu-id="23651-234">In addition toorecording when a retry happens, this also gives you hello opportunity toomodify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in hello primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="23651-235">Witaj trzeci podejście jest tooimplement niestandardowych składnik monitorowania aplikacji, która stale wysyła pakiet usługi ping punktu końcowego podstawowego magazynu z manekina odczytu toodetermine żądań (takich jak odczytywanie małych obiektów blob) jej kondycji.</span><span class="sxs-lookup"><span data-stu-id="23651-235">hello third approach is tooimplement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) toodetermine its health.</span></span> <span data-ttu-id="23651-236">To może potrwać niektórych zasobów, ale nie znacznej ilości.</span><span class="sxs-lookup"><span data-stu-id="23651-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="23651-237">Gdy problem zostanie odnaleziony, który osiągnie Twojej próg, następnie przeprowadza się przełącznika hello zbyt**SecondaryOnly** i w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="23651-237">When a problem is discovered that reaches your threshold, you would then perform hello switch too**SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="23651-238">W pewnym momencie można tooswitch toousing wstecz hello podstawowy punkt końcowy, dzięki czemu aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="23651-238">At some point, you will want tooswitch back toousing hello primary endpoint and allowing updates.</span></span> <span data-ttu-id="23651-239">Jeśli przy użyciu jednej z dwóch pierwszych metod hello wymienionych powyżej, może po prostu przełącznika wstecz toohello podstawowy punkt końcowy i włączyć tryb aktualizacji po przeprowadzono dowolnie wybranego przedziału czasu lub liczba operacji.</span><span class="sxs-lookup"><span data-stu-id="23651-239">If using one of hello first two methods listed above, you could simply switch back toohello primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="23651-240">Następnie można pozostawić ją ponownie przejść przez logikę ponawiania hello.</span><span class="sxs-lookup"><span data-stu-id="23651-240">You can then let it go through hello retry logic again.</span></span> <span data-ttu-id="23651-241">Jeśli hello problem został rozwiązany, utworzy kontynuować podstawowy punkt końcowy toouse hello i zezwolić na aktualizacje.</span><span class="sxs-lookup"><span data-stu-id="23651-241">If hello problem has been fixed, it will continue toouse hello primary endpoint and allow updates.</span></span> <span data-ttu-id="23651-242">Jeżeli problem nadal występuje, go jeszcze raz Przechodzi wstecz toohello dodatkowej punktu końcowego i trybie tylko do odczytu po nieudanym hello kryteria, które zostały ustawione.</span><span class="sxs-lookup"><span data-stu-id="23651-242">If there is still a problem, it will once more switch back toohello secondary endpoint and read-only mode after failing hello criteria you've set.</span></span>

<span data-ttu-id="23651-243">Trzeci scenariusz hello, gdy badanie końcowego podstawowego magazynu hello staje się pomyślnie, możesz wyzwolić hello Wróć za**PrimaryOnly** i kontynuować stosowanie aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="23651-243">For hello third scenario, when pinging hello primary storage endpoint becomes successful again, you can trigger hello switch back too**PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="23651-244">Obsługa ostatecznie spójność danych</span><span class="sxs-lookup"><span data-stu-id="23651-244">Handling eventually consistent data</span></span>

<span data-ttu-id="23651-245">RA-GRS polega na replikowanie transakcji z regionu pomocniczego hello toohello podstawowego.</span><span class="sxs-lookup"><span data-stu-id="23651-245">RA-GRS works by replicating transactions from hello primary toohello secondary region.</span></span> <span data-ttu-id="23651-246">Ten proces replikacji gwarantuje, że hello danych w regionie pomocniczym hello jest *ostatecznie spójne*.</span><span class="sxs-lookup"><span data-stu-id="23651-246">This replication process guarantees that hello data in hello secondary region is *eventually consistent*.</span></span> <span data-ttu-id="23651-247">Oznacza to, że wszystkie transakcje hello w regionie podstawowym hello ostatecznie pojawią się w regionie pomocniczym hello, ale może wystąpić opóźnienie przed wyświetleniem i że nie ma żadnej gwarancji transakcji hello przychodzą w regionie pomocniczym hello w porządku takie same jak hello czy w jakiej były pierwotnie stosowane w regionie podstawowym hello.</span><span class="sxs-lookup"><span data-stu-id="23651-247">This means that all hello transactions in hello primary region will eventually appear in hello secondary region, but that there may be a lag before they appear, and that there is no guarantee hello transactions arrive in hello secondary region in hello same order as that in which they were originally applied in hello primary region.</span></span> <span data-ttu-id="23651-248">Jeśli transakcje przychodzą w regionie pomocniczym hello poza kolejnością, możesz *może* należy wziąć pod uwagę dane toobe region pomocniczy hello w stanie niespójnym, dopóki usługa hello wyrównania.</span><span class="sxs-lookup"><span data-stu-id="23651-248">If your transactions arrive in hello secondary region out of order, you *may* consider your data in hello secondary region toobe in an inconsistent state until hello service catches up.</span></span>

<span data-ttu-id="23651-249">Witaj poniższej tabeli przedstawiono przykład co może się zdarzyć, gdy aktualizować hello szczegóły toomake pracownika jej członkiem hello *Administratorzy* roli.</span><span class="sxs-lookup"><span data-stu-id="23651-249">hello following table shows an example of what might happen when you update hello details of an employee toomake her a member of hello *administrators* role.</span></span> <span data-ttu-id="23651-250">Dla zapewnienia hello w tym przykładzie, wymaga aktualizacji hello **pracownika** jednostki i aktualizacji **roli administrator** jednostki wraz z liczbą hello łączna liczba administratorów.</span><span class="sxs-lookup"><span data-stu-id="23651-250">For hello sake of this example, this requires you update hello **employee** entity and update an **administrator role** entity with a count of hello total number of administrators.</span></span> <span data-ttu-id="23651-251">Zwróć uwagę, jak hello aktualizacji są stosowane poza kolejnością w regionie pomocniczym hello.</span><span class="sxs-lookup"><span data-stu-id="23651-251">Notice how hello updates are applied out of order in hello secondary region.</span></span>

| <span data-ttu-id="23651-252">**Czas**</span><span class="sxs-lookup"><span data-stu-id="23651-252">**Time**</span></span> | <span data-ttu-id="23651-253">**Transakcji**</span><span class="sxs-lookup"><span data-stu-id="23651-253">**Transaction**</span></span>                                            | <span data-ttu-id="23651-254">**Replikacja**</span><span class="sxs-lookup"><span data-stu-id="23651-254">**Replication**</span></span>                       | <span data-ttu-id="23651-255">**Czas ostatniej synchronizacji**</span><span class="sxs-lookup"><span data-stu-id="23651-255">**Last Sync Time**</span></span> | <span data-ttu-id="23651-256">**Wynik**</span><span class="sxs-lookup"><span data-stu-id="23651-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="23651-257">T0</span><span class="sxs-lookup"><span data-stu-id="23651-257">T0</span></span>       | <span data-ttu-id="23651-258">Transakcja A:</span><span class="sxs-lookup"><span data-stu-id="23651-258">Transaction A:</span></span> <br> <span data-ttu-id="23651-259">Wstaw pracownika</span><span class="sxs-lookup"><span data-stu-id="23651-259">Insert employee</span></span> <br> <span data-ttu-id="23651-260">jednostki w podstawowej</span><span class="sxs-lookup"><span data-stu-id="23651-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="23651-261">Transakcja A dodaje tooprimary,</span><span class="sxs-lookup"><span data-stu-id="23651-261">Transaction A inserted tooprimary,</span></span><br> <span data-ttu-id="23651-262">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-262">not replicated yet.</span></span> |
| <span data-ttu-id="23651-263">T1</span><span class="sxs-lookup"><span data-stu-id="23651-263">T1</span></span>       |                                                            | <span data-ttu-id="23651-264">Transakcja A</span><span class="sxs-lookup"><span data-stu-id="23651-264">Transaction A</span></span> <br> <span data-ttu-id="23651-265">Replikacja</span><span class="sxs-lookup"><span data-stu-id="23651-265">replicated to</span></span><br> <span data-ttu-id="23651-266">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="23651-266">secondary</span></span> | <span data-ttu-id="23651-267">T1</span><span class="sxs-lookup"><span data-stu-id="23651-267">T1</span></span> | <span data-ttu-id="23651-268">Transakcja A replikowane toosecondary.</span><span class="sxs-lookup"><span data-stu-id="23651-268">Transaction A replicated toosecondary.</span></span> <br><span data-ttu-id="23651-269">Czas ostatniej synchronizacji aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="23651-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="23651-270">T2</span><span class="sxs-lookup"><span data-stu-id="23651-270">T2</span></span>       | <span data-ttu-id="23651-271">Transakcja B:</span><span class="sxs-lookup"><span data-stu-id="23651-271">Transaction B:</span></span><br><span data-ttu-id="23651-272">Aktualizacja</span><span class="sxs-lookup"><span data-stu-id="23651-272">Update</span></span><br> <span data-ttu-id="23651-273">Jednostka pracownika</span><span class="sxs-lookup"><span data-stu-id="23651-273">employee entity</span></span><br> <span data-ttu-id="23651-274">w podstawowej</span><span class="sxs-lookup"><span data-stu-id="23651-274">in primary</span></span>  |                                | <span data-ttu-id="23651-275">T1</span><span class="sxs-lookup"><span data-stu-id="23651-275">T1</span></span>                 | <span data-ttu-id="23651-276">Transakcja B zapisywane tooprimary,</span><span class="sxs-lookup"><span data-stu-id="23651-276">Transaction B written tooprimary,</span></span><br> <span data-ttu-id="23651-277">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-277">not replicated yet.</span></span>  |
| <span data-ttu-id="23651-278">T3</span><span class="sxs-lookup"><span data-stu-id="23651-278">T3</span></span>       | <span data-ttu-id="23651-279">Transakcja C:</span><span class="sxs-lookup"><span data-stu-id="23651-279">Transaction C:</span></span><br> <span data-ttu-id="23651-280">Aktualizacja</span><span class="sxs-lookup"><span data-stu-id="23651-280">Update</span></span> <br><span data-ttu-id="23651-281">Administrator</span><span class="sxs-lookup"><span data-stu-id="23651-281">administrator</span></span><br><span data-ttu-id="23651-282">Jednostka roli w</span><span class="sxs-lookup"><span data-stu-id="23651-282">role entity in</span></span><br><span data-ttu-id="23651-283">podstawowy</span><span class="sxs-lookup"><span data-stu-id="23651-283">primary</span></span> |                    | <span data-ttu-id="23651-284">T1</span><span class="sxs-lookup"><span data-stu-id="23651-284">T1</span></span>                 | <span data-ttu-id="23651-285">Transakcja zapisywane tooprimary, C</span><span class="sxs-lookup"><span data-stu-id="23651-285">Transaction C written tooprimary,</span></span><br> <span data-ttu-id="23651-286">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-286">not replicated yet.</span></span>  |
| <span data-ttu-id="23651-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="23651-287">*T4*</span></span>     |                                                       | <span data-ttu-id="23651-288">Transakcja C</span><span class="sxs-lookup"><span data-stu-id="23651-288">Transaction C</span></span> <br><span data-ttu-id="23651-289">Replikacja</span><span class="sxs-lookup"><span data-stu-id="23651-289">replicated to</span></span><br> <span data-ttu-id="23651-290">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="23651-290">secondary</span></span> | <span data-ttu-id="23651-291">T1</span><span class="sxs-lookup"><span data-stu-id="23651-291">T1</span></span>         | <span data-ttu-id="23651-292">Transakcja C replikowane toosecondary.</span><span class="sxs-lookup"><span data-stu-id="23651-292">Transaction C replicated toosecondary.</span></span><br><span data-ttu-id="23651-293">Nie zaktualizowano ponieważ LastSyncTime</span><span class="sxs-lookup"><span data-stu-id="23651-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="23651-294">Transakcja B nie został jeszcze zreplikowany.</span><span class="sxs-lookup"><span data-stu-id="23651-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="23651-295">*T5*</span><span class="sxs-lookup"><span data-stu-id="23651-295">*T5*</span></span>     | <span data-ttu-id="23651-296">Odczyt jednostek</span><span class="sxs-lookup"><span data-stu-id="23651-296">Read entities</span></span> <br><span data-ttu-id="23651-297">pomocniczej</span><span class="sxs-lookup"><span data-stu-id="23651-297">from secondary</span></span>                           |                                  | <span data-ttu-id="23651-298">T1</span><span class="sxs-lookup"><span data-stu-id="23651-298">T1</span></span>                 | <span data-ttu-id="23651-299">Hello jest przestarzała wartość dla pracowników</span><span class="sxs-lookup"><span data-stu-id="23651-299">You get hello stale value for employee</span></span> <br> <span data-ttu-id="23651-300">jednostki, ponieważ nie transakcji B</span><span class="sxs-lookup"><span data-stu-id="23651-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="23651-301">jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-301">replicated yet.</span></span> <span data-ttu-id="23651-302">Pobierz hello nową wartość</span><span class="sxs-lookup"><span data-stu-id="23651-302">You get hello new value for</span></span><br> <span data-ttu-id="23651-303">Administrator roli jednostki, ponieważ ma C</span><span class="sxs-lookup"><span data-stu-id="23651-303">administrator role entity because C has</span></span><br> <span data-ttu-id="23651-304">zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-304">replicated.</span></span> <span data-ttu-id="23651-305">Czas ostatniej synchronizacji nadal nie.</span><span class="sxs-lookup"><span data-stu-id="23651-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="23651-306">zostały zaktualizowane, ponieważ transakcja B</span><span class="sxs-lookup"><span data-stu-id="23651-306">been updated because transaction B</span></span><br> <span data-ttu-id="23651-307">nie replikowane.</span><span class="sxs-lookup"><span data-stu-id="23651-307">hasn't replicated.</span></span> <span data-ttu-id="23651-308">Można określić</span><span class="sxs-lookup"><span data-stu-id="23651-308">You can tell the</span></span><br><span data-ttu-id="23651-309">Jednostka roli administratora jest niespójna</span><span class="sxs-lookup"><span data-stu-id="23651-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="23651-310">ponieważ po hello jednostek daty/godziny</span><span class="sxs-lookup"><span data-stu-id="23651-310">because hello entity date/time is after</span></span> <br><span data-ttu-id="23651-311">Witaj czas ostatniej synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="23651-311">hello Last Sync Time.</span></span> |
| <span data-ttu-id="23651-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="23651-312">*T6*</span></span>     |                                                      | <span data-ttu-id="23651-313">Transakcja B</span><span class="sxs-lookup"><span data-stu-id="23651-313">Transaction B</span></span><br> <span data-ttu-id="23651-314">Replikacja</span><span class="sxs-lookup"><span data-stu-id="23651-314">replicated to</span></span><br> <span data-ttu-id="23651-315">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="23651-315">secondary</span></span> | <span data-ttu-id="23651-316">T6</span><span class="sxs-lookup"><span data-stu-id="23651-316">T6</span></span>                 | <span data-ttu-id="23651-317">*T6* — wszystkie transakcje za pomocą C</span><span class="sxs-lookup"><span data-stu-id="23651-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="23651-318">zostały zreplikowane, czas ostatniej synchronizacji</span><span class="sxs-lookup"><span data-stu-id="23651-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="23651-319">jest aktualizowana.</span><span class="sxs-lookup"><span data-stu-id="23651-319">is updated.</span></span> |

<span data-ttu-id="23651-320">W tym przykładzie założono powitania klienta przełączniki tooreading z regionu pomocniczego hello w T5.</span><span class="sxs-lookup"><span data-stu-id="23651-320">In this example, assume hello client switches tooreading from hello secondary region at T5.</span></span> <span data-ttu-id="23651-321">Można pomyślnie odczytać hello **roli administrator** jednostki, w tym momencie, ale jednostki hello zawiera wartość dla liczby hello administratorów nie jest zgodna z liczbą hello **pracownika** jednostek oznaczonych jako administratorów w regionie pomocniczym hello w tej chwili.</span><span class="sxs-lookup"><span data-stu-id="23651-321">It can successfully read hello **administrator role** entity at this time, but hello entity contains a value for hello count of administrators that is not consistent with hello number of **employee** entities that are marked as administrators in hello secondary region at this time.</span></span> <span data-ttu-id="23651-322">Klient może po prostu wyświetlaj tej wartości, z ryzykiem hello jest niespójne informacje.</span><span class="sxs-lookup"><span data-stu-id="23651-322">Your client could simply display this value, with hello risk that it is inconsistent information.</span></span> <span data-ttu-id="23651-323">Alternatywnie powitania klienta może próbować toodetermine tego hello **roli administrator** jest w stanie potencjalnie niespójności, ponieważ aktualizacje hello wystąpiło poza kolejnością, a następnie powiadamia użytkownika hello o tym fakcie.</span><span class="sxs-lookup"><span data-stu-id="23651-323">Alternatively, hello client could attempt toodetermine that hello **administrator role** is in a potentially inconsistent state because hello updates have happened out of order, and then inform hello user of this fact.</span></span>

<span data-ttu-id="23651-324">toorecognize ma potencjalnie niespójne dane, powitania klienta można użyć wartości hello hello *czas ostatniej synchronizacji* czy można uzyskać w dowolnym momencie przez zapytanie do usługi magazynu.</span><span class="sxs-lookup"><span data-stu-id="23651-324">toorecognize that it has potentially inconsistent data, hello client can use hello value of hello *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="23651-325">Oznacza to, czas hello podczas ostatniego hello danych w regionie pomocniczym hello spójne i miał stosowania usługi hello hello wszystkie transakcje toothat wcześniejszego punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="23651-325">This tells you hello time when hello data in hello secondary region was last consistent and when hello service had applied all hello transactions prior toothat point in time.</span></span> <span data-ttu-id="23651-326">W powyższym po usługi hello wstawia hello przykład Witaj **pracownika** jednostek w regionie pomocniczym hello, hello czas ostatniej synchronizacji jest ustawiona zbyt*T1*.</span><span class="sxs-lookup"><span data-stu-id="23651-326">In hello example shown above, after hello service inserts hello **employee** entity in hello secondary region, hello last sync time is set too*T1*.</span></span> <span data-ttu-id="23651-327">Pozostaje w *T1* dopóki aktualizacje usługi hello hello **pracownika** jednostki w regionie pomocniczym hello, gdy są zbyt*T6*.</span><span class="sxs-lookup"><span data-stu-id="23651-327">It remains at *T1* until hello service updates hello **employee** entity in hello secondary region when it is set too*T6*.</span></span> <span data-ttu-id="23651-328">Jeśli klient hello pobiera hello czas ostatniej synchronizacji, gdy odczytuje hello jednostki w *T5*, można porównać ją ze znacznikiem czasu hello na powitania jednostki.</span><span class="sxs-lookup"><span data-stu-id="23651-328">If hello client retrieves hello last sync time when it reads hello entity at *T5*, it can compare it with hello timestamp on hello entity.</span></span> <span data-ttu-id="23651-329">Jeśli znacznik czasu hello jednostki hello jest nowsza niż hello ostatniej synchronizacji czasu, hello jednostka jest w stanie potencjalnie niespójności i może zająć niezależnie od jest hello odpowiednie działanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="23651-329">If hello timestamp on hello entity is later than hello last sync time, then hello entity is in a potentially inconsistent state, and you can take whatever is hello appropriate action for your application.</span></span> <span data-ttu-id="23651-330">To pole wymaga znać ukończenia hello ostatniej aktualizacji toohello podstawowego.</span><span class="sxs-lookup"><span data-stu-id="23651-330">Using this field requires that you know when hello last update toohello primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="23651-331">Testowanie</span><span class="sxs-lookup"><span data-stu-id="23651-331">Testing</span></span>

<span data-ttu-id="23651-332">Jest ważne tootest, która aplikacja działa zgodnie z oczekiwaniami w przypadku wykrycia błędów powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="23651-332">It's important tootest that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="23651-333">Na przykład należy tootest, który hello dodatkowej toohello przełączniki aplikacji i w trybie tylko do odczytu wykryje problem, a następnie przełącza z powrotem po regionu podstawowego hello staje się dostępna ponownie.</span><span class="sxs-lookup"><span data-stu-id="23651-333">For example, you need tootest that hello application switches toohello secondary and into read-only mode when it detects a problem, and switches back when hello primary region becomes available again.</span></span> <span data-ttu-id="23651-334">toodo, to należy błędy powtarzający operację toosimulate sposób i kontroli, jak często występują.</span><span class="sxs-lookup"><span data-stu-id="23651-334">toodo this, you need a way toosimulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="23651-335">Można użyć [Fiddler](http://www.telerik.com/fiddler) toointercept i modyfikowania odpowiedzi HTTP w skrypcie.</span><span class="sxs-lookup"><span data-stu-id="23651-335">You can use [Fiddler](http://www.telerik.com/fiddler) toointercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="23651-336">Ten skrypt można zidentyfikować odpowiedzi, które pochodzą od podstawowego punktu końcowego i zmienić tooone kod stanu HTTP hello powitalne tej biblioteki klienta magazynu jest rozpoznawany jako Błąd powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="23651-336">This script can identify responses that come from your primary endpoint and change hello HTTP status code tooone that hello Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="23651-337">Następujący fragment kodu przedstawiono prosty przykład skryptu Fiddler, który przechwytuje żądania tooread odpowiedzi przed hello **employeedata** tooreturn tabeli 502 stanu:</span><span class="sxs-lookup"><span data-stu-id="23651-337">This code snippet shows a simple example of a Fiddler script that intercepts responses tooread requests against hello **employeedata** table tooreturn a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="23651-338">Można rozszerzyć toointercept ten przykład większej liczby żądań i zmieniać tylko hello **responseCode** na niektórych z nich toobetter symulowania rzeczywistych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="23651-338">You could extend this example toointercept a wider range of requests and only change hello **responseCode** on some of them toobetter simulate a real-world scenario.</span></span> <span data-ttu-id="23651-339">Aby uzyskać więcej informacji dotyczących dostosowywania Fiddler skryptów, zobacz [modyfikowanie żądania lub odpowiedzi](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) w hello dokumentacji Fiddler.</span><span class="sxs-lookup"><span data-stu-id="23651-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello Fiddler documentation.</span></span>

<span data-ttu-id="23651-340">Jeśli wprowadzono przełączanie aplikacji tylko tooread tryb można skonfigurować progi hello będzie ułatwia zachowanie hello tootest z woluminami transakcji nieprodukcyjnych.</span><span class="sxs-lookup"><span data-stu-id="23651-340">If you have made hello thresholds for switching your application tooread-only mode configurable, it will be easier tootest hello behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="23651-341">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="23651-341">Next Steps</span></span>

* <span data-ttu-id="23651-342">Aby uzyskać więcej informacji o dostęp do odczytu-nadmiarowość geograficzna, łącznie z innym przykładem konfiguracji hello LastSyncTime, zobacz [opcje nadmiarowość magazynu Azure dla systemu Windows i dostęp do odczytu z magazynu geograficznie nadmiarowego magazynu](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="23651-342">For more information about Read Access Geo-Redundancy, including another example of how hello LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="23651-343">Kompletnego przykładu przedstawiający sposób toomake hello przełącznika i z powrotem między punktami końcowymi podstawowe i pomocnicze hello, zobacz [przykłady Azure — przy użyciu hello wyłącznika wzorca z magazynem RA-GRS](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="23651-343">For a complete sample showing how toomake hello switch back and forth between hello Primary and Secondary endpoints, please see [Azure Samples – Using hello Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
