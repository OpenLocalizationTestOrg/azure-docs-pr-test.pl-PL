---
title: "Projektowanie wysokiej dostępności aplikacji przy użyciu magazynu geograficznie nadmiarowego Azure dostęp do odczytu (RA-GRS) | Dokumentacja firmy Microsoft"
description: "Jak używać magazynu Azure RA-GRS do projektowania aplikacji wysokiej dostępności jest wystarczająco elastyczny, aby obsłużyć awarie."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: adc7e23d8c9f869f2951490020e3d0f1a2b2e81c
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="8180e-103">Projektowanie wysokiej dostępności aplikacji przy użyciu RA-GRS</span><span class="sxs-lookup"><span data-stu-id="8180e-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="8180e-104">Typową funkcją infrastruktury opartej na chmurze jest zapewniają platformy wysokiej dostępności do obsługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="8180e-105">Deweloperzy aplikacji opartych na chmurze należy starannie rozważyć sposób korzystania z tej platformie aplikacje wysokiej dostępności dla użytkowników.</span><span class="sxs-lookup"><span data-stu-id="8180e-105">Developers of cloud-based applications must consider carefully how to leverage this platform to deliver highly available applications to their users.</span></span> <span data-ttu-id="8180e-106">Ten artykuł dotyczy w szczególności sposób deweloperzy mogą używać Azure magazynu dostęp do odczytu z magazynu geograficznie nadmiarowego magazynu (RA-GRS) do udostępnienia ich aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-106">This article focuses specifically on how developers can use the Azure Storage Read Access Geo Redundant Storage (RA-GRS) to make their applications more available.</span></span>

<span data-ttu-id="8180e-107">Istnieją cztery opcje nadmiarowości — LRS (magazyn lokalnie nadmiarowy), ZRS (strefy nadmiarowego magazynu), GRS (magazyn geograficznie nadmiarowy) i RA-GRS (magazyn geograficznie nadmiarowy dostęp do odczytu).</span><span class="sxs-lookup"><span data-stu-id="8180e-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="8180e-108">Zamierzamy omówienia GRS i RA-GRS, w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="8180e-108">We are going to discuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="8180e-109">W wypadku magazynu GRS trzy kopie danych są przechowywane w regionie podstawowym wybranej podczas konfigurowania konta magazynu.</span><span class="sxs-lookup"><span data-stu-id="8180e-109">With GRS, three copies of your data are kept in the primary region you selected when setting up the storage account.</span></span> <span data-ttu-id="8180e-110">Trzy dodatkowe kopie są obsługiwane asynchronicznie w regionie pomocniczym określony przez platformę Azure.</span><span class="sxs-lookup"><span data-stu-id="8180e-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="8180e-111">RA-GRS jest odpowiednikiem GRS z tą różnicą, że masz dostęp do odczytu do dodatkowej kopiowania.</span><span class="sxs-lookup"><span data-stu-id="8180e-111">RA-GRS is the same thing as GRS except that you have read access to the secondary copy.</span></span> <span data-ttu-id="8180e-112">Aby uzyskać więcej informacji na temat opcji nadmiarowość magazynu Azure, zobacz [replikacja usługi Azure Storage](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="8180e-112">For more information about the different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="8180e-113">Artykuł replikacji zawiera także par podstawowych i pomocniczych regionów.</span><span class="sxs-lookup"><span data-stu-id="8180e-113">The replication article also shows the pairings of the primary and secondary regions.</span></span>

<span data-ttu-id="8180e-114">Dostępne są zawarte w tym artykule i link do kompletnego przykładu na końcu, który można pobrać i uruchomić wstawki kodu.</span><span class="sxs-lookup"><span data-stu-id="8180e-114">There are code snippets included in this article, and a link to a complete sample at the end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="8180e-115">Najważniejsze funkcje RA-GRS</span><span class="sxs-lookup"><span data-stu-id="8180e-115">Key features of RA-GRS</span></span>

<span data-ttu-id="8180e-116">Przed omawianiu jak używać magazynu RA-GRS teraz komunikować się o jego właściwości i zachowania.</span><span class="sxs-lookup"><span data-stu-id="8180e-116">Before we talk about how to use RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="8180e-117">Magazyn Azure przechowuje kopię tylko do odczytu danych, które są przechowywane w Twoim regionie podstawowym w regionie pomocniczym; jak wspomniano powyżej, usługa Magazyn Określa lokalizację w regionie pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-117">Azure Storage maintains a read-only copy of the data you store in your primary region in a secondary region; as noted above, the storage service determines the location of the secondary region.</span></span>

* <span data-ttu-id="8180e-118">Kopia tylko do odczytu jest [ostatecznie spójne](https://en.wikipedia.org/wiki/Eventual_consistency) z danymi w regionie podstawowym.</span><span class="sxs-lookup"><span data-stu-id="8180e-118">The read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with the data in the primary region.</span></span>

* <span data-ttu-id="8180e-119">Dla obiektów blob, tabel i kolejek, można zbadać w regionie pomocniczym dla *czas ostatniej synchronizacji* wartość, która informuje, wystąpienia ostatniej replikacji z serwera podstawowego w regionie pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-119">For blobs, tables, and queues, you can query the secondary region for a *Last Sync Time* value that tells you when the last replication from the primary to the secondary region occurred.</span></span> <span data-ttu-id="8180e-120">(To nie jest obsługiwana dla usługi Magazyn plików Azure, która nie ma RA-GRS nadmiarowości w tej chwili.)</span><span class="sxs-lookup"><span data-stu-id="8180e-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="8180e-121">Biblioteka klienta magazynu służy do interakcji z danymi w regionie podstawowym lub pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-121">You can use the Storage Client Library to interact with the data in either the primary or secondary region.</span></span> <span data-ttu-id="8180e-122">Możesz również przekierować żądania automatycznie w regionie pomocniczym odczytu, jeśli upłynie limit czasu odczytu żądania do regionu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="8180e-122">You can also redirect read requests automatically to the secondary region if a read request to the primary region times out.</span></span>

* <span data-ttu-id="8180e-123">Jeśli jest to główna kwestia wpływu na dostępność danych w regionie podstawowym, zespół Azure mogą wyzwalać geograficznie-trybu failover, po czym wpisy DNS, wskazując w regionie podstawowym zostanie zmieniony na wskaż region pomocniczy.</span><span class="sxs-lookup"><span data-stu-id="8180e-123">If there is a major issue affecting the accessibility of the data in the primary region, the Azure team may trigger a geo-failover, at which point the DNS entries pointing to the primary region will be changed to point to the secondary region.</span></span>

* <span data-ttu-id="8180e-124">W przypadku awarię replikacji geograficznej — warstwa Azure będzie wybierz nową lokalizację dodatkowej replikowane dane do tej lokalizacji, a następnie wskaż dodatkowej wpisy DNS.</span><span class="sxs-lookup"><span data-stu-id="8180e-124">If a geo-failover occurs, Azure will select a new secondary location and replicate the data to that location, then point the secondary DNS entries to it.</span></span> <span data-ttu-id="8180e-125">Pomocniczy punkt końcowy będzie niedostępny, dopóki konto magazynu zakończył replikację.</span><span class="sxs-lookup"><span data-stu-id="8180e-125">The secondary endpoint will be unavailable until the storage account has finished replicating.</span></span> <span data-ttu-id="8180e-126">Aby uzyskać więcej informacji, zobacz [co robić w przypadku wystąpienia awarii usługi Azure Storage](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="8180e-126">For more information, please see [What to do if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="8180e-127">Zagadnienia dotyczące projektowania aplikacji przy użyciu RA-GRS</span><span class="sxs-lookup"><span data-stu-id="8180e-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="8180e-128">Głównym celem tego artykułu jest pokazanie sposobu projektowania aplikacji, która będzie działać (chociaż są w ograniczonym zakresie), nawet w przypadku poważnej awarii w centrum danych podstawowych.</span><span class="sxs-lookup"><span data-stu-id="8180e-128">The main purpose of this article is to show you how to design an application that will continue to function (albeit in a limited capacity) even in the event of a major disaster at the primary data center.</span></span> <span data-ttu-id="8180e-129">W tym celu po aplikacji do obsługi problemów przejściowego lub długotrwałe przełączanie do odczytu z regionu pomocniczego, gdy występuje problem, a przełączanie po regionu podstawowego jest ponownie dostępny.</span><span class="sxs-lookup"><span data-stu-id="8180e-129">You do this by having your application to handle transient or long-running issues by switching to read from the secondary region while there is a problem, and switching back when the primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="8180e-130">Przy użyciu ostatecznie spójność danych</span><span class="sxs-lookup"><span data-stu-id="8180e-130">Using eventually consistent data</span></span>

<span data-ttu-id="8180e-131">To rozwiązanie proponowanych zakłada, że jej można wrócić, jakie mogą być starych danych do aplikacji wywołującej.</span><span class="sxs-lookup"><span data-stu-id="8180e-131">This proposed solution assumes that it is okay to return what could be stale data to the calling application.</span></span> <span data-ttu-id="8180e-132">Ponieważ dodatkowej danych jest ostatecznie spójne, jest możliwe, że dane zostały zapisane do serwera podstawowego, ale aktualizacji na serwerze pomocniczym ma nie zakończyło replikacji, gdy regionu podstawowego stał się niedostępny.</span><span class="sxs-lookup"><span data-stu-id="8180e-132">Because the secondary data is eventually consistent, it is possible that the data was written to the primary but the update to the secondary had not finished replicating when the primary region became inaccessible.</span></span>

<span data-ttu-id="8180e-133">Na przykład klienta można przesłać aktualizacji, który zakończy się pomyślnie, a następnie podstawową można Przejdź w dół, zanim propagacji aktualizacji na serwerze pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-133">For example, your customer could submit an update that is successful, and then the primary could go down before the update is propagated to the secondary.</span></span> <span data-ttu-id="8180e-134">W tym przypadku jeśli klient następnie prosi do odczytu z powrotem dane, odbiera on starych danych zamiast zaktualizowanych danych.</span><span class="sxs-lookup"><span data-stu-id="8180e-134">In this case, if the customer then asks to read the data back, he receives the stale data instead of the updated data.</span></span> <span data-ttu-id="8180e-135">Jeśli jest to dopuszczalne, a jeśli tak, należy zdecydować, w jaki sposób będzie komunikatów klienta.</span><span class="sxs-lookup"><span data-stu-id="8180e-135">You must decide if this is acceptable, and if so, how you will message the customer.</span></span> <span data-ttu-id="8180e-136">Zobaczysz jak sprawdzić czas ostatniej synchronizacji na dodatkowej danych w tym artykule czy pomocniczy jest aktualny.</span><span class="sxs-lookup"><span data-stu-id="8180e-136">You'll see how to check the Last Sync Time on the secondary data later in this article to see if the secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="8180e-137">Obsługa usług oddzielnie lub wszystkich elementów</span><span class="sxs-lookup"><span data-stu-id="8180e-137">Handling services separately or all together</span></span>

<span data-ttu-id="8180e-138">Gdy jest to prawdopodobnie nie jest możliwe dla jednej usługi staną się niedostępne podczas gdy inne usługi są nadal w pełni funkcjonalne.</span><span class="sxs-lookup"><span data-stu-id="8180e-138">While not likely, it is possible for one service to become unavailable while the other services are still fully functional.</span></span> <span data-ttu-id="8180e-139">Można obsługiwać ponownych prób i w trybie tylko do odczytu dla każdej usługi oddzielnie (obiekty BLOB, kolejek, tabel) lub liczbę ponownych prób objęty dla wszystkich usług magazynu może obsłużyć razem.</span><span class="sxs-lookup"><span data-stu-id="8180e-139">You can handle the retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all the storage services together.</span></span>

<span data-ttu-id="8180e-140">Na przykład jeśli używasz kolejek i obiektów blob w aplikacji może zdecydować o umieszczać w oddzielnych kodu do obsługi błędów powtarzający operację dla każdego z nich.</span><span class="sxs-lookup"><span data-stu-id="8180e-140">For example, if you use queues and blobs in your application, you may decide to put in separate code to handle retryable errors for each of these.</span></span> <span data-ttu-id="8180e-141">Następnie Jeśli ponowna próba możesz pobrać z usługi obiektów blob, ale nadal działa usługa kolejkowania, jest ograniczona tylko część aplikacji, która obsługuje obiekty BLOB.</span><span class="sxs-lookup"><span data-stu-id="8180e-141">Then if you get a retry from the blob service, but the queue service is still working, only the part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="8180e-142">Jeśli zdecydujesz się ogólnie obsługi ponawiania prób magazynu usługi i wywołanie usługi blob zwraca błąd powtarzający operację, następnie zarówno usługi obiektów blob i kolejki żądań wpłynie.</span><span class="sxs-lookup"><span data-stu-id="8180e-142">If you decide to handle all storage service retries generically and a call to the blob service returns a retryable error, then requests to both the blob service and the queue service will be impacted.</span></span>

<span data-ttu-id="8180e-143">Ostatecznie zależy od stopnia złożoności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-143">Ultimately, this depends on the complexity of your application.</span></span> <span data-ttu-id="8180e-144">Użytkownik może zrezygnować z obsługi błędów przez usługę, ale zamiast tego do przekierowywania żądań dla wszystkich usług magazynu w regionie pomocniczym odczytu i uruchomić aplikację w trybie tylko do odczytu, w przypadku wykrycia problemu z dowolnej usługi magazynu w regionie podstawowym.</span><span class="sxs-lookup"><span data-stu-id="8180e-144">You may decide not to handle the failures by service, but instead to redirect read requests for all storage services to the secondary region and run the application in read-only mode when you detect a problem with any storage service in the primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="8180e-145">Inne zagadnienia</span><span class="sxs-lookup"><span data-stu-id="8180e-145">Other considerations</span></span>

<span data-ttu-id="8180e-146">Są to innych kwestii, które omówimy w dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="8180e-146">These are the other considerations we will discuss in the rest of this article.</span></span>

*   <span data-ttu-id="8180e-147">Obsługa ponawianie żądań odczytu przy użyciu wzorca wyłącznika</span><span class="sxs-lookup"><span data-stu-id="8180e-147">Handling retries of read requests using the Circuit Breaker pattern</span></span>

*   <span data-ttu-id="8180e-148">Po pewnym czasie spójności danych i czas ostatniej synchronizacji</span><span class="sxs-lookup"><span data-stu-id="8180e-148">Eventually-consistent data and the Last Sync Time</span></span>

*   <span data-ttu-id="8180e-149">Testowanie</span><span class="sxs-lookup"><span data-stu-id="8180e-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="8180e-150">Uruchamiania aplikacji w trybie tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="8180e-150">Running your application in read-only mode</span></span>

<span data-ttu-id="8180e-151">Aby korzystać z magazynu RA-GRS, musi mieć możliwość obsługi zarówno nieudanych żądań odczytu i nieudane żądania aktualizacji (z aktualizacji w takim przypadku oznacza wstawiania, aktualizacji i usunięć).</span><span class="sxs-lookup"><span data-stu-id="8180e-151">To use RA-GRS storage, you must be able to handle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="8180e-152">Jeśli podstawowe Centrum kończy się niepowodzeniem, odczytu żądań może zostać przekierowane do centrum danych w dodatkowej, ale nie żądań aktualizacji, ponieważ pomocniczy jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-152">If the primary data center fails, read requests can be redirected to the secondary data center, but update requests cannot because the secondary is read only.</span></span> <span data-ttu-id="8180e-153">Z tego powodu należy jakiś sposób do uruchamiania aplikacji w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-153">For this reason, you need some way to run your application in read-only mode.</span></span>

<span data-ttu-id="8180e-154">Na przykład można ustawić flagi, który będzie sprawdzany przed przesłaniem żądań aktualizacji do usługi magazynu.</span><span class="sxs-lookup"><span data-stu-id="8180e-154">For example, you can set a flag that will be checked before submitting any update requests to the storage service.</span></span> <span data-ttu-id="8180e-155">Gdy jedno z żądań aktualizacji za pośrednictwem, można je pominąć i odpowiednią odpowiedź zwrócona do klienta.</span><span class="sxs-lookup"><span data-stu-id="8180e-155">When one of the update requests comes through, you can skip it and return an appropriate response to the customer.</span></span> <span data-ttu-id="8180e-156">Możesz nawet chcesz wyłączyć niektórych funkcji całkowicie, dopóki ten problem zostanie rozwiązany i Powiadom użytkowników, że te funkcje są tymczasowo niedostępne.</span><span class="sxs-lookup"><span data-stu-id="8180e-156">You may even want to disable certain features altogether until the problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="8180e-157">Jeśli zdecydujesz się oddzielnie obsługi błędów dla każdej usługi, należy również obsługiwać możliwość uruchamiania aplikacji w trybie tylko do odczytu przez usługę.</span><span class="sxs-lookup"><span data-stu-id="8180e-157">If you decide to handle errors for each service separately, you will also need to handle the ability to run your application in read-only mode by service.</span></span> <span data-ttu-id="8180e-158">Może mieć flagi tylko do odczytu dla wszystkich usług, które można włączyć i wyłączyć i obsługiwać odpowiednią flagę w odpowiednich miejscach w kodzie.</span><span class="sxs-lookup"><span data-stu-id="8180e-158">You could have read-only flags for each service that can be enabled and disabled and handle the appropriate flag in the appropriate places in your code.</span></span>

<span data-ttu-id="8180e-159">Możliwość uruchomienia aplikacji w trybie tylko do odczytu ma inny korzyści po stronie — daje możliwość zapewnienia ograniczoną funkcjonalność podczas uaktualniania najważniejszych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-159">Being able to run your application in read-only mode has another side benefit – it gives you the ability to ensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="8180e-160">Możesz wyzwolić aplikacji do uruchamiania w trybie tylko do odczytu i wskaż centrum danych w dodatkowej zapewnienie, że nikt nie uzyskuje dostęp do danych w regionie podstawowym, gdy wprowadzasz uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="8180e-160">You can trigger your application to run in read-only mode and point to the secondary data center, ensuring nobody is accessing the data in the primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="8180e-161">Obsługa aktualizacji w trybie tylko do odczytu</span><span class="sxs-lookup"><span data-stu-id="8180e-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="8180e-162">Istnieje wiele sposobów do obsługi żądań aktualizacji w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-162">There are many ways to handle update requests when running in read-only mode.</span></span> <span data-ttu-id="8180e-163">Firma Microsoft nie obejmuje to kompleksowe, ale ogólnie rzecz biorąc, istnieje kilka wzorców, które należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="8180e-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="8180e-164">Można odpowiadanie na użytkownika i poinformuj go, że nie są obecnie akceptuje aktualizacje.</span><span class="sxs-lookup"><span data-stu-id="8180e-164">You can respond to your user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="8180e-165">Na przykład system zarządzania kontaktami można włączyć klientom dostęp do informacji kontaktowych, ale nie dokonywać aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-165">For example, a contact management system could enable customers to access contact information but not make updates.</span></span>

2.  <span data-ttu-id="8180e-166">Można umieścić w kolejce aktualizacje w innym regionie.</span><span class="sxs-lookup"><span data-stu-id="8180e-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="8180e-167">W takim przypadku czy zapisać Twoich żądań oczekujących aktualizacji do kolejki w innym regionie, a następnie mogą uzyskiwać do przetwarzania te żądania po centrum danych podstawowych przejściu do trybu online ponownie.</span><span class="sxs-lookup"><span data-stu-id="8180e-167">In this case, you would write your pending update requests to a queue in a different region, and then have a way to process those requests after the primary data center comes online again.</span></span> <span data-ttu-id="8180e-168">W tym scenariuszu należy udostępnić klienta wiedzieć, że żądana aktualizacja jest przechowywane w kolejce do późniejszego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="8180e-168">In this scenario, you should let the customer know that the update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="8180e-169">Aktualizacje można zapisywać na konto magazynu w innym regionie.</span><span class="sxs-lookup"><span data-stu-id="8180e-169">You can write your updates to a storage account in another region.</span></span> <span data-ttu-id="8180e-170">Jeśli centrum danych podstawowych wraca do trybu online, możesz korzystać sposobem scalić tych aktualizacji danych podstawowych, w zależności od struktury danych.</span><span class="sxs-lookup"><span data-stu-id="8180e-170">Then when the primary data center comes back online, you can have a way to merge those updates into the primary data, depending on the structure of the data.</span></span> <span data-ttu-id="8180e-171">Na przykład jeśli tworzysz oddzielnych plików z sygnaturą daty/godziny w nazwie, można skopiować te pliki do regionu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="8180e-171">For example, if you are creating separate files with a date/time stamp in the name, you can copy those files back to the primary region.</span></span> <span data-ttu-id="8180e-172">Działa to w przypadku niektórych obciążeń, takich jak dane rejestrowania i iOT.</span><span class="sxs-lookup"><span data-stu-id="8180e-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="8180e-173">Obsługa ponownych prób</span><span class="sxs-lookup"><span data-stu-id="8180e-173">Handling retries</span></span>

<span data-ttu-id="8180e-174">Jak ustalić, które błędy są powtarzający operację?</span><span class="sxs-lookup"><span data-stu-id="8180e-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="8180e-175">Jest to określane za pomocą biblioteki klienta usługi storage.</span><span class="sxs-lookup"><span data-stu-id="8180e-175">This is determined by the storage client library.</span></span> <span data-ttu-id="8180e-176">Na przykład błąd 404 (nie znaleziono zasobu) nie jest powtarzający operację, ponieważ ponawianie próby jego nie może spowodować Powodzenie.</span><span class="sxs-lookup"><span data-stu-id="8180e-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely to result in success.</span></span> <span data-ttu-id="8180e-177">Z drugiej strony 500 Błąd jest powtarzający operację, ponieważ jest to błąd serwera i po prostu może być to problem przejściowy.</span><span class="sxs-lookup"><span data-stu-id="8180e-177">On the other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="8180e-178">Aby uzyskać więcej informacji, zapoznaj się z [Otwórz kod źródłowy dla klasy ExponentialRetry](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) w bibliotece klienta .NET magazynu.</span><span class="sxs-lookup"><span data-stu-id="8180e-178">For more details, check out the [open source code for the ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in the .NET storage client library.</span></span> <span data-ttu-id="8180e-179">(Poszukaj metody ShouldRetry).</span><span class="sxs-lookup"><span data-stu-id="8180e-179">(Look for the ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="8180e-180">Żądań odczytu</span><span class="sxs-lookup"><span data-stu-id="8180e-180">Read requests</span></span>

<span data-ttu-id="8180e-181">Jeśli występuje problem z magazynem podstawowego można przekierować żądania odczytu do magazynu pomocniczego.</span><span class="sxs-lookup"><span data-stu-id="8180e-181">Read requests can be redirected to secondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="8180e-182">Jak zanotowane powyżej w [przy użyciu ostatecznie spójności danych](#using-eventually-consistent-data), musi być dopuszczalne potencjalnie odczytać starych danych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application to potentially read stale data.</span></span> <span data-ttu-id="8180e-183">Jeśli korzystasz z biblioteki klienta magazynu dostępu do danych RA-GRS, można określić zachowanie ponów żądanie odczytu, ustawiając wartość **LocationMode** właściwości do jednej z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="8180e-183">If you are using the storage client library to access RA-GRS data, you can specify the retry behavior of a read request by setting a value for the **LocationMode** property to one of the following:</span></span>

*   <span data-ttu-id="8180e-184">**PrimaryOnly** (ustawienie domyślne)</span><span class="sxs-lookup"><span data-stu-id="8180e-184">**PrimaryOnly** (the default)</span></span>

*   <span data-ttu-id="8180e-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="8180e-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="8180e-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="8180e-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="8180e-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="8180e-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="8180e-188">Podczas ustawiania **LocationMode** do **PrimaryThenSecondary**, jeśli początkowe żądanie odczytu do awarii podstawowego punktu końcowego z powodu błędu powtarzającego operację, klient automatycznie tworzy kolejne żądanie odczytu pomocniczy punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="8180e-188">When you set the **LocationMode** to **PrimaryThenSecondary**, if the initial read request to the primary endpoint fails with a retryable error, the client automatically makes another read request to the secondary endpoint.</span></span> <span data-ttu-id="8180e-189">Jeśli błąd jest limit czasu serwera, klient będzie mieć oczekiwania limitu czasu wygaśnięcia przed odbierze błąd powtarzający operację usługi.</span><span class="sxs-lookup"><span data-stu-id="8180e-189">If the error is a server timeout, then the client will have to wait for the timeout to expire before it receives a retryable error from the service.</span></span>

<span data-ttu-id="8180e-190">Istnieją dwa scenariusze, które należy uwzględnić podczas decydowania odpowiadanie na błąd powtarzający operację:</span><span class="sxs-lookup"><span data-stu-id="8180e-190">There are basically two scenarios to consider when you are deciding how to respond to a retryable error:</span></span>

*   <span data-ttu-id="8180e-191">Jest to problem izolowanym i kolejnych żądań wysyłanych do punktu końcowego podstawowego nie zwróci błąd powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="8180e-191">This is an isolated problem and subsequent requests to the primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="8180e-192">Przykładem gdy taka sytuacja może wystąpić jest błąd sieci.</span><span class="sxs-lookup"><span data-stu-id="8180e-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="8180e-193">W tym scenariuszu istnieje żadne pogorszenie wydajności znaczących w o **LocationMode** ustawioną **PrimaryThenSecondary** jak tylko dzieje się rzadko.</span><span class="sxs-lookup"><span data-stu-id="8180e-193">In this scenario, there is no significant performance penalty in having **LocationMode** set to **PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="8180e-194">Jest to problem z co najmniej jedną z usług magazynu w regionie podstawowym i wszystkie kolejne żądania z usługą w regionie podstawowym mogą zwracać powtarzający operację błędów w danym okresie czasu.</span><span class="sxs-lookup"><span data-stu-id="8180e-194">This is a problem with at least one of the storage services in the primary region and all subsequent requests to that service in the primary region are likely to return retryable errors for a period of time.</span></span> <span data-ttu-id="8180e-195">Na przykład jest całkowicie niedostępne regionu podstawowego.</span><span class="sxs-lookup"><span data-stu-id="8180e-195">An example of this is if the primary region is completely inaccessible.</span></span>

    <span data-ttu-id="8180e-196">W tym scenariuszu istnieje spadek wydajności, ponieważ wszystkich żądań odczytu zostanie najpierw spróbuj podstawowy punkt końcowy, poczekaj, aż wygaśnie limit czasu, a następnie przełączyć się do dodatkowej punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="8180e-196">In this scenario, there is a performance penalty because all your read requests will try the primary endpoint first, wait for the timeout to expire, then switch to the secondary endpoint.</span></span>

<span data-ttu-id="8180e-197">W tych sytuacjach należy zidentyfikować z trwającej problem z punktem końcowym podstawowego i wysyłać żądania bezpośrednio do punktu końcowego dodatkowej wszystkie odczytu, ustawiając **LocationMode** właściwości **SecondaryOnly** .</span><span class="sxs-lookup"><span data-stu-id="8180e-197">For these scenarios, you should identify that there is an ongoing issue with the primary endpoint and send all read requests directly to the secondary endpoint by setting the **LocationMode** property to **SecondaryOnly**.</span></span> <span data-ttu-id="8180e-198">W tej chwili możesz również zmienić aplikację do uruchamiania w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-198">At this time, you should also change the application to run in read-only mode.</span></span> <span data-ttu-id="8180e-199">Takie podejście jest nazywany [wzorzec wyłącznika](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="8180e-199">This approach is known as the [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="8180e-200">Żądań aktualizacji</span><span class="sxs-lookup"><span data-stu-id="8180e-200">Update requests</span></span>

<span data-ttu-id="8180e-201">Wzorzec wyłącznika można zastosować w taki sposób, aby zaktualizować żądania.</span><span class="sxs-lookup"><span data-stu-id="8180e-201">The Circuit Breaker pattern can also be applied to update requests.</span></span> <span data-ttu-id="8180e-202">Jednak żądania aktualizacji nie może zostać przekierowane do magazynu pomocniczego, co jest tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-202">However, update requests cannot be redirected to secondary storage, which is read-only.</span></span> <span data-ttu-id="8180e-203">Dla tych wymagań, należy pozostawić **LocationMode** ustawioną właściwość **PrimaryOnly** (ustawienie domyślne).</span><span class="sxs-lookup"><span data-stu-id="8180e-203">For these requests, you should leave the **LocationMode** property set to **PrimaryOnly** (the default).</span></span> <span data-ttu-id="8180e-204">Do obsługi tych błędów, możesz dotyczą metrykę te żądania — takie jak 10 błędów w wierszu — i po spełnieniu Twojej próg przełączanie aplikacji do trybu tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-204">To handle these errors, you can apply a metric to these requests – such as 10 failures in a row – and when your threshold is met, switch the application into read-only mode.</span></span> <span data-ttu-id="8180e-205">Te same metody dla zwracania umożliwia tryb jak te opisane poniżej w następnej sekcji o wzorcu wyłącznika aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-205">You can use the same methods for returning to update mode as those described below in the next section about the Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="8180e-206">Wzorzec wyłącznika</span><span class="sxs-lookup"><span data-stu-id="8180e-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="8180e-207">W aplikacji przy użyciu wzorca wyłącznika może uniemożliwić ich ponowną próbą wykonania operacji, która może zakończyć się niepowodzeniem wielokrotnie.</span><span class="sxs-lookup"><span data-stu-id="8180e-207">Using the Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely to fail repeatedly.</span></span> <span data-ttu-id="8180e-208">Umożliwia to aplikacji kontynuować uruchamianie, a nie zajmuje czasu podczas operacji są wykładniczo ponowione.</span><span class="sxs-lookup"><span data-stu-id="8180e-208">It allows the application to continue to run rather than taking up time while the operation is retried exponentially.</span></span> <span data-ttu-id="8180e-209">Ta funkcja wykrywa także gdy stałe usterki, które aplikacji można spróbuj ponownie wykonać operację.</span><span class="sxs-lookup"><span data-stu-id="8180e-209">It also detects when the fault has been fixed, at which time the application can try the operation again.</span></span>

### <a name="how-to-implement-the-circuit-breaker-pattern"></a><span data-ttu-id="8180e-210">Jak zaimplementować wzorzec wyłącznika</span><span class="sxs-lookup"><span data-stu-id="8180e-210">How to implement the circuit breaker pattern</span></span>

<span data-ttu-id="8180e-211">Aby zidentyfikować trwającą problemie z podstawowy punkt końcowy, można monitorować, jak często klient wystąpią błędy powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="8180e-211">To identify that there is an ongoing problem with a primary endpoint, you can monitor how frequently the client encounters retryable errors.</span></span> <span data-ttu-id="8180e-212">Ponieważ każdy przypadek jest inny, masz podejmowanie decyzji o wartości progowej, którego chcesz użyć przy podejmowaniu decyzji, aby przełączyć się do dodatkowej punktu końcowego i uruchomić aplikację w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-212">Because each case is different, you have to decide on the threshold you want to use for the decision to switch to the secondary endpoint and run the application in read-only mode.</span></span> <span data-ttu-id="8180e-213">Na przykład można zdecydować, że wykonać przełącznik 10 błędy występują w wierszu z nie sukcesy.</span><span class="sxs-lookup"><span data-stu-id="8180e-213">For example, you could decide to perform the switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="8180e-214">Innym przykładem jest przełączenie w przypadku 90% żądań w okresie 2-minutowy zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="8180e-214">Another example is to switch if 90% of the requests in a 2-minute period fail.</span></span>

<span data-ttu-id="8180e-215">Dla pierwszego scenariusza można po prostu przechowuje licznika niepowodzeń i jeśli został pomyślnie przed osiągnięciem wartość maksymalna, ustaw liczbę wstecz od zera.</span><span class="sxs-lookup"><span data-stu-id="8180e-215">For the first scenario, you can simply keep a count of the failures, and if there is a success before reaching the maximum, set the count back to zero.</span></span> <span data-ttu-id="8180e-216">Drugi scenariusz jednym ze sposobów ją wdrożyć ma używać obiektu MemoryCache (w .NET).</span><span class="sxs-lookup"><span data-stu-id="8180e-216">For the second scenario, one way to implement it is to use the MemoryCache object (in .NET).</span></span> <span data-ttu-id="8180e-217">Dla każdego żądania Dodaj niż CacheItem do pamięci podręcznej, ustaw wartość Powodzenie (1) lub Niepowodzenie (0) i ustaw czas wygaśnięcia do dwóch minut od teraz (lub niezależnie od jest Twoje ograniczenia czasu).</span><span class="sxs-lookup"><span data-stu-id="8180e-217">For each request, add a CacheItem to the cache, set the value to success (1) or fail (0), and set the expiration time to 2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="8180e-218">Po osiągnięciu czas wygaśnięcia wpisu wpis zostanie automatycznie usunięta.</span><span class="sxs-lookup"><span data-stu-id="8180e-218">When an entry's expiration time is reached, the entry is automatically removed.</span></span> <span data-ttu-id="8180e-219">Zapewni to stopniowe okna 2-minutowy.</span><span class="sxs-lookup"><span data-stu-id="8180e-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="8180e-220">Zawsze, gdy wyślesz żądanie z usługą Magazyn należy najpierw użyj zapytań Linq na obiektu MemoryCache do obliczania procentu Powodzenie przez zsumowanie wartości i dzielenie przez wartość licznika.</span><span class="sxs-lookup"><span data-stu-id="8180e-220">Each time you make a request to the storage service, you first use a Linq query across the MemoryCache object to calculate the percent success by summing the values and dividing by the count.</span></span> <span data-ttu-id="8180e-221">Jeśli procent powodzenia spadnie poniżej progu, niektóre (na przykład 10%), należy skonfigurować **LocationMode** żądania właściwości do odczytu do **SecondaryOnly** i przełączyć aplikację do trybu tylko do odczytu, przed kontynuowaniem.</span><span class="sxs-lookup"><span data-stu-id="8180e-221">When the percent success drops below some threshold (such as 10%), set the **LocationMode** property for read requests to **SecondaryOnly** and switch the application into read-only mode before continuing.</span></span>

<span data-ttu-id="8180e-222">Próg błędów używany do określenia, kiedy należy utworzyć przełącznik może się różnić z usługami w aplikacji, więc należy rozważyć, dzięki czemu można konfigurować parametry.</span><span class="sxs-lookup"><span data-stu-id="8180e-222">The threshold of errors used to determine when to make the switch may vary from service to service in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="8180e-223">Dotyczy to również decyzję dotyczącą obsługi powtarzający operację błędów z każdej usługi osobno lub jako jedna, zgodnie z opisem wcześniej.</span><span class="sxs-lookup"><span data-stu-id="8180e-223">This is also where you decide to handle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="8180e-224">Kolejnym zagadnieniem jest sposób obsługi wielu wystąpień aplikacji, co należy zrobić po wykryciu powtarzającego operację błędów w każdym wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="8180e-224">Another consideration is how to handle multiple instances of an application, and what to do when you detect retryable errors in each instance.</span></span> <span data-ttu-id="8180e-225">Na przykład może być uruchomiony z tej samej aplikacji, które są ładowane 20 maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="8180e-225">For example, you may have 20 VMs running with the same application loaded.</span></span> <span data-ttu-id="8180e-226">Czy można obsługiwać każde wystąpienie osobno?</span><span class="sxs-lookup"><span data-stu-id="8180e-226">Do you handle each instance separately?</span></span> <span data-ttu-id="8180e-227">Jeśli jedno wystąpienie rozpoczyna się problemy, ma ograniczenie odpowiedzi tylko jednego wystąpienia albo czy chcesz spróbować ma wszystkich wystąpień odpowiedzi w taki sam sposób, jeśli jedno wystąpienie ma problem?</span><span class="sxs-lookup"><span data-stu-id="8180e-227">If one instance starts having problems, do you want to limit the response to just that one instance, or do you want to try to have all instances respond in the same way when one instance has a problem?</span></span> <span data-ttu-id="8180e-228">Obsługa wystąpień oddzielnie jest znacznie prostsze niż w trakcie koordynować odpowiedzi w ich, ale jak to zrobić zależy od architektury aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-228">Handling the instances separately is much simpler than trying to coordinate the response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-the-error-frequency"></a><span data-ttu-id="8180e-229">Opcje monitorowania częstotliwość błędów</span><span class="sxs-lookup"><span data-stu-id="8180e-229">Options for monitoring the error frequency</span></span>

<span data-ttu-id="8180e-230">Możliwe są trzy główne monitorowania częstotliwość ponownych prób w regionie podstawowym w celu ustalenia, kiedy należy przełączyć się do regionu pomocniczego i Zmień aplikację do uruchamiania w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-230">You have three main options for monitoring the frequency of retries in the primary region in order to determine when to switch over to the secondary region and change the application to run in read-only mode.</span></span>

*   <span data-ttu-id="8180e-231">Dodaj obsługę [ **ponawianie** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) zdarzenia w [ **elementu OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) żądań przekazania do magazynu obiektu — jest to metoda wyświetlane w tym artykule i używane w przykładowym towarzyszące.</span><span class="sxs-lookup"><span data-stu-id="8180e-231">Add a handler for the [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on the [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass to your storage requests – this is the method displayed in this article and used in the accompanying sample.</span></span> <span data-ttu-id="8180e-232">Te zdarzenia wyzwalać zawsze, gdy klient ponawia próbę żądania, dzięki któremu można śledzić, jak często klient napotkał błędy powtarzający operację na podstawowy punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="8180e-232">These events fire whenever the client retries a request, enabling you to track how often the client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in the primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="8180e-233">W [ **Evaluate** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) metody w zasadach niestandardowych ponownych prób, można uruchomić niestandardowego kodu przy każdym ponowna próba ma miejsce.</span><span class="sxs-lookup"><span data-stu-id="8180e-233">In the [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="8180e-234">Oprócz rejestrowania po ponowieniu próby odbywa się, zapewnia to również możliwość modyfikacji zachowania użytkownika spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="8180e-234">In addition to recording when a retry happens, this also gives you the opportunity to modify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in the primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="8180e-235">Trzeci podejściem jest wdrożenie niestandardowych składników monitorowania w aplikacji, która stale wysyła pakiet usługi ping punktu końcowego podstawowego magazynu z manekina odczytu żądań (takich jak odczytywanie małych obiektów blob) do określenia jej kondycji.</span><span class="sxs-lookup"><span data-stu-id="8180e-235">The third approach is to implement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) to determine its health.</span></span> <span data-ttu-id="8180e-236">To może potrwać niektórych zasobów, ale nie znacznej ilości.</span><span class="sxs-lookup"><span data-stu-id="8180e-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="8180e-237">Gdy problem zostanie odnaleziony, który osiągnie Twojej próg, następnie przeprowadza przełącznika tak, aby **SecondaryOnly** i w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="8180e-237">When a problem is discovered that reaches your threshold, you would then perform the switch to **SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="8180e-238">W pewnym momencie można wrócić do przy użyciu podstawowego punktu końcowego, dzięki czemu aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-238">At some point, you will want to switch back to using the primary endpoint and allowing updates.</span></span> <span data-ttu-id="8180e-239">Jeśli przy użyciu jednej z dwóch pierwszych metod wymienionych powyżej, może po prostu przejdź do podstawowego punktu końcowego i włączyć tryb aktualizacji po przeprowadzono dowolnie wybranego przedziału czasu lub liczba operacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-239">If using one of the first two methods listed above, you could simply switch back to the primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="8180e-240">Następnie można pozostawić ją ponownie przejść przez logikę ponawiania.</span><span class="sxs-lookup"><span data-stu-id="8180e-240">You can then let it go through the retry logic again.</span></span> <span data-ttu-id="8180e-241">Jeśli problem został rozwiązany, będzie używać podstawowego punktu końcowego i zezwolić na aktualizacje.</span><span class="sxs-lookup"><span data-stu-id="8180e-241">If the problem has been fixed, it will continue to use the primary endpoint and allow updates.</span></span> <span data-ttu-id="8180e-242">Jeżeli problem nadal występuje, jego zostanie ponownie przełącz się do dodatkowej punktu końcowego i w trybie tylko do odczytu po nieudanym ustawionych kryteriów.</span><span class="sxs-lookup"><span data-stu-id="8180e-242">If there is still a problem, it will once more switch back to the secondary endpoint and read-only mode after failing the criteria you've set.</span></span>

<span data-ttu-id="8180e-243">Trzeci scenariusz, gdy polecenie ping końcowego podstawowego magazynu staje się pomyślnie, możesz wyzwolić przełącznika do **PrimaryOnly** i kontynuować stosowanie aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-243">For the third scenario, when pinging the primary storage endpoint becomes successful again, you can trigger the switch back to **PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="8180e-244">Obsługa ostatecznie spójność danych</span><span class="sxs-lookup"><span data-stu-id="8180e-244">Handling eventually consistent data</span></span>

<span data-ttu-id="8180e-245">RA-GRS polega na replikowanie transakcji z serwera podstawowego w regionie pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-245">RA-GRS works by replicating transactions from the primary to the secondary region.</span></span> <span data-ttu-id="8180e-246">Ten proces replikacji gwarantuje, że dane w regionie pomocniczym są *ostatecznie spójne*.</span><span class="sxs-lookup"><span data-stu-id="8180e-246">This replication process guarantees that the data in the secondary region is *eventually consistent*.</span></span> <span data-ttu-id="8180e-247">Oznacza to, że wszystkie transakcje w regionie podstawowym ostatecznie pojawią się w regionie pomocniczym, ale może wystąpić opóźnienie przed wyświetleniem i że nie ma żadnej gwarancji, transakcje przychodzą w regionie pomocniczym w tej samej kolejności jak w którym one były pierwotnie stosowane w regionie podstawowym.</span><span class="sxs-lookup"><span data-stu-id="8180e-247">This means that all the transactions in the primary region will eventually appear in the secondary region, but that there may be a lag before they appear, and that there is no guarantee the transactions arrive in the secondary region in the same order as that in which they were originally applied in the primary region.</span></span> <span data-ttu-id="8180e-248">Jeśli transakcje przychodzą w regionie pomocniczym poza kolejnością, możesz *może* należy wziąć pod uwagę dane w regionie pomocniczym, aby być w stanie niespójnym, dopóki wyrównania usługi.</span><span class="sxs-lookup"><span data-stu-id="8180e-248">If your transactions arrive in the secondary region out of order, you *may* consider your data in the secondary region to be in an inconsistent state until the service catches up.</span></span>

<span data-ttu-id="8180e-249">W poniższej tabeli przedstawiono przykład co może się zdarzyć, gdy aktualizacja Szczegóły pracownika, aby jej członkiem *Administratorzy* roli.</span><span class="sxs-lookup"><span data-stu-id="8180e-249">The following table shows an example of what might happen when you update the details of an employee to make her a member of the *administrators* role.</span></span> <span data-ttu-id="8180e-250">Ze względu na przykład wymaga aktualizacji **pracownika** jednostki i aktualizacji **roli administrator** jednostki wraz z liczbą całkowitą liczbę administratorów.</span><span class="sxs-lookup"><span data-stu-id="8180e-250">For the sake of this example, this requires you update the **employee** entity and update an **administrator role** entity with a count of the total number of administrators.</span></span> <span data-ttu-id="8180e-251">Zwróć uwagę, jak aktualizacje są stosowane poza kolejnością w regionie pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-251">Notice how the updates are applied out of order in the secondary region.</span></span>

| <span data-ttu-id="8180e-252">**Czas**</span><span class="sxs-lookup"><span data-stu-id="8180e-252">**Time**</span></span> | <span data-ttu-id="8180e-253">**Transakcji**</span><span class="sxs-lookup"><span data-stu-id="8180e-253">**Transaction**</span></span>                                            | <span data-ttu-id="8180e-254">**Replikacja**</span><span class="sxs-lookup"><span data-stu-id="8180e-254">**Replication**</span></span>                       | <span data-ttu-id="8180e-255">**Czas ostatniej synchronizacji**</span><span class="sxs-lookup"><span data-stu-id="8180e-255">**Last Sync Time**</span></span> | <span data-ttu-id="8180e-256">**Wynik**</span><span class="sxs-lookup"><span data-stu-id="8180e-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="8180e-257">T0</span><span class="sxs-lookup"><span data-stu-id="8180e-257">T0</span></span>       | <span data-ttu-id="8180e-258">Transakcja A:</span><span class="sxs-lookup"><span data-stu-id="8180e-258">Transaction A:</span></span> <br> <span data-ttu-id="8180e-259">Wstaw pracownika</span><span class="sxs-lookup"><span data-stu-id="8180e-259">Insert employee</span></span> <br> <span data-ttu-id="8180e-260">jednostki w podstawowej</span><span class="sxs-lookup"><span data-stu-id="8180e-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="8180e-261">Dodaje podstawowym, A transakcji</span><span class="sxs-lookup"><span data-stu-id="8180e-261">Transaction A inserted to primary,</span></span><br> <span data-ttu-id="8180e-262">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-262">not replicated yet.</span></span> |
| <span data-ttu-id="8180e-263">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-263">T1</span></span>       |                                                            | <span data-ttu-id="8180e-264">Transakcja A</span><span class="sxs-lookup"><span data-stu-id="8180e-264">Transaction A</span></span> <br> <span data-ttu-id="8180e-265">Replikacja</span><span class="sxs-lookup"><span data-stu-id="8180e-265">replicated to</span></span><br> <span data-ttu-id="8180e-266">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="8180e-266">secondary</span></span> | <span data-ttu-id="8180e-267">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-267">T1</span></span> | <span data-ttu-id="8180e-268">Replikowane do dodatkowej A transakcji.</span><span class="sxs-lookup"><span data-stu-id="8180e-268">Transaction A replicated to secondary.</span></span> <br><span data-ttu-id="8180e-269">Czas ostatniej synchronizacji aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="8180e-270">T2</span><span class="sxs-lookup"><span data-stu-id="8180e-270">T2</span></span>       | <span data-ttu-id="8180e-271">Transakcja B:</span><span class="sxs-lookup"><span data-stu-id="8180e-271">Transaction B:</span></span><br><span data-ttu-id="8180e-272">Aktualizacja</span><span class="sxs-lookup"><span data-stu-id="8180e-272">Update</span></span><br> <span data-ttu-id="8180e-273">Jednostka pracownika</span><span class="sxs-lookup"><span data-stu-id="8180e-273">employee entity</span></span><br> <span data-ttu-id="8180e-274">w podstawowej</span><span class="sxs-lookup"><span data-stu-id="8180e-274">in primary</span></span>  |                                | <span data-ttu-id="8180e-275">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-275">T1</span></span>                 | <span data-ttu-id="8180e-276">Transakcja B zapisywane w podstawowym</span><span class="sxs-lookup"><span data-stu-id="8180e-276">Transaction B written to primary,</span></span><br> <span data-ttu-id="8180e-277">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-277">not replicated yet.</span></span>  |
| <span data-ttu-id="8180e-278">T3</span><span class="sxs-lookup"><span data-stu-id="8180e-278">T3</span></span>       | <span data-ttu-id="8180e-279">Transakcja C:</span><span class="sxs-lookup"><span data-stu-id="8180e-279">Transaction C:</span></span><br> <span data-ttu-id="8180e-280">Aktualizacja</span><span class="sxs-lookup"><span data-stu-id="8180e-280">Update</span></span> <br><span data-ttu-id="8180e-281">Administrator</span><span class="sxs-lookup"><span data-stu-id="8180e-281">administrator</span></span><br><span data-ttu-id="8180e-282">Jednostka roli w</span><span class="sxs-lookup"><span data-stu-id="8180e-282">role entity in</span></span><br><span data-ttu-id="8180e-283">podstawowy</span><span class="sxs-lookup"><span data-stu-id="8180e-283">primary</span></span> |                    | <span data-ttu-id="8180e-284">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-284">T1</span></span>                 | <span data-ttu-id="8180e-285">Transakcja zapisywane do podstawowych, C</span><span class="sxs-lookup"><span data-stu-id="8180e-285">Transaction C written to primary,</span></span><br> <span data-ttu-id="8180e-286">nie jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-286">not replicated yet.</span></span>  |
| <span data-ttu-id="8180e-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="8180e-287">*T4*</span></span>     |                                                       | <span data-ttu-id="8180e-288">Transakcja C</span><span class="sxs-lookup"><span data-stu-id="8180e-288">Transaction C</span></span> <br><span data-ttu-id="8180e-289">Replikacja</span><span class="sxs-lookup"><span data-stu-id="8180e-289">replicated to</span></span><br> <span data-ttu-id="8180e-290">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="8180e-290">secondary</span></span> | <span data-ttu-id="8180e-291">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-291">T1</span></span>         | <span data-ttu-id="8180e-292">Transakcja C replikowane do dodatkowej.</span><span class="sxs-lookup"><span data-stu-id="8180e-292">Transaction C replicated to secondary.</span></span><br><span data-ttu-id="8180e-293">Nie zaktualizowano ponieważ LastSyncTime</span><span class="sxs-lookup"><span data-stu-id="8180e-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="8180e-294">Transakcja B nie został jeszcze zreplikowany.</span><span class="sxs-lookup"><span data-stu-id="8180e-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="8180e-295">*T5*</span><span class="sxs-lookup"><span data-stu-id="8180e-295">*T5*</span></span>     | <span data-ttu-id="8180e-296">Odczyt jednostek</span><span class="sxs-lookup"><span data-stu-id="8180e-296">Read entities</span></span> <br><span data-ttu-id="8180e-297">pomocniczej</span><span class="sxs-lookup"><span data-stu-id="8180e-297">from secondary</span></span>                           |                                  | <span data-ttu-id="8180e-298">T1</span><span class="sxs-lookup"><span data-stu-id="8180e-298">T1</span></span>                 | <span data-ttu-id="8180e-299">Przestarzała wartość dla pracowników</span><span class="sxs-lookup"><span data-stu-id="8180e-299">You get the stale value for employee</span></span> <br> <span data-ttu-id="8180e-300">jednostki, ponieważ nie transakcji B</span><span class="sxs-lookup"><span data-stu-id="8180e-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="8180e-301">jeszcze zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-301">replicated yet.</span></span> <span data-ttu-id="8180e-302">Pobierz nową wartość</span><span class="sxs-lookup"><span data-stu-id="8180e-302">You get the new value for</span></span><br> <span data-ttu-id="8180e-303">Administrator roli jednostki, ponieważ ma C</span><span class="sxs-lookup"><span data-stu-id="8180e-303">administrator role entity because C has</span></span><br> <span data-ttu-id="8180e-304">zreplikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-304">replicated.</span></span> <span data-ttu-id="8180e-305">Czas ostatniej synchronizacji nadal nie.</span><span class="sxs-lookup"><span data-stu-id="8180e-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="8180e-306">zostały zaktualizowane, ponieważ transakcja B</span><span class="sxs-lookup"><span data-stu-id="8180e-306">been updated because transaction B</span></span><br> <span data-ttu-id="8180e-307">nie replikowane.</span><span class="sxs-lookup"><span data-stu-id="8180e-307">hasn't replicated.</span></span> <span data-ttu-id="8180e-308">Można określić</span><span class="sxs-lookup"><span data-stu-id="8180e-308">You can tell the</span></span><br><span data-ttu-id="8180e-309">Jednostka roli administratora jest niespójna</span><span class="sxs-lookup"><span data-stu-id="8180e-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="8180e-310">ponieważ entity Data/godzina jest po</span><span class="sxs-lookup"><span data-stu-id="8180e-310">because the entity date/time is after</span></span> <br><span data-ttu-id="8180e-311">Czas ostatniej synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-311">the Last Sync Time.</span></span> |
| <span data-ttu-id="8180e-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="8180e-312">*T6*</span></span>     |                                                      | <span data-ttu-id="8180e-313">Transakcja B</span><span class="sxs-lookup"><span data-stu-id="8180e-313">Transaction B</span></span><br> <span data-ttu-id="8180e-314">Replikacja</span><span class="sxs-lookup"><span data-stu-id="8180e-314">replicated to</span></span><br> <span data-ttu-id="8180e-315">dodatkowej</span><span class="sxs-lookup"><span data-stu-id="8180e-315">secondary</span></span> | <span data-ttu-id="8180e-316">T6</span><span class="sxs-lookup"><span data-stu-id="8180e-316">T6</span></span>                 | <span data-ttu-id="8180e-317">*T6* — wszystkie transakcje za pomocą C</span><span class="sxs-lookup"><span data-stu-id="8180e-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="8180e-318">zostały zreplikowane, czas ostatniej synchronizacji</span><span class="sxs-lookup"><span data-stu-id="8180e-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="8180e-319">jest aktualizowana.</span><span class="sxs-lookup"><span data-stu-id="8180e-319">is updated.</span></span> |

<span data-ttu-id="8180e-320">W tym przykładzie przyjęto założenie, że klient przełącza się do odczytu z regionu pomocniczego w T5.</span><span class="sxs-lookup"><span data-stu-id="8180e-320">In this example, assume the client switches to reading from the secondary region at T5.</span></span> <span data-ttu-id="8180e-321">Można pomyślnie odczytać **roli administrator** jednostki, w tym momencie, ale jednostka zawiera wartość liczby Administratorzy, który nie jest zgodny z numerem **pracownika** jednostek, które są w tym momencie, oznaczona jako administratorów w regionie pomocniczym.</span><span class="sxs-lookup"><span data-stu-id="8180e-321">It can successfully read the **administrator role** entity at this time, but the entity contains a value for the count of administrators that is not consistent with the number of **employee** entities that are marked as administrators in the secondary region at this time.</span></span> <span data-ttu-id="8180e-322">Klient może po prostu wyświetlaj tej wartości, z ryzyko, że jest niespójne informacje.</span><span class="sxs-lookup"><span data-stu-id="8180e-322">Your client could simply display this value, with the risk that it is inconsistent information.</span></span> <span data-ttu-id="8180e-323">Alternatywnie klient może próbować ustalić, który **roli administrator** jest w stanie potencjalnie niespójności, ponieważ aktualizacje wystąpiło poza kolejnością, a następnie powiadamia użytkownika o tym fakcie.</span><span class="sxs-lookup"><span data-stu-id="8180e-323">Alternatively, the client could attempt to determine that the **administrator role** is in a potentially inconsistent state because the updates have happened out of order, and then inform the user of this fact.</span></span>

<span data-ttu-id="8180e-324">Rozpoznanie, że ma ona potencjalnie niespójne dane, klient może używać wartości *czas ostatniej synchronizacji* czy można uzyskać w dowolnym momencie przez zapytanie do usługi magazynu.</span><span class="sxs-lookup"><span data-stu-id="8180e-324">To recognize that it has potentially inconsistent data, the client can use the value of the *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="8180e-325">Oznacza to, podczas gdy dane w regionie pomocniczym został ostatnio spójne i usługa ma stosowania wszystkich transakcji przed tego punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="8180e-325">This tells you the time when the data in the secondary region was last consistent and when the service had applied all the transactions prior to that point in time.</span></span> <span data-ttu-id="8180e-326">W przykładzie przedstawionym powyżej, po wstawia usługę **pracownika** jednostki w regionie pomocniczym, czas ostatniej synchronizacji ma ustawioną wartość *T1*.</span><span class="sxs-lookup"><span data-stu-id="8180e-326">In the example shown above, after the service inserts the **employee** entity in the secondary region, the last sync time is set to *T1*.</span></span> <span data-ttu-id="8180e-327">Pozostaje w *T1* do aktualizacji usługi **pracownika** jednostki w regionie pomocniczym, gdy jest równa *T6*.</span><span class="sxs-lookup"><span data-stu-id="8180e-327">It remains at *T1* until the service updates the **employee** entity in the secondary region when it is set to *T6*.</span></span> <span data-ttu-id="8180e-328">Jeśli klient pobiera czas ostatniej synchronizacji, gdy odczytuje jednostki po *T5*, można porównać ją z sygnaturą czasową w ramach jednostki.</span><span class="sxs-lookup"><span data-stu-id="8180e-328">If the client retrieves the last sync time when it reads the entity at *T5*, it can compare it with the timestamp on the entity.</span></span> <span data-ttu-id="8180e-329">Jeśli znacznik czasu jednostki jest późniejsza niż godzina ostatniej synchronizacji, następnie jednostka jest w stanie potencjalnie niespójności, a może zająć niezależnie od jest odpowiednie działanie aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8180e-329">If the timestamp on the entity is later than the last sync time, then the entity is in a potentially inconsistent state, and you can take whatever is the appropriate action for your application.</span></span> <span data-ttu-id="8180e-330">To pole wymaga znać ukończenia ostatniej aktualizacji do podstawowych.</span><span class="sxs-lookup"><span data-stu-id="8180e-330">Using this field requires that you know when the last update to the primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="8180e-331">Testowanie</span><span class="sxs-lookup"><span data-stu-id="8180e-331">Testing</span></span>

<span data-ttu-id="8180e-332">Należy przetestować, czy aplikacja działa zgodnie z oczekiwaniami w przypadku wykrycia błędów powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="8180e-332">It's important to test that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="8180e-333">Na przykład należy przeprowadzić testy, kiedy regionu podstawowego stają się dostępne ponownie tworzenie kopii przełączniki aplikacji na serwerze pomocniczym, jak i w trybie tylko do odczytu, gdy wykryje problem i przełączniki.</span><span class="sxs-lookup"><span data-stu-id="8180e-333">For example, you need to test that the application switches to the secondary and into read-only mode when it detects a problem, and switches back when the primary region becomes available again.</span></span> <span data-ttu-id="8180e-334">Aby to zrobić, należy do symulowania powtarzający operację błędów i kontroli, jak często występują.</span><span class="sxs-lookup"><span data-stu-id="8180e-334">To do this, you need a way to simulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="8180e-335">Można użyć [Fiddler](http://www.telerik.com/fiddler) do przechwycenia i modyfikowania odpowiedzi HTTP w skrypcie.</span><span class="sxs-lookup"><span data-stu-id="8180e-335">You can use [Fiddler](http://www.telerik.com/fiddler) to intercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="8180e-336">Ten skrypt można zidentyfikować odpowiedzi, które pochodzą od podstawowego punktu końcowego i zmień kod stanu HTTP na Biblioteka klienta magazynu jest rozpoznawany jako Błąd powtarzający operację.</span><span class="sxs-lookup"><span data-stu-id="8180e-336">This script can identify responses that come from your primary endpoint and change the HTTP status code to one that the Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="8180e-337">Następujący fragment kodu przedstawiono prosty przykład skryptu Fiddler, który przechwytuje odpowiedzi na żądanie dla odczytu **employeedata** tabeli ma zostać zwrócony stan 502:</span><span class="sxs-lookup"><span data-stu-id="8180e-337">This code snippet shows a simple example of a Fiddler script that intercepts responses to read requests against the **employeedata** table to return a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="8180e-338">Można rozszerzyć w tym przykładzie przechwycenia większej liczby żądań i zmieniać tylko **responseCode** na niektórych z nich, aby lepiej symulować rzeczywistych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="8180e-338">You could extend this example to intercept a wider range of requests and only change the **responseCode** on some of them to better simulate a real-world scenario.</span></span> <span data-ttu-id="8180e-339">Aby uzyskać więcej informacji dotyczących dostosowywania Fiddler skryptów, zobacz [modyfikowanie żądania lub odpowiedzi](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) w dokumentacji narzędzia Fiddler.</span><span class="sxs-lookup"><span data-stu-id="8180e-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in the Fiddler documentation.</span></span>

<span data-ttu-id="8180e-340">Jeśli zostały wprowadzone do przełączenia aplikacji do trybu tylko do odczytu można skonfigurować progi, będzie łatwiejsze testowanie zachowanie w przypadku woluminów transakcji nieprodukcyjnych.</span><span class="sxs-lookup"><span data-stu-id="8180e-340">If you have made the thresholds for switching your application to read-only mode configurable, it will be easier to test the behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="8180e-341">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="8180e-341">Next Steps</span></span>

* <span data-ttu-id="8180e-342">Aby uzyskać więcej informacji o dostęp do odczytu-nadmiarowość geograficzna, łącznie z innym przykładem konfiguracji LastSyncTime, zobacz [opcje nadmiarowość magazynu Azure dla systemu Windows i dostęp do odczytu z magazynu geograficznie nadmiarowego magazynu](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="8180e-342">For more information about Read Access Geo-Redundancy, including another example of how the LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="8180e-343">Kompletnego przykładu przedstawiający sposób wprowadzania przełącznika i z powrotem między punktami końcowymi podstawowe i pomocnicze, zobacz [przykłady Azure — przy użyciu wzorca wyłącznika z magazynem RA-GRS](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="8180e-343">For a complete sample showing how to make the switch back and forth between the Primary and Secondary endpoints, please see [Azure Samples – Using the Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
