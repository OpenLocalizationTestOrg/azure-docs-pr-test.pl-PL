---
title: "aaaWrite aplikacji, które używają kolejek usługi Azure Service Bus | Dokumentacja firmy Microsoft"
description: "Jak toowrite prostą aplikację na podstawie kolejki, która używa usługi Azure Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 754d91b3-1426-405e-84b4-fd36d65b114a
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm
ms.openlocfilehash: 93b75902a06becd6e33e05298e09f5669d0e2aef
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-queues"></a><span data-ttu-id="4cfc1-103">Tworzenie aplikacji korzystających z kolejek usługi Service Bus</span><span class="sxs-lookup"><span data-stu-id="4cfc1-103">Create applications that use Service Bus queues</span></span>
<span data-ttu-id="4cfc1-104">W tym temacie opisano kolejek usługi Service Bus oraz przedstawiono sposób toowrite prostą aplikację na podstawie kolejki, która używa usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-104">This topic describes Service Bus queues and shows how toowrite a simple queue-based application that uses Service Bus.</span></span>

<span data-ttu-id="4cfc1-105">Rozważmy scenariusz z Witaj świecie sprzedaży detalicznej, w którym dane o sprzedaży z poszczególnych Point-of-Sale (POS) musi być terminale kierowane tooan systemu zarządzania spisem, używany hello toodetermine danych w magazynie ma toobe uzupełniane.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-105">Consider a scenario from hello world of retail in which sales data from individual Point-of-Sale (POS) terminals must be routed tooan inventory management system that uses hello data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="4cfc1-106">To rozwiązanie wymaga komunikatów usługi Service Bus hello komunikacji między terminale hello i hello systemu zarządzania spisem, jak pokazano na następującej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="4cfc1-106">This solution uses Service Bus messaging for hello communication between hello terminals and hello inventory management system, as illustrated in hello following figure:</span></span>

![Obraz kolejek usługi Service Bus 1](./media/service-bus-create-queues/IC657161.gif)

<span data-ttu-id="4cfc1-108">Każdy terminal POS raporty jego danych sprzedaży przez wysłanie wiadomości toohello **DataCollectionQueue**.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-108">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue**.</span></span> <span data-ttu-id="4cfc1-109">Komunikaty te pozostają w tej kolejki do momentu pobrania przez system zarządzania hello spisu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-109">These messages remain in this queue until they are retrieved by hello inventory management system.</span></span> <span data-ttu-id="4cfc1-110">Ten wzorzec jest często nazywany *asynchroniczną obsługę wiadomości*, ponieważ hello POS terminali nie ma toowait na odpowiedź od przetwarzania toocontinue hello spisu zarządzania systemu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-110">This pattern is often termed *asynchronous messaging*, because hello POS terminal does not have toowait for a reply from hello inventory management system toocontinue processing.</span></span>

## <a name="why-queuing"></a><span data-ttu-id="4cfc1-111">Dlaczego kolejkowania?</span><span class="sxs-lookup"><span data-stu-id="4cfc1-111">Why queuing?</span></span>
<span data-ttu-id="4cfc1-112">Zanim przyjrzymy hello kodu, który jest wymagany tooset się tej aplikacji, należy rozważyć zalety hello przy użyciu kolejki w tym scenariuszu zamiast terminale hello POS komunikować się bezpośrednio (synchronicznie) toohello spisu systemu zarządzania.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-112">Before we look at hello code that is required tooset up this application, consider hello advantages of using a queue in this scenario instead of having hello POS terminals talk directly (synchronously) toohello inventory management system.</span></span>

### <a name="temporal-decoupling"></a><span data-ttu-id="4cfc1-113">Oddzielenia czasowego</span><span class="sxs-lookup"><span data-stu-id="4cfc1-113">Temporal decoupling</span></span>
<span data-ttu-id="4cfc1-114">Z hello asynchroniczny wzorzec przesyłania komunikatów, producenci i konsumenci nie mają toobe w trybie online na powitania tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-114">With hello asynchronous messaging pattern, producers and consumers do not have toobe online at hello same time.</span></span> <span data-ttu-id="4cfc1-115">infrastruktury obsługi wiadomości powitania niezawodny sposób przechowuje komunikaty do momentu hello odbierająca jest gotowa tooreceive je.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-115">hello messaging infrastructure reliably stores messages until hello consuming party is ready tooreceive them.</span></span> <span data-ttu-id="4cfc1-116">Oznacza to, że hello składniki aplikacji rozproszonej hello mogą być rozłączone zarówno dobrowolnie; na przykład w celu przeprowadzenia konserwacji lub powodu tooa awarii składników, bez wywierania wpływu na powitania całego systemu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-116">This means hello components of hello distributed application can be disconnected, either voluntarily; for example, for maintenance, or due tooa component crash, without affecting hello whole system.</span></span> <span data-ttu-id="4cfc1-117">Ponadto korzystanie z aplikacji hello może mieć tylko toobe online pewnych porach dnia hello.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-117">Furthermore, hello consuming application may only have toobe online during certain times of hello day.</span></span> <span data-ttu-id="4cfc1-118">Na przykład w tym scenariuszu handlowej systemu zarządzania spisem hello może mieć tylko toocome online po zakończeniu hello hello dnia roboczego.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-118">For example, in this retail scenario, hello inventory management system may only have toocome online after hello end of hello business day.</span></span>

### <a name="load-leveling"></a><span data-ttu-id="4cfc1-119">Wyrównywanie obciążenia</span><span class="sxs-lookup"><span data-stu-id="4cfc1-119">Load leveling</span></span>
<span data-ttu-id="4cfc1-120">W wielu aplikacjach obciążenie systemu różni się wraz z upływem czasu, podczas gdy czas przetwarzania hello wymagany dla każdej jednostki pracy jest zwykle stały.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-120">In many applications system load varies over time, whereas hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="4cfc1-121">Pośredniczenie komunikatów, producenci i konsumenci środki kolejki, które hello aplikacja odbierająca komunikaty (proces roboczy hello) zawiera jedynie toobe zainicjowana tooservice średnią załadować zamiast obciążenia szczytowego.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-121">Intermediating message producers and consumers with a queue means that hello consuming application (hello worker) only has toobe provisioned tooservice an average load rather than a peak load.</span></span> <span data-ttu-id="4cfc1-122">wzrośnie Hello głębokość kolejki hello i kontraktu jako hello przychodzące obciążenia zmienia się.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-122">hello depth of hello queue will grow and contract as hello incoming load varies.</span></span> <span data-ttu-id="4cfc1-123">To jest zapisywany bezpośrednio pieniędzy z uwzględnieniem toohello ilością obciążenia aplikacji hello wymagane tooservice infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-123">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span>

![Kolejki usługi Service Bus obraz 2](./media/service-bus-create-queues/IC657162.gif)

### <a name="load-balancing"></a><span data-ttu-id="4cfc1-125">Równoważenie obciążenia</span><span class="sxs-lookup"><span data-stu-id="4cfc1-125">Load balancing</span></span>
<span data-ttu-id="4cfc1-126">Witaj wzrostu obciążenia, więcej procesów roboczych może być dodany tooread z hello kolejki procesu roboczego.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-126">As hello load increases, more worker processes can be added tooread from hello worker queue.</span></span> <span data-ttu-id="4cfc1-127">Każdy komunikat jest przetwarzany przez tylko jeden z procesów roboczych hello.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-127">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="4cfc1-128">Ponadto tego równoważenie obciążenia oparte na ściąganiu umożliwia optymalne użycie komputerów roboczych hello nawet wtedy, gdy komputery procesu roboczego hello różnią się z uwzględnieniem tooprocessing zasilania, ponieważ każda będzie ściągać komunikaty własnych maksymalną szybkością.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-128">Furthermore, this pull-based load balancing allows for optimum usage of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="4cfc1-129">Ten wzorzec jest często nazywany hello konkurujących konsumentów wzorca.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-129">This pattern is often termed hello competing consumer pattern.</span></span>

![Obraz kolejek usługi Service Bus 3](./media/service-bus-create-queues/IC657163.gif)

### <a name="loose-coupling"></a><span data-ttu-id="4cfc1-131">Luźne powiązanie</span><span class="sxs-lookup"><span data-stu-id="4cfc1-131">Loose coupling</span></span>
<span data-ttu-id="4cfc1-132">Przy użyciu toointermediate kolejkowania wiadomości między producentami a konsumentami komunikatów zawiera wewnętrzne luźne powiązanie między składnikami hello.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-132">Using message queuing toointermediate between message producers and consumers provides an intrinsic loose coupling between hello components.</span></span> <span data-ttu-id="4cfc1-133">Ponieważ producenci i konsumenci nie są wzajemnie świadomi, można uaktualnić konsumenta bez wpływu na powitania producenta.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-133">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span> <span data-ttu-id="4cfc1-134">Ponadto można rozwijać hello wiadomości topologii, bez wpływu na istniejące punkty końcowe hello.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-134">Furthermore, hello messaging topology can evolve without affecting hello existing endpoints.</span></span> <span data-ttu-id="4cfc1-135">Omówiono to bardziej przy omawianiu publikowania/subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-135">We’ll discuss this more when we talk about publish/subscribe.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="4cfc1-136">Pokaż hello kodu</span><span class="sxs-lookup"><span data-stu-id="4cfc1-136">Show me hello code</span></span>
<span data-ttu-id="4cfc1-137">Witaj w następującej sekcji przedstawiono sposób toobuild usługi Service Bus toouse tej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-137">hello following section shows how toouse Service Bus toobuild this application.</span></span>

### <a name="sign-up-for-an-azure-account"></a><span data-ttu-id="4cfc1-138">Załóż konto platformy Azure</span><span class="sxs-lookup"><span data-stu-id="4cfc1-138">Sign up for an Azure account</span></span>
<span data-ttu-id="4cfc1-139">Konieczne będzie konto platformy Azure w kolejności toostart pracy z usługą Service Bus.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-139">You’ll need an Azure account in order toostart working with Service Bus.</span></span> <span data-ttu-id="4cfc1-140">Jeśli nie masz już jeden, można utworzysz bezpłatne konto [tutaj](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-140">If you do not already have one, you can sign up for a free account [here](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span></span>

### <a name="create-a-namespace"></a><span data-ttu-id="4cfc1-141">Tworzenie przestrzeni nazw</span><span class="sxs-lookup"><span data-stu-id="4cfc1-141">Create a namespace</span></span>
<span data-ttu-id="4cfc1-142">Po utworzeniu subskrypcji można [tworzenie przestrzeni nazw usługi](service-bus-create-namespace-portal.md).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-142">Once you have a subscription, you can [create a service namespace](service-bus-create-namespace-portal.md).</span></span> <span data-ttu-id="4cfc1-143">Każdy obszar nazw działa jako kontener zakresu dla zestawu jednostek usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-143">Each namespace acts as a scoping container for a set of Service Bus entities.</span></span> <span data-ttu-id="4cfc1-144">Nadaj unikatową nazwę nowego obszaru nazw, wszystkich kont usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-144">Give your new namespace a unique name across all Service Bus accounts.</span></span> 

### <a name="install-hello-nuget-package"></a><span data-ttu-id="4cfc1-145">Zainstaluj pakiet NuGet hello</span><span class="sxs-lookup"><span data-stu-id="4cfc1-145">Install hello NuGet package</span></span>
<span data-ttu-id="4cfc1-146">toouse hello nazw usługi Service Bus, aplikacja musi odwoływać się hello zestawu usługi Service Bus, w szczególności Microsoft.ServiceBus.dll.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-146">toouse hello Service Bus namespace, an application must reference hello Service Bus assembly, specifically Microsoft.ServiceBus.dll.</span></span> <span data-ttu-id="4cfc1-147">Możesz znaleźć tego zestawu jako część hello Microsoft Azure SDK i pobierania hello jest dostępna na powitania [strona pobierania zestawu Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-147">You can find this assembly as part of hello Microsoft Azure SDK, and hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="4cfc1-148">Jednak hello [pakietu NuGet usługi Service Bus](https://www.nuget.org/packages/WindowsAzure.ServiceBus) jest hello Najprostszym sposobem tooget hello interfejsu API usługi Service Bus i tooconfigure aplikacji ze wszystkimi zależnościami usługi Service Bus hello.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-148">However, hello [Service Bus NuGet package](https://www.nuget.org/packages/WindowsAzure.ServiceBus) is hello easiest way tooget hello Service Bus API and tooconfigure your application with all of hello Service Bus dependencies.</span></span>

### <a name="create-hello-queue"></a><span data-ttu-id="4cfc1-149">Utwórz kolejkę hello</span><span class="sxs-lookup"><span data-stu-id="4cfc1-149">Create hello queue</span></span>
<span data-ttu-id="4cfc1-150">Operacje zarządzania dla usługi Service Bus jednostek obsługi komunikatów (kolejki i publikowania/subskrypcji tematy) są wykonywane za pośrednictwem hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasy.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-150">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class.</span></span> <span data-ttu-id="4cfc1-151">Usługa Service Bus używa [dostępu sygnatury dostępu Współdzielonego](service-bus-sas.md) na podstawie modelu zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-151">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="4cfc1-152">Witaj [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) klasa reprezentuje dostawcę tokenu zabezpieczającego z wbudowanymi metodami factory zwracanie niektórych dobrze znanych dostawców tokenu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-152">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="4cfc1-153">Użyjemy [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) poświadczeń sygnatury dostępu Współdzielonego hello toohold metody.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-153">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="4cfc1-154">Witaj [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) wystąpienia następnie jest tworzony z hello adresu podstawowego przestrzeni nazw usługi Service Bus hello oraz hello dostawcy tokenu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-154">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="4cfc1-155">Witaj [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasa dostarcza metody toocreate, wyliczania i usuwania jednostek obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-155">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="4cfc1-156">Witaj kod, który jest wyświetlany w tym miejscu przedstawiono sposób hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) wystąpienie jest utworzony i używany toocreate hello **DataCollectionQueue** kolejki.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-156">hello code that is shown here shows how hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is created and used toocreate hello **DataCollectionQueue** queue.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", 
                "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = 
    TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = 
    new NamespaceManager(uri, tokenProvider);
namespaceManager.CreateQueue("DataCollectionQueue");
```

<span data-ttu-id="4cfc1-157">Należy pamiętać, że istnieją przeciążenia metody hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) metodę, która włączyć właściwości toobe kolejki hello dostosowana.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-157">Note that there are overloads of hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method that enable properties of hello queue toobe tuned.</span></span> <span data-ttu-id="4cfc1-158">Na przykład można ustawić hello time to live (TTL) wartość domyślna dla wiadomości wysyłanych toohello kolejki.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-158">For example, you can set hello default time-to-live (TTL) value for messages sent toohello queue.</span></span>

### <a name="send-messages-toohello-queue"></a><span data-ttu-id="4cfc1-159">Komunikaty toohello kolejki wysyłania</span><span class="sxs-lookup"><span data-stu-id="4cfc1-159">Send messages toohello queue</span></span>
<span data-ttu-id="4cfc1-160">Dla czasu wykonywania operacji na jednostek usługi Service Bus; na przykład wysyłanie i odbieranie wiadomości, aplikacja musi najpierw utworzyć [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) obiektu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-160">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) object.</span></span> <span data-ttu-id="4cfc1-161">Podobne toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) klasy, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) z adresu podstawowego hello hello przestrzeni nazw usługi i dostawcy tokenów hello jest tworzone wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-161">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```csharp
 BrokeredMessage bm = new BrokeredMessage(salesData);
 bm.Label = "SalesReport";
 bm.Properties["StoreName"] = "Redmond";
 bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="4cfc1-162">Komunikaty wysyłane do i odbierane z usługi Service Bus są kolejki wystąpień hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) klasy.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-162">Messages sent to, and received from Service Bus queues are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="4cfc1-163">Ta klasa zawiera zestaw właściwości standardowych (takich jak [etykiety](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) i [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), słownik, który jest używany toohold właściwości aplikacji oraz treść dowolnych danych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-163">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="4cfc1-164">Aplikacja możne ustawić treść hello przez przekazanie dowolnego obiektu podlegającego serializacji (hello w poniższym przykładzie przekazuje w **SalesData** obiekt, który reprezentuje hello danych sprzedaży z terminalu hello POS), który będzie używany hello [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello obiektu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-164">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="4cfc1-165">Alternatywnie [strumienia](https://msdn.microsoft.com/library/system.io.stream.aspx) można podać obiektu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-165">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

<span data-ttu-id="4cfc1-166">Witaj najprostszym tooa sposób toosend wiadomości, podane kolejki w naszym wielkość hello **DataCollectionQueue**, jest toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) obiektu bezpośrednio z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-166">hello easiest way toosend messages tooa given queue, in our case hello **DataCollectionQueue**, is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance.</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionQueue");
sender.Send(bm);
```

### <a name="receiving-messages-from-hello-queue"></a><span data-ttu-id="4cfc1-167">Odbieranie komunikatów z kolejki hello</span><span class="sxs-lookup"><span data-stu-id="4cfc1-167">Receiving messages from hello queue</span></span>
<span data-ttu-id="4cfc1-168">tooreceive wiadomości z kolejki hello, można użyć [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) obiektów, które można tworzyć bezpośrednio z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) przy użyciu [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-168">tooreceive messages from hello queue, you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="4cfc1-169">Odbiorcy wiadomości mogą pracować w dwóch różnych trybach: **ReceiveAndDelete** i **PeekLock**.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-169">Message receivers can work in two different modes: **ReceiveAndDelete** and **PeekLock**.</span></span> <span data-ttu-id="4cfc1-170">Witaj [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) jest ustawiana po utworzeniu odbiornika wiadomość hello jako toohello parametru [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) wywołania.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-170">hello [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) is set when hello message receiver is created, as a parameter toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) call.</span></span>

<span data-ttu-id="4cfc1-171">Korzystając z hello **ReceiveAndDelete** trybie hello odbieranie jest operacją pojedynczego zrzutu; oznacza to, kiedy usługa Service Bus odbiera żądanie hello, oznacza hello komunikat jako wykorzystany i zwraca go toohello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-171">When using hello **ReceiveAndDelete** mode, hello receive is a single-shot operation; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="4cfc1-172">**ReceiveAndDelete** tryb jest hello najprostszym modelem i działa najlepiej w scenariuszach, w których hello aplikacji może tolerować nieprzetworzenie komunikatu toooccur gdyby awarii.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-172">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message if a failure were toooccur.</span></span> <span data-ttu-id="4cfc1-173">toounderstand, Rozważmy scenariusz w problemy, które konsumenta hello hello mógł odebrać żądanie, a następnie ulega awarii przed jego przetworzeniem.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-173">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="4cfc1-174">Ponieważ Usługa Service Bus oznaczony hello komunikat jako wykorzystany, podczas ponownego uruchamiania aplikacji hello i uruchamia ponownie, korzystanie z komunikatów pominie utracony wiadomość hello, który został wykorzystany przed hello awarii.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-174">Since Service Bus marked hello message as being consumed, when hello application restarts and starts consuming messages again, it will have missed hello message that was consumed before hello crash.</span></span>

<span data-ttu-id="4cfc1-175">W **PeekLock** trybie hello odbieranie staje się operacją dwuetapową, dzięki czemu możliwe toosupport aplikacji, które nie tolerują brakujących komunikatów.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-175">In **PeekLock** mode, hello receive becomes a two-stage operation, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="4cfc1-176">Usługa Service Bus odbiera żądanie hello, znajduje się dalej toobe wiadomość hello używane, blokuje go tooprevent innym klientom odebrania go i zwraca go po toohello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-176">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="4cfc1-177">Kiedy aplikacja hello zakończy przetwarzanie wiadomości powitania (lub niezawodnie zapisze go w celu przyszłego przetwarzania), wykonuje drugi etap hello hello odbierania przez wywołanie metody procesu [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) na wiadomość powitania odebrane.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-177">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="4cfc1-178">Kiedy Usługa Service Bus widzi hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) wywołania oznacza hello komunikat jako wykorzystany.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-178">When Service Bus sees hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="4cfc1-179">Możliwe są dwa inne wyniki.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-179">Two other outcomes are possible.</span></span> <span data-ttu-id="4cfc1-180">Po pierwsze, jeśli aplikacja hello nie tooprocess hello komunikat dla jakiegoś powodu, może wywołać [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) na wiadomość powitania odebranych (zamiast [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-180">First, if hello application is unable tooprocess hello message for some reason, it can call [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="4cfc1-181">To spowoduje, że wiadomość hello toounlock usługi Service Bus i stał się dostępny toobe odbioru, hello przez tego samego użytkownika lub innego Kończenie konsumenta.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-181">This causes Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another completing consumer.</span></span> <span data-ttu-id="4cfc1-182">Po drugie istnieje limit czasu skojarzony z blokadą hello i jeśli aplikacja hello nie można przetworzyć wiadomości powitania przed hello upływem limitu czasu blokady (na przykład jeśli wystąpiła awaria aplikacji hello), a następnie odblokowaniem usługi Service Bus wiadomość hello i stał się dostępny toobe Odebrano ponownie (zasadniczo wykonywania [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operacji domyślnie).</span><span class="sxs-lookup"><span data-stu-id="4cfc1-182">Second, there is a time-out associated with hello lock and if hello application cannot process hello message before hello lock time-out expires (for example, if hello application crashes), then Service Bus will unlock hello message and make it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="4cfc1-183">Należy pamiętać, że jeśli hello aplikacja przestaje działać po przetwarza wiadomości powitania, ale przed jego hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) żądanie zostało wydane, wiadomość hello jest przed przeniesieniem toohello aplikacji po jej ponownym uruchomieniu.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-183">Note that if hello application crashes after it processes hello message but before hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) request was issued, hello message will be redelivered toohello application when it restarts.</span></span> <span data-ttu-id="4cfc1-184">To jest często nazywany * co najmniej raz * przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-184">This is often termed *At Least Once * processing.</span></span> <span data-ttu-id="4cfc1-185">Oznacza to, że każdy komunikat będzie przetwarzany co najmniej raz, ale w niektórych sytuacjach hello sam komunikat może być dostarczony ponownie.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-185">This means that each message will be processed at least once but in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="4cfc1-186">Jeśli hello scenariusz nie Toleruje dwukrotnego przetwarzania, w duplikaty toodetect aplikacji hello jest wymagane dodatkowe logiki.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-186">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates.</span></span> <span data-ttu-id="4cfc1-187">Można to osiągnąć oparte na powitania [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) właściwości wiadomości powitania.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-187">This can be achieved based on hello [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property of hello message.</span></span> <span data-ttu-id="4cfc1-188">wartość tej właściwości Hello pozostaje stała między kolejnymi próbami dostarczenia.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-188">hello value of this property remains constant across delivery attempts.</span></span> <span data-ttu-id="4cfc1-189">Jest to określane jako *dokładnie raz* przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-189">This is termed *Exactly Once* processing.</span></span>

<span data-ttu-id="4cfc1-190">Witaj kod, który jest wyświetlany w tym miejscu odbiera i przetwarza wiadomości przy użyciu hello **PeekLock** tryb, który jest domyślnym hello, jeśli nie [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) wartość nie zostanie podany wprost.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-190">hello code that is shown here receives and processes a message using hello **PeekLock** mode, which is hello default if no [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) value is explicitly provided.</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionQueue");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

### <a name="use-hello-queue-client"></a><span data-ttu-id="4cfc1-191">Użyj powitania klienta kolejki</span><span class="sxs-lookup"><span data-stu-id="4cfc1-191">Use hello queue client</span></span>
<span data-ttu-id="4cfc1-192">Witaj przykłady we wcześniejszej części tej sekcji utworzony [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) i [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) obiektów bezpośrednio z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend i odbierania wiadomości z kolejki hello odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-192">hello examples earlier in this section created [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) and [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objects directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend and receive messages from hello queue, respectively.</span></span> <span data-ttu-id="4cfc1-193">Informacje o innym podejściu jest toouse [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) obiektu, który obsługuje zarówno operacji wysyłania i odbierania w toomore dodanie zaawansowane funkcje, takie jak sesji.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-193">An alternative approach is toouse a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object, which supports both send and receive operations in addition toomore advanced features, such as sessions.</span></span>

```csharp
QueueClient queueClient = factory.CreateQueueClient("DataCollectionQueue");
queueClient.Send(bm);

BrokeredMessage message = queueClient.Receive();

try
{
    ProcessMessage(message);
    message.Complete();
}
catch (Exception e)
{
    message.Abandon();
} 
```

## <a name="next-steps"></a><span data-ttu-id="4cfc1-194">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="4cfc1-194">Next steps</span></span>
<span data-ttu-id="4cfc1-195">Teraz, kiedy znasz już podstawy hello kolejek, zobacz [tworzenie aplikacji korzystających z usługi Service Bus tematy i subskrypcje](service-bus-create-topics-subscriptions.md) toocontinue rozważania przy użyciu możliwości publikowania/subskrybowania hello tematów usługi Service Bus i Subskrypcje.</span><span class="sxs-lookup"><span data-stu-id="4cfc1-195">Now that you've learned hello basics of queues, see [Create applications that use Service Bus topics and subscriptions](service-bus-create-topics-subscriptions.md) toocontinue this discussion using hello publish/subscribe capabilities of Service Bus topics and subscriptions.</span></span>

