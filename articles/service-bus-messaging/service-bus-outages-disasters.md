---
title: "aplikacje usługi Azure Service Bus aaaInsulating przed awariami i awarii | Dokumentacja firmy Microsoft"
description: "Opisuje metody można użyć aplikacji tooprotect dla potencjalnych awarii usługi Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="6feda-103">Najlepsze rozwiązania dotyczące izolacji aplikacji przed awariami usługi Service Bus i awarii</span><span class="sxs-lookup"><span data-stu-id="6feda-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="6feda-104">Kluczowych aplikacji musi działać w sposób ciągły, nawet w obecności hello nieplanowanych przestojów lub awarii.</span><span class="sxs-lookup"><span data-stu-id="6feda-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="6feda-105">W tym temacie opisano metody można użyć aplikacji usługi Service Bus tooprotect dla potencjalnych awarii usługi lub po awarii.</span><span class="sxs-lookup"><span data-stu-id="6feda-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="6feda-106">Awaria jest zdefiniowany jako tymczasowej niedostępności hello Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="6feda-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="6feda-107">Witaj awarii może mieć wpływ na niektórych składników usługi Service Bus, takiego jak magazynie obsługi komunikatów, lub nawet hello całe centrum danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="6feda-108">Po hello problem został rozwiązany, usługi Service Bus znowu dostępne.</span><span class="sxs-lookup"><span data-stu-id="6feda-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="6feda-109">Zazwyczaj awarii nie powoduje utraty wiadomości lub innych danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="6feda-110">Przykładem awarii składnika jest niedostępność hello określonym magazynie obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="6feda-111">Przykład awaria sieci centrum danych jest awarii zasilania hello centrum danych lub przełącznik sieciowy błędny centrum danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="6feda-112">Awaria może trwać od kilku minut tooa kilka dni.</span><span class="sxs-lookup"><span data-stu-id="6feda-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="6feda-113">Awarii jest zdefiniowany jako trwałą utratę hello jednostki skalowania usługi Service Bus lub datacenter.</span><span class="sxs-lookup"><span data-stu-id="6feda-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="6feda-114">Witaj w centrum danych może lub nie może stać się dostępne ponownie.</span><span class="sxs-lookup"><span data-stu-id="6feda-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="6feda-115">Zazwyczaj awarii spowoduje, że niektóre lub wszystkie komunikaty lub innych danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="6feda-116">Przykłady awarii fire, zalewania lub trzęsienie ziemi.</span><span class="sxs-lookup"><span data-stu-id="6feda-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="6feda-117">Architektura bieżącego</span><span class="sxs-lookup"><span data-stu-id="6feda-117">Current architecture</span></span>
<span data-ttu-id="6feda-118">Usługa Service Bus używa wielu komunikatów magazynów toostore wiadomości wysyłanych tooqueues lub tematów.</span><span class="sxs-lookup"><span data-stu-id="6feda-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="6feda-119">Niepartycjonowany kolejka lub temat przypisano tooone magazynu do obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="6feda-120">Ten magazyn obsługi komunikatów jest niedostępny, wszystkie operacje dla tej kolejki lub temat zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="6feda-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="6feda-121">Wszystkie jednostki obsługi komunikatów usługi Service Bus (kolejek, tematów, przekaźników) znajdują się w przestrzeni nazw usługi, które jest powiązane z centrum danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="6feda-122">Magistrali usług nie są włączone automatyczne replikacja geograficzna, danych ani jej zezwala toospan przestrzeni nazw wiele centrów danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="6feda-123">Ochrona przed awariami ACS</span><span class="sxs-lookup"><span data-stu-id="6feda-123">Protecting against ACS outages</span></span>
<span data-ttu-id="6feda-124">Jeśli używane są poświadczenia ACS i usług ACS jest niedostępny, klienci nie mogą uzyskać tokeny.</span><span class="sxs-lookup"><span data-stu-id="6feda-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="6feda-125">Klientów, którzy mają tokenu w czasie hello ACS ulegnie awarii można kontynuować toouse usługi Service Bus do momentu wygaśnięcia tokenów hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="6feda-126">okres istnienia tokenu domyślne Hello jest 3 godziny.</span><span class="sxs-lookup"><span data-stu-id="6feda-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="6feda-127">tooprotect względem awarii ACS za pomocą tokenów dostępu sygnatury dostępu Współdzielonego.</span><span class="sxs-lookup"><span data-stu-id="6feda-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="6feda-128">W takim przypadku klient hello uwierzytelnia bezpośrednio z usługą Service Bus przez podpisywania tokenu własnym minted za pomocą klucza tajnego.</span><span class="sxs-lookup"><span data-stu-id="6feda-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="6feda-129">TooACS wywołania nie są już wymagane.</span><span class="sxs-lookup"><span data-stu-id="6feda-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="6feda-130">Aby uzyskać więcej informacji na temat tokeny sygnatury dostępu Współdzielonego, zobacz [uwierzytelniania usługi Service Bus][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="6feda-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="6feda-131">Ochrona kolejek i tematów z błędami magazynu do obsługi komunikatów</span><span class="sxs-lookup"><span data-stu-id="6feda-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="6feda-132">Niepartycjonowany kolejka lub temat przypisano tooone magazynu do obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="6feda-133">Ten magazyn obsługi komunikatów jest niedostępny, wszystkie operacje dla tej kolejki lub temat zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="6feda-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="6feda-134">A podzielona na partycje kolejki na powitania drugiej strony, składa się z wielu fragmentów.</span><span class="sxs-lookup"><span data-stu-id="6feda-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="6feda-135">Każdy fragment są przechowywane w różnych magazynie obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="6feda-136">Po wysłaniu wiadomości tooa partycjonowanej kolejka lub temat usługi Service Bus przypisuje tooone wiadomość hello hello fragmentów.</span><span class="sxs-lookup"><span data-stu-id="6feda-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="6feda-137">Odpowiedni magazyn obsługi wiadomości powitania jest niedostępny, usługi Service Bus zapisuje wiadomość hello tooa fragmentu innego, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="6feda-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="6feda-138">Aby uzyskać więcej informacji na temat partycjonowane jednostki, zobacz [partycjonowane jednostki do obsługi komunikatów][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="6feda-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="6feda-139">Ochrona przed przestojami centrum danych lub awarii</span><span class="sxs-lookup"><span data-stu-id="6feda-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="6feda-140">tooallow Failover między dwoma centrami danych, można utworzyć przestrzeni nazw usługi Service Bus w każde centrum danych.</span><span class="sxs-lookup"><span data-stu-id="6feda-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="6feda-141">Na przykład Witaj nazw usługi Service Bus **contosoPrimary.servicebus.windows.net** może znajdować się w regionie Stanów Zjednoczonych północ/centralnego hello, i **contosoSecondary.servicebus.windows.net**może znajdować się w regionie nam Południowa/centralnego hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="6feda-142">Jeśli jednostki do obsługi komunikatów usługi Service Bus musi pozostać dostępna w obecności hello awarii centrum danych, możesz utworzyć jednostkę w obu tych przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="6feda-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="6feda-143">Aby uzyskać więcej informacji, zobacz sekcja "Niepowodzenie usługi Service Bus w obrębie centrum danych Azure" hello [asynchroniczne wzorce i wysokiej dostępności do obsługi komunikatów][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="6feda-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="6feda-144">Ochrona punktów końcowych przekazywania względem przestojami centrum danych lub awarii</span><span class="sxs-lookup"><span data-stu-id="6feda-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="6feda-145">Replikacja geograficzna punktów końcowych przekazywania umożliwia to usługa, która przedstawia przekazywania toobe punktu końcowego, dostępny w obecności hello awarie usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="6feda-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="6feda-146">tooachieve replikacja geograficzna, usługa hello musi utworzyć dwa punkty końcowe przekazywania w różnych przestrzeniach nazw.</span><span class="sxs-lookup"><span data-stu-id="6feda-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="6feda-147">przestrzenie nazw Hello musi znajdować się w różnych centrach danych i hello dwa punkty końcowe muszą mieć różne nazwy.</span><span class="sxs-lookup"><span data-stu-id="6feda-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="6feda-148">Na przykład podstawowy punkt końcowy jest osiągalny w obszarze **contosoPrimary.servicebus.windows.net/myPrimaryService**, a jego odpowiednikiem dodatkowej można połączyć się w obszarze **contosoSecondary.servicebus.windows.net /mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="6feda-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="6feda-149">Usługa Hello następnie nasłuchuje oba punkty końcowe, a klient może wywołać hello usługi za pośrednictwem albo punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="6feda-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="6feda-150">Aplikacja kliencka losowo wybiera jeden z przekaźników hello jako hello podstawowy punkt końcowy i wysyła jego żądanie toohello aktywny punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="6feda-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="6feda-151">Jeśli operacja hello kończy się niepowodzeniem z kodem błędu, ten błąd oznacza, że tego punktu końcowego przekazywania hello jest niedostępny.</span><span class="sxs-lookup"><span data-stu-id="6feda-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="6feda-152">Aplikacja Hello otwiera toohello kopii zapasowej punktu końcowego kanału i wysyła żądanie hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="6feda-153">W tym momencie hello active i tworzenia kopii zapasowej punkty końcowe hello przełączyć role: powitania klienta aplikacji uwzględnia hello starego aktywny punkt końcowy toobe hello nowy punkt końcowy kopii zapasowej i hello starego zapasowego punktu końcowego toobe hello nowy aktywny punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="6feda-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="6feda-154">Jeśli niepowodzenie operacji zarówno wysyłania, role hello Witaj dwie jednostki pozostają bez zmian i zostanie zwrócony błąd.</span><span class="sxs-lookup"><span data-stu-id="6feda-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="6feda-155">Witaj [— replikacja geograficzna z usługą Service Bus obsługiwanych przez przekaźnik wiadomości] [ Geo-replication with Service Bus relayed Messages] przykładzie pokazano, jak przekazuje tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="6feda-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="6feda-156">Ochrona kolejek i tematów względem przestojami centrum danych lub awarii</span><span class="sxs-lookup"><span data-stu-id="6feda-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="6feda-157">tooachieve odporności na awarie centrum danych przy użyciu komunikatów obsługiwanych przez brokera, Usługa Service Bus obsługuje dwa podejścia: *active* i *pasywnym* replikacji.</span><span class="sxs-lookup"><span data-stu-id="6feda-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="6feda-158">Dla każdego z podejść Jeśli dany kolejka lub temat musi pozostać dostępna w obecności hello awarii centrum danych, można go utworzyć w obu tych przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="6feda-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="6feda-159">Obie te jednostki można mieć hello tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="6feda-159">Both entities can have hello same name.</span></span> <span data-ttu-id="6feda-160">Na przykład w obszarze osiągalna kolejki głównej **contosoPrimary.servicebus.windows.net/myQueue**, a jego odpowiednikiem dodatkowej można połączyć się w obszarze **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="6feda-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="6feda-161">Jeśli aplikacja hello wymaga stałej łączności nadawcy do odbiornika, aplikacja hello można zaimplementować trwałe kolejki po stronie klienta tooprevent utratą i tooshield hello nadawcy wiadomości z przejściowych błędów usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="6feda-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="6feda-162">Aktywna replikacja</span><span class="sxs-lookup"><span data-stu-id="6feda-162">Active replication</span></span>
<span data-ttu-id="6feda-163">Aktywna replikacja używa jednostek w obu tych przestrzeni nazw dla każdej operacji.</span><span class="sxs-lookup"><span data-stu-id="6feda-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="6feda-164">Każdy klient, który wysyła komunikat wysyła dwie kopie hello tego samego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="6feda-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="6feda-165">Pierwsza kopia Hello są wysyłane toohello podstawowej jednostki (na przykład **contosoPrimary.servicebus.windows.net/sales**), i drugą kopię wiadomości powitania hello są wysyłane toohello dodatkowej jednostki (na przykład  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="6feda-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="6feda-166">Klient odbiera komunikaty z kolejek obu.</span><span class="sxs-lookup"><span data-stu-id="6feda-166">A client receives messages from both queues.</span></span> <span data-ttu-id="6feda-167">procesy odbiornika Hello hello pierwsza kopia wiadomości, a druga kopia hello jest pomijane.</span><span class="sxs-lookup"><span data-stu-id="6feda-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="6feda-168">toosuppress zduplikowanych wiadomości powitania nadawcy musi tagu każdy komunikat z unikatowym identyfikatorem.</span><span class="sxs-lookup"><span data-stu-id="6feda-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="6feda-169">Obydwie kopie wiadomości powitania musi być oznaczane hello tego samego identyfikatora.</span><span class="sxs-lookup"><span data-stu-id="6feda-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="6feda-170">Można użyć hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] lub [BrokeredMessage.Label] [ BrokeredMessage.Label] właściwości lub hello tootag właściwości niestandardowej Komunikat.</span><span class="sxs-lookup"><span data-stu-id="6feda-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="6feda-171">odbiornik Hello muszą zachować listę komunikatów, które już została odebrana.</span><span class="sxs-lookup"><span data-stu-id="6feda-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="6feda-172">Witaj [— replikacja geograficzna z komunikatów obsługiwanych przez brokera magistrali usługi] [ Geo-replication with Service Bus Brokered Messages] przykładzie pokazano aktywna replikacja jednostek do obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="6feda-173">podejście aktywna replikacja Hello podwaja hello liczba operacji, w związku z tym takie podejście może prowadzić toohigher kosztów.</span><span class="sxs-lookup"><span data-stu-id="6feda-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="6feda-174">Pasywne replikacji</span><span class="sxs-lookup"><span data-stu-id="6feda-174">Passive replication</span></span>
<span data-ttu-id="6feda-175">W przypadku awarii bez hello pasywnym replikacji używa tylko jeden z dwóch jednostek obsługi komunikatów hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="6feda-176">Klient wysyła jednostki active toohello wiadomość hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="6feda-177">Jeśli operacja hello w jednostce active hello kończy się niepowodzeniem z kodem błędu wskazujący hello centrum danych, czy jednostki active hello hosty mogą być niedostępne, powitania klienta wysyła kopię jednostek kopii zapasowej toohello wiadomość hello.</span><span class="sxs-lookup"><span data-stu-id="6feda-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="6feda-178">W tym momencie hello active i jednostek kopii zapasowej hello przełączyć role: powitania klienta wysyłania uwzględnia hello starego aktywnych toobe hello nowej kopii zapasowej jednostki i hello starego jednostka kopii zapasowej jest hello nowej jednostki aktywne.</span><span class="sxs-lookup"><span data-stu-id="6feda-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="6feda-179">Jeśli niepowodzenie operacji zarówno wysyłania, role hello Witaj dwie jednostki pozostają bez zmian i zostanie zwrócony błąd.</span><span class="sxs-lookup"><span data-stu-id="6feda-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="6feda-180">Klient odbiera komunikaty z kolejek obu.</span><span class="sxs-lookup"><span data-stu-id="6feda-180">A client receives messages from both queues.</span></span> <span data-ttu-id="6feda-181">Ponieważ jest stosowany tego odbiornika hello odbiera dwie kopie hello sam komunikatu, hello odbiornika musi pomijania zduplikowanych wiadomości.</span><span class="sxs-lookup"><span data-stu-id="6feda-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="6feda-182">Można pominąć duplikatów hello sam sposób jak opisane dla aktywnej replikacji.</span><span class="sxs-lookup"><span data-stu-id="6feda-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="6feda-183">Ogólnie rzecz biorąc pasywnym replikacji jest bardziej ekonomiczne niż replikacja usługi active, ponieważ w większości przypadków jest wykonywane tylko jedna operacja.</span><span class="sxs-lookup"><span data-stu-id="6feda-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="6feda-184">Czas oczekiwania, przepływności i koszt są identyczne toohello niezreplikowanej scenariusza.</span><span class="sxs-lookup"><span data-stu-id="6feda-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="6feda-185">Korzystając z pasywnym replikacji, w hello następujące scenariusze komunikaty mogą być utracone lub odbierane dwa razy:</span><span class="sxs-lookup"><span data-stu-id="6feda-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="6feda-186">**Opóźnienie wiadomości lub utraty**: założono, że nadawca hello pomyślnie wysłał wiadomość kolejki głównej toohello m1 i kolejki hello staje się niedostępna przed odbiornika hello odbiera m1.</span><span class="sxs-lookup"><span data-stu-id="6feda-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="6feda-187">nadawca Hello wysyła kolejki dodatkowej toohello m2 kolejnych komunikatów Szukaj komunikatu.</span><span class="sxs-lookup"><span data-stu-id="6feda-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="6feda-188">Jeśli kolejka głównej hello jest tymczasowo niedostępny, odbiornika hello odbiera m1 po kolejki hello znowu dostępne.</span><span class="sxs-lookup"><span data-stu-id="6feda-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="6feda-189">W przypadku awarii odbiornika hello nigdy nie może zostać wyświetlony m1.</span><span class="sxs-lookup"><span data-stu-id="6feda-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="6feda-190">**Zduplikowana odbioru**: założono tego nadawcy hello wysyła kolejki głównej toohello komunikatów m.</span><span class="sxs-lookup"><span data-stu-id="6feda-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="6feda-191">Usługa Service Bus pomyślnie przetwarza m, ale nie powiedzie się toosend odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="6feda-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="6feda-192">Po hello wysłać czasu operacji wychodzących, hello Nadawca wysyła identyczne kopię kolejki dodatkowej toohello m.</span><span class="sxs-lookup"><span data-stu-id="6feda-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="6feda-193">Jeśli odbiornik hello jest pierwsza kopia stanie tooreceive hello m przed kolejki głównej hello staje się niedostępny, odbiornika hello odbiera obydwie kopie m w przybliżeniu hello tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="6feda-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="6feda-194">Jeśli odbiornik hello nie jest możliwe tooreceive hello pierwszego kopiowania m przed kolejki głównej hello przestanie być dostępny, odbiornika hello początkowo odbiera tylko hello drugiej kopii m, ale otrzyma kopię m po udostępnieniu hello kolejki głównej.</span><span class="sxs-lookup"><span data-stu-id="6feda-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="6feda-195">Witaj [— replikacja geograficzna z usługą Service Bus obsługiwanych przez brokera komunikatów] [ Geo-replication with Service Bus Brokered Messages] przykładzie pokazano pasywnym replikacji jednostki do obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="6feda-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6feda-196">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="6feda-196">Next steps</span></span>
<span data-ttu-id="6feda-197">toolearn więcej informacji na temat odzyskiwania po awarii, zobacz następujące artykuły:</span><span class="sxs-lookup"><span data-stu-id="6feda-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="6feda-198">[Ciągłość prowadzenia działalności biznesowej bazy danych Azure SQL][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="6feda-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="6feda-199">[Projektowanie aplikacji odporne na platformie Azure][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="6feda-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
