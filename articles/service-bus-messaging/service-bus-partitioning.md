---
title: "Tworzenie tematów i kolejek usługi Azure Service Bus partycjonowanej | Dokumentacja firmy Microsoft"
description: "Opisuje sposób partycji tematów i kolejek usługi Service Bus przy użyciu wielu brokerzy wiadomości."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 5a4e69ea7e13cb017f8fb432c524c6a8ce9228a8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="a9f90-103">Partycjonowane kolejki i tematy</span><span class="sxs-lookup"><span data-stu-id="a9f90-103">Partitioned queues and topics</span></span>
<span data-ttu-id="a9f90-104">Usługa Azure Service Bus jest stosowana w wielu brokerów komunikat do przetwarzania komunikatów i wiele magazynów obsługi komunikatów do przechowywania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-104">Azure Service Bus employs multiple message brokers to process messages and multiple messaging stores to store messages.</span></span> <span data-ttu-id="a9f90-105">Konwencjonalne kolejka lub temat są obsługiwane przez brokera pojedynczej wiadomości i przechowywane w jeden Magazyn obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="a9f90-106">Usługa Service Bus *partycje* włączyć kolejek i tematów, lub *jednostki do obsługi komunikatów*, aby być dzielony na partycje w wielu brokerzy wiadomości i magazyny obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, to be partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="a9f90-107">Oznacza to, że ogólną przepustowość partycjonowane jednostki nie jest już ograniczone przez wydajność brokera komunikatów pojedynczego lub magazynie obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-107">This means that the overall throughput of a partitioned entity is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="a9f90-108">Ponadto tymczasowego awaria magazynie obsługi komunikatów nie renderować partycjonowanej kolejka lub temat niedostępny.</span><span class="sxs-lookup"><span data-stu-id="a9f90-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="a9f90-109">Partycjonowane kolejek i tematów może zawierać wszystkich zaawansowanych funkcji usługi Service Bus, takie jak obsługa transakcji i sesje.</span><span class="sxs-lookup"><span data-stu-id="a9f90-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="a9f90-110">Informacje o wewnętrzne usługi Service Bus, zobacz [Architektura usługi Service Bus] [ Service Bus architecture] artykułu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-110">For information about Service Bus internals, see the [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="a9f90-111">Partycjonowanie jest włączone domyślnie podczas tworzenia jednostki dla wszystkich kolejek i tematów w wersjach Standard i Premium messaging.</span><span class="sxs-lookup"><span data-stu-id="a9f90-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="a9f90-112">Można utworzyć Standard warstwy jednostki do obsługi komunikatów bez podziału na partycje, ale kolejek i tematów w przestrzeni nazw Premium zawsze są podzielone na partycje; Nie można wyłączyć tę opcję.</span><span class="sxs-lookup"><span data-stu-id="a9f90-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="a9f90-113">Nie jest możliwe do zmiany opcji podziału na istniejącej kolejki lub tematu w warstwy standardowa lub Premium, można ustawić tylko opcji podczas tworzenia jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-113">It is not possible to change the partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set the option when you create the entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="a9f90-114">Jak to działa</span><span class="sxs-lookup"><span data-stu-id="a9f90-114">How it works</span></span>

<span data-ttu-id="a9f90-115">Każdy partycjonowanej kolejka lub temat składa się z wielu fragmentów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="a9f90-116">Każdy fragment jest przechowywane w różnych magazynie obsługi komunikatów i obsługiwane przez brokera inny komunikat.</span><span class="sxs-lookup"><span data-stu-id="a9f90-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="a9f90-117">Po wysłaniu wiadomości do kolejki podzielonym na partycje lub tematu usługi Service Bus przypisuje wiadomości na jeden z fragmentów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-117">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="a9f90-118">Zaznaczenie jest wykonywane losowo przez magistralę usług lub przy użyciu klucza partycji, który można określić nadawcy.</span><span class="sxs-lookup"><span data-stu-id="a9f90-118">The selection is done randomly by Service Bus or by using a partition key that the sender can specify.</span></span>

<span data-ttu-id="a9f90-119">Gdy klient chce otrzymywać wiadomość z kolejki podzielonym na partycje lub subskrypcję tematu podzielonym na partycje, zapytania usługi Service Bus wszystkie fragmenty wiadomości, zwraca pierwszy komunikat o uzyskany z dowolnej magazyny obsługi komunikatów do odbiornika.</span><span class="sxs-lookup"><span data-stu-id="a9f90-119">When a client wants to receive a message from a partitioned queue, or from a subscription to a partitioned topic, Service Bus queries all fragments for messages, then returns the first message that is obtained from any of the messaging stores to the receiver.</span></span> <span data-ttu-id="a9f90-120">Pamięci podręczne usługi Service Bus, innych komunikatów i zwraca je po odebraniu dodatkowe odbierania żądań.</span><span class="sxs-lookup"><span data-stu-id="a9f90-120">Service Bus caches the other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="a9f90-121">Odbieranie klienta nie został powiadomiony o partycjonowanie; zachowanie po stronie klienta partycjonowanej kolejka lub temat (na przykład Odczyt, ukończenia, odroczenie utraconych wiadomości, Odczyt z wyprzedzeniem) jest taka sama jak zachowanie regularne jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-121">A receiving client is not aware of the partitioning; the client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical to the behavior of a regular entity.</span></span>

<span data-ttu-id="a9f90-122">Nie ma żadnych dodatkowych kosztów przy wysyłaniu wiadomości lub odbierania wiadomości z kolejki podzielonym na partycje lub temat.</span><span class="sxs-lookup"><span data-stu-id="a9f90-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="a9f90-123">Włącz partycjonowania</span><span class="sxs-lookup"><span data-stu-id="a9f90-123">Enable partitioning</span></span>

<span data-ttu-id="a9f90-124">Aby używać partycjonowanej kolejek i tematów z usługi Azure Service Bus, korzystanie z zestawu SDK platformy Azure w wersji 2,2 lub nowszej, lub określ `api-version=2013-10` w HTTP żądania.</span><span class="sxs-lookup"><span data-stu-id="a9f90-124">To use partitioned queues and topics with Azure Service Bus, use the Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="a9f90-125">Standardowa</span><span class="sxs-lookup"><span data-stu-id="a9f90-125">Standard</span></span>

<span data-ttu-id="a9f90-126">W warstwie standardowej obsługi wiadomości można utworzyć kolejki usługi Service Bus i tematów w rozmiarze 1, 2, 3, 4 lub 5 GB (wartość domyślna to 1 GB).</span><span class="sxs-lookup"><span data-stu-id="a9f90-126">In the Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="a9f90-127">Z partycjonowania włączone, usługi Service Bus tworzy 16 kopie (16 partycji) jednostki dla każdego Gigabajta określisz.</span><span class="sxs-lookup"><span data-stu-id="a9f90-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of the entity for each GB you specify.</span></span> <span data-ttu-id="a9f90-128">Tak, można utworzyć kolejkę o rozmiarze 5 GB, z 16 partycji maksymalny rozmiar kolejki staje się (5 \* 16) = 80 GB.</span><span class="sxs-lookup"><span data-stu-id="a9f90-128">As such, if you create a queue that's 5 GB in size, with 16 partitions the maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="a9f90-129">Maksymalny rozmiar kolejki podzielonym na partycje lub temat widzą analizując jego wpis [portalu Azure][Azure portal]w **omówienie** bloku dla tej jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-129">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="a9f90-130">Premium</span><span class="sxs-lookup"><span data-stu-id="a9f90-130">Premium</span></span>

<span data-ttu-id="a9f90-131">W przypadku przestrzeni nazw warstwy Premium można utworzyć kolejki usługi Service Bus i tematów w rozmiarze 1, 2, 3, 4, 5, 10, 20, 40 lub 80 GB (wartość domyślna to 1 GB).</span><span class="sxs-lookup"><span data-stu-id="a9f90-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="a9f90-132">W partycji, domyślnie włączona, usługi Service Bus tworzy dwie partycje nieobsługujące jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="a9f90-133">Maksymalny rozmiar kolejki podzielonym na partycje lub temat widzą analizując jego wpis [portalu Azure][Azure portal]w **omówienie** bloku dla tej jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-133">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

<span data-ttu-id="a9f90-134">Aby uzyskać więcej informacji na temat partycjonowania w warstwie Premium obsługi komunikatów, zobacz [usługi Service Bus w warstwie Premium i standardowa komunikatami w warstwie](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="a9f90-134">For more information about partitioning in the Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="a9f90-135">Utwórz jednostkę podzielonym na partycje</span><span class="sxs-lookup"><span data-stu-id="a9f90-135">Create a partitioned entity</span></span>

<span data-ttu-id="a9f90-136">Istnieje kilka sposobów tworzenia partycjonowanej kolejka lub temat.</span><span class="sxs-lookup"><span data-stu-id="a9f90-136">There are several ways to create a partitioned queue or topic.</span></span> <span data-ttu-id="a9f90-137">Podczas tworzenia kolejki lub tematu z aplikacji, można włączyć podział kolejka lub temat odpowiednio ustawiając [QueueDescription.EnablePartitioning] [ QueueDescription.EnablePartitioning] lub [ TopicDescription.EnablePartitioning] [ TopicDescription.EnablePartitioning] właściwości **true**.</span><span class="sxs-lookup"><span data-stu-id="a9f90-137">When you create the queue or topic from your application, you can enable partitioning for the queue or topic by respectively setting the [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property to **true**.</span></span> <span data-ttu-id="a9f90-138">Te właściwości musi być ustawiony w tym czasie kolejki lub utworzeniu tematu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-138">These properties must be set at the time the queue or topic is created.</span></span> <span data-ttu-id="a9f90-139">Jak wspomniano wcześniej, nie jest możliwe zmienianie te właściwości istniejącej kolejki lub temat.</span><span class="sxs-lookup"><span data-stu-id="a9f90-139">As stated previously, it is not possible to change these properties on an existing queue or topic.</span></span> <span data-ttu-id="a9f90-140">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="a9f90-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="a9f90-141">Alternatywnie można utworzyć kolejki podzielonym na partycje lub tematu w [portalu Azure] [ Azure portal] lub w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a9f90-141">Alternatively, you can create a partitioned queue or topic in the [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="a9f90-142">Podczas tworzenia kolejki lub tematu w portalu, **włączyć partycjonowania** opcję kolejka lub temat **Utwórz** bloku jest domyślnie zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="a9f90-142">When you create a queue or topic in the portal, the **Enable partitioning** option in the queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="a9f90-143">Tylko można wyłączyć tę opcję w jednostce warstwy standardowa; w warstwie Premium Partycjonowanie jest zawsze włączone.</span><span class="sxs-lookup"><span data-stu-id="a9f90-143">You can only disable this option in a Standard tier entity; in the Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="a9f90-144">W programie Visual Studio, kliknij przycisk **włączyć partycjonowania** checkbox w **nową kolejkę** lub **nowy temat** okno dialogowe.</span><span class="sxs-lookup"><span data-stu-id="a9f90-144">In Visual Studio, click the **Enable Partitioning** checkbox in the **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="a9f90-145">Użycie kluczy partycji</span><span class="sxs-lookup"><span data-stu-id="a9f90-145">Use of partition keys</span></span>
<span data-ttu-id="a9f90-146">Gdy komunikat jest dodawanych do kolejki w podzielonym na partycje kolejka lub temat, usługi Service Bus sprawdza obecności klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for the presence of a partition key.</span></span> <span data-ttu-id="a9f90-147">Jeśli zostanie znaleziony, wybiera fragmentu na podstawie tego klucza.</span><span class="sxs-lookup"><span data-stu-id="a9f90-147">If it finds one, it selects the fragment based on that key.</span></span> <span data-ttu-id="a9f90-148">Jeśli nie znajdzie klucza partycji, wybiera fragmentu na podstawie wewnętrznego algorytmu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-148">If it does not find a partition key, it selects the fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="a9f90-149">Użycie klucza partycji</span><span class="sxs-lookup"><span data-stu-id="a9f90-149">Using a partition key</span></span>
<span data-ttu-id="a9f90-150">Niektóre scenariusze, takie jak sesji lub transakcji, wymagają wiadomości, które mają być przechowywane w określonych fragmentu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-150">Some scenarios, such as sessions or transactions, require messages to be stored in a specific fragment.</span></span> <span data-ttu-id="a9f90-151">Te scenariusze wymagają użycia klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-151">All these scenarios require the use of a partition key.</span></span> <span data-ttu-id="a9f90-152">Wszystkie komunikaty, które używają tego samego klucza partycji są przypisane do tego samego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-152">All messages that use the same partition key are assigned to the same fragment.</span></span> <span data-ttu-id="a9f90-153">Jeśli fragment jest tymczasowo niedostępny, usługi Service Bus zwraca błąd.</span><span class="sxs-lookup"><span data-stu-id="a9f90-153">If the fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="a9f90-154">W zależności od scenariusza inny komunikat właściwości są używane jako klucza partycji:</span><span class="sxs-lookup"><span data-stu-id="a9f90-154">Depending on the scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="a9f90-155">**Identyfikator sesji**: Jeśli wiadomość ma [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] ustaw właściwość, a następnie usługi Service Bus używa tej właściwości jako klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-155">**SessionId**: If a message has the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as the partition key.</span></span> <span data-ttu-id="a9f90-156">Dzięki temu wszystkie komunikaty, które należą do tej samej sesji są obsługiwane przez tego samego brokera komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-156">This way, all messages that belong to the same session are handled by the same message broker.</span></span> <span data-ttu-id="a9f90-157">Dzięki temu usługa Service Bus zagwarantowanie komunikat porządkowanie oraz spójności stanów sesji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-157">This enables Service Bus to guarantee message ordering as well as the consistency of session states.</span></span>

<span data-ttu-id="a9f90-158">**PartitionKey**: Jeśli wiadomość ma [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] właściwości, ale nie [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] ustaw właściwość, a następnie używa usługi Service Bus [PartitionKey] [ PartitionKey] właściwość jako klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-158">**PartitionKey**: If a message has the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses the [PartitionKey][PartitionKey] property as the partition key.</span></span> <span data-ttu-id="a9f90-159">Jeśli wiadomość ma zarówno atrybut [SessionId] [ SessionId] i [PartitionKey] [ PartitionKey] zestaw właściwości obie właściwości muszą być takie same.</span><span class="sxs-lookup"><span data-stu-id="a9f90-159">If the message has both the [SessionId][SessionId] and the [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="a9f90-160">Jeśli [PartitionKey] [ PartitionKey] właściwość jest ustawiona na wartość inną niż [SessionId] [ SessionId] właściwość, usługi Service Bus zwraca jest nieprawidłowa wyjątek operacji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-160">If the [PartitionKey][PartitionKey] property is set to a different value than the [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a9f90-161">[PartitionKey] [ PartitionKey] właściwości należy używać, gdy nadawca wysyła wiadomości transakcyjne pamiętać-session.</span><span class="sxs-lookup"><span data-stu-id="a9f90-161">The [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="a9f90-162">Klucz partycji gwarantuje, że wszystkie komunikaty, które są wysyłane w ramach transakcji są obsługiwane przez tego samego brokera obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-162">The partition key ensures that all messages that are sent within a transaction are handled by the same messaging broker.</span></span>

<span data-ttu-id="a9f90-163">**Identyfikator komunikatu**: Jeśli kolejka lub temat ma [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] ustawioną właściwość **true** i [ BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] lub [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] nie ustawiono właściwości, a następnie [ BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] właściwość służy jako klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-163">**MessageId**: If the queue or topic has the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set to **true** and the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as the partition key.</span></span> <span data-ttu-id="a9f90-164">(Należy pamiętać, że biblioteki Microsoft .NET i protokołu AMQP automatycznie przypisać identyfikator komunikatu, jeśli aplikacja wysyłająca nie). W takim przypadku wszystkie kopie tej samej wiadomości są obsługiwane przez tego samego brokera komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-164">(Note that the Microsoft .NET and AMQP libraries automatically assign a message ID if the sending application does not.) In this case, all copies of the same message are handled by the same message broker.</span></span> <span data-ttu-id="a9f90-165">Dzięki temu usługa Service Bus do wykrywania i eliminowania duplikatów wiadomości.</span><span class="sxs-lookup"><span data-stu-id="a9f90-165">This enables Service Bus to detect and eliminate duplicate messages.</span></span> <span data-ttu-id="a9f90-166">Jeśli [QueueDescription.RequiresDuplicateDetection] [ QueueDescription.RequiresDuplicateDetection] nie ustawiono właściwości **true**, magistrali usług nie należy wziąć pod uwagę [MessageId] [ MessageId] właściwość jako klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-166">If the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set to **true**, Service Bus does not consider the [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="a9f90-167">Nie używa klucza partycji</span><span class="sxs-lookup"><span data-stu-id="a9f90-167">Not using a partition key</span></span>
<span data-ttu-id="a9f90-168">W przypadku braku klucza partycji usługi Service Bus dystrybuuje wiadomości w okrężne do wszystkie fragmenty partycjonowanej kolejka lub temat.</span><span class="sxs-lookup"><span data-stu-id="a9f90-168">In the absence of a partition key, Service Bus distributes messages in a round-robin fashion to all the fragments of the partitioned queue or topic.</span></span> <span data-ttu-id="a9f90-169">Wybrany fragment jest niedostępny, usługi Service Bus przypisuje komunikat różnych fragmentu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-169">If the chosen fragment is not available, Service Bus assigns the message to a different fragment.</span></span> <span data-ttu-id="a9f90-170">W ten sposób wysyłania powiedzie się niezależnie od tymczasowej niedostępności magazynie obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-170">This way, the send operation succeeds despite the temporary unavailability of a messaging store.</span></span> <span data-ttu-id="a9f90-171">Jednak nie będzie osiągnąć gwarantuje kolejność, który zawiera klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-171">However, you will not achieve the guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="a9f90-172">Aby uzyskać bardziej szczegółowym omówieniem zależności między dostępności (nie klucza partycji) i spójności (przy użyciu klucza partycji), zobacz [w tym artykule](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="a9f90-172">For a more in-depth discussion of the tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="a9f90-173">Te informacje dotyczą jednakowo partycjonowane jednostki magistrali usług i partycji usługi Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="a9f90-173">This information applies equally to partitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="a9f90-174">Aby zapewnić usługi Service Bus wystarczająco dużo czasu można umieścić w kolejce wiadomości do fragmentu innego [MessagingFactorySettings.OperationTimeout] [ MessagingFactorySettings.OperationTimeout] wartość określoną przez klienta, który wysyła wiadomości musi być większa od 15 sekund.</span><span class="sxs-lookup"><span data-stu-id="a9f90-174">To give Service Bus enough time to enqueue the message into a different fragment, the [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by the client that sends the message must be greater than 15 seconds.</span></span> <span data-ttu-id="a9f90-175">Zalecane jest, aby ustawić [OperationTimeout] [ OperationTimeout] właściwości wartość domyślna wynosząca 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="a9f90-175">It is recommended that you set the [OperationTimeout][OperationTimeout] property to the default value of 60 seconds.</span></span>

<span data-ttu-id="a9f90-176">Należy pamiętać, że klucz partycji "PIN" komunikat do określonego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-176">Note that a partition key "pins" a message to a specific fragment.</span></span> <span data-ttu-id="a9f90-177">Jeśli w magazynie obsługi komunikatów, który zawiera ten fragment jest niedostępny, usługi Service Bus zwraca błąd.</span><span class="sxs-lookup"><span data-stu-id="a9f90-177">If the messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="a9f90-178">W przypadku braku klucza partycji usługi Service Bus można wybrać różne fragmentu i powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="a9f90-178">In the absence of a partition key, Service Bus can choose a different fragment and the operation succeeds.</span></span> <span data-ttu-id="a9f90-179">Dlatego zaleca się, że nie zostanie podany klucz partycji, chyba że jest to wymagane.</span><span class="sxs-lookup"><span data-stu-id="a9f90-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="a9f90-180">Tematy zaawansowane: transakcji za pomocą partycjonowane jednostki</span><span class="sxs-lookup"><span data-stu-id="a9f90-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="a9f90-181">Komunikaty, które są wysyłane jako część transakcji muszą określać klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="a9f90-182">Może to być jeden z następujących właściwości: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], lub [ BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="a9f90-182">This can be one of the following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="a9f90-183">Wszystkie komunikaty, które są wysyłane w ramach tej samej transakcji należy określić ten sam klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-183">All messages that are sent as part of the same transaction must specify the same partition key.</span></span> <span data-ttu-id="a9f90-184">Jeśli chcesz wysłać wiadomość bez klucza partycji w ramach transakcji, usługi Service Bus zwraca wyjątek Nieprawidłowa operacja.</span><span class="sxs-lookup"><span data-stu-id="a9f90-184">If you attempt to send a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a9f90-185">Próba wysyłania wielu wiadomości w tej samej transakcji o różnych kluczach partycji usługi Service Bus zwraca wyjątek Nieprawidłowa operacja.</span><span class="sxs-lookup"><span data-stu-id="a9f90-185">If you attempt to send multiple messages within the same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a9f90-186">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="a9f90-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="a9f90-187">Jeśli ustawiono wartość właściwości, które służą jako klucza partycji, usługi Service Bus PIN wiadomości do określonego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-187">If any of the properties that serve as a partition key are set, Service Bus pins the message to a specific fragment.</span></span> <span data-ttu-id="a9f90-188">Dzieje się tak, czy transakcja jest używany.</span><span class="sxs-lookup"><span data-stu-id="a9f90-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="a9f90-189">Zaleca się, że nie określisz klucza partycji, jeśli nie jest konieczne.</span><span class="sxs-lookup"><span data-stu-id="a9f90-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="a9f90-190">Korzystanie z sesji z partycjonowane jednostki</span><span class="sxs-lookup"><span data-stu-id="a9f90-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="a9f90-191">Do wysyłania wiadomości transakcyjnych do tematu obsługujący sesji lub kolejki, aby wiadomość miała [BrokeredMessage.SessionId] [ BrokeredMessage.SessionId] zestawu właściwości.</span><span class="sxs-lookup"><span data-stu-id="a9f90-191">To send a transactional message to a session-aware topic or queue, the message must have the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="a9f90-192">Jeśli [BrokeredMessage.PartitionKey] [ BrokeredMessage.PartitionKey] także określona właściwość, musi być taki sam jak [SessionId] [ SessionId] właściwości.</span><span class="sxs-lookup"><span data-stu-id="a9f90-192">If the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical to the [SessionId][SessionId] property.</span></span> <span data-ttu-id="a9f90-193">Jeśli będą się różnić, usługi Service Bus zwraca wyjątek Nieprawidłowa operacja.</span><span class="sxs-lookup"><span data-stu-id="a9f90-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="a9f90-194">W odróżnieniu od regularne (niepartycjonowany) kolejki i tematy nie jest możliwe wysyłać wiele różnych sesji za pomocą pojedynczej transakcji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-194">Unlike regular (non-partitioned) queues or topics, it is not possible to use a single transaction to send multiple messages to different sessions.</span></span> <span data-ttu-id="a9f90-195">Jeśli podjęto, usługi Service Bus zwraca wyjątek Nieprawidłowa operacja.</span><span class="sxs-lookup"><span data-stu-id="a9f90-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="a9f90-196">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="a9f90-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="a9f90-197">Przekazywanie komunikatów automatyczne z partycjonowane jednostki</span><span class="sxs-lookup"><span data-stu-id="a9f90-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="a9f90-198">Usługa Service Bus obsługuje komunikat automatycznego przesyłania dalej z, aby lub między partycjonowane jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="a9f90-199">Aby włączyć przekazywanie automatyczne wiadomości, ustaw [QueueDescription.ForwardTo] [ QueueDescription.ForwardTo] właściwości kolejki źródłowej lub subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-199">To enable automatic message forwarding, set the [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on the source queue or subscription.</span></span> <span data-ttu-id="a9f90-200">Jeśli komunikat określa klucz partycji ([SessionId][SessionId], [PartitionKey][PartitionKey], lub [MessageId] [ MessageId]), ten klucz partycji służy do jednostki docelowej.</span><span class="sxs-lookup"><span data-stu-id="a9f90-200">If the message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for the destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="a9f90-201">Zagadnienia i wskazówki</span><span class="sxs-lookup"><span data-stu-id="a9f90-201">Considerations and guidelines</span></span>
* <span data-ttu-id="a9f90-202">**Funkcje wysokiej spójności**: Jeśli jednostki korzysta z funkcji, takich jak sesje, wykrywania duplikatów lub jawne kontrolę nad kluczem partycjonowania, a następnie operacje obsługi wiadomości zawsze są kierowane do określonego fragmenty.</span><span class="sxs-lookup"><span data-stu-id="a9f90-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then the messaging operations are always routed to specific fragments.</span></span> <span data-ttu-id="a9f90-203">Jeśli występują dowolne z fragmentów dużego natężenia ruchu sieciowego lub odpowiedni magazyn jest zła, te operacje kończą się niepowodzeniem, i zmniejsza dostępności.</span><span class="sxs-lookup"><span data-stu-id="a9f90-203">If any of the fragments experience high traffic or the underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="a9f90-204">Generalnie spójności jest nadal znacznie wyższa niż niepartycjonowany jednostki; tylko podzestaw ruchu wystąpiły problemy, a nie cały ruch.</span><span class="sxs-lookup"><span data-stu-id="a9f90-204">Overall, the consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed to all the traffic.</span></span> <span data-ttu-id="a9f90-205">Aby uzyskać więcej informacji, zobacz [Omówienie dostępności i spójności](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="a9f90-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="a9f90-206">**Zarządzanie**: należy wykonać operacji, takich jak tworzenie, Update i Delete na wszystkie fragmenty jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-206">**Management**: Operations such as Create, Update and Delete must be performed on all the fragments of the entity.</span></span> <span data-ttu-id="a9f90-207">Jeśli wszystkie fragment jest zła może spowodować błędy do tych operacji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="a9f90-208">Dla operacji Get informacje takie jak liczba wiadomości musi być agregowana z wszystkie fragmenty.</span><span class="sxs-lookup"><span data-stu-id="a9f90-208">For the Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="a9f90-209">Jeśli wszystkie fragment jest zła, stan dostępności jednostki został zgłoszony jako ograniczone.</span><span class="sxs-lookup"><span data-stu-id="a9f90-209">If any fragment is unhealthy, the entity availability status is reported as limited.</span></span>
* <span data-ttu-id="a9f90-210">**Niska scenariuszy komunikat**: dla takich scenariuszy, szczególnie w przypadku, gdy przy użyciu protokołu HTTP, może zajść potrzeba wykonania wielu operacji pobrania w celu uzyskania wszystkie komunikaty.</span><span class="sxs-lookup"><span data-stu-id="a9f90-210">**Low volume message scenarios**: For such scenarios, especially when using the HTTP protocol, you may have to perform multiple receive operations in order to obtain all the messages.</span></span> <span data-ttu-id="a9f90-211">Dla żądania odbierania fronton wykonuje receive na wszystkie fragmenty i przechowuje wszystkie odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="a9f90-211">For receive requests, the front end performs a receive on all the fragments and caches all the responses received.</span></span> <span data-ttu-id="a9f90-212">Żądania odbierania kolejnych w ramach tego samego połączenia będzie korzystać z tej pamięci podręcznej i odbierania opóźnienia będzie niższa.</span><span class="sxs-lookup"><span data-stu-id="a9f90-212">A subsequent receive request on the same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="a9f90-213">Jednak jeśli masz wiele połączeń lub za pomocą protokołu HTTP, który ustanawia nowego połączenia dla każdego żądania.</span><span class="sxs-lookup"><span data-stu-id="a9f90-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="a9f90-214">W efekcie nie ma żadnej gwarancji, że będzie on trafić w tym samym węźle.</span><span class="sxs-lookup"><span data-stu-id="a9f90-214">As such, there is no guarantee that it would land on the same node.</span></span> <span data-ttu-id="a9f90-215">Jeśli wszystkie istniejące wiadomości są zablokowane i są przechowywane w innej frontonu, operacja receive zwraca **null**.</span><span class="sxs-lookup"><span data-stu-id="a9f90-215">If all existing messages are locked and cached in another front end, the receive operation returns **null**.</span></span> <span data-ttu-id="a9f90-216">Po pewnym czasie wygaśnięcia wiadomości i może odbierać je ponownie.</span><span class="sxs-lookup"><span data-stu-id="a9f90-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="a9f90-217">Utrzymanie aktywności HTTP jest zalecane.</span><span class="sxs-lookup"><span data-stu-id="a9f90-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="a9f90-218">**Przeglądaj/Peek wiadomości**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) nie zawsze zwraca liczbę wiadomości określona w [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) właściwości.</span><span class="sxs-lookup"><span data-stu-id="a9f90-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return the number of messages specified in the [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="a9f90-219">Istnieją dwie typowe powody to.</span><span class="sxs-lookup"><span data-stu-id="a9f90-219">There are two common reasons for this.</span></span> <span data-ttu-id="a9f90-220">Jedną z przyczyn jest to, że zagregowane rozmiar kolekcji komunikatów przekracza maksymalny rozmiar 256 KB.</span><span class="sxs-lookup"><span data-stu-id="a9f90-220">One reason is that the aggregated size of the collection of messages exceeds the maximum size of 256KB.</span></span> <span data-ttu-id="a9f90-221">Inną przyczyną jest to, że jeśli kolejka lub temat ma [właściwości parametr EnablePartitioning](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) ustawioną **true**, partycji może nie mieć wystarczającej ilości komunikaty, aby ukończyć żądanej liczby komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-221">Another reason is that if the queue or topic has the [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set to **true**, a partition may not have enough messages to complete the requested number of messages.</span></span> <span data-ttu-id="a9f90-222">Ogólnie rzecz biorąc, jeśli aplikacja chce otrzymywać określoną liczbę wiadomości, powinna wywołać [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) aż pobiera tej liczby wiadomości, lub nie ma żadnych więcej komunikatów do wglądu.</span><span class="sxs-lookup"><span data-stu-id="a9f90-222">In general, if an application wants to receive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages to peek.</span></span> <span data-ttu-id="a9f90-223">Aby uzyskać więcej informacji, przykłady kodu, w tym temacie [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) lub [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="a9f90-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="a9f90-224">Najnowsze funkcje dodane</span><span class="sxs-lookup"><span data-stu-id="a9f90-224">Latest added features</span></span>
* <span data-ttu-id="a9f90-225">Dodawanie lub usuwanie reguł jest teraz obsługiwana przez partycjonowane jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="a9f90-226">Inne niż niepartycjonowany jednostki, te operacje nie są obsługiwane w transakcji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="a9f90-227">Protokół AMQP jest teraz obsługiwana do wysyłania i odbierania wiadomości do i z partycjonowane jednostki.</span><span class="sxs-lookup"><span data-stu-id="a9f90-227">AMQP is now supported for sending and receiving messages to and from a partitioned entity.</span></span>
* <span data-ttu-id="a9f90-228">Protokół AMQP jest teraz obsługiwana przez następujące operacje: [wysyłania partii](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [odbierania partii](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive numer porządkowy](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [wgląd](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [ Odnów blokady](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [zaplanować komunikat](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Anuluj zaplanowane wiadomość](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Dodaj regułę](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Usuń regułę](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Sesji odnawiania blokady](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [stanu sesji zestaw](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [stanu sesji Get](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), i [wyliczyć sesji](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="a9f90-228">AMQP is now supported for the following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="a9f90-229">Ograniczenia partycjonowane jednostki</span><span class="sxs-lookup"><span data-stu-id="a9f90-229">Partitioned entities limitations</span></span>
<span data-ttu-id="a9f90-230">Obecnie Usługa Service Bus nakłada następujące ograniczenia partycjonowanej kolejek i tematów:</span><span class="sxs-lookup"><span data-stu-id="a9f90-230">Currently Service Bus imposes the following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="a9f90-231">Partycjonowane kolejek i tematów nie obsługują wysyłanie wiadomości, które należą do różnych sesji w ramach jednej transakcji.</span><span class="sxs-lookup"><span data-stu-id="a9f90-231">Partitioned queues and topics do not support sending messages that belong to different sessions in a single transaction.</span></span>
* <span data-ttu-id="a9f90-232">Usługa Service Bus umożliwia obecnie maksymalnie 100 partycjonowanej kolejki i tematy na przestrzeń nazw.</span><span class="sxs-lookup"><span data-stu-id="a9f90-232">Service Bus currently allows up to 100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="a9f90-233">Każdy partycjonowanej kolejka lub temat, liczy się przydziału 10 000 jednostek na przestrzeń nazw (nie ma zastosowania do warstwy Premium).</span><span class="sxs-lookup"><span data-stu-id="a9f90-233">Each partitioned queue or topic counts towards the quota of 10,000 entities per namespace (does not apply to Premium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a9f90-234">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="a9f90-234">Next steps</span></span>
<span data-ttu-id="a9f90-235">Zawiera omówienie [obsługi protokołu AMQP 1.0 dla usługi Service Bus podzielona na partycje, kolejek i tematów] [ AMQP 1.0 support for Service Bus partitioned queues and topics] Aby dowiedzieć się więcej na temat partycjonowania jednostek obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="a9f90-235">See the discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] to learn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
