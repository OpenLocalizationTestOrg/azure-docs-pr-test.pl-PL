---
title: "Tworzenie aplikacji korzystających z tematów i subskrypcji Azure Service Bus | Dokumentacja firmy Microsoft"
description: "Wprowadzenie do publikacji-subskrypcji możliwości oferowane przez usługi Service Bus tematów i subskrypcji."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a48fc9b0-b7b0-464e-8187-a517bf8b4eb4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2017
ms.author: sethm
ms.openlocfilehash: eb01120ce9578f716e5381c107faa93f0b36e358
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="create-applications-that-use-service-bus-topics-and-subscriptions"></a><span data-ttu-id="209bc-103">Tworzenie aplikacji korzystających z usługi Service Bus tematów i subskrypcji</span><span class="sxs-lookup"><span data-stu-id="209bc-103">Create applications that use Service Bus topics and subscriptions</span></span>
<span data-ttu-id="209bc-104">Usługa Azure Service Bus obsługuje zestaw technologii chmurowych, zorientowany oprogramowanie pośredniczące, takich jak usługi kolejkowania komunikatów niezawodnej i trwałe publikowania/subskrybowania komunikatów.</span><span class="sxs-lookup"><span data-stu-id="209bc-104">Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="209bc-105">W tym artykule opiera się na informacji dostępnych w [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md) i oferuje wprowadzenie do publikowania/subskrypcji możliwości oferowane przez tematów usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="209bc-105">This article builds on the information provided in [Create applications that use Service Bus queues](service-bus-create-queues.md) and offers an introduction to the publish/subscribe capabilities offered by Service Bus topics.</span></span>

## <a name="evolving-retail-scenario"></a><span data-ttu-id="209bc-106">Scenariusz sprzedaży detalicznej zmieniające się</span><span class="sxs-lookup"><span data-stu-id="209bc-106">Evolving retail scenario</span></span>
<span data-ttu-id="209bc-107">W tym artykule nadal scenariusz sprzedaży detalicznej używane w [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="209bc-107">This article continues the retail scenario used in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span> <span data-ttu-id="209bc-108">Odwołaj danych sprzedaży z poszczególnych punktu z sprzedaży (POS) terminale muszą być kierowane do systemu zarządzania spisem, który używa tych danych do określania, kiedy ma być uzupełniona zasobów.</span><span class="sxs-lookup"><span data-stu-id="209bc-108">Recall that sales data from individual Point of Sale (POS) terminals must be routed to an inventory management system which uses that data to determine when stock has to be replenished.</span></span> <span data-ttu-id="209bc-109">Każdy terminal POS raporty jego danych sprzedaży przez wysyłanie komunikatów do **DataCollectionQueue** kolejki, gdy są one nadal dopóki nie zostaną odebrane z magazynu systemu zarządzania, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="209bc-109">Each POS terminal reports its sales data by sending messages to the **DataCollectionQueue** queue, where they remain until they are received by the inventory management system, as shown here:</span></span>

![Usługa Service Bus 1](./media/service-bus-create-topics-subscriptions/IC657161.gif)

<span data-ttu-id="209bc-111">Podlegać ewolucji w tym scenariuszu, do systemu dodano nowe wymaganie: właściciela sklepu chce mieć możliwość monitorowania, jak magazyn działa w czasie rzeczywistym.</span><span class="sxs-lookup"><span data-stu-id="209bc-111">To evolve this scenario, a new requirement has been added to the system: the store owner wants to be able to monitor how the store is performing in real time.</span></span>

<span data-ttu-id="209bc-112">W celu rozwiązania tego wymagania, system musi "naciśnij przycisk" Wyłącz strumienia danych sprzedaży.</span><span class="sxs-lookup"><span data-stu-id="209bc-112">To address this requirement, the system must "tap" off the sales data stream.</span></span> <span data-ttu-id="209bc-113">Każdy komunikat wysyłany przez Terminale POS do wysłania do systemu zarządzania spisu jako przed chcemy się nadal, ale chcemy innej kopii każdej wiadomości, które firma Microsoft służy do prezentowania widoku pulpitu nawigacyjnego do właściciela sklepu.</span><span class="sxs-lookup"><span data-stu-id="209bc-113">We still want each message sent by the POS terminals to be sent to the inventory management system as before, but we want another copy of each message that we can use to present the dashboard view to the store owner.</span></span>

<span data-ttu-id="209bc-114">W każdej sytuacji, takich jak ta, w której wymagają każdy komunikat jest używane przez wiele stron, można użyć usługi Service Bus *tematy*.</span><span class="sxs-lookup"><span data-stu-id="209bc-114">In any situation such as this, in which you require each message to be consumed by multiple parties, you can use Service Bus *topics*.</span></span> <span data-ttu-id="209bc-115">Tematy zawierają wzorzec publikowania/subskrypcji, w którym każdy opublikowany komunikat jest udostępniony dla przynajmniej jednej subskrypcji zarejestrowanej w temacie.</span><span class="sxs-lookup"><span data-stu-id="209bc-115">Topics provide a publish/subscribe pattern in which each published message is made available to one or more subscriptions registered with the topic.</span></span> <span data-ttu-id="209bc-116">Z kolei w przypadku kolejek każdy komunikat jest odbierany przez jednego konsumenta.</span><span class="sxs-lookup"><span data-stu-id="209bc-116">In contrast, with queues each message is received by a single consumer.</span></span>

<span data-ttu-id="209bc-117">Komunikaty są wysyłane do tematu w taki sam sposób jak te są wysyłane do kolejki.</span><span class="sxs-lookup"><span data-stu-id="209bc-117">Messages are sent to a topic in the same way as they are sent to a queue.</span></span> <span data-ttu-id="209bc-118">Jednak nie odbiera wiadomości z tematu bezpośrednio; zostały odebrane z subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-118">However, messages are not received from the topic directly; they are received from subscriptions.</span></span> <span data-ttu-id="209bc-119">Można potraktować subskrypcję tematu jako wirtualną kolejkę, która odbiera kopie komunikatów, które są wysyłane do tego tematu.</span><span class="sxs-lookup"><span data-stu-id="209bc-119">You can think of a subscription to a topic as a virtual queue that receives copies of the messages that are sent to that topic.</span></span> <span data-ttu-id="209bc-120">Komunikaty są odbierane z subskrypcji samo są odbierane z kolejki.</span><span class="sxs-lookup"><span data-stu-id="209bc-120">Messages are received from a subscription the same way as they are received from a queue.</span></span>

<span data-ttu-id="209bc-121">Po powrocie do scenariusza sieci sprzedaży, kolejki zastępuje tematu i subskrypcji zostanie dodany, którego można użyć składnika systemu zarządzania spisu.</span><span class="sxs-lookup"><span data-stu-id="209bc-121">Going back to the retail scenario, the queue is replaced by a topic, and a subscription is added, which the inventory management system component can use.</span></span> <span data-ttu-id="209bc-122">System pojawi się teraz w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="209bc-122">The system now appears as follows:</span></span>

![Usługa Service Bus 2](./media/service-bus-create-topics-subscriptions/IC657165.gif)

<span data-ttu-id="209bc-124">Konfiguracji przeprowadza się tak samo do poprzedniego projekt na podstawie kolejki.</span><span class="sxs-lookup"><span data-stu-id="209bc-124">The configuration here performs identically to the previous queue-based design.</span></span> <span data-ttu-id="209bc-125">Oznacza to, że komunikaty wysłane do tematu są kierowane do **spisu** subskrypcji, z którego **systemu zarządzania spisem** je wykorzystuje.</span><span class="sxs-lookup"><span data-stu-id="209bc-125">That is, messages sent to the topic are routed to the **Inventory** subscription, from which the **Inventory Management System** consumes them.</span></span>

<span data-ttu-id="209bc-126">Aby zapewnić obsługę pulpit nawigacyjny zarządzania, utworzymy drugi subskrypcję tematu, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="209bc-126">In order to support the management dashboard, we create a second subscription on the topic, as shown here:</span></span>

![Usługa Service Bus 3](./media/service-bus-create-topics-subscriptions/IC657166.gif)

<span data-ttu-id="209bc-128">W tej konfiguracji, ma zostać udostępnione zarówno każdy komunikat z Terminale POS **pulpitu nawigacyjnego** i **spisu** subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-128">With this configuration, each message from the POS terminals is made available to both the **Dashboard** and **Inventory** subscriptions.</span></span>

## <a name="show-me-the-code"></a><span data-ttu-id="209bc-129">Pokaż kod</span><span class="sxs-lookup"><span data-stu-id="209bc-129">Show me the code</span></span>
<span data-ttu-id="209bc-130">Artykuł [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md) opisano, jak utworzyć konta platformy Azure i tworzenia przestrzeni nazw usługi.</span><span class="sxs-lookup"><span data-stu-id="209bc-130">The article [Create applications that use Service Bus queues](service-bus-create-queues.md) describes how to sign up for an Azure account and create a service namespace.</span></span> <span data-ttu-id="209bc-131">Najprostszym sposobem odwołania zależnościami usługi Service Bus jest zainstalowanie usługi Service Bus [pakietu Nuget](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span><span class="sxs-lookup"><span data-stu-id="209bc-131">The easiest way to reference Service Bus dependencies is to install the Service Bus [Nuget package](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span></span> <span data-ttu-id="209bc-132">Można również znaleźć bibliotek usługi Service Bus jako część zestawu Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="209bc-132">You can also find the Service Bus libraries as part of the Azure SDK.</span></span> <span data-ttu-id="209bc-133">Dane pobierane są dostępne pod adresem [strona pobierania zestawu Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="209bc-133">The download is available at the [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span>

### <a name="create-the-topic-and-subscriptions"></a><span data-ttu-id="209bc-134">Tworzenie tematu i subskrypcji</span><span class="sxs-lookup"><span data-stu-id="209bc-134">Create the topic and subscriptions</span></span>
<span data-ttu-id="209bc-135">Operacje zarządzania jednostek obsługi komunikatów (kolejki i publikowania/subskrypcji tematy) są wykonywane za pośrednictwem usługi Service Bus [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasy.</span><span class="sxs-lookup"><span data-stu-id="209bc-135">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via the [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class.</span></span> <span data-ttu-id="209bc-136">Odpowiednie poświadczenia są wymagane w celu utworzenia **NamespaceManager** wystąpienia określonego obszaru nazw.</span><span class="sxs-lookup"><span data-stu-id="209bc-136">Appropriate credentials are required in order to create a **NamespaceManager** instance for a particular namespace.</span></span> <span data-ttu-id="209bc-137">Usługa Service Bus używa [dostępu sygnatury dostępu Współdzielonego](service-bus-sas.md) na podstawie modelu zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="209bc-137">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="209bc-138">[TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) klasa reprezentuje dostawcę tokenu zabezpieczającego z wbudowanymi metodami factory zwracanie niektórych dobrze znanych dostawców tokenu.</span><span class="sxs-lookup"><span data-stu-id="209bc-138">The [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="209bc-139">Użyjemy [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) metody do przechowywania poświadczeń sygnatury dostępu Współdzielonego.</span><span class="sxs-lookup"><span data-stu-id="209bc-139">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method to hold the SAS credentials.</span></span> <span data-ttu-id="209bc-140">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) wystąpienia następnie jest tworzony z adresu podstawowego przestrzeni nazw usługi Service Bus oraz dostawcy tokenu.</span><span class="sxs-lookup"><span data-stu-id="209bc-140">The [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance is then constructed with the base address of the Service Bus namespace and the token provider.</span></span>

<span data-ttu-id="209bc-141">[NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasa dostarcza metody do tworzenia, wyliczania i usuwania jednostek obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="209bc-141">The [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class provides methods to create, enumerate and delete messaging entities.</span></span> <span data-ttu-id="209bc-142">Kod, który jest wyświetlany w tym miejscu przedstawiono sposób **NamespaceManager** wystąpienia są tworzone i używane do tworzenia **DataCollectionTopic** tematu.</span><span class="sxs-lookup"><span data-stu-id="209bc-142">The code that is shown here shows how the **NamespaceManager** instance is created and used to create the **DataCollectionTopic** topic.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = new NamespaceManager(uri, tokenProvider);

namespaceManager.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="209bc-143">Należy pamiętać, że istnieją overloads z [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) metody umożliwiające ustawienie właściwości tematu.</span><span class="sxs-lookup"><span data-stu-id="209bc-143">Note that there are overloads of the [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method that enable you to set properties of the topic.</span></span> <span data-ttu-id="209bc-144">Na przykład można ustawić czas wygaśnięcia (TTL) wartością domyślną dla komunikatów wysyłanych do tematu.</span><span class="sxs-lookup"><span data-stu-id="209bc-144">For example, you can set the default time-to-live (TTL) value for messages sent to the topic.</span></span> <span data-ttu-id="209bc-145">Następnie dodaj **spisu** i **pulpitu nawigacyjnego** subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-145">Next, add the **Inventory** and **Dashboard** subscriptions.</span></span>

```csharp
namespaceManager.CreateSubscription("DataCollectionTopic", "Inventory");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard");
```

### <a name="send-messages-to-the-topic"></a><span data-ttu-id="209bc-146">Wysyłanie komunikatów do tematu</span><span class="sxs-lookup"><span data-stu-id="209bc-146">Send messages to the topic</span></span>
<span data-ttu-id="209bc-147">Dla czasu wykonywania operacji na jednostek usługi Service Bus; na przykład wysyłanie i odbieranie wiadomości, aplikacja musi najpierw utworzyć [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) obiektu.</span><span class="sxs-lookup"><span data-stu-id="209bc-147">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span></span> <span data-ttu-id="209bc-148">Podobnie jak [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) klasy **MessagingFactory** wystąpienia jest tworzona na podstawie adresu podstawowego przestrzeni nazw usługi i dostawcy tokenu.</span><span class="sxs-lookup"><span data-stu-id="209bc-148">Similar to the [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, the **MessagingFactory** instance is created from the base address of the service namespace and the token provider.</span></span>

```
MessagingFactory factory = MessagingFactory.Create(uri, tokenProvider);
```

<span data-ttu-id="209bc-149">Komunikaty wysyłane do i odebrane od tematów usługi Service Bus są wystąpieniami klasy [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) klasy.</span><span class="sxs-lookup"><span data-stu-id="209bc-149">Messages sent to and received from Service Bus topics, are instances of the [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="209bc-150">Ta klasa zawiera zestaw właściwości standardowych (takich jak [etykiety](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) i [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), słownik, który jest używany do przechowywania aplikacji właściwości oraz treść dowolnych danych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="209bc-150">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used to hold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="209bc-151">Aplikacja możne ustawić treść przez przekazanie dowolnego obiektu podlegającego serializacji (poniższy przykład przekazuje w **SalesData** obiekt, który reprezentuje dane o sprzedaży z POS terminal), co oznacza użycie [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) do serializacji obiektu.</span><span class="sxs-lookup"><span data-stu-id="209bc-151">An application can set the body by passing in any serializable object (the following example passes in a **SalesData** object that represents the sales data from the POS terminal), which will use the [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) to serialize the object.</span></span> <span data-ttu-id="209bc-152">Alternatywnie [strumienia](https://msdn.microsoft.com/library/system.io.stream.aspx) można podać obiektu.</span><span class="sxs-lookup"><span data-stu-id="209bc-152">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

```csharp
BrokeredMessage bm = new BrokeredMessage(salesData);
bm.Label = "SalesReport";
bm.Properties["StoreName"] = "Redmond";
bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="209bc-153">Najprostszym sposobem wysyłania komunikatów do tematu jest użycie [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) utworzyć [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) obiekt bezpośrednio z [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) wystąpienie:</span><span class="sxs-lookup"><span data-stu-id="209bc-153">The easiest way to send messages to the topic is to use [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) to create a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from the [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance:</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionTopic");
sender.Send(bm);
```

### <a name="receive-messages-from-a-subscription"></a><span data-ttu-id="209bc-154">Odbieranie komunikatów z subskrypcji</span><span class="sxs-lookup"><span data-stu-id="209bc-154">Receive messages from a subscription</span></span>
<span data-ttu-id="209bc-155">Podobnie jak przy użyciu kolejki, do odbierania wiadomości z subskrypcji, można użyć [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) obiektów, które można tworzyć bezpośrednio z [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) przy użyciu [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="209bc-155">Similar to using queues, to receive messages from a subscription you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from the [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="209bc-156">Można użyć jednej z dwóch różnych trybów odbierać (**ReceiveAndDelete** i **PeekLock**), zgodnie z opisem w [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="209bc-156">You can use one of the two different receive modes (**ReceiveAndDelete** and **PeekLock**), as discussed in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span>

<span data-ttu-id="209bc-157">Należy pamiętać, że podczas tworzenia **MessageReceiver** subskrypcji, *entityPath* parametr ma postać `topicPath/subscriptions/subscriptionName`.</span><span class="sxs-lookup"><span data-stu-id="209bc-157">Note that when you create a **MessageReceiver** for subscriptions, the *entityPath* parameter is of the form `topicPath/subscriptions/subscriptionName`.</span></span> <span data-ttu-id="209bc-158">W związku z tym aby utworzyć **MessageReceiver** dla **spisu** subskrypcji **DataCollectionTopic** tematu, *entityPath* musi mieć ustawioną `DataCollectionTopic/subscriptions/Inventory`.</span><span class="sxs-lookup"><span data-stu-id="209bc-158">Therefore, to create a **MessageReceiver** for the **Inventory** subscription of the **DataCollectionTopic** topic, *entityPath* must be set to `DataCollectionTopic/subscriptions/Inventory`.</span></span> <span data-ttu-id="209bc-159">Kod wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="209bc-159">The code appears as follows:</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionTopic/subscriptions/Inventory");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

## <a name="subscription-filters"></a><span data-ttu-id="209bc-160">Filtry subskrypcji</span><span class="sxs-lookup"><span data-stu-id="209bc-160">Subscription filters</span></span>
<span data-ttu-id="209bc-161">Do tej pory w tym scenariuszu wszystkich wiadomości wysłanych do tematu są udostępniane dla wszystkich zarejestrowanych subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-161">So far, in this scenario all messages sent to the topic are made available to all registered subscriptions.</span></span> <span data-ttu-id="209bc-162">Tutaj klucza frazy "udostępniono."</span><span class="sxs-lookup"><span data-stu-id="209bc-162">The key phrase here is "made available."</span></span> <span data-ttu-id="209bc-163">Natomiast subskrypcje usługi Service Bus, zobacz wszystkich wiadomości wysłanych do tematu, możesz skopiować tylko podzbiór tych wiadomości do kolejki subskrypcji wirtualnego.</span><span class="sxs-lookup"><span data-stu-id="209bc-163">While Service Bus subscriptions see all messages sent to the topic, you can copy only a subset of those messages to the virtual subscription queue.</span></span> <span data-ttu-id="209bc-164">To jest wykonywane przy użyciu subskrypcji *filtry*.</span><span class="sxs-lookup"><span data-stu-id="209bc-164">This is performed using subscription *filters*.</span></span> <span data-ttu-id="209bc-165">Podczas tworzenia subskrypcji, możesz podać wyrażenie filtru w formularzu predykatu styl SQL92 działającą za pośrednictwem właściwości wiadomości, właściwości systemu (na przykład [etykiety](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) i właściwości aplikacji, takich jak **StoreName** w poprzednim przykładzie.</span><span class="sxs-lookup"><span data-stu-id="209bc-165">When you create a subscription, you can supply a filter expression in the form of a SQL92 style predicate that operates over the properties of the message, both the system properties (for example, [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) and the application properties, such as **StoreName** in the previous example.</span></span>

<span data-ttu-id="209bc-166">Rozwijają scenariusza ilustrację, drugi magazynu jest mają zostać dodane do naszych scenariusz sprzedaży detalicznej.</span><span class="sxs-lookup"><span data-stu-id="209bc-166">Evolving the scenario to illustrate this, a second store is to be added to our retail scenario.</span></span> <span data-ttu-id="209bc-167">Jeszcze przesłana do systemu zarządzania spisem scentralizowane sprzedaży danych ze wszystkich terminali w punkcie sprzedaży z obu sklepów, ale Menedżera magazynu przy użyciu narzędzia Pulpit nawigacyjny jest tylko zainteresowane w wykonywaniu tego magazynu.</span><span class="sxs-lookup"><span data-stu-id="209bc-167">Sales data from all of the POS terminals from both stores still have to be routed to the centralized inventory management system, but a store manager using the dashboard tool is only interested in the performance of that store.</span></span> <span data-ttu-id="209bc-168">Możesz użyć filtrowania można to osiągnąć subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-168">You can use subscription filtering to achieve this.</span></span> <span data-ttu-id="209bc-169">Należy pamiętać, że Terminale POS publikowania wiadomości, ustawione **StoreName** właściwości aplikacji w komunikacie.</span><span class="sxs-lookup"><span data-stu-id="209bc-169">Note that when the POS terminals publish messages, they set the **StoreName** application property on the message.</span></span> <span data-ttu-id="209bc-170">Podane dwóch magazynów, na przykład **Redmond** i **Seattle**, Terminale POS w magazynie Redmond oznaczania ich wiadomości danych sprzedaży z **StoreName** równa **Redmond**, podczas gdy Seattle przechowywania Użyj Terminale POS **StoreName** równa **Seattle**.</span><span class="sxs-lookup"><span data-stu-id="209bc-170">Given two stores, for example **Redmond** and **Seattle**, the POS terminals in the Redmond store stamp their sales data messages with a **StoreName** equal to **Redmond**, whereas the Seattle store POS terminals use a **StoreName** equal to **Seattle**.</span></span> <span data-ttu-id="209bc-171">Menedżer magazynu magazynu Redmond tylko chce wyświetlać dane z terminali w punkcie sprzedaży.</span><span class="sxs-lookup"><span data-stu-id="209bc-171">The store manager of the Redmond store only wants to see data from its POS terminals.</span></span> <span data-ttu-id="209bc-172">System wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="209bc-172">The system appears as follows:</span></span>

![Usługa Bus4](./media/service-bus-create-topics-subscriptions/IC657167.gif)

<span data-ttu-id="209bc-174">Aby skonfigurować ten routingu, należy utworzyć **pulpitu nawigacyjnego** subskrypcji w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="209bc-174">To set up this routing, you create the **Dashboard** subscription as follows:</span></span>

```csharp
SqlFilter dashboardFilter = new SqlFilter("StoreName = 'Redmond'");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard", dashboardFilter);
```

<span data-ttu-id="209bc-175">Z tym [filtr subskrypcji](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), tylko komunikaty, które mają **StoreName** ustawioną właściwość **Redmond** zostaną skopiowane do wirtualnej kolejki w celu **pulpitu nawigacyjnego** subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-175">With this [subscription filter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), only messages that have the **StoreName** property set to **Redmond** will be copied to the virtual queue for the **Dashboard** subscription.</span></span> <span data-ttu-id="209bc-176">Istnieje wiele więcej filtrowanie subskrypcji, jednak.</span><span class="sxs-lookup"><span data-stu-id="209bc-176">There is much more to subscription filtering, however.</span></span> <span data-ttu-id="209bc-177">Aplikacje mogą mieć wiele reguł filtrowania dla subskrypcji Oprócz uprawnienia do modyfikowania właściwości komunikatu zgodnie z przekazaniem do wirtualnej kolejki subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="209bc-177">Applications can have multiple filter rules per subscription in addition to the ability to modify the properties of a message as it passes to a subscription's virtual queue.</span></span>

## <a name="summary"></a><span data-ttu-id="209bc-178">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="209bc-178">Summary</span></span>
<span data-ttu-id="209bc-179">Wszystkie powody do korzystania z usługi kolejkowania wiadomości opisanego w [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md) mają zastosowanie również do tematów, w szczególności:</span><span class="sxs-lookup"><span data-stu-id="209bc-179">All of the reasons to use queuing described in [Create applications that use Service Bus queues](service-bus-create-queues.md) also apply to topics, specifically:</span></span>

* <span data-ttu-id="209bc-180">Oddzielenia czasowego — komunikatów, producenci i konsumenci nie trzeba być w trybie online w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="209bc-180">Temporal decoupling – message producers and consumers do not have to be online at the same time.</span></span>
* <span data-ttu-id="209bc-181">Wyrównywanie obciążenia — szczytów obciążenia są wygładzania w temacie Włączanie aplikacji odbiorczych może udostępnić średni obciążenia zamiast obciążenia szczytowego.</span><span class="sxs-lookup"><span data-stu-id="209bc-181">Load leveling – peaks in load are smoothed out by the topic enabling consuming applications to be provisioned for average load instead of peak load.</span></span>
* <span data-ttu-id="209bc-182">Równoważenie obciążenia — podobnie jak kolejka, może mieć na wielu konkurujących konsumentów nasłuchiwania na jedną subskrypcją, w każdej wiadomości przekazane do tylko jednej konsumentów, a tym samym równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="209bc-182">Load balancing – similar to a queue, you can have multiple competing consumers listening on a single subscription, with each message handed off to only one of the consumers, thereby balancing load.</span></span>
* <span data-ttu-id="209bc-183">Luźne powiązanie — komunikacji sieciowej można rozwijać, bez wywierania wpływu na istniejące punkty końcowe; na przykład dodawania subskrypcji lub zmiana filtrów do tematu, aby umożliwić nowych klientów.</span><span class="sxs-lookup"><span data-stu-id="209bc-183">Loose coupling – you can evolve the messaging network without affecting existing endpoints; for example, adding subscriptions or changing filters to a topic to allow for new consumers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="209bc-184">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="209bc-184">Next steps</span></span>

<span data-ttu-id="209bc-185">Zobacz [tworzenie aplikacji korzystających z kolejek usługi Service Bus](service-bus-create-queues.md) informacji o tym, jak używać kolejek w scenariuszu retail POS.</span><span class="sxs-lookup"><span data-stu-id="209bc-185">See [Create applications that use Service Bus queues](service-bus-create-queues.md) for information about how to use queues in the POS retail scenario.</span></span>

