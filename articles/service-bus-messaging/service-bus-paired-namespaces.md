---
title: "Przestrzenie nazw łączyć usługi Azure Service Bus | Dokumentacja firmy Microsoft"
description: "Szczegóły implementacji par nazw i kosztów"
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 2440c8d3-ed2e-47e0-93cf-ab7fbb855d2e
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/25/2017
ms.author: sethm
ms.openlocfilehash: a200ea7937b9f5296c743928a9408897adfba428
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="paired-namespace-implementation-details-and-cost-implications"></a><span data-ttu-id="299a0-103">Skojarzone szczegóły implementacji przestrzeni nazw i kosztów efekty</span><span class="sxs-lookup"><span data-stu-id="299a0-103">Paired namespace implementation details and cost implications</span></span>
<span data-ttu-id="299a0-104">[PairNamespaceAsync] [ PairNamespaceAsync] — metoda, za pomocą [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] wystąpienia, wykonuje zadania widoczne w Twoim imieniu.</span><span class="sxs-lookup"><span data-stu-id="299a0-104">The [PairNamespaceAsync][PairNamespaceAsync] method, using a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance, performs visible tasks on your behalf.</span></span> <span data-ttu-id="299a0-105">Ponieważ są koszt zagadnienia, podczas korzystania z funkcji, takiemu grupowaniu można sprawdzić te zadania, tak aby oczekiwać zachowanie, gdy nastąpi.</span><span class="sxs-lookup"><span data-stu-id="299a0-105">Because there are cost considerations when using the feature, it is useful to understand those tasks so that you expect the behavior when it happens.</span></span> <span data-ttu-id="299a0-106">Interfejs API angażujący następujące automatyczne działanie w imieniu użytkownika:</span><span class="sxs-lookup"><span data-stu-id="299a0-106">The API engages the following automatic behavior on your behalf:</span></span>

* <span data-ttu-id="299a0-107">Tworzenie zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-107">Creation of backlog queues.</span></span>
* <span data-ttu-id="299a0-108">Tworzenie [MessageSender] [ MessageSender] obiekt, który komunikuje się z kolejki i tematy.</span><span class="sxs-lookup"><span data-stu-id="299a0-108">Creation of a [MessageSender][MessageSender] object that talks to queues or topics.</span></span>
* <span data-ttu-id="299a0-109">Gdy jednostka obsługi komunikatów staje się niedostępny, wysyła polecenie ping wiadomości do jednostki w celu Wykryj, kiedy jednostkę znowu dostępne.</span><span class="sxs-lookup"><span data-stu-id="299a0-109">When a messaging entity becomes unavailable, sends ping messages to the entity in an attempt to detect when that entity becomes available again.</span></span>
* <span data-ttu-id="299a0-110">Opcjonalnie tworzy zestawu pomp"komunikat" który przenosić wiadomości z kolejki zaległości do kolejki głównej.</span><span class="sxs-lookup"><span data-stu-id="299a0-110">Optionally creates of a set of “message pumps” that move messages from the backlog queues to the primary queues.</span></span>
* <span data-ttu-id="299a0-111">Współrzędne zamknięcia/powodujący błąd podstawowych i pomocniczych [MessagingFactory] [ MessagingFactory] wystąpień.</span><span class="sxs-lookup"><span data-stu-id="299a0-111">Coordinates closing/faulting of the primary and secondary [MessagingFactory][MessagingFactory] instances.</span></span>

<span data-ttu-id="299a0-112">Na wysokim poziomie, ta funkcja działa w następujący sposób: podczas podstawowej jednostki jest w dobrej kondycji, nie zmiany sposobu działania są wykonywane.</span><span class="sxs-lookup"><span data-stu-id="299a0-112">At a high level, the feature works as follows: when the primary entity is healthy, no behavior changes occur.</span></span> <span data-ttu-id="299a0-113">Gdy [FailoverInterval] [ FailoverInterval] upłynie czas trwania, a nie powiodło się widzi podstawowej jednostki wysyła po z systemem innym niż przejściowy [MessagingException] [ MessagingException] lub [TimeoutException][TimeoutException], spowoduje następujące zachowanie:</span><span class="sxs-lookup"><span data-stu-id="299a0-113">When the [FailoverInterval][FailoverInterval] duration elapses, and the primary entity sees no successful sends after a non-transient [MessagingException][MessagingException] or a [TimeoutException][TimeoutException], the following behavior occurs:</span></span>

1. <span data-ttu-id="299a0-114">Wyślij operacji do podstawowej jednostki są wyłączone i systemu wysyła pakiet usługi ping podstawowej jednostki aż pomyślnie dostarczony polecenia ping.</span><span class="sxs-lookup"><span data-stu-id="299a0-114">Send operations to the primary entity are disabled and the system pings the primary entity until pings can be successfully delivered.</span></span>
2. <span data-ttu-id="299a0-115">Wybrano losowe zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-115">A random backlog queue is selected.</span></span>
3. <span data-ttu-id="299a0-116">[BrokeredMessage] [ BrokeredMessage] obiekty są kierowane do wybranego zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-116">[BrokeredMessage][BrokeredMessage] objects are routed to the chosen backlog queue.</span></span>
4. <span data-ttu-id="299a0-117">W przypadku niepowodzenia operacji wysyłania do kolejki zaległości wybrany tej kolejki są pobierane z obrót i Nowa kolejka jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="299a0-117">If a send operation to the chosen backlog queue fails, that queue is pulled from the rotation and a new queue is selected.</span></span> <span data-ttu-id="299a0-118">Wszystkich nadawców na [MessagingFactory] [ MessagingFactory] wystąpienia Dowiedz się więcej o awarii.</span><span class="sxs-lookup"><span data-stu-id="299a0-118">All senders on the [MessagingFactory][MessagingFactory] instance learn of the failure.</span></span>

<span data-ttu-id="299a0-119">Poniższe rysunki przedstawiać sekwencję.</span><span class="sxs-lookup"><span data-stu-id="299a0-119">The following figures depict the sequence.</span></span> <span data-ttu-id="299a0-120">Nadawca wysyła najpierw wiadomości.</span><span class="sxs-lookup"><span data-stu-id="299a0-120">First, the sender sends messages.</span></span>

![Sparowanego przestrzenie nazw][0]

<span data-ttu-id="299a0-122">W przypadku awarii do wysyłania do kolejki głównej nadawca zaczyna wysyła wiadomości do kolejki zaległości losowo wybrany.</span><span class="sxs-lookup"><span data-stu-id="299a0-122">Upon failure to send to the primary queue, the sender begins sending messages to a randomly chosen backlog queue.</span></span> <span data-ttu-id="299a0-123">Rozpoczyna się jednocześnie, zadanie ping.</span><span class="sxs-lookup"><span data-stu-id="299a0-123">Simultaneously, it starts a ping task.</span></span>

![Sparowanego przestrzenie nazw][1]

<span data-ttu-id="299a0-125">W tym momencie komunikaty są nadal w kolejce dodatkowej i nie zostały dostarczone do kolejki głównej.</span><span class="sxs-lookup"><span data-stu-id="299a0-125">At this point the messages are still in the secondary queue and have not been delivered to the primary queue.</span></span> <span data-ttu-id="299a0-126">Gdy podstawowy kolejki jest w dobrej kondycji ponownie, co najmniej jeden proces powinna być uruchomiona syphon.</span><span class="sxs-lookup"><span data-stu-id="299a0-126">Once the primary queue is healthy again, at least one process should be running the syphon.</span></span> <span data-ttu-id="299a0-127">Syphon dostarcza komunikaty z różnych kolejek zaległości na jednostki właściwe miejsce docelowe (kolejki i tematy).</span><span class="sxs-lookup"><span data-stu-id="299a0-127">The syphon delivers the messages from all the various backlog queues to the proper destination entities (queues and topics).</span></span>

![Sparowanego przestrzenie nazw][2]

<span data-ttu-id="299a0-129">W pozostałej części w tym temacie omówiono konkretne szczegółowe informacje, jak te elementy pracy.</span><span class="sxs-lookup"><span data-stu-id="299a0-129">The remainder of this topic discusses the specific details of how these pieces work.</span></span>

## <a name="creation-of-backlog-queues"></a><span data-ttu-id="299a0-130">Tworzenie zaległości kolejki</span><span class="sxs-lookup"><span data-stu-id="299a0-130">Creation of backlog queues</span></span>
<span data-ttu-id="299a0-131">[SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] obiekt przekazywany do [PairNamespaceAsync] [ PairNamespaceAsync] metody wskazuje liczbę kolejek zaległości, którego chcesz użyć.</span><span class="sxs-lookup"><span data-stu-id="299a0-131">The [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] object passed to the [PairNamespaceAsync][PairNamespaceAsync] method indicates the number of backlog queues you want to use.</span></span> <span data-ttu-id="299a0-132">Każdej kolejki zaległości zostanie utworzona z następującymi właściwościami jawnie ustaw (wszystkie inne wartości są ustawiane na [QueueDescription] [ QueueDescription] ustawień domyślnych):</span><span class="sxs-lookup"><span data-stu-id="299a0-132">Each backlog queue is then created with the following properties explicitly set (all other values are set to the [QueueDescription][QueueDescription] defaults):</span></span>

| <span data-ttu-id="299a0-133">Ścieżka</span><span class="sxs-lookup"><span data-stu-id="299a0-133">Path</span></span> | <span data-ttu-id="299a0-134">[głównej przestrzeni nazw] / x magistrali usług transferu / [Indeks] [Indeks] w przypadku wartości [0, BacklogQueueCount)</span><span class="sxs-lookup"><span data-stu-id="299a0-134">[primary namespace]/x-servicebus-transfer/[index] where [index] is a value in [0, BacklogQueueCount)</span></span> |
| --- | --- |
| <span data-ttu-id="299a0-135">MaxSizeInMegabytes</span><span class="sxs-lookup"><span data-stu-id="299a0-135">MaxSizeInMegabytes</span></span> |<span data-ttu-id="299a0-136">5120</span><span class="sxs-lookup"><span data-stu-id="299a0-136">5120</span></span> |
| <span data-ttu-id="299a0-137">maxDeliveryCount</span><span class="sxs-lookup"><span data-stu-id="299a0-137">MaxDeliveryCount</span></span> |<span data-ttu-id="299a0-138">int. MaxValue</span><span class="sxs-lookup"><span data-stu-id="299a0-138">int.MaxValue</span></span> |
| <span data-ttu-id="299a0-139">DefaultMessageTimeToLive</span><span class="sxs-lookup"><span data-stu-id="299a0-139">DefaultMessageTimeToLive</span></span> |<span data-ttu-id="299a0-140">Wartość TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="299a0-140">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="299a0-141">AutoDeleteOnIdle</span><span class="sxs-lookup"><span data-stu-id="299a0-141">AutoDeleteOnIdle</span></span> |<span data-ttu-id="299a0-142">Wartość TimeSpan.MaxValue</span><span class="sxs-lookup"><span data-stu-id="299a0-142">TimeSpan.MaxValue</span></span> |
| <span data-ttu-id="299a0-143">LockDuration</span><span class="sxs-lookup"><span data-stu-id="299a0-143">LockDuration</span></span> |<span data-ttu-id="299a0-144">1 minuta</span><span class="sxs-lookup"><span data-stu-id="299a0-144">1 minute</span></span> |
| <span data-ttu-id="299a0-145">EnableDeadLetteringOnMessageExpiration</span><span class="sxs-lookup"><span data-stu-id="299a0-145">EnableDeadLetteringOnMessageExpiration</span></span> |<span data-ttu-id="299a0-146">Wartość true</span><span class="sxs-lookup"><span data-stu-id="299a0-146">true</span></span> |
| <span data-ttu-id="299a0-147">EnableBatchedOperations</span><span class="sxs-lookup"><span data-stu-id="299a0-147">EnableBatchedOperations</span></span> |<span data-ttu-id="299a0-148">Wartość true</span><span class="sxs-lookup"><span data-stu-id="299a0-148">true</span></span> |

<span data-ttu-id="299a0-149">Na przykład utworzyć pierwszy kolejki zaległości dla przestrzeni nazw **contoso** nosi nazwę `contoso/x-servicebus-transfer/0`.</span><span class="sxs-lookup"><span data-stu-id="299a0-149">For example, the first backlog queue created for namespace **contoso** is named `contoso/x-servicebus-transfer/0`.</span></span>

<span data-ttu-id="299a0-150">Podczas tworzenia kolejki, kod najpierw sprawdza, czy istnieje takiej kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-150">When creating the queues, the code first checks to see if such a queue exists.</span></span> <span data-ttu-id="299a0-151">Jeśli kolejka nie istnieje, trwa tworzenie kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-151">If the queue does not exist, then the queue is created.</span></span> <span data-ttu-id="299a0-152">Ten kod nie oczyszczania "dodatkowe" zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-152">The code does not clean up "extra" backlog queues.</span></span> <span data-ttu-id="299a0-153">W szczególności jeśli aplikacji głównej przestrzeni nazw **contoso** żądań w pięciu kolejkach zaległości, ale zaległości kolejki ze ścieżką `contoso/x-servicebus-transfer/7` istnieje, jest nadal znajdują się dodatkowe zaległości kolejki, ale nie są używane.</span><span class="sxs-lookup"><span data-stu-id="299a0-153">Specifically, if the application with the primary namespace **contoso** requests five backlog queues but a backlog queue with the path `contoso/x-servicebus-transfer/7` exists, that extra backlog queue is still present but is not used.</span></span> <span data-ttu-id="299a0-154">System zezwala jawnie kolejek zaległości dodatkowe mogą znajdować się, których nie można użyć.</span><span class="sxs-lookup"><span data-stu-id="299a0-154">The system explicitly allows extra backlog queues to exist that would not be used.</span></span> <span data-ttu-id="299a0-155">Jako właściciel przestrzeni nazw jest odpowiedzialny za czyszczenie wszystkie nieużywane/niechciane zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-155">As the namespace owner, you are responsible for cleaning up any unused/unwanted backlog queues.</span></span> <span data-ttu-id="299a0-156">Przyczyną tej decyzji jest magistrali usług nie wiadomo, jakich celów istnieje dla wszystkich kolejek w przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="299a0-156">The reason for this decision is that Service Bus cannot know what purposes exist for all the queues in your namespace.</span></span> <span data-ttu-id="299a0-157">Ponadto jeśli kolejka o podanej nazwie istnieje, ale nie spełnia zakładanego [QueueDescription][QueueDescription], a następnie z powodów są własne dla zmianę zachowania domyślnego.</span><span class="sxs-lookup"><span data-stu-id="299a0-157">Furthermore, if a queue exists with the given name but does not meet the assumed [QueueDescription][QueueDescription], then your reasons are your own for changing the default behavior.</span></span> <span data-ttu-id="299a0-158">Gwarancje nie są wykonywane dla modyfikacje kolejki zaległości w kodzie.</span><span class="sxs-lookup"><span data-stu-id="299a0-158">No guarantees are made for modifications to the backlog queues by your code.</span></span> <span data-ttu-id="299a0-159">Upewnij się dokładnie przetestować zmiany.</span><span class="sxs-lookup"><span data-stu-id="299a0-159">Make sure to test your changes thoroughly.</span></span>

## <a name="custom-messagesender"></a><span data-ttu-id="299a0-160">Niestandardowe MessageSender</span><span class="sxs-lookup"><span data-stu-id="299a0-160">Custom MessageSender</span></span>
<span data-ttu-id="299a0-161">Podczas wysyłania, wszystkie komunikaty go za pośrednictwem wewnętrznego [MessageSender] [ MessageSender] obiekt, który będzie pracował normalnie, kiedy wszystko działa i przekierowuje do zaległości kolejki podczas czynności "break."</span><span class="sxs-lookup"><span data-stu-id="299a0-161">When sending, all messages go through an internal [MessageSender][MessageSender] object that behaves normally when everything works, and redirects to the backlog queues when things "break."</span></span> <span data-ttu-id="299a0-162">Po odebraniu Błąd przejściowy z systemem innym niż, uruchamia czasomierz.</span><span class="sxs-lookup"><span data-stu-id="299a0-162">Upon receiving a non-transient failure, a timer starts.</span></span> <span data-ttu-id="299a0-163">Po [TimeSpan] [ TimeSpan] okres składające się z [FailoverInterval] [ FailoverInterval] uczestniczy w którym nie powiodło się komunikaty są wysyłane, wartość właściwości pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="299a0-163">After a [TimeSpan][TimeSpan] period consisting of the [FailoverInterval][FailoverInterval] property value during which no successful messages are sent, the failover is engaged.</span></span> <span data-ttu-id="299a0-164">W tym momencie dla każdej jednostki się zdarzyć następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="299a0-164">At this point, the following things happen for each entity:</span></span>

* <span data-ttu-id="299a0-165">Wykonuje zadanie ping co [PingPrimaryInterval] [ PingPrimaryInterval] do sprawdzenia, czy jednostka jest dostępna.</span><span class="sxs-lookup"><span data-stu-id="299a0-165">A ping task executes every [PingPrimaryInterval][PingPrimaryInterval] to check if the entity is available.</span></span> <span data-ttu-id="299a0-166">Po pomyślnym to zadanie, żadnego kodu klienta, który używa jednostki natychmiast rozpoczyna wysyłanie wiadomości do głównej przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="299a0-166">Once this task succeeds, all client code that uses the entity immediately starts sending new messages to the primary namespace.</span></span>
* <span data-ttu-id="299a0-167">Wynikiem będzie przyszłych żądań do wysyłania do tej samej jednostki z innych nadawców [BrokeredMessage] [ BrokeredMessage] wysyłane modyfikacji w celu znajdują się w kolejce zaległości.</span><span class="sxs-lookup"><span data-stu-id="299a0-167">Future requests to send to that same entity from any other senders will result in the [BrokeredMessage][BrokeredMessage] being sent to be modified to sit in the backlog queue.</span></span> <span data-ttu-id="299a0-168">Modyfikacja usuwa niektóre właściwości z [BrokeredMessage] [ BrokeredMessage] obiektu i przechowuje je w innym miejscu.</span><span class="sxs-lookup"><span data-stu-id="299a0-168">The modification removes some properties from the [BrokeredMessage][BrokeredMessage] object and stores them elsewhere.</span></span> <span data-ttu-id="299a0-169">Następujące właściwości są wyczyszczone i dodany w obszarze Nowy alias, dzięki czemu jednolicie przetwarzania komunikatów usługi Service Bus i zestawu SDK:</span><span class="sxs-lookup"><span data-stu-id="299a0-169">The following properties are cleared and added under a new alias, allowing Service Bus and the SDK to process messages uniformly:</span></span>

| <span data-ttu-id="299a0-170">Stara nazwa właściwości</span><span class="sxs-lookup"><span data-stu-id="299a0-170">Old Property Name</span></span> | <span data-ttu-id="299a0-171">Nowa nazwa właściwości</span><span class="sxs-lookup"><span data-stu-id="299a0-171">New Property Name</span></span> |
| --- | --- |
| <span data-ttu-id="299a0-172">Identyfikator sesji</span><span class="sxs-lookup"><span data-stu-id="299a0-172">SessionId</span></span> |<span data-ttu-id="299a0-173">x-ms-sessionid</span><span class="sxs-lookup"><span data-stu-id="299a0-173">x-ms-sessionid</span></span> |
| <span data-ttu-id="299a0-174">TimeToLive</span><span class="sxs-lookup"><span data-stu-id="299a0-174">TimeToLive</span></span> |<span data-ttu-id="299a0-175">x-ms-timetolive</span><span class="sxs-lookup"><span data-stu-id="299a0-175">x-ms-timetolive</span></span> |
| <span data-ttu-id="299a0-176">ScheduledEnqueueTimeUtc</span><span class="sxs-lookup"><span data-stu-id="299a0-176">ScheduledEnqueueTimeUtc</span></span> |<span data-ttu-id="299a0-177">x-ms-path.</span><span class="sxs-lookup"><span data-stu-id="299a0-177">x-ms-path</span></span> |

<span data-ttu-id="299a0-178">Oryginalna ścieżka docelowa jest również przechowywane w wiadomości jako właściwość o nazwie x-ms-path.</span><span class="sxs-lookup"><span data-stu-id="299a0-178">The original destination path is also stored within the message as a property named x-ms-path.</span></span> <span data-ttu-id="299a0-179">Ten projekt umożliwia wiadomości dla wielu obiektów współistnienie w jednym zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-179">This design allows messages for many entities to coexist in a single backlog queue.</span></span> <span data-ttu-id="299a0-180">Właściwości są tłumaczone przez syphon.</span><span class="sxs-lookup"><span data-stu-id="299a0-180">The properties are translated back by the syphon.</span></span>

<span data-ttu-id="299a0-181">Niestandardowa [MessageSender] [ MessageSender] obiektu może wystąpić problemy podczas wiadomości podejścia limit 256 KB i pracy awaryjnej jest włączone.</span><span class="sxs-lookup"><span data-stu-id="299a0-181">The custom [MessageSender][MessageSender] object can encounter issues when messages approach the 256-KB limit and failover is engaged.</span></span> <span data-ttu-id="299a0-182">Niestandardowa [MessageSender] [ MessageSender] obiekt przechowuje komunikaty wszystkich kolejek i tematów w zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-182">The custom [MessageSender][MessageSender] object stores messages for all queues and topics together in the backlog queues.</span></span> <span data-ttu-id="299a0-183">Ten obiekt łączy komunikaty z wielu kolory podstawowe w ramach zaległości kolejki.</span><span class="sxs-lookup"><span data-stu-id="299a0-183">This object mixes messages from many primaries together within the backlog queues.</span></span> <span data-ttu-id="299a0-184">Do obsługi obciążenia zrównoważyć wielu klientów, których nie wiadomo, wzajemnie, zestaw SDK losowo wybiera jeden kolejki zaległości na dla każdego [QueueClient] [ QueueClient] lub [TopicClient] [ TopicClient] tworzenie w kodzie.</span><span class="sxs-lookup"><span data-stu-id="299a0-184">To handle load balancing among many clients that do not know each other, the SDK randomly picks one backlog queue for each [QueueClient][QueueClient] or [TopicClient][TopicClient] you create in code.</span></span>

## <a name="pings"></a><span data-ttu-id="299a0-185">Polecenia ping</span><span class="sxs-lookup"><span data-stu-id="299a0-185">Pings</span></span>
<span data-ttu-id="299a0-186">Wiadomość ping jest pusta [BrokeredMessage] [ BrokeredMessage] z jego [ContentType] [ ContentType] właściwość aplikacji/vnd.ms-magistrali usług ping i [TimeToLive] [ TimeToLive] wartość 1 sekundę.</span><span class="sxs-lookup"><span data-stu-id="299a0-186">A ping message is an empty [BrokeredMessage][BrokeredMessage] with its [ContentType][ContentType] property set to application/vnd.ms-servicebus-ping and a [TimeToLive][TimeToLive] value of 1 second.</span></span> <span data-ttu-id="299a0-187">To polecenie ping ma jeden właściwości specjalne w usłudze Service Bus: serwer nigdy nie dostarcza polecenia ping, gdy zażąda każdego obiektu wywołującego [BrokeredMessage][BrokeredMessage].</span><span class="sxs-lookup"><span data-stu-id="299a0-187">This ping has one special characteristic in Service Bus: the server never delivers a ping when any caller requests a [BrokeredMessage][BrokeredMessage].</span></span> <span data-ttu-id="299a0-188">W związku z tym nie trzeba Dowiedz się, jak otrzymywać i ignorować te komunikaty.</span><span class="sxs-lookup"><span data-stu-id="299a0-188">Thus, you never have to learn how to receive and ignore these messages.</span></span> <span data-ttu-id="299a0-189">Każdy obiekt (unikatowe kolejka lub temat) na [MessagingFactory] [ MessagingFactory] wystąpienia na klienta będzie można wykonywać polecenia ping, gdy są one uznawane za jako niedostępny.</span><span class="sxs-lookup"><span data-stu-id="299a0-189">Each entity (unique queue or topic) per [MessagingFactory][MessagingFactory] instance per client will be pinged when they are considered to be unavailable.</span></span> <span data-ttu-id="299a0-190">Domyślnie to odbywa się raz na minutę.</span><span class="sxs-lookup"><span data-stu-id="299a0-190">By default, this happens once per minute.</span></span> <span data-ttu-id="299a0-191">Komunikaty ping są traktowane jako prawidłowe komunikatów usługi Service Bus i może spowodować opłaty za przepustowości i wiadomości.</span><span class="sxs-lookup"><span data-stu-id="299a0-191">Ping messages are considered to be regular Service Bus messages, and can result in charges for bandwidth and messages.</span></span> <span data-ttu-id="299a0-192">Jak klienci wykrywają, że system będzie dostępny, Zatrzymaj wiadomości.</span><span class="sxs-lookup"><span data-stu-id="299a0-192">As soon as the clients detect that the system is available, the messages stop.</span></span>

## <a name="the-syphon"></a><span data-ttu-id="299a0-193">Syphon</span><span class="sxs-lookup"><span data-stu-id="299a0-193">The syphon</span></span>
<span data-ttu-id="299a0-194">Co najmniej jeden program wykonywalny w aplikacji aktywnie powinna działać syphon.</span><span class="sxs-lookup"><span data-stu-id="299a0-194">At least one executable program in the application should be actively running the syphon.</span></span> <span data-ttu-id="299a0-195">Syphon wykonuje długi sondowania odbierania, które to 15 minut.</span><span class="sxs-lookup"><span data-stu-id="299a0-195">The syphon performs a long poll receive that lasts 15 minutes.</span></span> <span data-ttu-id="299a0-196">Gdy wszystkie obiekty są dostępne i masz 10 zaległości kolejki, aplikacji, która obsługuje syphon wywołania operacji odbierania 40 razy na godzinę, 960 razy dziennie i 28800 razy w ciągu 30 dni.</span><span class="sxs-lookup"><span data-stu-id="299a0-196">When all entities are available and you have 10 backlog queues, the application that hosts the syphon calls the receive operation 40 times per hour, 960 times per day, and 28800 times in 30 days.</span></span> <span data-ttu-id="299a0-197">Przemieszczając się syphon jest aktywnie komunikatów z zaległości do kolejki głównej, każdy komunikat napotyka następujące opłaty (standardowe opłaty za rozmiaru wiadomości i przepustowości dotyczy wszystkich etapach):</span><span class="sxs-lookup"><span data-stu-id="299a0-197">When the syphon is actively moving messages from the backlog to the primary queue, each message experiences the following charges (standard charges for message size and bandwidth apply in all stages):</span></span>

1. <span data-ttu-id="299a0-198">Wyślij do listy prac.</span><span class="sxs-lookup"><span data-stu-id="299a0-198">Send to the backlog.</span></span>
2. <span data-ttu-id="299a0-199">Otrzymywać zaległości.</span><span class="sxs-lookup"><span data-stu-id="299a0-199">Receive from the backlog.</span></span>
3. <span data-ttu-id="299a0-200">Wyślij do serwera podstawowego.</span><span class="sxs-lookup"><span data-stu-id="299a0-200">Send to the primary.</span></span>
4. <span data-ttu-id="299a0-201">Odbieranie z serwera podstawowego.</span><span class="sxs-lookup"><span data-stu-id="299a0-201">Receive from the primary.</span></span>

## <a name="closefault-behavior"></a><span data-ttu-id="299a0-202">Zamknij/błędów zachowanie</span><span class="sxs-lookup"><span data-stu-id="299a0-202">Close/fault behavior</span></span>
<span data-ttu-id="299a0-203">W aplikacji, która obsługuje syphon, raz podstawowej lub pomocniczej [MessagingFactory] [ MessagingFactory] błędów lub zamknięciu bez partnera również jest błędny zamknięte, a syphon wykrywa ten stan działania syphon.</span><span class="sxs-lookup"><span data-stu-id="299a0-203">Within an application that hosts the syphon, once the primary or secondary [MessagingFactory][MessagingFactory] faults or is closed without its partner also being faulted/closed and the syphon detects this state, the syphon acts.</span></span> <span data-ttu-id="299a0-204">Jeśli drugiej [MessagingFactory] [ MessagingFactory] nie są zamknięte w ciągu 5 sekund syphon będzie fault nadal Otwórz [MessagingFactory][MessagingFactory].</span><span class="sxs-lookup"><span data-stu-id="299a0-204">If the other [MessagingFactory][MessagingFactory] is not closed within 5 seconds, the syphon will fault the still open [MessagingFactory][MessagingFactory].</span></span>

## <a name="next-steps"></a><span data-ttu-id="299a0-205">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="299a0-205">Next steps</span></span>
<span data-ttu-id="299a0-206">Zobacz [asynchroniczne wzorce i wysokiej dostępności do obsługi komunikatów] [ Asynchronous messaging patterns and high availability] szczegółowe omówienie asynchroniczne komunikatów usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="299a0-206">See [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability] for a detailed discussion of Service Bus asynchronous messaging.</span></span> 

[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[MessageSender]: /dotnet/api/microsoft.servicebus.messaging.messagesender
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[FailoverInterval]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions#Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_FailoverInterval
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[TimeoutException]: https://msdn.microsoft.com/library/azure/system.timeoutexception.aspx
[BrokeredMessage]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage
[QueueDescription]: /dotnet/api/microsoft.servicebus.messaging.queuedescription
[TimeSpan]: https://msdn.microsoft.com/library/azure/system.timespan.aspx
[PingPrimaryInterval]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_PingPrimaryInterval
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[ContentType]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_ContentType
[TimeToLive]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md
[0]: ./media/service-bus-paired-namespaces/IC673405.png
[1]: ./media/service-bus-paired-namespaces/IC673406.png
[2]: ./media/service-bus-paired-namespaces/IC673407.png
