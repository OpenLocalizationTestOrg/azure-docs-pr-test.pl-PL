---
title: "Automatyczne skalowanie obliczeniowe węzłów w puli partii zadań Azure | Dokumentacja firmy Microsoft"
description: "Włącz automatyczne skalowanie w puli chmury można dynamicznie zmieniać liczbę węzłów obliczeniowych w puli."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: f0e49cd8a64a48c53f5b6104703164a597c797f0
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="4759b-103">Utwórz formułę Skalowanie automatyczne skalowanie węzłów obliczeniowych w puli partii</span><span class="sxs-lookup"><span data-stu-id="4759b-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="4759b-104">Partia zadań Azure może automatycznie skalować puli na podstawie parametrów zdefiniowanych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4759b-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="4759b-105">Automatyczne skalowanie partii dynamicznie dodaje węzły do puli jako wzrost wymagań zadań i usuwa jako zmniejszają węzły obliczeniowe.</span><span class="sxs-lookup"><span data-stu-id="4759b-105">With automatic scaling, Batch dynamically adds nodes to a pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="4759b-106">Automatycznie dostosowując liczba węzłów obliczeniowych używanych przez aplikację partii można zapisać zarówno czas i pieniądze.</span><span class="sxs-lookup"><span data-stu-id="4759b-106">You can save both time and money by automatically adjusting the number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="4759b-107">Możesz włączyć automatyczne skalowanie węzłów obliczeniowych puli można skojarzyć z nim *formułą automatycznego skalowania* zdefiniowana.</span><span class="sxs-lookup"><span data-stu-id="4759b-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="4759b-108">Usługa partia zadań korzysta formułą automatycznego skalowania, aby określić liczbę węzłów obliczeniowych, które są wymagane do wykonania obciążenie.</span><span class="sxs-lookup"><span data-stu-id="4759b-108">The Batch service uses the autoscale formula to determine the number of compute nodes that are needed to execute your workload.</span></span> <span data-ttu-id="4759b-109">Obliczeniowe węzły mogą być dedykowanych węzłów lub [węzłów niskiego priorytetu](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="4759b-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="4759b-110">Wsadowe odpowiada okresowo zbieranych danych metryki usługi.</span><span class="sxs-lookup"><span data-stu-id="4759b-110">Batch responds to service metrics data that is collected periodically.</span></span> <span data-ttu-id="4759b-111">Przy użyciu tych danych metryki, partii dostosowuje liczbę węzłów obliczeniowych w puli na podstawie formuły i interwałem można konfigurować.</span><span class="sxs-lookup"><span data-stu-id="4759b-111">Using this metrics data, Batch adjusts the number of compute nodes in the pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="4759b-112">Można włączyć automatyczne skalowanie, gdy tworzona jest pula lub na istniejącej puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="4759b-113">Można również zmienić istniejącej formuły w puli, która jest skonfigurowana dla Skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="4759b-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="4759b-114">Partii umożliwia ocenę formułach przed przypisywanie ich do pul oraz do monitorowania stanu automatycznego skalowania działa.</span><span class="sxs-lookup"><span data-stu-id="4759b-114">Batch enables you to evaluate your formulas before assigning them to pools and to monitor the status of automatic scaling runs.</span></span>

<span data-ttu-id="4759b-115">W tym artykule omówiono różnymi jednostkami wchodzące w skład formułach skalowania automatycznego, w tym zmienne, operatory, operacje i funkcje.</span><span class="sxs-lookup"><span data-stu-id="4759b-115">This article discusses the various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="4759b-116">Omówiono sposób uzyskiwania różnych obliczeń zasób i zadanie metryk w partii.</span><span class="sxs-lookup"><span data-stu-id="4759b-116">We discuss how to obtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="4759b-117">Te metryki umożliwia dostosowanie liczba węzłów z puli na podstawie stanu zasobu użycia i zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-117">You can use these metrics to adjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="4759b-118">Następnie opisano sposobu konstruowania formuły i Włącz automatyczne skalowanie w puli przy użyciu REST partii i interfejsów API architektury .NET.</span><span class="sxs-lookup"><span data-stu-id="4759b-118">We then describe how to construct a formula and enable automatic scaling on a pool by using both the Batch REST and .NET APIs.</span></span> <span data-ttu-id="4759b-119">Na koniec kończymy z kilku przykład formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4759b-120">Podczas tworzenia konta usługi partia zadań można określić [konfiguracji konta](batch-api-basics.md#account), która określa, czy pule są przydzielane w ramach subskrypcji usługi partii (ustawienie domyślne) lub w ramach subskrypcji użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4759b-120">When you create a Batch account, you can specify the [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (the default), or in your user subscription.</span></span> <span data-ttu-id="4759b-121">Jeśli utworzono konta partii zadań z domyślnej konfiguracji usługi partia zadań Twoje konto jest ograniczona do maksymalna liczba rdzeni, które mogą być używane do przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="4759b-121">If you created your Batch account with the default Batch Service configuration, then your account is limited to a maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="4759b-122">Usługa partia zadań skalowanie węzłów obliczeniowych do tego limitu core.</span><span class="sxs-lookup"><span data-stu-id="4759b-122">The Batch service scales compute nodes only up to that core limit.</span></span> <span data-ttu-id="4759b-123">Z tego powodu usługa partia zadań nie może nawiązać połączenia docelowej liczba węzłów obliczeniowych określony formułą automatycznego skalowania.</span><span class="sxs-lookup"><span data-stu-id="4759b-123">For this reason, the Batch service may not reach the target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="4759b-124">Zobacz [przydziały i limity dla usługi partia zadań Azure](batch-quota-limit.md) informacji na temat przeglądania i zwiększenie przydziały Twojego konta.</span><span class="sxs-lookup"><span data-stu-id="4759b-124">See [Quotas and limits for the Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="4759b-125">Jeśli Twoje konto zostało utworzone przy użyciu konfiguracji subskrypcji użytkownika, Twoje konto udziałów w limit przydziału rdzeni dla subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="4759b-125">If you created your account with the User Subscription configuration, then your account shares in the core quota for the subscription.</span></span> <span data-ttu-id="4759b-126">Aby uzyskać więcej informacji, zobacz sekcję [Virtual Machines limits (Limity maszyn wirtualnych)](../azure-subscription-service-limits.md#virtual-machines-limits) w artykule [Azure subscription and service limits, quotas, and constraints (Ograniczenia, przydziały i limity usług i subskrypcji platformy Azure)](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="4759b-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="4759b-127">Automatyczne skalowanie formuł</span><span class="sxs-lookup"><span data-stu-id="4759b-127">Automatic scaling formulas</span></span>
<span data-ttu-id="4759b-128">Formuła skalowania automatycznego jest wartość ciągu przez Ciebie, która zawiera jedną lub więcej instrukcji.</span><span class="sxs-lookup"><span data-stu-id="4759b-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="4759b-129">Formuła skalowania automatycznego jest przypisany do puli [autoScaleFormula] [ rest_autoscaleformula] elementu (REST partii) lub [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] Właściwość (partiami platformy .NET).</span><span class="sxs-lookup"><span data-stu-id="4759b-129">The autoscale formula is assigned to a pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="4759b-130">Usługa partia zadań używa formułę do określania docelowych liczba węzłów obliczeniowych w puli przy następnym interwale przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="4759b-130">The Batch service uses your formula to determine the target number of compute nodes in the pool for the next interval of processing.</span></span> <span data-ttu-id="4759b-131">Ciąg formuły nie może być dłuższa niż 8 KB, może zawierać maksymalnie 100 instrukcji, które są oddzielone średnikami i może zawierać podziałów wierszy i komentarze.</span><span class="sxs-lookup"><span data-stu-id="4759b-131">The formula string cannot exceed 8 KB, can include up to 100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="4759b-132">Można traktować automatycznego skalowania formuł jako skalowania automatycznego partii "język".</span><span class="sxs-lookup"><span data-stu-id="4759b-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="4759b-133">Instrukcje formuły są wolne sformułowanych wyrażeń zawierających zarówno usługa zdefiniowana zmiennych (zmiennych zdefiniowanych przez usługi partia zadań), jak i zmienne zdefiniowane przez użytkownika (zmiennych zdefiniowanych przez użytkownika).</span><span class="sxs-lookup"><span data-stu-id="4759b-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by the Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="4759b-134">Mogą oni wykonywać różne operacje tych wartości za pomocą wbudowanych typów, Operatorzy i funkcje.</span><span class="sxs-lookup"><span data-stu-id="4759b-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="4759b-135">Na przykład instrukcja może mieć następującą formę:</span><span class="sxs-lookup"><span data-stu-id="4759b-135">For example, a statement might take the following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="4759b-136">Formuły zwykle zawierają wiele instrukcji, które wykonują operacje na wartości, które zostały uzyskane w poprzednim instrukcje.</span><span class="sxs-lookup"><span data-stu-id="4759b-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="4759b-137">Na przykład, najpierw możemy uzyskać wartości `variable1`, następnie przekazać do funkcji, aby wypełnić `variable2`:</span><span class="sxs-lookup"><span data-stu-id="4759b-137">For example, first we obtain a value for `variable1`, then pass it to a function to populate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="4759b-138">Dołącz te instrukcje formuły skalowania automatycznego na docelowym liczba węzłów obliczeniowych.</span><span class="sxs-lookup"><span data-stu-id="4759b-138">Include these statements in your autoscale formula to arrive at a target number of compute nodes.</span></span> <span data-ttu-id="4759b-139">Dedykowanych węzłów, jak i węzły niskiego priorytetu mają własnych ustawień obiektu docelowego, dzięki czemu można zdefiniować docelowy dla każdego typu węzła.</span><span class="sxs-lookup"><span data-stu-id="4759b-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="4759b-140">Formuła automatycznego skalowania może zawierać wartość docelowa dla dedykowanych węzłów i/lub wartość docelowa dla węzłów o niskim priorytecie.</span><span class="sxs-lookup"><span data-stu-id="4759b-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="4759b-141">Docelowy liczba węzłów mogą być wyższe, małe lub taka sama jak bieżąca liczba węzłów tego typu w puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-141">The target number of nodes may be higher, lower, or the same as the current number of nodes of that type in the pool.</span></span> <span data-ttu-id="4759b-142">Wsadowe ocenia formułą automatycznego skalowania puli w określonych odstępach czasu (zobacz [automatyczne skalowanie interwałów](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="4759b-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="4759b-143">Partii dostosowuje liczbę docelowych każdy typ węzła w puli, aby liczba, która określa formułę automatycznego skalowania w chwili szacowania.</span><span class="sxs-lookup"><span data-stu-id="4759b-143">Batch adjusts the target number of each type of node in the pool to the number that your autoscale formula specifies at the time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="4759b-144">Przykładowa formuła skalowania automatycznego</span><span class="sxs-lookup"><span data-stu-id="4759b-144">Sample autoscale formula</span></span>

<span data-ttu-id="4759b-145">Oto przykład formuły skalowania automatycznego, którą można dostosować do pracy w przypadku większości scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="4759b-145">Here is an example of an autoscale formula that can be adjusted to work for most scenarios.</span></span> <span data-ttu-id="4759b-146">Zmienne `startingNumberOfVMs` i `maxNumberofVMs` w przykładzie formuły można dostosować do własnych potrzeb.</span><span class="sxs-lookup"><span data-stu-id="4759b-146">The variables `startingNumberOfVMs` and `maxNumberofVMs` in the example formula can be adjusted to your needs.</span></span> <span data-ttu-id="4759b-147">W tej formule skaluje dedykowanych węzłów, ale można zmodyfikować, aby dotyczą również węzłów niskiego priorytetu skali.</span><span class="sxs-lookup"><span data-stu-id="4759b-147">This formula scales dedicated nodes, but can be modified to apply to scale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="4759b-148">Tą formułą automatycznego skalowania puli został początkowo utworzony z jednej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="4759b-148">With this autoscale formula, the pool is initially created with a single VM.</span></span> <span data-ttu-id="4759b-149">`$PendingTasks` Metryka definiuje liczbę zadań, które są uruchomione lub umieszczonych w kolejce.</span><span class="sxs-lookup"><span data-stu-id="4759b-149">The `$PendingTasks` metric defines the number of tasks that are running or queued.</span></span> <span data-ttu-id="4759b-150">Formuła znajduje średnią liczbę zadań oczekujących w ostatnich 180 sekund i zestawy `$TargetDedicatedNodes` zmiennej odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="4759b-150">The formula finds the average number of pending tasks in the last 180 seconds and sets the `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="4759b-151">Formuła gwarantuje, że docelowy Liczba dedykowanych węzłów nigdy nie przekracza 25 maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="4759b-151">The formula ensures that the target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="4759b-152">Nowe zadania zostały przesłane, automatycznie zwiększa rozmiar puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-152">As new tasks are submitted, the pool automatically grows.</span></span> <span data-ttu-id="4759b-153">Jako zakończenie zadania wolnego jeden po drugim stają się maszyn wirtualnych i formuła Skalowanie automatyczne zmniejszana puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-153">As tasks complete, VMs become free one by one and the autoscaling formula shrinks the pool.</span></span>

## <a name="variables"></a><span data-ttu-id="4759b-154">Zmienne</span><span class="sxs-lookup"><span data-stu-id="4759b-154">Variables</span></span>
<span data-ttu-id="4759b-155">Można użyć zarówno **usługa zdefiniowana** i **zdefiniowane przez użytkownika** zmiennych w formułach skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="4759b-156">Zmienne zdefiniowane przez usługi są wbudowane w celu usługi partia zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-156">The service-defined variables are built in to the Batch service.</span></span> <span data-ttu-id="4759b-157">Niektóre zmienne zdefiniowane usługi są odczytu i zapisu, a niektóre są tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="4759b-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="4759b-158">Zmienne zdefiniowane przez użytkownika są zmiennych zdefiniowanych przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4759b-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="4759b-159">W formule przykładzie pokazano w poprzedniej sekcji `$TargetDedicatedNodes` i `$PendingTasks` są zmienne zdefiniowane przez usługę.</span><span class="sxs-lookup"><span data-stu-id="4759b-159">In the example formula shown in the previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="4759b-160">Zmienne `startingNumberOfVMs` i `maxNumberofVMs` są zmienne zdefiniowane przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="4759b-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="4759b-161">Zmienne zdefiniowane przez usługi są zawsze poprzedzone znak dolara ($).</span><span class="sxs-lookup"><span data-stu-id="4759b-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="4759b-162">W przypadku zmiennych zdefiniowanych przez użytkownika znak dolara jest opcjonalna.</span><span class="sxs-lookup"><span data-stu-id="4759b-162">For user-defined variables, the dollar sign is optional.</span></span>
>
>

<span data-ttu-id="4759b-163">W poniższej tabeli przedstawiono zmienne odczytu zapisu i tylko do odczytu, które są definiowane przez usługi partia zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-163">The following tables show both read-write and read-only variables that are defined by the Batch service.</span></span>

<span data-ttu-id="4759b-164">Możesz pobrać i ustawić wartości tych zmiennych zdefiniowanych przez usługę, aby zarządzać liczbą węzłów obliczeniowych w puli:</span><span class="sxs-lookup"><span data-stu-id="4759b-164">You can get and set the values of these service-defined variables to manage the number of compute nodes in a pool:</span></span>

| <span data-ttu-id="4759b-165">Zmienne zdefiniowane przez usługę do odczytu / zapisu</span><span class="sxs-lookup"><span data-stu-id="4759b-165">Read-write service-defined variables</span></span> | <span data-ttu-id="4759b-166">Opis</span><span class="sxs-lookup"><span data-stu-id="4759b-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="4759b-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="4759b-168">Docelowy Liczba dedykowanych obliczeniowe węzłów dla tej puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-168">The target number of dedicated compute nodes for the pool.</span></span> <span data-ttu-id="4759b-169">Liczba dedykowanych węzłów jest określony jako element docelowy, ponieważ pula nie zawsze będzie odpowiednią liczbę węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-169">The number of dedicated nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="4759b-170">Na przykład docelowy Liczba dedykowanych węzłów jest modyfikowany przez ocenę automatycznego skalowania przed puli osiągnęła początkowej docelowej, następnie puli może nie osiągnąć obiektu docelowego.</span><span class="sxs-lookup"><span data-stu-id="4759b-170">For example, if the target number of dedicated nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <br /><br /> <span data-ttu-id="4759b-171">Pulą konto utworzone z konfiguracją usługi partia zadań nie może osiągnąć elementem docelowym, jeśli element docelowy przekracza przydział węzła lub core konta wsadowego.</span><span class="sxs-lookup"><span data-stu-id="4759b-171">A pool in an account created with the Batch Service configuration may not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="4759b-172">Pulą konto utworzone przy użyciu konfiguracji subskrypcji użytkownika nie może osiągnąć elementem docelowym, jeśli element docelowy przekracza limit przydziału rdzeni udostępnionego dla subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="4759b-172">A pool in an account created with the User Subscription configuration may not achieve its target if the target exceeds the shared core quota for the subscription.</span></span>|
| <span data-ttu-id="4759b-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="4759b-174">Liczba docelowych niskiego priorytetu obliczeniowe węzłów dla tej puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-174">The target number of low-priority compute nodes for the pool.</span></span> <span data-ttu-id="4759b-175">Liczba węzłów o niskim priorytecie jest określony jako element docelowy, ponieważ pula nie zawsze będzie odpowiednią liczbę węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-175">The number of low-priority nodes is specified as a target because a pool may not always achieve the desired number of nodes.</span></span> <span data-ttu-id="4759b-176">Na przykład docelowej liczby węzłów niskiego priorytetu jest modyfikowany przez ocenę skalowania automatycznego przed puli osiągnęła początkowej docelowej, następnie puli może nie osiągnąć cel.</span><span class="sxs-lookup"><span data-stu-id="4759b-176">For example, if the target number of low-priority nodes is modified by an autoscale evaluation before the pool has reached the initial target, then the pool may not reach the target.</span></span> <span data-ttu-id="4759b-177">Pula również może nie będzie elementem docelowym, jeśli element docelowy przekracza przydział węzła lub core konta wsadowego.</span><span class="sxs-lookup"><span data-stu-id="4759b-177">A pool may also not achieve its target if the target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="4759b-178">Aby uzyskać więcej informacji na węzłach obliczeniowych niskiego priorytetu, zobacz [niskiego priorytetu maszyn wirtualnych za pomocą partii (wersja zapoznawcza)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="4759b-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="4759b-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="4759b-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="4759b-180">Akcja, która występuje, gdy węzły obliczeniowe są usuwane z puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-180">The action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="4759b-181">Możliwe wartości:</span><span class="sxs-lookup"><span data-stu-id="4759b-181">Possible values are:</span></span><ul><li><span data-ttu-id="4759b-182">**requeue**--natychmiast kończy zadań i umieszczane w kolejce zadań, dzięki czemu są one zmienił.</span><span class="sxs-lookup"><span data-stu-id="4759b-182">**requeue**--Terminates tasks immediately and puts them back on the job queue so that they are rescheduled.</span></span><li><span data-ttu-id="4759b-183">**przerwanie**— natychmiast kończy zadań i usuwa je z kolejki zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-183">**terminate**--Terminates tasks immediately and removes them from the job queue.</span></span><li><span data-ttu-id="4759b-184">**taskcompletion**--oczekuje aktualnie uruchomione zadania, aby zakończyć, a następnie usuwa węzeł z puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-184">**taskcompletion**--Waits for currently running tasks to finish and then removes the node from the pool.</span></span><li><span data-ttu-id="4759b-185">**retaineddata**--czeka na wszystkich danych lokalnych zachowane zadań na węzeł, który ma zostać wyczyszczone przed usunięciem węzeł z puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-185">**retaineddata**--Waits for all the local task-retained data on the node to be cleaned up before removing the node from the pool.</span></span></ul> |

<span data-ttu-id="4759b-186">Można pobrać wartości tych zmiennych zdefiniowanych przez usługę wprowadzanie korekt, oparte na metryki z usługi partia zadań:</span><span class="sxs-lookup"><span data-stu-id="4759b-186">You can get the value of these service-defined variables to make adjustments that are based on metrics from the Batch service:</span></span>

| <span data-ttu-id="4759b-187">Zmienne tylko do odczytu usługa zdefiniowana</span><span class="sxs-lookup"><span data-stu-id="4759b-187">Read-only service-defined variables</span></span> | <span data-ttu-id="4759b-188">Opis</span><span class="sxs-lookup"><span data-stu-id="4759b-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="4759b-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="4759b-189">$CPUPercent</span></span> |<span data-ttu-id="4759b-190">Średni procent użycia procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="4759b-190">The average percentage of CPU usage.</span></span> |
| <span data-ttu-id="4759b-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="4759b-191">$WallClockSeconds</span></span> |<span data-ttu-id="4759b-192">Liczba zużywane sekund.</span><span class="sxs-lookup"><span data-stu-id="4759b-192">The number of seconds consumed.</span></span> |
| <span data-ttu-id="4759b-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-193">$MemoryBytes</span></span> |<span data-ttu-id="4759b-194">Średnia liczba megabajtów używane.</span><span class="sxs-lookup"><span data-stu-id="4759b-194">The average number of megabytes used.</span></span> |
| <span data-ttu-id="4759b-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-195">$DiskBytes</span></span> |<span data-ttu-id="4759b-196">Średnia liczba gigabajtów używane na lokalnych dyskach.</span><span class="sxs-lookup"><span data-stu-id="4759b-196">The average number of gigabytes used on the local disks.</span></span> |
| <span data-ttu-id="4759b-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-197">$DiskReadBytes</span></span> |<span data-ttu-id="4759b-198">Liczba bajtów odczytanych.</span><span class="sxs-lookup"><span data-stu-id="4759b-198">The number of bytes read.</span></span> |
| <span data-ttu-id="4759b-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-199">$DiskWriteBytes</span></span> |<span data-ttu-id="4759b-200">Liczba zapisanych bajtów.</span><span class="sxs-lookup"><span data-stu-id="4759b-200">The number of bytes written.</span></span> |
| <span data-ttu-id="4759b-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="4759b-201">$DiskReadOps</span></span> |<span data-ttu-id="4759b-202">Liczba operacji odczytu dysku.</span><span class="sxs-lookup"><span data-stu-id="4759b-202">The count of read disk operations performed.</span></span> |
| <span data-ttu-id="4759b-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="4759b-203">$DiskWriteOps</span></span> |<span data-ttu-id="4759b-204">Liczba operacji dysku zapisu.</span><span class="sxs-lookup"><span data-stu-id="4759b-204">The count of write disk operations performed.</span></span> |
| <span data-ttu-id="4759b-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-205">$NetworkInBytes</span></span> |<span data-ttu-id="4759b-206">Liczba bajtów przychodzących.</span><span class="sxs-lookup"><span data-stu-id="4759b-206">The number of inbound bytes.</span></span> |
| <span data-ttu-id="4759b-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-207">$NetworkOutBytes</span></span> |<span data-ttu-id="4759b-208">Liczba bajtów wychodzących.</span><span class="sxs-lookup"><span data-stu-id="4759b-208">The number of outbound bytes.</span></span> |
| <span data-ttu-id="4759b-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="4759b-209">$SampleNodeCount</span></span> |<span data-ttu-id="4759b-210">Liczba węzłów obliczeniowych.</span><span class="sxs-lookup"><span data-stu-id="4759b-210">The count of compute nodes.</span></span> |
| <span data-ttu-id="4759b-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-211">$ActiveTasks</span></span> |<span data-ttu-id="4759b-212">Liczba zadań, które są gotowe do wykonania, ale nie są jeszcze wykonywany.</span><span class="sxs-lookup"><span data-stu-id="4759b-212">The number of tasks that are ready to execute but are not yet executing.</span></span> <span data-ttu-id="4759b-213">Licznik $ActiveTasks obejmuje wszystkie zadania, które znajdują się w stanie aktywnym i którego zależności zostały spełnione.</span><span class="sxs-lookup"><span data-stu-id="4759b-213">The $ActiveTasks count includes all tasks that are in the active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="4759b-214">Wszystkie zadania, które są w stanie aktywnym, ale których zależności nie zostały spełnione są wykluczone z liczby $ActiveTasks.</span><span class="sxs-lookup"><span data-stu-id="4759b-214">Any tasks that are in the active state but whose dependencies have not been satisfied are excluded from the $ActiveTasks count.</span></span>|
| <span data-ttu-id="4759b-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-215">$RunningTasks</span></span> |<span data-ttu-id="4759b-216">Liczba zadań w stanie uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="4759b-216">The number of tasks in a running state.</span></span> |
| <span data-ttu-id="4759b-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-217">$PendingTasks</span></span> |<span data-ttu-id="4759b-218">Suma $ActiveTasks i $RunningTasks.</span><span class="sxs-lookup"><span data-stu-id="4759b-218">The sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="4759b-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-219">$SucceededTasks</span></span> |<span data-ttu-id="4759b-220">Liczba zadań, które zakończyło się pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="4759b-220">The number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="4759b-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-221">$FailedTasks</span></span> |<span data-ttu-id="4759b-222">Liczba zadań, których nie powiodła się.</span><span class="sxs-lookup"><span data-stu-id="4759b-222">The number of tasks that failed.</span></span> |
| <span data-ttu-id="4759b-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="4759b-224">Bieżąca liczba dedykowanych węzły obliczeniowe.</span><span class="sxs-lookup"><span data-stu-id="4759b-224">The current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="4759b-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="4759b-226">Bieżąca liczba niskiego priorytetu obliczeniowe węzły, w tym wszystkie węzły, które zostały opóźnieniem.</span><span class="sxs-lookup"><span data-stu-id="4759b-226">The current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="4759b-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="4759b-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="4759b-228">Liczba węzłów w puli, które są w stanie opóźnieniem.</span><span class="sxs-lookup"><span data-stu-id="4759b-228">The number of nodes in the pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="4759b-229">Zmienne tylko do odczytu, usługa zdefiniowana, które są wyświetlane w poprzedniej tabeli są *obiektów* zawierających różne metody dostępu do danych skojarzonych z każdym.</span><span class="sxs-lookup"><span data-stu-id="4759b-229">The read-only, service-defined variables that are shown in the previous table are *objects* that provide various methods to access data associated with each.</span></span> <span data-ttu-id="4759b-230">Aby uzyskać więcej informacji, zobacz [uzyskać przykładowe dane](#getsampledata) dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="4759b-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="4759b-231">Typy</span><span class="sxs-lookup"><span data-stu-id="4759b-231">Types</span></span>
<span data-ttu-id="4759b-232">Te typy są obsługiwane w formule:</span><span class="sxs-lookup"><span data-stu-id="4759b-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="4759b-233">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-233">double</span></span>
* <span data-ttu-id="4759b-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-234">doubleVec</span></span>
* <span data-ttu-id="4759b-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="4759b-235">doubleVecList</span></span>
* <span data-ttu-id="4759b-236">Ciąg</span><span class="sxs-lookup"><span data-stu-id="4759b-236">string</span></span>
* <span data-ttu-id="4759b-237">Sygnatura czasowa — sygnatura czasowa jest złożone struktura, która zawiera następujące składniki:</span><span class="sxs-lookup"><span data-stu-id="4759b-237">timestamp--timestamp is a compound structure that contains the following members:</span></span>

  * <span data-ttu-id="4759b-238">Roku</span><span class="sxs-lookup"><span data-stu-id="4759b-238">year</span></span>
  * <span data-ttu-id="4759b-239">miesiąc (1-12)</span><span class="sxs-lookup"><span data-stu-id="4759b-239">month (1-12)</span></span>
  * <span data-ttu-id="4759b-240">dzień (1-31)</span><span class="sxs-lookup"><span data-stu-id="4759b-240">day (1-31)</span></span>
  * <span data-ttu-id="4759b-241">dzień tygodnia (w formacie numeru; na przykład 1, od poniedziałku)</span><span class="sxs-lookup"><span data-stu-id="4759b-241">weekday (in the format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="4759b-242">Godzina (w formacie liczby 24-godzinnym; na przykład 13 oznacza 13: 00)</span><span class="sxs-lookup"><span data-stu-id="4759b-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="4759b-243">minut (00 do 59)</span><span class="sxs-lookup"><span data-stu-id="4759b-243">minute (00-59)</span></span>
  * <span data-ttu-id="4759b-244">drugie (00 do 59)</span><span class="sxs-lookup"><span data-stu-id="4759b-244">second (00-59)</span></span>
* <span data-ttu-id="4759b-245">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-245">timeinterval</span></span>

  * <span data-ttu-id="4759b-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="4759b-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="4759b-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="4759b-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="4759b-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="4759b-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="4759b-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="4759b-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="4759b-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="4759b-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="4759b-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="4759b-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="4759b-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="4759b-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="4759b-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="4759b-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="4759b-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="4759b-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="4759b-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="4759b-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="4759b-256">Operacje</span><span class="sxs-lookup"><span data-stu-id="4759b-256">Operations</span></span>
<span data-ttu-id="4759b-257">Te operacje są dozwolone w typach, które są wymienione w poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="4759b-257">These operations are allowed on the types that are listed in the previous section.</span></span>

| <span data-ttu-id="4759b-258">Operacja</span><span class="sxs-lookup"><span data-stu-id="4759b-258">Operation</span></span> | <span data-ttu-id="4759b-259">Operatory obsługiwane</span><span class="sxs-lookup"><span data-stu-id="4759b-259">Supported operators</span></span> | <span data-ttu-id="4759b-260">Typ wyniku</span><span class="sxs-lookup"><span data-stu-id="4759b-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4759b-261">Podwójna *operator* podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-261">double *operator* double</span></span> |<span data-ttu-id="4759b-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="4759b-262">+, -, *, /</span></span> |<span data-ttu-id="4759b-263">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-263">double</span></span> |
| <span data-ttu-id="4759b-264">Podwójna *operator* parametru timeinterval</span><span class="sxs-lookup"><span data-stu-id="4759b-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="4759b-265">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-265">timeinterval</span></span> |
| <span data-ttu-id="4759b-266">doubleVec *operator* podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-266">doubleVec *operator* double</span></span> |<span data-ttu-id="4759b-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="4759b-267">+, -, *, /</span></span> |<span data-ttu-id="4759b-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-268">doubleVec</span></span> |
| <span data-ttu-id="4759b-269">doubleVec *operator* doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="4759b-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="4759b-270">+, -, *, /</span></span> |<span data-ttu-id="4759b-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-271">doubleVec</span></span> |
| <span data-ttu-id="4759b-272">parametru TimeInterval *operator* podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-272">timeinterval *operator* double</span></span> |<span data-ttu-id="4759b-273">*, /</span><span class="sxs-lookup"><span data-stu-id="4759b-273">*, /</span></span> |<span data-ttu-id="4759b-274">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-274">timeinterval</span></span> |
| <span data-ttu-id="4759b-275">parametru TimeInterval *operator* parametru timeinterval</span><span class="sxs-lookup"><span data-stu-id="4759b-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="4759b-276">+, -</span><span class="sxs-lookup"><span data-stu-id="4759b-276">+, -</span></span> |<span data-ttu-id="4759b-277">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-277">timeinterval</span></span> |
| <span data-ttu-id="4759b-278">parametru TimeInterval *operator* sygnatury czasowej</span><span class="sxs-lookup"><span data-stu-id="4759b-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="4759b-279">sygnatura czasowa</span><span class="sxs-lookup"><span data-stu-id="4759b-279">timestamp</span></span> |
| <span data-ttu-id="4759b-280">Sygnatura czasowa *operator* parametru timeinterval</span><span class="sxs-lookup"><span data-stu-id="4759b-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="4759b-281">sygnatura czasowa</span><span class="sxs-lookup"><span data-stu-id="4759b-281">timestamp</span></span> |
| <span data-ttu-id="4759b-282">Sygnatura czasowa *operator* sygnatury czasowej</span><span class="sxs-lookup"><span data-stu-id="4759b-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="4759b-283">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-283">timeinterval</span></span> |
| <span data-ttu-id="4759b-284">*operator*podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-284">*operator*double</span></span> |<span data-ttu-id="4759b-285">-, !</span><span class="sxs-lookup"><span data-stu-id="4759b-285">-, !</span></span> |<span data-ttu-id="4759b-286">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-286">double</span></span> |
| <span data-ttu-id="4759b-287">*operator*parametru timeinterval</span><span class="sxs-lookup"><span data-stu-id="4759b-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="4759b-288">parametru TimeInterval</span><span class="sxs-lookup"><span data-stu-id="4759b-288">timeinterval</span></span> |
| <span data-ttu-id="4759b-289">Podwójna *operator* podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-289">double *operator* double</span></span> |<span data-ttu-id="4759b-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="4759b-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="4759b-291">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-291">double</span></span> |
| <span data-ttu-id="4759b-292">ciąg *operator* ciągu</span><span class="sxs-lookup"><span data-stu-id="4759b-292">string *operator* string</span></span> |<span data-ttu-id="4759b-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="4759b-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="4759b-294">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-294">double</span></span> |
| <span data-ttu-id="4759b-295">Sygnatura czasowa *operator* sygnatury czasowej</span><span class="sxs-lookup"><span data-stu-id="4759b-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="4759b-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="4759b-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="4759b-297">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-297">double</span></span> |
| <span data-ttu-id="4759b-298">parametru TimeInterval *operator* parametru timeinterval</span><span class="sxs-lookup"><span data-stu-id="4759b-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="4759b-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="4759b-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="4759b-300">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-300">double</span></span> |
| <span data-ttu-id="4759b-301">Podwójna *operator* podwójne</span><span class="sxs-lookup"><span data-stu-id="4759b-301">double *operator* double</span></span> |<span data-ttu-id="4759b-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="4759b-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="4759b-303">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-303">double</span></span> |

<span data-ttu-id="4759b-304">Podczas testowania wartość o podwójnej precyzji z trójargumentowy (`double ? statement1 : statement2`), jest różna od zera jest **true**, i zero jest **false**.</span><span class="sxs-lookup"><span data-stu-id="4759b-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="4759b-305">Funkcje</span><span class="sxs-lookup"><span data-stu-id="4759b-305">Functions</span></span>
<span data-ttu-id="4759b-306">Te wstępnie zdefiniowane **funkcje** są dostępne do użycia podczas definiowania automatycznego skalowania formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-306">These predefined **functions** are available for you to use in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="4759b-307">Funkcja</span><span class="sxs-lookup"><span data-stu-id="4759b-307">Function</span></span> | <span data-ttu-id="4759b-308">Zwracany typ</span><span class="sxs-lookup"><span data-stu-id="4759b-308">Return type</span></span> | <span data-ttu-id="4759b-309">Opis</span><span class="sxs-lookup"><span data-stu-id="4759b-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4759b-310">AVG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-310">avg(doubleVecList)</span></span> |<span data-ttu-id="4759b-311">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-311">double</span></span> |<span data-ttu-id="4759b-312">Zwraca średnią wartość dla wszystkich wartości w doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-312">Returns the average value for all values in the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-313">Len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-313">len(doubleVecList)</span></span> |<span data-ttu-id="4759b-314">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-314">double</span></span> |<span data-ttu-id="4759b-315">Zwraca długość wektora, która jest tworzona na podstawie doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-315">Returns the length of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-316">LG(Double)</span><span class="sxs-lookup"><span data-stu-id="4759b-316">lg(double)</span></span> |<span data-ttu-id="4759b-317">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-317">double</span></span> |<span data-ttu-id="4759b-318">Zwraca dziennik podstawowej 2 podwójnego.</span><span class="sxs-lookup"><span data-stu-id="4759b-318">Returns the log base 2 of the double.</span></span> |
| <span data-ttu-id="4759b-319">LG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-319">lg(doubleVecList)</span></span> |<span data-ttu-id="4759b-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-320">doubleVec</span></span> |<span data-ttu-id="4759b-321">Zwraca podstawie 2 doubleVecList component-wise dziennika.</span><span class="sxs-lookup"><span data-stu-id="4759b-321">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="4759b-322">Vec(double) muszą być jawnie przekazywane w parametrze.</span><span class="sxs-lookup"><span data-stu-id="4759b-322">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="4759b-323">W przeciwnym razie przyjęto wersji lg(double) dwa razy.</span><span class="sxs-lookup"><span data-stu-id="4759b-323">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="4759b-324">ln(Double)</span><span class="sxs-lookup"><span data-stu-id="4759b-324">ln(double)</span></span> |<span data-ttu-id="4759b-325">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-325">double</span></span> |<span data-ttu-id="4759b-326">Zwraca logarytm naturalny podwójnego.</span><span class="sxs-lookup"><span data-stu-id="4759b-326">Returns the natural log of the double.</span></span> |
| <span data-ttu-id="4759b-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-327">ln(doubleVecList)</span></span> |<span data-ttu-id="4759b-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-328">doubleVec</span></span> |<span data-ttu-id="4759b-329">Zwraca podstawie 2 doubleVecList component-wise dziennika.</span><span class="sxs-lookup"><span data-stu-id="4759b-329">Returns the component-wise log base 2 of the doubleVecList.</span></span> <span data-ttu-id="4759b-330">Vec(double) muszą być jawnie przekazywane w parametrze.</span><span class="sxs-lookup"><span data-stu-id="4759b-330">A vec(double) must be explicitly passed for the parameter.</span></span> <span data-ttu-id="4759b-331">W przeciwnym razie przyjęto wersji lg(double) dwa razy.</span><span class="sxs-lookup"><span data-stu-id="4759b-331">Otherwise, the double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="4759b-332">log(Double)</span><span class="sxs-lookup"><span data-stu-id="4759b-332">log(double)</span></span> |<span data-ttu-id="4759b-333">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-333">double</span></span> |<span data-ttu-id="4759b-334">Zwraca dziennik podwójnego o podstawie 10.</span><span class="sxs-lookup"><span data-stu-id="4759b-334">Returns the log base 10 of the double.</span></span> |
| <span data-ttu-id="4759b-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-335">log(doubleVecList)</span></span> |<span data-ttu-id="4759b-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="4759b-336">doubleVec</span></span> |<span data-ttu-id="4759b-337">Zwraca dziennik component-wise doubleVecList o podstawie 10.</span><span class="sxs-lookup"><span data-stu-id="4759b-337">Returns the component-wise log base 10 of the doubleVecList.</span></span> <span data-ttu-id="4759b-338">Vec(double) muszą być jawnie przekazywane dla jednego parametru dwa razy.</span><span class="sxs-lookup"><span data-stu-id="4759b-338">A vec(double) must be explicitly passed for the single double parameter.</span></span> <span data-ttu-id="4759b-339">W przeciwnym razie przyjęto wersji log(double) dwa razy.</span><span class="sxs-lookup"><span data-stu-id="4759b-339">Otherwise, the double log(double) version is assumed.</span></span> |
| <span data-ttu-id="4759b-340">MAX(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-340">max(doubleVecList)</span></span> |<span data-ttu-id="4759b-341">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-341">double</span></span> |<span data-ttu-id="4759b-342">Zwraca maksymalną wartość doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-342">Returns the maximum value in the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-343">min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-343">min(doubleVecList)</span></span> |<span data-ttu-id="4759b-344">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-344">double</span></span> |<span data-ttu-id="4759b-345">Zwraca minimalną wartość doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-345">Returns the minimum value in the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-346">norm(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-346">norm(doubleVecList)</span></span> |<span data-ttu-id="4759b-347">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-347">double</span></span> |<span data-ttu-id="4759b-348">Zwraca dwa normy wektora, która jest tworzona na podstawie doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-348">Returns the two-norm of the vector that is created from the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-349">percentyl (v doubleVec podwójne p)</span><span class="sxs-lookup"><span data-stu-id="4759b-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="4759b-350">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-350">double</span></span> |<span data-ttu-id="4759b-351">Zwraca element percentyl wektora v.</span><span class="sxs-lookup"><span data-stu-id="4759b-351">Returns the percentile element of the vector v.</span></span> |
| <span data-ttu-id="4759b-352">RAND()</span><span class="sxs-lookup"><span data-stu-id="4759b-352">rand()</span></span> |<span data-ttu-id="4759b-353">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-353">double</span></span> |<span data-ttu-id="4759b-354">Zwraca wartość losowe od 0,0 do 1,0.</span><span class="sxs-lookup"><span data-stu-id="4759b-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="4759b-355">Range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-355">range(doubleVecList)</span></span> |<span data-ttu-id="4759b-356">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-356">double</span></span> |<span data-ttu-id="4759b-357">Zwraca różnicę między minimalną i maksymalną wartości doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-357">Returns the difference between the min and max values in the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-358">STD(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-358">std(doubleVecList)</span></span> |<span data-ttu-id="4759b-359">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-359">double</span></span> |<span data-ttu-id="4759b-360">Zwraca odchylenie standardowe przykładowe wartości doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-360">Returns the sample standard deviation of the values in the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-361">stop()</span><span class="sxs-lookup"><span data-stu-id="4759b-361">stop()</span></span> | |<span data-ttu-id="4759b-362">Zatrzymuje obliczania wyrażenia Skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="4759b-362">Stops evaluation of the autoscaling expression.</span></span> |
| <span data-ttu-id="4759b-363">sum(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="4759b-363">sum(doubleVecList)</span></span> |<span data-ttu-id="4759b-364">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-364">double</span></span> |<span data-ttu-id="4759b-365">Zwraca sumę wszystkich składników doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="4759b-365">Returns the sum of all the components of the doubleVecList.</span></span> |
| <span data-ttu-id="4759b-366">czas (string, dateTime = "")</span><span class="sxs-lookup"><span data-stu-id="4759b-366">time(string dateTime="")</span></span> |<span data-ttu-id="4759b-367">sygnatura czasowa</span><span class="sxs-lookup"><span data-stu-id="4759b-367">timestamp</span></span> |<span data-ttu-id="4759b-368">Zwraca sygnaturę czasową bieżącego czasu, jeśli nie przekazano żadnych parametrów lub sygnatura czasowa ciągu daty i godziny, jeśli został przekazany.</span><span class="sxs-lookup"><span data-stu-id="4759b-368">Returns the time stamp of the current time if no parameters are passed, or the time stamp of the dateTime string if it is passed.</span></span> <span data-ttu-id="4759b-369">Formaty obsługiwanych dateTime są W3C DTF i RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="4759b-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="4759b-370">Val (v doubleVec i dwa razy)</span><span class="sxs-lookup"><span data-stu-id="4759b-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="4759b-371">O podwójnej precyzji</span><span class="sxs-lookup"><span data-stu-id="4759b-371">double</span></span> |<span data-ttu-id="4759b-372">Zwraca wartość elementu, który znajduje się w lokalizacji i w przypadku wektora v z indeksem początkowej zero.</span><span class="sxs-lookup"><span data-stu-id="4759b-372">Returns the value of the element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="4759b-373">Niektóre funkcje, które zostały opisane w poprzedniej tabeli można zaakceptować listy jako argument.</span><span class="sxs-lookup"><span data-stu-id="4759b-373">Some of the functions that are described in the previous table can accept a list as an argument.</span></span> <span data-ttu-id="4759b-374">Rozdzielana przecinkami lista jest dowolną kombinację *podwójne* i *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="4759b-374">The comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="4759b-375">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="4759b-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="4759b-376">*DoubleVecList* wartość jest konwertowana na jeden *doubleVec* przed oceny.</span><span class="sxs-lookup"><span data-stu-id="4759b-376">The *doubleVecList* value is converted to a single *doubleVec* before evaluation.</span></span> <span data-ttu-id="4759b-377">Na przykład jeśli `v = [1,2,3]`, wywołując `avg(v)` jest odpowiednikiem wywołania `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="4759b-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent to calling `avg(1,2,3)`.</span></span> <span data-ttu-id="4759b-378">Wywoływanie `avg(v, 7)` jest odpowiednikiem wywołania `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="4759b-378">Calling `avg(v, 7)` is equivalent to calling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="4759b-379"><a name="getsampledata"></a>Uzyskaj przykładowe dane</span><span class="sxs-lookup"><span data-stu-id="4759b-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="4759b-380">Funkcja automatycznego skalowania formuły działają na metryki danych (przykłady) dostarczonego przez usługi partia zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-380">Autoscale formulas act on metrics data (samples) that is provided by the Batch service.</span></span> <span data-ttu-id="4759b-381">Formuła powiększa się lub zmniejsza rozmiar puli na podstawie wartości uzyskiwanych z usługi.</span><span class="sxs-lookup"><span data-stu-id="4759b-381">A formula grows or shrinks pool size based on the values that it obtains from the service.</span></span> <span data-ttu-id="4759b-382">Definicja usługi zmiennych, które zostały opisane wcześniej są obiekty, które zapewniają różne metody dostępu do danych, który jest skojarzony z tym obiektem.</span><span class="sxs-lookup"><span data-stu-id="4759b-382">The service-defined variables that were described previously are objects that provide various methods to access data that is associated with that object.</span></span> <span data-ttu-id="4759b-383">Na przykład poniższe wyrażenie zawiera żądanie get ostatnich pięciu minut użycia procesora CPU:</span><span class="sxs-lookup"><span data-stu-id="4759b-383">For example, the following expression shows a request to get the last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="4759b-384">Metoda</span><span class="sxs-lookup"><span data-stu-id="4759b-384">Method</span></span> | <span data-ttu-id="4759b-385">Opis</span><span class="sxs-lookup"><span data-stu-id="4759b-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="4759b-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="4759b-386">GetSample()</span></span> |<span data-ttu-id="4759b-387">`GetSample()` Metoda zwraca wektor próbek danych.</span><span class="sxs-lookup"><span data-stu-id="4759b-387">The `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="4759b-388">Przykładowe wynosi 30 sekund warto danych metryki.</span><span class="sxs-lookup"><span data-stu-id="4759b-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="4759b-389">Innymi słowy przykłady są uzyskiwane co 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="4759b-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="4759b-390">Ale przypadków wymienionych poniżej, opóźnienie między po próbki są zbierane i gdy jest ona dostępna do formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-390">But as noted below, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="4759b-391">Tak nie wszystkie przykłady w danym czasie może być dostępny do szacowania przez formułę.</span><span class="sxs-lookup"><span data-stu-id="4759b-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="4759b-392">Określa liczbę próbek można uzyskać z najnowsze przykłady, które zostały zebrane.</span><span class="sxs-lookup"><span data-stu-id="4759b-392">Specifies the number of samples to obtain from the most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="4759b-393">`GetSample(1)`Zwraca ostatniej próbki dostępne.</span><span class="sxs-lookup"><span data-stu-id="4759b-393">`GetSample(1)` returns the last available sample.</span></span> <span data-ttu-id="4759b-394">Dla metryk, takich jak `$CPUPercent`, jednak to nie stosuje się, ponieważ nie jest możliwe, należy wiedzieć *podczas* próbki został zebrany.</span><span class="sxs-lookup"><span data-stu-id="4759b-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible to know *when* the sample was collected.</span></span> <span data-ttu-id="4759b-395">Może być ostatnie lub z powodu problemów dotyczących systemu, może być znacznie starsza.</span><span class="sxs-lookup"><span data-stu-id="4759b-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="4759b-396">Najlepiej w takich przypadkach można użyć przedział czasu, jak pokazano poniżej.</span><span class="sxs-lookup"><span data-stu-id="4759b-396">It is better in such cases to use a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="4759b-397">Określa przedział czasu zbierania przykładowych danych.</span><span class="sxs-lookup"><span data-stu-id="4759b-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="4759b-398">Opcjonalnie określa również wartość procentowa próbek, które muszą być dostępne w ramach czasowych żądanej.</span><span class="sxs-lookup"><span data-stu-id="4759b-398">Optionally, it also specifies the percentage of samples that must be available in the requested time frame.</span></span><br/><br/><span data-ttu-id="4759b-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`zwróci 20 próbek, gdy wszystkie próbki dla ostatnich 10 minut znajdują się w historii CPUPercent.</span><span class="sxs-lookup"><span data-stu-id="4759b-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for the last 10 minutes are present in the CPUPercent history.</span></span> <span data-ttu-id="4759b-400">Jeśli w ciągu ostatniej minuty Historia nie jest dostępna, jednak tylko 18 przykłady będzie zwracany.</span><span class="sxs-lookup"><span data-stu-id="4759b-400">If the last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="4759b-401">W takim przypadku:</span><span class="sxs-lookup"><span data-stu-id="4759b-401">In this case:</span></span><br/><br/><span data-ttu-id="4759b-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`nie powiedzie się, ponieważ nie są dostępne tylko 90 procent próbek.</span><span class="sxs-lookup"><span data-stu-id="4759b-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of the samples are available.</span></span><br/><br/><span data-ttu-id="4759b-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)`powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="4759b-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="4759b-404">Określa przedział czasu zbierania danych z godziny rozpoczęcia i godzina zakończenia.</span><span class="sxs-lookup"><span data-stu-id="4759b-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="4759b-405">Jak wspomniano powyżej, istnieje opóźnienie między po próbki są zbierane i gdy jest ona dostępna do formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-405">As mentioned above, there is a delay between when a sample is collected and when it is available to a formula.</span></span> <span data-ttu-id="4759b-406">Należy rozważyć to opóźnienie, korzystając z `GetSample` metody.</span><span class="sxs-lookup"><span data-stu-id="4759b-406">Consider this delay when you use the `GetSample` method.</span></span> <span data-ttu-id="4759b-407">Zobacz `GetSamplePercent` poniżej.</span><span class="sxs-lookup"><span data-stu-id="4759b-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="4759b-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="4759b-408">GetSamplePeriod()</span></span> |<span data-ttu-id="4759b-409">Zwraca okres próbek, które zostały wykonane w zestawie danych historycznych próbki.</span><span class="sxs-lookup"><span data-stu-id="4759b-409">Returns the period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="4759b-410">Funkcji Count()</span><span class="sxs-lookup"><span data-stu-id="4759b-410">Count()</span></span> |<span data-ttu-id="4759b-411">Zwraca łączna liczba próbek w historii metryki.</span><span class="sxs-lookup"><span data-stu-id="4759b-411">Returns the total number of samples in the metric history.</span></span> |
| <span data-ttu-id="4759b-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="4759b-412">HistoryBeginTime()</span></span> |<span data-ttu-id="4759b-413">Zwraca sygnaturę czasową najstarsze próbki dostępnych danych dla metryki.</span><span class="sxs-lookup"><span data-stu-id="4759b-413">Returns the time stamp of the oldest available data sample for the metric.</span></span> |
| <span data-ttu-id="4759b-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="4759b-414">GetSamplePercent()</span></span> |<span data-ttu-id="4759b-415">Zwraca wartość procentowa próbek, które są dostępne dla danego interwału.</span><span class="sxs-lookup"><span data-stu-id="4759b-415">Returns the percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="4759b-416">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="4759b-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="4759b-417">Ponieważ `GetSample` metody zakończy się niepowodzeniem, jeśli wartość procentowa próbek zwracany jest mniejsza niż `samplePercent` określony, można użyć `GetSamplePercent` metodę, aby sprawdzić w pierwszej kolejności.</span><span class="sxs-lookup"><span data-stu-id="4759b-417">Because the `GetSample` method fails if the percentage of samples returned is less than the `samplePercent` specified, you can use the `GetSamplePercent` method to check first.</span></span> <span data-ttu-id="4759b-418">Następnie można wykonać akcję alternatywną, jeśli brakuje przykłady są obecne, bez zatrzymania automatycznego skalowania oceny.</span><span class="sxs-lookup"><span data-stu-id="4759b-418">Then you can perform an alternate action if insufficient samples are present, without halting the automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-the-getsample-method"></a><span data-ttu-id="4759b-419">Przykłady, wartość procentowa próbki i *GetSample()* — metoda</span><span class="sxs-lookup"><span data-stu-id="4759b-419">Samples, sample percentage, and the *GetSample()* method</span></span>
<span data-ttu-id="4759b-420">Zapewnienia podstawowej funkcjonalności formułę skalowania automatycznego jest uzyskania danych metryki zadań i zasobów, a następnie Dostosuj rozmiar puli na podstawie tych danych.</span><span class="sxs-lookup"><span data-stu-id="4759b-420">The core operation of an autoscale formula is to obtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="4759b-421">Jest tak, należy dysponować przejrzysty sposób skalowania automatycznego formuły interakcji z metryki danych (przykłady).</span><span class="sxs-lookup"><span data-stu-id="4759b-421">As such, it is important to have a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="4759b-422">**Przykłady**</span><span class="sxs-lookup"><span data-stu-id="4759b-422">**Samples**</span></span>

<span data-ttu-id="4759b-423">Usługa partia zadań okresowo przyjmuje przykłady zadań i zasobu metryki i udostępnia formułach skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-423">The Batch service periodically takes samples of task and resource metrics and makes them available to your autoscale formulas.</span></span> <span data-ttu-id="4759b-424">Te przykłady są rejestrowane co 30 sekund, przez usługi partia zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-424">These samples are recorded every 30 seconds by the Batch service.</span></span> <span data-ttu-id="4759b-425">Istnieje jednak zwykle opóźnienia między kiedy te przykłady zostały zarejestrowane oraz w przypadku ich stają się dostępne do (i może zostać odczytany przez) formułach skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-425">However, there is typically a delay between when those samples were recorded and when they are made available to (and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="4759b-426">Ponadto ze względu na różne czynniki, takie jak sieci lub inne problemy z infrastrukturą, próbki mogą nie zostać zarejestrowane dla określonego interwału.</span><span class="sxs-lookup"><span data-stu-id="4759b-426">Additionally, due to various factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="4759b-427">**Przykładowe wartości procentowej**</span><span class="sxs-lookup"><span data-stu-id="4759b-427">**Sample percentage**</span></span>

<span data-ttu-id="4759b-428">Gdy `samplePercent` jest przekazywana do `GetSample()` — metoda lub `GetSamplePercent()` metoda jest wywoływana, _procent_ odwołuje się do porównania całkowita liczba próbek, które są rejestrowane przez usługę partii i liczba przykłady, które są dostępne z formułą automatycznego skalowania.</span><span class="sxs-lookup"><span data-stu-id="4759b-428">When `samplePercent` is passed to the `GetSample()` method or the `GetSamplePercent()` method is called, _percent_ refers to a comparison between the total possible number of samples that are recorded by the Batch service and the number of samples that are available to your autoscale formula.</span></span>

<span data-ttu-id="4759b-429">Na przykład Przyjrzyjmy timespan 10 minut.</span><span class="sxs-lookup"><span data-stu-id="4759b-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="4759b-430">Ponieważ próbki są rejestrowane co 30 sekund w timespan 10 minut, maksymalna liczba próbek, które są rejestrowane przez partię będzie 20 próbek (2 na minutę).</span><span class="sxs-lookup"><span data-stu-id="4759b-430">Because samples are recorded every 30 seconds within a 10-minute timespan, the maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="4759b-431">Jednak z powodu opóźnienia związanego z używaniem mechanizmu raportowania i inne problemy w systemie Azure, może być tylko 15 przykłady, które są dostępne dla formuły skalowania automatycznego do odczytu.</span><span class="sxs-lookup"><span data-stu-id="4759b-431">However, due to the inherent latency of the reporting mechanism and other issues within Azure, there may be only 15 samples that are available to your autoscale formula for reading.</span></span> <span data-ttu-id="4759b-432">Tak na przykład, w tym okresie 10-minutowych tylko 75% łączna liczba próbek, rejestrowane mogą być dostępne do formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-432">So, for example, for that 10-minute period, only 75% of the total number of samples recorded may be available to your formula.</span></span>

<span data-ttu-id="4759b-433">**Zakresy GetSample() i próbki**</span><span class="sxs-lookup"><span data-stu-id="4759b-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="4759b-434">Formułach skalowania automatycznego mają być powiększania i zmniejszanie z pul &mdash; Dodawanie węzłów i usuwanie węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-434">Your autoscale formulas are going to be growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="4759b-435">Ponieważ węzłów koszt pieniądze, chcesz upewnij się, że formułach Użyj inteligentnego metody analizy, który jest oparty na wystarczającą ilość danych.</span><span class="sxs-lookup"><span data-stu-id="4759b-435">Because nodes cost you money, you want to ensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="4759b-436">Dlatego zaleca się używać analizy typu analizy trendów w formułach.</span><span class="sxs-lookup"><span data-stu-id="4759b-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="4759b-437">Ten typ rozwoju i zmniejsza z puli na podstawie zakresu zbieranych próbek.</span><span class="sxs-lookup"><span data-stu-id="4759b-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="4759b-438">Aby to zrobić, użyj `GetSample(interval look-back start, interval look-back end)` do zwrócenia wektor próbek:</span><span class="sxs-lookup"><span data-stu-id="4759b-438">To do so, use `GetSample(interval look-back start, interval look-back end)` to return a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="4759b-439">Jeśli wiersz powyżej jest oceniane w partii, zwraca zakres próbek jako wektor wartości.</span><span class="sxs-lookup"><span data-stu-id="4759b-439">When the above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="4759b-440">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="4759b-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="4759b-441">Po zostały zebrane wektor próbek, można następnie użyć funkcji, takich jak `min()`, `max()`, i `avg()` do uzyskania istotnych wartości z zakresu zebrane.</span><span class="sxs-lookup"><span data-stu-id="4759b-441">Once you've collected the vector of samples, you can then use functions like `min()`, `max()`, and `avg()` to derive meaningful values from the collected range.</span></span>

<span data-ttu-id="4759b-442">Aby dodatkowo zwiększyć bezpieczeństwo możesz wymusić formuły, aby zakończyć się niepowodzeniem, jeśli jest mniejsza niż określony procent próbki dostępnych w określonym czasie.</span><span class="sxs-lookup"><span data-stu-id="4759b-442">For additional security, you can force a formula evaluation to fail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="4759b-443">Po wymuszeniu formuły niepowodzenie, poinstruuj się partii przestaną dalsze oceny formuły, jeśli określona wartość procentowa próbek nie jest dostępna.</span><span class="sxs-lookup"><span data-stu-id="4759b-443">When you force a formula evaluation to fail, you instruct Batch to cease further evaluation of the formula if the specified percentage of samples is not available.</span></span> <span data-ttu-id="4759b-444">W tym przypadku są wprowadzane żadne zmiany, aby rozmiar puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-444">In this case, no change is made to the pool size.</span></span> <span data-ttu-id="4759b-445">Aby określić wymagana wartość procentowa próbek w wersji ewaluacyjnej powiodło się, należy określić go jako trzeci parametr `GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="4759b-445">To specify a required percentage of samples for the evaluation to succeed, specify it as the third parameter to `GetSample()`.</span></span> <span data-ttu-id="4759b-446">W tym miejscu określono wymaganie 75 procent próbek:</span><span class="sxs-lookup"><span data-stu-id="4759b-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="4759b-447">Ponieważ mogą występować opóźnienia w dostępności próbki, należy zawsze określić zakres czasu, czas rozpoczęcia wygląd Wstecz, która jest starsza niż minuta.</span><span class="sxs-lookup"><span data-stu-id="4759b-447">Because there may be a delay in sample availability, it is important to always specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="4759b-448">Trwa około minuty dla przykładów propagację za pośrednictwem systemu, więc przykłady w zakresie `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` mogą nie być dostępne.</span><span class="sxs-lookup"><span data-stu-id="4759b-448">It takes approximately one minute for samples to propagate through the system, so samples in the range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="4759b-449">Ponownie, można użyć parametru procent `GetSample()` wymusić wymaganie procent określonej próbki.</span><span class="sxs-lookup"><span data-stu-id="4759b-449">Again, you can use the percentage parameter of `GetSample()` to force a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4759b-450">Firma Microsoft **zdecydowanie zaleca się** że **uniknąć jednostki uzależnionej *tylko* na `GetSample(1)` w formułach skalowania automatycznego**.</span><span class="sxs-lookup"><span data-stu-id="4759b-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="4759b-451">Jest to spowodowane `GetSample(1)` zasadniczo mówi, aby usługa partia zadań "Mnie ostatniej próbki, należy podać ma, niezależnie od tego, jak dawno temu pobraniu."</span><span class="sxs-lookup"><span data-stu-id="4759b-451">This is because `GetSample(1)` essentially says to the Batch service, "Give me the last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="4759b-452">Ponieważ jest tylko jeden przykład i mogą być starsze próbki, nie może być przedstawiciel większy obraz ostatnie zadanie lub stan zasobów.</span><span class="sxs-lookup"><span data-stu-id="4759b-452">Since it is only a single sample, and it may be an older sample, it may not be representative of the larger picture of recent task or resource state.</span></span> <span data-ttu-id="4759b-453">Jeśli używasz `GetSample(1)`, upewnij się, że jest część instrukcję większy i nie zależy od formuły punktu danych tylko.</span><span class="sxs-lookup"><span data-stu-id="4759b-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not the only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="4759b-454">Metryki</span><span class="sxs-lookup"><span data-stu-id="4759b-454">Metrics</span></span>
<span data-ttu-id="4759b-455">Podczas definiowania formuły, można użyć zarówno zasobów, jak i zadanie metryki.</span><span class="sxs-lookup"><span data-stu-id="4759b-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="4759b-456">Dostosuj jest docelowy Liczba dedykowanych węzłów w puli na podstawie danych metryki uzyskać i oceny.</span><span class="sxs-lookup"><span data-stu-id="4759b-456">You adjust the target number of dedicated nodes in the pool based on the metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="4759b-457">Zobacz [zmienne](#variables) sekcji powyżej, aby uzyskać więcej informacji na wszystkie metryki.</span><span class="sxs-lookup"><span data-stu-id="4759b-457">See the [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="4759b-458">Metryka</span><span class="sxs-lookup"><span data-stu-id="4759b-458">Metric</span></span></th>
    <th><span data-ttu-id="4759b-459">Opis</span><span class="sxs-lookup"><span data-stu-id="4759b-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="4759b-460"><b>Zasób</b></span><span class="sxs-lookup"><span data-stu-id="4759b-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="4759b-461">Metryki zasobów są oparte na procesor CPU, przepustowości, użycie pamięci przez węzły obliczeniowe i liczby węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-461">Resource metrics are based on the CPU, the bandwidth, the memory usage of compute nodes, and the number of nodes.</span></span></p>
        <p> <span data-ttu-id="4759b-462">Te zmienne zdefiniowane usługi są przydatne do korekt na podstawie liczby węzłów:</span><span class="sxs-lookup"><span data-stu-id="4759b-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="4759b-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="4759b-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="4759b-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="4759b-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="4759b-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="4759b-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="4759b-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="4759b-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="4759b-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="4759b-469">Te zmienne zdefiniowane usługi są przydatne do korekt na podstawie użycia zasobów węzła:</span><span class="sxs-lookup"><span data-stu-id="4759b-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="4759b-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="4759b-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="4759b-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="4759b-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="4759b-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="4759b-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="4759b-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="4759b-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="4759b-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="4759b-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="4759b-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="4759b-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="4759b-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="4759b-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="4759b-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="4759b-480"><b>Zadanie podrzędne</b></span><span class="sxs-lookup"><span data-stu-id="4759b-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="4759b-481">Metryki zadań opartych na stan zadania, takie jak aktywny, oczekujące i zakończone.</span><span class="sxs-lookup"><span data-stu-id="4759b-481">Task metrics are based on the status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="4759b-482">Następujące zmienne zdefiniowane przez usługi są przydatne, aby wprowadzić zmiany rozmiaru puli, w oparciu metryki zadań:</span><span class="sxs-lookup"><span data-stu-id="4759b-482">The following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="4759b-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="4759b-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="4759b-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="4759b-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="4759b-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="4759b-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="4759b-488">Pisanie formuły skalowania automatycznego</span><span class="sxs-lookup"><span data-stu-id="4759b-488">Write an autoscale formula</span></span>
<span data-ttu-id="4759b-489">Tworzenie formułą automatycznego skalowania przez tworzenie instrukcji, które używają powyżej składników następnie łączenie tych instrukcji do ukończenia formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-489">You build an autoscale formula by forming statements that use the above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="4759b-490">W tej sekcji utworzymy skalowania automatycznego przykład formuły, które można wykonywać pewne decyzje skalowania rzeczywistych.</span><span class="sxs-lookup"><span data-stu-id="4759b-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="4759b-491">Najpierw zdefiniujmy wymagania dotyczące naszej nowej formuły skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-491">First, let's define the requirements for our new autoscale formula.</span></span> <span data-ttu-id="4759b-492">Formuła następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="4759b-492">The formula should:</span></span>

1. <span data-ttu-id="4759b-493">Jeśli użycie procesora CPU jest wysokie, należy zwiększyć liczbę docelowych węzłów obliczeniowych dedykowanych w puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-493">Increase the target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="4759b-494">Zmniejszyć liczbę docelowych węzłów obliczeniowych dedykowanych w puli, gdy wykorzystanie Procesora jest niskie.</span><span class="sxs-lookup"><span data-stu-id="4759b-494">Decrease the target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="4759b-495">Zawsze należy ograniczyć maksymalna liczba dedykowanych węzłów do 400.</span><span class="sxs-lookup"><span data-stu-id="4759b-495">Always restrict the maximum number of dedicated nodes to 400.</span></span>

<span data-ttu-id="4759b-496">Aby zwiększyć liczbę węzłów podczas wysokiego użycia procesora CPU, zdefiniuj instrukcji, która wypełnia zmiennej zdefiniowanej przez użytkownika (`$totalDedicatedNodes`) z wartością, która jest 110 procent bieżący numer docelowej dedykowanych węzłów, ale tylko wtedy, gdy minimalna średniego użycia procesora CPU podczas ostatnich 10 minut była powyżej 70 procent.</span><span class="sxs-lookup"><span data-stu-id="4759b-496">To increase the number of nodes during high CPU usage, define the statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of the current target number of dedicated nodes, but only if the minimum average CPU usage during the last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="4759b-497">W przeciwnym razie użyj wartości dla bieżąca liczba dedykowanych węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-497">Otherwise, use the value for the current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="4759b-498">Do *zmniejszyć* Liczba dedykowanych węzłów podczas niski użycia procesora CPU, następnej instrukcji w naszym formuły zestawów takie same `$totalDedicatedNodes` zmienną do 90 procent bieżącego docelowa Liczba dedykowanych węzłów, jeśli średniego użycia procesora CPU w ciągu ostatnich 60 minut w obszarze został 20 procent.</span><span class="sxs-lookup"><span data-stu-id="4759b-498">To *decrease* the number of dedicated nodes during low CPU usage, the next statement in our formula sets the same `$totalDedicatedNodes` variable to 90 percent of the current target number of dedicated nodes if the average CPU usage in the past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="4759b-499">W przeciwnym razie użyj bieżącą wartość `$totalDedicatedNodes` który mamy wypełniony w powyższych instrukcji.</span><span class="sxs-lookup"><span data-stu-id="4759b-499">Otherwise, use the current value of `$totalDedicatedNodes` that we populated in the statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="4759b-500">Teraz można ograniczyć liczbę docelowych węzłów obliczeniowych dedykowane do maksymalnie 400:</span><span class="sxs-lookup"><span data-stu-id="4759b-500">Now limit the target number of dedicated compute nodes to a maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="4759b-501">Oto całej formuły:</span><span class="sxs-lookup"><span data-stu-id="4759b-501">Here's the complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="4759b-502">Utwórz pulę włączona funkcja automatycznego skalowania z platformą .NET</span><span class="sxs-lookup"><span data-stu-id="4759b-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="4759b-503">Aby utworzyć pulę z Skalowanie automatyczne włączona w programie .NET, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="4759b-503">To create a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="4759b-504">Utwórz pulę z [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="4759b-504">Create the pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="4759b-505">Ustaw [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) właściwości `true`.</span><span class="sxs-lookup"><span data-stu-id="4759b-505">Set the [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property to `true`.</span></span>
3. <span data-ttu-id="4759b-506">Ustaw [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) właściwości z formułą automatycznego skalowania.</span><span class="sxs-lookup"><span data-stu-id="4759b-506">Set the [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="4759b-507">(Opcjonalnie) Ustaw [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) właściwość (wartość domyślna to 15 minut).</span><span class="sxs-lookup"><span data-stu-id="4759b-507">(Optional) Set the [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="4759b-508">Zatwierdź puli z [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) lub [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="4759b-508">Commit the pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="4759b-509">Poniższy fragment kodu tworzy włączona funkcja automatycznego skalowania puli .NET.</span><span class="sxs-lookup"><span data-stu-id="4759b-509">The following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="4759b-510">Formuła automatycznego skalowania puli ustawia docelowy Liczba dedykowanych węzłów do 5 w poniedziałek i 1 dla każdego dnia, tygodnia.</span><span class="sxs-lookup"><span data-stu-id="4759b-510">The pool's autoscale formula sets the target number of dedicated nodes to 5 on Mondays, and 1 on every other day of the week.</span></span> <span data-ttu-id="4759b-511">[Interwał automatycznego skalowania](#automatic-scaling-interval) jest ustawiona na 30 minut.</span><span class="sxs-lookup"><span data-stu-id="4759b-511">The [automatic scaling interval](#automatic-scaling-interval) is set to 30 minutes.</span></span> <span data-ttu-id="4759b-512">W tym i innych C# fragmenty kodu w tym artykule `myBatchClient` jest prawidłowo zainicjowany wystąpieniem [BatchClient] [ net_batchclient] klasy.</span><span class="sxs-lookup"><span data-stu-id="4759b-512">In this and the other C# snippets in this article, `myBatchClient` is a properly initialized instance of the [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="4759b-513">Podczas tworzenia puli włączone skalowania automatycznego nie należy określać _targetDedicatedComputeNodes_ parametru lub _targetLowPriorityComputeNodes_ parametr w wywołaniu **CreatePool** .</span><span class="sxs-lookup"><span data-stu-id="4759b-513">When you create an autoscale-enabled pool, do not specify the _targetDedicatedComputeNodes_ parameter or the _targetLowPriorityComputeNodes_ parameter on the call to **CreatePool**.</span></span> <span data-ttu-id="4759b-514">Zamiast tego określ **AutoScaleEnabled** i **AutoScaleFormula** właściwości w puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-514">Instead, specify the **AutoScaleEnabled** and **AutoScaleFormula** properties on the pool.</span></span> <span data-ttu-id="4759b-515">Wartości tych właściwości zliczane docelowym każdego typu węzła.</span><span class="sxs-lookup"><span data-stu-id="4759b-515">The values for these properties determine the target number of each type of node.</span></span> <span data-ttu-id="4759b-516">Ponadto do ręcznie zmiany rozmiaru włączona funkcja automatycznego skalowania puli (na przykład z [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), pierwszy **wyłączyć** automatyczne skalowanie na w puli, a następnie zmienić jego rozmiar.</span><span class="sxs-lookup"><span data-stu-id="4759b-516">Also, to manually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on the pool, then resize it.</span></span>
>
>

<span data-ttu-id="4759b-517">Oprócz partiami platformy .NET, można użyć dowolnego z innych [wsadowego zestawów SDK](batch-apis-tools.md#azure-accounts-for-batch-development), [REST partii](https://docs.microsoft.com/rest/api/batchservice/), [poleceń cmdlet programu PowerShell partii](batch-powershell-cmdlets-get-started.md)i [CLI partii](batch-cli-get-started.md) do Konfigurowanie skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-517">In addition to Batch .NET, you can use any of the other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and the [Batch CLI](batch-cli-get-started.md) to configure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="4759b-518">Interwał automatycznego skalowania</span><span class="sxs-lookup"><span data-stu-id="4759b-518">Automatic scaling interval</span></span>
<span data-ttu-id="4759b-519">Domyślnie usługa partia zadań dopasowuje rozmiar puli zgodnie z jego formułą automatycznego skalowania co 15 minut.</span><span class="sxs-lookup"><span data-stu-id="4759b-519">By default, the Batch service adjusts a pool's size according to its autoscale formula every 15 minutes.</span></span> <span data-ttu-id="4759b-520">Interwał ten jest można skonfigurować za pomocą następujących właściwości puli:</span><span class="sxs-lookup"><span data-stu-id="4759b-520">This interval is configurable by using the following pool properties:</span></span>

* <span data-ttu-id="4759b-521">[CloudPool.AutoScaleEvaluationInterval] [ net_cloudpool_autoscaleevalinterval] (wsadowe .NET)</span><span class="sxs-lookup"><span data-stu-id="4759b-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="4759b-522">[autoScaleEvaluationInterval] [ rest_autoscaleinterval] (interfejsu API REST)</span><span class="sxs-lookup"><span data-stu-id="4759b-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="4759b-523">Minimalny interwał to pięć minut, a maksymalna to 168 godzin.</span><span class="sxs-lookup"><span data-stu-id="4759b-523">The minimum interval is five minutes, and the maximum is 168 hours.</span></span> <span data-ttu-id="4759b-524">Jeśli określono interwał poza tym zakresem, usługa partia zadań zwrócą błąd nieprawidłowe żądanie (400).</span><span class="sxs-lookup"><span data-stu-id="4759b-524">If an interval outside this range is specified, the Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="4759b-525">Skalowanie automatyczne aktualnie nie jest przeznaczona do reagowania na zmiany w mniej niż minutę, ale raczej jest przeznaczona do dopasowania rozmiaru puli stopniowo w momencie uruchamiania obciążeń.</span><span class="sxs-lookup"><span data-stu-id="4759b-525">Autoscaling is not currently intended to respond to changes in less than a minute, but rather is intended to adjust the size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="4759b-526">Włącz funkcję skalowania automatycznego na istniejącej puli</span><span class="sxs-lookup"><span data-stu-id="4759b-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="4759b-527">Zestaw SDK każdej partii udostępnia sposób, aby umożliwić skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="4759b-527">Each Batch SDK provides a way to enable autoscaling.</span></span> <span data-ttu-id="4759b-528">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="4759b-528">For example:</span></span>

* <span data-ttu-id="4759b-529">[BatchClient.PoolOperations.EnableAutoScaleAsync] [ net_enableautoscaleasync] (wsadowe .NET)</span><span class="sxs-lookup"><span data-stu-id="4759b-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="4759b-530">[Włącz automatyczne skalowanie w puli] [ rest_enableautoscale] (interfejsu API REST)</span><span class="sxs-lookup"><span data-stu-id="4759b-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="4759b-531">Po włączeniu Skalowanie automatyczne w istniejącej puli pamiętać następujące kwestie:</span><span class="sxs-lookup"><span data-stu-id="4759b-531">When you enable autoscaling on an existing pool, keep in mind the following points:</span></span>

* <span data-ttu-id="4759b-532">Jeśli automatyczne skalowanie jest obecnie wyłączona w puli w przypadku wysyłania żądania, aby umożliwić skalowanie automatyczne, należy określić formułę prawidłowy automatycznego skalowania w przypadku wysyłania żądania.</span><span class="sxs-lookup"><span data-stu-id="4759b-532">If automatic scaling is currently disabled on the pool when you issue the request to enable autoscaling, you must specify a valid autoscale formula when you issue the request.</span></span> <span data-ttu-id="4759b-533">Opcjonalnie można określić interwał oceny skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="4759b-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="4759b-534">Jeśli nie określisz interwał, jest używana wartość domyślna wynosząca 15 minut.</span><span class="sxs-lookup"><span data-stu-id="4759b-534">If you do not specify an interval, the default value of 15 minutes is used.</span></span>
* <span data-ttu-id="4759b-535">Jeśli skalowania automatycznego jest aktualnie włączone w puli, można określić formułą automatycznego skalowania i interwał oceny.</span><span class="sxs-lookup"><span data-stu-id="4759b-535">If autoscale is currently enabled on the pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="4759b-536">Należy określić co najmniej jeden z tych właściwości.</span><span class="sxs-lookup"><span data-stu-id="4759b-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="4759b-537">Jeśli określisz nowy interwał oceny skalowania automatycznego istniejącego harmonogramu szacowania został zatrzymany, a nowy harmonogram jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="4759b-537">If you specify a new autoscale evaluation interval, then the existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="4759b-538">Czas rozpoczęcia nowy harmonogram jest czas, w którym został wystawiony żądania, aby umożliwić skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="4759b-538">The new schedule's start time is the time at which the request to enable autoscaling was issued.</span></span>
  * <span data-ttu-id="4759b-539">W przypadku pominięcia formułą automatycznego skalowania lub interwał oceny, usługa partia zadań będzie później nadal używać bieżącą wartość tego ustawienia.</span><span class="sxs-lookup"><span data-stu-id="4759b-539">If you omit either the autoscale formula or evaluation interval, the Batch service continues to use the current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="4759b-540">Jeśli określono wartości dla *targetDedicatedComputeNodes* lub *targetLowPriorityComputeNodes* parametry **CreatePool** metody podczas tworzenia puli w .NET, lub porównywalny parametrów w innym języku, następnie wartości te są ignorowane podczas szacowania automatycznego skalowania formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-540">If you specified values for the *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of the **CreatePool** method when you created the pool in .NET, or for the comparable parameters in another language, then those values are ignored when the automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="4759b-541">Następujący fragment kodu C# używa [partiami platformy .NET] [ net_api] biblioteki, aby umożliwić skalowanie automatyczne w istniejącej puli:</span><span class="sxs-lookup"><span data-stu-id="4759b-541">This C# code snippet uses the [Batch .NET][net_api] library to enable autoscaling on an existing pool:</span></span>

```csharp
// Define the autoscaling formula. This formula sets the target number of nodes
// to 5 on Mondays, and 1 on every other day of the week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set the autoscale formula on the existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="4759b-542">Aktualizacja formułą automatycznego skalowania</span><span class="sxs-lookup"><span data-stu-id="4759b-542">Update an autoscale formula</span></span>

<span data-ttu-id="4759b-543">Aby zaktualizować formułę w istniejącej puli włączona funkcja automatycznego skalowania, wywołaj operację, aby umożliwić skalowanie automatyczne ponownie, używając nowej formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-543">To update the formula on an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new formula.</span></span> <span data-ttu-id="4759b-544">Na przykład, jeśli już włączone Skalowanie automatyczne `myexistingpool` podczas wykonywania następującego kodu platformy .NET, jego formuły skalowania automatycznego jest zastępowany zawartość `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="4759b-544">For example, if autoscaling is already enabled on `myexistingpool` when the following .NET code is executed, its autoscale formula is replaced with the contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-the-autoscale-interval"></a><span data-ttu-id="4759b-545">Interwał automatycznego skalowania aktualizacji</span><span class="sxs-lookup"><span data-stu-id="4759b-545">Update the autoscale interval</span></span>

<span data-ttu-id="4759b-546">Aby zaktualizować interwał oceny skalowania automatycznego istniejącej puli włączona funkcja automatycznego skalowania, wywołaj operację, aby umożliwić skalowanie automatyczne ponownie, używając nowego interwału.</span><span class="sxs-lookup"><span data-stu-id="4759b-546">To update the autoscale evaluation interval of an existing autoscale-enabled pool, call the operation to enable autoscaling again with the new interval.</span></span> <span data-ttu-id="4759b-547">Na przykład, aby ustawić interwał oceny skalowania automatycznego do 60 minut dla puli, która jest już włączona funkcja automatycznego skalowania w .NET:</span><span class="sxs-lookup"><span data-stu-id="4759b-547">For example, to set the autoscale evaluation interval to 60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="4759b-548">Ocena formułą automatycznego skalowania</span><span class="sxs-lookup"><span data-stu-id="4759b-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="4759b-549">Formuły można obliczyć zanim zostaną one zastosowane do puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-549">You can evaluate a formula before applying it to a pool.</span></span> <span data-ttu-id="4759b-550">W ten sposób można przetestować formuły, aby zobaczyć, jak jego instrukcje oceny jego przydatności przed umieszczeniem formuły w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="4759b-550">In this way, you can test the formula to see how its statements evaluate before you put the formula into production.</span></span>

<span data-ttu-id="4759b-551">Aby ocenić formułą automatycznego skalowania, należy najpierw włączyć Skalowanie automatyczne w puli z prawidłową formułę.</span><span class="sxs-lookup"><span data-stu-id="4759b-551">To evaluate an autoscale formula, you must first enable autoscaling on the pool with a valid formula.</span></span> <span data-ttu-id="4759b-552">Aby przetestować formuły w puli, która nie ma jeszcze włączone Skalowanie automatyczne, należy użyć jednego wiersza formuły `$TargetDedicatedNodes = 0` po pierwszym włączeniu Skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="4759b-552">To test a formula on a pool that doesn't yet have autoscaling enabled, use the one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="4759b-553">Następnie służą do oceny formułę, którą chcesz przetestować jedną z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="4759b-553">Then, use one of the following to evaluate the formula you want to test:</span></span>

* <span data-ttu-id="4759b-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) lub [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="4759b-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="4759b-555">Te metody partiami platformy .NET wymagają identyfikator określający istniejącą pulę, a ciąg zawierający formułą automatycznego skalowania do oceny.</span><span class="sxs-lookup"><span data-stu-id="4759b-555">These Batch .NET methods require the ID of an existing pool and a string containing the autoscale formula to evaluate.</span></span>

* [<span data-ttu-id="4759b-556">Szacowanie formuły skalowania automatycznego</span><span class="sxs-lookup"><span data-stu-id="4759b-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="4759b-557">W tym żądania interfejsu API REST, określ identyfikator puli w identyfikatorze URI i formułą automatycznego skalowania w *autoScaleFormula* elementu treści żądania.</span><span class="sxs-lookup"><span data-stu-id="4759b-557">In this REST API request, specify the pool ID in the URI, and the autoscale formula in the *autoScaleFormula* element of the request body.</span></span> <span data-ttu-id="4759b-558">Odpowiedź operacji zawiera informacje o błędzie, który może być związana z formułą.</span><span class="sxs-lookup"><span data-stu-id="4759b-558">The response of the operation contains any error information that might be related to the formula.</span></span>

<span data-ttu-id="4759b-559">W tym [partiami platformy .NET] [ net_api] fragment kodu, możemy ocenić formułą automatycznego skalowania.</span><span class="sxs-lookup"><span data-stu-id="4759b-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="4759b-560">Jeśli pula nie ma włączone Skalowanie automatyczne, możemy włączyć ją najpierw.</span><span class="sxs-lookup"><span data-stu-id="4759b-560">If the pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference to an existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on the pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula to enable autoscaling on the
    // pool. This formula is valid, but won't resize the pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls to once every 30 seconds.
    // Because we want to apply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here to ensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh the properties of the pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on the pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // The formula to evaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform the autoscale formula evaluation. Note that this code does not
    // actually apply the formula to the pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print the results of the AutoScaleRun.
        // This will display the values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply the formula to the pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output the message associated with the error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="4759b-561">Pomyślne obliczanie formuły pokazano w poniższym przykładzie tworzy wyniki podobne do:</span><span class="sxs-lookup"><span data-stu-id="4759b-561">Successful evaluation of the formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="4759b-562">Uzyskiwanie informacji o uruchomieniu automatycznego skalowania</span><span class="sxs-lookup"><span data-stu-id="4759b-562">Get information about autoscale runs</span></span>

<span data-ttu-id="4759b-563">Aby upewnić się, że formuła działa zgodnie z oczekiwaniami, firma Microsoft zaleca okresowo sprawdzać wyniki przebiegów Skalowanie automatyczne, wykonywanych w Twojej puli partii.</span><span class="sxs-lookup"><span data-stu-id="4759b-563">To ensure that your formula is performing as expected, we recommend that you periodically check the results of the autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="4759b-564">Tak, Pobierz (lub Odśwież) odwołanie do puli i sprawdź, czy właściwości funkcja automatycznego skalowania jego ostatniego uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="4759b-564">To do so, get (or refresh) a reference to the pool, and examine the properties of its last autoscale run.</span></span>

<span data-ttu-id="4759b-565">W partii .NET [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) właściwość ma kilka właściwości, które zawierają informacje o najnowszych automatyczne skalowanie Uruchom wykonywane w puli:</span><span class="sxs-lookup"><span data-stu-id="4759b-565">In Batch .NET, the [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about the latest automatic scaling run performed on the pool:</span></span>

* [<span data-ttu-id="4759b-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="4759b-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="4759b-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="4759b-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="4759b-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="4759b-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="4759b-569">W interfejsie API REST [uzyskać informacje o puli](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) żądania zwraca informacje o puli, która zawiera najnowsze automatyczne skalowanie Uruchom informacji [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) właściwości.</span><span class="sxs-lookup"><span data-stu-id="4759b-569">In the REST API, the [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about the pool, which includes the latest automatic scaling run information in the [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="4759b-570">Poniższy fragment kodu C# korzysta z biblioteki partiami platformy .NET do drukowania informacji o ostatnich Skalowanie automatyczne uruchamianie w puli _myPool_:</span><span class="sxs-lookup"><span data-stu-id="4759b-570">The following C# code snippet uses the Batch .NET library to print information about the last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="4759b-571">Przykładowe dane wyjściowe poprzedniego fragmentu:</span><span class="sxs-lookup"><span data-stu-id="4759b-571">Sample output of the preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="4759b-572">Przykład formuły skalowania automatycznego</span><span class="sxs-lookup"><span data-stu-id="4759b-572">Example autoscale formulas</span></span>
<span data-ttu-id="4759b-573">Oto kilka formuły, które przedstawiono różne sposoby, aby dopasować ilość zasobów obliczeniowych w puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-573">Let's look at a few formulas that show different ways to adjust the amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="4759b-574">Przykład 1: Dopasowania na podstawie czasu</span><span class="sxs-lookup"><span data-stu-id="4759b-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="4759b-575">Załóżmy, że chcesz dostosować rozmiar puli na podstawie dzień tygodnia i godzinę.</span><span class="sxs-lookup"><span data-stu-id="4759b-575">Suppose you want to adjust the pool size based on the day of the week and time of day.</span></span> <span data-ttu-id="4759b-576">W tym przykładzie przedstawiono sposób zwiększenia lub zmniejszenia liczby węzłów w puli odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="4759b-576">This example shows how to increase or decrease the number of nodes in the pool accordingly.</span></span>

<span data-ttu-id="4759b-577">Formuła najpierw pobiera bieżącą godzinę.</span><span class="sxs-lookup"><span data-stu-id="4759b-577">The formula first obtains the current time.</span></span> <span data-ttu-id="4759b-578">Jeśli dzień (1-5), a w godzinach pracy (8 AM do 18: 00), rozmiar puli docelowej wynosi 20 węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-578">If it's a weekday (1-5) and within working hours (8 AM to 6 PM), the target pool size is set to 20 nodes.</span></span> <span data-ttu-id="4759b-579">W przeciwnym razie wartość jest ustawiona na 10 węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-579">Otherwise, it's set to 10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="4759b-580">Przykład 2: Dostosowywanie opartego na zadaniach</span><span class="sxs-lookup"><span data-stu-id="4759b-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="4759b-581">W tym przykładzie rozmiar puli jest uwzględniany w oparciu o liczbę zadań w kolejce.</span><span class="sxs-lookup"><span data-stu-id="4759b-581">In this example, the pool size is adjusted based on the number of tasks in the queue.</span></span> <span data-ttu-id="4759b-582">Zarówno podziały wierszy, jak i komentarze są dozwolone w ciągach formuły.</span><span class="sxs-lookup"><span data-stu-id="4759b-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for the past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use the last sample point,
// otherwise we use the maximum of last sample point and the history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM to pending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// The pool size is capped at 20, if target VM value is more than that, set it
// to 20. This value should be adjusted according to your use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="4759b-583">Przykład 3: Uwzględniająca zadań równoległych</span><span class="sxs-lookup"><span data-stu-id="4759b-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="4759b-584">W tym przykładzie można dostosować do rozmiaru puli na podstawie liczby zadań.</span><span class="sxs-lookup"><span data-stu-id="4759b-584">This example adjusts the pool size based on the number of tasks.</span></span> <span data-ttu-id="4759b-585">W tej formule uwzględnia również [MaxTasksPerComputeNode] [ net_maxtasks] wartość, która została ustawiona dla tej puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-585">This formula also takes into account the [MaxTasksPerComputeNode][net_maxtasks] value that has been set for the pool.</span></span> <span data-ttu-id="4759b-586">Takie rozwiązanie jest przydatne w sytuacjach, w którym [równoległe wykonywanie zadań](batch-parallel-node-tasks.md) został włączony na pulę.</span><span class="sxs-lookup"><span data-stu-id="4759b-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of the samples have been recorded in the past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set the number of nodes to add to one-fourth the number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set to 4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt to grow the number of compute nodes to match the number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep the nodes active until the tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="4759b-587">Przykład 4: Ustawienie rozmiaru puli początkowej</span><span class="sxs-lookup"><span data-stu-id="4759b-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="4759b-588">Ten przykład przedstawia fragment kodu C# formułą automatycznego skalowania, która ustawia rozmiar puli do określonej liczby węzłów w przedziale czasu początkowej.</span><span class="sxs-lookup"><span data-stu-id="4759b-588">This example shows a C# code snippet with an autoscale formula that sets the pool size to a specified number of nodes for an initial time period.</span></span> <span data-ttu-id="4759b-589">A następnie go dopasowuje rozmiar puli, w zależności od liczby uruchomiona i aktywne zadania po upływie okresu czasu początkowej.</span><span class="sxs-lookup"><span data-stu-id="4759b-589">Then it adjusts the pool size based on the number of running and active tasks after the initial time period has elapsed.</span></span>

<span data-ttu-id="4759b-590">Formuła w poniższy fragment kodu:</span><span class="sxs-lookup"><span data-stu-id="4759b-590">The formula in the following code snippet:</span></span>

* <span data-ttu-id="4759b-591">Ustawia rozmiar puli początkowej czterech węzłów.</span><span class="sxs-lookup"><span data-stu-id="4759b-591">Sets the initial pool size to four nodes.</span></span>
* <span data-ttu-id="4759b-592">W ciągu 10 minut życia puli nie Dostosuj rozmiar puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-592">Does not adjust the pool size within the first 10 minutes of the pool's lifecycle.</span></span>
* <span data-ttu-id="4759b-593">Po 10 minutach uzyskuje wartość maksymalna liczba zadań uruchomionych i aktywne w ciągu ostatnich 60 minut.</span><span class="sxs-lookup"><span data-stu-id="4759b-593">After 10 minutes, obtains the max value of the number of running and active tasks within the past 60 minutes.</span></span>
  * <span data-ttu-id="4759b-594">Jeśli obie wartości są równe 0 (co oznacza, że żadne zadania zostały uruchomione lub aktywne w ciągu ostatnich 60 minut), rozmiar puli jest równa 0.</span><span class="sxs-lookup"><span data-stu-id="4759b-594">If both values are 0 (indicating that no tasks were running or active in the last 60 minutes), the pool size is set to 0.</span></span>
  * <span data-ttu-id="4759b-595">Jeśli każda wartość jest większa niż zero, są wprowadzane żadne zmiany.</span><span class="sxs-lookup"><span data-stu-id="4759b-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="4759b-596">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="4759b-596">Next steps</span></span>
* <span data-ttu-id="4759b-597">[Maksymalizowanie użycia zasobów obliczeniowych partii zadań Azure z węzła równoczesnych zadań](batch-parallel-node-tasks.md) zawiera szczegółowe informacje o sposobie można wykonywać wielu zadań jednocześnie w węzłach obliczeniowych w puli.</span><span class="sxs-lookup"><span data-stu-id="4759b-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on the compute nodes in your pool.</span></span> <span data-ttu-id="4759b-598">Oprócz Skalowanie automatyczne ta funkcja może pomóc zmniejszyć czas trwania zadania dla niektórych obciążeń, co pozwala zaoszczędzić pieniądze.</span><span class="sxs-lookup"><span data-stu-id="4759b-598">In addition to autoscaling, this feature may help to lower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="4759b-599">Dla innego wydajności zestawu wspomagającego upewnij się, że aplikacja partii zapytań usługa partia zadań w optymalny sposób.</span><span class="sxs-lookup"><span data-stu-id="4759b-599">For another efficiency booster, ensure that your Batch application queries the Batch service in the most optimal way.</span></span> <span data-ttu-id="4759b-600">Zobacz [wydajnie zapytania usługi partia zadań Azure](batch-efficient-list-queries.md) Aby dowiedzieć się, jak ograniczyć ilość danych w sieci po wykonaniu kwerendy stanu tysięcy węzłów obliczeniowych lub zadania.</span><span class="sxs-lookup"><span data-stu-id="4759b-600">See [Query the Azure Batch service efficiently](batch-efficient-list-queries.md) to learn how to limit the amount of data that crosses the wire when you query the status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
