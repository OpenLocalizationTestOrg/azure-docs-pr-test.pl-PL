---
title: "aaaPersist i zadań output tooAzure magazynu z hello interfejsu API usługi partia zadań Azure | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak tooAzure magazynu wyjściowe toouse interfejsu API usługi partii toopersist partii zadań i zadania."
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="5b481-103">Utrwalanie tooAzure danych zadań magazynu z hello interfejsu API usługi partii</span><span class="sxs-lookup"><span data-stu-id="5b481-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="5b481-104">Począwszy od wersji 2017-05-01, hello interfejsu API partii usługi obsługuje trwałych tooAzure danych wyjściowych magazynu dla zadań i zadania Menedżer zadania, które będą uruchamiane w pulach hello konfiguracji maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5b481-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="5b481-105">Podczas dodawania zadania jako miejsce docelowe danych wyjściowych zadania hello hello można określić kontener w usłudze Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5b481-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="5b481-106">Witaj, usługa partia zadań, a następnie zapisuje kontenera toothat żadnych danych wyjściowych danych po zakończeniu zadania hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="5b481-107">Zaletą toousing hello wyjście zadań toopersist interfejsu API usługi jest niepotrzebne aplikacji hello toomodify hello zadania wsadowego jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="5b481-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="5b481-108">Zamiast tego z aplikacji klienckiej tooyour kilka prostych zmian, można ją utrwalić dane wyjściowe zadania hello z kodem hello, która tworzy zadanie hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="5b481-109">Kiedy używać danych wyjściowych zadania toopersist hello interfejsu API usługi partii?</span><span class="sxs-lookup"><span data-stu-id="5b481-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="5b481-110">Partia zadań Azure zawiera więcej niż jednym ze sposobów toopersist dane wyjściowe zadania.</span><span class="sxs-lookup"><span data-stu-id="5b481-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="5b481-111">Używanie hello interfejsu API usługi partii jest to wygodny podejście, które są najlepiej nadaje się toothese scenariusze:</span><span class="sxs-lookup"><span data-stu-id="5b481-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="5b481-112">Dane wyjściowe zadania toopersist kodu toowrite z mają w aplikacji klienta, bez modyfikowania aplikacji hello zadań jest uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="5b481-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="5b481-113">Chcesz, aby dane wyjściowe toopersist partii zadań i zadania Menedżer zadania w pulach utworzone za pomocą hello konfiguracji maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5b481-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="5b481-114">Ma toopersist dane wyjściowe tooan usługi Azure Storage kontenera o nazwie dowolnego.</span><span class="sxs-lookup"><span data-stu-id="5b481-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="5b481-115">Ma toopersist dane wyjściowe tooan kontenera magazynu Azure o nazwie zgodnie z toohello [standard konwencje pliku wsadowego](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="5b481-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="5b481-116">Jeśli scenariusz różni się od wymienione powyżej, może być konieczne tooconsider inny sposób.</span><span class="sxs-lookup"><span data-stu-id="5b481-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="5b481-117">Na przykład interfejsu API usługi partii hello aktualnie nie obsługuje przesyłania strumieniowego tooAzure dane wyjściowe magazynu podczas wykonywania zadania hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="5b481-118">dane wyjściowe toostream, należy rozważyć użycie biblioteki konwencje pliku wsadowego hello, dostępna dla platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="5b481-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="5b481-119">W przypadku języków musisz tooimplement własne rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="5b481-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="5b481-120">Aby uzyskać więcej informacji dotyczących innych opcji trwałych danych wyjściowych zadania, zobacz [utrwalanie i zadań output tooAzure magazynu](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="5b481-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="5b481-121">Tworzenie kontenera w usłudze Azure Storage</span><span class="sxs-lookup"><span data-stu-id="5b481-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="5b481-122">zadanie toopersist output tooAzure magazynu, musisz toocreate kontener, który służy jako docelowy hello plików wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="5b481-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="5b481-123">Tworzenie kontenera hello, najlepiej uruchomienia zadania, aby przesłać zadanie.</span><span class="sxs-lookup"><span data-stu-id="5b481-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="5b481-124">kontener hello toocreate, użyj hello odpowiedniej biblioteki klienta magazynu Azure lub zestawu SDK.</span><span class="sxs-lookup"><span data-stu-id="5b481-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="5b481-125">Aby uzyskać więcej informacji na temat interfejsy API usługi Azure Storage, zobacz hello [dokumentację usługi Azure Storage](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="5b481-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="5b481-126">Na przykład podczas pisania aplikacji w języku C#, użyj hello [biblioteki klienta usługi Azure Storage dla platformy .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="5b481-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="5b481-127">powitania po przykładzie pokazano, jak toocreate kontener:</span><span class="sxs-lookup"><span data-stu-id="5b481-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="5b481-128">Uzyskiwanie sygnatury dostępu współdzielonego dla kontenera hello</span><span class="sxs-lookup"><span data-stu-id="5b481-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="5b481-129">Po utworzeniu kontenera hello uzyskiwanie sygnatury dostępu współdzielonego (SAS), z kontenerem toohello dostęp do zapisu.</span><span class="sxs-lookup"><span data-stu-id="5b481-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="5b481-130">Sygnatury dostępu Współdzielonego zapewnia dostęp delegowany toohello kontener.</span><span class="sxs-lookup"><span data-stu-id="5b481-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="5b481-131">Witaj SAS udziela dostępu z określonego zestawu uprawnień i w określonym przedziale czasu.</span><span class="sxs-lookup"><span data-stu-id="5b481-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="5b481-132">Usługa partia zadań Hello musi SAS z kontenerem toohello dane wyjściowe zadania. toowrite uprawnień zapisu.</span><span class="sxs-lookup"><span data-stu-id="5b481-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="5b481-133">Aby uzyskać więcej informacji na temat sygnatury dostępu Współdzielonego, zobacz [używanie sygnatury dostępu współdzielonego \(SAS\) w usłudze Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="5b481-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="5b481-134">Po wyświetleniu okna sygnatury dostępu Współdzielonego przy użyciu hello interfejsy API usługi Azure Storage, hello interfejsu API zwraca ciąg tokenu sygnatury dostępu Współdzielonego.</span><span class="sxs-lookup"><span data-stu-id="5b481-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="5b481-135">Ten ciąg tokenu zawiera wszystkie parametry hello SAS, w tym uprawnienia hello i interwał powitania za pośrednictwem których hello SAS jest prawidłowy.</span><span class="sxs-lookup"><span data-stu-id="5b481-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="5b481-136">toouse hello SAS tooaccess kontenera w magazynie Azure, należy tooappend hello SAS ciąg tokenu toohello identyfikator URI zasobu.</span><span class="sxs-lookup"><span data-stu-id="5b481-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="5b481-137">zasób Hello identyfikatora URI, wraz z hello dołączany tokenu sygnatury dostępu Współdzielonego, zapewnia uwierzytelniony dostęp tooAzure magazynu.</span><span class="sxs-lookup"><span data-stu-id="5b481-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="5b481-138">Witaj poniższy przykład pokazuje, jak ciąg hello kontenera tokenu tooget SAS tylko do zapisu, a następnie dołącza hello SAS toohello kontenera identyfikatora URI:</span><span class="sxs-lookup"><span data-stu-id="5b481-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="5b481-139">Określ plików wyjściowych dla danych wyjściowych zadania</span><span class="sxs-lookup"><span data-stu-id="5b481-139">Specify output files for task output</span></span>

<span data-ttu-id="5b481-140">pliki wyjściowe toospecify zadania, utworzyć kolekcję [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) obiekty i przypisać je toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) właściwości po utworzeniu zadania hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="5b481-141">Witaj poniższy przykład kodu .NET tworzy zadanie, które zapisuje liczb losowych tooa plik o nazwie `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="5b481-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="5b481-142">przykład Witaj tworzy plik wyjściowy do `output.txt` toobe zapisywane toohello kontenera.</span><span class="sxs-lookup"><span data-stu-id="5b481-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="5b481-143">przykład Witaj tworzy także plików wyjściowych dla wszystkie pliki dziennika, które jest zgodny z wzorcem pliku hello `std*.txt` (_np._, `stdout.txt` i `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="5b481-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="5b481-144">adresu URL kontenera Hello wymaga hello sygnatury dostępu Współdzielonego, który został utworzony wcześniej hello kontenera.</span><span class="sxs-lookup"><span data-stu-id="5b481-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="5b481-145">Witaj usługa partia zadań używa hello SAS tooauthenticate dostępu toohello kontenera:</span><span class="sxs-lookup"><span data-stu-id="5b481-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="5b481-146">Określ wzorzec pliku do dopasowania</span><span class="sxs-lookup"><span data-stu-id="5b481-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="5b481-147">Po określeniu pliku wyjściowego, można użyć hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) toospecify właściwości wzorzec pliku do dopasowania.</span><span class="sxs-lookup"><span data-stu-id="5b481-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="5b481-148">wzorzec pliku Hello zgadzają zero pliki, pojedynczego pliku lub zestawu plików, które są tworzone przez zadanie hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="5b481-149">Hello **FilePattern** właściwość obsługuje standardowe plików symboli wieloznacznych `*` (dla innych niż cykliczne zgodna) i `**` (dla cyklicznego zgodna).</span><span class="sxs-lookup"><span data-stu-id="5b481-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="5b481-150">Na przykład w powyższym przykładowym kodzie hello określa toomatch wzorzec pliku hello `std*.txt` lokalizacji:</span><span class="sxs-lookup"><span data-stu-id="5b481-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="5b481-151">tooupload jednego pliku, określ wzorzec pliku bez symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="5b481-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="5b481-152">Na przykład powyższym przykładowym kodzie hello określa hello pliku wzorca toomatch `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="5b481-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="5b481-153">Określ warunek przekazywania</span><span class="sxs-lookup"><span data-stu-id="5b481-153">Specify an upload condition</span></span>

<span data-ttu-id="5b481-154">Witaj [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) właściwości zezwala na przekazywanie warunkowego plików wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="5b481-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="5b481-155">Typowy scenariusz obejmuje tooupload jeden zestaw plików w przypadku pomyślnego zakończenia zadania hello i inny zestaw plików, jeśli działanie nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="5b481-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="5b481-156">Na przykład możesz plików pełnego dziennika tooupload tylko wtedy, gdy hello zadań kończy się niepowodzeniem i kończy działanie z kodem zakończenia różną od zera.</span><span class="sxs-lookup"><span data-stu-id="5b481-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="5b481-157">Podobnie można plików wyników tooupload tylko wtedy, gdy zadanie hello powiedzie się, jak te pliki mogą być brakujące lub niekompletne, jeśli zadanie hello nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="5b481-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="5b481-158">Witaj powyższy kod przykładowy ustawia hello **UploadCondition** właściwości zbyt**TaskCompletion**.</span><span class="sxs-lookup"><span data-stu-id="5b481-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="5b481-159">To ustawienie określa, czy plik hello jest toobe przekazany po zakończeniu zadania hello, niezależnie od wartości hello hello kodu zakończenia.</span><span class="sxs-lookup"><span data-stu-id="5b481-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="5b481-160">W przypadku innych ustawień, zobacz hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) wyliczenia.</span><span class="sxs-lookup"><span data-stu-id="5b481-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="5b481-161">Pliki z hello odróżniania samej nazwie</span><span class="sxs-lookup"><span data-stu-id="5b481-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="5b481-162">Witaj zadań w ramach zadania może tworzyć pliki, których hello tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="5b481-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="5b481-163">Na przykład `stdout.txt` i `stderr.txt` są tworzone dla każdego zadania w ramach zadania.</span><span class="sxs-lookup"><span data-stu-id="5b481-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="5b481-164">Ponieważ każde zadanie jest uruchamiane w kontekście jego własnej, pliki te nie powodują konflikt w systemie plików hello węzła.</span><span class="sxs-lookup"><span data-stu-id="5b481-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="5b481-165">Jednak podczas przekazywania plików z wielu zadań tooa udostępnionego kontenera należy toodisambiguate pliki z hello tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="5b481-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="5b481-166">Witaj [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) właściwość określa hello docelowego obiektu blob lub katalog wirtualny dla plików wyjściowych.</span><span class="sxs-lookup"><span data-stu-id="5b481-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="5b481-167">Można użyć hello **ścieżki** właściwości tooname hello blob lub katalogu wirtualnego w taki sposób, że dane wyjściowe pliki z hello jednoznacznie noszą tej samej nazwy w usłudze Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5b481-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="5b481-168">Za pomocą Identyfikatora zadania hello w ścieżce hello jest tooensure dobrze unikatowe nazwy i łatwo zidentyfikować plików.</span><span class="sxs-lookup"><span data-stu-id="5b481-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="5b481-169">Jeśli hello **FilePattern** właściwość ma wartość wyrażenia z symbolami wieloznacznymi tooa, a następnie wszystkie pliki, które jest zgodny z wzorcem hello są określony przez hello katalog wirtualny przekazane toohello **ścieżki** właściwości.</span><span class="sxs-lookup"><span data-stu-id="5b481-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="5b481-170">Na przykład, jeśli hello kontener jest `mycontainer`, zadanie hello jest identyfikator `mytask`, i wzorzec pliku hello jest `..\std*.txt`, następnie hello bezwzględną pliki wyjściowe toohello identyfikatorów URI w usłudze Azure Storage będą wyglądać podobnie do:</span><span class="sxs-lookup"><span data-stu-id="5b481-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="5b481-171">Jeśli hello **FilePattern** właściwość toomatch zestaw jedna nazwa pliku, co oznacza nie zawiera żadnych symboli wieloznacznych, następnie hello wartość hello **ścieżki** właściwość określa hello obiektów blob w pełni kwalifikowana nazwa .</span><span class="sxs-lookup"><span data-stu-id="5b481-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="5b481-172">Jeśli przewidujesz konflikty nazw z jednego pliku z wielu zadań, następnie wprowadzić nazwę katalogu wirtualnego hello hello jako część toodisambiguate nazwę pliku hello tych plików.</span><span class="sxs-lookup"><span data-stu-id="5b481-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="5b481-173">Na przykład zestaw hello **ścieżki** właściwości tooinclude hello zadania o identyfikatorze, hello znak ogranicznika (zazwyczaj ukośnikiem) i nazwa pliku hello:</span><span class="sxs-lookup"><span data-stu-id="5b481-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="5b481-174">Hello bezwzględny identyfikator URI toohello plików wyjściowych dla zestawu zadań będą wyglądać podobnie do:</span><span class="sxs-lookup"><span data-stu-id="5b481-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="5b481-175">Aby uzyskać więcej informacji na temat katalogów wirtualnych w usłudze Azure Storage, zobacz [listy hello BLOB w kontenerze](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="5b481-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="5b481-176">Diagnozowanie błędów przekazywania plików</span><span class="sxs-lookup"><span data-stu-id="5b481-176">Diagnose file upload errors</span></span>

<span data-ttu-id="5b481-177">Jeśli przekazywanie danych wyjściowych pliki tooAzure magazynu kończy się niepowodzeniem, a następnie zadanie hello przenosi toohello **Ukończono** stanu i hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) właściwość jest ustawiona.</span><span class="sxs-lookup"><span data-stu-id="5b481-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="5b481-178">Sprawdź hello **FailureInformation** toodetermine właściwości jakie błąd.</span><span class="sxs-lookup"><span data-stu-id="5b481-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="5b481-179">Na przykład w tym miejscu jest błąd występujący podczas przekazywania pliku, jeśli nie można odnaleźć kontenera hello:</span><span class="sxs-lookup"><span data-stu-id="5b481-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="5b481-180">Na każdym przekazywania pliku wsadowego zapisuje dziennika dwa pliki toohello węźle obliczeń, `fileuploadout.txt` i `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="5b481-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="5b481-181">Możesz przejrzeć te pliki dziennika toolearn więcej informacji na temat określonego błędu.</span><span class="sxs-lookup"><span data-stu-id="5b481-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="5b481-182">W przypadkach, gdy przekazywania pliku hello nigdy nie podjęto, na przykład ponieważ nie można uruchomić samo zadanie hello następnie te pliki dziennika nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="5b481-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="5b481-183">Diagnozowanie wydajność przekazywania pliku</span><span class="sxs-lookup"><span data-stu-id="5b481-183">Diagnose file upload performance</span></span>

<span data-ttu-id="5b481-184">Witaj `fileuploadout.txt` plików dzienników postępu przekazywania.</span><span class="sxs-lookup"><span data-stu-id="5b481-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="5b481-185">Można sprawdzić toolearn tego pliku, który trwa więcej informacji na temat czas przekazywania pliku.</span><span class="sxs-lookup"><span data-stu-id="5b481-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="5b481-186">Należy pamiętać, że istnieje wiele czynników tooupload wydajności, w tym rozmiar hello hello węzła, innych działań w węźle hello w czasie hello przekazywania hello kontenera docelowego hello w hello są liczbę węzłów w tym samym regionie co hello puli partii, przekazywanie toohello konta magazynu na powitania sam czas i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="5b481-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="5b481-187">Interfejs API usługi partii hello za pomocą hello standardowych konwencji pliku wsadowego</span><span class="sxs-lookup"><span data-stu-id="5b481-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="5b481-188">Można utrwalić danych wyjściowych zadania z hello interfejsu API partii usługi, należy określić nazwę użytkownika docelowy kontener i obiektów blob, jednak chcesz.</span><span class="sxs-lookup"><span data-stu-id="5b481-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="5b481-189">Możesz również tooname je zgodnie z toohello [standard konwencje pliku wsadowego](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="5b481-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="5b481-190">standard konwencje plików Hello określa nazwy hello hello docelowy kontener i obiektów blob w usłudze Azure Storage dla pliku wyjściowego danego na podstawie nazw hello hello zadań i zadań.</span><span class="sxs-lookup"><span data-stu-id="5b481-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="5b481-191">Jeśli należy używać hello konwencje plików standard nazewnictwa plików wyjściowych, a następnie Twoje pliki wyjściowe są dostępne do wyświetlenia w hello [portalu Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="5b481-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="5b481-192">Jeśli tworzysz w języku C#, można użyć metody hello wbudowane hello [biblioteki konwencje pliku wsadowego dla platformy .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="5b481-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="5b481-193">Ta biblioteka tworzy hello poprawnie o nazwie kontenerów i obiektów blob ścieżki dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="5b481-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="5b481-194">Na przykład można wywołać hello interfejsu API tooget hello poprawną nazwę kontenera hello, na podstawie nazwy zadania hello:</span><span class="sxs-lookup"><span data-stu-id="5b481-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="5b481-195">Można użyć hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) tooreturn metody adres URL sygnatury dostępu Współdzielonego dostępu współdzielonego, który jest używany toowrite toohello kontenera.</span><span class="sxs-lookup"><span data-stu-id="5b481-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="5b481-196">Można następnie przekazać ten toohello SAS [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) konstruktora.</span><span class="sxs-lookup"><span data-stu-id="5b481-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="5b481-197">Jeśli tworzysz w języku innym niż C#, konieczne będzie tooimplement hello konwencje plików standard samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="5b481-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="5b481-198">Przykład kodu</span><span class="sxs-lookup"><span data-stu-id="5b481-198">Code sample</span></span>

<span data-ttu-id="5b481-199">Witaj [PersistOutputs] [ github_persistoutputs] przykładowy projekt jest jednym z hello [przykłady kodu partii zadań Azure] [ github_samples] w witrynie GitHub.</span><span class="sxs-lookup"><span data-stu-id="5b481-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="5b481-200">To rozwiązanie Visual Studio pokazano, jak biblioteki klienta toouse hello partii zadań dla zadania toopersist .NET output toodurable magazynu.</span><span class="sxs-lookup"><span data-stu-id="5b481-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="5b481-201">Witaj toorun przykładowe, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="5b481-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="5b481-202">Witaj Otwórz projekt w **programu Visual Studio 2015 lub nowsza**.</span><span class="sxs-lookup"><span data-stu-id="5b481-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="5b481-203">Dodaj wsadowego i magazynowania **poświadczenia konta** za**AccountSettings.settings** w projekcie Microsoft.Azure.Batch.Samples.Common hello.</span><span class="sxs-lookup"><span data-stu-id="5b481-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="5b481-204">**Tworzenie** (ale nie jest uruchomiony) hello rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="5b481-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="5b481-205">Jeśli zostanie wyświetlony monit, należy przywrócić wszystkie pakiety NuGet.</span><span class="sxs-lookup"><span data-stu-id="5b481-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="5b481-206">Użyj hello Azure portalu tooupload [pakiet aplikacji](batch-application-packages.md) dla **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="5b481-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="5b481-207">Zawierają hello `PersistOutputsTask.exe` i jego zestawów zależnych hello zip pakietu, identyfikator aplikacji hello zestawu zbyt wersja pakietu "PersistOutputsTask" i aplikacji hello zbyt "1.0".</span><span class="sxs-lookup"><span data-stu-id="5b481-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="5b481-208">**Uruchom** (Uruchom) hello **PersistOutputs** projektu.</span><span class="sxs-lookup"><span data-stu-id="5b481-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="5b481-209">Gdy zostanie wyświetlony monit o toochoose hello trwałości technologii toouse dla uruchomionego hello próbki, wprowadź **2** toorun hello próbki, przy użyciu danych wyjściowych zadania toopersist hello interfejsu API usługi partii.</span><span class="sxs-lookup"><span data-stu-id="5b481-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="5b481-210">W razie potrzeby próbki hello ponownie uruchomić, wprowadzania **3** toopersist wyjście z interfejsu API usługi partii hello i tooname hello i kontener obiektów blob ścieżki docelowej zgodnie z toohello konwencje plików standardowych.</span><span class="sxs-lookup"><span data-stu-id="5b481-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5b481-211">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="5b481-211">Next steps</span></span>

- <span data-ttu-id="5b481-212">Aby uzyskać więcej informacji na trwałych danych wyjściowych zadania z hello konwencje plików biblioteki dla platformy .NET, zobacz [utrwalić i zadań tooAzure danych magazynu z biblioteki konwencje pliku wsadowego hello .NET toopersist ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="5b481-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="5b481-213">Aby uzyskać informacje na inne podejścia trwałych danych wyjściowych w partii zadań Azure, zobacz [utrwalanie i zadań output tooAzure magazynu](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="5b481-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
