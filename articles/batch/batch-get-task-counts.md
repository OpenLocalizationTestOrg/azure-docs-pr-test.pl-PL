---
title: "Monitorowanie postępu zadania przez zliczanie zadań według stanu - partii zadań Azure | Dokumentacja firmy Microsoft"
description: "Monitorować postęp zadania, wywołując operację Get liczby zadań, aby liczba zadań dla zadania. Możesz uzyskać liczby aktywnych, uruchomione i zakończonych zadań i zadań, które zakończyło się pomyślnie lub nie powiodło się."
services: batch
author: tamram
manager: timlt
ms.service: batch
ms.topic: article
ms.date: 08/02/2017
ms.author: tamram
ms.openlocfilehash: ceff59d7063b60a1344a47489d3d73e0e8ee07df
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="count-tasks-by-state-to-monitor-a-jobs-progress-preview"></a><span data-ttu-id="faef6-104">Liczba zadań według stanu, aby monitorować postęp zadania (wersja zapoznawcza)</span><span class="sxs-lookup"><span data-stu-id="faef6-104">Count tasks by state to monitor a job's progress (Preview)</span></span>

<span data-ttu-id="faef6-105">Partia zadań Azure umożliwia wydajny sposób, aby monitorować postęp zadania podczas jego wykonywania swoich zadań.</span><span class="sxs-lookup"><span data-stu-id="faef6-105">Azure Batch provides an efficient way to monitor the progress of a job as it runs its tasks.</span></span> <span data-ttu-id="faef6-106">Możesz wywołać [pobrać liczby zadań] [ rest_get_task_counts] operację, aby dowiedzieć się, jak wielu zadań, które są w stanie active, uruchomione lub zostało zakończone i ma liczbę powodzeniem lub niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="faef6-106">You can call the [Get Task Counts][rest_get_task_counts] operation to find out how many tasks are in an active, running, or completed state, and how many have succeeded or failed.</span></span> <span data-ttu-id="faef6-107">Przez liczenie zadania w każdym stanie, łatwiej można wyświetlić postęp zadania dla użytkownika lub wykrywania nieoczekiwane opóźnienia lub błędy, które mogą wpłynąć na zadania.</span><span class="sxs-lookup"><span data-stu-id="faef6-107">By counting the number of tasks in each state, you can more easily display the job's progress to a user, or detect unexpected delays or failures that may affect the job.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="faef6-108">Operacja Get liczby zadań jest obecnie w wersji zapoznawczej i nie jest jeszcze dostępna w Azure dla instytucji rządowych, chińskiej wersji platformy Azure i platformy Azure w Niemczech.</span><span class="sxs-lookup"><span data-stu-id="faef6-108">The Get Task Counts operation is currently in preview, and is not yet available in Azure Government, Azure China, and Azure Germany.</span></span> 
>
>

## <a name="how-tasks-are-counted"></a><span data-ttu-id="faef6-109">Jak zliczane są zadania</span><span class="sxs-lookup"><span data-stu-id="faef6-109">How tasks are counted</span></span>

<span data-ttu-id="faef6-110">Operacja Get liczby zadań liczby zadań według stanu, w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="faef6-110">The Get Task Counts operation counts tasks by state, as follows:</span></span>

- <span data-ttu-id="faef6-111">Zadanie jest traktowane jako **active** gdy jest w kolejce i możliwość uruchamiania, ale nie jest aktualnie przypisany do węzła obliczeń.</span><span class="sxs-lookup"><span data-stu-id="faef6-111">A task is counted as **active** when it is queued and able to run, but is not currently assigned to a compute node.</span></span> <span data-ttu-id="faef6-112">Zadanie również jest traktowane jako **active** Jeśli jest on zależny od zadaniem nadrzędnym, które nie zostało jeszcze zakończone.</span><span class="sxs-lookup"><span data-stu-id="faef6-112">A task is also counted as **active** if it is dependent on a parent task that has not yet completed.</span></span> <span data-ttu-id="faef6-113">Aby uzyskać więcej informacji o zależnościach zadań, zobacz [utworzyć zależności zadań do wykonywania zadań, które są zależne od innych zadań](batch-task-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="faef6-113">For more information on task dependencies, see [Create task dependencies to run tasks that depend on other tasks](batch-task-dependencies.md).</span></span> 
- <span data-ttu-id="faef6-114">Zadanie jest traktowane jako **systemem** po jego przypisany do węzła obliczeń, ale nie zostało jeszcze zakończone.</span><span class="sxs-lookup"><span data-stu-id="faef6-114">A task is counted as **running** when it has been assigned to a compute node, but has not yet completed.</span></span> <span data-ttu-id="faef6-115">Zadanie jest traktowane jako **systemem** po jej stan to `preparing` lub `running`, wskazywany przez [uzyskać informacje o zadaniu] [ rest_get_task] operacji.</span><span class="sxs-lookup"><span data-stu-id="faef6-115">A task is counted as **running** when its state is either `preparing` or `running`, as indicated by the [Get information about a task][rest_get_task] operation.</span></span>
- <span data-ttu-id="faef6-116">Zadanie jest traktowane jako **ukończone** gdy nie jest już mogą być uruchamiane.</span><span class="sxs-lookup"><span data-stu-id="faef6-116">A task is counted as **completed** when it is no longer eligible to run.</span></span> <span data-ttu-id="faef6-117">Zadania są liczone jako **ukończone** ma zazwyczaj albo zakończyło się pomyślnie, lub zakończy się niepowodzeniem i również Przekroczono limit ponownych prób.</span><span class="sxs-lookup"><span data-stu-id="faef6-117">A task counted as **completed** has typically either finished successfully, or has finished unsuccessfully and has also exhausted its retry limit.</span></span> 

<span data-ttu-id="faef6-118">Operacja Get liczby zadań udostępnia również ile zadań ma powodzeniem lub niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="faef6-118">The Get Task Counts operation also reports how many tasks have succeeded or failed.</span></span> <span data-ttu-id="faef6-119">Partii określa, czy zadanie zakończyło się pomyślnie lub nie powiodło się, sprawdzając **wynik** właściwości właściwości [executionInfo] [https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo]:</span><span class="sxs-lookup"><span data-stu-id="faef6-119">Batch determines whether a task has succeeded or failed by checking the **result** property of the [executionInfo][https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task#executionInfo] property:</span></span>

    - <span data-ttu-id="faef6-120">Zadanie jest traktowane jako **zakończyło się pomyślnie** Jeśli wynikiem wykonania zadania jest `success`.</span><span class="sxs-lookup"><span data-stu-id="faef6-120">A task is counted as **succeeded** if the result of task execution is `success`.</span></span>
    - <span data-ttu-id="faef6-121">Zadanie jest traktowane jako **nie powiodło się** Jeśli wynikiem wykonania zadania jest `failure`.</span><span class="sxs-lookup"><span data-stu-id="faef6-121">A task is counted as **failed** if the result of task execution is `failure`.</span></span>

<span data-ttu-id="faef6-122">Aby uzyskać więcej informacji na temat stanów zadań, zobacz [uzyskać informacje o zadaniu][rest_get_task].</span><span class="sxs-lookup"><span data-stu-id="faef6-122">For more information about task states, see [Get information about a task][rest_get_task].</span></span>

<span data-ttu-id="faef6-123">Poniższy przykład kodu .NET pokazano, jak można pobrać liczby zadań według stanu:</span><span class="sxs-lookup"><span data-stu-id="faef6-123">The following .NET code sample shows how to retrieve task counts by state:</span></span> 

```csharp
var taskCounts = await batchClient.JobOperations.GetTaskCountsAsync("job-1");

Console.WriteLine("Task count in active state: {0}", taskCounts.Active);
Console.WriteLine("Task count in preparing or running state: {0}", taskCounts.Running);
Console.WriteLine("Task count in completed state: {0}", taskCounts.Completed);
Console.WriteLine("Succeeded task count: {0}", taskCounts.Succeeded);
Console.WriteLine("Failed task count: {0}", taskCounts.Failed);
Console.WriteLine("ValidationStatus: {0}", taskCounts.ValidationStatus);
```

> [!NOTE]
> <span data-ttu-id="faef6-124">Można użyć podobnego wzorca pozostałej i innych obsługiwanych języków można pobrać liczby zadań dla zadania.</span><span class="sxs-lookup"><span data-stu-id="faef6-124">You can use a similar pattern for REST and other supported languages to get task counts for a job.</span></span> 
> 
> 

## <a name="consistency-checking-for-task-counts"></a><span data-ttu-id="faef6-125">Sprawdzanie liczby zadań spójności</span><span class="sxs-lookup"><span data-stu-id="faef6-125">Consistency checking for task counts</span></span>

<span data-ttu-id="faef6-126">Usługa partia zadań agreguje liczby zadań przez zbieranie danych z wielu części asynchroniczne Rozproszony system.</span><span class="sxs-lookup"><span data-stu-id="faef6-126">The Batch service aggregates task counts by gathering data from multiple parts of an asynchronous distributed system.</span></span> <span data-ttu-id="faef6-127">Aby zapewnić, że liczby zadań są poprawne, partii udostępnia dodatkowe sprawdzanie poprawności stanu liczby, wykonując spójności sprawdza przed wiele składników systemu.</span><span class="sxs-lookup"><span data-stu-id="faef6-127">To ensure that task counts are correct, Batch provides additional validation for state counts by performing consistency checks against multiple components of the system.</span></span> <span data-ttu-id="faef6-128">Wsadowe wykonuje te sprawdzenia spójności tak długo, jak jest krótsza niż 200 000 zadań w zadaniu.</span><span class="sxs-lookup"><span data-stu-id="faef6-128">Batch performs these consistency checks as long as there are fewer than 200,000 tasks in the job.</span></span> <span data-ttu-id="faef6-129">W przypadku mało prawdopodobne, że sprawdzanie spójności znajdzie błędy partii poprawia wynik operacji Get liczby zadań, na podstawie wyników sprawdzania spójności.</span><span class="sxs-lookup"><span data-stu-id="faef6-129">In the unlikely event that the consistency check finds errors, Batch corrects the result of the Get Tasks Counts operation based on the results of the consistency check.</span></span> <span data-ttu-id="faef6-130">Kontrola spójności jest dodatkowy poziom, aby upewnić się, że klienci, którzy polegać na operację Get liczby zadań uzyskać właściwe informacje, które są im niezbędne do ich rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="faef6-130">The consistency check is an extra measure to ensure that customers who rely on the Get Task Counts operation get the right information they need for their solution.</span></span>

<span data-ttu-id="faef6-131">**Stan** właściwość w odpowiedzi wskazuje, czy partii jest wykonywane sprawdzanie spójności.</span><span class="sxs-lookup"><span data-stu-id="faef6-131">The **validationStatus** property in the response indicates whether Batch has performed the consistency check.</span></span> <span data-ttu-id="faef6-132">Jeśli partii nie mógł sprawdzić stan wlicza się rzeczywista stany przechowywanych w systemie, a następnie **stan** właściwość jest ustawiona na `unvalidated`.</span><span class="sxs-lookup"><span data-stu-id="faef6-132">If Batch has not been able to check state counts against the actual states held in the system, then the **validationStatus** property is set to `unvalidated`.</span></span> <span data-ttu-id="faef6-133">Ze względu na wydajność wsadu nie będzie wykonywać sprawdzanie spójności Jeśli zadanie zawiera więcej niż 200 000 zadań, więc **stan** może mieć ustawioną właściwość `unvalidated` w takim przypadku.</span><span class="sxs-lookup"><span data-stu-id="faef6-133">For performance reasons, Batch will not perform the consistency check if the job includes more than 200,000 tasks, so the **validationStatus** property may be set to `unvalidated` in this case.</span></span> <span data-ttu-id="faef6-134">Jednak liczba zadań nie jest zawsze niewłaściwy w takim przypadku nawet utraty bardzo ograniczoną ilość danych jest wysoce nieprawdopodobne.</span><span class="sxs-lookup"><span data-stu-id="faef6-134">However, the task count is not necessarily wrong in this case, as even a very limited data loss is highly unlikely.</span></span> 

<span data-ttu-id="faef6-135">Po zmianie stanu zadania potoku agregacji przetwarza zmiany w ciągu kilku sekund.</span><span class="sxs-lookup"><span data-stu-id="faef6-135">When a task changes state, the aggregation pipeline processes the change within few seconds.</span></span> <span data-ttu-id="faef6-136">Operacja Get liczby zadań odzwierciedla liczby zadań zaktualizowane w tym okresie.</span><span class="sxs-lookup"><span data-stu-id="faef6-136">The Get Task Counts operation reflects the updated task counts within that period.</span></span> <span data-ttu-id="faef6-137">Jednak jeśli potoku agregacji chybień zmianę stanu zadań, następnie tej zmiany nie jest zarejestrowany do czasu następnego przebieg sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="faef6-137">However, if the aggregation pipeline misses a change in a task state, then that change is not registered until the next validation pass.</span></span> <span data-ttu-id="faef6-138">W tym czasie liczby zadań mogą być nieco niedokładne z powodu brakujących zdarzeń, ale są one usunąć na następny przebieg sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="faef6-138">During this time, task counts may be slightly inaccurate due to the missed event, but they are corrected on the next validation pass.</span></span>

## <a name="best-practices-for-counting-a-jobs-tasks"></a><span data-ttu-id="faef6-139">Najlepsze rozwiązania dotyczące inwentaryzacji zadania podrzędne zadania</span><span class="sxs-lookup"><span data-stu-id="faef6-139">Best practices for counting a job's tasks</span></span>

<span data-ttu-id="faef6-140">Podczas wywoływania operacji Get liczby zadań jest najbardziej wydajnym sposobem zwróciło podstawowe liczby zadania według stanu.</span><span class="sxs-lookup"><span data-stu-id="faef6-140">Calling the Get Task Counts operation is the most efficient way to return a basic count of a job's tasks by state.</span></span> <span data-ttu-id="faef6-141">Jeśli używasz wersji usługi partii 2017-06-01.5.1, zaleca się zapisywania lub aktualizowania kod, aby używał pobrać liczby zadań.</span><span class="sxs-lookup"><span data-stu-id="faef6-141">If you are using Batch service version 2017-06-01.5.1, we recommend writing or updating your code to use Get Task Counts.</span></span>

<span data-ttu-id="faef6-142">Operacji Get liczby zadań nie jest starszy niż 2017-06-01.5.1 dostępne w wersjach usługi partii.</span><span class="sxs-lookup"><span data-stu-id="faef6-142">The Get Task Counts operation is not available in Batch service versions earlier than 2017-06-01.5.1.</span></span> <span data-ttu-id="faef6-143">Jeśli używasz starszej wersji usługi użyć kwerendy listy, aby zamiast tego liczba zadań w ramach zadania.</span><span class="sxs-lookup"><span data-stu-id="faef6-143">If you are using an older version of the service, then use a list query to count tasks in a job instead.</span></span> <span data-ttu-id="faef6-144">Aby uzyskać więcej informacji, zobacz [tworzenia zapytań do listy zasobów partii wydajnie](batch-efficient-list-queries.md).</span><span class="sxs-lookup"><span data-stu-id="faef6-144">For more information, see [Create queries to list Batch resources efficiently](batch-efficient-list-queries.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="faef6-145">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="faef6-145">Next steps</span></span>

* <span data-ttu-id="faef6-146">Aby dowiedzieć się więcej o zasadach działania i funkcjach usługi Batch, zobacz temat [Omówienie funkcji usługi Batch](batch-api-basics.md).</span><span class="sxs-lookup"><span data-stu-id="faef6-146">See the [Batch feature overview](batch-api-basics.md) to learn more about Batch service concepts and features.</span></span> <span data-ttu-id="faef6-147">Artykuł zawiera omówienie głównej zasobów usługi partia zadań, takich jak pule, węzły obliczeniowe, zadań i zadań, a zawiera przegląd funkcji usługi.</span><span class="sxs-lookup"><span data-stu-id="faef6-147">The article discusses the primary Batch resources such as pools, compute nodes, jobs, and tasks, and provides an overview of the service's features.</span></span>
* <span data-ttu-id="faef6-148">Poznaj podstawy tworzenia aplikacji wykorzystujących usługę Batch za pomocą biblioteki klienta [Batch .NET](batch-dotnet-get-started.md) lub języka [Python](batch-python-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="faef6-148">Learn the basics of developing a Batch-enabled application using the [Batch .NET client library](batch-dotnet-get-started.md) or [Python](batch-python-tutorial.md).</span></span> <span data-ttu-id="faef6-149">Te artykuły wprowadzające informacje pomocne przy działającą aplikację, która używa usługi partia zadań do wykonania na wielu węzłach obliczeniowych dla obciążenia.</span><span class="sxs-lookup"><span data-stu-id="faef6-149">These introductory articles guide you through a working application that uses the Batch service to execute a workload on multiple compute nodes.</span></span>


[rest_get_task_counts]: https://docs.microsoft.com/rest/api/batchservice/get-the-task-counts-for-a-job
[rest_get_task]: https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-task
[rest_list_tasks]: https://docs.microsoft.com/rest/api/batchservice/list-the-tasks-associated-with-a-job
