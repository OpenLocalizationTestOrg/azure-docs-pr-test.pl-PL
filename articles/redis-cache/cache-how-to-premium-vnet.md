---
title: "aaaConfigure sieci wirtualnej dla podręczna Redis Azure Premium | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak toocreate i zarządzanie nimi obsługi sieci wirtualnej dla swoich wystąpień pamięci podręcznej Redis Azure warstwy Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="b079b-103">W jaki sposób tooconfigure sieci wirtualnej obsługę podręczna Redis Azure Premium</span><span class="sxs-lookup"><span data-stu-id="b079b-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="b079b-104">Pamięć podręczna Redis Azure ma inną pamięci podręcznej oferty, które zapewniają elastyczność w wyborze hello rozmiar pamięci podręcznej i funkcji, łącznie z funkcji warstwy Premium, takich jak klastrowanie, trwałości i obsługi sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="b079b-105">Sieci wirtualnej jest w chmurze hello sieci prywatnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="b079b-106">Po skonfigurowaniu wystąpienia pamięci podręcznej Redis Azure z sieci wirtualnej nie jest publicznie adresowana i jest możliwy tylko z maszyn wirtualnych i aplikacji w obrębie hello sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="b079b-107">W tym artykule opisano, jak sieci wirtualnej tooconfigure obsługują dla wystąpienia pamięci podręcznej Redis Azure premium.</span><span class="sxs-lookup"><span data-stu-id="b079b-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="b079b-108">Pamięć podręczna Redis Azure obsługuje zarówno classic i sieci wirtualnych Menedżera zasobów.</span><span class="sxs-lookup"><span data-stu-id="b079b-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="b079b-109">Aby uzyskać informacji o innych funkcjach pamięci podręcznej premium, zobacz [warstwy pamięci podręcznej Redis Azure Premium toohello wprowadzenie](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="b079b-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="b079b-110">Dlaczego sieci wirtualnej?</span><span class="sxs-lookup"><span data-stu-id="b079b-110">Why VNet?</span></span>
<span data-ttu-id="b079b-111">[Sieć wirtualna platformy Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) wdrożenie zapewnia większe bezpieczeństwo i izolację dla pamięci podręcznej Redis Azure, jak również podsieci, zasad kontroli dostępu i inne funkcje toofurther ograniczyć dostęp.</span><span class="sxs-lookup"><span data-stu-id="b079b-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="b079b-112">Obsługa sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="b079b-112">Virtual network support</span></span>
<span data-ttu-id="b079b-113">Obsługa usługi Virtual Network (VNet) jest skonfigurowany na powitania **nowa pamięć podręczna Redis** bloku podczas tworzenia pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b079b-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="b079b-114">Po wybraniu warstwie cenowej premium można skonfigurować integracji Redis sieci wirtualnej, wybierając sieć wirtualną, która znajduje się w hello tej samej subskrypcji i lokalizacji co pamięć podręczną.</span><span class="sxs-lookup"><span data-stu-id="b079b-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="b079b-115">toouse nowej sieci wirtualnej, utwórz go najpierw wykonać kroki hello w [Utwórz sieć wirtualną przy użyciu portalu Azure hello](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) lub [utworzyć sieć wirtualną (klasyczne) przy użyciu portalu Azure hello](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) , a następnie wróć toohello **Nowa pamięć podręczna Redis** toocreate bloku i skonfigurować pamięć podręczną premium.</span><span class="sxs-lookup"><span data-stu-id="b079b-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="b079b-116">Witaj tooconfigure sieci wirtualnej dla nowej pamięci podręcznej, kliknij przycisk **sieci wirtualnej** na powitania **nowa pamięć podręczna Redis** bloku, a następnie wybierz hello potrzeby sieci wirtualnej z listy rozwijanej hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Sieć wirtualna][redis-cache-vnet]

<span data-ttu-id="b079b-118">Wybierz hello odpowiednie podsieci z hello **podsieci** listy rozwijanej liście, a następnie określ hello potrzeby **statyczny adres IP**.</span><span class="sxs-lookup"><span data-stu-id="b079b-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="b079b-119">Jeśli używasz klasycznego hello sieci wirtualnej **statyczny adres IP** pole jest opcjonalne, a jeśli nie zostanie określona, wybrano jeden z hello wybrane podsieci.</span><span class="sxs-lookup"><span data-stu-id="b079b-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b079b-120">Podczas wdrażania tooa pamięć podręczna Redis Azure Resource Manager sieci wirtualnej, hello pamięci podręcznej musi być w dedykowanym podsieć, która nie zawiera żadnych innych zasobów, z wyjątkiem wystąpienia pamięci podręcznej Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="b079b-121">Toodeploy podejmowana jest próba tooa pamięć podręczna Redis Azure podsieci tooa Menedżera zasobów w sieci wirtualnej, która zawiera inne zasoby, hello wdrożenie nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="b079b-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Sieć wirtualna][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="b079b-123">Azure rezerwuje niektórych adresów IP w każdej podsieci, a nie można użyć tych adresów.</span><span class="sxs-lookup"><span data-stu-id="b079b-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="b079b-124">Witaj imię i nazwisko adresów IP podsieci hello są zastrzeżone dla protokołu zgodność, wraz z trzech więcej adresów używanych na potrzeby usług Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="b079b-125">Aby uzyskać więcej informacji, zobacz [istnieją wszystkie ograniczenia dotyczące używania adresów IP w ramach tych podsieci?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="b079b-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="b079b-126">W przypadku dodawania adresów IP toohello używanych przez infrastrukturę sieci Wirtualnej Azure hello każdy Redis wystąpienia adresów IP używa dwóch podsieci hello na niezależnych i jeden dodatkowy adres IP dla modułu równoważenia obciążenia hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="b079b-127">Pamięć podręczna nieklastrowanych jest uważany za toohave jednego niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="b079b-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="b079b-128">Po utworzeniu pamięci podręcznej hello hello konfiguracji hello sieci wirtualnej można wyświetlić, klikając **sieci wirtualnej** z hello **zasobów menu**.</span><span class="sxs-lookup"><span data-stu-id="b079b-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Sieć wirtualna][redis-cache-vnet-info]

<span data-ttu-id="b079b-130">tooconnect tooyour Azure Redis wystąpienia pamięci podręcznej przy użyciu sieci wirtualnej, określ nazwę hosta hello pamięć podręczną w parametrach połączenia hello, jak pokazano w hello poniższy przykład:</span><span class="sxs-lookup"><span data-stu-id="b079b-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="b079b-131">Sieć wirtualna pamięci podręcznej Azure Redis — często zadawane pytania</span><span class="sxs-lookup"><span data-stu-id="b079b-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="b079b-132">Witaj, następujące listy zawiera zadawane pytania dotyczące skalowania pamięć podręczna Redis Azure hello toocommonly odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="b079b-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="b079b-133">Co to są niektórych typowych problemów błędnej konfiguracji sieci wirtualnych i pamięci podręcznej Redis Azure?</span><span class="sxs-lookup"><span data-stu-id="b079b-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="b079b-134">Jak sprawdzić, czy Moje pamięci podręcznej działa w sieci Wirtualnej?</span><span class="sxs-lookup"><span data-stu-id="b079b-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="b079b-135">Sieci wirtualne można używać z standard lub podstawowa pamięci podręcznej?</span><span class="sxs-lookup"><span data-stu-id="b079b-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="b079b-136">Dlaczego Tworzenie pamięci podręcznej Redis powiedzie w niektórych podsieci, a innych nie?</span><span class="sxs-lookup"><span data-stu-id="b079b-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="b079b-137">Jakie są wymagania dotyczące miejsca na powitania podsieci adresów?</span><span class="sxs-lookup"><span data-stu-id="b079b-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="b079b-138">Wszystkie funkcje pamięci podręcznej działają odnośnie do hostowania pamięci podręcznej w sieci Wirtualnej?</span><span class="sxs-lookup"><span data-stu-id="b079b-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="b079b-139">Co to są niektórych typowych problemów błędnej konfiguracji sieci wirtualnych i pamięci podręcznej Redis Azure?</span><span class="sxs-lookup"><span data-stu-id="b079b-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="b079b-140">Gdy pamięć podręczna Redis Azure znajduje się w sieci wirtualnej, porty hello hello następujące tabele są używane.</span><span class="sxs-lookup"><span data-stu-id="b079b-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="b079b-141">Porty hello w hello następujące tabele są zablokowane, hello pamięci podręcznej mogą nie działać poprawnie.</span><span class="sxs-lookup"><span data-stu-id="b079b-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="b079b-142">Co najmniej jeden z tych portów zablokowane jest posiadanie hello najbardziej typowych konfiguracji problem przy użyciu pamięci podręcznej Redis Azure w sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="b079b-143">Wymagania dotyczące portów wychodzących</span><span class="sxs-lookup"><span data-stu-id="b079b-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="b079b-144">Wymagania dotyczące portów dla ruchu przychodzącego</span><span class="sxs-lookup"><span data-stu-id="b079b-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="b079b-145">Wymagania dotyczące portów wychodzących</span><span class="sxs-lookup"><span data-stu-id="b079b-145">Outbound port requirements</span></span>

<span data-ttu-id="b079b-146">Istnieje siedem wymagań dotyczących portu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="b079b-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="b079b-147">W razie potrzeby, wszystkie toohello połączenia wychodzące przez internet, mogą być wprowadzane za pośrednictwem klienta lokalnego inspekcji urządzenia.</span><span class="sxs-lookup"><span data-stu-id="b079b-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="b079b-148">Trzy porty hello trasy punkty końcowe tooAzure ruchu obsługi usługi Azure Storage i Azure DNS.</span><span class="sxs-lookup"><span data-stu-id="b079b-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="b079b-149">Witaj, pozostałe zakresy portów i komunikacji podsieci wewnętrznej pamięci podręcznej Redis.</span><span class="sxs-lookup"><span data-stu-id="b079b-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="b079b-150">Brak reguł NSG podsieci są niezbędne do komunikacji podsieci wewnętrznej pamięci podręcznej Redis.</span><span class="sxs-lookup"><span data-stu-id="b079b-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="b079b-151">Porty</span><span class="sxs-lookup"><span data-stu-id="b079b-151">Port(s)</span></span> | <span data-ttu-id="b079b-152">Kierunek</span><span class="sxs-lookup"><span data-stu-id="b079b-152">Direction</span></span> | <span data-ttu-id="b079b-153">Protokół transportu</span><span class="sxs-lookup"><span data-stu-id="b079b-153">Transport Protocol</span></span> | <span data-ttu-id="b079b-154">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b079b-154">Purpose</span></span> | <span data-ttu-id="b079b-155">Lokalny adres IP</span><span class="sxs-lookup"><span data-stu-id="b079b-155">Local IP</span></span> | <span data-ttu-id="b079b-156">Zdalny adres IP</span><span class="sxs-lookup"><span data-stu-id="b079b-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="b079b-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="b079b-157">80, 443</span></span> |<span data-ttu-id="b079b-158">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-158">Outbound</span></span> |<span data-ttu-id="b079b-159">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-159">TCP</span></span> |<span data-ttu-id="b079b-160">Redis zależności na platformie Azure magazynu/infrastruktury kluczy publicznych (Internet)</span><span class="sxs-lookup"><span data-stu-id="b079b-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="b079b-161">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="b079b-162">53</span><span class="sxs-lookup"><span data-stu-id="b079b-162">53</span></span> |<span data-ttu-id="b079b-163">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-163">Outbound</span></span> |<span data-ttu-id="b079b-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="b079b-164">TCP/UDP</span></span> |<span data-ttu-id="b079b-165">Redis zależności w systemie DNS (Internet/VNet)</span><span class="sxs-lookup"><span data-stu-id="b079b-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="b079b-166">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="b079b-167">8443</span><span class="sxs-lookup"><span data-stu-id="b079b-167">8443</span></span> |<span data-ttu-id="b079b-168">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-168">Outbound</span></span> |<span data-ttu-id="b079b-169">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-169">TCP</span></span> |<span data-ttu-id="b079b-170">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-170">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-171">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-171">(Redis subnet)</span></span> | <span data-ttu-id="b079b-172">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-172">(Redis subnet)</span></span> |
| <span data-ttu-id="b079b-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="b079b-173">10221-10231</span></span> |<span data-ttu-id="b079b-174">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-174">Outbound</span></span> |<span data-ttu-id="b079b-175">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-175">TCP</span></span> |<span data-ttu-id="b079b-176">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-176">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-177">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-177">(Redis subnet)</span></span> | <span data-ttu-id="b079b-178">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-178">(Redis subnet)</span></span> |
| <span data-ttu-id="b079b-179">20226</span><span class="sxs-lookup"><span data-stu-id="b079b-179">20226</span></span> |<span data-ttu-id="b079b-180">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-180">Outbound</span></span> |<span data-ttu-id="b079b-181">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-181">TCP</span></span> |<span data-ttu-id="b079b-182">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-182">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-183">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-183">(Redis subnet)</span></span> |<span data-ttu-id="b079b-184">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-184">(Redis subnet)</span></span> |
| <span data-ttu-id="b079b-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="b079b-185">13000-13999</span></span> |<span data-ttu-id="b079b-186">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-186">Outbound</span></span> |<span data-ttu-id="b079b-187">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-187">TCP</span></span> |<span data-ttu-id="b079b-188">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-188">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-189">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-189">(Redis subnet)</span></span> |<span data-ttu-id="b079b-190">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-190">(Redis subnet)</span></span> |
| <span data-ttu-id="b079b-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="b079b-191">15000-15999</span></span> |<span data-ttu-id="b079b-192">Wychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-192">Outbound</span></span> |<span data-ttu-id="b079b-193">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-193">TCP</span></span> |<span data-ttu-id="b079b-194">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-194">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-195">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-195">(Redis subnet)</span></span> |<span data-ttu-id="b079b-196">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="b079b-197">Wymagania dotyczące portów dla ruchu przychodzącego</span><span class="sxs-lookup"><span data-stu-id="b079b-197">Inbound port requirements</span></span>

<span data-ttu-id="b079b-198">Ma osiem wymagań zakresu portów przychodzących.</span><span class="sxs-lookup"><span data-stu-id="b079b-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="b079b-199">Przychodzące żądania w tych zakresów są ruch przychodzący z innych usług hostowanych w hello tej samej sieci Wirtualnej lub toohello wewnętrznej komunikacji podsieci Redis.</span><span class="sxs-lookup"><span data-stu-id="b079b-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="b079b-200">Porty</span><span class="sxs-lookup"><span data-stu-id="b079b-200">Port(s)</span></span> | <span data-ttu-id="b079b-201">Kierunek</span><span class="sxs-lookup"><span data-stu-id="b079b-201">Direction</span></span> | <span data-ttu-id="b079b-202">Protokół transportu</span><span class="sxs-lookup"><span data-stu-id="b079b-202">Transport Protocol</span></span> | <span data-ttu-id="b079b-203">Przeznaczenie</span><span class="sxs-lookup"><span data-stu-id="b079b-203">Purpose</span></span> | <span data-ttu-id="b079b-204">Lokalny adres IP</span><span class="sxs-lookup"><span data-stu-id="b079b-204">Local IP</span></span> | <span data-ttu-id="b079b-205">Zdalny adres IP</span><span class="sxs-lookup"><span data-stu-id="b079b-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="b079b-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="b079b-206">6379, 6380</span></span> |<span data-ttu-id="b079b-207">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-207">Inbound</span></span> |<span data-ttu-id="b079b-208">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-208">TCP</span></span> |<span data-ttu-id="b079b-209">Równoważenie obciążenia Azure tooRedis komunikacji klienta,</span><span class="sxs-lookup"><span data-stu-id="b079b-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="b079b-210">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-210">(Redis subnet)</span></span> |<span data-ttu-id="b079b-211">Sieć wirtualna Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="b079b-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-212">8443</span><span class="sxs-lookup"><span data-stu-id="b079b-212">8443</span></span> |<span data-ttu-id="b079b-213">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-213">Inbound</span></span> |<span data-ttu-id="b079b-214">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-214">TCP</span></span> |<span data-ttu-id="b079b-215">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-215">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-216">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-216">(Redis subnet)</span></span> |<span data-ttu-id="b079b-217">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-217">(Redis subnet)</span></span> |
| <span data-ttu-id="b079b-218">8500</span><span class="sxs-lookup"><span data-stu-id="b079b-218">8500</span></span> |<span data-ttu-id="b079b-219">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-219">Inbound</span></span> |<span data-ttu-id="b079b-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="b079b-220">TCP/UDP</span></span> |<span data-ttu-id="b079b-221">Równoważenia obciążenia Azure</span><span class="sxs-lookup"><span data-stu-id="b079b-221">Azure load balancing</span></span> | <span data-ttu-id="b079b-222">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-222">(Redis subnet)</span></span> |<span data-ttu-id="b079b-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="b079b-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="b079b-224">10221-10231</span></span> |<span data-ttu-id="b079b-225">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-225">Inbound</span></span> |<span data-ttu-id="b079b-226">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-226">TCP</span></span> |<span data-ttu-id="b079b-227">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-227">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-228">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-228">(Redis subnet)</span></span> |<span data-ttu-id="b079b-229">(Redis podsieć), usługi równoważenia obciążenia Azure</span><span class="sxs-lookup"><span data-stu-id="b079b-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="b079b-230">13000-13999</span></span> |<span data-ttu-id="b079b-231">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-231">Inbound</span></span> |<span data-ttu-id="b079b-232">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-232">TCP</span></span> |<span data-ttu-id="b079b-233">TooRedis komunikacji klienta klastrów równoważenia obciążenia Azure</span><span class="sxs-lookup"><span data-stu-id="b079b-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="b079b-234">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-234">(Redis subnet)</span></span> |<span data-ttu-id="b079b-235">Sieć wirtualna Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="b079b-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="b079b-236">15000-15999</span></span> |<span data-ttu-id="b079b-237">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-237">Inbound</span></span> |<span data-ttu-id="b079b-238">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-238">TCP</span></span> |<span data-ttu-id="b079b-239">Równoważenie obciążenia klastrów, Azure tooRedis komunikacji klienta</span><span class="sxs-lookup"><span data-stu-id="b079b-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="b079b-240">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-240">(Redis subnet)</span></span> |<span data-ttu-id="b079b-241">Sieć wirtualna Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="b079b-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-242">16001</span><span class="sxs-lookup"><span data-stu-id="b079b-242">16001</span></span> |<span data-ttu-id="b079b-243">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-243">Inbound</span></span> |<span data-ttu-id="b079b-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="b079b-244">TCP/UDP</span></span> |<span data-ttu-id="b079b-245">Równoważenia obciążenia Azure</span><span class="sxs-lookup"><span data-stu-id="b079b-245">Azure load balancing</span></span> | <span data-ttu-id="b079b-246">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-246">(Redis subnet)</span></span> |<span data-ttu-id="b079b-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="b079b-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="b079b-248">20226</span><span class="sxs-lookup"><span data-stu-id="b079b-248">20226</span></span> |<span data-ttu-id="b079b-249">Przychodzący</span><span class="sxs-lookup"><span data-stu-id="b079b-249">Inbound</span></span> |<span data-ttu-id="b079b-250">TCP</span><span class="sxs-lookup"><span data-stu-id="b079b-250">TCP</span></span> |<span data-ttu-id="b079b-251">Wewnętrzny komunikację z usługą Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-251">Internal communications for Redis</span></span> | <span data-ttu-id="b079b-252">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-252">(Redis subnet)</span></span> |<span data-ttu-id="b079b-253">(Redis podsieci)</span><span class="sxs-lookup"><span data-stu-id="b079b-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="b079b-254">Dodatkowe wymagania dotyczące łączności sieci sieci Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="b079b-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="b079b-255">Istnieją wymagania dotyczące łączności sieciowej pamięci podręcznej Redis Azure nie może być początkowo spełnieniu w sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="b079b-256">Pamięć podręczna Redis Azure wymaga hello wszystkie następujące elementy toofunction poprawnie, gdy jest używany w ramach sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="b079b-257">Wychodzące połączenie tooAzure magazynu punktów końcowych sieci na całym świecie.</span><span class="sxs-lookup"><span data-stu-id="b079b-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="b079b-258">Obejmuje to punkty końcowe znajduje się w hello tego samego regionu hello wystąpienia pamięci podręcznej Redis Azure, a także punkty końcowe usługi storage znajduje się w **innych** regiony platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="b079b-259">Punkty końcowe usługi Azure Storage rozwiązania w obszarze hello następujące domeny DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*i *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="b079b-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="b079b-260">Wychodzące połączenia sieciowego zbyt*ocsp.msocsp.com*, *mscrl.microsoft.com*, i *crl.microsoft.com*. To połączenie jest toosupport wymagane funkcje protokołu SSL.</span><span class="sxs-lookup"><span data-stu-id="b079b-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="b079b-261">Witaj konfigurację systemu DNS dla sieci wirtualnej hello musi on mieć możliwość rozpoznawania wszystkie punkty końcowe hello i domeny wymienione w hello wcześniejszych punktów.</span><span class="sxs-lookup"><span data-stu-id="b079b-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="b079b-262">W celu zapewnienia prawidłowy infrastruktura DNS jest skonfigurowany i dla sieci wirtualnej hello można spełnić te wymagania systemu DNS.</span><span class="sxs-lookup"><span data-stu-id="b079b-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="b079b-263">Toohello połączenia wychodzącego po Azure punktów końcowych monitorowania, które rozwiązanie w obszarze hello następujące domeny DNS: shoebox2 black.shoebox2.metrics.nsatc.net, prod2.prod2.metrics.nsatc.net Północna, azglobal-black.azglobal.metrics.nsatc.net, wschód prod2.prod2.metrics.nsatc.net shoebox2-red.shoebox2.metrics.nsatc.net azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="b079b-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="b079b-264">Jak sprawdzić, czy Moje pamięci podręcznej działa w sieci Wirtualnej?</span><span class="sxs-lookup"><span data-stu-id="b079b-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="b079b-265">Podczas łączenia z wystąpienia pamięci podręcznej Redis Azure tooan, który znajduje się w sieci Wirtualnej, klienci muszą być w pamięci podręcznej hello tej samej sieci Wirtualnej, w tym testowanie aplikacji ani badanie narzędzia diagnostyczne.</span><span class="sxs-lookup"><span data-stu-id="b079b-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="b079b-266">Po skonfigurowaniu wymagania dotyczące portów hello zgodnie z opisem w poprzedniej sekcji hello można sprawdzić, czy pamięć podręczna działa, wykonując następujące kroki hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="b079b-267">[Ponowny rozruch](cache-administration.md#reboot) wszystkie hello węzłów w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b079b-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="b079b-268">Jeśli wszystkie hello wymagane zależności buforu jest nieosiągalny (zgodnie z opisem w [ruchu przychodzącego wymagania dotyczące portów](cache-how-to-premium-vnet.md#inbound-port-requirements) i [wymagania dotyczące portów wychodzących](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello pamięci podręcznej nie będzie możliwe toorestart pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="b079b-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="b079b-269">Po hello pamięci podręcznej węzły zostały ponownie uruchomione (zgodnie z raportem hello stan pamięci podręcznej w hello portalu Azure), można wykonać hello następujące testy:</span><span class="sxs-lookup"><span data-stu-id="b079b-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="b079b-270">polecenie ping hello punkt końcowy (przy użyciu portu 6380) z komputera, który mieści się w hello tej samej sieci Wirtualnej jako hello pamięci podręcznej, za pomocą [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="b079b-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="b079b-271">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="b079b-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="b079b-272">Jeśli hello `tcping` narzędzie informuje, że hello port jest otwarty, pamięć podręczna hello jest dostępny dla połączeń z klientami w hello sieci Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="b079b-273">Inny sposób tootest jest toocreate klienta pamięci podręcznej testu (co może być prostą aplikację konsoli przy użyciu programie StackExchange.Redis) który łączy z pamięci podręcznej toohello i dodaje i pobiera niektóre elementy z pamięci podręcznej hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="b079b-274">Zainstaluj klienta próbki hello na maszynie Wirtualnej, która znajduje się w tej samej sieci Wirtualnej jako pamięci podręcznej hello Witaj i uruchom go tooverify łączności toohello w pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="b079b-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="b079b-275">Sieci wirtualne można używać z standard lub podstawowa pamięci podręcznej?</span><span class="sxs-lookup"><span data-stu-id="b079b-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="b079b-276">Sieci wirtualne można używać tylko z pamięci podręcznych premium.</span><span class="sxs-lookup"><span data-stu-id="b079b-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="b079b-277">Dlaczego Tworzenie pamięci podręcznej Redis powiedzie w niektórych podsieci, a innych nie?</span><span class="sxs-lookup"><span data-stu-id="b079b-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="b079b-278">Jeśli wdrażasz tooa pamięć podręczna Redis Azure Resource Manager sieci wirtualnej hello pamięci podręcznej musi być w dedykowanym podsieci, która zawiera inny typ zasobu.</span><span class="sxs-lookup"><span data-stu-id="b079b-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="b079b-279">Toodeploy podejmowana jest próba tooa pamięć podręczna Redis Azure podsieci sieci wirtualnej Resource Manager, która zawiera inne zasoby, hello wdrożenie nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="b079b-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="b079b-280">Należy usunąć istniejące zasoby hello wewnątrz podsieci hello przed utworzeniem nowej pamięci podręcznej Redis.</span><span class="sxs-lookup"><span data-stu-id="b079b-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="b079b-281">Można wdrożyć wiele typów o tooa zasoby klasyczne sieci wirtualnej tak długo, jak długo ma za mało IP adresów dostępne.</span><span class="sxs-lookup"><span data-stu-id="b079b-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="b079b-282">Jakie są wymagania dotyczące miejsca na powitania podsieci adresów?</span><span class="sxs-lookup"><span data-stu-id="b079b-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="b079b-283">Azure rezerwuje niektórych adresów IP w każdej podsieci, a nie można użyć tych adresów.</span><span class="sxs-lookup"><span data-stu-id="b079b-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="b079b-284">Witaj imię i nazwisko adresów IP podsieci hello są zastrzeżone dla protokołu zgodność, wraz z trzech więcej adresów używanych na potrzeby usług Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="b079b-285">Aby uzyskać więcej informacji, zobacz [istnieją wszystkie ograniczenia dotyczące używania adresów IP w ramach tych podsieci?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="b079b-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="b079b-286">W przypadku dodawania adresów IP toohello używanych przez infrastrukturę sieci Wirtualnej Azure hello każdy Redis wystąpienia adresów IP używa dwóch podsieci hello na niezależnych i jeden dodatkowy adres IP dla modułu równoważenia obciążenia hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="b079b-287">Pamięć podręczna nieklastrowanych jest uważany za toohave jednego niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="b079b-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="b079b-288">Wszystkie funkcje pamięci podręcznej działają odnośnie do hostowania pamięci podręcznej w sieci Wirtualnej?</span><span class="sxs-lookup"><span data-stu-id="b079b-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="b079b-289">Jeśli pamięć podręczna jest częścią sieci Wirtualnej, tylko klienci w sieci Wirtualnej hello można uzyskać dostępu do pamięci podręcznej hello.</span><span class="sxs-lookup"><span data-stu-id="b079b-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="b079b-290">W związku z tym hello następujące funkcje zarządzania pamięci podręcznej nie działają w tej chwili.</span><span class="sxs-lookup"><span data-stu-id="b079b-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="b079b-291">Redis konsoli — konsoli Redis jest uruchamiana w przeglądarce lokalnego znajduje się poza hello sieci Wirtualnej, nie można połączyć z pamięci podręcznej tooyour.</span><span class="sxs-lookup"><span data-stu-id="b079b-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="b079b-292">Użyj usługi ExpressRoute z pamięcią podręczną Azure Redis</span><span class="sxs-lookup"><span data-stu-id="b079b-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="b079b-293">Klienci mogą się łączyć [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) infrastruktury sieci wirtualnej tootheir obwód, w związku z tym rozszerzanie ich tooAzure sieci lokalnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="b079b-294">Domyślnie nowo utworzony obwodu usługi expressroute nie tunelowanie wymuszone (anons trasę domyślną wartość 0.0.0.0/0) w sieci Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="b079b-295">W związku z tym wychodzące połączenie z Internetem jest dozwolona bezpośrednio z hello sieci Wirtualnej i aplikacje klienckie są możliwe tooconnect tooother Azure punktów końcowych, łącznie z pamięcią podręczną Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="b079b-296">Typowa konfiguracja klienta jest wymuszone tunelowanie toouse (anonsowanie trasy domyślnej) który wymusza wychodzącego Internet ruchu tooinstead przepływu lokalnymi.</span><span class="sxs-lookup"><span data-stu-id="b079b-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="b079b-297">Tego przepływu ruchu przerywa połączenie z pamięcią podręczną Redis Azure, jeśli ruch wychodzący hello jest następnie zablokowany lokalnego pozwalający hello wystąpienia pamięci podręcznej Redis Azure nie jest możliwe toocommunicate z jego zależności.</span><span class="sxs-lookup"><span data-stu-id="b079b-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="b079b-298">rozwiązanie Hello jest toodefine jednej (lub więcej) zdefiniowane przez użytkownika tras (Udr) na powitania podsieci, która zawiera hello pamięć podręczna Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="b079b-299">PRZEZ definiuje tras specyficzne dla podsieci, które będą honorowane zamiast hello trasy domyślnej.</span><span class="sxs-lookup"><span data-stu-id="b079b-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="b079b-300">Jeśli to możliwe zaleca się hello toouse następującej konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="b079b-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="b079b-301">konfiguracji usługi ExpressRoute Hello anonsuje 0.0.0.0/0 i domyślnie życie tuneli wszystkich ruch wychodzący lokalnymi.</span><span class="sxs-lookup"><span data-stu-id="b079b-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="b079b-302">Hello stosowane przez toohello podsieć zawierająca hello pamięć podręczna Redis Azure definiuje 0.0.0.0/0 trasa pracy dla toohello ruchu TCP/IP publicznego Internetu; na przykład przez ustawienie hello następnego przeskoku too'Internet typu ".</span><span class="sxs-lookup"><span data-stu-id="b079b-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="b079b-303">Witaj połączony wpływ tych kroków jest hello na poziomie podsieci przez ma pierwszeństwo przed hello ExpressRoute wymuszone tunelowanie, w związku z tym zapewnienie wychodzący dostęp do Internetu z hello pamięć podręczna Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="b079b-304">Łączącego wystąpienie pamięci podręcznej Redis Azure tooan z aplikacji lokalnych przy użyciu usługi ExpressRoute nie jest scenariuszem typowy sposób powodu przyczyn tooperformance (Aby uzyskać najlepszą wydajność pamięci podręcznej Redis Azure klienci powinni mieć w hello tego samego regionu hello pamięć podręczna Redis Azure).</span><span class="sxs-lookup"><span data-stu-id="b079b-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="b079b-305">Witaj tras określonych w przez **musi** można tootake wystarczająco konkretny, pierwszeństwo nad dowolnym trasy anonsowane przez hello konfiguracji usługi ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b079b-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="b079b-306">Witaj poniższy przykład używa zakresu adresów szerokie 0.0.0.0/0 hello i jako taki może potencjalnie być przypadkowo przesłonięta przez anonsów tras za pomocą bardziej szczegółowych zakresów adresów.</span><span class="sxs-lookup"><span data-stu-id="b079b-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="b079b-307">Pamięć podręczna Redis Azure nie jest obsługiwany w konfiguracji usługi ExpressRoute który **niepoprawnie cross anonsowanie trasy z hello publicznej komunikacji równorzędnej ścieżka toohello prywatnej komunikacji równorzędnej ścieżka**.</span><span class="sxs-lookup"><span data-stu-id="b079b-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="b079b-308">Konfiguracji usługi ExpressRoute, które mają publicznej komunikacji równorzędnej skonfigurowane, otrzymywać anonsów tras od firmy Microsoft dla dużych zestawów zakresów adresów IP firmy Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="b079b-309">Jeśli te zakresy adresów są niepoprawnie cross anonsowany w ścieżki prywatnej komunikacji równorzędnej hello, wynik hello są wszystkich pakietów sieciowych wychodzące z wystąpienia pamięci podręcznej Redis Azure hello podsieci sieci lokalnej klienta niepoprawnie tunneled życie tooa infrastruktura.</span><span class="sxs-lookup"><span data-stu-id="b079b-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="b079b-310">Ten przepływ sieci dzieli pamięci podręcznej Redis Azure.</span><span class="sxs-lookup"><span data-stu-id="b079b-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="b079b-311">problem toothis rozwiązania Hello jest toostop tras między reklamy hello publicznej komunikacji równorzędnej ścieżka toohello prywatnej komunikacji równorzędnej ścieżka.</span><span class="sxs-lookup"><span data-stu-id="b079b-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="b079b-312">Informacje na trasach zdefiniowanych przez użytkownika jest dostępna w tym [omówienie](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b079b-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="b079b-313">Aby uzyskać więcej informacji na temat połączenia ExpressRoute, zobacz [opis techniczny ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="b079b-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b079b-314">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="b079b-314">Next steps</span></span>
<span data-ttu-id="b079b-315">Dowiedz się, jak toouse premium więcej pamięci podręcznej funkcji.</span><span class="sxs-lookup"><span data-stu-id="b079b-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="b079b-316">Wprowadzenie toohello pamięci podręcznej Redis Azure Premium warstwy</span><span class="sxs-lookup"><span data-stu-id="b079b-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

