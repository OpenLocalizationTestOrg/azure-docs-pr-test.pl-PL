---
title: "aaaTroubleshoot automatycznie skalowana za pomocą zestawów skali maszyny wirtualnej | Dokumentacja firmy Microsoft"
description: "Rozwiązywanie problemów z automatycznie skalowana za pomocą zestawów skali maszyny wirtualnej. Zrozumienie typowych problemów i w jaki sposób tooresolve je."
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: c7d87b72-ee24-4e52-9377-a42f337f76fa
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: windows
ms.devlang: na
ms.topic: article
ms.date: 10/28/2016
ms.author: guybo
ms.openlocfilehash: 4c9a70992348d87fb43646421a90a027bf400a17
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-autoscale-with-virtual-machine-scale-sets"></a><span data-ttu-id="fe4df-104">Rozwiązywanie problemów z automatycznie skalowana za pomocą zestawów skali maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="fe4df-104">Troubleshooting autoscale with Virtual Machine Scale Sets</span></span>
<span data-ttu-id="fe4df-105">**Problem** — po utworzeniu Skalowanie automatyczne infrastruktury w usłudze Azure Resource Manager przy użyciu zestawy skalowania maszyny Wirtualnej — na przykład, przez wdrożenie szablonu następująco: https://github.com/Azure/azure-quickstart-templates/tree/master/201- vmss-bottle — funkcja automatycznego skalowania — masz zdefiniowanych reguł skalowania i działa ona ponosić, z tą różnicą, że niezależnie od tego, ile obciążenia zostanie umieszczony na powitania maszyn wirtualnych, nie będzie skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="fe4df-105">**Problem** – you’ve created an autoscaling infrastructure in Azure Resource Manager using VM Scale Sets –  for example by deploying a template like this: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale  – you have your scale rules defined and it works great, except that no matter how much load you put on hello VMs, it won’t autoscale.</span></span>

## <a name="troubleshooting-steps"></a><span data-ttu-id="fe4df-106">Kroki rozwiązywania problemów</span><span class="sxs-lookup"><span data-stu-id="fe4df-106">Troubleshooting steps</span></span>
<span data-ttu-id="fe4df-107">Niektóre elementy tooconsider obejmują:</span><span class="sxs-lookup"><span data-stu-id="fe4df-107">Some things tooconsider include:</span></span>

* <span data-ttu-id="fe4df-108">Liczby rdzeni każda maszyna wirtualna ma i czy ładowanie każdego rdzenia? Szablon Szybki Start Azure przykład Hello powyżej ma do_work.php skrypt, który jest ładowany przez pojedynczy rdzeń.</span><span class="sxs-lookup"><span data-stu-id="fe4df-108">How many cores does each VM have, and are you loading each core? hello example Azure Quickstart template above has a do_work.php script, which loads a single core.</span></span> <span data-ttu-id="fe4df-109">Jeśli używasz większy niż pojedynczego rdzenia rozmiar maszyny Wirtualnej maszyny Wirtualnej, tak jak Standard_A1 lub D1 następnie wymagałoby toorun obciążenie wiele razy.</span><span class="sxs-lookup"><span data-stu-id="fe4df-109">If you’re using a VM bigger than a single core VM size like Standard_A1 or D1 then you’d need toorun this load multiple times.</span></span> <span data-ttu-id="fe4df-110">Sprawdź, ile rdzenie maszyn wirtualnych, przeglądając [rozmiary dla systemu Windows maszyny wirtualne na platformie Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="fe4df-110">Check how many cores your VMs by reviewing [Sizes for Windows virtual machines in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="fe4df-111">Jak wiele maszyn wirtualnych w hello zestawu skali maszyny Wirtualnej można operacji pracy na każdej z nich?</span><span class="sxs-lookup"><span data-stu-id="fe4df-111">How many VMs in hello VM Scale Set, are you doing work on each one?</span></span>
  
    <span data-ttu-id="fe4df-112">Skalowania zdarzeń ma miejsce tylko po hello średni procesora CPU przez **wszystkie** hello wartości progowej, wraz z upływem czasu hello wewnętrzny zdefiniowane w regułach skalowania automatycznego hello przekracza hello maszyn wirtualnych w zestawie skalowania.</span><span class="sxs-lookup"><span data-stu-id="fe4df-112">A scale out event will only take place when hello average CPU across **all** hello VMs in a scale set exceeds hello threshold value, over hello time internal defined in hello autoscale rules.</span></span>
* <span data-ttu-id="fe4df-113">Czy zapomniano wszelkie zdarzenia skalowania?</span><span class="sxs-lookup"><span data-stu-id="fe4df-113">Did you miss any scale events?</span></span>
  
    <span data-ttu-id="fe4df-114">Przejrzyj dzienniki inspekcji hello w hello portalu Azure zdarzeń skali.</span><span class="sxs-lookup"><span data-stu-id="fe4df-114">Check hello audit logs in hello Azure portal for scale events.</span></span> <span data-ttu-id="fe4df-115">Może być wystąpił skali górę i skalowania w dół, która została pominięta.</span><span class="sxs-lookup"><span data-stu-id="fe4df-115">Maybe there was a scale up and a scale down which was missed.</span></span> <span data-ttu-id="fe4df-116">Można filtrować według "Skala"...</span><span class="sxs-lookup"><span data-stu-id="fe4df-116">You can filter by “Scale”..</span></span>
  
    ![Dzienniki inspekcji][audit]
* <span data-ttu-id="fe4df-118">Wartości progowe w skali i skalowalnego w poziomie są różni się wystarczająco?</span><span class="sxs-lookup"><span data-stu-id="fe4df-118">Are your scale-in and scale-out thresholds sufficiently different?</span></span>
  
    <span data-ttu-id="fe4df-119">Załóżmy, że ustawić reguły tooscale się, gdy średnie wykorzystanie Procesora jest większa niż 50% ponad 5 minut, a tooscale w przypadku średnie wykorzystanie Procesora na mniej niż 50%.</span><span class="sxs-lookup"><span data-stu-id="fe4df-119">Suppose you set a rule tooscale out when average CPU is greater than 50% over 5 minutes, and tooscale in when average CPU is less than 50%.</span></span> <span data-ttu-id="fe4df-120">To spowodowałoby problem "flapping" gdy wykorzystanie Procesora jest próg Zamknij toothis akcji skalowania hello stale zwiększania i zmniejszania rozmiaru hello zestawu.</span><span class="sxs-lookup"><span data-stu-id="fe4df-120">This would cause a “flapping” problem when CPU usage is close toothis threshold, with scale actions constantly increasing and decreasing hello size of hello set.</span></span> <span data-ttu-id="fe4df-121">W związku z tym hello automatycznego skalowania usługi próbuje tooprevent "niestabilny", który można manifestu jako skalowania nie.</span><span class="sxs-lookup"><span data-stu-id="fe4df-121">Because of this, hello autoscale service tries tooprevent “flapping”, which can manifest as not scaling.</span></span> <span data-ttu-id="fe4df-122">W związku z tym upewnij się, że wartości progowe skalowalnego w poziomie i w skali są różni się wystarczająco tooallow Zwolnij miejsce Between skalowania.</span><span class="sxs-lookup"><span data-stu-id="fe4df-122">Therefore make sure your scale-out and scale-in thresholds are sufficiently different tooallow some space in between scaling.</span></span>
* <span data-ttu-id="fe4df-123">Czy pisania szablonu JSON?</span><span class="sxs-lookup"><span data-stu-id="fe4df-123">Did you write your own JSON template?</span></span>
  
    <span data-ttu-id="fe4df-124">Jest łatwe toomake błędów, więc uruchomić przy użyciu szablonu, takie jak hello jest jeden nad którym sprawdzone toowork i małych zmiany przyrostowe.</span><span class="sxs-lookup"><span data-stu-id="fe4df-124">It is easy toomake mistakes, so start with a template like hello one above which is proven toowork, and make small incremental changes.</span></span> 
* <span data-ttu-id="fe4df-125">Można ręcznie skalowanie przychodzący lub wychodzący?</span><span class="sxs-lookup"><span data-stu-id="fe4df-125">Can you manually scale in or out?</span></span>
  
    <span data-ttu-id="fe4df-126">Spróbuj ręcznie hello ponownego wdrożenia zasobów zestawu skali maszyny Wirtualnej z różnych "pojemność" ustawienie toochange hello wiele maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="fe4df-126">Try redeploying hello VM Scale Set resource with a different “capacity” setting toochange hello number of VMs manually.</span></span> <span data-ttu-id="fe4df-127">Przykład toodo szablonu jest tutaj: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing — może być konieczne tooedit hello szablonu toomake się, że ma ona hello sam rozmiar komputera jest korzystania z zestawu skalowania.</span><span class="sxs-lookup"><span data-stu-id="fe4df-127">An example template toodo this is here: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – you may need tooedit hello template toomake sure it has hello same machine size as your Scale Set is using.</span></span> <span data-ttu-id="fe4df-128">Czy można pomyślnie ręcznie zmienić hello liczbę maszyn wirtualnych, następnie wiadomo, że hello problem jest tooautoscale izolowanym.</span><span class="sxs-lookup"><span data-stu-id="fe4df-128">If you can successfully change hello number of VMs manually, then you know hello problem is isolated tooautoscale.</span></span>
* <span data-ttu-id="fe4df-129">Sprawdź Twojej Microsoft.Compute/virtualMachineScaleSet i zasoby elemencie Microsoft.Insights hello [Eksploratora zasobów Azure](https://resources.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="fe4df-129">Check your Microsoft.Compute/virtualMachineScaleSet, and Microsoft.Insights resources in hello [Azure Resource Explorer](https://resources.azure.com/)</span></span>
  
    <span data-ttu-id="fe4df-130">Jest to nieodzowne Rozwiązywanie problemów z narzędzia, które pokazuje hello stanu zasobów usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="fe4df-130">This is an indispensable troubleshooting tool which shows you hello state of your Azure Resource Manager resources.</span></span> <span data-ttu-id="fe4df-131">Kliknij subskrypcję i przyjrzyj się hello są Rozwiązywanie problemów z grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="fe4df-131">Click on your subscription and look at hello Resource Group you are troubleshooting.</span></span> <span data-ttu-id="fe4df-132">W obszarze dostawcy zasobów obliczeniowych hello przyjrzeć się hello tworzenia zestawu skali maszyny Wirtualnej i sprawdź hello wystąpienia widoku, który pokazuje hello stanu wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="fe4df-132">Under hello Compute resource provider look at hello VM Scale Set you created and check hello Instance View, which shows you hello state of a deployment.</span></span> <span data-ttu-id="fe4df-133">Sprawdź również hello widok wystąpienia maszyny wirtualnej w hello zestawu skali maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="fe4df-133">Also check hello instance view of VMs in hello VM Scale Set.</span></span> <span data-ttu-id="fe4df-134">Następnie przejdź do dostawcy zasobów w elemencie Microsoft.Insights hello i sprawdź, czy wygląd hello reguł skalowania automatycznego.</span><span class="sxs-lookup"><span data-stu-id="fe4df-134">Then go into hello Microsoft.Insights resource provider and check hello autoscale rules look good.</span></span>
* <span data-ttu-id="fe4df-135">Jest hello diagnostycznych rozszerzenia pracy i wysyłających dane dotyczące wydajności?</span><span class="sxs-lookup"><span data-stu-id="fe4df-135">Is hello Diagnostic extension working and emitting performance data?</span></span>
  
    <span data-ttu-id="fe4df-136">**Aktualizacja:** Azure automatycznego skalowania zostało ulepszone toouse hosta na podstawie metryk potoku, który nie wymaga już toobe rozszerzenia diagnostyki, zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="fe4df-136">**Update:** Azure autoscale has been enhanced toouse a host based metrics pipeline which no longer requires a diagnostics extension toobe installed.</span></span> <span data-ttu-id="fe4df-137">Oznacza to, że hello kilku następnych akapitów nie mają już zastosowania w przypadku utworzenia aplikacji Skalowanie automatyczne przy użyciu hello nowy potok.</span><span class="sxs-lookup"><span data-stu-id="fe4df-137">This means hello next few paragraphs no longer apply if you create an autoscaling application using hello new pipeline.</span></span> <span data-ttu-id="fe4df-138">Na przykład szablonów platformy Azure, które zostały przekonwertowane toouse hello hosta potoku: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span><span class="sxs-lookup"><span data-stu-id="fe4df-138">An example of Azure templates which have been converted toouse hello host pipeline is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span></span> 
  
    <span data-ttu-id="fe4df-139">Przy użyciu hosta na podstawie metryki skalowania automatycznego jest lepszym rozwiązaniem dla hello z następujących powodów:</span><span class="sxs-lookup"><span data-stu-id="fe4df-139">Using host based metrics for autoscale is better for hello following reasons:</span></span>
  
  * <span data-ttu-id="fe4df-140">Mniej części ruchome jako rozszerzenia nie diagnostyki muszą toobe zainstalowane.</span><span class="sxs-lookup"><span data-stu-id="fe4df-140">Fewer moving parts as no diagnostics extensions need toobe installed.</span></span>
  * <span data-ttu-id="fe4df-141">Szablony prostsze.</span><span class="sxs-lookup"><span data-stu-id="fe4df-141">Simpler templates.</span></span> <span data-ttu-id="fe4df-142">Wystarczy dodać insights skalowania automatycznego reguły tooan istniejącego zestawu skalowania maszyny wirtualnej szablonu.</span><span class="sxs-lookup"><span data-stu-id="fe4df-142">Just add insights autoscale rules tooan existing scale set template.</span></span>
  * <span data-ttu-id="fe4df-143">Bardziej niezawodne, raportowanie i szybsze uruchamianie nowych maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="fe4df-143">More reliable reporting and faster launching of new VMs.</span></span>
    
    <span data-ttu-id="fe4df-144">Hello tylko przyczyn może być tookeep przy użyciu rozszerzenia diagnostycznych może być konieczne będzie pamięci diagnostyki raportowania/skalowania.</span><span class="sxs-lookup"><span data-stu-id="fe4df-144">hello only reasons you might want tookeep using a diagnostic extension would be if you need memory diagnostics reporting/scaling.</span></span> <span data-ttu-id="fe4df-145">Host, na podstawie metryk nie raportują pamięci.</span><span class="sxs-lookup"><span data-stu-id="fe4df-145">Host based metrics doesn't report memory.</span></span>
    
    <span data-ttu-id="fe4df-146">Z tym pamiętać tylko wykonaj hello dalszej części tego artykułu, nadal używasz rozszerzenia diagnostycznych dla Twojego Skalowanie automatyczne.</span><span class="sxs-lookup"><span data-stu-id="fe4df-146">With that in mind, only follow hello rest of this article if you are still using diagnostic extensions for your autoscaling.</span></span>
    
    <span data-ttu-id="fe4df-147">Funkcja automatycznego skalowania usługi Azure Resource Manager można pracować (ale nie ma już do) za pomocą rozszerzenia maszyny Wirtualnej o nazwie hello rozszerzenia diagnostyki.</span><span class="sxs-lookup"><span data-stu-id="fe4df-147">Autoscale in Azure Resource Manager can work (but no longer has to) by means of a VM extension called hello Diagnostics Extension.</span></span> <span data-ttu-id="fe4df-148">Konto magazynu tooa danych wydajności, zdefiniowanych w szablonie hello go emituje.</span><span class="sxs-lookup"><span data-stu-id="fe4df-148">It emits performance data tooa storage account you define in hello template.</span></span> <span data-ttu-id="fe4df-149">Te dane są agregowane przez usługę Azure Monitor hello.</span><span class="sxs-lookup"><span data-stu-id="fe4df-149">This data is then aggregated by hello Azure Monitor service.</span></span>
    
    <span data-ttu-id="fe4df-150">Jeśli hello usługa szczegółowych informacji nie można odczytać danych z hello maszyn wirtualnych, powinien toosend Ci wiadomość e-mail — na przykład jeśli zostały hello maszyn wirtualnych, więc Sprawdź pocztę (hello określona podczas tworzenia hello konto platformy Azure).</span><span class="sxs-lookup"><span data-stu-id="fe4df-150">If hello Insights service can’t read data from hello VMs, it is supposed toosend you an email – for example if hello VMs were down, so check your email (hello one you specified when creating hello Azure account).</span></span>
    
    <span data-ttu-id="fe4df-151">Można również przejść i wyglądać na powitania danych.</span><span class="sxs-lookup"><span data-stu-id="fe4df-151">You can also go and look at hello data yourself.</span></span> <span data-ttu-id="fe4df-152">Spójrz na powitania kontem magazynu platformy Azure przy użyciu Eksplorator chmury.</span><span class="sxs-lookup"><span data-stu-id="fe4df-152">Look at hello Azure storage account using a cloud explorer.</span></span> <span data-ttu-id="fe4df-153">Na przykład za pomocą hello [programu Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), zaloguj się za wybierz hello używasz subskrypcji platformy Azure i hello nazwa odwołuje hello definicji rozszerzenia diagnostyki w danym wdrożeniu konto magazynu diagnostyki szablon...</span><span class="sxs-lookup"><span data-stu-id="fe4df-153">For example using hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), log in and pick hello Azure subscription you’re using, and hello Diagnostics storage account name referenced in hello Diagnostics extension definition in your deployment template..</span></span>
    
    ![Eksplorator chmury][explorer]
    
    <span data-ttu-id="fe4df-155">W tym miejscu zobaczysz grupy tabel, gdzie są przechowywane dane hello z każdej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="fe4df-155">Here you will see a bunch of tables where hello data from each VM is being stored.</span></span> <span data-ttu-id="fe4df-156">Biorąc systemu Linux i hello Metryka procesora CPU, na przykład, przyjrzeć się hello najnowszych wierszy.</span><span class="sxs-lookup"><span data-stu-id="fe4df-156">Taking Linux and hello CPU metric as an example, look at hello most recent rows.</span></span> <span data-ttu-id="fe4df-157">Hello Visual Studio cloud explorer obsługuje język zapytań, więc można uruchomić zapytania, takie jak "datetime gt sygnatura czasowa" 2016-02-02T21:20:00Z "" toomake się pobrać najnowszych zdarzeń hello (przyjmowane jest czas jest w formacie UTC).</span><span class="sxs-lookup"><span data-stu-id="fe4df-157">hello Visual Studio cloud explorer supports a query language so you can run a query like “Timestamp gt datetime’2016-02-02T21:20:00Z’” toomake sure you get hello most recent events (assume time is in UTC).</span></span> <span data-ttu-id="fe4df-158">Witaj dane, które widać w odpowiada toohello skalowany reguł skonfigurowanych?</span><span class="sxs-lookup"><span data-stu-id="fe4df-158">Does hello data you see in there correspond toohello scale rules you set up?</span></span> <span data-ttu-id="fe4df-159">W poniższym przykładzie hello hello Procesora dla maszyny 20 uruchomiona zwiększyć too100% hello ostatnich 5 minut.</span><span class="sxs-lookup"><span data-stu-id="fe4df-159">In hello example below, hello CPU for machine 20 started increasing too100% over hello last 5 minutes..</span></span>
    
    ![Magazyn tabel][tables]
    
    <span data-ttu-id="fe4df-161">W przypadku hello danych nie istnieje, następnie zakłada się, że hello problem jest rozszerzeniem diagnostycznych hello uruchomionych w hello maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="fe4df-161">If hello data is not there, then it implies hello problem is with hello diagnostic extension running in hello VMs.</span></span> <span data-ttu-id="fe4df-162">Jeśli istnieje już hello danych, oznacza to, brak problemami z reguł skalowania lub usłudze Insights hello.</span><span class="sxs-lookup"><span data-stu-id="fe4df-162">If hello data is there, it implies there is either a problem with your scale rules, or with hello Insights service.</span></span> <span data-ttu-id="fe4df-163">Sprawdź [Azure stan](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="fe4df-163">Check [Azure Status](https://azure.microsoft.com/status/).</span></span>
    
    <span data-ttu-id="fe4df-164">Po już został tych kroków, jeśli nadal występują problemy z automatycznego skalowania można wypróbować fora hello na [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), lub [przepełnienie stosu](http://stackoverflow.com/questions/tagged/azure), lub pomocy technicznej.</span><span class="sxs-lookup"><span data-stu-id="fe4df-164">Once you’ve been through these steps, if you are still having autoscale problems you could try hello forums on [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), or [Stack overflow](http://stackoverflow.com/questions/tagged/azure), or log a support call.</span></span> <span data-ttu-id="fe4df-165">Można przygotować tooshare hello szablon i widoku hello danych dotyczących wydajności.</span><span class="sxs-lookup"><span data-stu-id="fe4df-165">Be prepared tooshare hello template and a view of hello performance data.</span></span>

[audit]: ./media/virtual-machine-scale-sets-troubleshoot/image3.png
[explorer]: ./media/virtual-machine-scale-sets-troubleshoot/image1.png
[tables]: ./media/virtual-machine-scale-sets-troubleshoot/image4.png
