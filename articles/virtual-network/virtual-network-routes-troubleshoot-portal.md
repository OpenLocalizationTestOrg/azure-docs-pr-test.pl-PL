---
title: "Rozwiązywanie problemów z tras - Portal | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak rozwiązywać problemy z trasy w modelu wdrażania usługi Azure Resource Manager przy użyciu portalu Azure."
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: bdd8b6dc-02fb-4057-bb23-8289caa9de89
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: dad415936280b4af916b8c46df46f6c51ac0bca4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-routes-using-the-azure-portal"></a><span data-ttu-id="ae185-103">Rozwiązywanie problemów z tras przy użyciu portalu Azure</span><span class="sxs-lookup"><span data-stu-id="ae185-103">Troubleshoot routes using the Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="ae185-104">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="ae185-104">Azure Portal</span></span>](virtual-network-routes-troubleshoot-portal.md)
> * [<span data-ttu-id="ae185-105">PowerShell</span><span class="sxs-lookup"><span data-stu-id="ae185-105">PowerShell</span></span>](virtual-network-routes-troubleshoot-powershell.md)
>
>

<span data-ttu-id="ae185-106">Jeśli występują problemy z połączeniem sieciowym do lub z sieci maszyny wirtualnej Azure (VM), tras może mieć wpływ na Twoje ruch maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-106">If you are experiencing network connectivity issues to or from your Azure Virtual Machine (VM), routes may be impacting your VM traffic flows.</span></span> <span data-ttu-id="ae185-107">Ten artykuł zawiera omówienie funkcji diagnostyki dla tras do dalszego rozwiązywania.</span><span class="sxs-lookup"><span data-stu-id="ae185-107">This article provides an overview of diagnostics capabilities for routes to help troubleshoot further.</span></span>

<span data-ttu-id="ae185-108">Tabele tras są skojarzone z podsieciami i obowiązują na wszystkich interfejsach sieciowych (NIC) w tej podsieci.</span><span class="sxs-lookup"><span data-stu-id="ae185-108">Route tables are associated with subnets and are effective on all network interfaces (NIC) in that subnet.</span></span> <span data-ttu-id="ae185-109">Następujące typy tras może odnosić się do każdego interfejsu sieciowego:</span><span class="sxs-lookup"><span data-stu-id="ae185-109">The following types of routes can be applied to each network interface:</span></span>

* <span data-ttu-id="ae185-110">**Trasy systemowe:** Domyślnie każda podsieć utworzona w sieci wirtualnej platformy Azure (VNet) ma tabel tras systemu, które umożliwiają lokalnej sieci wirtualnej ruch, ruch lokalnej za pośrednictwem bramy sieci VPN i ruchu internetowego.</span><span class="sxs-lookup"><span data-stu-id="ae185-110">**System routes:** By default, every subnet created in an Azure Virtual Network (VNet) has system route tables that allow local VNet traffic, on-premises traffic via VPN gateways, and Internet traffic.</span></span> <span data-ttu-id="ae185-111">Istnieją również tras systemowych dla połączyć za pomocą sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="ae185-111">System routes also exist for peered VNets.</span></span>
* <span data-ttu-id="ae185-112">**Trasy protokołu BGP:** propagowane do interfejsów sieciowych za pośrednictwem usługi ExpressRoute lub połączeń VPN lokacja lokacja.</span><span class="sxs-lookup"><span data-stu-id="ae185-112">**BGP routes:** Propagated to network interfaces through ExpressRoute or site-to-site VPN connections.</span></span> <span data-ttu-id="ae185-113">Dowiedz się więcej o routingu BGP, odczytując [protokołu BGP z bramy sieci VPN](../vpn-gateway/vpn-gateway-bgp-overview.md) i [omówienie ExpressRoute](../expressroute/expressroute-introduction.md) artykułów.</span><span class="sxs-lookup"><span data-stu-id="ae185-113">Learn more about BGP routing by reading the [BGP with VPN gateways](../vpn-gateway/vpn-gateway-bgp-overview.md) and [ExpressRoute overview](../expressroute/expressroute-introduction.md) articles.</span></span>
* <span data-ttu-id="ae185-114">**Trasy zdefiniowane przez użytkownika (przez):** korzystając z wirtualnych urządzeń sieciowych lub są wymuszone tunelowanie ruch do sieci lokalnej za pośrednictwem sieci VPN lokacja lokacja, może być zdefiniowana przez użytkownika tras (Udr) skojarzone z tabeli tras podsieci.</span><span class="sxs-lookup"><span data-stu-id="ae185-114">**User-defined routes (UDR):** If you are using network virtual appliances or are forced-tunneling traffic to an on-premises network via a site-to-site VPN, you may have user-defined routes (UDRs) associated with your subnet route table.</span></span> <span data-ttu-id="ae185-115">Jeśli nie masz doświadczenia w obsłudze Udr, przeczytaj [trasy zdefiniowane przez użytkownika](virtual-networks-udr-overview.md#user-defined-routes) artykułu.</span><span class="sxs-lookup"><span data-stu-id="ae185-115">If you're not familiar with UDRs, read the [user-defined routes](virtual-networks-udr-overview.md#user-defined-routes) article.</span></span>

<span data-ttu-id="ae185-116">Przy użyciu różnych tras, które można zastosować do interfejsu sieciowego może być trudne do ustalenia, obowiązują agregacji trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-116">With the various routes that can be applied to a network interface, it can be difficult to determine which aggregate routes are effective.</span></span> <span data-ttu-id="ae185-117">Do rozwiązywania problemów łączności sieciowej maszyny Wirtualnej, można wyświetlić wszystkie skuteczne trasy dla interfejsu sieciowego w modelu wdrażania usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="ae185-117">To help troubleshoot VM network connectivity, you can view all the effective routes for a network interface in the Azure Resource Manager deployment model.</span></span>

## <a name="using-effective-routes-to-troubleshoot-vm-traffic-flow"></a><span data-ttu-id="ae185-118">Rozwiązywanie problemów z przepływem ruchu maszyny Wirtualnej za pomocą skuteczne tras</span><span class="sxs-lookup"><span data-stu-id="ae185-118">Using Effective Routes to troubleshoot VM traffic flow</span></span>
<span data-ttu-id="ae185-119">W tym artykule używa następujący scenariusz jako przykład ilustrujący sposób rozwiązywania skuteczne trasy dla interfejsu sieciowego:</span><span class="sxs-lookup"><span data-stu-id="ae185-119">This article uses the following scenario as an example to illustrate how to troubleshoot the effective routes for a network interface:</span></span>

<span data-ttu-id="ae185-120">Maszyna wirtualna (*VM1*) podłączone do sieci wirtualnej (*VNet1*, prefiks: 10.9.0.0/16) nie może połączyć się VM(VM3) w nowo peered sieci wirtualnej (*VNet3*, prefiks 10.10.0.0/16).</span><span class="sxs-lookup"><span data-stu-id="ae185-120">A VM (*VM1*) connected to the VNet (*VNet1*, prefix: 10.9.0.0/16) fails to connect to a VM(VM3) in a newly peered VNet (*VNet3*, prefix 10.10.0.0/16).</span></span> <span data-ttu-id="ae185-121">Brak Udr lub BGP kieruje stosowane do interfejsu sieciowego VM1 NIC1 podłączony do maszyny Wirtualnej, są stosowane tylko tras systemowych.</span><span class="sxs-lookup"><span data-stu-id="ae185-121">There are no UDRs or BGP routes applied to VM1-NIC1 network interface connected to the VM, only system routes are applied.</span></span>

<span data-ttu-id="ae185-122">W tym artykule opisano sposób ustalić przyczynę niepowodzenia połączenia przy użyciu możliwości wprowadzenia trasy w modelu wdrażania zarządzania zasobami Azure.</span><span class="sxs-lookup"><span data-stu-id="ae185-122">This article explains how to determine the cause of the connection failure, using effective routes capability in Azure Resource Management deployment model.</span></span>
<span data-ttu-id="ae185-123">Podczas w przykładzie użyto tylko tras systemowych, te same kroki może służyć do określenia błędów połączenia przychodzącego i wychodzącego przez dowolnego typu trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-123">While the example uses only system routes, the same steps can be used to determine inbound and outbound connection failures over any route type.</span></span>

> [!NOTE]
> <span data-ttu-id="ae185-124">Jeśli maszyna wirtualna ma więcej niż jedną kartę Sieciową podłączoną, sprawdź skuteczne trasy dla każdej z kart sieciowych do diagnozowania problemów z łącznością sieciową z maszyny Wirtualnej i.</span><span class="sxs-lookup"><span data-stu-id="ae185-124">If your VM has more than one NIC attached, check effective routes for each of the NICs to diagnose network connectivity issues to and from a VM.</span></span>
>
>

### <a name="view-effective-routes-for-a-virtual-machine"></a><span data-ttu-id="ae185-125">Widok skuteczne trasy dla maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="ae185-125">View effective routes for a virtual machine</span></span>
<span data-ttu-id="ae185-126">Aby wyświetlić trasy agregacji, które są stosowane do maszyny Wirtualnej, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="ae185-126">To see the aggregate routes that are applied to a VM, complete the following steps:</span></span>

1. <span data-ttu-id="ae185-127">Zaloguj się do portalu Azure pod adresem https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="ae185-127">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="ae185-128">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **maszyn wirtualnych** na liście.</span><span class="sxs-lookup"><span data-stu-id="ae185-128">Click **More services**, then click **Virtual machines** in the list that appears.</span></span>
3. <span data-ttu-id="ae185-129">Wybierz maszynę Wirtualną, aby rozwiązać problemy z listy, która pojawia się i zostanie wyświetlony blok maszyny Wirtualnej, z opcjami.</span><span class="sxs-lookup"><span data-stu-id="ae185-129">Select a VM to troubleshoot from the list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="ae185-130">Kliknij przycisk **Diagnozuj & rozwiązywania problemów** , a następnie wybierz powszechny problem.</span><span class="sxs-lookup"><span data-stu-id="ae185-130">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="ae185-131">Na przykład **nie mogę połączyć się z maszyną Wirtualną z systemem Windows** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="ae185-131">For this example, **I can’t connect to my Windows VM** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image1.png)
5. <span data-ttu-id="ae185-132">Kroki są wyświetlane w obszarze ten problem, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ae185-132">Steps appear under the problem, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image2.png)

    <span data-ttu-id="ae185-133">Kliknij przycisk *skuteczne tras* na liście zalecanych kroków.</span><span class="sxs-lookup"><span data-stu-id="ae185-133">Click *effective routes* in the list of recommended steps.</span></span>
6. <span data-ttu-id="ae185-134">**Skuteczne tras** zostanie wyświetlony blok, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ae185-134">The **Effective routes** blade appears, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image3.png)

    <span data-ttu-id="ae185-135">Jeśli maszyna wirtualna ma tylko jedną kartę Sieciową, jest wybrany domyślnie.</span><span class="sxs-lookup"><span data-stu-id="ae185-135">If your VM has only one NIC, it is selected by default.</span></span> <span data-ttu-id="ae185-136">Jeśli masz więcej niż jedną kartę Sieciową, wybierz karty interfejsu Sieciowego, dla którego chcesz wyświetlić skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-136">If you have more than one NIC, select the NIC for which you want to view the effective routes.</span></span>

   > [!NOTE]
   > <span data-ttu-id="ae185-137">Jeśli skojarzone z karty Sieciowej maszyny Wirtualnej nie jest w stanie uruchomienia, nie można wyświetlić skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-137">If the VM associated with the NIC is not in a running state, effective routes will not be shown.</span></span> <span data-ttu-id="ae185-138">Tylko pierwszych 200 skuteczne trasy są wyświetlane w portalu.</span><span class="sxs-lookup"><span data-stu-id="ae185-138">Only the first 200 effective routes are shown in the portal.</span></span> <span data-ttu-id="ae185-139">Aby uzyskać pełną listę, kliknij **Pobierz**.</span><span class="sxs-lookup"><span data-stu-id="ae185-139">For the full list, click **Download**.</span></span> <span data-ttu-id="ae185-140">Dodatkowo można filtrować wyniki z pliku CSV pobrany.</span><span class="sxs-lookup"><span data-stu-id="ae185-140">You can further filter on the results from the downloaded .csv file.</span></span>
   >
   >

    <span data-ttu-id="ae185-141">Zwróć uwagę następujące opcje w danych wyjściowych:</span><span class="sxs-lookup"><span data-stu-id="ae185-141">Notice the following in the output:</span></span>

   * <span data-ttu-id="ae185-142">**Źródło**: Określa typ trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-142">**Source**: Indicates the type of route.</span></span> <span data-ttu-id="ae185-143">Trasy systemowe są wyświetlane jako *domyślne*, Udr są wyświetlane jako *użytkownika* i tras bramy (statyczny lub BGP) są wyświetlane jako *właściwość VPNGateway*.</span><span class="sxs-lookup"><span data-stu-id="ae185-143">System routes are shown as *Default*, UDRs are shown as *User* and gateway routes (static or BGP) are shown as *VPNGateway*.</span></span>
   * <span data-ttu-id="ae185-144">**Stan**: wskazuje stan skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-144">**State**: Indicates state of the effective route.</span></span> <span data-ttu-id="ae185-145">Możliwe wartości to *Active* lub *nieprawidłowy*.</span><span class="sxs-lookup"><span data-stu-id="ae185-145">Possible values are *Active* or *Invalid*.</span></span>
   * <span data-ttu-id="ae185-146">**AddressPrefixes**: Określa prefiks adresu skuteczne trasy w notacji CIDR.</span><span class="sxs-lookup"><span data-stu-id="ae185-146">**AddressPrefixes**: Specifies the address prefix of the effective route in CIDR notation.</span></span>
   * <span data-ttu-id="ae185-147">**Typ następnego przeskoku**: wskazuje następnego skoku dla danej trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-147">**nextHopType**: Indicates the next hop for the given route.</span></span> <span data-ttu-id="ae185-148">Możliwe wartości to *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering*, lub *Null*.</span><span class="sxs-lookup"><span data-stu-id="ae185-148">Possible values are *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering*, or *Null*.</span></span> <span data-ttu-id="ae185-149">Wartość *Null* dla **Typ następnego przeskoku** przez może oznaczać nieprawidłową trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-149">A value of *Null* for **nextHopType** in a UDR may indicate an invalid route.</span></span> <span data-ttu-id="ae185-150">Na przykład jeśli **Typ następnego przeskoku** jest *VirtualAppliance* i urządzenie wirtualne sieci maszyny Wirtualnej nie jest w stanie zainicjowano obsługę administracyjną uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="ae185-150">For example, if **nextHopType** is *VirtualAppliance* and the network virtual appliance VM is not in a provisioned/running state.</span></span> <span data-ttu-id="ae185-151">Jeśli **Typ następnego przeskoku** jest *właściwość VPNGateway* i nie ma żadnych bramy elastycznie/uruchomiony w danej sieci wirtualnej, trasa mogą być nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="ae185-151">If **nextHopType** is *VPNGateway* and there is no gateway provisioned/running in the given VNet, the route may become invalid.</span></span>
7. <span data-ttu-id="ae185-152">Brak trasy do *WestUS VNET3* sieciami wirtualnymi (prefiks 10.10.0.0/16) z *WestUS VNet1* (prefiksu 10.9.0.0/16) na obrazie w poprzednim kroku.</span><span class="sxs-lookup"><span data-stu-id="ae185-152">There is no route listed to the *WestUS-VNET3* VNet (Prefix 10.10.0.0/16) from the *WestUS-VNet1* (Prefix 10.9.0.0/16) in the picture in the previous step.</span></span> <span data-ttu-id="ae185-153">Na poniższej ilustracji komunikacji równorzędnej łącze znajduje się w *Rozłączono* stanu:</span><span class="sxs-lookup"><span data-stu-id="ae185-153">In the following picture, the peering link is in the *Disconnected* state:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image4.png)

    <span data-ttu-id="ae185-154">Łącze dwukierunkowe dla komunikacji równorzędnej jest uszkodzona, który wyjaśnia dlaczego VM1 nie może połączyć się VM3 w *WestUS VNet3* sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-154">The bi-directional link for the peering is broken, which explains why VM1 could not connect to VM3 in the *WestUS-VNet3* VNet.</span></span>
8. <span data-ttu-id="ae185-155">Na poniższej ilustracji przedstawiono trasy po ustanowieniu łącza komunikacji równorzędnej dwukierunkowe:</span><span class="sxs-lookup"><span data-stu-id="ae185-155">The following picture shows the routes after establishing the bi-directional peering link:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image5.png)

<span data-ttu-id="ae185-156">Więcej rozwiązywania scenariusze w przypadku oceny tunelowanie wymuszone i tras, przeczytaj [zagadnienia](virtual-network-routes-troubleshoot-portal.md#considerations) sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="ae185-156">For more troubleshooting scenarios for forced-tunneling and route evaluation, read the [Considerations](virtual-network-routes-troubleshoot-portal.md#considerations) section of this article.</span></span>

### <a name="view-effective-routes-for-a-network-interface"></a><span data-ttu-id="ae185-157">Widok skuteczne trasy dla interfejsu sieciowego</span><span class="sxs-lookup"><span data-stu-id="ae185-157">View effective routes for a network interface</span></span>
<span data-ttu-id="ae185-158">Jeśli jest w pełni funkcjonalne przepływ ruchu sieciowego dla konkretnego interfejsu sieciowego (NIC), można wyświetlić pełną listę tras skuteczne karty sieciowej bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="ae185-158">If network traffic flow is impacted for a particular network interface (NIC), you can view a full list of effective routes on a NIC directly.</span></span> <span data-ttu-id="ae185-159">Aby wyświetlić trasy agregacji, które są stosowane do karty Sieciowej, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="ae185-159">To see the aggregate routes that are applied to a NIC, complete the following steps:</span></span>

1. <span data-ttu-id="ae185-160">Zaloguj się do portalu Azure pod adresem https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="ae185-160">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="ae185-161">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **interfejsy sieciowe**</span><span class="sxs-lookup"><span data-stu-id="ae185-161">Click **More services**, then click **Network interfaces**</span></span>
3. <span data-ttu-id="ae185-162">Wyszukaj liście Nazwa karty sieciowej, lub wybierz ją z listy.</span><span class="sxs-lookup"><span data-stu-id="ae185-162">Search the list for the name of a NIC, or select it from the list that appears.</span></span> <span data-ttu-id="ae185-163">W tym przykładzie **VM1 NIC1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="ae185-163">In this example, **VM1-NIC1** is selected.</span></span>
4. <span data-ttu-id="ae185-164">Wybierz **skuteczne tras** w **interfejsu sieciowego** bloku, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ae185-164">Select **Effective routes** in the **Network interface** blade, as shown in the following picture:</span></span>

       ![](./media/virtual-network-routes-troubleshoot-portal/image6.png)

    <span data-ttu-id="ae185-165">**Zakres** domyślnie wybrany interfejs sieciowy.</span><span class="sxs-lookup"><span data-stu-id="ae185-165">The **Scope** defaults to the network interface selected.</span></span>

      ![](./media/virtual-network-routes-troubleshoot-portal/image7.png)

### <a name="view-effective-routes-for-a-route-table"></a><span data-ttu-id="ae185-166">Widok skuteczne trasy dla tabeli tras</span><span class="sxs-lookup"><span data-stu-id="ae185-166">View effective routes for a route table</span></span>
<span data-ttu-id="ae185-167">Podczas modyfikowania trasy zdefiniowane przez użytkownika (Udr) w tabeli tras, można przejrzeć wpływ tras dodawany na określonej maszynie Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-167">When modifying user-defined routes (UDRs) in a route table, you may want to review the impact of the routes being added on a particular VM.</span></span> <span data-ttu-id="ae185-168">Tabeli tras można skojarzyć z dowolną liczbą podsieci.</span><span class="sxs-lookup"><span data-stu-id="ae185-168">A route table can be associated with any number of subnets.</span></span> <span data-ttu-id="ae185-169">Możesz teraz przeglądać skuteczne trasy dla wszystkich kart zastosowane tabelę tras danego, bez konieczności przełączania kontekstu za pomocą bloku tabeli daną trasą.</span><span class="sxs-lookup"><span data-stu-id="ae185-169">You can now view all the effective routes for all the NICs that a given route table is applied to, without having to switch context from the given route table blade.</span></span>

<span data-ttu-id="ae185-170">Na przykład przez (*UDRoute*) jest określona w tabeli tras (*UDRouteTable*).</span><span class="sxs-lookup"><span data-stu-id="ae185-170">For this example, a UDR (*UDRoute*) is specified in a route table (*UDRouteTable*).</span></span> <span data-ttu-id="ae185-171">Ta trasa wysyła wszystkie ruch internetowy pochodzący od *podsieć1* w *WestUS VNet1* sieci wirtualnej przez urządzenie wirtualne sieci (NVA) w *podsieć2* z tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-171">This route sends all Internet traffic from *Subnet1* in the *WestUS-VNet1* VNet, through a network virtual appliance (NVA), in *Subnet2* of the same VNet.</span></span> <span data-ttu-id="ae185-172">Trasy pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ae185-172">The route is shown in the following picture:</span></span>

![](./media/virtual-network-routes-troubleshoot-portal/image8.png)

<span data-ttu-id="ae185-173">Aby wyświetlić łączny trasy dla tabeli tras, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="ae185-173">To see the aggregate routes for a route table, complete the following steps:</span></span>

1. <span data-ttu-id="ae185-174">Zaloguj się do portalu Azure pod adresem https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="ae185-174">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="ae185-175">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **tabel tras**</span><span class="sxs-lookup"><span data-stu-id="ae185-175">Click **More services**, then click **Route tables**</span></span>
3. <span data-ttu-id="ae185-176">Wyszukaj listę do tabeli tras, którą chcesz znajduje łączny trasy dla i zaznacz go.</span><span class="sxs-lookup"><span data-stu-id="ae185-176">Search the list for the route table you want to see aggregate routes for and select it.</span></span> <span data-ttu-id="ae185-177">W tym przykładzie **UDRouteTable** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="ae185-177">In this example, **UDRouteTable** is selected.</span></span> <span data-ttu-id="ae185-178">Zostanie wyświetlony blok dla tabeli wybranej trasy, jak pokazano na poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="ae185-178">A blade for the selected route table appears, as shown in the following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image9.png)
4. <span data-ttu-id="ae185-179">Wybierz **skuteczne tras** w **tabeli tras** bloku.</span><span class="sxs-lookup"><span data-stu-id="ae185-179">Select **Effective Routes** in the **Route table** blade.</span></span> <span data-ttu-id="ae185-180">**Zakres** ma ustawioną wartość wybranego tabeli tras.</span><span class="sxs-lookup"><span data-stu-id="ae185-180">The **Scope** is set to the route table you selected.</span></span>
5. <span data-ttu-id="ae185-181">Tabela tras może odnosić się do wielu podsieci.</span><span class="sxs-lookup"><span data-stu-id="ae185-181">A route table can be applied to multiple subnets.</span></span> <span data-ttu-id="ae185-182">Wybierz **podsieci** chcesz przejrzeć na liście.</span><span class="sxs-lookup"><span data-stu-id="ae185-182">Select the **Subnet** you want to review from the list.</span></span> <span data-ttu-id="ae185-183">W tym przykładzie **podsieć1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="ae185-183">In this example, **Subnet1** is selected.</span></span>
6. <span data-ttu-id="ae185-184">Wybierz **interfejs sieciowy**.</span><span class="sxs-lookup"><span data-stu-id="ae185-184">Select a **Network Interface**.</span></span> <span data-ttu-id="ae185-185">Wszystkie karty sieciowe podłączone do wybranej podsieci są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="ae185-185">All NICs connected to the selected subnet are listed.</span></span> <span data-ttu-id="ae185-186">W tym przykładzie **VM1 NIC1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="ae185-186">In this example, **VM1-NIC1** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image10.png)

   > [!NOTE]
   > <span data-ttu-id="ae185-187">Jeśli karta sieciowa nie jest skojarzony z uruchomionej maszyny Wirtualnej, są wyświetlane nie skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="ae185-187">If the NIC is not associated with a running VM, no effective routes are shown.</span></span>
   >
   >

## <a name="considerations"></a><span data-ttu-id="ae185-188">Zagadnienia do rozważenia</span><span class="sxs-lookup"><span data-stu-id="ae185-188">Considerations</span></span>
<span data-ttu-id="ae185-189">Zwrócono kilka rzeczy, które należy wziąć pod uwagę podczas przeglądania listy tras:</span><span class="sxs-lookup"><span data-stu-id="ae185-189">A few things to keep in mind when reviewing the list of routes returned:</span></span>

* <span data-ttu-id="ae185-190">Routing jest oparta na Najdłuższy prefiks dopasowania (LPM) Wybierane spośród Udr, trasy protokołu BGP i systemu.</span><span class="sxs-lookup"><span data-stu-id="ae185-190">Routing is based on Longest Prefix Match (LPM) among UDRs, BGP and system routes.</span></span> <span data-ttu-id="ae185-191">Jeśli istnieje więcej niż jedna trasa z tym samym dopasowaniem LPM, następnie wybór trasy odbywa się w następującej kolejności:</span><span class="sxs-lookup"><span data-stu-id="ae185-191">If there is more than one route with the same LPM match, then a route is selected based on its origin in the following order:</span></span>

  * <span data-ttu-id="ae185-192">Trasa zdefiniowana przez użytkownika</span><span class="sxs-lookup"><span data-stu-id="ae185-192">User-defined route</span></span>
  * <span data-ttu-id="ae185-193">Trasa protokołu BGP</span><span class="sxs-lookup"><span data-stu-id="ae185-193">BGP route</span></span>
  * <span data-ttu-id="ae185-194">Trasa systemowa (ustawienie domyślne)</span><span class="sxs-lookup"><span data-stu-id="ae185-194">System (Default) route</span></span>

    <span data-ttu-id="ae185-195">Skuteczne trasy może zobaczyć tylko skuteczne ścieżek, które są dopasowaniem LPM oparte na trasach są one dostępne.</span><span class="sxs-lookup"><span data-stu-id="ae185-195">With effective routes, you can only see effective routes that are LPM match based on all the availble routes.</span></span> <span data-ttu-id="ae185-196">Przez pokazanie, jak trasy faktycznie są oceniane pod kątem danej karty Sieciowej, dzięki temu znacznie łatwiejsze Rozwiązywanie problemów z określonej trasy, które mogą mieć wpływ na łączność z maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-196">By showing how the routes are actually evaluated for a given NIC, this makes it a lot easier to troubleshoot specific routes that may be impacting connectivity to/from your VM.</span></span>
* <span data-ttu-id="ae185-197">Jeśli masz Udr i wysyłania ruchu do sieci (NVA), urządzenie wirtualne z *VirtualAppliance* jako **Typ następnego przeskoku**, upewnij się, że przekazywanie IP jest włączona na NVA odbieranie ruchu lub pakietów porzucone.</span><span class="sxs-lookup"><span data-stu-id="ae185-197">If you have UDRs and are sending traffic to a network virtual appliance (NVA), with *VirtualAppliance* as **nextHopType**, ensure that IP forwarding is enabled on the NVA receiving the traffic or packets are dropped.</span></span>
* <span data-ttu-id="ae185-198">Jeśli włączono wymuszony tunelowania cały ruch wychodzący z Internetem będą kierowane do lokalnego.</span><span class="sxs-lookup"><span data-stu-id="ae185-198">If Forced tunneling is enabled, all outbound Internet traffic will be routed to on-premises.</span></span> <span data-ttu-id="ae185-199">Protokołu RDP/SSH z Internetu do maszyny Wirtualnej może nie działać z tym ustawieniem, w zależności od tego, jak lokalną obsługuje ten ruch.</span><span class="sxs-lookup"><span data-stu-id="ae185-199">RDP/SSH from Internet to your VM may not work with this setting, depending on how the on-premises handles this traffic.</span></span>
  <span data-ttu-id="ae185-200">Tunelowanie wymuszone można włączyć:</span><span class="sxs-lookup"><span data-stu-id="ae185-200">Forced-tunneling can be enabled:</span></span>
  * <span data-ttu-id="ae185-201">Jeśli przy użyciu sieci VPN typu lokacja lokacja, ustawiając trasy zdefiniowane przez użytkownika (przez) z Typ następnego przeskoku jako brama sieci VPN</span><span class="sxs-lookup"><span data-stu-id="ae185-201">If using site-to-site VPN, by setting a user-defined route (UDR) with nextHopType as VPN Gateway</span></span>
  * <span data-ttu-id="ae185-202">Jeśli trasa domyślna jest anonsowana za pośrednictwem protokołu BGP</span><span class="sxs-lookup"><span data-stu-id="ae185-202">If a default route is advertised over BGP</span></span>
* <span data-ttu-id="ae185-203">Dla sieci wirtualnej komunikacji równorzędnej ruchu działał prawidłowo, trasa systemu o **Typ następnego przeskoku** *VNetPeering* musi istnieć dla zakresu prefiksu peered sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-203">For VNet peering traffic to work correctly, a system route with **nextHopType** *VNetPeering* must exist for the peered VNet’s prefix range.</span></span> <span data-ttu-id="ae185-204">Jeśli taka trasa nie istnieje, a łącze sieci wirtualnej komunikacji równorzędnej wygląda OK:</span><span class="sxs-lookup"><span data-stu-id="ae185-204">If such a route doesn’t exist and the VNet peering link looks OK:</span></span>
  * <span data-ttu-id="ae185-205">Poczekaj kilka sekund, a następnie spróbuj ponownie, jeśli jest to nowo utworzonego łącze komunikacji równorzędnej.</span><span class="sxs-lookup"><span data-stu-id="ae185-205">Wait a few seconds and retry if it's a newly established peering link.</span></span> <span data-ttu-id="ae185-206">Od czasu do czasu zajmuje więcej czasu propagowania tras dla wszystkich interfejsów sieciowych w podsieci.</span><span class="sxs-lookup"><span data-stu-id="ae185-206">It occasionally takes longer to propagate routes to all the network interfaces in a subnet.</span></span>
  * <span data-ttu-id="ae185-207">Zasady grupy zabezpieczeń sieci (NSG) może mieć wpływ na przepływów ruchu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="ae185-207">Network Security Group (NSG) rules may be impacting the traffic flows.</span></span> <span data-ttu-id="ae185-208">Aby uzyskać więcej informacji, zobacz [Rozwiązywanie problemów z grup zabezpieczeń sieci](virtual-network-nsg-troubleshoot-portal.md) artykułu.</span><span class="sxs-lookup"><span data-stu-id="ae185-208">For more information, see the [Troubleshoot Network Security Groups](virtual-network-nsg-troubleshoot-portal.md) article.</span></span>
