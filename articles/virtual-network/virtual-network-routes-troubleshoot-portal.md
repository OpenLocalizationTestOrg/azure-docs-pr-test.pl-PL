---
title: trasy aaaTroubleshoot - Portal | Dokumentacja firmy Microsoft
description: "Dowiedz się, jak trasy tootroubleshoot przy użyciu modelu wdrażania usługi Azure Resource Manager hello hello portalu Azure."
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: bdd8b6dc-02fb-4057-bb23-8289caa9de89
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: 579bae91ef3200852032b3953d3cc5d26deada86
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-routes-using-hello-azure-portal"></a><span data-ttu-id="5146f-103">Rozwiązywanie problemów z tras za pomocą hello portalu Azure</span><span class="sxs-lookup"><span data-stu-id="5146f-103">Troubleshoot routes using hello Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="5146f-104">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="5146f-104">Azure Portal</span></span>](virtual-network-routes-troubleshoot-portal.md)
> * [<span data-ttu-id="5146f-105">PowerShell</span><span class="sxs-lookup"><span data-stu-id="5146f-105">PowerShell</span></span>](virtual-network-routes-troubleshoot-powershell.md)
>
>

<span data-ttu-id="5146f-106">Jeśli występują tooor problemy dotyczące łączności sieciowej z sieci maszyny wirtualnej Azure (VM), tras może mieć wpływ na Twoje ruch maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-106">If you are experiencing network connectivity issues tooor from your Azure Virtual Machine (VM), routes may be impacting your VM traffic flows.</span></span> <span data-ttu-id="5146f-107">Ten artykuł zawiera omówienie funkcji diagnostyki dla tras toohelp dalsze poszukiwanie rozwiązania problemu.</span><span class="sxs-lookup"><span data-stu-id="5146f-107">This article provides an overview of diagnostics capabilities for routes toohelp troubleshoot further.</span></span>

<span data-ttu-id="5146f-108">Tabele tras są skojarzone z podsieciami i obowiązują na wszystkich interfejsach sieciowych (NIC) w tej podsieci.</span><span class="sxs-lookup"><span data-stu-id="5146f-108">Route tables are associated with subnets and are effective on all network interfaces (NIC) in that subnet.</span></span> <span data-ttu-id="5146f-109">następujące typy tras Hello może być zastosowane tooeach interfejsu sieciowego:</span><span class="sxs-lookup"><span data-stu-id="5146f-109">hello following types of routes can be applied tooeach network interface:</span></span>

* <span data-ttu-id="5146f-110">**Trasy systemowe:** Domyślnie każda podsieć utworzona w sieci wirtualnej platformy Azure (VNet) ma tabel tras systemu, które umożliwiają lokalnej sieci wirtualnej ruch, ruch lokalnej za pośrednictwem bramy sieci VPN i ruchu internetowego.</span><span class="sxs-lookup"><span data-stu-id="5146f-110">**System routes:** By default, every subnet created in an Azure Virtual Network (VNet) has system route tables that allow local VNet traffic, on-premises traffic via VPN gateways, and Internet traffic.</span></span> <span data-ttu-id="5146f-111">Istnieją również tras systemowych dla połączyć za pomocą sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="5146f-111">System routes also exist for peered VNets.</span></span>
* <span data-ttu-id="5146f-112">**Trasy protokołu BGP:** propagowane interfejsów toonetwork za pośrednictwem usługi ExpressRoute lub połączeń VPN lokacja lokacja.</span><span class="sxs-lookup"><span data-stu-id="5146f-112">**BGP routes:** Propagated toonetwork interfaces through ExpressRoute or site-to-site VPN connections.</span></span> <span data-ttu-id="5146f-113">Dowiedz się więcej o routingu BGP, odczytując hello [protokołu BGP z bramy sieci VPN](../vpn-gateway/vpn-gateway-bgp-overview.md) i [omówienie ExpressRoute](../expressroute/expressroute-introduction.md) artykułów.</span><span class="sxs-lookup"><span data-stu-id="5146f-113">Learn more about BGP routing by reading hello [BGP with VPN gateways](../vpn-gateway/vpn-gateway-bgp-overview.md) and [ExpressRoute overview](../expressroute/expressroute-introduction.md) articles.</span></span>
* <span data-ttu-id="5146f-114">**Trasy zdefiniowane przez użytkownika (przez):** Jeśli używasz wirtualnych urządzeń sieciowych lub są wymuszone tunelowanie ruchu tooan sieci lokalnej za pośrednictwem sieci VPN lokacja lokacja, może być zdefiniowana przez użytkownika tras (Udr) skojarzone z tabeli tras podsieci.</span><span class="sxs-lookup"><span data-stu-id="5146f-114">**User-defined routes (UDR):** If you are using network virtual appliances or are forced-tunneling traffic tooan on-premises network via a site-to-site VPN, you may have user-defined routes (UDRs) associated with your subnet route table.</span></span> <span data-ttu-id="5146f-115">Jeśli nie masz doświadczenia w obsłudze Udr, przeczytaj hello [trasy zdefiniowane przez użytkownika](virtual-networks-udr-overview.md#user-defined-routes) artykułu.</span><span class="sxs-lookup"><span data-stu-id="5146f-115">If you're not familiar with UDRs, read hello [user-defined routes](virtual-networks-udr-overview.md#user-defined-routes) article.</span></span>

<span data-ttu-id="5146f-116">Z hello różne trasy, które mogą być zastosowane tooa interfejsu sieciowego, może być trudne toodetermine obowiązują agregacji trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-116">With hello various routes that can be applied tooa network interface, it can be difficult toodetermine which aggregate routes are effective.</span></span> <span data-ttu-id="5146f-117">toohelp rozwiązywania problemów z połączeniami sieci maszyny Wirtualnej, można wyświetlić wszystkie hello skuteczne trasy dla interfejsu sieciowego w modelu wdrażania usługi Azure Resource Manager hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-117">toohelp troubleshoot VM network connectivity, you can view all hello effective routes for a network interface in hello Azure Resource Manager deployment model.</span></span>

## <a name="using-effective-routes-tootroubleshoot-vm-traffic-flow"></a><span data-ttu-id="5146f-118">Przy użyciu przepływu ruchu maszyny Wirtualnej tootroubleshoot skuteczne tras</span><span class="sxs-lookup"><span data-stu-id="5146f-118">Using Effective Routes tootroubleshoot VM traffic flow</span></span>
<span data-ttu-id="5146f-119">W tym artykule wykorzystano powitania po scenariusz jako tooillustrate przykład, jak skuteczne hello tootroubleshoot trasy dla interfejsu sieciowego:</span><span class="sxs-lookup"><span data-stu-id="5146f-119">This article uses hello following scenario as an example tooillustrate how tootroubleshoot hello effective routes for a network interface:</span></span>

<span data-ttu-id="5146f-120">Maszyna wirtualna (*VM1*) połączony toohello sieci wirtualnej (*VNet1*, prefiks: 10.9.0.0/16) nie powiedzie się tooa tooconnect VM(VM3) w nowo peered sieci wirtualnej (*VNet3*, prefiks 10.10.0.0/16).</span><span class="sxs-lookup"><span data-stu-id="5146f-120">A VM (*VM1*) connected toohello VNet (*VNet1*, prefix: 10.9.0.0/16) fails tooconnect tooa VM(VM3) in a newly peered VNet (*VNet3*, prefix 10.10.0.0/16).</span></span> <span data-ttu-id="5146f-121">Brak Udr lub BGP kieruje zastosowane NIC1 tooVM1 sieci interfejs podłączony toohello maszyny Wirtualnej, są stosowane tylko tras systemowych.</span><span class="sxs-lookup"><span data-stu-id="5146f-121">There are no UDRs or BGP routes applied tooVM1-NIC1 network interface connected toohello VM, only system routes are applied.</span></span>

<span data-ttu-id="5146f-122">W tym artykule opisano, jak toodetermine hello. Przyczyna niepowodzenia połączenia hello przy użyciu możliwości wprowadzenia trasy w modelu wdrażania zarządzania zasobami Azure.</span><span class="sxs-lookup"><span data-stu-id="5146f-122">This article explains how toodetermine hello cause of hello connection failure, using effective routes capability in Azure Resource Management deployment model.</span></span>
<span data-ttu-id="5146f-123">Gdy hello przykładzie użyto tylko tras systemowych, hello te same kroki można używane toodetermine błędów połączenia przychodzącego i wychodzącego przez dowolnego typu trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-123">While hello example uses only system routes, hello same steps can be used toodetermine inbound and outbound connection failures over any route type.</span></span>

> [!NOTE]
> <span data-ttu-id="5146f-124">Jeśli maszyna wirtualna ma więcej niż jedną kartę Sieciową podłączoną, sprawdź skuteczne trasy dla każdego hello tooand sieci toodiagnose kart sieciowych problemy dotyczące łączności z maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-124">If your VM has more than one NIC attached, check effective routes for each of hello NICs toodiagnose network connectivity issues tooand from a VM.</span></span>
>
>

### <a name="view-effective-routes-for-a-virtual-machine"></a><span data-ttu-id="5146f-125">Widok skuteczne trasy dla maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="5146f-125">View effective routes for a virtual machine</span></span>
<span data-ttu-id="5146f-126">toosee hello agregacji tras, na których są stosowane tooa maszyny Wirtualnej, pełną hello następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="5146f-126">toosee hello aggregate routes that are applied tooa VM, complete hello following steps:</span></span>

1. <span data-ttu-id="5146f-127">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="5146f-127">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="5146f-128">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **maszyn wirtualnych** na liście hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-128">Click **More services**, then click **Virtual machines** in hello list that appears.</span></span>
3. <span data-ttu-id="5146f-129">Wybierz z listy hello tootroubleshoot maszyny Wirtualnej i zostanie wyświetlony blok maszyny Wirtualnej, z opcjami.</span><span class="sxs-lookup"><span data-stu-id="5146f-129">Select a VM tootroubleshoot from hello list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="5146f-130">Kliknij przycisk **Diagnozuj & rozwiązywania problemów** , a następnie wybierz powszechny problem.</span><span class="sxs-lookup"><span data-stu-id="5146f-130">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="5146f-131">Na przykład **toomy maszyny Wirtualnej systemu Windows nie można połączyć z** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="5146f-131">For this example, **I can’t connect toomy Windows VM** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image1.png)
5. <span data-ttu-id="5146f-132">Kroki są wyświetlane w polu hello problem, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-132">Steps appear under hello problem, as shown in hello following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image2.png)

    <span data-ttu-id="5146f-133">Kliknij przycisk *skuteczne tras* hello liście zalecanych kroków.</span><span class="sxs-lookup"><span data-stu-id="5146f-133">Click *effective routes* in hello list of recommended steps.</span></span>
6. <span data-ttu-id="5146f-134">Witaj **skuteczne tras** zostanie wyświetlony blok, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-134">hello **Effective routes** blade appears, as shown in hello following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image3.png)

    <span data-ttu-id="5146f-135">Jeśli maszyna wirtualna ma tylko jedną kartę Sieciową, jest wybrany domyślnie.</span><span class="sxs-lookup"><span data-stu-id="5146f-135">If your VM has only one NIC, it is selected by default.</span></span> <span data-ttu-id="5146f-136">Jeśli masz więcej niż jedną kartę Sieciową, wybierz hello kart interfejsu Sieciowego, dla której ma zostać tooview hello skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-136">If you have more than one NIC, select hello NIC for which you want tooview hello effective routes.</span></span>

   > [!NOTE]
   > <span data-ttu-id="5146f-137">Jeśli hello maszyny Wirtualnej skojarzone z hello NIC nie jest w stanie uruchomienia, skutecznego trasy nie będą wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="5146f-137">If hello VM associated with hello NIC is not in a running state, effective routes will not be shown.</span></span> <span data-ttu-id="5146f-138">Tylko hello pierwszych 200 skuteczne trasy są wyświetlane w portalu hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-138">Only hello first 200 effective routes are shown in hello portal.</span></span> <span data-ttu-id="5146f-139">Aby uzyskać pełną listę hello, kliknij **Pobierz**.</span><span class="sxs-lookup"><span data-stu-id="5146f-139">For hello full list, click **Download**.</span></span> <span data-ttu-id="5146f-140">Dodatkowo można filtrować na powitania wyniki z pliku CSV pobrany hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-140">You can further filter on hello results from hello downloaded .csv file.</span></span>
   >
   >

    <span data-ttu-id="5146f-141">Zwróć uwagę hello następujących danych wyjściowych hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-141">Notice hello following in hello output:</span></span>

   * <span data-ttu-id="5146f-142">**Źródło**: wskazuje typ hello trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-142">**Source**: Indicates hello type of route.</span></span> <span data-ttu-id="5146f-143">Trasy systemowe są wyświetlane jako *domyślne*, Udr są wyświetlane jako *użytkownika* i tras bramy (statyczny lub BGP) są wyświetlane jako *właściwość VPNGateway*.</span><span class="sxs-lookup"><span data-stu-id="5146f-143">System routes are shown as *Default*, UDRs are shown as *User* and gateway routes (static or BGP) are shown as *VPNGateway*.</span></span>
   * <span data-ttu-id="5146f-144">**Stan**: wskazuje stan hello skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-144">**State**: Indicates state of hello effective route.</span></span> <span data-ttu-id="5146f-145">Możliwe wartości to *Active* lub *nieprawidłowy*.</span><span class="sxs-lookup"><span data-stu-id="5146f-145">Possible values are *Active* or *Invalid*.</span></span>
   * <span data-ttu-id="5146f-146">**AddressPrefixes**: Określa prefiks adresu hello hello skuteczne trasy w notacji CIDR.</span><span class="sxs-lookup"><span data-stu-id="5146f-146">**AddressPrefixes**: Specifies hello address prefix of hello effective route in CIDR notation.</span></span>
   * <span data-ttu-id="5146f-147">**Typ następnego przeskoku**: wskazuje hello następnego skoku dla hello podane trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-147">**nextHopType**: Indicates hello next hop for hello given route.</span></span> <span data-ttu-id="5146f-148">Możliwe wartości to *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering*, lub *Null*.</span><span class="sxs-lookup"><span data-stu-id="5146f-148">Possible values are *VirtualAppliance*, *Internet*, *VNetLocal*, *VNetPeering*, or *Null*.</span></span> <span data-ttu-id="5146f-149">Wartość *Null* dla **Typ następnego przeskoku** przez może oznaczać nieprawidłową trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-149">A value of *Null* for **nextHopType** in a UDR may indicate an invalid route.</span></span> <span data-ttu-id="5146f-150">Na przykład jeśli **Typ następnego przeskoku** jest *VirtualAppliance* i urządzenie wirtualne sieci hello maszyna wirtualna nie jest w stanie zainicjowano obsługę administracyjną uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="5146f-150">For example, if **nextHopType** is *VirtualAppliance* and hello network virtual appliance VM is not in a provisioned/running state.</span></span> <span data-ttu-id="5146f-151">Jeśli **Typ następnego przeskoku** jest *właściwość VPNGateway* i nie Brak bramy elastycznie/uruchomiony w hello podanej sieci wirtualnej, trasa hello mogą być nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="5146f-151">If **nextHopType** is *VPNGateway* and there is no gateway provisioned/running in hello given VNet, hello route may become invalid.</span></span>
7. <span data-ttu-id="5146f-152">Nie istnieje żadne toohello trasy wymienione *WestUS VNET3* sieciami wirtualnymi (prefiks 10.10.0.0/16) z hello *WestUS VNet1* (prefiksu 10.9.0.0/16) w obraz powitania w poprzednim kroku hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-152">There is no route listed toohello *WestUS-VNET3* VNet (Prefix 10.10.0.0/16) from hello *WestUS-VNet1* (Prefix 10.9.0.0/16) in hello picture in hello previous step.</span></span> <span data-ttu-id="5146f-153">W poniższej ilustracji hello, hello komunikacji równorzędnej łącze znajduje się w hello *Rozłączono* stanu:</span><span class="sxs-lookup"><span data-stu-id="5146f-153">In hello following picture, hello peering link is in hello *Disconnected* state:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image4.png)

    <span data-ttu-id="5146f-154">Hello łącze dwukierunkowe dla komunikacji równorzędnej hello jest uszkodzona, który wyjaśnia dlaczego VM1 nie może połączyć tooVM3 w hello *WestUS VNet3* sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-154">hello bi-directional link for hello peering is broken, which explains why VM1 could not connect tooVM3 in hello *WestUS-VNet3* VNet.</span></span>
8. <span data-ttu-id="5146f-155">Witaj poniższej ilustracji przedstawiono trasy powitania po ustanowieniu komunikacji równorzędnej łącza dwukierunkowe hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-155">hello following picture shows hello routes after establishing hello bi-directional peering link:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image5.png)

<span data-ttu-id="5146f-156">Więcej rozwiązywania scenariusze w przypadku oceny tunelowanie wymuszone i tras, przeczytaj hello [zagadnienia](virtual-network-routes-troubleshoot-portal.md#considerations) sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="5146f-156">For more troubleshooting scenarios for forced-tunneling and route evaluation, read hello [Considerations](virtual-network-routes-troubleshoot-portal.md#considerations) section of this article.</span></span>

### <a name="view-effective-routes-for-a-network-interface"></a><span data-ttu-id="5146f-157">Widok skuteczne trasy dla interfejsu sieciowego</span><span class="sxs-lookup"><span data-stu-id="5146f-157">View effective routes for a network interface</span></span>
<span data-ttu-id="5146f-158">Jeśli jest w pełni funkcjonalne przepływ ruchu sieciowego dla konkretnego interfejsu sieciowego (NIC), można wyświetlić pełną listę tras skuteczne karty sieciowej bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="5146f-158">If network traffic flow is impacted for a particular network interface (NIC), you can view a full list of effective routes on a NIC directly.</span></span> <span data-ttu-id="5146f-159">toosee hello agregacji tras, na których są stosowane tooa karty Sieciowej, pełną hello następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="5146f-159">toosee hello aggregate routes that are applied tooa NIC, complete hello following steps:</span></span>

1. <span data-ttu-id="5146f-160">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="5146f-160">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="5146f-161">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **interfejsy sieciowe**</span><span class="sxs-lookup"><span data-stu-id="5146f-161">Click **More services**, then click **Network interfaces**</span></span>
3. <span data-ttu-id="5146f-162">Wyszukaj hello liście hello nazwa karty sieciowej, lub wybierz ją z listy hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-162">Search hello list for hello name of a NIC, or select it from hello list that appears.</span></span> <span data-ttu-id="5146f-163">W tym przykładzie **VM1 NIC1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="5146f-163">In this example, **VM1-NIC1** is selected.</span></span>
4. <span data-ttu-id="5146f-164">Wybierz **skuteczne tras** w hello **interfejsu sieciowego** bloku, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-164">Select **Effective routes** in hello **Network interface** blade, as shown in hello following picture:</span></span>

       ![](./media/virtual-network-routes-troubleshoot-portal/image6.png)

    <span data-ttu-id="5146f-165">Witaj **zakres** interfejsu sieciowego toohello domyślne wybrane.</span><span class="sxs-lookup"><span data-stu-id="5146f-165">hello **Scope** defaults toohello network interface selected.</span></span>

      ![](./media/virtual-network-routes-troubleshoot-portal/image7.png)

### <a name="view-effective-routes-for-a-route-table"></a><span data-ttu-id="5146f-166">Widok skuteczne trasy dla tabeli tras</span><span class="sxs-lookup"><span data-stu-id="5146f-166">View effective routes for a route table</span></span>
<span data-ttu-id="5146f-167">Podczas modyfikowania trasy zdefiniowane przez użytkownika (Udr) w tabeli tras, może być wpływ hello tooreview tras hello dodawany na określonej maszynie Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-167">When modifying user-defined routes (UDRs) in a route table, you may want tooreview hello impact of hello routes being added on a particular VM.</span></span> <span data-ttu-id="5146f-168">Tabeli tras można skojarzyć z dowolną liczbą podsieci.</span><span class="sxs-lookup"><span data-stu-id="5146f-168">A route table can be associated with any number of subnets.</span></span> <span data-ttu-id="5146f-169">Możesz teraz przeglądać wszystkie hello trasy skuteczne dla hello wszystkie karty sieciowe obsługujące tabelę tras danego jest stosowany do, bez konieczności kontekst tooswitch od hello podane bloku tabeli tras.</span><span class="sxs-lookup"><span data-stu-id="5146f-169">You can now view all hello effective routes for all hello NICs that a given route table is applied to, without having tooswitch context from hello given route table blade.</span></span>

<span data-ttu-id="5146f-170">Na przykład przez (*UDRoute*) jest określona w tabeli tras (*UDRouteTable*).</span><span class="sxs-lookup"><span data-stu-id="5146f-170">For this example, a UDR (*UDRoute*) is specified in a route table (*UDRouteTable*).</span></span> <span data-ttu-id="5146f-171">Ta trasa wysyła wszystkie ruch internetowy pochodzący od *podsieć1* w hello *WestUS VNet1* sieci wirtualnej przez urządzenie wirtualne sieci (NVA) w *podsieć2* z hello tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-171">This route sends all Internet traffic from *Subnet1* in hello *WestUS-VNet1* VNet, through a network virtual appliance (NVA), in *Subnet2* of hello same VNet.</span></span> <span data-ttu-id="5146f-172">trasy Hello jest wyświetlany w hello poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="5146f-172">hello route is shown in hello following picture:</span></span>

![](./media/virtual-network-routes-troubleshoot-portal/image8.png)

<span data-ttu-id="5146f-173">toosee hello agregacji trasy dla tabeli tras, pełną hello następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="5146f-173">toosee hello aggregate routes for a route table, complete hello following steps:</span></span>

1. <span data-ttu-id="5146f-174">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="5146f-174">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="5146f-175">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **tabel tras**</span><span class="sxs-lookup"><span data-stu-id="5146f-175">Click **More services**, then click **Route tables**</span></span>
3. <span data-ttu-id="5146f-176">Lista hello wyszukiwania dla tabeli tras hello mają toosee agregacji trasy dla i zaznacz go.</span><span class="sxs-lookup"><span data-stu-id="5146f-176">Search hello list for hello route table you want toosee aggregate routes for and select it.</span></span> <span data-ttu-id="5146f-177">W tym przykładzie **UDRouteTable** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="5146f-177">In this example, **UDRouteTable** is selected.</span></span> <span data-ttu-id="5146f-178">Zostanie wyświetlony blok dla tabeli tras hello zaznaczone, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-178">A blade for hello selected route table appears, as shown in hello following picture:</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image9.png)
4. <span data-ttu-id="5146f-179">Wybierz **skuteczne tras** w hello **tabeli tras** bloku.</span><span class="sxs-lookup"><span data-stu-id="5146f-179">Select **Effective Routes** in hello **Route table** blade.</span></span> <span data-ttu-id="5146f-180">Witaj **zakres** ustawiono tabeli tras toohello wybrane.</span><span class="sxs-lookup"><span data-stu-id="5146f-180">hello **Scope** is set toohello route table you selected.</span></span>
5. <span data-ttu-id="5146f-181">Tabelę tras może być zastosowane toomultiple podsieci.</span><span class="sxs-lookup"><span data-stu-id="5146f-181">A route table can be applied toomultiple subnets.</span></span> <span data-ttu-id="5146f-182">Wybierz hello **podsieci** ma tooreview z listy hello.</span><span class="sxs-lookup"><span data-stu-id="5146f-182">Select hello **Subnet** you want tooreview from hello list.</span></span> <span data-ttu-id="5146f-183">W tym przykładzie **podsieć1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="5146f-183">In this example, **Subnet1** is selected.</span></span>
6. <span data-ttu-id="5146f-184">Wybierz **interfejs sieciowy**.</span><span class="sxs-lookup"><span data-stu-id="5146f-184">Select a **Network Interface**.</span></span> <span data-ttu-id="5146f-185">Wszystkie karty sieciowe połączone toohello wybrane podsieci są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="5146f-185">All NICs connected toohello selected subnet are listed.</span></span> <span data-ttu-id="5146f-186">W tym przykładzie **VM1 NIC1** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="5146f-186">In this example, **VM1-NIC1** is selected.</span></span>

    ![](./media/virtual-network-routes-troubleshoot-portal/image10.png)

   > [!NOTE]
   > <span data-ttu-id="5146f-187">Czy hello NIC nie jest skojarzony z uruchomionej maszyny Wirtualnej, są wyświetlane nie skuteczne trasy.</span><span class="sxs-lookup"><span data-stu-id="5146f-187">If hello NIC is not associated with a running VM, no effective routes are shown.</span></span>
   >
   >

## <a name="considerations"></a><span data-ttu-id="5146f-188">Zagadnienia do rozważenia</span><span class="sxs-lookup"><span data-stu-id="5146f-188">Considerations</span></span>
<span data-ttu-id="5146f-189">Zwrócono kilka rzeczy tookeep pamiętać podczas przeglądania listy hello tras:</span><span class="sxs-lookup"><span data-stu-id="5146f-189">A few things tookeep in mind when reviewing hello list of routes returned:</span></span>

* <span data-ttu-id="5146f-190">Routing jest oparta na Najdłuższy prefiks dopasowania (LPM) Wybierane spośród Udr, trasy protokołu BGP i systemu.</span><span class="sxs-lookup"><span data-stu-id="5146f-190">Routing is based on Longest Prefix Match (LPM) among UDRs, BGP and system routes.</span></span> <span data-ttu-id="5146f-191">Jeśli istnieje więcej niż jedna trasa z hello sam LPM zgodne, a następnie, wybór trasy odbywa się w następującej kolejności hello:</span><span class="sxs-lookup"><span data-stu-id="5146f-191">If there is more than one route with hello same LPM match, then a route is selected based on its origin in hello following order:</span></span>

  * <span data-ttu-id="5146f-192">Trasa zdefiniowana przez użytkownika</span><span class="sxs-lookup"><span data-stu-id="5146f-192">User-defined route</span></span>
  * <span data-ttu-id="5146f-193">Trasa protokołu BGP</span><span class="sxs-lookup"><span data-stu-id="5146f-193">BGP route</span></span>
  * <span data-ttu-id="5146f-194">Trasa systemowa (ustawienie domyślne)</span><span class="sxs-lookup"><span data-stu-id="5146f-194">System (Default) route</span></span>

    <span data-ttu-id="5146f-195">Skuteczne trasy może zobaczyć tylko skuteczne ścieżek, które są oparte na wszystkich tras dostępnego hello dopasowaniem LPM.</span><span class="sxs-lookup"><span data-stu-id="5146f-195">With effective routes, you can only see effective routes that are LPM match based on all hello availble routes.</span></span> <span data-ttu-id="5146f-196">Przez pokazanie, jak trasy hello faktycznie są oceniane pod kątem danej karty Sieciowej, ułatwia to znacznie łatwiejsze trasy określonych tootroubleshoot, które mogą mieć wpływ na łączność z maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-196">By showing how hello routes are actually evaluated for a given NIC, this makes it a lot easier tootroubleshoot specific routes that may be impacting connectivity to/from your VM.</span></span>
* <span data-ttu-id="5146f-197">Jeśli masz Udr i wysyłania ruchu tooa sieci urządzenie wirtualne (NVA) z *VirtualAppliance* jako **Typ następnego przeskoku**, upewnij się, że przesyłanie dalej IP jest włączona na odbieranie ruchu hello hello NVA lub pakiety są usuwane.</span><span class="sxs-lookup"><span data-stu-id="5146f-197">If you have UDRs and are sending traffic tooa network virtual appliance (NVA), with *VirtualAppliance* as **nextHopType**, ensure that IP forwarding is enabled on hello NVA receiving hello traffic or packets are dropped.</span></span>
* <span data-ttu-id="5146f-198">Włączenie tunelowania wymuszony cały ruch wychodzący z Internetem będzie routingiem tooon firmą.</span><span class="sxs-lookup"><span data-stu-id="5146f-198">If Forced tunneling is enabled, all outbound Internet traffic will be routed tooon-premises.</span></span> <span data-ttu-id="5146f-199">Protokołu RDP/SSH z tooyour Internet, maszyna wirtualna może nie działać to ustawienie, w zależności od sposobu hello lokalnymi obsługuje ten ruch.</span><span class="sxs-lookup"><span data-stu-id="5146f-199">RDP/SSH from Internet tooyour VM may not work with this setting, depending on how hello on-premises handles this traffic.</span></span>
  <span data-ttu-id="5146f-200">Tunelowanie wymuszone można włączyć:</span><span class="sxs-lookup"><span data-stu-id="5146f-200">Forced-tunneling can be enabled:</span></span>
  * <span data-ttu-id="5146f-201">Jeśli przy użyciu sieci VPN typu lokacja lokacja, ustawiając trasy zdefiniowane przez użytkownika (przez) z Typ następnego przeskoku jako brama sieci VPN</span><span class="sxs-lookup"><span data-stu-id="5146f-201">If using site-to-site VPN, by setting a user-defined route (UDR) with nextHopType as VPN Gateway</span></span>
  * <span data-ttu-id="5146f-202">Jeśli trasa domyślna jest anonsowana za pośrednictwem protokołu BGP</span><span class="sxs-lookup"><span data-stu-id="5146f-202">If a default route is advertised over BGP</span></span>
* <span data-ttu-id="5146f-203">Dla sieci równorzędne — ruch toowork poprawnie, trasa systemu o **Typ następnego przeskoku** *VNetPeering* musi istnieć na powitania połączyć za pomocą sieci wirtualnej firmy prefiks zakresu.</span><span class="sxs-lookup"><span data-stu-id="5146f-203">For VNet peering traffic toowork correctly, a system route with **nextHopType** *VNetPeering* must exist for hello peered VNet’s prefix range.</span></span> <span data-ttu-id="5146f-204">Jeśli taka trasa nie istnieje i hello sieci wirtualnej komunikacji równorzędnej łącze wygląda OK:</span><span class="sxs-lookup"><span data-stu-id="5146f-204">If such a route doesn’t exist and hello VNet peering link looks OK:</span></span>
  * <span data-ttu-id="5146f-205">Poczekaj kilka sekund, a następnie spróbuj ponownie, jeśli jest to nowo utworzonego łącze komunikacji równorzędnej.</span><span class="sxs-lookup"><span data-stu-id="5146f-205">Wait a few seconds and retry if it's a newly established peering link.</span></span> <span data-ttu-id="5146f-206">Od czasu do czasu zajmuje dłużej tras toopropagate interfejsów sieciowych hello tooall w podsieci.</span><span class="sxs-lookup"><span data-stu-id="5146f-206">It occasionally takes longer toopropagate routes tooall hello network interfaces in a subnet.</span></span>
  * <span data-ttu-id="5146f-207">Zasady grupy zabezpieczeń sieci (NSG) może mieć wpływ na powitania przepływów ruchu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="5146f-207">Network Security Group (NSG) rules may be impacting hello traffic flows.</span></span> <span data-ttu-id="5146f-208">Aby uzyskać więcej informacji, zobacz hello [Rozwiązywanie problemów z grup zabezpieczeń sieci](virtual-network-nsg-troubleshoot-portal.md) artykułu.</span><span class="sxs-lookup"><span data-stu-id="5146f-208">For more information, see hello [Troubleshoot Network Security Groups](virtual-network-nsg-troubleshoot-portal.md) article.</span></span>
