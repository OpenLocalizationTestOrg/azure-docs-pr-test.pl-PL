---
title: "aaaTroubleshoot grup zabezpieczeń sieci - Portal | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak grup zabezpieczeń sieci tootroubleshoot we wdrożeniu usługi Azure Resource Manager hello modelu przy użyciu hello portalu Azure."
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: a54feccf-0123-4e49-a743-eb8d0bdd1ebc
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: 0d3d2110fe1507f36e3b933de924a0876db2747a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-network-security-groups-using-hello-azure-portal"></a><span data-ttu-id="13859-103">Rozwiązywanie problemów z grup zabezpieczeń sieci przy użyciu hello portalu Azure</span><span class="sxs-lookup"><span data-stu-id="13859-103">Troubleshoot Network Security Groups using hello Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="13859-104">Azure Portal</span><span class="sxs-lookup"><span data-stu-id="13859-104">Azure Portal</span></span>](virtual-network-nsg-troubleshoot-portal.md)
> * [<span data-ttu-id="13859-105">PowerShell</span><span class="sxs-lookup"><span data-stu-id="13859-105">PowerShell</span></span>](virtual-network-nsg-troubleshoot-powershell.md)
> 
> 

<span data-ttu-id="13859-106">Jeśli skonfigurowana grup zabezpieczeń sieci (NSG) na maszynie wirtualnej (VM) i występują problemy z połączeniem maszyny Wirtualnej, ten artykuł zawiera omówienie funkcji diagnostyki dla grup NSG toohelp dalsze poszukiwanie rozwiązania problemu.</span><span class="sxs-lookup"><span data-stu-id="13859-106">If you configured Network Security Groups (NSGs) on your virtual machine (VM) and are experiencing VM connectivity issues, this article provides an overview of diagnostics capabilities for NSGs toohelp troubleshoot further.</span></span>

<span data-ttu-id="13859-107">Grupy NSG pozwalają toocontrol hello rodzaje ruchu przepływające i maszyn wirtualnych (VM).</span><span class="sxs-lookup"><span data-stu-id="13859-107">NSGs enable you toocontrol hello types of traffic that flow in and out of your virtual machines (VMs).</span></span> <span data-ttu-id="13859-108">Grupy NSG mogą być zastosowane toosubnets w sieci wirtualnej platformy Azure (VNet) i/lub interfejsów sieciowych (NIC).</span><span class="sxs-lookup"><span data-stu-id="13859-108">NSGs can be applied toosubnets in an Azure Virtual Network (VNet), network interfaces (NIC), or both.</span></span> <span data-ttu-id="13859-109">Hello tooa skuteczne reguły stosowane karty Sieciowej są hello reguł, które istnieją w hello zastosować grupy NSG tooa kart Sieciowych i hello podsieci, w której jest dołączona do agregacji.</span><span class="sxs-lookup"><span data-stu-id="13859-109">hello effective rules applied tooa NIC are an aggregation of hello rules that exist in hello NSGs applied tooa NIC and hello subnet it is connected to.</span></span> <span data-ttu-id="13859-110">Reguły w tych grup NSG można czasami konflikt ze sobą i mieć wpływ na łączność sieciową z maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-110">Rules across these NSGs can sometimes conflict with each other and impact a VM's network connectivity.</span></span>  

<span data-ttu-id="13859-111">Można wyświetlić wszystkie reguły efektywnym elementem systemu zabezpieczeń hello z grup NSG, jak stosować kart sieciowych maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-111">You can view all hello effective security rules from your NSGs, as applied on your VM's NICs.</span></span> <span data-ttu-id="13859-112">W tym artykule opisano, jak przy użyciu tych reguł w problemy z łącznością wirtualna tootroubleshoot hello modelu wdrażania usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="13859-112">This article shows how tootroubleshoot VM connectivity issues using these rules in hello Azure Resource Manager deployment model.</span></span> <span data-ttu-id="13859-113">Jeśli nie znasz z sieci wirtualnej i NSG pojęcia, przeczytaj hello [sieci wirtualnej](virtual-networks-overview.md) i [sieciowej grupy zabezpieczeń](virtual-networks-nsg.md) omówienie artykułów.</span><span class="sxs-lookup"><span data-stu-id="13859-113">If you're not familiar with VNet and NSG concepts, read hello [Virtual network](virtual-networks-overview.md) and [Network security groups](virtual-networks-nsg.md) overview articles.</span></span>

## <a name="using-effective-security-rules-tootroubleshoot-vm-traffic-flow"></a><span data-ttu-id="13859-114">Przy użyciu przepływu ruchu maszyny Wirtualnej tootroubleshoot skuteczne reguły zabezpieczeń</span><span class="sxs-lookup"><span data-stu-id="13859-114">Using Effective Security Rules tootroubleshoot VM traffic flow</span></span>
<span data-ttu-id="13859-115">Hello scenariusz, w którym następuje jest przykładem to powszechny problem połączenia:</span><span class="sxs-lookup"><span data-stu-id="13859-115">hello scenario that follows is an example of a common connection problem:</span></span>

<span data-ttu-id="13859-116">Maszyna wirtualna o nazwie *VM1* jest częścią podsieci o nazwie *podsieć1* w ramach sieci wirtualnej o nazwie *WestUS VNet1*.</span><span class="sxs-lookup"><span data-stu-id="13859-116">A VM named *VM1* is part of a subnet named *Subnet1* within a VNet named *WestUS-VNet1*.</span></span> <span data-ttu-id="13859-117">Próba tooconnect toohello maszyny Wirtualnej przy użyciu protokołu RDP za pośrednictwem portu 3389 protokołu TCP nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="13859-117">An attempt tooconnect toohello VM using RDP over TCP port 3389 fails.</span></span> <span data-ttu-id="13859-118">Grupy NSG są stosowane w obu hello kart *VM1 NIC1* i hello podsieci *podsieć1*.</span><span class="sxs-lookup"><span data-stu-id="13859-118">NSGs are applied at both hello NIC *VM1-NIC1* and hello subnet *Subnet1*.</span></span> <span data-ttu-id="13859-119">Ruch tooTCP portu 3389 jest dozwolony w hello grupy NSG skojarzonej z interfejsem sieciowym hello *VM1 NIC1*, jednak TCP polecenie ping na tooVM1 portu 3389 kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="13859-119">Traffic tooTCP port 3389 is allowed in hello NSG associated with hello network interface *VM1-NIC1*, however TCP ping tooVM1's port 3389 fails.</span></span>

<span data-ttu-id="13859-120">Gdy w tym przykładzie korzysta z portu 3389 protokołu TCP, hello następujących kroków można używane toodetermine błędów połączenia przychodzącego i wychodzącego przez dowolnego portu.</span><span class="sxs-lookup"><span data-stu-id="13859-120">While this example uses TCP port 3389, hello following steps can be used toodetermine inbound and outbound connection failures over any port.</span></span>

### <span data-ttu-id="13859-121"><a name="vm"></a>Wyświetl reguły efektywnym elementem systemu zabezpieczeń dla maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="13859-121"><a name="vm"></a>View effective security rules for a virtual machine</span></span>
<span data-ttu-id="13859-122">Wykonaj hello następujące kroki tootroubleshoot grup NSG dla maszyny Wirtualnej:</span><span class="sxs-lookup"><span data-stu-id="13859-122">Complete hello following steps tootroubleshoot NSGs for a VM:</span></span>

<span data-ttu-id="13859-123">Pełna lista reguł efektywnym elementem systemu zabezpieczeń hello można wyświetlić karty sieciowej, z hello samej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-123">You can view full list of hello effective security rules on a NIC, from hello VM itself.</span></span> <span data-ttu-id="13859-124">Można również dodawanie, modyfikowanie i usuwanie reguły NSG podsieci i karty w bloku skuteczne reguły hello, jeśli masz uprawnienia tooperform te operacje.</span><span class="sxs-lookup"><span data-stu-id="13859-124">You can also add, modify, and delete both NIC and subnet NSG rules from hello effective rules blade, if you have permissions tooperform these operations.</span></span>

1. <span data-ttu-id="13859-125">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="13859-125">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="13859-126">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **maszyn wirtualnych** na liście hello.</span><span class="sxs-lookup"><span data-stu-id="13859-126">Click **More services**, then click **Virtual machines** in hello list that appears.</span></span>
3. <span data-ttu-id="13859-127">Wybierz z listy hello tootroubleshoot maszyny Wirtualnej i zostanie wyświetlony blok maszyny Wirtualnej, z opcjami.</span><span class="sxs-lookup"><span data-stu-id="13859-127">Select a VM tootroubleshoot from hello list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="13859-128">Kliknij przycisk **Diagnozuj & rozwiązywania problemów** , a następnie wybierz powszechny problem.</span><span class="sxs-lookup"><span data-stu-id="13859-128">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="13859-129">Na przykład **toomy maszyny Wirtualnej systemu Windows nie można połączyć z** jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="13859-129">For this example, **I can’t connect toomy Windows VM** is selected.</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image1.png)
5. <span data-ttu-id="13859-130">Kroki są wyświetlane w polu hello problem, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="13859-130">Steps appear under hello problem, as shown in hello following picture:</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image2.png)
   
    <span data-ttu-id="13859-131">Kliknij przycisk *efektywnym elementem systemu zabezpieczeń, zasady grupy* hello liście zalecanych kroków.</span><span class="sxs-lookup"><span data-stu-id="13859-131">Click *effective security group rules* in hello list of recommended steps.</span></span>
6. <span data-ttu-id="13859-132">Witaj **pobieranie reguł efektywnym elementem systemu zabezpieczeń** zostanie wyświetlony blok, jak pokazano na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="13859-132">hello **Get effective security rules** blade appears, as shown in hello following picture:</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image3.png)
   
    <span data-ttu-id="13859-133">Następujące sekcje obraz powitania hello powiadomień:</span><span class="sxs-lookup"><span data-stu-id="13859-133">Notice hello following sections of hello picture:</span></span>
   
   * <span data-ttu-id="13859-134">**Zakres:** ustawić także*VM1*, hello maszyny Wirtualnej wybrany w kroku 3.</span><span class="sxs-lookup"><span data-stu-id="13859-134">**Scope:** Set too*VM1*, hello VM selected in step 3.</span></span>
   * <span data-ttu-id="13859-135">**Interfejs sieciowy:** *VM1 NIC1* jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="13859-135">**Network interface:** *VM1-NIC1* is selected.</span></span> <span data-ttu-id="13859-136">Maszyna wirtualna może mieć wiele interfejsów sieciowych (NIC).</span><span class="sxs-lookup"><span data-stu-id="13859-136">A VM can have multiple network interfaces (NIC).</span></span> <span data-ttu-id="13859-137">Poszczególne karty Sieciowe mogą mieć unikatowe efektywnym elementem systemu zabezpieczeń reguły.</span><span class="sxs-lookup"><span data-stu-id="13859-137">Each NIC can have unique effective security rules.</span></span> <span data-ttu-id="13859-138">Podczas rozwiązywania problemów, konieczne może tooview hello efektywnym elementem systemu zabezpieczeń reguł dla poszczególnych kart sieciowych.</span><span class="sxs-lookup"><span data-stu-id="13859-138">When troubleshooting, you may need tooview hello effective security rules for each NIC.</span></span>
   * <span data-ttu-id="13859-139">**Grupy NSG skojarzone:** grupy NSG mogą być zastosowane tooboth hello kart Sieciowych i hello podsieci hello jest połączona karta sieciowa.</span><span class="sxs-lookup"><span data-stu-id="13859-139">**Associated NSGs:** NSGs can be applied tooboth hello NIC and hello subnet hello NIC is connected to.</span></span> <span data-ttu-id="13859-140">Na rysunku hello grupy NSG została tooboth zastosowane hello kart Sieciowych i hello podsieci, w której jest dołączona do.</span><span class="sxs-lookup"><span data-stu-id="13859-140">In hello picture, an NSG has been applied tooboth hello NIC and hello subnet it's connected to.</span></span> <span data-ttu-id="13859-141">Możesz kliknąć na nazwy grupy NSG hello toodirectly zmodyfikuj zasady w hello grup NSG.</span><span class="sxs-lookup"><span data-stu-id="13859-141">You can click on hello NSG names toodirectly modify rules in hello NSGs.</span></span>
   * <span data-ttu-id="13859-142">**Karta VM1 nsg:** hello listę reguł wyświetlonych obraz powitania jest hello grupa NSG stosowana toohello karty sieciowej.</span><span class="sxs-lookup"><span data-stu-id="13859-142">**VM1-nsg tab:** hello list of rules displayed in hello picture is for hello NSG applied toohello NIC.</span></span> <span data-ttu-id="13859-143">Kilka reguł domyślnych są tworzone przez usługę Azure zawsze, gdy grupa NSG jest tworzona.</span><span class="sxs-lookup"><span data-stu-id="13859-143">Several default rules are created by Azure whenever an NSG is created.</span></span> <span data-ttu-id="13859-144">Nie można usunąć reguły domyślne hello, ale można je zastąpić przy użyciu reguł o wyższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="13859-144">You can't remove hello default rules, but you can override them with rules of higher priority.</span></span> <span data-ttu-id="13859-145">więcej informacji na temat reguł domyślnych, przeczytaj hello toolearn [omówienie NSG](virtual-networks-nsg.md#default-rules) artykułu.</span><span class="sxs-lookup"><span data-stu-id="13859-145">toolearn more about default rules, read hello [NSG overview](virtual-networks-nsg.md#default-rules) article.</span></span>
   * <span data-ttu-id="13859-146">**Kolumna docelowa:** niektóre reguły hello mają tekst w kolumnie hello, podczas gdy inne muszą prefiksy adresów.</span><span class="sxs-lookup"><span data-stu-id="13859-146">**DESTINATION column:** Some of hello rules have text in hello column, while others have address prefixes.</span></span> <span data-ttu-id="13859-147">tekst Hello jest hello nazwę domyślną regułę zabezpieczeń toohello znaczniki zastosowane podczas jej tworzenia.</span><span class="sxs-lookup"><span data-stu-id="13859-147">hello text is hello name of default tags applied toohello security rule when it was created.</span></span> <span data-ttu-id="13859-148">tagi Hello są dostarczane przez system identyfikatorów, które reprezentują wiele prefiksów.</span><span class="sxs-lookup"><span data-stu-id="13859-148">hello tags are system-provided identifiers that represent multiple prefixes.</span></span> <span data-ttu-id="13859-149">Wybranie reguły za pomocą tagów, takich jak *AllowInternetOutBound*, zawiera listę prefiksów hello hello **prefiksy adresów** bloku.</span><span class="sxs-lookup"><span data-stu-id="13859-149">Selecting a rule with a tag, such as *AllowInternetOutBound*, lists hello prefixes in hello **Address prefixes** blade.</span></span>
   * <span data-ttu-id="13859-150">**Pobieranie:** hello lista reguł może trwać długo.</span><span class="sxs-lookup"><span data-stu-id="13859-150">**Download:** hello list of rules can be long.</span></span> <span data-ttu-id="13859-151">Plik CSV reguł hello celów analizy offline można pobrać po kliknięciu **Pobierz** i zapisanie pliku hello.</span><span class="sxs-lookup"><span data-stu-id="13859-151">You can download a .csv file of hello rules for offline analysis by clicking **Download** and saving hello file.</span></span>
   * <span data-ttu-id="13859-152">**AllowRDP** reguły dla ruchu przychodzącego: ta zasada umożliwia toohello połączeń protokołu RDP maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-152">**AllowRDP** Inbound rule: This rule allows RDP connections toohello VM.</span></span>
7. <span data-ttu-id="13859-153">Kliknij przycisk hello **NSG podsieć1** kartę tooview hello skuteczne reguły z hello NSG stosowane toohello podsieci, pokazane na poniższej ilustracji hello:</span><span class="sxs-lookup"><span data-stu-id="13859-153">Click hello **Subnet1-NSG** tab tooview hello effective rules from hello NSG applied toohello subnet, as shown in hello following picture:</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image4.png)
   
    <span data-ttu-id="13859-154">Powiadomienie hello *denyRDP* **przychodzący** reguły.</span><span class="sxs-lookup"><span data-stu-id="13859-154">Notice hello *denyRDP* **Inbound** rule.</span></span> <span data-ttu-id="13859-155">Reguły ruchu przychodzącego na powitania podsieci są obliczane przed zasady stosowane na powitania interfejsu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="13859-155">Inbound rules applied at hello subnet are evaluated before rules applied at hello network interface.</span></span> <span data-ttu-id="13859-156">Ponieważ w podsieci hello jest stosowana reguła odmowy hello, hello żądania tooconnect tooTCP 3389 nie powiedzie się, ponieważ hello regułę Zezwalaj na powitalne nigdy nie jest obliczane karty Sieciowej.</span><span class="sxs-lookup"><span data-stu-id="13859-156">Since hello deny rule is applied at hello subnet, hello request tooconnect tooTCP 3389 fails, because hello allow rule at hello NIC is never evaluated.</span></span> 
   
    <span data-ttu-id="13859-157">Witaj *denyRDP* reguła jest przyczyna hello Dlaczego hello połączenie RDP kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="13859-157">hello *denyRDP* rule is hello reason why hello RDP connection is failing.</span></span> <span data-ttu-id="13859-158">Usunięcie go powinno rozwiązać hello problem.</span><span class="sxs-lookup"><span data-stu-id="13859-158">Removing it should resolve hello problem.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="13859-159">Jeśli hello maszyny Wirtualnej skojarzone z hello NIC nie jest w stanie uruchomienia, lub grupy NSG nie zostały zastosowane toohello karty Sieciowej lub podsieci, są wyświetlane żadne reguły.</span><span class="sxs-lookup"><span data-stu-id="13859-159">If hello VM associated with hello NIC is not in a running state, or NSGs haven't been applied toohello NIC or subnet, no rules are shown.</span></span>
   > 
   > 
8. <span data-ttu-id="13859-160">reguły NSG tooedit, kliknij przycisk *NSG podsieć1* w hello **skojarzonych grup NSG** sekcji.</span><span class="sxs-lookup"><span data-stu-id="13859-160">tooedit NSG rules, click *Subnet1-NSG* in hello **Associated NSGs** section.</span></span>
   <span data-ttu-id="13859-161">Spowoduje to otwarcie hello **NSG podsieć1** bloku.</span><span class="sxs-lookup"><span data-stu-id="13859-161">This opens hello **Subnet1-NSG** blade.</span></span> <span data-ttu-id="13859-162">Reguły hello można bezpośrednio edytować, klikając **reguły zabezpieczeń dla ruchu przychodzącego**.</span><span class="sxs-lookup"><span data-stu-id="13859-162">You can directly edit hello rules by clicking on **Inbound security rules**.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image7.png)
9. <span data-ttu-id="13859-163">Po usunięciu hello *denyRDP* reguły dla ruchu przychodzącego w hello **NSG podsieć1** i dodawanie *allowRDP* reguły listy reguł efektywne hello wygląda hello poniższej ilustracji:</span><span class="sxs-lookup"><span data-stu-id="13859-163">After removing hello *denyRDP* inbound rule in hello **Subnet1-NSG** and adding an *allowRDP* rule, hello effective rules list looks like hello following picture:</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image8.png)
   
    <span data-ttu-id="13859-164">Upewnij się, że portu 3389 protokołu TCP jest otwarty przez otwarcie toohello połączenia RDP maszyny Wirtualnej lub za pomocą narzędzia narzędzia PsPing hello.</span><span class="sxs-lookup"><span data-stu-id="13859-164">Confirm that TCP port 3389 is open by opening an RDP connection toohello VM or using hello PsPing tool.</span></span> <span data-ttu-id="13859-165">Użytkownik może dowiedzieć się więcej o narzędzia PsPing za odczytywanie hello [stronę pobierania narzędzia PsPing](https://technet.microsoft.com/sysinternals/psping.aspx).</span><span class="sxs-lookup"><span data-stu-id="13859-165">You can learn more about PsPing by reading hello [PsPing download page](https://technet.microsoft.com/sysinternals/psping.aspx).</span></span>

### <span data-ttu-id="13859-166"><a name="nic"></a>Wyświetl reguły efektywnym elementem systemu zabezpieczeń dla interfejsu sieciowego</span><span class="sxs-lookup"><span data-stu-id="13859-166"><a name="nic"></a>View effective security rules for a network interface</span></span>
<span data-ttu-id="13859-167">Jeśli do ruchu maszyny Wirtualnej jest w pełni funkcjonalne dla określonych kart interfejsu Sieciowego, można wyświetlić pełną listę hello Zasady efektywne hello karty Sieciowej z kontekstu interfejsów sieciowych hello, wykonując następujące kroki hello:</span><span class="sxs-lookup"><span data-stu-id="13859-167">If your VM traffic flow is impacted for a specific NIC, you can view a full list of hello effective rules for hello NIC from hello network interfaces context by completing hello following steps:</span></span>

1. <span data-ttu-id="13859-168">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="13859-168">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="13859-169">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **interfejsy sieciowe** na liście hello.</span><span class="sxs-lookup"><span data-stu-id="13859-169">Click **More services**, then click **Network interfaces** in hello list that appears.</span></span>
3. <span data-ttu-id="13859-170">Wybierz interfejs sieciowy.</span><span class="sxs-lookup"><span data-stu-id="13859-170">Select a network interface.</span></span> <span data-ttu-id="13859-171">W poniższej ilustracji hello, karta sieciowa o nazwie *VM1 NIC1* jest zaznaczone.</span><span class="sxs-lookup"><span data-stu-id="13859-171">In hello following picture, a NIC named *VM1-NIC1* is selected.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image5.png)
   
    <span data-ttu-id="13859-172">Zwróć uwagę, że hello **zakres** ustawiono wybrany interfejs sieciowy toohello.</span><span class="sxs-lookup"><span data-stu-id="13859-172">Notice that hello **Scope** is set toohello network interface selected.</span></span> <span data-ttu-id="13859-173">więcej informacji o toolearn hello dodatkowe informacje wyświetlane, przeczytaj kroku 6 hello **Rozwiązywanie problemów z grup NSG dla maszyny Wirtualnej** sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="13859-173">toolearn more about hello additional information shown, read step 6 of hello **Troubleshoot NSGs for a VM** section of this article.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="13859-174">Usunięcie grupy NSG z interfejsem sieciowym podsieci hello grupa NSG jest nadal wprowadza ją na powitania podanych kart sieciowych.</span><span class="sxs-lookup"><span data-stu-id="13859-174">If an NSG is removed from a network interface, hello subnet NSG is still effective on hello given NIC.</span></span> <span data-ttu-id="13859-175">W takim przypadku dane wyjściowe hello czy wyświetla tylko reguły z podsieci hello NSG.</span><span class="sxs-lookup"><span data-stu-id="13859-175">In this case, hello output would only show rules from hello subnet NSG.</span></span> <span data-ttu-id="13859-176">Reguły są wyświetlane tylko, jeśli hello karty Sieciowej jest dołączony tooa maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-176">Rules only appear if hello NIC is attached tooa VM.</span></span>
   > 
   > 
4. <span data-ttu-id="13859-177">Zasady można edytować bezpośrednio do grupy zabezpieczeń sieci skojarzonych z karty Sieciowej i podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-177">You can directly edit rules for NSGs associated with a NIC and a subnet.</span></span> <span data-ttu-id="13859-178">jak to zrobić, przeczytaj toolearn krok 8 hello **wyświetlić reguły efektywnym elementem systemu zabezpieczeń dla maszyny wirtualnej** sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="13859-178">toolearn how, read step 8 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

## <span data-ttu-id="13859-179"><a name="nsg"></a>Wyświetlanie efektywnym elementem systemu zabezpieczeń reguł sieciowej grupy zabezpieczeń (NSG)</span><span class="sxs-lookup"><span data-stu-id="13859-179"><a name="nsg"></a>View effective security rules for a network security group (NSG)</span></span>
<span data-ttu-id="13859-180">Podczas modyfikowania reguły NSG, może być tooreview hello wpływ zasad hello dodawany na określonej maszynie Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-180">When modifying NSG rules, you may want tooreview hello impact of hello rules being added on a particular VM.</span></span> <span data-ttu-id="13859-181">Można wyświetlić pełną listę hello efektywnym elementem systemu zabezpieczeń reguły dla wszystkich hello karty sieciowe obsługujące danego grupa NSG jest stosowana do, bez konieczności kontekst tooswitch od hello podane NSG bloku.</span><span class="sxs-lookup"><span data-stu-id="13859-181">You can view a full list of hello effective security rules for all hello NICs that a given NSG is applied to, without having tooswitch context from hello given NSG blade.</span></span> <span data-ttu-id="13859-182">tootroubleshoot skuteczne reguły w obrębie grupy NSG, pełną hello następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="13859-182">tootroubleshoot effective rules within an NSG, complete hello following steps:</span></span>

1. <span data-ttu-id="13859-183">Toohello logowania portalu Azure w https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="13859-183">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="13859-184">Kliknij przycisk **więcej usług**, następnie kliknij przycisk **sieciowej grupy zabezpieczeń** na liście hello.</span><span class="sxs-lookup"><span data-stu-id="13859-184">Click **More services**, then click **Network security groups** in hello list that appears.</span></span>
3. <span data-ttu-id="13859-185">Wybierz grupy NSG.</span><span class="sxs-lookup"><span data-stu-id="13859-185">Select an NSG.</span></span> <span data-ttu-id="13859-186">W poniższej ilustracji hello grupy NSG o nazwie grupy nsg VM1 został wybrany.</span><span class="sxs-lookup"><span data-stu-id="13859-186">In hello following picture, an NSG named VM1-nsg was selected.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image6.png)
   
    <span data-ttu-id="13859-187">Następujące sekcje hello poprzedni obraz powitania powiadomień:</span><span class="sxs-lookup"><span data-stu-id="13859-187">Notice hello following sections of hello previous picture:</span></span>
   
   * <span data-ttu-id="13859-188">**Zakres:** ustawić toohello wybrane grupy NSG.</span><span class="sxs-lookup"><span data-stu-id="13859-188">**Scope:** Set toohello NSG selected.</span></span>
   * <span data-ttu-id="13859-189">**Maszyna wirtualna:** gdy grupa NSG jest stosowane tooa podsieci, jest tooall stosowane interfejsy tooall dołączone maszyn wirtualnych połączonych toohello podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-189">**Virtual machine:** When an NSG is applied tooa subnet, it's applied tooall network interfaces attached tooall VMs connected toohello subnet.</span></span> <span data-ttu-id="13859-190">Ta lista zawiera ta grupa NSG jest stosowana do wszystkich maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="13859-190">This list shows all VMs this NSG is applied to.</span></span> <span data-ttu-id="13859-191">Możesz wybrać żadnej maszyny Wirtualnej z listy hello.</span><span class="sxs-lookup"><span data-stu-id="13859-191">You can select any VM from hello list.</span></span>
     
     > [!NOTE]
     > <span data-ttu-id="13859-192">Jeśli grupa NSG jest stosowane tooonly pusty podsieci, maszyny wirtualne nie są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="13859-192">If an NSG is applied tooonly an empty subnet, VMs will not be listed.</span></span> <span data-ttu-id="13859-193">Jeśli grupa NSG jest stosowane tooa karty Sieciowej, która nie jest skojarzona z maszyną Wirtualną, te karty sieciowe również nie są wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="13859-193">If an NSG is applied tooa NIC which is not associated with a VM, those NICs will also not be listed.</span></span> 
     > 
     > 
   * <span data-ttu-id="13859-194">**Interfejs sieciowy:** maszyny Wirtualnej może mieć wiele interfejsów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="13859-194">**Network Interface:** A VM can have multiple network interfaces.</span></span> <span data-ttu-id="13859-195">Możesz wybrać karty sieciowej dołączonych toohello wybrane maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-195">You can select a network interface attached toohello selected VM.</span></span>
   * <span data-ttu-id="13859-196">**AssociatedNSGs:** w dowolnym momencie, karta sieciowa może zawierać maksymalnie tootwo skuteczne grup NSG, jeden stosowane toohello karty Sieciowej i hello innych podsieci toohello.</span><span class="sxs-lookup"><span data-stu-id="13859-196">**AssociatedNSGs:** At any time, a NIC can have up tootwo effective NSGs, one applied toohello NIC and hello other toohello subnet.</span></span> <span data-ttu-id="13859-197">Mimo że hello zakres został wybrany jako grupa nsg VM1, jeśli hello karta sieciowa ma podsieć skuteczne NSG, hello dane wyjściowe będą pokazywały obu grup NSG.</span><span class="sxs-lookup"><span data-stu-id="13859-197">Although hello scope is selected as VM1-nsg, if hello NIC has an effective subnet NSG, hello output will show both NSGs.</span></span>
4. <span data-ttu-id="13859-198">Zasady można edytować bezpośrednio do grupy zabezpieczeń sieci skojarzonych z karty Sieciowej lub podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-198">You can directly edit rules for NSGs associated with a NIC or subnet.</span></span> <span data-ttu-id="13859-199">jak to zrobić, przeczytaj toolearn krok 8 hello **wyświetlić reguły efektywnym elementem systemu zabezpieczeń dla maszyny wirtualnej** sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="13859-199">toolearn how, read step 8 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

<span data-ttu-id="13859-200">więcej informacji o toolearn hello dodatkowe informacje wyświetlane, przeczytaj kroku 6 hello **wyświetlić reguły efektywnym elementem systemu zabezpieczeń dla maszyny wirtualnej** sekcji tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="13859-200">toolearn more about hello additional information shown, read step 6 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

> [!NOTE]
> <span data-ttu-id="13859-201">Chociaż podsieci i karty Sieciowej można mieć tylko jeden toothem grupa NSG stosowana, grupy NSG mogą być skojarzone toomultiple kart sieciowych i wielu podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-201">Though a subnet and NIC can each have only one NSG applied toothem, an NSG can be associated toomultiple NICs and multiple subnets.</span></span>
> 
> 

## <a name="considerations"></a><span data-ttu-id="13859-202">Zagadnienia do rozważenia</span><span class="sxs-lookup"><span data-stu-id="13859-202">Considerations</span></span>
<span data-ttu-id="13859-203">Należy wziąć pod uwagę następujące punkty podczas rozwiązywania problemów z łącznością hello:</span><span class="sxs-lookup"><span data-stu-id="13859-203">Consider hello following points when troubleshooting connectivity problems:</span></span>

* <span data-ttu-id="13859-204">Reguły NSG domyślne zablokuje dostęp przychodzący do z hello internet i zezwolenia sieci wirtualnej ruch przychodzący.</span><span class="sxs-lookup"><span data-stu-id="13859-204">Default NSG rules will block inbound access from hello internet and only permit VNet inbound traffic.</span></span> <span data-ttu-id="13859-205">Zasady należy jawnie dodać tooallow ruchu przychodzącego dla dostępu z Internetu, zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="13859-205">Rules should be explicitly added tooallow inbound access from Internet, as required.</span></span>
* <span data-ttu-id="13859-206">Jeśli nie żadnych reguł zabezpieczeń grupy NSG powoduje toofail łączności sieciowej maszyny Wirtualnej, hello problem może być:</span><span class="sxs-lookup"><span data-stu-id="13859-206">If there are no NSG security rules causing a VM’s network connectivity toofail, hello problem may be due to:</span></span>
  * <span data-ttu-id="13859-207">Oprogramowanie zapory w systemie operacyjnym hello maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="13859-207">Firewall software running within hello VM's operating system</span></span>
  * <span data-ttu-id="13859-208">Trasy skonfigurowanych dla urządzenia wirtualnego lub ruch lokalny.</span><span class="sxs-lookup"><span data-stu-id="13859-208">Routes configured for virtual appliances or on-premises traffic.</span></span> <span data-ttu-id="13859-209">Ruch internetowy może być przekierowane tooon lokalnych przy użyciu tunelowania wymuszonego.</span><span class="sxs-lookup"><span data-stu-id="13859-209">Internet traffic can be redirected tooon-premises via forced-tunneling.</span></span> <span data-ttu-id="13859-210">Połączenia protokołu RDP/SSH z tooyour Internet hello maszyna wirtualna może nie działać to ustawienie, w zależności od tego, jak sprzętu sieciowego lokalne powitania obsługuje ten ruch.</span><span class="sxs-lookup"><span data-stu-id="13859-210">An RDP/SSH connection from hello Internet tooyour VM may not work with this setting, depending on how hello on-premises network hardware handles this traffic.</span></span> <span data-ttu-id="13859-211">Odczyt hello [Rozwiązywanie problemów z tras](virtual-network-routes-troubleshoot-powershell.md) toolearn artykułu, jak toodiagnose trasy problemów, które mogą utrudnić hello przepływu ruchu w hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="13859-211">Read hello [Troubleshooting Routes](virtual-network-routes-troubleshoot-powershell.md) article toolearn how toodiagnose route problems that may be impeding hello flow of traffic in and out of hello VM.</span></span> 
* <span data-ttu-id="13859-212">Jeśli ma połączyć za pomocą sieci wirtualnych, domyślnie, hello VIRTUAL_NETWORK tag automatycznie rozwiń tooinclude prefiksy dla połączyć za pomocą sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="13859-212">If you have peered VNets, by default, hello VIRTUAL_NETWORK tag will automatically expand tooinclude prefixes for peered VNets.</span></span> <span data-ttu-id="13859-213">Prefiksy te można wyświetlić w hello **ExpandedAddressPrefix** listy tootroubleshoot żadnych problemów powiązanych tooVNet równorzędna łączności.</span><span class="sxs-lookup"><span data-stu-id="13859-213">You can view these prefixes in hello **ExpandedAddressPrefix** list, tootroubleshoot any issues related tooVNet peering connectivity.</span></span> 
* <span data-ttu-id="13859-214">Reguły efektywnym elementem systemu zabezpieczeń są wyświetlane tylko jeśli istnieje grupa NSG skojarzonego z hello maszyny Wirtualnej karty Sieciowej i podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-214">Effective security rules are only shown if there is an NSG associated with hello VM’s NIC and or subnet.</span></span> 
* <span data-ttu-id="13859-215">Jeśli nie ma żadnych grup NSG skojarzone z hello karty Sieciowej lub w podsieci i publicznego adresu IP przypisany tooyour maszyna wirtualna, wszystkie porty jest otwarte dla przychodzący i wychodzący dostęp.</span><span class="sxs-lookup"><span data-stu-id="13859-215">If there are no NSGs associated with hello NIC or subnet and you have a public IP address assigned tooyour VM, all ports will be open for inbound and outbound access.</span></span> <span data-ttu-id="13859-216">Jeśli hello maszyna wirtualna ma publiczny adres IP, zdecydowanie zalecane jest stosowanie toohello grup NSG karty Sieciowej lub podsieci.</span><span class="sxs-lookup"><span data-stu-id="13859-216">If hello VM has a public IP address, applying NSGs toohello NIC or subnet is strongly recommended.</span></span>

