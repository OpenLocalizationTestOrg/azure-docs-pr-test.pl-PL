---
title: "aaaScript programowanie akcji z usługą HDInsight - Azure | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak toocustomize Hadoop clusters z akcji skryptu. Akcja skryptu można dodatkowe oprogramowanie używane tooinstall systemem Hadoop klastra lub toochange hello konfiguracji aplikacji instalowanych w klastrze."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 836d68a8-8b21-4d69-8b61-281a7fe67f21
ms.service: hdinsight
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/25/2017
ms.author: jgao
ROBOTS: NOINDEX
ms.openlocfilehash: 4fc3a389df8a003f7129ab00b4cd9bc7ad81a419
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="develop-script-action-scripts-for-hdinsight-windows-based-clusters"></a><span data-ttu-id="3aca3-104">Tworzenie skryptów akcji skryptu dla klastrów usługi HDInsight w systemie Windows</span><span class="sxs-lookup"><span data-stu-id="3aca3-104">Develop Script Action scripts for HDInsight Windows-based clusters</span></span>
<span data-ttu-id="3aca3-105">Dowiedz się, jak skrypty toowrite akcji skryptu dla usługi HDInsight.</span><span class="sxs-lookup"><span data-stu-id="3aca3-105">Learn how toowrite Script Action scripts for HDInsight.</span></span> <span data-ttu-id="3aca3-106">Uzyskać informacji na temat używania skryptów akcji skryptu, zobacz [HDInsight dostosować klastry za pomocą akcji skryptu](hdinsight-hadoop-customize-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-106">For information on using Script Action scripts, see [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md).</span></span> <span data-ttu-id="3aca3-107">Aby hello tego samego artykułu zapisywane w klastrach usługi HDInsight opartej na systemie Linux, zobacz [skryptów tworzenie akcji skryptu dla usługi HDInsight](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-107">For hello same article written for Linux-based HDInsight clusters, see [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions-linux.md).</span></span>



> [!IMPORTANT]
> <span data-ttu-id="3aca3-108">Witaj czynnościach w ramach tego dokumentu działa tylko w przypadku klastrów usługi HDInsight opartej na systemie Windows.</span><span class="sxs-lookup"><span data-stu-id="3aca3-108">hello steps in this document only work for Windows-based HDInsight clusters.</span></span> <span data-ttu-id="3aca3-109">HDInsight jest dostępna tylko w systemie Windows dla wersji starszej niż HDInsight 3.4.</span><span class="sxs-lookup"><span data-stu-id="3aca3-109">HDInsight is only available on Windows for versions lower than HDInsight 3.4.</span></span> <span data-ttu-id="3aca3-110">Linux jest hello tylko system operacyjny używany w usłudze HDInsight w wersji 3.4 lub nowszej.</span><span class="sxs-lookup"><span data-stu-id="3aca3-110">Linux is hello only operating system used on HDInsight version 3.4 or greater.</span></span> <span data-ttu-id="3aca3-111">Aby uzyskać więcej informacji, zobacz sekcję [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement) (Wycofanie usługi HDInsight w systemie Windows).</span><span class="sxs-lookup"><span data-stu-id="3aca3-111">For more information, see [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span></span> <span data-ttu-id="3aca3-112">Uzyskać przy użyciu akcji skryptu z klastrów z systemem Linux, zobacz [programowanie akcji z usługą HDInsight (Linux) w skrypcie](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-112">For information on using script actions with Linux-based clusters, see [Script action development with HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span></span>
>
>



<span data-ttu-id="3aca3-113">Akcja skryptu można dodatkowe oprogramowanie używane tooinstall systemem Hadoop klastra lub toochange hello konfiguracji aplikacji instalowanych w klastrze.</span><span class="sxs-lookup"><span data-stu-id="3aca3-113">Script Action can be used tooinstall additional software running on a Hadoop cluster or toochange hello configuration of applications installed on a cluster.</span></span> <span data-ttu-id="3aca3-114">Akcje skryptu to skrypty, których uruchamianie w węzłach klastra hello w przypadku klastrów usługi HDInsight i są wykonywane po węzłach w klastrze hello Zakończ konfigurację usługi HDInsight.</span><span class="sxs-lookup"><span data-stu-id="3aca3-114">Script actions are scripts that run on hello cluster nodes when HDInsight clusters are deployed, and they are executed once nodes in hello cluster complete HDInsight configuration.</span></span> <span data-ttu-id="3aca3-115">Akcja skryptu jest wykonywane w ramach uprawnień konta administratora systemu i zapewnia pełne prawa dostępu toohello węzłów klastra.</span><span class="sxs-lookup"><span data-stu-id="3aca3-115">A script action is executed under system admin account privileges and provides full access rights toohello cluster nodes.</span></span> <span data-ttu-id="3aca3-116">Każdy klaster można podać listę skryptu toobe akcje wykonywane w kolejności hello, w którym zostały określone.</span><span class="sxs-lookup"><span data-stu-id="3aca3-116">Each cluster can be provided with a list of script actions toobe executed in hello order in which they are specified.</span></span>

> [!NOTE]
> <span data-ttu-id="3aca3-117">Jeśli wystąpią hello następujący komunikat o błędzie:</span><span class="sxs-lookup"><span data-stu-id="3aca3-117">If you experience hello following error message:</span></span>
>
> <span data-ttu-id="3aca3-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage: hello termin "Zapisz HDIFile" nie został rozpoznany jako hello nazwę polecenia cmdlet, funkcji, pliku skryptu lub program wykonywalny.</span><span class="sxs-lookup"><span data-stu-id="3aca3-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage : hello term 'Save-HDIFile' is not recognized as hello name of a cmdlet, function, script file, or operable program.</span></span> <span data-ttu-id="3aca3-119">Sprawdź pisownię nazwy hello hello, lub jeśli ścieżki został uwzględniony, sprawdź, czy ścieżka tego hello jest poprawna i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="3aca3-119">Check hello spelling of hello name, or if a path was included, verify that hello path is correct and try again.</span></span>
> <span data-ttu-id="3aca3-120">Istnieje, ponieważ nie zawiera metody pomocnicze hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-120">It is because you didn't include hello helper methods.</span></span>  <span data-ttu-id="3aca3-121">Zobacz [metody pomocnicze dla niestandardowych skryptów](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span><span class="sxs-lookup"><span data-stu-id="3aca3-121">See [Helper methods for custom scripts](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span></span>
>
>

## <a name="sample-scripts"></a><span data-ttu-id="3aca3-122">Przykładowe skrypty</span><span class="sxs-lookup"><span data-stu-id="3aca3-122">Sample scripts</span></span>
<span data-ttu-id="3aca3-123">Do tworzenia klastrów usługi HDInsight w systemie operacyjnym Windows, hello akcji skryptu jest skrypt programu PowerShell systemu Azure.</span><span class="sxs-lookup"><span data-stu-id="3aca3-123">For creating HDInsight clusters on Windows operating system, hello Script Action is Azure PowerShell script.</span></span> <span data-ttu-id="3aca3-124">Witaj poniższy skrypt to przykład dla konfigurowania plików konfiguracji lokacji hello:</span><span class="sxs-lookup"><span data-stu-id="3aca3-124">hello following script is a sample for configuring hello site configuration files:</span></span>

[!INCLUDE [upgrade-powershell](../../includes/hdinsight-use-latest-powershell.md)]

    param (
        [parameter(Mandatory)][string] $ConfigFileName,
        [parameter(Mandatory)][string] $Name,
        [parameter(Mandatory)][string] $Value,
        [parameter()][string] $Description
    )

    if (!$Description) {
        $Description = ""
    }

    $hdiConfigFiles = @{
        "hive-site.xml" = "$env:HIVE_HOME\conf\hive-site.xml";
        "core-site.xml" = "$env:HADOOP_HOME\etc\hadoop\core-site.xml";
        "hdfs-site.xml" = "$env:HADOOP_HOME\etc\hadoop\hdfs-site.xml";
        "mapred-site.xml" = "$env:HADOOP_HOME\etc\hadoop\mapred-site.xml";
        "yarn-site.xml" = "$env:HADOOP_HOME\etc\hadoop\yarn-site.xml"
    }

    if (!($hdiConfigFiles[$ConfigFileName])) {
        Write-HDILog "Unable tooconfigure $ConfigFileName because it is not part of hello HDI configuration files."
        return
    }

    [xml]$configFile = Get-Content $hdiConfigFiles[$ConfigFileName]

    $existingproperty = $configFile.configuration.property | where {$_.Name -eq $Name}

    if ($existingproperty) {
        $existingproperty.Value = $Value
        $existingproperty.Description = $Description
    } else {
        $newproperty = @($configFile.configuration.property)[0].Clone()
        $newproperty.Name = $Name
        $newproperty.Value = $Value
        $newproperty.Description = $Description
        $configFile.configuration.AppendChild($newproperty)
    }

    $configFile.Save($hdiConfigFiles[$ConfigFileName])

    Write-HDILog "$configFileName has been configured."

<span data-ttu-id="3aca3-125">skrypt Hello przyjmuje cztery parametry, nazwa pliku konfiguracji hello, właściwość hello ma toomodify, wartość hello tooset i opis.</span><span class="sxs-lookup"><span data-stu-id="3aca3-125">hello script takes four parameters, hello configuration file name, hello property you want toomodify, hello value you want tooset, and a description.</span></span> <span data-ttu-id="3aca3-126">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3aca3-126">For example:</span></span>

    hive-site.xml hive.metastore.client.socket.timeout 90

<span data-ttu-id="3aca3-127">Te parametry ustawia hello hive.metastore.client.socket.timeout wartość too90 w pliku gałęzi site.xml hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-127">These parameters sets hello hive.metastore.client.socket.timeout value too90 in hello hive-site.xml file.</span></span>  <span data-ttu-id="3aca3-128">Witaj, wartość domyślna to 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="3aca3-128">hello default value is 60 seconds.</span></span>

<span data-ttu-id="3aca3-129">Ten przykładowy skrypt można znaleźć w [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span><span class="sxs-lookup"><span data-stu-id="3aca3-129">This sample script can also be found at [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span></span>

<span data-ttu-id="3aca3-130">Usługa HDInsight zapewnia kilka skryptów tooinstall dodatkowe składniki w klastrach HDInsight:</span><span class="sxs-lookup"><span data-stu-id="3aca3-130">HDInsight provides several scripts tooinstall additional components on HDInsight clusters:</span></span>

| <span data-ttu-id="3aca3-131">Nazwa</span><span class="sxs-lookup"><span data-stu-id="3aca3-131">Name</span></span> | <span data-ttu-id="3aca3-132">Skrypt</span><span class="sxs-lookup"><span data-stu-id="3aca3-132">Script</span></span> |
| --- | --- |
| <span data-ttu-id="3aca3-133">**Zainstaluj Spark**</span><span class="sxs-lookup"><span data-stu-id="3aca3-133">**Install Spark**</span></span> |<span data-ttu-id="3aca3-134">https://hdiconfigactions.blob.Core.Windows.NET/sparkconfigactionv03/Spark-Installer-v03.ps1.</span><span class="sxs-lookup"><span data-stu-id="3aca3-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span></span> <span data-ttu-id="3aca3-135">Zobacz [instalacji i używania platformy Spark w usłudze HDInsight clusters][hdinsight-install-spark].</span><span class="sxs-lookup"><span data-stu-id="3aca3-135">See [Install and use Spark on HDInsight clusters][hdinsight-install-spark].</span></span> |
| <span data-ttu-id="3aca3-136">**Zainstalować język R**</span><span class="sxs-lookup"><span data-stu-id="3aca3-136">**Install R**</span></span> |<span data-ttu-id="3aca3-137">https://hdiconfigactions.blob.Core.Windows.NET/rconfigactionv02/r-Installer-v02.ps1.</span><span class="sxs-lookup"><span data-stu-id="3aca3-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span></span> <span data-ttu-id="3aca3-138">Zobacz [instalacji i używania R w klastrach HDInsight][hdinsight-r-scripts].</span><span class="sxs-lookup"><span data-stu-id="3aca3-138">See [Install and use R on HDInsight clusters][hdinsight-r-scripts].</span></span> |
| <span data-ttu-id="3aca3-139">**Zainstaluj Solr**</span><span class="sxs-lookup"><span data-stu-id="3aca3-139">**Install Solr**</span></span> |<span data-ttu-id="3aca3-140">https://hdiconfigactions.blob.Core.Windows.NET/solrconfigactionv01/solr-Installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="3aca3-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span></span> <span data-ttu-id="3aca3-141">Zobacz [instalacji i używania Solr w usłudze HDInsight clusters](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-141">See [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span> |
| <span data-ttu-id="3aca3-142">- **Zainstaluj Giraph**</span><span class="sxs-lookup"><span data-stu-id="3aca3-142">- **Install Giraph**</span></span> |<span data-ttu-id="3aca3-143">https://hdiconfigactions.blob.Core.Windows.NET/giraphconfigactionv01/giraph-Installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="3aca3-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span></span> <span data-ttu-id="3aca3-144">Zobacz [instalacji i używania Giraph w usłudze HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-144">See [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span> |

<span data-ttu-id="3aca3-145">Akcja skryptu można wdrożyć z hello portalu Azure, programu Azure PowerShell lub przy użyciu hello zestawu .NET SDK usługi HDInsight.</span><span class="sxs-lookup"><span data-stu-id="3aca3-145">Script Action can be deployed from hello Azure portal, Azure PowerShell or by using hello HDInsight .NET SDK.</span></span>  <span data-ttu-id="3aca3-146">Aby uzyskać więcej informacji, zobacz [HDInsight dostosować klastry za pomocą akcji skryptu][hdinsight-cluster-customize].</span><span class="sxs-lookup"><span data-stu-id="3aca3-146">For more information, see [Customize HDInsight clusters using Script Action][hdinsight-cluster-customize].</span></span>

> [!NOTE]
> <span data-ttu-id="3aca3-147">Witaj przykładowe skrypty działa tylko z klastra usługi HDInsight w wersji 3.1 lub nowszy.</span><span class="sxs-lookup"><span data-stu-id="3aca3-147">hello sample scripts work only with HDInsight cluster version 3.1 or above.</span></span> <span data-ttu-id="3aca3-148">Aby uzyskać więcej informacji o wersjach klastra usługi HDInsight, zobacz [wersji klastra usługi HDInsight](hdinsight-component-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-148">For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).</span></span>
>
>

## <a name="helper-methods-for-custom-scripts"></a><span data-ttu-id="3aca3-149">Metody pomocnicze dla niestandardowych skryptów</span><span class="sxs-lookup"><span data-stu-id="3aca3-149">Helper methods for custom scripts</span></span>
<span data-ttu-id="3aca3-150">Metody pomocnicze akcji skryptu są narzędzia, które można użyć podczas pisania skryptów niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="3aca3-150">Script Action helper methods are utilities that you can use while writing custom scripts.</span></span> <span data-ttu-id="3aca3-151">Te metody są zdefiniowane w [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1)i może być uwzględniony w użyciu hello następujące przykładowe skrypty:</span><span class="sxs-lookup"><span data-stu-id="3aca3-151">These methods are defined in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1), and can be included in your scripts using hello following sample:</span></span>

    # Download config action module from a well-known directory.
    $CONFIGACTIONURI = "https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1";
    $CONFIGACTIONMODULE = "C:\apps\dist\HDInsightUtilities.psm1";
    $webclient = New-Object System.Net.WebClient;
    $webclient.DownloadFile($CONFIGACTIONURI, $CONFIGACTIONMODULE);

    # (TIP) Import config action helper method module toomake writing config action easy.
    if (Test-Path ($CONFIGACTIONMODULE))
    {
        Import-Module $CONFIGACTIONMODULE;
    }
    else
    {
        Write-Output "Failed tooload HDInsightUtilities module, exiting ...";
        exit;
    }

<span data-ttu-id="3aca3-152">Poniżej przedstawiono hello metody pomocnicze, które są udostępniane przez ten skrypt:</span><span class="sxs-lookup"><span data-stu-id="3aca3-152">Here are hello helper methods that are provided by this script:</span></span>

| <span data-ttu-id="3aca3-153">Metoda pomocnika</span><span class="sxs-lookup"><span data-stu-id="3aca3-153">Helper method</span></span> | <span data-ttu-id="3aca3-154">Opis</span><span class="sxs-lookup"><span data-stu-id="3aca3-154">Description</span></span> |
| --- | --- |
| <span data-ttu-id="3aca3-155">**Zapisz HDIFile**</span><span class="sxs-lookup"><span data-stu-id="3aca3-155">**Save-HDIFile**</span></span> |<span data-ttu-id="3aca3-156">Pobierz plik z hello określonej lokalizacji tooa identyfikator URI (Uniform Resource) na dysku lokalnym hello skojarzony z hello maszyny Wirtualnej Azure węzła przypisanej toohello klastra.</span><span class="sxs-lookup"><span data-stu-id="3aca3-156">Download a file from hello specified Uniform Resource Identifier (URI) tooa location on hello local disk that is associated with hello Azure VM node assigned toohello cluster.</span></span> |
| <span data-ttu-id="3aca3-157">**Rozwiń węzeł HDIZippedFile**</span><span class="sxs-lookup"><span data-stu-id="3aca3-157">**Expand-HDIZippedFile**</span></span> |<span data-ttu-id="3aca3-158">Rozpakuj plik z rozszerzeniem zip.</span><span class="sxs-lookup"><span data-stu-id="3aca3-158">Unzip a zipped file.</span></span> |
| <span data-ttu-id="3aca3-159">**Wywołanie HDICmdScript**</span><span class="sxs-lookup"><span data-stu-id="3aca3-159">**Invoke-HDICmdScript**</span></span> |<span data-ttu-id="3aca3-160">Uruchom skrypt z cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="3aca3-160">Run a script from cmd.exe.</span></span> |
| <span data-ttu-id="3aca3-161">**HDILog zapisu**</span><span class="sxs-lookup"><span data-stu-id="3aca3-161">**Write-HDILog**</span></span> |<span data-ttu-id="3aca3-162">Zapisywania danych wyjściowych z niestandardowego skryptu hello używanych w przypadku akcji skryptu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-162">Write output from hello custom script used for a script action.</span></span> |
| <span data-ttu-id="3aca3-163">**Get-Services**</span><span class="sxs-lookup"><span data-stu-id="3aca3-163">**Get-Services**</span></span> |<span data-ttu-id="3aca3-164">Pobierz listę usługi działające na maszynie hello, w którym hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-164">Get a list of services running on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-165">**Get-Service**</span><span class="sxs-lookup"><span data-stu-id="3aca3-165">**Get-Service**</span></span> |<span data-ttu-id="3aca3-166">O nazwie określonej usługi hello jako dane wejściowe, uzyskać szczegółowe informacje dla określonej usługi (nazwy usługi, przetworzyć identyfikator, stan, itp.) na maszynie hello gdzie hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-166">With hello specific service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-167">**Get-HDIServices**</span><span class="sxs-lookup"><span data-stu-id="3aca3-167">**Get-HDIServices**</span></span> |<span data-ttu-id="3aca3-168">Pobierz listę usług HDInsight działającego na komputerze hello, w którym hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-168">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-169">**Get-HDIService**</span><span class="sxs-lookup"><span data-stu-id="3aca3-169">**Get-HDIService**</span></span> |<span data-ttu-id="3aca3-170">Przy hello HDInsight usługi nazwy określonej jako dane wejściowe, uzyskać szczegółowe informacje dla określonej usługi (nazwy usługi, przetworzyć identyfikator, stan, itp.) na maszynie hello gdzie hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-170">With hello specific HDInsight service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-171">**Get-ServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="3aca3-171">**Get-ServicesRunning**</span></span> |<span data-ttu-id="3aca3-172">Pobierz listę usług, które są uruchomione na komputerze hello, w którym hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-172">Get a list of services that are running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-173">**Get-ServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="3aca3-173">**Get-ServiceRunning**</span></span> |<span data-ttu-id="3aca3-174">Sprawdź, czy określonej usługi (według nazwy) jest uruchomiony na komputerze hello gdzie hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-174">Check if a specific service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-175">**Get-HDIServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="3aca3-175">**Get-HDIServicesRunning**</span></span> |<span data-ttu-id="3aca3-176">Pobierz listę usług HDInsight działającego na komputerze hello, w którym hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-176">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-177">**Get-HDIServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="3aca3-177">**Get-HDIServiceRunning**</span></span> |<span data-ttu-id="3aca3-178">Sprawdź, czy określonej usługi HDInsight (według nazwy) jest uruchomiony na komputerze hello gdzie hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-178">Check if a specific HDInsight service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-179">**Get-HDIHadoopVersion**</span><span class="sxs-lookup"><span data-stu-id="3aca3-179">**Get-HDIHadoopVersion**</span></span> |<span data-ttu-id="3aca3-180">Pobierz wersję hello Hadoop zainstalowany na komputerze hello gdzie hello skrypt jest wykonywany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-180">Get hello version of Hadoop installed on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="3aca3-181">**IsHDIHeadNode testu**</span><span class="sxs-lookup"><span data-stu-id="3aca3-181">**Test-IsHDIHeadNode**</span></span> |<span data-ttu-id="3aca3-182">Sprawdź, czy komputer hello gdzie hello skrypt jest wykonywany jest węzła głównego.</span><span class="sxs-lookup"><span data-stu-id="3aca3-182">Check if hello computer where hello script executes is a head node.</span></span> |
| <span data-ttu-id="3aca3-183">**IsActiveHDIHeadNode testu**</span><span class="sxs-lookup"><span data-stu-id="3aca3-183">**Test-IsActiveHDIHeadNode**</span></span> |<span data-ttu-id="3aca3-184">Sprawdź, czy komputer hello gdzie hello skrypt jest wykonywany jest aktywnego węzła głównego.</span><span class="sxs-lookup"><span data-stu-id="3aca3-184">Check if hello computer where hello script executes is an active head node.</span></span> |
| <span data-ttu-id="3aca3-185">**IsHDIDataNode testu**</span><span class="sxs-lookup"><span data-stu-id="3aca3-185">**Test-IsHDIDataNode**</span></span> |<span data-ttu-id="3aca3-186">Sprawdź, czy komputer hello gdzie hello skrypt jest wykonywany jest węzeł danych.</span><span class="sxs-lookup"><span data-stu-id="3aca3-186">Check if hello computer where hello script executes is a data node.</span></span> |
| <span data-ttu-id="3aca3-187">**Edytuj HDIConfigFile**</span><span class="sxs-lookup"><span data-stu-id="3aca3-187">**Edit-HDIConfigFile**</span></span> |<span data-ttu-id="3aca3-188">Edytuj pliki konfiguracji hello hive-site.xml, core-site.xml, system plików hdfs-site.xml, mapred-site.xml lub yarn-site.xml.</span><span class="sxs-lookup"><span data-stu-id="3aca3-188">Edit hello config files hive-site.xml, core-site.xml, hdfs-site.xml, mapred-site.xml, or yarn-site.xml.</span></span> |

## <a name="best-practices-for-script-development"></a><span data-ttu-id="3aca3-189">Najlepsze rozwiązania dotyczące tworzenia skryptów</span><span class="sxs-lookup"><span data-stu-id="3aca3-189">Best practices for script development</span></span>
<span data-ttu-id="3aca3-190">Podczas opracowywania niestandardowego skryptu dla klastra usługi HDInsight są kilka tookeep najlepszych praktyk pamiętać:</span><span class="sxs-lookup"><span data-stu-id="3aca3-190">When you develop a custom script for an HDInsight cluster, there are several best practices tookeep in mind:</span></span>

* <span data-ttu-id="3aca3-191">Sprawdź, czy wersja Hadoop hello</span><span class="sxs-lookup"><span data-stu-id="3aca3-191">Check for hello Hadoop version</span></span>

    <span data-ttu-id="3aca3-192">HDInsight w wersji 3.1 (Hadoop 2.4) lub nowszym obsługa przy użyciu akcji skryptu tooinstall niestandardowych składników w klastrze.</span><span class="sxs-lookup"><span data-stu-id="3aca3-192">Only HDInsight version 3.1 (Hadoop 2.4) and above support using Script Action tooinstall custom components on a cluster.</span></span> <span data-ttu-id="3aca3-193">W skrypcie niestandardowe, należy użyć hello **Get HDIHadoopVersion** pomocnika metody toocheck hello Hadoop wersji przed kontynuowaniem wykonywania innych zadań w skrypcie hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-193">In your custom script, you must use hello **Get-HDIHadoopVersion** helper method toocheck hello Hadoop version before proceeding with performing other tasks in hello script.</span></span>
* <span data-ttu-id="3aca3-194">Znajdują się stabilne łączy tooscript zasoby</span><span class="sxs-lookup"><span data-stu-id="3aca3-194">Provide stable links tooscript resources</span></span>

    <span data-ttu-id="3aca3-195">Upewnij się, wszystkie skrypty hello i innych artefaktów używane w dostosowania hello klastra pozostają dostępne przez cały okres istnienia hello hello klastra i hello wersje tych plików nie należy zmieniać na czas trwania hello użytkowników.</span><span class="sxs-lookup"><span data-stu-id="3aca3-195">Users should make sure that all hello scripts and other artifacts used in hello customization of a cluster remain available throughout hello lifetime of hello cluster and that hello versions of these files do not change for hello duration.</span></span> <span data-ttu-id="3aca3-196">Te zasoby są wymagane, jeśli hello ponownym węzłów w klastrze hello jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="3aca3-196">These resources are required if hello reimaging of nodes in hello cluster is required.</span></span> <span data-ttu-id="3aca3-197">Witaj, najlepszym rozwiązaniem jest toodownload i zarchiwizowanie wszystkich na koncie magazynu, który hello kontrolki użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3aca3-197">hello best practice is toodownload and archive everything in a Storage account that hello user controls.</span></span> <span data-ttu-id="3aca3-198">Może to być hello domyślne konto magazynu lub dowolnym hello określone w chwili hello wdrożenia klastra dostosowane dodatkowych kont magazynu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-198">This can be hello default Storage account or any of hello additional Storage accounts specified at hello time of deployment for a customized cluster.</span></span>
    <span data-ttu-id="3aca3-199">W hello Spark i R dostosować klastra przykłady podane w dokumentacji hello, na przykład wprowadzono lokalną kopię hello zasobów tego konta magazynu: https://hdiconfigactions.blob.core.windows.net/.</span><span class="sxs-lookup"><span data-stu-id="3aca3-199">In hello Spark and R customized cluster samples provided in hello documentation, for example, we have made a local copy of hello resources in this Storage account: https://hdiconfigactions.blob.core.windows.net/.</span></span>
* <span data-ttu-id="3aca3-200">Upewnij się, że hello klastra dostosowywania skryptu jest idempotentności</span><span class="sxs-lookup"><span data-stu-id="3aca3-200">Ensure that hello cluster customization script is idempotent</span></span>

    <span data-ttu-id="3aca3-201">Należy oczekiwać, że hello węzłów klastra usługi HDInsight zostanie odtworzone z obrazu okres istnienia klastra hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-201">You must expect that hello nodes of an HDInsight cluster is reimaged during hello cluster lifetime.</span></span> <span data-ttu-id="3aca3-202">Witaj klastra dostosowania skrypt jest uruchamiany, gdy klaster zostanie odtworzone z obrazu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-202">hello cluster customization script is run whenever a cluster is reimaged.</span></span> <span data-ttu-id="3aca3-203">Ten skrypt musi być idempotentności toobe zaprojektowane w hello sensie, że po ponownej instalacji systemu, skrypt hello powinien zapewnić, że klastra hello jest zwracany toohello dostosowanej sam tuż po hello skryptu dla hello pierwszego uruchomienia podczas hello klastra został początkowo był w stanie utworzony.</span><span class="sxs-lookup"><span data-stu-id="3aca3-203">This script must be designed toobe idempotent in hello sense that upon reimaging, hello script should ensure that hello cluster is returned toohello same customized state that it was in just after hello script ran for hello first time when hello cluster was initially created.</span></span> <span data-ttu-id="3aca3-204">Na przykład, jeśli skryptu niestandardowego zainstalować aplikację na D:\AppLocation na pierwszym Uruchom, a następnie przy każdym uruchomieniu kolejne, po ponownym, skrypt hello należy sprawdzić, czy aplikacja hello istnieje na powitania D:\AppLocation lokalizacji przed kontynuowaniem z innymi kroki w skrypcie hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-204">For example, if a custom script installed an application at D:\AppLocation on its first run, then on each subsequent run, upon reimaging, hello script should check whether hello application exists at hello D:\AppLocation location before proceeding with other steps in hello script.</span></span>
* <span data-ttu-id="3aca3-205">Zainstaluj składniki niestandardowe w lokalizacji optymalne hello</span><span class="sxs-lookup"><span data-stu-id="3aca3-205">Install custom components in hello optimal location</span></span>

    <span data-ttu-id="3aca3-206">Jeśli węzły klastra są odtworzyć z obrazu, hello C:\ zasobów dysku i dysk systemowy D:\ można ponownie sformatowany, co grozi utratą hello danych i aplikacji, które były zainstalowane na tych dyskach.</span><span class="sxs-lookup"><span data-stu-id="3aca3-206">When cluster nodes are reimaged, hello C:\ resource drive and D:\ system drive can be reformatted, resulting in hello loss of data and applications that had been installed on those drives.</span></span> <span data-ttu-id="3aca3-207">Może to również nastąpić, jeśli węzeł maszyny wirtualnej platformy Azure (VM), który jest częścią klastra hello ulegnie awarii i zostało zastąpione przez nowy węzeł.</span><span class="sxs-lookup"><span data-stu-id="3aca3-207">This could also happen if an Azure virtual machine (VM) node that is part of hello cluster goes down and is replaced by a new node.</span></span> <span data-ttu-id="3aca3-208">Składniki można zainstalować na dysku D:\ hello lub w lokalizacji C:\apps hello na powitania klastra.</span><span class="sxs-lookup"><span data-stu-id="3aca3-208">You can install components on hello D:\ drive or in hello C:\apps location on hello cluster.</span></span> <span data-ttu-id="3aca3-209">Wszystkich innych lokalizacji na dysku C:\ hello są zastrzeżone.</span><span class="sxs-lookup"><span data-stu-id="3aca3-209">All other locations on hello C:\ drive are reserved.</span></span> <span data-ttu-id="3aca3-210">Określ lokalizację hello gdzie biblioteki lub aplikacje są toobe zainstalowane w hello klastra dostosowywania skryptu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-210">Specify hello location where applications or libraries are toobe installed in hello cluster customization script.</span></span>
* <span data-ttu-id="3aca3-211">Zapewni to wysoką dostępność hello architektury klastra</span><span class="sxs-lookup"><span data-stu-id="3aca3-211">Ensure high availability of hello cluster architecture</span></span>

    <span data-ttu-id="3aca3-212">HDInsight ma architekturę aktywny / pasywny wysokiej dostępności, w których jednego węzła głównego jest w trybie aktywnym (w którym jest uruchamiana hello usługi HDInsight) i innych hello węzła głównego jest w trybie rezerwy (w którym HDInsight usługi nie działają).</span><span class="sxs-lookup"><span data-stu-id="3aca3-212">HDInsight has an active-passive architecture for high availability, in which one head node is in active mode (where hello HDInsight services are running) and hello other head node is in standby mode (in which HDInsight services are not running).</span></span> <span data-ttu-id="3aca3-213">węzły Hello przełącznika tryby aktywnym i pasywnym, jeśli usługi HDInsight są przerywane.</span><span class="sxs-lookup"><span data-stu-id="3aca3-213">hello nodes switch active and passive modes if HDInsight services are interrupted.</span></span> <span data-ttu-id="3aca3-214">Akcja skryptu w przypadku usługi tooinstall używane na obu węzłach głównych wysokiej dostępności, należy pamiętać, że tego hello mechanizm pracy awaryjnej usługi HDInsight nie jest tooautomatically może zakończyć się niepowodzeniem przy użyciu tych usług zainstalowane przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3aca3-214">If a script action is used tooinstall services on both head nodes for high availability, note that hello HDInsight failover mechanism is not able tooautomatically fail over these user-installed services.</span></span> <span data-ttu-id="3aca3-215">Dlatego użytkownik zainstalował usługi na węzłach head HDInsight, które są oczekiwane toobe wysokiej dostępności musisz mieć własne mechanizm pracy awaryjnej w trybie aktywny / pasywny lub być w trybie aktywny / aktywny.</span><span class="sxs-lookup"><span data-stu-id="3aca3-215">So user-installed services on HDInsight head nodes that are expected toobe highly available must either have their own failover mechanism if in active-passive mode or be in active-active mode.</span></span>

    <span data-ttu-id="3aca3-216">Akcja skryptu HDInsight polecenie jest uruchamiane na obu węzłach głównych, gdy roli węzła head hello jest określona jako wartość hello *ClusterRoleCollection* parametru.</span><span class="sxs-lookup"><span data-stu-id="3aca3-216">An HDInsight Script Action command runs on both head nodes when hello head-node role is specified as a value in hello *ClusterRoleCollection* parameter.</span></span> <span data-ttu-id="3aca3-217">Tak podczas projektowania niestandardowego skryptu, upewnij się, że skrypt jest świadome tego Instalatora.</span><span class="sxs-lookup"><span data-stu-id="3aca3-217">So when you design a custom script, make sure that your script is aware of this setup.</span></span> <span data-ttu-id="3aca3-218">Nie należy uruchamiać na problemy z którym hello tej samej usługi są zainstalowane i uruchomione na obu węzłów head hello i ich przechodzili konkurujących ze sobą.</span><span class="sxs-lookup"><span data-stu-id="3aca3-218">You should not run into problems where hello same services are installed and started on both of hello head nodes and they end up competing with each other.</span></span> <span data-ttu-id="3aca3-219">Pamiętaj też, że dane zostały utracone podczas ponownej instalacji systemu, tak oprogramowania zainstalowanych za pomocą akcji skryptu ma toobe odporność toosuch zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3aca3-219">Also, be aware that data is lost during reimaging, so software installed via Script Action has toobe resilient toosuch events.</span></span> <span data-ttu-id="3aca3-220">Aplikacje powinny być zaprojektowane toowork o wysokiej dostępności danych, który będzie rozmieszczona na wielu węzłach.</span><span class="sxs-lookup"><span data-stu-id="3aca3-220">Applications should be designed toowork with highly available data that is distributed across many nodes.</span></span> <span data-ttu-id="3aca3-221">Należy pamiętać, że maksymalnie 1/5 hello węzłów w klastrze mogą można odtworzyć z obrazu na powitania tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="3aca3-221">Note that as many as 1/5 of hello nodes in a cluster can be reimaged at hello same time.</span></span>
* <span data-ttu-id="3aca3-222">Konfigurowanie magazynu obiektów Blob platformy Azure toouse niestandardowych składników hello</span><span class="sxs-lookup"><span data-stu-id="3aca3-222">Configure hello custom components toouse Azure Blob storage</span></span>

    <span data-ttu-id="3aca3-223">Hello niestandardowych składników, które należy zainstalować na węzłach klastra hello może być domyślny toouse konfiguracji magazynu systemu Distributed plików Hadoop (HDFS).</span><span class="sxs-lookup"><span data-stu-id="3aca3-223">hello custom components that you install on hello cluster nodes might have a default configuration toouse Hadoop Distributed File System (HDFS) storage.</span></span> <span data-ttu-id="3aca3-224">Zamiast tego należy zmienić hello toouse konfiguracji magazynu obiektów Blob platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="3aca3-224">You should change hello configuration toouse Azure Blob storage instead.</span></span> <span data-ttu-id="3aca3-225">Na klastrze odtworzenia z obrazu pobiera sformatowany w systemie plików HDFS hello i zostaną utracone wszystkie dane są przechowywane.</span><span class="sxs-lookup"><span data-stu-id="3aca3-225">On a cluster reimage, hello HDFS file system gets formatted and you would lose any data that is stored there.</span></span> <span data-ttu-id="3aca3-226">Zamiast tego przy użyciu magazynu obiektów Blob platformy Azure zapewnia, że dane są przechowywane.</span><span class="sxs-lookup"><span data-stu-id="3aca3-226">Using Azure Blob storage instead ensures that your data is retained.</span></span>

## <a name="common-usage-patterns"></a><span data-ttu-id="3aca3-227">Wspólne wzorce użycia</span><span class="sxs-lookup"><span data-stu-id="3aca3-227">Common usage patterns</span></span>
<span data-ttu-id="3aca3-228">Ta sekcja zawiera wskazówki dotyczące implementowania niektóre hello typowe wzorce użycia, które możesz napotkać podczas pisania skryptu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="3aca3-228">This section provides guidance on implementing some of hello common usage patterns that you might run into while writing your own custom script.</span></span>

### <a name="configure-environment-variables"></a><span data-ttu-id="3aca3-229">Skonfiguruj zmienne środowiskowe</span><span class="sxs-lookup"><span data-stu-id="3aca3-229">Configure environment variables</span></span>
<span data-ttu-id="3aca3-230">Często w rozwoju akcji skryptu, uważasz, że hello muszą tooset zmiennych środowiskowych.</span><span class="sxs-lookup"><span data-stu-id="3aca3-230">Often in script action development, you feel hello need tooset environment variables.</span></span> <span data-ttu-id="3aca3-231">Na przykład najbardziej prawdopodobnym scenariuszem jest podczas pobierania pliku binarnego z witryny zewnętrznej, ją zainstalować w klastrze hello i Dodaj lokalizację hello, gdzie jest zmienna środowiskowa "PATH" tooyour zainstalowanych.</span><span class="sxs-lookup"><span data-stu-id="3aca3-231">For instance, a most likely scenario is when you download a binary from an external site, install it on hello cluster, and add hello location of where it is installed tooyour ‘PATH’ environment variable.</span></span> <span data-ttu-id="3aca3-232">powitania po fragment kodu przedstawia sposób tooset zmienne środowiskowe w hello skryptu niestandardowego.</span><span class="sxs-lookup"><span data-stu-id="3aca3-232">hello following snippet shows you how tooset environment variables in hello custom script.</span></span>

    Write-HDILog "Starting environment variable setting at: $(Get-Date)";
    [Environment]::SetEnvironmentVariable('MDS_RUNNER_CUSTOM_CLUSTER', 'true', 'Machine');

<span data-ttu-id="3aca3-233">Ta instrukcja ustawia zmienną środowiskową hello **MDS_RUNNER_CUSTOM_CLUSTER** toohello wartość "true", a także ustawia hello zakresu tej zmiennej toobe komputera.</span><span class="sxs-lookup"><span data-stu-id="3aca3-233">This statement sets hello environment variable **MDS_RUNNER_CUSTOM_CLUSTER** toohello value 'true' and also sets hello scope of this variable toobe machine-wide.</span></span> <span data-ttu-id="3aca3-234">W czasie ważne jest, że zmienne środowiskowe są ustawiane w zakresie odpowiedniego hello — komputera lub użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3aca3-234">At times it is important that environment variables are set at hello appropriate scope – machine or user.</span></span> <span data-ttu-id="3aca3-235">Zobacz [tutaj] [ 1] Aby uzyskać więcej informacji na temat ustawiania zmiennych środowiskowych.</span><span class="sxs-lookup"><span data-stu-id="3aca3-235">Refer [here][1] for more information on setting environment variables.</span></span>

### <a name="access-toolocations-where-hello-custom-scripts-are-stored"></a><span data-ttu-id="3aca3-236">Gdzie są przechowywane niestandardowe skrypty hello toolocations dostępu</span><span class="sxs-lookup"><span data-stu-id="3aca3-236">Access toolocations where hello custom scripts are stored</span></span>
<span data-ttu-id="3aca3-237">Skrypty używane toocustomize tooeither potrzeb klastra można hello domyślne konto magazynu dla klastra hello lub publicznego kontenera tylko do odczytu na inne konto magazynu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-237">Scripts used toocustomize a cluster needs tooeither be in hello default storage account for hello cluster or in a public read-only container on any other storage account.</span></span> <span data-ttu-id="3aca3-238">Jeśli skrypt uzyskuje dostęp do zasobów znajdujących się w innym miejscu te czynności toobe w publicznie dostępnym (co najmniej publiczne tylko do odczytu).</span><span class="sxs-lookup"><span data-stu-id="3aca3-238">If your script accesses resources located elsewhere these need toobe in a publicly accessible (at least public read-only).</span></span> <span data-ttu-id="3aca3-239">Na przykład może tooaccess pliku i zapisz go przy użyciu polecenia hello SaveFile HDI.</span><span class="sxs-lookup"><span data-stu-id="3aca3-239">For instance you might want tooaccess a file and save it using hello SaveFile-HDI command.</span></span>

    Save-HDIFile -SrcUri 'https://somestorageaccount.blob.core.windows.net/somecontainer/some-file.jar' -DestFile 'C:\apps\dist\hadoop-2.4.0.2.1.9.0-2196\share\hadoop\mapreduce\some-file.jar'

<span data-ttu-id="3aca3-240">W tym przykładzie musisz zapewnić, że kontenera "somecontainer" na koncie magazynu "somestorageaccount" hello jest dostępny publicznie.</span><span class="sxs-lookup"><span data-stu-id="3aca3-240">In this example, you must ensure that hello container 'somecontainer' in storage account 'somestorageaccount' is publicly accessible.</span></span> <span data-ttu-id="3aca3-241">W przeciwnym razie hello skrypt zgłasza wyjątek nie znaleziono i zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="3aca3-241">Otherwise, hello script throws a ‘Not Found’ exception and fail.</span></span>

### <a name="pass-parameters-toohello-add-azurermhdinsightscriptaction-cmdlet"></a><span data-ttu-id="3aca3-242">Polecenie cmdlet Add-AzureRmHDInsightScriptAction toohello parametry do przekazania</span><span class="sxs-lookup"><span data-stu-id="3aca3-242">Pass parameters toohello Add-AzureRmHDInsightScriptAction cmdlet</span></span>
<span data-ttu-id="3aca3-243">toopass wiele parametrów polecenia cmdlet toohello Dodaj AzureRmHDInsightScriptAction, należy toocontain wartość ciąg hello tooformat wszystkie parametry dla hello skryptu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-243">toopass multiple parameters toohello Add-AzureRmHDInsightScriptAction cmdlet, you need tooformat hello string value toocontain all parameters for hello script.</span></span> <span data-ttu-id="3aca3-244">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3aca3-244">For example:</span></span>

    "-CertifcateUri wasb:///abc.pfx -CertificatePassword 123456 -InstallFolderName MyFolder"

<span data-ttu-id="3aca3-245">lub</span><span class="sxs-lookup"><span data-stu-id="3aca3-245">or</span></span>

    $parameters = '-Parameters "{0};{1};{2}"' -f $CertificateName,$certUriWithSasToken,$CertificatePassword


### <a name="throw-exception-for-failed-cluster-deployment"></a><span data-ttu-id="3aca3-246">Zgłoszenie wyjątku dla wdrożenia klastra nie powiodło się</span><span class="sxs-lookup"><span data-stu-id="3aca3-246">Throw exception for failed cluster deployment</span></span>
<span data-ttu-id="3aca3-247">Wtedy, gdy tooget dokładnie powiadomienie faktu hello dostosowywania tego klastra nie powiodła się zgodnie z oczekiwaniami, jest ważne toothrow wyjątek i niepowodzenie hello tworzenia klastra.</span><span class="sxs-lookup"><span data-stu-id="3aca3-247">If you want tooget accurately notified of hello fact that cluster customization did not succeed as expected, it is important toothrow an exception and fail hello cluster creation.</span></span> <span data-ttu-id="3aca3-248">Na przykład możesz mają tooprocess pliku, jeśli istnieje i obsługę w przypadku błędu hello, gdzie hello plik nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="3aca3-248">For instance, you might want tooprocess a file if it exists and handle hello error case where hello file does not exist.</span></span> <span data-ttu-id="3aca3-249">Może to zapewnić hello skrypt zakończy pracę bezpiecznie i hello stan klastra hello poprawnie jest znany.</span><span class="sxs-lookup"><span data-stu-id="3aca3-249">This would ensure that hello script exits gracefully and hello state of hello cluster is correctly known.</span></span> <span data-ttu-id="3aca3-250">Witaj następujący fragment kodu przedstawiono przykładowy sposób tooachieve to:</span><span class="sxs-lookup"><span data-stu-id="3aca3-250">hello following snippet gives an example of how tooachieve this:</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    exit
    }

<span data-ttu-id="3aca3-251">W tym fragmencie Jeśli hello plik nie istnieje, jej doprowadziłoby stanu tooa gdzie skryptu hello faktycznie opuszcza bezpiecznie po wydrukowaniu komunikat o błędzie hello i klastra hello osiągnie uruchomiona przy założeniu, że "pomyślnie" ukończyć procesu dostosowywania klastra.</span><span class="sxs-lookup"><span data-stu-id="3aca3-251">In this snippet, if hello file did not exist, it would lead tooa state where hello script actually exits gracefully after printing hello error message, and hello cluster reaches running state assuming it "successfully" completed cluster customization process.</span></span> <span data-ttu-id="3aca3-252">Wtedy, gdy toobe dokładnie powiadomienie faktu hello dostosowywania tego klastra zasadniczo nie powiodło się zgodnie z oczekiwaniami ze względu na Brak pliku, jest bardziej odpowiednia toothrow wyjątek i niepowodzenie kroku dostosowania klastra hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-252">If you want toobe accurately notified of hello fact that cluster customization essentially did not succeed as expected because of a missing file, it is more appropriate toothrow an exception and fail hello cluster customization step.</span></span> <span data-ttu-id="3aca3-253">tooachieve to hello następującego fragmentu kodu przykładowej zamiast tego należy użyć.</span><span class="sxs-lookup"><span data-stu-id="3aca3-253">tooachieve this you must use hello following sample code snippet instead.</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    throw
    }


## <a name="checklist-for-deploying-a-script-action"></a><span data-ttu-id="3aca3-254">Lista kontrolna wdrażania akcji skryptu</span><span class="sxs-lookup"><span data-stu-id="3aca3-254">Checklist for deploying a script action</span></span>
<span data-ttu-id="3aca3-255">Poniżej przedstawiono kroki hello Wybraliśmy podczas przygotowywania toodeploy te skrypty:</span><span class="sxs-lookup"><span data-stu-id="3aca3-255">Here are hello steps we took when preparing toodeploy these scripts:</span></span>

1. <span data-ttu-id="3aca3-256">Umieść hello pliki, które zawierają hello niestandardowych skryptów w miejscu, który jest dostępny dla węzłów klastra hello podczas wdrażania.</span><span class="sxs-lookup"><span data-stu-id="3aca3-256">Put hello files that contain hello custom scripts in a place that is accessible by hello cluster nodes during deployment.</span></span> <span data-ttu-id="3aca3-257">Może to być domyślny hello lub dodatkowych kont magazynu określony w momencie hello wdrożenie klastra lub innych kontenera magazynu publicznie.</span><span class="sxs-lookup"><span data-stu-id="3aca3-257">This can be any of hello default or additional Storage accounts specified at hello time of cluster deployment, or any other publicly accessible storage container.</span></span>
2. <span data-ttu-id="3aca3-258">Dodaj kontroli do skryptów toomake się upewnić, że są one wykonywane idempotently, tak, aby skrypt hello mogą być wykonywane wiele razy na powitania tym samym węźle.</span><span class="sxs-lookup"><span data-stu-id="3aca3-258">Add checks into scripts toomake sure that they execute idempotently, so that hello script can be executed multiple times on hello same node.</span></span>
3. <span data-ttu-id="3aca3-259">Użyj hello **Write-Output** tooSTDOUT tooprint polecenia cmdlet programu Azure PowerShell, a także STDERR.</span><span class="sxs-lookup"><span data-stu-id="3aca3-259">Use hello **Write-Output** Azure PowerShell cmdlet tooprint tooSTDOUT as well as STDERR.</span></span> <span data-ttu-id="3aca3-260">Nie używaj **Write-Host**.</span><span class="sxs-lookup"><span data-stu-id="3aca3-260">Do not use **Write-Host**.</span></span>
4. <span data-ttu-id="3aca3-261">Użyj folder plików tymczasowych, takich jak $env: TEMP, tookeep hello pobrany plik używany przez skrypty hello, a następnie wyczyść je po wykonaniu skryptów.</span><span class="sxs-lookup"><span data-stu-id="3aca3-261">Use a temporary file folder, such as $env:TEMP, tookeep hello downloaded file used by hello scripts and then clean them up after scripts have executed.</span></span>
5. <span data-ttu-id="3aca3-262">Zainstaluj oprogramowanie niestandardowe tylko na D:\ lub C:\apps.</span><span class="sxs-lookup"><span data-stu-id="3aca3-262">Install custom software only at D:\ or C:\apps.</span></span> <span data-ttu-id="3aca3-263">Nie należy używać innych lokalizacji na dysku C: hello są one zastrzeżone.</span><span class="sxs-lookup"><span data-stu-id="3aca3-263">Other locations on hello C: drive should not be used as they are reserved.</span></span> <span data-ttu-id="3aca3-264">Należy pamiętać, że instalowanie plików na dysku C: hello poza folderem C:\apps hello może spowodować błędy instalacji podczas reimages hello węzła.</span><span class="sxs-lookup"><span data-stu-id="3aca3-264">Note that installing files on hello C: drive outside of hello C:\apps folder may result in setup failures during reimages of hello node.</span></span>
6. <span data-ttu-id="3aca3-265">W przypadku hello zostały zmienione ustawienia na poziomie systemu operacyjnego lub plików konfiguracyjnych usługi Hadoop możesz toorestart usługi HDInsight, dzięki czemu użytkownik może wybrać wszystkie ustawienia poziomu systemu operacyjnego, takich jak hello zmienne środowiskowe w hello skryptów.</span><span class="sxs-lookup"><span data-stu-id="3aca3-265">In hello event that OS-level settings or Hadoop service configuration files were changed, you may want toorestart HDInsight services so that they can pick up any OS-level settings, such as hello environment variables set in hello scripts.</span></span>

## <a name="debug-custom-scripts"></a><span data-ttu-id="3aca3-266">Debugowanie skryptów niestandardowych</span><span class="sxs-lookup"><span data-stu-id="3aca3-266">Debug custom scripts</span></span>
<span data-ttu-id="3aca3-267">dzienniki błędów skryptu Hello są przechowywane wraz z innymi dane wyjściowe w hello domyślnego konta magazynu określony dla hello klastra podczas jego tworzenia.</span><span class="sxs-lookup"><span data-stu-id="3aca3-267">hello script error logs are stored, along with other output, in hello default Storage account that you specified for hello cluster at its creation.</span></span> <span data-ttu-id="3aca3-268">Witaj dzienniki są przechowywane w tabeli o nazwie hello *u < \cluster-name-fragment >< \time-stamp > setuplog*.</span><span class="sxs-lookup"><span data-stu-id="3aca3-268">hello logs are stored in a table with hello name *u<\cluster-name-fragment><\time-stamp>setuplog*.</span></span> <span data-ttu-id="3aca3-269">Są to dzienniki zagregowane, które rekordy z wszystkich węzłów hello (węzła głównego i węzły procesów roboczych) na które hello skrypt jest uruchamiany w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-269">These are aggregated logs that have records from all of hello nodes (head node and worker nodes) on which hello script runs in hello cluster.</span></span>
<span data-ttu-id="3aca3-270">Łatwe toocheck hello dzienników jest toouse HDInsight Tools dla programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3aca3-270">An easy way toocheck hello logs is toouse HDInsight Tools for Visual Studio.</span></span> <span data-ttu-id="3aca3-271">Do zainstalowania narzędzia hello, zobacz [rozpocząć korzystanie z narzędzi Visual Studio Hadoop dla usługi HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span><span class="sxs-lookup"><span data-stu-id="3aca3-271">For installing hello tools, see [Get started using Visual Studio Hadoop tools for HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span></span>

<span data-ttu-id="3aca3-272">**toocheck hello dziennika za pomocą programu Visual Studio**</span><span class="sxs-lookup"><span data-stu-id="3aca3-272">**toocheck hello log using Visual Studio**</span></span>

1. <span data-ttu-id="3aca3-273">Otwórz program Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3aca3-273">Open Visual Studio.</span></span>
2. <span data-ttu-id="3aca3-274">Kliknij przycisk **widoku**, a następnie kliknij przycisk **Eksploratora serwera**.</span><span class="sxs-lookup"><span data-stu-id="3aca3-274">Click **View**, and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="3aca3-275">Kliknij prawym przyciskiem myszy "Azure", kliknij przycisk Połącz za**subskrypcji platformy Microsoft Azure**, a następnie wprowadź swoje poświadczenia.</span><span class="sxs-lookup"><span data-stu-id="3aca3-275">Right-click "Azure", click Connect too**Microsoft Azure Subscriptions**, and then enter your credentials.</span></span>
4. <span data-ttu-id="3aca3-276">Rozwiń węzeł **magazynu**, rozwiń konto usługi Azure storage hello używany jako domyślny system plików hello, rozwiń węzeł **tabel**, a następnie kliknij dwukrotnie nazwę tabeli hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-276">Expand **Storage**, expand hello Azure storage account used as hello default file system, expand **Tables**, and then double-click hello table name.</span></span>

<span data-ttu-id="3aca3-277">Możesz również zdalnego do toosee węzłów klastra hello zarówno STDOUT i STDERR niestandardowych skryptów.</span><span class="sxs-lookup"><span data-stu-id="3aca3-277">You can also remote into hello cluster nodes toosee both STDOUT and STDERR for custom scripts.</span></span> <span data-ttu-id="3aca3-278">Witaj dzienniki w każdym węźle są określonego węzła tylko toothat i logują się do **C:\HDInsightLogs\DeploymentAgent.log**.</span><span class="sxs-lookup"><span data-stu-id="3aca3-278">hello logs on each node are specific only toothat node and are logged into **C:\HDInsightLogs\DeploymentAgent.log**.</span></span> <span data-ttu-id="3aca3-279">Te pliki dziennika rejestrować wszystkie dane wyjściowe z hello niestandardowego skryptu.</span><span class="sxs-lookup"><span data-stu-id="3aca3-279">These log files record all outputs from hello custom script.</span></span> <span data-ttu-id="3aca3-280">Przykład fragment dziennika akcji skryptu Spark wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="3aca3-280">An example log snippet for a Spark script action looks like this:</span></span>

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand; Details : BEGIN: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Starting Spark installation at: 09/04/2014 21:46:02 Done with Spark installation at: 09/04/2014 21:46:38;

    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand;
    Details : END: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;


<span data-ttu-id="3aca3-281">W tym dzienniku jest jasne, czy wykonano akcji skryptu Spark hello na powitania maszyny Wirtualnej o nazwie HEADNODE0 i że nie zwrócono wyjątek podczas wykonywania hello.</span><span class="sxs-lookup"><span data-stu-id="3aca3-281">In this log, it is clear that hello Spark script action has been executed on hello VM named HEADNODE0 and that no exceptions were thrown during hello execution.</span></span>

<span data-ttu-id="3aca3-282">W zdarzeniu hello, która występuje błąd wykonania dane wyjściowe hello opisujące go również znajduje się w tym pliku dziennika.</span><span class="sxs-lookup"><span data-stu-id="3aca3-282">In hello event that an execution failure occurs, hello output describing it is also contained in this log file.</span></span> <span data-ttu-id="3aca3-283">Witaj informacji dostępnych w tych dziennikach powinna być pomocnych w debugowaniu problemów skryptu, które mogą wystąpić.</span><span class="sxs-lookup"><span data-stu-id="3aca3-283">hello information provided in these logs should be helpful in debugging script problems that may arise.</span></span>

## <a name="see-also"></a><span data-ttu-id="3aca3-284">Zobacz też</span><span class="sxs-lookup"><span data-stu-id="3aca3-284">See also</span></span>
* <span data-ttu-id="3aca3-285">[Dostosowywanie klastrów usługi HDInsight przy użyciu akcji skryptu][hdinsight-cluster-customize]</span><span class="sxs-lookup"><span data-stu-id="3aca3-285">[Customize HDInsight clusters using Script Action][hdinsight-cluster-customize]</span></span>
* <span data-ttu-id="3aca3-286">[Zainstalować i używać platformy Spark w usłudze hdinsight][hdinsight-install-spark]</span><span class="sxs-lookup"><span data-stu-id="3aca3-286">[Install and use Spark on HDInsight clusters][hdinsight-install-spark]</span></span>
* <span data-ttu-id="3aca3-287">[Zainstaluj i użyj języka R w klastrach HDInsight][hdinsight-r-scripts]</span><span class="sxs-lookup"><span data-stu-id="3aca3-287">[Install and use R on HDInsight clusters][hdinsight-r-scripts]</span></span>
* <span data-ttu-id="3aca3-288">[Zainstalować i używać Solr w klastrach HDInsight](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-288">[Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span>
* <span data-ttu-id="3aca3-289">[Zainstalować i używać Giraph w klastrach HDInsight](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="3aca3-289">[Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span>

[hdinsight-provision]: hdinsight-provision-clusters.md
[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md
[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md
[hdinsight-r-scripts]: hdinsight-hadoop-r-scripts.md
[powershell-install-configure]: install-configure-powershell.md

<!--Reference links in article-->
[1]: https://msdn.microsoft.com/library/96xafkes(v=vs.110).aspx
