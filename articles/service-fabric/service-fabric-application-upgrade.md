---
title: "Uaktualnianie aplikacji sieci szkieletowej usług | Dokumentacja firmy Microsoft"
description: "Ten artykuł zawiera wprowadzenie do uaktualniania aplikacji usługi Service Fabric, w tym wyboru między trybami uaktualniania i zostanie wykonana kontroli kondycji."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 4c2752bee8e9a859b23dbf47662d15798b551bb5
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="a75fc-103">Uaktualnianie aplikacji usługi Service Fabric</span><span class="sxs-lookup"><span data-stu-id="a75fc-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="a75fc-104">Aplikacja Azure Service Fabric jest kolekcja usług.</span><span class="sxs-lookup"><span data-stu-id="a75fc-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="a75fc-105">Podczas uaktualniania usługi sieć szkieletowa porównuje nowe [manifest aplikacji](service-fabric-application-model.md#describe-an-application) z poprzedniej wersji i określa usług w aplikacji wymagają aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-105">During an upgrade, Service Fabric compares the new [application manifest](service-fabric-application-model.md#describe-an-application) with the previous version and determines which services in the application require updates.</span></span> <span data-ttu-id="a75fc-106">Sieć szkieletowa usług porównuje wersji numery w usłudze manifesty numery wersji w poprzedniej wersji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-106">Service Fabric compares the version numbers in the service manifests with the version numbers in the previous version.</span></span> <span data-ttu-id="a75fc-107">Jeśli usługa nie została zmieniona, czy usługa nie jest uaktualniony.</span><span class="sxs-lookup"><span data-stu-id="a75fc-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="a75fc-108">Omówienie uaktualnienia stopniowego</span><span class="sxs-lookup"><span data-stu-id="a75fc-108">Rolling upgrades overview</span></span>
<span data-ttu-id="a75fc-109">W uaktualnienia stopniowego aplikacji uaktualnienia jest wykonywane w etapach.</span><span class="sxs-lookup"><span data-stu-id="a75fc-109">In a rolling application upgrade, the upgrade is performed in stages.</span></span> <span data-ttu-id="a75fc-110">Na każdym etapie uaktualnienie ma zostać zastosowane do podzbioru węzłów w klastrze o nazwie domeny aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-110">At each stage, the upgrade is applied to a subset of nodes in the cluster, called an update domain.</span></span> <span data-ttu-id="a75fc-111">W związku z tym aplikacja pozostaje dostępne w całej uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="a75fc-111">As a result, the application remains available throughout the upgrade.</span></span> <span data-ttu-id="a75fc-112">Podczas uaktualniania klastra może zawierać mieszanie starej i nowej wersji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-112">During the upgrade, the cluster may contain a mix of the old and new versions.</span></span>

<span data-ttu-id="a75fc-113">Z tego powodu dwie wersje musi być do przodu i do tyłu zgodne.</span><span class="sxs-lookup"><span data-stu-id="a75fc-113">For that reason, the two versions must be forward and backward compatible.</span></span> <span data-ttu-id="a75fc-114">Jeśli nie są zgodne, administrator aplikacji jest odpowiedzialny za przemieszczania uaktualnienia fazy, aby zachować dostępność.</span><span class="sxs-lookup"><span data-stu-id="a75fc-114">If they are not compatible, the application administrator is responsible for staging a multiple-phase upgrade to maintain availability.</span></span> <span data-ttu-id="a75fc-115">Uaktualnianie fazy pierwszym krokiem jest uaktualnienie do pośredniego wersji aplikacji, która jest zgodna z poprzednią wersją.</span><span class="sxs-lookup"><span data-stu-id="a75fc-115">In a multiple-phase upgrade, the first step is upgrading to an intermediate version of the application that is compatible with the previous version.</span></span> <span data-ttu-id="a75fc-116">Drugim krokiem jest uaktualnienie z ostateczną wersją dzieli zgodności z wersją przed aktualizacją, ale jest niezgodny z wersją pośrednich.</span><span class="sxs-lookup"><span data-stu-id="a75fc-116">The second step is to upgrade the final version that breaks compatibility with the pre-update version, but is compatible with the intermediate version.</span></span>

<span data-ttu-id="a75fc-117">Domen aktualizacji są określone w manifeście klastra podczas konfigurowania klastra.</span><span class="sxs-lookup"><span data-stu-id="a75fc-117">Update domains are specified in the cluster manifest when you configure the cluster.</span></span> <span data-ttu-id="a75fc-118">Aktualizacja domeny nie otrzymywać aktualizacje w określonej kolejności.</span><span class="sxs-lookup"><span data-stu-id="a75fc-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="a75fc-119">Domena aktualizacji jest jednostka logiczna wdrożenia dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="a75fc-120">Aktualizacja domen Zezwalaj usługom ma pozostać w wysokiej dostępności podczas uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="a75fc-120">Update domains allow the services to remain at high availability during an upgrade.</span></span>

<span data-ttu-id="a75fc-121">Uaktualnienia stopniowego nie są możliwe, jeśli uaktualnienie ma zostać zastosowane do wszystkich węzłów w klastrze, co ma miejsce w przypadku aplikacji ma tylko jedną domenę aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-121">Non-rolling upgrades are possible if the upgrade is applied to all nodes in the cluster, which is the case when the application has only one update domain.</span></span> <span data-ttu-id="a75fc-122">Ta metoda nie jest zalecane, ponieważ usługa ulegnie awarii i nie jest dostępny w czasie uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="a75fc-122">This approach is not recommended, since the service goes down and isn't available at the time of upgrade.</span></span> <span data-ttu-id="a75fc-123">Ponadto Azure nie daje żadnej gwarancji, po skonfigurowaniu klastra z tylko jedną aktualizację domeny.</span><span class="sxs-lookup"><span data-stu-id="a75fc-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="a75fc-124">Sprawdzanie kondycji podczas uaktualniania</span><span class="sxs-lookup"><span data-stu-id="a75fc-124">Health checks during upgrades</span></span>
<span data-ttu-id="a75fc-125">W przypadku uaktualnienia zasady dotyczące kondycji muszą być ustawione lub mogą zostać użyte wartości domyślne.</span><span class="sxs-lookup"><span data-stu-id="a75fc-125">For an upgrade, health policies have to be set (or default values may be used).</span></span> <span data-ttu-id="a75fc-126">Uaktualnienie jest określane powiodło się po uaktualnieniu wszystkich domen aktualizacji w ramach określonego limitu czasu i wszystkich domen aktualizacji zostaną uznane za dobrej kondycji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-126">An upgrade is termed successful when all update domains are upgraded within the specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="a75fc-127">Domeny aktualizacji w dobrej kondycji oznacza, że domeny aktualizacji przekazywany kontroli kondycji określonym w zasadach kondycji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-127">A healthy update domain means that the update domain passed all the health checks specified in the health policy.</span></span> <span data-ttu-id="a75fc-128">Na przykład zasadę może wprowadzić, że wszystkie usługi w ramach wystąpienia aplikacji musi być *dobrej kondycji*, jak kondycji jest definiowana za pomocą sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="a75fc-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="a75fc-129">Zasady dotyczące kondycji i kontroli podczas uaktualniania przez sieć szkieletowa usług są niezależne od usług i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="a75fc-130">Oznacza to, że są wykonywane żadne testy specyficzne dla usługi.</span><span class="sxs-lookup"><span data-stu-id="a75fc-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="a75fc-131">Na przykład usługa może mieć wymaganie przepływności, ale usługi sieć szkieletowa nie ma informacji, aby sprawdzić przepływności.</span><span class="sxs-lookup"><span data-stu-id="a75fc-131">For example, your service might have a throughput requirement, but Service Fabric does not have the information to check throughput.</span></span> <span data-ttu-id="a75fc-132">Zapoznaj się [artykuły kondycji](service-fabric-health-introduction.md) dla testów, które są wykonywane.</span><span class="sxs-lookup"><span data-stu-id="a75fc-132">Refer to the [health articles](service-fabric-health-introduction.md) for the checks that are performed.</span></span> <span data-ttu-id="a75fc-133">Sprawdza, czy mają miejsce podczas testów uaktualniania include dla tego, czy pakiet aplikacji został skopiowany poprawnie, czy wystąpienie zostało uruchomione itd.</span><span class="sxs-lookup"><span data-stu-id="a75fc-133">The checks that happen during an upgrade include tests for whether the application package was copied correctly, whether the instance was started, and so on.</span></span>

<span data-ttu-id="a75fc-134">Kondycja aplikacji jest agregacją obiektów podrzędnych w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-134">The application health is an aggregation of the child entities of the application.</span></span> <span data-ttu-id="a75fc-135">Innymi słowy sieć szkieletowa usług ocenia kondycję aplikację przez usługę kondycji, który jest zgłaszany w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-135">In short, Service Fabric evaluates the health of the application through the health that is reported on the application.</span></span> <span data-ttu-id="a75fc-136">Oblicza również kondycję wszystkich usług dla aplikacji w ten sposób.</span><span class="sxs-lookup"><span data-stu-id="a75fc-136">It also evaluates the health of all the services for the application this way.</span></span> <span data-ttu-id="a75fc-137">Dodatkowe sieci szkieletowej usług ocenia kondycję usługi aplikacji przez agregowanie ich elementy podrzędne, takie jak repliki usługi kondycji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-137">Service Fabric further evaluates the health of the application services by aggregating the health of their children, such as the service replica.</span></span> <span data-ttu-id="a75fc-138">Po spełnieniu zasad dotyczących kondycji aplikacji, można kontynuować uaktualnienie.</span><span class="sxs-lookup"><span data-stu-id="a75fc-138">Once the application health policy is satisfied, the upgrade can proceed.</span></span> <span data-ttu-id="a75fc-139">Naruszenia zasad dotyczących kondycji uaktualniania aplikacji nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="a75fc-139">If the health policy is violated, the application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="a75fc-140">Tryby uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="a75fc-140">Upgrade modes</span></span>
<span data-ttu-id="a75fc-141">Tryb, w którym firma Microsoft zaleca się uaktualnienie aplikacji jest monitorowane tryb, który jest powszechnie używany tryb.</span><span class="sxs-lookup"><span data-stu-id="a75fc-141">The mode that we recommend for application upgrade is the monitored mode, which is the commonly used mode.</span></span> <span data-ttu-id="a75fc-142">Tryb monitorowanych wykonuje uaktualnienia w domenie jedna aktualizacja, a jeśli sprawdza wszystkie dane kondycji przebiegu (na zasady określone), przechodzi do następnej domeny aktualizacji automatycznie.</span><span class="sxs-lookup"><span data-stu-id="a75fc-142">Monitored mode performs the upgrade on one update domain, and if all health checks pass (per the policy specified), moves on to the next update domain automatically.</span></span>  <span data-ttu-id="a75fc-143">Niepowodzenie sprawdzania kondycji i/lub osiągnięcia limitów czasu, uaktualnienia albo jest przywracana w domenie aktualizacji, czy tryb zostanie zmieniona na niemonitorowane ręcznie.</span><span class="sxs-lookup"><span data-stu-id="a75fc-143">If health checks fail and/or time-outs are reached, the upgrade is either rolled back for the update domain, or the mode is changed to unmonitored manual.</span></span> <span data-ttu-id="a75fc-144">Można skonfigurować uaktualnienia można wybrać jeden z tych dwóch trybów uaktualnienia nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="a75fc-144">You can configure the upgrade to choose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="a75fc-145">Niemonitorowane ręczny tryb wymaga ręcznej interwencji po każdym uaktualnieniu domeny aktualizacji, aby rozpocząć poza uaktualniania do następnej domeny aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, to kick off the upgrade on the next update domain.</span></span> <span data-ttu-id="a75fc-146">Nie sieci szkieletowej usług kondycji są sprawdzane.</span><span class="sxs-lookup"><span data-stu-id="a75fc-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="a75fc-147">Administrator przeprowadza kontrole kondycji lub stanu przed rozpoczęciem uaktualniania w następnej domeny aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="a75fc-147">The administrator performs the health or status checks before starting the upgrade in the next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="a75fc-148">Uaktualnij usługi domyślne</span><span class="sxs-lookup"><span data-stu-id="a75fc-148">Upgrade default services</span></span>
<span data-ttu-id="a75fc-149">Podczas procesu uaktualniania aplikacji można uaktualnić usługi domyślnej aplikacji sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="a75fc-149">Default services within Service Fabric application can be upgraded during the upgrade process of an application.</span></span> <span data-ttu-id="a75fc-150">Domyślne usługi są zdefiniowane w [manifest aplikacji](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="a75fc-150">Default services are defined in the [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="a75fc-151">Standardowe reguły uaktualniania usług domyślnych są następujące:</span><span class="sxs-lookup"><span data-stu-id="a75fc-151">The standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="a75fc-152">Domyślne usługi w nowym [manifest aplikacji](service-fabric-application-model.md#describe-an-application) który nie istnieje w klastrze są tworzone.</span><span class="sxs-lookup"><span data-stu-id="a75fc-152">Default services in the new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in the cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="a75fc-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) musi być ustawiona na true, aby włączyć następujące reguły.</span><span class="sxs-lookup"><span data-stu-id="a75fc-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs to be set to true to enable the following rules.</span></span> <span data-ttu-id="a75fc-154">Ta funkcja jest obsługiwana w wersji 5.5.</span><span class="sxs-lookup"><span data-stu-id="a75fc-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="a75fc-155">Domyślne usługi istniejących w obu poprzednich [manifest aplikacji](service-fabric-application-model.md#describe-an-application) i nowej wersji zostały zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="a75fc-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="a75fc-156">Opisy usług w nowej wersji zastąpiłaby już w klastrze.</span><span class="sxs-lookup"><span data-stu-id="a75fc-156">Service descriptions in the new version would overwrite those already in the cluster.</span></span> <span data-ttu-id="a75fc-157">Uaktualnianie aplikacji czy wycofywania automatycznie po aktualizacji awaria usługi domyślne.</span><span class="sxs-lookup"><span data-stu-id="a75fc-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="a75fc-158">Domyślne usługi w poprzedniej [manifest aplikacji](service-fabric-application-model.md#describe-an-application) , ale nie w nowej wersji są usuwane.</span><span class="sxs-lookup"><span data-stu-id="a75fc-158">Default services in the previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in the new version are deleted.</span></span> <span data-ttu-id="a75fc-159">**Należy zwrócić uwagę, to usunięcie usług domyślnych nie można przywrócić.**</span><span class="sxs-lookup"><span data-stu-id="a75fc-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="a75fc-160">W przypadku uaktualniania zostanie wycofana, domyślne, które usługi są przywracane do stanu przed rozpoczęciem uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="a75fc-160">In case of an application upgrade is rolled back, default services are reverted to the status before upgrade started.</span></span> <span data-ttu-id="a75fc-161">Ale usługami usunięto nigdy nie mogą być tworzone.</span><span class="sxs-lookup"><span data-stu-id="a75fc-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="a75fc-162">Schemat blokowy uaktualniania aplikacji</span><span class="sxs-lookup"><span data-stu-id="a75fc-162">Application upgrade flowchart</span></span>
<span data-ttu-id="a75fc-163">Schemat blokowy dalej w tym temacie mogą pomóc zrozumieć proces uaktualniania aplikacji sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="a75fc-163">The flowchart following this paragraph can help you understand the upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="a75fc-164">W szczególności przepływ w tym artykule opisano sposób limity czasu, w tym *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, i *UpgradeHealthCheckInterval*, pomoc Formant podczas uaktualniania w domenie jedna aktualizacja jest uznawany za powodzenie lub niepowodzenie.</span><span class="sxs-lookup"><span data-stu-id="a75fc-164">In particular, the flow describes how the time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when the upgrade in one update domain is considered a success or a failure.</span></span>

![Proces uaktualniania dla aplikacji sieci szkieletowej usług][image]

## <a name="next-steps"></a><span data-ttu-id="a75fc-166">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="a75fc-166">Next steps</span></span>
<span data-ttu-id="a75fc-167">[Uaktualnianie aplikacji za pomocą Visual Studio](service-fabric-application-upgrade-tutorial.md) przeprowadzi Cię przez proces uaktualnienia aplikacji przy użyciu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a75fc-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="a75fc-168">[Uaktualnienie z aplikacji przy użyciu programu Powershell](service-fabric-application-upgrade-tutorial-powershell.md) przeprowadzi Cię przez proces uaktualnienia aplikacji przy użyciu programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a75fc-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="a75fc-169">Kontrolowanie sposobu uaktualnienia aplikacji przy użyciu [uaktualnienia parametrów](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="a75fc-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="a75fc-170">Uzyskania uaktualnień aplikacji zgodnych przez poznanie [szeregowanie danych](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="a75fc-170">Make your application upgrades compatible by learning how to use [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="a75fc-171">Dowiedz się, jak korzystać z zaawansowanych funkcji podczas uaktualniania aplikacji, odwołując się do [Tematy zaawansowane](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="a75fc-171">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="a75fc-172">Rozwiązywania typowych problemów w uaktualnień aplikacji, korzystając z procedury opisanej w [Rozwiązywanie problemów z uaktualnieniami aplikacji](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="a75fc-172">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
