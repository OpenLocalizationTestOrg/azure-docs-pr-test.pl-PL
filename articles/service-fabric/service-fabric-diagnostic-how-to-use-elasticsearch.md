---
title: "aaaUsing Elasticsearch jako magazyn śledzenia aplikacji sieci szkieletowej usług | Dokumentacja firmy Microsoft"
description: "Opisuje sposób wykorzystania aplikacji usługi Service Fabric toostore Elasticsearch i Kibana, indeksu i wyszukiwania za pomocą śladów aplikacji (Dzienniki)"
services: service-fabric
documentationcenter: .net
author: karolz-ms
manager: adegeo
editor: 
ms.assetid: e59b0c39-e468-4d9e-b453-d5f2a8ad20d8
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: karolz@microsoft.com
redirect_url: /azure/service-fabric/service-fabric-diagnostics-event-aggregation-eventflow
ms.openlocfilehash: b5977c54e69319e3caa376e44a02f971b66a3254
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="use-elasticsearch-as-a-service-fabric-application-trace-store"></a><span data-ttu-id="9c92b-103">Przechowywanie Elasticsearch używany jako śledzenia aplikacji sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="9c92b-103">Use Elasticsearch as a Service Fabric application trace store</span></span>
## <a name="introduction"></a><span data-ttu-id="9c92b-104">Wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="9c92b-104">Introduction</span></span>
<span data-ttu-id="9c92b-105">W tym artykule opisano sposób [sieć szkieletowa usług Azure](https://azure.microsoft.com/documentation/services/service-fabric/) aplikacje mogą używać **Elasticsearch** i **Kibana** dla magazynu śledzenia aplikacji, indeksowanie i wyszukiwanie.</span><span class="sxs-lookup"><span data-stu-id="9c92b-105">This article describes how [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) applications can use **Elasticsearch** and **Kibana** for application trace storage, indexing, and search.</span></span> <span data-ttu-id="9c92b-106">[Elasticsearch](https://www.elastic.co/guide/index.html) jest open source, rozproszone i skalowalne w czasie rzeczywistym wyszukiwania i analiza mechanizm, który dobrze nadaje się do tego zadania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is an open-source, distributed, and scalable real-time search and analytics engine that is well-suited for this task.</span></span> <span data-ttu-id="9c92b-107">Można go zainstalować na maszynach wirtualnych Windows i Linux, działają na platformie Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="9c92b-107">It can be installed on Windows and Linux virtual machines running in Microsoft Azure.</span></span> <span data-ttu-id="9c92b-108">Elasticsearch wydajnie może przetwarzać *strukturalnych* śladów utworzone przy użyciu technologii, takich jak **funkcji Śledzenie zdarzeń systemu Windows ()**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-108">Elasticsearch can efficiently process *structured* traces produced using technologies such as **Event Tracing for Windows (ETW)**.</span></span>

<span data-ttu-id="9c92b-109">ETW jest używany przez usługi sieć szkieletowa środowiska uruchomieniowego toosource informacje diagnostyczne (śladów).</span><span class="sxs-lookup"><span data-stu-id="9c92b-109">ETW is used by Service Fabric runtime toosource diagnostic information (traces).</span></span> <span data-ttu-id="9c92b-110">Jest to hello ich informacje diagnostyczne, metoda toosource aplikacji sieci szkieletowej usług są zalecane zbyt.</span><span class="sxs-lookup"><span data-stu-id="9c92b-110">It is hello recommended method for Service Fabric applications toosource their diagnostic information, too.</span></span> <span data-ttu-id="9c92b-111">Przy użyciu powitalne sam mechanizm umożliwia korelacji między dostarczone przez środowisko uruchomieniowe i aplikacja dostarczona śladów i sprawia, że rozwiązania problemu.</span><span class="sxs-lookup"><span data-stu-id="9c92b-111">Using hello same mechanism allows for correlation between runtime-supplied and application-supplied traces and makes troubleshooting easier.</span></span> <span data-ttu-id="9c92b-112">Interfejs API rejestrowania obejmują szablony projektów sieci szkieletowej usług w programie Visual Studio (oparte na powitania .NET **EventSource** klasy) który emituje śladów ETW. domyślnie.</span><span class="sxs-lookup"><span data-stu-id="9c92b-112">Service Fabric project templates in Visual Studio include a logging API (based on hello .NET **EventSource** class) that emits ETW traces by default.</span></span> <span data-ttu-id="9c92b-113">Ogólne omówienie aplikacji usługi Service Fabric śledzenia przy użyciu funkcji ETW, zobacz [monitorowania i diagnozowania usług w Instalatorze programowanie komputera lokalnego](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span><span class="sxs-lookup"><span data-stu-id="9c92b-113">For a general overview of Service Fabric application tracing using ETW, see [Monitoring and diagnosing services in a local machine development setup](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span></span>

<span data-ttu-id="9c92b-114">Witaj śladów tooshow się w Elasticsearch muszą one toobe zarejestrowane w węzłach klastra usługi sieć szkieletowa hello w czasie rzeczywistym (gdy jest uruchomiona aplikacja hello) i wysyłane do punktu końcowego Elasticsearch tooan.</span><span class="sxs-lookup"><span data-stu-id="9c92b-114">For hello traces tooshow up in Elasticsearch, they need toobe captured at hello Service Fabric cluster nodes in real time (while hello application is running) and sent tooan Elasticsearch endpoint.</span></span> <span data-ttu-id="9c92b-115">Dostępne są dwie główne opcje do przechwytywania śledzenia:</span><span class="sxs-lookup"><span data-stu-id="9c92b-115">There are two major options for trace capturing:</span></span>

* <span data-ttu-id="9c92b-116">**W procesie przechwytywania śledzenia**</span><span class="sxs-lookup"><span data-stu-id="9c92b-116">**In-process trace capturing**</span></span>  
  <span data-ttu-id="9c92b-117">Aplikacja Hello lub dokładnie procesu usługi, jest odpowiedzialny za wysyłanie hello danych diagnostycznych toohello śledzenia magazynu (Elasticsearch).</span><span class="sxs-lookup"><span data-stu-id="9c92b-117">hello application, or more precisely, service process, is responsible for sending out hello diagnostic data toohello trace store (Elasticsearch).</span></span>
* <span data-ttu-id="9c92b-118">**Przechwytywanie śledzenia poza procesem.**</span><span class="sxs-lookup"><span data-stu-id="9c92b-118">**Out-of-process trace capturing**</span></span>  
  <span data-ttu-id="9c92b-119">Oddzielnym agentem jest przechwytywanie śladów pochodzących z procesu usługi hello lub procesów i wysyłania ich toohello śledzenia magazynu.</span><span class="sxs-lookup"><span data-stu-id="9c92b-119">A separate agent is capturing traces from hello service process or processes and sending them toohello trace store.</span></span>

<span data-ttu-id="9c92b-120">Poniżej opisano sposób tooset się Elasticsearch na platformie Azure. omówiono w nim specjaliści hello i wad dla obu opcji przechwytywania i wyjaśniają, jak tooconfigure usługi sieć szkieletowa usług toosend tooElasticsearch danych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-120">Below, we describe how tooset up Elasticsearch on Azure, discuss hello pros and cons for both capture options, and explain how tooconfigure a Service Fabric service toosend data tooElasticsearch.</span></span>

## <a name="set-up-elasticsearch-on-azure"></a><span data-ttu-id="9c92b-121">Konfigurowanie Elasticsearch na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="9c92b-121">Set up Elasticsearch on Azure</span></span>
<span data-ttu-id="9c92b-122">Witaj najprostszy sposób tooset hello Elasticsearch usługi na platformie Azure jest za pośrednictwem [ **szablonów usługi Azure Resource Manager**](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9c92b-122">hello most straightforward way tooset up hello Elasticsearch service on Azure is through [**Azure Resource Manager templates**](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="9c92b-123">Zaawansowane [szablon szybkiego startu usługi Azure Resource Manager dla Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) jest dostępna z repozytorium szablonów Szybki Start Azure.</span><span class="sxs-lookup"><span data-stu-id="9c92b-123">A comprehensive [Quickstart Azure Resource Manager template for Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is available from Azure Quickstart templates repository.</span></span> <span data-ttu-id="9c92b-124">Ten szablon używa oddzielny magazyn kont dla jednostki skali (grupy węzłów).</span><span class="sxs-lookup"><span data-stu-id="9c92b-124">This template uses separate storage accounts for scale units (groups of nodes).</span></span> <span data-ttu-id="9c92b-125">Można również udostępniać, klienckim oddzielnie i węzły serwera z różnymi konfiguracjami oraz różne numery dyskach danych dołączonych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-125">It can also provision separate client and server nodes with different configurations and various numbers of data disks attached.</span></span>

<span data-ttu-id="9c92b-126">W tym miejscu korzystamy z innego szablonu, nazywane **ES MultiNode** z hello [repozytorium Azure narzędzia diagnostyczne](https://github.com/Azure/azure-diagnostics-tools).</span><span class="sxs-lookup"><span data-stu-id="9c92b-126">Here, we use another template, called **ES-MultiNode** from hello [Azure diagnostic tools repository](https://github.com/Azure/azure-diagnostics-tools).</span></span> <span data-ttu-id="9c92b-127">Ten szablon jest łatwiejsze toouse i tworzy klaster Elasticsearch zabezpieczone przy użyciu podstawowego uwierzytelniania HTTP.</span><span class="sxs-lookup"><span data-stu-id="9c92b-127">This template is easier toouse, and it creates an Elasticsearch cluster protected by HTTP basic authentication.</span></span> <span data-ttu-id="9c92b-128">Przed kontynuowaniem pobrać hello repozytorium GitHub tooyour maszyny (przez klonowanie repozytorium hello lub pobieranie pliku zip).</span><span class="sxs-lookup"><span data-stu-id="9c92b-128">Before you proceed, download hello repository from GitHub tooyour machine (by either cloning hello repository or downloading a zip file).</span></span> <span data-ttu-id="9c92b-129">Szablon Hello ES MultiNode znajduje się w folderze hello z hello tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="9c92b-129">hello ES-MultiNode template is located in hello folder with hello same name.</span></span>

### <a name="prepare-a-machine-toorun-elasticsearch-installation-scripts"></a><span data-ttu-id="9c92b-130">Przygotowanie toorun maszyny Elasticsearch skrypty instalacyjne</span><span class="sxs-lookup"><span data-stu-id="9c92b-130">Prepare a machine toorun Elasticsearch installation scripts</span></span>
<span data-ttu-id="9c92b-131">Witaj Najprostszym sposobem toouse hello ES MultiNode szablonu jest za pośrednictwem dostarczonego skryptu programu PowerShell systemu Azure o nazwie `CreateElasticSearchCluster`.</span><span class="sxs-lookup"><span data-stu-id="9c92b-131">hello easiest way toouse hello ES-MultiNode template is through a provided Azure PowerShell script called `CreateElasticSearchCluster`.</span></span> <span data-ttu-id="9c92b-132">toouse ten skrypt należy tooinstall moduły programu PowerShell i narzędzie **openssl**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-132">toouse this script, you need tooinstall PowerShell modules and a tool called **openssl**.</span></span> <span data-ttu-id="9c92b-133">ostatnie Hello jest niezbędny do utworzenia klastra Elasticsearch kluczem SSH, które mogą być używane tooadminister zdalnie.</span><span class="sxs-lookup"><span data-stu-id="9c92b-133">hello latter is needed for creating an SSH key that can be used tooadminister your Elasticsearch cluster remotely.</span></span>

<span data-ttu-id="9c92b-134">`CreateElasticSearchCluster`skrypt jest przeznaczona dla łatwość użycia z szablonem hello ES MultiNode z komputera z systemem Windows.</span><span class="sxs-lookup"><span data-stu-id="9c92b-134">`CreateElasticSearchCluster` script is designed for ease of use with hello ES-MultiNode template from a Windows machine.</span></span> <span data-ttu-id="9c92b-135">Jest to możliwe toouse hello szablon na komputerze z systemem innym niż Windows, ale w tym scenariuszu wykracza poza zakres tego artykułu hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-135">It is possible toouse hello template on a non-Windows machine, but that scenario is beyond hello scope of this article.</span></span>

1. <span data-ttu-id="9c92b-136">Jeśli ich nie zainstalowano już, zainstaluj [ **modułów programu Azure PowerShell**](http://aka.ms/webpi-azps).</span><span class="sxs-lookup"><span data-stu-id="9c92b-136">If you haven't installed them already, install [**Azure PowerShell modules**](http://aka.ms/webpi-azps).</span></span> <span data-ttu-id="9c92b-137">Po wyświetleniu monitu kliknij przycisk **Uruchom**, następnie **zainstalować**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-137">When prompted, click **Run**, then **Install**.</span></span> <span data-ttu-id="9c92b-138">Program Azure PowerShell 1.3 lub nowszy jest wymagany.</span><span class="sxs-lookup"><span data-stu-id="9c92b-138">Azure PowerShell 1.3 or newer is required.</span></span>
2. <span data-ttu-id="9c92b-139">Witaj **openssl** narzędzie jest dostępne w dystrybucji hello [ **Git dla systemu Windows**](http://www.git-scm.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="9c92b-139">hello **openssl** tool is included in hello distribution of [**Git for Windows**](http://www.git-scm.com/downloads).</span></span> <span data-ttu-id="9c92b-140">Jeśli jeszcze tego nie zrobiono, zainstaluj [Git dla systemu Windows](http://www.git-scm.com/downloads) teraz.</span><span class="sxs-lookup"><span data-stu-id="9c92b-140">If you have not done so already, install [Git for Windows](http://www.git-scm.com/downloads) now.</span></span> <span data-ttu-id="9c92b-141">(opcje instalacji domyślna hello są OK).</span><span class="sxs-lookup"><span data-stu-id="9c92b-141">(hello default installation options are OK.)</span></span>
3. <span data-ttu-id="9c92b-142">Przy założeniu, że Git został zainstalowany, ale nie jest uwzględniony w ścieżce systemowej hello, Otwórz okno programu Microsoft Azure PowerShell i uruchom następujące polecenia hello:</span><span class="sxs-lookup"><span data-stu-id="9c92b-142">Assuming that Git has been installed but not included in hello system path, open a Microsoft Azure PowerShell window and run hello following commands:</span></span>
   
    ```powershell
    $ENV:PATH += ";<Git installation folder>\usr\bin"
    $ENV:OPENSSL_CONF = "<Git installation folder>\usr\ssl\openssl.cnf"
    ```
   
    <span data-ttu-id="9c92b-143">Zastąp hello `<Git installation folder>` z lokalizacji Git hello na tym komputerze; domyślnie hello jest **"C:\Program Files\Git"**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-143">Replace hello `<Git installation folder>` with hello Git location on your machine; hello default is **"C:\Program Files\Git"**.</span></span> <span data-ttu-id="9c92b-144">Należy zwrócić uwagę średnika hello na początku hello hello pierwszy ścieżki.</span><span class="sxs-lookup"><span data-stu-id="9c92b-144">Note hello semicolon character at hello beginning of hello first path.</span></span>
4. <span data-ttu-id="9c92b-145">Upewnij się, że użytkownik jest zalogowany tooAzure (za pośrednictwem [ `Add-AzureRmAccount` ](https://msdn.microsoft.com/library/mt619267.aspx) polecenia cmdlet) i wybrano hello subskrypcji, która powinna być używana toocreate klastra elastycznej wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-145">Ensure that you are logged on tooAzure (via [`Add-AzureRmAccount`](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) and that you have selected hello subscription that should be used toocreate your Elastic Search cluster.</span></span> <span data-ttu-id="9c92b-146">Można sprawdzić, czy wybrano poprawną subskrypcję za pomocą `Get-AzureRmContext` i `Get-AzureRmSubscription` polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="9c92b-146">You can verify that correct subscription is selected using `Get-AzureRmContext` and `Get-AzureRmSubscription` cmdlets.</span></span>
5. <span data-ttu-id="9c92b-147">Jeśli jeszcze tego nie zrobiono tego wcześniej, zmień bieżący folder katalogu toohello ES MultiNode hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-147">If you haven't done so already, change hello current directory toohello ES-MultiNode folder.</span></span>

### <a name="run-hello-createelasticsearchcluster-script"></a><span data-ttu-id="9c92b-148">Uruchom skrypt CreateElasticSearchCluster hello</span><span class="sxs-lookup"><span data-stu-id="9c92b-148">Run hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="9c92b-149">Przed uruchomieniem skryptu hello Otwórz hello `azuredeploy-parameters.json` pliku Sprawdź i podaj wartości parametrów skryptu hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-149">Before you run hello script, open hello `azuredeploy-parameters.json` file and verify or provide values for hello script parameters.</span></span> <span data-ttu-id="9c92b-150">dostępne są następujące parametry Hello:</span><span class="sxs-lookup"><span data-stu-id="9c92b-150">hello following parameters are provided:</span></span>

| <span data-ttu-id="9c92b-151">Nazwa parametru</span><span class="sxs-lookup"><span data-stu-id="9c92b-151">Parameter Name</span></span> | <span data-ttu-id="9c92b-152">Opis</span><span class="sxs-lookup"><span data-stu-id="9c92b-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="9c92b-153">dnsNameForLoadBalancerIP</span><span class="sxs-lookup"><span data-stu-id="9c92b-153">dnsNameForLoadBalancerIP</span></span> |<span data-ttu-id="9c92b-154">Nazwa Hello jest używane toocreate hello widocznego publicznie nazwy DNS dla klastra elastycznej wyszukiwania hello (przez dodanie hello regionu Azure domeny toohello podane nazwy).</span><span class="sxs-lookup"><span data-stu-id="9c92b-154">hello name that is used toocreate hello publicly visible DNS name for hello Elastic Search cluster (by appending hello Azure region domain toohello provided name).</span></span> <span data-ttu-id="9c92b-155">Na przykład jeśli wartość tego parametru jest "myBigCluster" hello wybrany region platformy Azure to zachodnie stany USA, hello wynikowej nazwy DNS dla klastra hello jest myBigCluster.westus.cloudapp.azure.com.</span><span class="sxs-lookup"><span data-stu-id="9c92b-155">For example, if this parameter value is "myBigCluster" and hello chosen Azure region is West US, hello resulting DNS name for hello cluster is myBigCluster.westus.cloudapp.azure.com.</span></span> <br /><br /><span data-ttu-id="9c92b-156">Ta nazwa służy również jako nazwa główna dla wielu artefakty skojarzone z klastrem elastycznej wyszukiwania hello, takich jak nazwy węzła danych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-156">This name also serves as a root name for many artifacts associated with hello Elastic Search cluster, such as data node names.</span></span> |
| <span data-ttu-id="9c92b-157">adminUsername</span><span class="sxs-lookup"><span data-stu-id="9c92b-157">adminUsername</span></span> |<span data-ttu-id="9c92b-158">nazwę Hello konta administratora hello Zarządzanie klastrem elastycznej wyszukiwania hello (odpowiadające im klucze SSH wygenerowaniu automatycznie).</span><span class="sxs-lookup"><span data-stu-id="9c92b-158">hello name of hello administrator account for managing hello Elastic Search cluster (corresponding SSH keys are generated automatically).</span></span> |
| <span data-ttu-id="9c92b-159">dataNodeCount</span><span class="sxs-lookup"><span data-stu-id="9c92b-159">dataNodeCount</span></span> |<span data-ttu-id="9c92b-160">Hello liczba węzłów w klastrze elastycznej wyszukiwania hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-160">hello number of nodes in hello Elastic Search cluster.</span></span> <span data-ttu-id="9c92b-161">Bieżąca wersja Hello hello skryptu nie rozróżnia między węzłami danych i zapytania. wszystkie węzły odtworzyć obie role.</span><span class="sxs-lookup"><span data-stu-id="9c92b-161">hello current version of hello script does not distinguish between data and query nodes; all nodes play both roles.</span></span> <span data-ttu-id="9c92b-162">Węzły too3 wartości domyślnych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-162">Defaults too3 nodes.</span></span> |
| <span data-ttu-id="9c92b-163">dataDiskSize</span><span class="sxs-lookup"><span data-stu-id="9c92b-163">dataDiskSize</span></span> |<span data-ttu-id="9c92b-164">rozmiar Hello dysków danych (w GB) przypisany do każdego węzła danych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-164">hello size of data disks (in GB) that is allocated for each data node.</span></span> <span data-ttu-id="9c92b-165">Każdy węzeł odbiera 4 dyski danych wyłącznie dedykowanych tooElastic usługi wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-165">Each node receives 4 data disks, exclusively dedicated tooElastic Search service.</span></span> |
| <span data-ttu-id="9c92b-166">Region</span><span class="sxs-lookup"><span data-stu-id="9c92b-166">region</span></span> |<span data-ttu-id="9c92b-167">Nazwa Hello region platformy Azure, gdzie powinien być zlokalizowany hello elastycznej wyszukiwania klastra.</span><span class="sxs-lookup"><span data-stu-id="9c92b-167">hello name of Azure region where hello Elastic Search cluster should be located.</span></span> |
| <span data-ttu-id="9c92b-168">esUserName</span><span class="sxs-lookup"><span data-stu-id="9c92b-168">esUserName</span></span> |<span data-ttu-id="9c92b-169">Witaj nazwa użytkownika hello użytkownika, która jest skonfigurowana toohave dostępu tooES klastra (podmiotu tooHTTP uwierzytelniania podstawowego).</span><span class="sxs-lookup"><span data-stu-id="9c92b-169">hello user name of hello user that is configured toohave access tooES cluster (subject tooHTTP basic authentication).</span></span> <span data-ttu-id="9c92b-170">Witaj hasło nie jest częścią pliku parametrów i należy podać podczas `CreateElasticSearchCluster` skrypt zostanie wywołany.</span><span class="sxs-lookup"><span data-stu-id="9c92b-170">hello password is not part of parameters file and must be provided when `CreateElasticSearchCluster` script is invoked.</span></span> |
| <span data-ttu-id="9c92b-171">vmSizeDataNodes</span><span class="sxs-lookup"><span data-stu-id="9c92b-171">vmSizeDataNodes</span></span> |<span data-ttu-id="9c92b-172">Witaj rozmiar maszyny wirtualnej platformy Azure dla węzłów klastra elastycznej wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-172">hello Azure virtual machine size for Elastic Search cluster nodes.</span></span> <span data-ttu-id="9c92b-173">TooStandard_D2 wartości domyślnych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-173">Defaults tooStandard_D2.</span></span> |

<span data-ttu-id="9c92b-174">Teraz wszystko jest gotowe toorun hello skryptu.</span><span class="sxs-lookup"><span data-stu-id="9c92b-174">Now you are ready toorun hello script.</span></span> <span data-ttu-id="9c92b-175">Problem hello następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="9c92b-175">Issue hello following command:</span></span>

```powershell
CreateElasticSearchCluster -ResourceGroupName <es-group-name> -Region <azure-region> -EsPassword <es-password>
```

<span data-ttu-id="9c92b-176">gdzie</span><span class="sxs-lookup"><span data-stu-id="9c92b-176">where</span></span> 

| <span data-ttu-id="9c92b-177">Nazwa parametru skryptu</span><span class="sxs-lookup"><span data-stu-id="9c92b-177">Script Parameter Name</span></span> | <span data-ttu-id="9c92b-178">Opis</span><span class="sxs-lookup"><span data-stu-id="9c92b-178">Description</span></span> |
| --- | --- |
| `<es-group-name>` |<span data-ttu-id="9c92b-179">Nazwa Hello hello grupy zasobów platformy Azure, która będzie zawierać wszystkich zasobów klastra elastycznej wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-179">hello name of hello Azure resource group that will contain all Elastic Search cluster resources.</span></span> |
| `<azure-region>` |<span data-ttu-id="9c92b-180">Nazwa Hello hello region platformy Azure, w którym ma zostać utworzony hello elastycznej wyszukiwania klastra.</span><span class="sxs-lookup"><span data-stu-id="9c92b-180">hello name of hello Azure region where hello Elastic Search cluster should be created.</span></span> |
| `<es-password>` |<span data-ttu-id="9c92b-181">hasło Hello hello elastycznej wyszukiwania użytkownika.</span><span class="sxs-lookup"><span data-stu-id="9c92b-181">hello password for hello Elastic Search user.</span></span> |

> [!NOTE]
> <span data-ttu-id="9c92b-182">Jeśli otrzymasz NullReferenceException z polecenia cmdlet Test-AzureResourceGroup hello pamiętasz toolog na tooAzure (`Add-AzureRmAccount`).</span><span class="sxs-lookup"><span data-stu-id="9c92b-182">If you get a NullReferenceException from hello Test-AzureResourceGroup cmdlet, you have forgotten toolog on tooAzure (`Add-AzureRmAccount`).</span></span>
> 
> 

<span data-ttu-id="9c92b-183">Jeśli wystąpi błąd uruchamiania skryptu hello i określeniu błąd hello spowodowane przez wartość parametru szablonu niewłaściwy, popraw hello parametru plik i ponownie uruchomić skrypt hello nazwę grupy zasobów w innej.</span><span class="sxs-lookup"><span data-stu-id="9c92b-183">If you get an error from running hello script and you determine that hello error was caused by a wrong template parameter value, correct hello parameter file and run hello script again with a different resource group name.</span></span> <span data-ttu-id="9c92b-184">Można również wykorzystać hello tej samej nazwy grupy zasobów i mieć skryptu hello oczyszczania hello stary przez dodanie hello `-RemoveExistingResourceGroup` wywołanie skryptu toohello parametru.</span><span class="sxs-lookup"><span data-stu-id="9c92b-184">You can also reuse hello same resource group name and have hello script clean up hello old one by adding hello `-RemoveExistingResourceGroup` parameter toohello script invocation.</span></span>

### <a name="result-of-running-hello-createelasticsearchcluster-script"></a><span data-ttu-id="9c92b-185">Wynik uruchomienia skryptu CreateElasticSearchCluster hello</span><span class="sxs-lookup"><span data-stu-id="9c92b-185">Result of running hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="9c92b-186">Po uruchomieniu hello `CreateElasticSearchCluster` skryptu hello następujące główne artefakty zostanie utworzony.</span><span class="sxs-lookup"><span data-stu-id="9c92b-186">After you run hello `CreateElasticSearchCluster` script, hello following main artifacts will be created.</span></span> <span data-ttu-id="9c92b-187">W tym przykładzie przyjęto założenie, czy użyto "myBigCluster" jako wartości hello hello `dnsNameForLoadBalancerIP` parametr i hello regionu, w którym utworzono klaster hello jest zachodnie stany USA.</span><span class="sxs-lookup"><span data-stu-id="9c92b-187">For this example we assume that you have used "myBigCluster" as hello value of hello `dnsNameForLoadBalancerIP` parameter and that hello region where you created hello cluster is West US.</span></span>

| <span data-ttu-id="9c92b-188">Artefaktów</span><span class="sxs-lookup"><span data-stu-id="9c92b-188">Artifact</span></span> | <span data-ttu-id="9c92b-189">Nazwa, lokalizacja i uwagi</span><span class="sxs-lookup"><span data-stu-id="9c92b-189">Name, location, and remarks</span></span> |
| --- | --- |
| <span data-ttu-id="9c92b-190">Klucz SSH dla administracji zdalnej</span><span class="sxs-lookup"><span data-stu-id="9c92b-190">SSH key for remote administration</span></span> |<span data-ttu-id="9c92b-191">Plik myBigCluster.key (w katalogu hello, z których hello CreateElasticSearchCluster zostało uruchomione).</span><span class="sxs-lookup"><span data-stu-id="9c92b-191">myBigCluster.key file (in hello directory from which hello CreateElasticSearchCluster was run).</span></span> <br /><br /><span data-ttu-id="9c92b-192">Ten plik klucza może być używane tooconnect toohello admin węzła (za pośrednictwem węzła admin hello) toodata węzłów w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-192">This key file can be used tooconnect toohello admin node and (through hello admin node) toodata nodes in hello cluster.</span></span> |
| <span data-ttu-id="9c92b-193">Węzeł administratora</span><span class="sxs-lookup"><span data-stu-id="9c92b-193">Admin node</span></span> |<span data-ttu-id="9c92b-194">myBigCluster admin.westus.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="9c92b-194">myBigCluster-admin.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="9c92b-195">Dedykowane maszyny Wirtualnej dla zdalnego administrowania klastrami Elasticsearch — Witaj tylko jeden, który zezwala na zewnętrzne połączenia SSH.</span><span class="sxs-lookup"><span data-stu-id="9c92b-195">A dedicated VM for remote Elasticsearch cluster administration--hello only one that allows external SSH connections.</span></span> <span data-ttu-id="9c92b-196">Jest uruchamiany na powitania tej samej sieci wirtualnej jako wszystkie węzły klastra Elasticsearch hello, ale nie nie uruchomienia wszystkie usługi Elasticsearch.</span><span class="sxs-lookup"><span data-stu-id="9c92b-196">It runs on hello same virtual network as all hello Elasticsearch cluster nodes, but it does not run any Elasticsearch services.</span></span> |
| <span data-ttu-id="9c92b-197">Węzły danych</span><span class="sxs-lookup"><span data-stu-id="9c92b-197">Data nodes</span></span> |<span data-ttu-id="9c92b-198">myBigCluster1...</span><span class="sxs-lookup"><span data-stu-id="9c92b-198">myBigCluster1 …</span></span> <span data-ttu-id="9c92b-199">myBigCluster*N*</span><span class="sxs-lookup"><span data-stu-id="9c92b-199">myBigCluster*N*</span></span> <br /><br /><span data-ttu-id="9c92b-200">Węzły danych, które są uruchomione usługi Elasticsearch i Kibana.</span><span class="sxs-lookup"><span data-stu-id="9c92b-200">Data nodes that are running Elasticsearch and Kibana services.</span></span> <span data-ttu-id="9c92b-201">Możesz połączyć za pomocą węzła tooeach SSH, ale tylko za pośrednictwem hello admin węzła.</span><span class="sxs-lookup"><span data-stu-id="9c92b-201">You can connect via SSH tooeach node, but only via hello admin node.</span></span> |
| <span data-ttu-id="9c92b-202">Elasticsearch klastra</span><span class="sxs-lookup"><span data-stu-id="9c92b-202">Elasticsearch cluster</span></span> |<span data-ttu-id="9c92b-203">http://myBigCluster.westus.cloudapp.Azure.com/ES/</span><span class="sxs-lookup"><span data-stu-id="9c92b-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span></span> <br /><br /><span data-ttu-id="9c92b-204">Hello podstawowy punkt końcowy dla klastra Elasticsearch hello (Uwaga hello /es sufiks).</span><span class="sxs-lookup"><span data-stu-id="9c92b-204">hello primary endpoint for hello Elasticsearch cluster (note hello /es suffix).</span></span> <span data-ttu-id="9c92b-205">Plik jest chroniony przez podstawowego uwierzytelniania HTTP (hello poświadczenia zostały hello określone parametry esUserName/esPassword hello ES MultiNode szablonu).</span><span class="sxs-lookup"><span data-stu-id="9c92b-205">It is protected by basic HTTP authentication (hello credentials were hello specified esUserName/esPassword parameters of hello ES-MultiNode template).</span></span> <span data-ttu-id="9c92b-206">klaster Hello ma również hello head wtyczki zainstalowane (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) dla administracji podstawowy klaster.</span><span class="sxs-lookup"><span data-stu-id="9c92b-206">hello cluster has also hello head plug-in installed (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) for basic cluster administration.</span></span> |
| <span data-ttu-id="9c92b-207">Usługa Kibana</span><span class="sxs-lookup"><span data-stu-id="9c92b-207">Kibana service</span></span> |<span data-ttu-id="9c92b-208">http://myBigCluster.westus.cloudapp.Azure.com</span><span class="sxs-lookup"><span data-stu-id="9c92b-208">http://myBigCluster.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="9c92b-209">Witaj Kibana usługi skonfigurowano tooshow danych z hello utworzony Elasticsearch klastra.</span><span class="sxs-lookup"><span data-stu-id="9c92b-209">hello Kibana service is set up tooshow data from hello created Elasticsearch cluster.</span></span> <span data-ttu-id="9c92b-210">Plik jest chroniony przez hello tych samych poświadczeń uwierzytelniania jako hello klastra samej siebie.</span><span class="sxs-lookup"><span data-stu-id="9c92b-210">It is protected by hello same authentication credentials as hello cluster itself.</span></span> |

## <a name="in-process-versus-out-of-process-trace-capturing"></a><span data-ttu-id="9c92b-211">W trakcie i przechwytywanie śledzenia poza procesem.</span><span class="sxs-lookup"><span data-stu-id="9c92b-211">In-process versus out-of-process trace capturing</span></span>
<span data-ttu-id="9c92b-212">Wprowadzeniu hello wspomniano dwa podstawowe sposoby zbierania danych diagnostycznych: w trakcie i poza procesem.</span><span class="sxs-lookup"><span data-stu-id="9c92b-212">In hello introduction, we mentioned two fundamental ways of collecting diagnostic data: in-process and out-of-process.</span></span> <span data-ttu-id="9c92b-213">Każdy ma mocne i słabe strony.</span><span class="sxs-lookup"><span data-stu-id="9c92b-213">Each has strengths and weaknesses.</span></span>

<span data-ttu-id="9c92b-214">Zalety hello **w procesie przechwytywania śledzenia** obejmują:</span><span class="sxs-lookup"><span data-stu-id="9c92b-214">Advantages of hello **in-process trace capturing** include:</span></span>

1. <span data-ttu-id="9c92b-215">*Łatwe konfigurowanie i wdrażanie*</span><span class="sxs-lookup"><span data-stu-id="9c92b-215">*Easy configuration and deployment*</span></span>
   
   * <span data-ttu-id="9c92b-216">Konfiguracja Hello zbierania danych diagnostycznych jest tylko część konfiguracji aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-216">hello configuration of diagnostic data collection is just part of hello application configuration.</span></span> <span data-ttu-id="9c92b-217">Należy zachować łatwe tooalways go "zsynchronizowane" z hello pozostałej części aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-217">It is easy tooalways keep it "in sync" with hello rest of hello application.</span></span>
   * <span data-ttu-id="9c92b-218">Dla każdej aplikacji lub na usługi konfiguracji jest łatwo osiągalny.</span><span class="sxs-lookup"><span data-stu-id="9c92b-218">Per-application or per-service configuration is easily achievable.</span></span>
   * <span data-ttu-id="9c92b-219">Zazwyczaj przechwytywania śledzenia poza procesem wymaga oddzielnego wdrażania i konfiguracji agenta diagnostyki hello, zadanie bardzo administracyjne i potencjalne źródła błędów.</span><span class="sxs-lookup"><span data-stu-id="9c92b-219">Out-of-process trace capturing usually requires a separate deployment and configuration of hello diagnostic agent, which is an extra administrative task and a potential source of errors.</span></span> <span data-ttu-id="9c92b-220">Technologia określonego agenta Hello często umożliwia tylko jedno wystąpienie agenta hello na maszynę wirtualną (węzeł).</span><span class="sxs-lookup"><span data-stu-id="9c92b-220">hello particular agent technology often allows only one instance of hello agent per virtual machine (node).</span></span> <span data-ttu-id="9c92b-221">Oznacza to tej konfiguracji dla kolekcji hello konfiguracji diagnostycznych hello jest współdzielona przez wszystkie aplikacje i usługi działające na tym węźle.</span><span class="sxs-lookup"><span data-stu-id="9c92b-221">This means that configuration for hello collection of hello diagnostic configuration is shared among all applications and services running on that node.</span></span>
2. <span data-ttu-id="9c92b-222">*Elastyczność*</span><span class="sxs-lookup"><span data-stu-id="9c92b-222">*Flexibility*</span></span>
   
   * <span data-ttu-id="9c92b-223">Aplikacja Hello może wysyłać dane hello wszędzie tam, gdzie musi toogo, tak długo, jak istnieje biblioteki klienckiej, która obsługuje system przechowywania danych hello docelowe.</span><span class="sxs-lookup"><span data-stu-id="9c92b-223">hello application can send hello data wherever it needs toogo, as long as there is a client library that supports hello targeted data storage system.</span></span> <span data-ttu-id="9c92b-224">Można dodać nowego wychwytywanie pożądane.</span><span class="sxs-lookup"><span data-stu-id="9c92b-224">New sinks can be added as desired.</span></span>
   * <span data-ttu-id="9c92b-225">Złożone zasady przechwytywania, filtrowania i agregacja danych może być zaimplementowany.</span><span class="sxs-lookup"><span data-stu-id="9c92b-225">Complex capture, filtering, and data-aggregation rules can be implemented.</span></span>
   * <span data-ttu-id="9c92b-226">Przechwytywanie śledzenia poza procesem często jest ograniczona przez hello sink danych, które hello obsługuje agenta.</span><span class="sxs-lookup"><span data-stu-id="9c92b-226">An out-of-process trace capturing is often limited by hello data sinks that hello agent supports.</span></span> <span data-ttu-id="9c92b-227">Niektóre agenci są rozszerzalne.</span><span class="sxs-lookup"><span data-stu-id="9c92b-227">Some agents are extensible.</span></span>
3. <span data-ttu-id="9c92b-228">*Uzyskiwanie dostępu do danych aplikacji toointernal i kontekstu*</span><span class="sxs-lookup"><span data-stu-id="9c92b-228">*Access toointernal application data and context*</span></span>
   
   * <span data-ttu-id="9c92b-229">Podsystem diagnostycznych Hello uruchomiony proces aplikacji/usługi hello można łatwo rozszerzyć hello śladów z informacje kontekstowe.</span><span class="sxs-lookup"><span data-stu-id="9c92b-229">hello diagnostic subsystem running inside hello application/service process can easily augment hello traces with contextual information.</span></span>
   * <span data-ttu-id="9c92b-230">W podejściu poza procesem hello hello dane należy wysłać tooan agenta za pomocą mechanizmu komunikacji międzyprocesowej takich jak zdarzenia śledzenia systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="9c92b-230">In hello out-of-process approach, hello data must be sent tooan agent via some inter-process communication mechanism, such as Event Tracing for Windows.</span></span> <span data-ttu-id="9c92b-231">Ten mechanizm można skonfigurować dodatkowe ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="9c92b-231">This mechanism could impose additional limitations.</span></span>

<span data-ttu-id="9c92b-232">Zalety hello **przechwytywania śledzenia poza procesem** obejmują:</span><span class="sxs-lookup"><span data-stu-id="9c92b-232">Advantages of hello **out-of-process trace capturing** include:</span></span>

1. <span data-ttu-id="9c92b-233">*Witaj możliwości toomonitor hello aplikacji i zbieranie zrzutów awaryjnych*</span><span class="sxs-lookup"><span data-stu-id="9c92b-233">*hello ability toomonitor hello application and collect crash dumps*</span></span>
   
   * <span data-ttu-id="9c92b-234">W trakcie śledzenia przechwytywania może się nie powieść, jeśli aplikacja hello nie powiedzie się toostart lub ulegnie awarii.</span><span class="sxs-lookup"><span data-stu-id="9c92b-234">In-process trace capturing may be unsuccessful if hello application fails toostart or crashes.</span></span> <span data-ttu-id="9c92b-235">Niezależnego agenta ma znacznie zwiększa prawdopodobieństwo Przechwytywanie istotne informacje dotyczące rozwiązywania problemów.</span><span class="sxs-lookup"><span data-stu-id="9c92b-235">An independent agent has a much better chance of capturing crucial troubleshooting information.</span></span><br /><br />
2. <span data-ttu-id="9c92b-236">*Dojrzałości, niezawodności i wydajności sprawdzonych*</span><span class="sxs-lookup"><span data-stu-id="9c92b-236">*Maturity, robustness, and proven performance*</span></span>
   
   * <span data-ttu-id="9c92b-237">Agent opracowane przez dostawcę platformy (na przykład agent programu Microsoft Azure Diagnostics) została toorigorous temat testowania i ograniczania funkcjonalności bitwy.</span><span class="sxs-lookup"><span data-stu-id="9c92b-237">An agent developed by a platform vendor (such as a Microsoft Azure Diagnostics agent) has been subject toorigorous testing and battle-hardening.</span></span>
   * <span data-ttu-id="9c92b-238">Z śledzenia w procesie przechwytywania należy uważać tooensure wysyłanie danych diagnostycznych z procesu aplikacji hello działania nie zakłócać aplikacji hello głównych zadań lub doprowadzić do problemów chronometrażu lub wydajności.</span><span class="sxs-lookup"><span data-stu-id="9c92b-238">With in-process trace capturing, care must be taken tooensure that hello activity of sending diagnostic data from an application process does not interfere with hello application's main tasks or introduce timing or performance problems.</span></span> <span data-ttu-id="9c92b-239">Niezależnie uruchomiony agent jest mniej podatne problemów toothese i specjalnie zaprojektowanego toolimit jego wpływ na hello system.</span><span class="sxs-lookup"><span data-stu-id="9c92b-239">An independently running agent is less prone toothese issues and is specifically designed toolimit its impact on hello system.</span></span>

<span data-ttu-id="9c92b-240">Jest to możliwe toocombine i korzystać z obu podejść.</span><span class="sxs-lookup"><span data-stu-id="9c92b-240">It is possible toocombine and benefit from both approaches.</span></span> <span data-ttu-id="9c92b-241">W rzeczywistości może być hello najlepsze rozwiązanie dla wielu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="9c92b-241">Indeed, it might be hello best solution for many applications.</span></span>

<span data-ttu-id="9c92b-242">W tym miejscu użyjemy hello **biblioteki Microsoft.Diagnostic.Listeners** i śledzenia w trakcie hello przechwytywanie danych toosend z klastra Elasticsearch tooan aplikacji sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="9c92b-242">Here, we use hello **Microsoft.Diagnostic.Listeners library** and hello in-process trace capturing toosend data from a Service Fabric application tooan Elasticsearch cluster.</span></span>

## <a name="use-hello-listeners-library-toosend-diagnostic-data-tooelasticsearch"></a><span data-ttu-id="9c92b-243">Użyj hello odbiorników biblioteki toosend danych diagnostycznych tooElasticsearch</span><span class="sxs-lookup"><span data-stu-id="9c92b-243">Use hello Listeners library toosend diagnostic data tooElasticsearch</span></span>
<span data-ttu-id="9c92b-244">Biblioteka Microsoft.Diagnostic.Listeners Hello jest częścią PartyCluster przykładowej aplikacji sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="9c92b-244">hello Microsoft.Diagnostic.Listeners library is part of PartyCluster sample Service Fabric application.</span></span> <span data-ttu-id="9c92b-245">toouse go:</span><span class="sxs-lookup"><span data-stu-id="9c92b-245">toouse it:</span></span>

1. <span data-ttu-id="9c92b-246">Pobierz [próbki PartyCluster hello](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) z usługi GitHub.</span><span class="sxs-lookup"><span data-stu-id="9c92b-246">Download [hello PartyCluster sample](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) from GitHub.</span></span>
2. <span data-ttu-id="9c92b-247">Skopiuj hello Microsoft.Diagnostics.Listeners i Microsoft.Diagnostics.Listeners.Fabric projektów (całe foldery) z hello PartyCluster próbki toohello rozwiązania folder katalogu aplikacji hello, która ma toosend hello danych tooElasticsearch .</span><span class="sxs-lookup"><span data-stu-id="9c92b-247">Copy hello Microsoft.Diagnostics.Listeners and Microsoft.Diagnostics.Listeners.Fabric projects (whole folders) from hello PartyCluster sample directory toohello solution folder of hello application that is supposed toosend hello data tooElasticsearch.</span></span>
3. <span data-ttu-id="9c92b-248">Otwórz rozwiązanie docelowy hello, kliknij prawym przyciskiem myszy węzeł rozwiązania hello w hello Eksploratora rozwiązań i wybierz **Dodaj istniejący projekt**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-248">Open hello target solution, right-click hello solution node in hello Solution Explorer, and choose **Add Existing Project**.</span></span> <span data-ttu-id="9c92b-249">Dodaj hello Microsoft.Diagnostics.Listeners projektu toohello rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="9c92b-249">Add hello Microsoft.Diagnostics.Listeners project toohello solution.</span></span> <span data-ttu-id="9c92b-250">Powtórz hello takie same dla hello Microsoft.Diagnostics.Listeners.Fabric projektu.</span><span class="sxs-lookup"><span data-stu-id="9c92b-250">Repeat hello same for hello Microsoft.Diagnostics.Listeners.Fabric project.</span></span>
4. <span data-ttu-id="9c92b-251">Dodaj odwołanie do projektu z usługi projekty toohello dwóch dodano projektów.</span><span class="sxs-lookup"><span data-stu-id="9c92b-251">Add a project reference from your service project(s) toohello two added projects.</span></span> <span data-ttu-id="9c92b-252">(Każda usługa, która ma toosend tooElasticsearch danych powinien odwoływać się Microsoft.Diagnostics.EventListeners i Microsoft.Diagnostics.EventListeners.Fabric).</span><span class="sxs-lookup"><span data-stu-id="9c92b-252">(Each service that is supposed toosend data tooElasticsearch should reference Microsoft.Diagnostics.EventListeners and Microsoft.Diagnostics.EventListeners.Fabric).</span></span>
   
    ![Projekt zawiera odwołania do tooMicrosoft.Diagnostics.EventListeners i bibliotek Microsoft.Diagnostics.EventListeners.Fabric][1]

### <a name="service-fabric-general-availability-release-and-microsoftdiagnosticstracing-nuget-package"></a><span data-ttu-id="9c92b-254">Wersja usługi sieć szkieletowa ogólnej dostępności i pakiet Microsoft.Diagnostics.Tracing Nuget</span><span class="sxs-lookup"><span data-stu-id="9c92b-254">Service Fabric General Availability release and Microsoft.Diagnostics.Tracing Nuget package</span></span>
<span data-ttu-id="9c92b-255">Aplikacji skompilowanej za pomocą wersji dostępności usługi sieć szkieletowa ogólne (2.0.135 wydane 31 marca 2016) docelowej **.NET Framework 4.5.2**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-255">Applications built with Service Fabric General Availability release (2.0.135, released March 31, 2016) target **.NET Framework 4.5.2**.</span></span> <span data-ttu-id="9c92b-256">Ta wersja jest hello najwyższa wersja programu .NET Framework obsługiwane przez platformę Azure w czasie hello wersji hello GA hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-256">This version is hello highest version of hello .NET Framework supported by Azure at hello time of hello GA release.</span></span> <span data-ttu-id="9c92b-257">Niestety ta wersja hello framework brakuje niektórych interfejsów API odbiornika danych tego hello Microsoft.Diagnostics.Listeners wymaga biblioteki.</span><span class="sxs-lookup"><span data-stu-id="9c92b-257">Unfortunately, this version of hello framework lacks certain EventListener APIs that hello Microsoft.Diagnostics.Listeners library needs.</span></span> <span data-ttu-id="9c92b-258">Ponieważ EventSource (hello składnik, który podstawą hello rejestrowania interfejsów API w aplikacji sieci szkieletowej) i odbiornika danych są ściśle powiązane, każdy projekt, który korzysta z biblioteki Microsoft.Diagnostics.Listeners hello musi korzystać z alternatywnych implementacji Element EventSource.</span><span class="sxs-lookup"><span data-stu-id="9c92b-258">Because EventSource (hello component that forms hello basis of logging APIs in Fabric applications) and EventListener are tightly coupled, every project that uses hello Microsoft.Diagnostics.Listeners library must use an alternative implementation of EventSource.</span></span> <span data-ttu-id="9c92b-259">Ta implementacja jest zapewniana przez hello **pakietu Microsoft.Diagnostics.Tracing Nuget**, utworzone przez firmę Microsoft.</span><span class="sxs-lookup"><span data-stu-id="9c92b-259">This implementation is provided by hello **Microsoft.Diagnostics.Tracing Nuget package**, authored by Microsoft.</span></span> <span data-ttu-id="9c92b-260">Pakiet HELLO jest pełni zgodny z EventSource zawarte w ramach hello, więc zmiany w kodzie nie powinno być konieczne niż zmiany przywoływanego przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="9c92b-260">hello package is fully backward-compatible with EventSource included in hello framework, so no code changes should be necessary other than referenced namespace changes.</span></span>

<span data-ttu-id="9c92b-261">toostart przy użyciu implementacji Microsoft.Diagnostics.Tracing hello hello EventSource klasy, wykonaj następujące kroki dla każdego projektu usługi, który wymaga toosend tooElasticsearch danych:</span><span class="sxs-lookup"><span data-stu-id="9c92b-261">toostart using hello Microsoft.Diagnostics.Tracing implementation of hello EventSource class, follow these steps for each service project that needs toosend data tooElasticsearch:</span></span>

1. <span data-ttu-id="9c92b-262">Kliknij prawym przyciskiem myszy projekt usługi hello i wybierz polecenie **Zarządzaj pakietami Nuget**.</span><span class="sxs-lookup"><span data-stu-id="9c92b-262">Right-click on hello service project and choose **Manage Nuget Packages**.</span></span>
2. <span data-ttu-id="9c92b-263">Przełącz toohello nuget.org źródła pakietu (Jeśli nie została jeszcze wybrana) i wyszukaj "**Microsoft.Diagnostics.Tracing**".</span><span class="sxs-lookup"><span data-stu-id="9c92b-263">Switch toohello nuget.org package source (if it is not already selected) and search for "**Microsoft.Diagnostics.Tracing**".</span></span>
3. <span data-ttu-id="9c92b-264">Zainstaluj hello `Microsoft.Diagnostics.Tracing.EventSource` pakiet (i jego zależności).</span><span class="sxs-lookup"><span data-stu-id="9c92b-264">Install hello `Microsoft.Diagnostics.Tracing.EventSource` package (and its dependencies).</span></span>
4. <span data-ttu-id="9c92b-265">Otwórz hello **ServiceEventSource.cs** lub **ActorEventSource.cs** pliku w projekcie usługi i Zastąp hello `using System.Diagnostics.Tracing` dyrektywy u góry pliku hello hello `using Microsoft.Diagnostics.Tracing` dyrektywy.</span><span class="sxs-lookup"><span data-stu-id="9c92b-265">Open hello **ServiceEventSource.cs** or **ActorEventSource.cs** file in your service project and replace hello `using System.Diagnostics.Tracing` directive on top of hello file with hello `using Microsoft.Diagnostics.Tracing` directive.</span></span>

<span data-ttu-id="9c92b-266">Te czynności nie będzie konieczne raz hello **.NET Framework 4.6** jest obsługiwana przez system Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="9c92b-266">These steps will not be necessary once hello **.NET Framework 4.6** is supported by Microsoft Azure.</span></span>

### <a name="elasticsearch-listener-instantiation-and-configuration"></a><span data-ttu-id="9c92b-267">Podczas tworzenia wystąpienia Elasticsearch odbiornika i konfiguracji</span><span class="sxs-lookup"><span data-stu-id="9c92b-267">Elasticsearch listener instantiation and configuration</span></span>
<span data-ttu-id="9c92b-268">Witaj ostatnim krokiem wysyłanie danych diagnostycznych tooElasticsearch jest toocreate wystąpienia `ElasticSearchListener` i konfigurowanie go z Elasticsearch połączenia danych.</span><span class="sxs-lookup"><span data-stu-id="9c92b-268">hello final step for sending diagnostic data tooElasticsearch is toocreate an instance of `ElasticSearchListener` and configure it with Elasticsearch connection data.</span></span> <span data-ttu-id="9c92b-269">odbiornik Hello automatycznie przechwytuje wszystkie zdarzenia wywoływane za pośrednictwem klas źródła zdarzeń zdefiniowanych w projekcie usługi hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-269">hello listener automatically captures all events raised via EventSource classes defined in hello service project.</span></span> <span data-ttu-id="9c92b-270">Musi on toobe podczas okresu istnienia hello usługi hello, więc hello najlepiej umieścić toocreate, którego kod inicjujący hello usługi.</span><span class="sxs-lookup"><span data-stu-id="9c92b-270">It needs toobe alive during hello lifetime of hello service, so hello best place toocreate it is in hello service initialization code.</span></span> <span data-ttu-id="9c92b-271">Oto, jak kod inicjujący hello usługi bezstanowej może wyglądać po hello niezbędne zmiany (dodatki wskazano w komentarzach począwszy `****`):</span><span class="sxs-lookup"><span data-stu-id="9c92b-271">Here is how hello initialization code for a stateless service could look after hello necessary changes (additions pointed out in comments starting with `****`):</span></span>

```csharp
using System;
using System.Diagnostics;
using System.Fabric;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.ServiceFabric.Services.Runtime;

// **** Add hello following directives
using Microsoft.Diagnostics.EventListeners;
using Microsoft.Diagnostics.EventListeners.Fabric;

namespace Stateless1
{
    internal static class Program
    {
        /// <summary>
        /// This is hello entry point of hello service host process.
        /// </summary>        
        private static void Main()
        {
            try
            {
                // **** Instantiate ElasticSearchListener
                var configProvider = new FabricConfigurationProvider("ElasticSearchEventListener");
                ElasticSearchListener esListener = null;
                if (configProvider.HasConfiguration)
                {
                    esListener = new ElasticSearchListener(configProvider, new FabricHealthReporter("ElasticSearchEventListener"));
                }

                // hello ServiceManifest.XML file defines one or more service type names.
                // Registering a service maps a service type name tooa .NET type.
                // When Service Fabric creates an instance of this service type,
                // an instance of hello class is created in this host process.

                ServiceRuntime.RegisterServiceAsync("Stateless1Type", 
                    context => new Stateless1(context)).GetAwaiter().GetResult();

                ServiceEventSource.Current.ServiceTypeRegistered(Process.GetCurrentProcess().Id, typeof(Stateless1).Name);

                // Prevents this host process from terminating so services keep running.
                Thread.Sleep(Timeout.Infinite);

                // **** Ensure that hello ElasticSearchListner instance is not garbage-collected prematurely
                GC.KeepAlive(esListener);
            }
            catch (Exception e)
            {
                ServiceEventSource.Current.ServiceHostInitializationFailed(e);
                throw;
            }
        }
    }
}
```

<span data-ttu-id="9c92b-272">Dane połączenia Elasticsearch powinno znajdować się w osobnej sekcji w pliku konfiguracji usługi hello (**PackageRoot\Config\Settings.xml**).</span><span class="sxs-lookup"><span data-stu-id="9c92b-272">Elasticsearch connection data should be put in a separate section in hello service configuration file (**PackageRoot\Config\Settings.xml**).</span></span> <span data-ttu-id="9c92b-273">Witaj nazwę sekcji hello musi odpowiadać toohello przekazana wartość toohello `FabricConfigurationProvider` konstruktora, na przykład:</span><span class="sxs-lookup"><span data-stu-id="9c92b-273">hello name of hello section must correspond toohello value passed toohello `FabricConfigurationProvider` constructor, for example:</span></span>

```xml
<Section Name="ElasticSearchEventListener">
  <Parameter Name="serviceUri" Value="http://myBigCluster.westus.cloudapp.azure.com/es/" />
  <Parameter Name="userName" Value="(ES user name)" />
  <Parameter Name="password" Value="(ES user password)" />
  <Parameter Name="indexNamePrefix" Value="myapp" />
</Section>
```
<span data-ttu-id="9c92b-274">Witaj wartości `serviceUri`, `userName` i `password` odpowiadają adres punktu końcowego klastra Elasticsearch toohello, Elasticsearch nazwę użytkownika i hasło, odpowiednio.</span><span class="sxs-lookup"><span data-stu-id="9c92b-274">hello values of `serviceUri`, `userName` and `password` parameters correspond toohello Elasticsearch cluster endpoint address, Elasticsearch user name, and password, respectively.</span></span> <span data-ttu-id="9c92b-275">`indexNamePrefix`Witaj prefiksu dla indeksów Elasticsearch; Biblioteka Microsoft.Diagnostics.Listeners Hello tworzy nowy indeks danych raz dziennie.</span><span class="sxs-lookup"><span data-stu-id="9c92b-275">`indexNamePrefix` is hello prefix for Elasticsearch indexes; hello Microsoft.Diagnostics.Listeners library creates a new index for its data daily.</span></span>

### <a name="verification"></a><span data-ttu-id="9c92b-276">Weryfikacja</span><span class="sxs-lookup"><span data-stu-id="9c92b-276">Verification</span></span>
<span data-ttu-id="9c92b-277">Gotowe.</span><span class="sxs-lookup"><span data-stu-id="9c92b-277">That's it!</span></span> <span data-ttu-id="9c92b-278">Teraz gdy uruchomiona jest usługa hello, rozpoczyna się wysyłanie śladów toohello Elasticsearch usługi, określonego w konfiguracji hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-278">Now, whenever hello service is run, it starts sending traces toohello Elasticsearch service specified in hello configuration.</span></span> <span data-ttu-id="9c92b-279">Sprawdź hello otwarcia, Kibana interfejsu użytkownika skojarzonego z wystąpieniem Elasticsearch docelowej hello.</span><span class="sxs-lookup"><span data-stu-id="9c92b-279">You can verify this by opening hello Kibana UI associated with hello target Elasticsearch instance.</span></span> <span data-ttu-id="9c92b-280">W naszym przykładzie adres strony hello jest http://myBigCluster.westus.cloudapp.azure.com/.</span><span class="sxs-lookup"><span data-stu-id="9c92b-280">In our example, hello page address is http://myBigCluster.westus.cloudapp.azure.com/.</span></span> <span data-ttu-id="9c92b-281">Sprawdź, czy indeksy z prefiksem nazwy hello wybrany dla hello `ElasticSearchListener` rzeczywiście zostały utworzone i wypełniane przy użyciu danych wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="9c92b-281">Check that indexes with hello name prefix chosen for hello `ElasticSearchListener` instance have indeed been created and populated with data.</span></span>

![Zdarzenia aplikacji PartyCluster przedstawiający Kibana][2]

## <a name="next-steps"></a><span data-ttu-id="9c92b-283">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="9c92b-283">Next steps</span></span>
* [<span data-ttu-id="9c92b-284">Więcej informacji na temat diagnozowania i monitorowanie usługi sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="9c92b-284">Learn more about diagnosing and monitoring a Service Fabric service</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

<!--Image references-->
[1]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/listener-lib-references.png
[2]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/kibana.png
