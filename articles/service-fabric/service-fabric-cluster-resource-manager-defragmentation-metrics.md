---
title: "aaaDefragmentation metryki w sieci szkieletowej usług Azure | Dokumentacja firmy Microsoft"
description: "Omówienie przy użyciu defragmentacji lub pakowania jako strategię metryki w sieci szkieletowej usług"
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: e5ebfae5-c8f7-4d6c-9173-3e22a9730552
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: d09045a6cf196d2771f1a0794637f4579d3eb96b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="defragmentation-of-metrics-and-load-in-service-fabric"></a><span data-ttu-id="01b2c-103">Defragmentacja metryki i obciążenia w sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="01b2c-103">Defragmentation of metrics and load in Service Fabric</span></span>
<span data-ttu-id="01b2c-104">Strategia domyślne Hello usługi sieć szkieletowa klastra Menedżera zasobów do zarządzania metryki obciążenia w klastrze hello jest toodistribute hello obciążenia.</span><span class="sxs-lookup"><span data-stu-id="01b2c-104">hello Service Fabric Cluster Resource Manager's default strategy for managing load metrics in hello cluster is toodistribute hello load.</span></span> <span data-ttu-id="01b2c-105">Zapewnienie, że węzły są wykorzystywane równomiernie pozwala uniknąć gorącego i zimnych miejsc prowadzących rywalizacji tooboth i nieużywanego zasobów.</span><span class="sxs-lookup"><span data-stu-id="01b2c-105">Ensuring that nodes are evenly utilized avoids hot and cold spots that lead tooboth contention and wasted resources.</span></span> <span data-ttu-id="01b2c-106">Dystrybucji obciążeń w klastrze hello jest również hello najbezpieczniejszy pod względem pozostałych błędy, ponieważ gwarantuje, że błąd nie Wyjmij znaczną część danego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="01b2c-106">Distributing workloads in hello cluster is also hello safest in terms of surviving failures since it ensures that a failure doesn’t take out a large percentage of a given workload.</span></span> 

<span data-ttu-id="01b2c-107">Hello zasobu klastra sieci szkieletowej programu Service Manager obsługuje innych strategii zarządzania obciążenia, który jest defragmentacji.</span><span class="sxs-lookup"><span data-stu-id="01b2c-107">hello Service Fabric Cluster Resource Manager does support a different strategy for managing load, which is defragmentation.</span></span> <span data-ttu-id="01b2c-108">Defragmentacja oznacza, że zamiast w trakcie wykorzystania hello toodistribute metryki w klastrze hello, jego są konsolidowane.</span><span class="sxs-lookup"><span data-stu-id="01b2c-108">Defragmentation means that instead of trying toodistribute hello utilization of a metric across hello cluster, it is consolidated.</span></span> <span data-ttu-id="01b2c-109">Konsolidacja jest po prostu odwracanie domyślne hello równoważenia strategii — zamiast minimalizując hello średni odchylenie standardowe metryki obciążenia, hello Menedżera zasobów klastra próbuje tooincrease go.</span><span class="sxs-lookup"><span data-stu-id="01b2c-109">Consolidation is just an inversion of hello default balancing strategy – instead of minimizing hello average standard deviation of metric load, hello Cluster Resource Manager tries tooincrease it.</span></span>

## <a name="when-toouse-defragmentation"></a><span data-ttu-id="01b2c-110">Gdy defragmentacji toouse</span><span class="sxs-lookup"><span data-stu-id="01b2c-110">When toouse defragmentation</span></span>
<span data-ttu-id="01b2c-111">Dystrybucja obciążenia w klastrze hello zużywa niektórych zasobów hello w każdym węźle.</span><span class="sxs-lookup"><span data-stu-id="01b2c-111">Distributing load in hello cluster consumes some of hello resources on each node.</span></span> <span data-ttu-id="01b2c-112">Niektórych zadań tworzenia usług, które są wyjątkowo dużą i używać większości lub wszystkich węzła.</span><span class="sxs-lookup"><span data-stu-id="01b2c-112">Some workloads create services that are exceptionally large and consume most or all of a node.</span></span> <span data-ttu-id="01b2c-113">W takich przypadkach jest to możliwe, że w przypadku dużych pobierania utworzone obciążeń, które nie ma wystarczającej ilości miejsca w toorun dowolnego węzła je.</span><span class="sxs-lookup"><span data-stu-id="01b2c-113">In these cases, it's possible that when there are large workloads getting created that there isn't enough space on any node toorun them.</span></span> <span data-ttu-id="01b2c-114">Duże obciążenia nie są problem w sieci szkieletowej usług; w tych przypadkach hello Cluster Resource Manager ustala, że potrzebuje tooreorganize hello klastra toomake miejsca na tym duże obciążenie.</span><span class="sxs-lookup"><span data-stu-id="01b2c-114">Large workloads aren't a problem in Service Fabric; in these cases hello Cluster Resource Manager determines that it needs tooreorganize hello cluster toomake room for this large workload.</span></span> <span data-ttu-id="01b2c-115">Jednak w hello międzyczasie aby obciążenie ma toobe toowait zaplanowane hello klastra.</span><span class="sxs-lookup"><span data-stu-id="01b2c-115">However, in hello meantime that workload has toowait toobe scheduled in hello cluster.</span></span>

<span data-ttu-id="01b2c-116">Jeśli istnieje wiele usług i stan toomove wokół, jego może potrwać długo toobe duże obciążenie hello umieszczone w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="01b2c-116">If there are many services and state toomove around, then it could take a long time for hello large workload toobe placed in hello cluster.</span></span> <span data-ttu-id="01b2c-117">Jest to bardziej prawdopodobne, jeśli inne obciążenia w klastrze hello są także duży i dlatego trwać dłużej tooreorganize.</span><span class="sxs-lookup"><span data-stu-id="01b2c-117">This is more likely if other workloads in hello cluster are also large and so take longer tooreorganize.</span></span> <span data-ttu-id="01b2c-118">zespołu usługi sieć szkieletowa Hello mierzone czasy tworzenia w symulacji tego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="01b2c-118">hello Service Fabric team measured creation times in simulations of this scenario.</span></span> <span data-ttu-id="01b2c-119">Znaleziono się, że tworzenie dużych usług trwało dłużej zaraz po wykorzystaniu klastra otrzymano powyżej od 30% do 50%.</span><span class="sxs-lookup"><span data-stu-id="01b2c-119">We found that creating large services took much longer as soon as cluster utilization got above between 30% and 50%.</span></span> <span data-ttu-id="01b2c-120">toohandle tego scenariusza, wprowadzono defragmentacji jako równoważenia strategii.</span><span class="sxs-lookup"><span data-stu-id="01b2c-120">toohandle this scenario, we introduced defragmentation as a balancing strategy.</span></span> <span data-ttu-id="01b2c-121">Znaleziono się, że w przypadku dużych obciążeń, zwłaszcza tych, których czas utworzenia było ważne defragmentacji naprawdę pomocne te nowe obciążenia są planowane hello klastra.</span><span class="sxs-lookup"><span data-stu-id="01b2c-121">We found that for large workloads, especially ones where creation time was important, defragmentation really helped those new workloads get scheduled in hello cluster.</span></span>

<span data-ttu-id="01b2c-122">Defragmentacja metryki toohave hello tooproactively Menedżera zasobów klastra spróbuj toocondense hello obciążenia hello usług można skonfigurować do mniej węzłów.</span><span class="sxs-lookup"><span data-stu-id="01b2c-122">You can configure defragmentation metrics toohave hello Cluster Resource Manager tooproactively try toocondense hello load of hello services into fewer nodes.</span></span> <span data-ttu-id="01b2c-123">Pomaga to zapewnić, że jest prawie zawsze miejsca dla dużych usług bez reorganizacja hello klastra.</span><span class="sxs-lookup"><span data-stu-id="01b2c-123">This helps ensure that there is almost always room for large services without reorganizing hello cluster.</span></span> <span data-ttu-id="01b2c-124">Nie ma tooreorganize hello klastra umożliwia szybkie tworzenie dużych obciążeń.</span><span class="sxs-lookup"><span data-stu-id="01b2c-124">Not having tooreorganize hello cluster allows creating large workloads quickly.</span></span>

<span data-ttu-id="01b2c-125">Defragmentacja nie ma potrzeby większości użytkowników.</span><span class="sxs-lookup"><span data-stu-id="01b2c-125">Most people don’t need defragmentation.</span></span> <span data-ttu-id="01b2c-126">Usług są zwykle jest mały, więc nie twardych toofind miejsca dla nich w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="01b2c-126">Services are usually be small, so it’s not hard toofind room for them in hello cluster.</span></span> <span data-ttu-id="01b2c-127">Gdy reorganizacji jest możliwe, przechodzi ona szybko ponownie ponieważ większość usług są małe i mogą zostać przeniesione szybkie i równolegle.</span><span class="sxs-lookup"><span data-stu-id="01b2c-127">When reorganization is possible, it goes quickly, again because most services are small and can be moved quickly and in parallel.</span></span> <span data-ttu-id="01b2c-128">Jednak jeśli dużych usług i należy je szybko utworzyć hello strategii defragmentacji jest dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="01b2c-128">However, if you have large services and need them created quickly then hello defragmentation strategy is for you.</span></span> <span data-ttu-id="01b2c-129">Omówiono wady i zalety korzystania defragmentacji obok hello.</span><span class="sxs-lookup"><span data-stu-id="01b2c-129">We'll discuss hello tradeoffs of using defragmentation next.</span></span> 

## <a name="defragmentation-tradeoffs"></a><span data-ttu-id="01b2c-130">Defragmentacja wady i zalety</span><span class="sxs-lookup"><span data-stu-id="01b2c-130">Defragmentation tradeoffs</span></span>
<span data-ttu-id="01b2c-131">Defragmentacji może zwiększyć impactfulness błędy, ponieważ w węzłach, które nie są uruchomione usługi więcej.</span><span class="sxs-lookup"><span data-stu-id="01b2c-131">Defragmentation can increase impactfulness of failures, since more services are running on nodes that fail.</span></span> <span data-ttu-id="01b2c-132">Defragmentacja także może zwiększyć koszty, ponieważ zasobów w klastrze hello musi być przechowywany w rezerwy czeka na utworzenie hello dużych obciążeń.</span><span class="sxs-lookup"><span data-stu-id="01b2c-132">Defragmentation can also increase costs, since resources in hello cluster must be held in reserve, waiting for hello creation of large workloads.</span></span>

<span data-ttu-id="01b2c-133">Witaj poniższym diagramie zapewnia wizualną reprezentację dwa klastry, który defragmentacji i jedną, która nie jest.</span><span class="sxs-lookup"><span data-stu-id="01b2c-133">hello following diagram gives a visual representation of two clusters, one that is defragmented and one that is not.</span></span> 

<span data-ttu-id="01b2c-134"><center>
![Porównywanie zrównoważonym i defragmentacji klastrów][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="01b2c-134"><center>
![Comparing Balanced and Defragmented Clusters][Image1]
</center></span></span>

<span data-ttu-id="01b2c-135">W przypadku hello zrównoważonym należy wziąć pod uwagę liczbę hello przemieszczania, które mogą być niezbędne tooplace, jeden z największych obiektów usługi hello.</span><span class="sxs-lookup"><span data-stu-id="01b2c-135">In hello balanced case, consider hello number of movements that would be necessary tooplace one of hello largest service objects.</span></span> <span data-ttu-id="01b2c-136">W klastrze zdefragmentowanej hello hello duże obciążenie można umieścić w węzłach czterech lub pięciu bez konieczności toowait dla innych toomove usług.</span><span class="sxs-lookup"><span data-stu-id="01b2c-136">In hello defragmented cluster, hello large workload could be placed on nodes four or five without having toowait for any other services toomove.</span></span>

## <a name="defragmentation-pros-and-cons"></a><span data-ttu-id="01b2c-137">Defragmentacja zalet i wad</span><span class="sxs-lookup"><span data-stu-id="01b2c-137">Defragmentation pros and cons</span></span>
<span data-ttu-id="01b2c-138">Co to są tych pojęć kompromisy?</span><span class="sxs-lookup"><span data-stu-id="01b2c-138">So what are those other conceptual tradeoffs?</span></span> <span data-ttu-id="01b2c-139">Poniżej przedstawiono szybki spis toothink rzeczy, o:</span><span class="sxs-lookup"><span data-stu-id="01b2c-139">Here’s a quick table of things toothink about:</span></span>

| <span data-ttu-id="01b2c-140">Specjaliści defragmentacji</span><span class="sxs-lookup"><span data-stu-id="01b2c-140">Defragmentation Pros</span></span> | <span data-ttu-id="01b2c-141">Defragmentacja wad</span><span class="sxs-lookup"><span data-stu-id="01b2c-141">Defragmentation Cons</span></span> |
| --- | --- |
| <span data-ttu-id="01b2c-142">Umożliwia szybsze tworzenie dużych usług</span><span class="sxs-lookup"><span data-stu-id="01b2c-142">Allows faster creation of large services</span></span> |<span data-ttu-id="01b2c-143">Koncentraty obciążenia na mniejszą liczbę węzłów, zwiększenie rywalizacji</span><span class="sxs-lookup"><span data-stu-id="01b2c-143">Concentrates load onto fewer nodes, increasing contention</span></span> |
| <span data-ttu-id="01b2c-144">Umożliwia obniżyć przenoszenia danych podczas tworzenia</span><span class="sxs-lookup"><span data-stu-id="01b2c-144">Enables lower data movement during creation</span></span> |<span data-ttu-id="01b2c-145">Błędy może mieć wpływ na inne usługi i przenoszenie więcej</span><span class="sxs-lookup"><span data-stu-id="01b2c-145">Failures can impact more services and cause more churn</span></span> |
| <span data-ttu-id="01b2c-146">Umożliwia zaawansowane opis wymagań i odzyskiwanie miejsca</span><span class="sxs-lookup"><span data-stu-id="01b2c-146">Allows rich description of requirements and reclamation of space</span></span> |<span data-ttu-id="01b2c-147">Bardziej złożonych konfiguracji ogólnej zarządzanie zasobami</span><span class="sxs-lookup"><span data-stu-id="01b2c-147">More complex overall Resource Management configuration</span></span> |

<span data-ttu-id="01b2c-148">Można mieszać zdefragmentowanej i normalnym metryki w hello tego samego klastra.</span><span class="sxs-lookup"><span data-stu-id="01b2c-148">You can mix defragmented and normal metrics in hello same cluster.</span></span> <span data-ttu-id="01b2c-149">Witaj Menedżera zasobów klastra prób tooconsolidate hello defragmentacji metryki możliwie często podczas rozkładanie hello innych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="01b2c-149">hello Cluster Resource Manager tries tooconsolidate hello defragmentation metrics as much as possible while spreading out hello others.</span></span> <span data-ttu-id="01b2c-150">wyniki Hello mieszanie defragmentacji oraz równoważenia strategii zależy od kilka czynników, takich jak:</span><span class="sxs-lookup"><span data-stu-id="01b2c-150">hello results of mixing defragmentation and balancing strategies depends on several factors, including:</span></span>
  - <span data-ttu-id="01b2c-151">Liczba Hello równoważenia metryki a hello liczby metryk defragmentacji</span><span class="sxs-lookup"><span data-stu-id="01b2c-151">hello number of balancing metrics vs. hello number of defragmentation metrics</span></span>
  - <span data-ttu-id="01b2c-152">Określa, czy usługi używa obu typów metryk</span><span class="sxs-lookup"><span data-stu-id="01b2c-152">Whether any service uses both types of metrics</span></span> 
  - <span data-ttu-id="01b2c-153">metryki wag Hello</span><span class="sxs-lookup"><span data-stu-id="01b2c-153">hello metric weights</span></span>
  - <span data-ttu-id="01b2c-154">ładuje bieżący metryki</span><span class="sxs-lookup"><span data-stu-id="01b2c-154">current metric loads</span></span>
  
<span data-ttu-id="01b2c-155">Eksperymenty jest wymagana toodetermine hello dokładnej konfiguracji niezbędne.</span><span class="sxs-lookup"><span data-stu-id="01b2c-155">Experimentation is required toodetermine hello exact configuration necessary.</span></span> <span data-ttu-id="01b2c-156">Zalecamy dokładne pomiary obciążeń przed włączeniem metryki defragmentacji w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="01b2c-156">We recommend thorough measurement of your workloads before you enable defragmentation metrics in production.</span></span> <span data-ttu-id="01b2c-157">Jest to szczególnie istotne, jeśli mieszanie defragmentacji i zrównoważonym metryki w hello tę samą usługę.</span><span class="sxs-lookup"><span data-stu-id="01b2c-157">This is especially true when mixing defragmentation and balanced metrics within hello same service.</span></span> 

## <a name="configuring-defragmentation-metrics"></a><span data-ttu-id="01b2c-158">Konfigurowanie metryki defragmentacji</span><span class="sxs-lookup"><span data-stu-id="01b2c-158">Configuring defragmentation metrics</span></span>
<span data-ttu-id="01b2c-159">Konfigurowanie metryki defragmentacji jest globalne decyzji w klastrze hello i do defragmentacji można wybrać poszczególnych metryki.</span><span class="sxs-lookup"><span data-stu-id="01b2c-159">Configuring defragmentation metrics is a global decision in hello cluster, and individual metrics can be selected for defragmentation.</span></span> <span data-ttu-id="01b2c-160">powitania po konfiguracji wstawki pokazują, jak metryki tooconfigure defragmentacji.</span><span class="sxs-lookup"><span data-stu-id="01b2c-160">hello following config snippets show how tooconfigure metrics for defragmentation.</span></span> <span data-ttu-id="01b2c-161">W takim przypadku "Metric1" jest skonfigurowana jako metrykę defragmentacji "Metric2" będzie nadal toobe zrównoważonym normalnie.</span><span class="sxs-lookup"><span data-stu-id="01b2c-161">In this case, "Metric1" is configured as a defragmentation metric, while "Metric2" will continue toobe balanced normally.</span></span> 

<span data-ttu-id="01b2c-162">ClusterManifest.xml:</span><span class="sxs-lookup"><span data-stu-id="01b2c-162">ClusterManifest.xml:</span></span>

```xml
<Section Name="DefragmentationMetrics">
    <Parameter Name="Metric1" Value="true" />
    <Parameter Name="Metric2" Value="false" />
</Section>
```

<span data-ttu-id="01b2c-163">za pomocą pliku ClusterConfig.json dla autonomicznych wdrożeniach lub Template.json dla platformy Azure hostowanej klastrów:</span><span class="sxs-lookup"><span data-stu-id="01b2c-163">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "DefragmentationMetrics",
    "parameters": [
      {
          "name": "Metric1",
          "value": "true"
      },
      {
          "name": "Metric2",
          "value": "false"
      }
    ]
  }
]
```


## <a name="next-steps"></a><span data-ttu-id="01b2c-164">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="01b2c-164">Next steps</span></span>
- <span data-ttu-id="01b2c-165">Hello Menedżera zasobów klastra ma opcje man opisujące hello klastra.</span><span class="sxs-lookup"><span data-stu-id="01b2c-165">hello Cluster Resource Manager has man options for describing hello cluster.</span></span> <span data-ttu-id="01b2c-166">toofind się więcej na ich temat, zapoznaj się w tym artykule na [opisujące klastra sieci szkieletowej usług](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="01b2c-166">toofind out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
- <span data-ttu-id="01b2c-167">Metryki są zarządzaniu hello Menedżer zasobów klastra sieci szkieletowej usług konsumenckich i pojemności w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="01b2c-167">Metrics are how hello Service Fabric Cluster Resource Manger manages consumption and capacity in hello cluster.</span></span> <span data-ttu-id="01b2c-168">więcej informacji na temat metryki toolearn i jak tooconfigure, zapoznaj się z [w tym artykule](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="01b2c-168">toolearn more about metrics and how tooconfigure them, check out [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-defragmentation-metrics/balancing-defrag-compared.png
