---
title: "aaaUpgrade klastra usługi sieć szkieletowa usług Azure | Dokumentacja firmy Microsoft"
description: "Uaktualnij hello kodu sieci szkieletowej usług i/lub konfigurację, która działa w klastrze usługi sieć szkieletowa usług, w tym ustawieniu trybu aktualizacji klastra, certyfikaty, dodawanie portów aplikacji, sposób poprawek systemu operacyjnego, uaktualnienie i tak dalej. Czego można oczekiwać po hello uaktualnienia są wykonywane?"
services: service-fabric
documentationcenter: .net
author: ChackDan
manager: timlt
editor: 
ms.assetid: 15190ace-31ed-491f-a54b-b5ff61e718db
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 8/10/2017
ms.author: chackdan
ms.openlocfilehash: 94ac3833ec0810f79de06ecb50f254028fa90408
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="upgrade-an-azure-service-fabric-cluster"></a><span data-ttu-id="b20f2-104">Uaktualnianie klastra usługi sieć szkieletowa usług Azure</span><span class="sxs-lookup"><span data-stu-id="b20f2-104">Upgrade an Azure Service Fabric cluster</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="b20f2-105">Klastrze platformy Azure</span><span class="sxs-lookup"><span data-stu-id="b20f2-105">Azure Cluster</span></span>](service-fabric-cluster-upgrade.md)
> * [<span data-ttu-id="b20f2-106">Autonomiczny klastra</span><span class="sxs-lookup"><span data-stu-id="b20f2-106">Standalone Cluster</span></span>](service-fabric-cluster-upgrade-windows-server.md)
> 
> 

<span data-ttu-id="b20f2-107">Systemu nowoczesnych projektowanie na możliwość jest długoterminowym sukcesie tooachieving klucza produktu.</span><span class="sxs-lookup"><span data-stu-id="b20f2-107">For any modern system, designing for upgradability is key tooachieving long-term success of your product.</span></span> <span data-ttu-id="b20f2-108">Klaster sieci szkieletowej usług Azure jest z zasobem, który jest właścicielem, ale jest częściowo zarządzany przez firmę Microsoft.</span><span class="sxs-lookup"><span data-stu-id="b20f2-108">An Azure Service Fabric cluster is a resource that you own, but is partly managed by Microsoft.</span></span> <span data-ttu-id="b20f2-109">W tym artykule opisano, co jest zarządzana automatycznie i samodzielnie skonfigurować.</span><span class="sxs-lookup"><span data-stu-id="b20f2-109">This article describes what is managed automatically and what you can configure yourself.</span></span>

## <a name="controlling-hello-fabric-version-that-runs-on-your-cluster"></a><span data-ttu-id="b20f2-110">Kontrolowanie hello wersji sieci szkieletowej, która działa w klastrze</span><span class="sxs-lookup"><span data-stu-id="b20f2-110">Controlling hello fabric version that runs on your Cluster</span></span>
<span data-ttu-id="b20f2-111">Można ustawić sieci szkieletowej automatyczne tooreceive klastra uaktualnień zgodnie z ich wydania przez firmę Microsoft lub wybrać wersji obsługiwanych sieci szkieletowej, która ma toobe Twojego klastra na.</span><span class="sxs-lookup"><span data-stu-id="b20f2-111">You can set your cluster tooreceive automatic fabric upgrades as they are released by Microsoft or you can select a supported fabric version you want your cluster toobe on.</span></span>

<span data-ttu-id="b20f2-112">Aby to zrobić, konfiguracja klastra "parametr upgrademode musi mieć" hello ustawienia w portalu hello lub za pomocą Menedżera zasobów w czasie tworzenia hello lub nowsza w klastrze na żywo</span><span class="sxs-lookup"><span data-stu-id="b20f2-112">You do this by setting hello "upgradeMode" cluster configuration on hello portal or using Resource Manager at hello time of creation or later on a live cluster</span></span> 

> [!NOTE]
> <span data-ttu-id="b20f2-113">Upewnij się, że tookeep klastra zawsze uruchomiona wersja obsługiwanych sieci szkieletowej.</span><span class="sxs-lookup"><span data-stu-id="b20f2-113">Make sure tookeep your cluster running a supported fabric version always.</span></span> <span data-ttu-id="b20f2-114">Gdy firma Microsoft ogłaszamy hello wydaniu nowej wersji platformy service fabric, poprzednia wersja hello jest oznaczony do zakończenia wsparcia po co najmniej 60 dni.</span><span class="sxs-lookup"><span data-stu-id="b20f2-114">As and when we announce hello release of a new version of service fabric, hello previous version is marked for end of support after a minimum of 60 days from that date.</span></span> <span data-ttu-id="b20f2-115">Witaj nowości hello są ogłaszane [na blogu zespołu sieci szkieletowej usług hello](https://blogs.msdn.microsoft.com/azureservicefabric/).</span><span class="sxs-lookup"><span data-stu-id="b20f2-115">hello  hello new releases are announced [on hello service fabric team blog](https://blogs.msdn.microsoft.com/azureservicefabric/).</span></span> <span data-ttu-id="b20f2-116">nową wersję Hello jest następnie toochoose dostępne.</span><span class="sxs-lookup"><span data-stu-id="b20f2-116">hello new release is available toochoose then.</span></span> 
> 
> 

<span data-ttu-id="b20f2-117">14 dni wygaśnięcia toohello wcześniejszych wersji hello klaster działa, zdarzenie kondycji jest generowany, który umieszcza klastra ostrzegawczy stan kondycji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-117">14 days prior toohello expiry of hello release your cluster is running, a health event is generated that puts your cluster into a warning health state.</span></span> <span data-ttu-id="b20f2-118">Hello klaster będzie pozostawał w stanie ostrzeżenia, do momentu uaktualnienia tooa sieci szkieletowej obsługiwanej wersji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-118">hello cluster remains in a warning state until you upgrade tooa supported fabric version.</span></span>

### <a name="setting-hello-upgrade-mode-via-portal"></a><span data-ttu-id="b20f2-119">Ustawianie trybu uaktualniania hello za pośrednictwem portalu</span><span class="sxs-lookup"><span data-stu-id="b20f2-119">Setting hello upgrade mode via portal</span></span>
<span data-ttu-id="b20f2-120">Podczas tworzenia klastra hello można ustawić tooautomatic klastra hello lub ręcznie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-120">You can set hello cluster tooautomatic or manual when you are creating hello cluster.</span></span>

![Create_Manualmode][Create_Manualmode]

<span data-ttu-id="b20f2-122">Można ustawić tooautomatic klastra hello, lub ręcznie, gdy w klastrze na żywo, za pomocą hello zarządzanie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-122">You can set hello cluster tooautomatic or manual when on a live cluster, using hello manage experience.</span></span> 

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-portal"></a><span data-ttu-id="b20f2-123">Uaktualnianie tooa nową wersję w klastrze, który jest ustawiony tryb tooManual za pośrednictwem portalu.</span><span class="sxs-lookup"><span data-stu-id="b20f2-123">Upgrading tooa new version on a cluster that is set tooManual mode via portal.</span></span>
<span data-ttu-id="b20f2-124">Nowa wersja tooa tooupgrade toodo wystarczy wybierz z listy rozwijanej hello hello dostępnych wersji i Zapisz.</span><span class="sxs-lookup"><span data-stu-id="b20f2-124">tooupgrade tooa new version, all you need toodo is select hello available version from hello dropdown and save.</span></span> <span data-ttu-id="b20f2-125">uaktualnienie sieci szkieletowej Hello pobiera rozpoczęte automatycznie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-125">hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="b20f2-126">Witaj zasady dotyczące kondycji klastra (kombinacja kondycji węzła i kondycji hello hello wszystkie aplikacje uruchomione w klastrze hello) są przestrzegane tooduring hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-126">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="b20f2-127">Jeśli zasady dotyczące kondycji hello klastra nie są spełnione, uaktualnienie hello zostanie wycofana.</span><span class="sxs-lookup"><span data-stu-id="b20f2-127">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="b20f2-128">Przewiń w dół tego dokumentu tooread więcej na temat tooset tych zasad dotyczących kondycji niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="b20f2-128">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="b20f2-129">Po wyeliminowaniu hello problemy, które spowodowało wycofanie hello, należy tooinitiate hello uaktualnianie ponownie, przez następujące hello takie same jak poprzednio kroki.</span><span class="sxs-lookup"><span data-stu-id="b20f2-129">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

![Manage_Automaticmode][Manage_Automaticmode]

### <a name="setting-hello-upgrade-mode-via-a-resource-manager-template"></a><span data-ttu-id="b20f2-131">Ustawianie trybu uaktualniania hello za pomocą szablonu usługi Resource Manager</span><span class="sxs-lookup"><span data-stu-id="b20f2-131">Setting hello upgrade mode via a Resource Manager template</span></span>
<span data-ttu-id="b20f2-132">Dodaj definicję zasobu Microsoft.ServiceFabric/clusters toohello konfiguracji "parametr upgrademode musi mieć" hello i tooone "clusterCodeVersion" hello zestawu z hello obsługiwane wersje sieci szkieletowej, jak pokazano poniżej, a następnie wdrożyć hello szablonu.</span><span class="sxs-lookup"><span data-stu-id="b20f2-132">Add hello "upgradeMode" configuration toohello Microsoft.ServiceFabric/clusters resource definition and set hello "clusterCodeVersion" tooone of hello supported fabric versions as shown below and then deploy hello template.</span></span> <span data-ttu-id="b20f2-133">Prawidłowe wartości Hello "parametr upgrademode musi mieć" to "Ręczny" lub "Automatyczny"</span><span class="sxs-lookup"><span data-stu-id="b20f2-133">hello valid values for "upgradeMode" are "Manual" or "Automatic"</span></span>

![ARMUpgradeMode][ARMUpgradeMode]

#### <a name="upgrading-tooa-new-version-on-a-cluster-that-is-set-toomanual-mode-via-a-resource-manager-template"></a><span data-ttu-id="b20f2-135">Uaktualnianie tooa nową wersję w klastrze, który jest ustawiony tryb tooManual za pomocą szablonu usługi Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="b20f2-135">Upgrading tooa new version on a cluster that is set tooManual mode via a Resource Manager template.</span></span>
<span data-ttu-id="b20f2-136">Gdy hello klastra jest w trybie ręcznym tooupgrade tooa nowej wersji zmienić hello "clusterCodeVersion" tooa obsługiwanej wersji i wdrożyć ją.</span><span class="sxs-lookup"><span data-stu-id="b20f2-136">When hello cluster is in Manual mode, tooupgrade tooa new version, change hello "clusterCodeVersion" tooa supported version and deploy it.</span></span> <span data-ttu-id="b20f2-137">wdrożenia Hello hello szablonu, kopnięć uaktualnienia programu Fabric hello pobiera rozpoczęte automatycznie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-137">hello deployment of hello template, kicks of hello Fabric upgrade gets kicked off automatically.</span></span> <span data-ttu-id="b20f2-138">Witaj zasady dotyczące kondycji klastra (kombinacja kondycji węzła i kondycji hello hello wszystkie aplikacje uruchomione w klastrze hello) są przestrzegane tooduring hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-138">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="b20f2-139">Jeśli zasady dotyczące kondycji hello klastra nie są spełnione, uaktualnienie hello zostanie wycofana.</span><span class="sxs-lookup"><span data-stu-id="b20f2-139">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="b20f2-140">Przewiń w dół tego dokumentu tooread więcej na temat tooset tych zasad dotyczących kondycji niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="b20f2-140">Scroll down this document tooread more on how tooset those custom health policies.</span></span> 

<span data-ttu-id="b20f2-141">Po wyeliminowaniu hello problemy, które spowodowało wycofanie hello, należy tooinitiate hello uaktualnianie ponownie, przez następujące hello takie same jak poprzednio kroki.</span><span class="sxs-lookup"><span data-stu-id="b20f2-141">Once you have fixed hello issues that resulted in hello rollback, you need tooinitiate hello upgrade again, by following hello same steps as before.</span></span>

### <a name="get-list-of-all-available-version-for-all-environments-for-a-given-subscription"></a><span data-ttu-id="b20f2-142">Pobierz listę wszystkich dostępnych wersji dla wszystkich środowisk w ramach danej subskrypcji</span><span class="sxs-lookup"><span data-stu-id="b20f2-142">Get list of all available version for all environments for a given subscription</span></span>
<span data-ttu-id="b20f2-143">Uruchom hello następujące polecenie, a następnie należy pobrać toothis podobne dane wyjściowe.</span><span class="sxs-lookup"><span data-stu-id="b20f2-143">Run hello following command, and you should get an output similar toothis.</span></span>

<span data-ttu-id="b20f2-144">"supportExpiryUtc" informuje użytkownika w przypadku danej wersji wygaśnie lub jego ważność wygasła.</span><span class="sxs-lookup"><span data-stu-id="b20f2-144">"supportExpiryUtc" tells your when a given release is expiring or has expired.</span></span> <span data-ttu-id="b20f2-145">Witaj najnowszej wersji nie ma prawidłowej daty — ma wartość "9999-12-31T23:59:59.9999999", co oznacza tylko, że data wygaśnięcia hello nie jest jeszcze ustawiony.</span><span class="sxs-lookup"><span data-stu-id="b20f2-145">hello latest release does not have a valid date - it has a value of "9999-12-31T23:59:59.9999999", which just means that hello expiry date is not yet set.</span></span>

```REST
GET https://<endpoint>/subscriptions/{{subscriptionId}}/providers/Microsoft.ServiceFabric/locations/{{location}}/clusterVersions?api-version=2016-09-01

Example: https://management.azure.com/subscriptions/1857f442-3bce-4b96-ad95-627f76437a67/providers/Microsoft.ServiceFabric/locations/eastus/clusterVersions?api-version=2016-09-01

Output:
{
                  "value": [
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/5.0.1427.9490",
                      "name": "5.0.1427.9490",
                      "type": "Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.0.1427.9490",
                        "supportExpiryUtc": "2016-11-26T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.0.1427.9490",
                      "name": "5.1.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "5.1.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Windows"
                      }
                    },
                    {
                      "id": "subscriptions/35349203-a0b3-405e-8a23-9f1450984307/providers/Microsoft.ServiceFabric/environments/Windows/clusterVersions/4.4.1427.9490",
                      "name": "4.4.1427.9490",
                      "type": " Microsoft.ServiceFabric/environments/clusterVersions",
                      "properties": {
                        "codeVersion": "4.4.1427.9490",
                        "supportExpiryUtc": "9999-12-31T23:59:59.9999999",
                        "environment": "Linux"
                      }
                    }
                  ]
                }


```

## <a name="fabric-upgrade-behavior-when-hello-cluster-upgrade-mode-is-automatic"></a><span data-ttu-id="b20f2-146">Zachowanie uaktualnienia sieci szkieletowej, gdy tryb uaktualniania klastra hello jest automatyczny</span><span class="sxs-lookup"><span data-stu-id="b20f2-146">Fabric upgrade behavior when hello cluster Upgrade Mode is Automatic</span></span>
<span data-ttu-id="b20f2-147">Firma Microsoft udostępnia hello kodu sieci szkieletowej i konfigurację, która działa w klastrze platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="b20f2-147">Microsoft maintains hello fabric code and configuration that runs in an Azure cluster.</span></span> <span data-ttu-id="b20f2-148">Możemy przeprowadzić oprogramowania toohello automatycznych uaktualnień monitorowanych na zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="b20f2-148">We perform automatic monitored upgrades toohello software on an as-needed basis.</span></span> <span data-ttu-id="b20f2-149">Te uaktualnienia może być kodu i konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-149">These upgrades could be code, configuration, or both.</span></span> <span data-ttu-id="b20f2-150">toomake się upewnić, że aplikacja wystąpi Brak wpływu lub minimalny wpływ powodu toothese uaktualnień, możemy wykonywać hello uaktualnień w hello następujące etapy:</span><span class="sxs-lookup"><span data-stu-id="b20f2-150">toomake sure that your application suffers no impact or minimal impact due toothese upgrades, we perform hello upgrades in hello following phases:</span></span>

### <a name="phase-1-an-upgrade-is-performed-by-using-all-cluster-health-policies"></a><span data-ttu-id="b20f2-151">Faza 1: Uaktualnianie jest przeprowadzane przy użyciu wszystkich zasad dotyczących kondycji klastra</span><span class="sxs-lookup"><span data-stu-id="b20f2-151">Phase 1: An upgrade is performed by using all cluster health policies</span></span>
<span data-ttu-id="b20f2-152">W tej fazie uaktualnień hello kontynuować domeny uaktualnienia pojedynczo i hello aplikacje, które były uruchomione w klastrze hello nadal toorun bez żadnego przestoju.</span><span class="sxs-lookup"><span data-stu-id="b20f2-152">During this phase, hello upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="b20f2-153">Witaj zasady dotyczące kondycji klastra (kombinacja kondycji węzła i kondycji hello hello wszystkie aplikacje uruchomione w klastrze hello) są przestrzegane tooduring hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-153">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered tooduring hello upgrade.</span></span>

<span data-ttu-id="b20f2-154">Jeśli zasady dotyczące kondycji hello klastra nie są spełnione, uaktualnienie hello zostanie wycofana.</span><span class="sxs-lookup"><span data-stu-id="b20f2-154">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="b20f2-155">Następnie właściciel toohello hello subskrypcji zostanie wysłana wiadomość e-mail.</span><span class="sxs-lookup"><span data-stu-id="b20f2-155">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="b20f2-156">Witaj w wiadomości e-mail zawierają hello następujących informacji:</span><span class="sxs-lookup"><span data-stu-id="b20f2-156">hello email contains hello following information:</span></span>

* <span data-ttu-id="b20f2-157">Powiadomienie, że było ponownie tooroll uaktualniania klastra.</span><span class="sxs-lookup"><span data-stu-id="b20f2-157">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="b20f2-158">Sugerowane akcje naprawcze, jeśli istnieje.</span><span class="sxs-lookup"><span data-stu-id="b20f2-158">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="b20f2-159">Witaj liczbę dni (n), dopóki nie możemy wykonać fazy 2.</span><span class="sxs-lookup"><span data-stu-id="b20f2-159">hello number of days (n) until we execute Phase 2.</span></span>

<span data-ttu-id="b20f2-160">Spróbujemy hello tooexecute sam uaktualnienia kilka razy w przypadku uaktualniania nie powiodło się ze względów infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="b20f2-160">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="b20f2-161">Po hello n dni od hello Data hello e-mail została wysłana, możemy kontynuować tooPhase 2.</span><span class="sxs-lookup"><span data-stu-id="b20f2-161">After hello n days from hello date hello email was sent, we proceed tooPhase 2.</span></span>

<span data-ttu-id="b20f2-162">Jeśli zasady dotyczące kondycji klastra hello są spełnione, uaktualnienie hello jest uznawany za pomyślny i oznaczone jako ukończone.</span><span class="sxs-lookup"><span data-stu-id="b20f2-162">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="b20f2-163">Może to nastąpić podczas uaktualniania początkowej hello lub dowolnego powtórki uaktualnienia hello na tym etapie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-163">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="b20f2-164">Nie ma żadnych wiadomości e-mail z potwierdzeniem pomyślnego uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-164">There is no email confirmation of a successful run.</span></span> <span data-ttu-id="b20f2-165">Jest to tooavoid wysyłanie zostanie zbyt dużo żądań wiadomości e-mail — odbieranie wiadomości e-mail powinien być traktowany jako toonormal wyjątek.</span><span class="sxs-lookup"><span data-stu-id="b20f2-165">This is tooavoid sending you too many emails--receiving an email should be seen as an exception toonormal.</span></span> <span data-ttu-id="b20f2-166">Oczekujemy większość toosucceed uaktualnienia klastra hello bez wpływu na dostępność Twojej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-166">We expect most of hello cluster upgrades toosucceed without impacting your application availability.</span></span>

### <a name="phase-2-an-upgrade-is-performed-by-using-default-health-policies-only"></a><span data-ttu-id="b20f2-167">Faza 2: Uaktualnianie jest przeprowadzane przy użyciu tylko zasady dotyczące kondycji domyślne</span><span class="sxs-lookup"><span data-stu-id="b20f2-167">Phase 2: An upgrade is performed by using default health policies only</span></span>
<span data-ttu-id="b20f2-168">zasady dotyczące kondycji Hello na tym etapie są ustawiane w taki sposób, że liczba hello aplikacji, które są w dobrej kondycji na początku hello uaktualnienia hello pozostaje hello takie same dla hello czas trwania procesu uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-168">hello health policies in this phase are set in such a way that hello number of applications that were healthy at hello beginning of hello upgrade remains hello same for hello duration of hello upgrade process.</span></span> <span data-ttu-id="b20f2-169">Jak Faza 1 uaktualnień hello fazy 2 kontynuować domeny uaktualnienia pojedynczo i hello aplikacje, które były uruchomione w klastrze hello nadal toorun bez żadnego przestoju.</span><span class="sxs-lookup"><span data-stu-id="b20f2-169">As in Phase 1, hello Phase 2 upgrades proceed one upgrade domain at a time, and hello applications that were running in hello cluster continue toorun without any downtime.</span></span> <span data-ttu-id="b20f2-170">zasady dotyczące kondycji klastra Hello (kombinacja kondycji węzła i kondycji hello hello wszystkie aplikacje uruchomione w klastrze hello) są toofor przyklejonej hello czas trwania uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-170">hello cluster health policies (a combination of node health and hello health all hello applications running in hello cluster) are adhered toofor hello duration of hello upgrade.</span></span>

<span data-ttu-id="b20f2-171">Jeśli zasady dotyczące kondycji klastra hello skutkuje nie są spełnione, uaktualnienie hello zostanie wycofana.</span><span class="sxs-lookup"><span data-stu-id="b20f2-171">If hello cluster health policies in effect are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="b20f2-172">Następnie właściciel toohello hello subskrypcji zostanie wysłana wiadomość e-mail.</span><span class="sxs-lookup"><span data-stu-id="b20f2-172">Then an email is sent toohello owner of hello subscription.</span></span> <span data-ttu-id="b20f2-173">Witaj w wiadomości e-mail zawierają hello następujących informacji:</span><span class="sxs-lookup"><span data-stu-id="b20f2-173">hello email contains hello following information:</span></span>

* <span data-ttu-id="b20f2-174">Powiadomienie, że było ponownie tooroll uaktualniania klastra.</span><span class="sxs-lookup"><span data-stu-id="b20f2-174">Notification that we had tooroll back a cluster upgrade.</span></span>
* <span data-ttu-id="b20f2-175">Sugerowane akcje naprawcze, jeśli istnieje.</span><span class="sxs-lookup"><span data-stu-id="b20f2-175">Suggested remedial actions, if any.</span></span>
* <span data-ttu-id="b20f2-176">Witaj liczbę dni (n), dopóki nie możemy wykonać fazy 3.</span><span class="sxs-lookup"><span data-stu-id="b20f2-176">hello number of days (n) until we execute Phase 3.</span></span>

<span data-ttu-id="b20f2-177">Spróbujemy hello tooexecute sam uaktualnienia kilka razy w przypadku uaktualniania nie powiodło się ze względów infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="b20f2-177">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="b20f2-178">Przypomnienie e-mail jest wysyłana kilka dni, n dni są włączone.</span><span class="sxs-lookup"><span data-stu-id="b20f2-178">A reminder email is sent a couple of days before n days are up.</span></span> <span data-ttu-id="b20f2-179">Po hello n dni od hello Data hello e-mail została wysłana, możemy kontynuować tooPhase 3.</span><span class="sxs-lookup"><span data-stu-id="b20f2-179">After hello n days from hello date hello email was sent, we proceed tooPhase 3.</span></span> <span data-ttu-id="b20f2-180">wiadomości powitania możemy wysłać Faza 2 należy podjąć poważnie i należy podjąć działania naprawcze.</span><span class="sxs-lookup"><span data-stu-id="b20f2-180">hello emails we send you in Phase 2 must be taken seriously and remedial actions must be taken.</span></span>

<span data-ttu-id="b20f2-181">Jeśli zasady dotyczące kondycji klastra hello są spełnione, uaktualnienie hello jest uznawany za pomyślny i oznaczone jako ukończone.</span><span class="sxs-lookup"><span data-stu-id="b20f2-181">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="b20f2-182">Może to nastąpić podczas uaktualniania początkowej hello lub dowolnego powtórki uaktualnienia hello na tym etapie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-182">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="b20f2-183">Nie ma żadnych wiadomości e-mail z potwierdzeniem pomyślnego uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-183">There is no email confirmation of a successful run.</span></span>

### <a name="phase-3-an-upgrade-is-performed-by-using-aggressive-health-policies"></a><span data-ttu-id="b20f2-184">Faza 3: Uaktualnianie jest przeprowadzane za pomocą zasady dotyczące kondycji aktywnego</span><span class="sxs-lookup"><span data-stu-id="b20f2-184">Phase 3: An upgrade is performed by using aggressive health policies</span></span>
<span data-ttu-id="b20f2-185">Te zasady dotyczące kondycji w tej fazie są przeznaczone dla ukończenia uaktualnienia hello zamiast hello kondycję aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-185">These health policies in this phase are geared towards completion of hello upgrade rather than hello health of hello applications.</span></span> <span data-ttu-id="b20f2-186">Bardzo mało uaktualnienia klastra przechodzili na tym etapie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-186">Very few cluster upgrades end up in this phase.</span></span> <span data-ttu-id="b20f2-187">Jeśli klaster pobiera toothis fazy, istnieje duże prawdopodobieństwo, że aplikacja staje się nieprawidłowy, i/lub utratę dostępności.</span><span class="sxs-lookup"><span data-stu-id="b20f2-187">If your cluster gets toothis phase, there is a good chance that your application becomes unhealthy and/or lose availability.</span></span>

<span data-ttu-id="b20f2-188">Podobne toohello innych dwóch faz uaktualnienia fazy 3 kontynuować jedną domenę uaktualnienia naraz.</span><span class="sxs-lookup"><span data-stu-id="b20f2-188">Similar toohello other two phases, Phase 3 upgrades proceed one upgrade domain at a time.</span></span>

<span data-ttu-id="b20f2-189">Jeśli zasady dotyczące kondycji hello klastra nie są spełnione, uaktualnienie hello zostanie wycofana.</span><span class="sxs-lookup"><span data-stu-id="b20f2-189">If hello cluster health policies are not met, hello upgrade is rolled back.</span></span> <span data-ttu-id="b20f2-190">Spróbujemy hello tooexecute sam uaktualnienia kilka razy w przypadku uaktualniania nie powiodło się ze względów infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="b20f2-190">We try tooexecute hello same upgrade a few more times in case any upgrades failed for infrastructure reasons.</span></span> <span data-ttu-id="b20f2-191">Po wykonaniu tej klastra hello jest przypięty, aby go nie będziesz już otrzymywać pomocy technicznej i/lub uaktualnień.</span><span class="sxs-lookup"><span data-stu-id="b20f2-191">After that, hello cluster is pinned, so that it will no longer receive support and/or upgrades.</span></span>

<span data-ttu-id="b20f2-192">Właściciel subskrypcji toohello, wraz z czynności zaradczych hello jest wysłana wiadomość e-mail z tymi informacjami.</span><span class="sxs-lookup"><span data-stu-id="b20f2-192">An email with this information is sent toohello subscription owner, along with hello remedial actions.</span></span> <span data-ttu-id="b20f2-193">Nie oczekuje się żadnych tooget klastrów w stanie, w którym fazy 3 nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="b20f2-193">We do not expect any clusters tooget into a state where Phase 3 has failed.</span></span>

<span data-ttu-id="b20f2-194">Jeśli zasady dotyczące kondycji klastra hello są spełnione, uaktualnienie hello jest uznawany za pomyślny i oznaczone jako ukończone.</span><span class="sxs-lookup"><span data-stu-id="b20f2-194">If hello cluster health policies are met, hello upgrade is considered successful and marked complete.</span></span> <span data-ttu-id="b20f2-195">Może to nastąpić podczas uaktualniania początkowej hello lub dowolnego powtórki uaktualnienia hello na tym etapie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-195">This can happen during hello initial upgrade or any of hello upgrade reruns in this phase.</span></span> <span data-ttu-id="b20f2-196">Nie ma żadnych wiadomości e-mail z potwierdzeniem pomyślnego uruchomienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-196">There is no email confirmation of a successful run.</span></span>

## <a name="cluster-configurations-that-you-control"></a><span data-ttu-id="b20f2-197">Konfiguracje klastrów, które kontrolujesz</span><span class="sxs-lookup"><span data-stu-id="b20f2-197">Cluster configurations that you control</span></span>
<span data-ttu-id="b20f2-198">Ponadto tryb uaktualniania toohello możliwości tooset hello klastra, w tym miejscu są hello konfiguracje, które można zmienić w klastrze na żywo.</span><span class="sxs-lookup"><span data-stu-id="b20f2-198">In addition toohello ability tooset hello cluster upgrade mode, Here are hello configurations that you can change on a live cluster.</span></span>

### <a name="certificates"></a><span data-ttu-id="b20f2-199">Certyfikaty</span><span class="sxs-lookup"><span data-stu-id="b20f2-199">Certificates</span></span>
<span data-ttu-id="b20f2-200">Możesz dodać nowe lub łatwo usunąć certyfikaty dla klastra hello i klienta za pośrednictwem portalu hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-200">You can add new or delete certificates for hello cluster and client via hello portal easily.</span></span> <span data-ttu-id="b20f2-201">Odwołuje się zbyt[tego dokumentu, aby uzyskać szczegółowe instrukcje](service-fabric-cluster-security-update-certs-azure.md)</span><span class="sxs-lookup"><span data-stu-id="b20f2-201">Refer too[this document for detailed instructions](service-fabric-cluster-security-update-certs-azure.md)</span></span>

![Zrzut ekranu pokazujący odciski palców certyfikatów hello portalu Azure.][CertificateUpgrade]

### <a name="application-ports"></a><span data-ttu-id="b20f2-203">Porty aplikacji</span><span class="sxs-lookup"><span data-stu-id="b20f2-203">Application ports</span></span>
<span data-ttu-id="b20f2-204">Porty aplikacji można zmienić, zmieniając właściwości zasobów usługi równoważenia obciążenia hello, które są skojarzone z typem węzła hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-204">You can change application ports by changing hello Load Balancer resource properties that are associated with hello node type.</span></span> <span data-ttu-id="b20f2-205">Można użyć portalu hello, lub można użyć programu PowerShell Menedżera zasobów bezpośrednio.</span><span class="sxs-lookup"><span data-stu-id="b20f2-205">You can use hello portal, or you can use Resource Manager PowerShell directly.</span></span>

<span data-ttu-id="b20f2-206">Nowy port na wszystkich maszynach wirtualnych w typie węzła tooopen hello następujące:</span><span class="sxs-lookup"><span data-stu-id="b20f2-206">tooopen a new port on all VMs in a node type, do hello following:</span></span>

1. <span data-ttu-id="b20f2-207">Dodaj nowy sondowania toohello odpowiedniej usługi równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-207">Add a new probe toohello appropriate load balancer.</span></span>
   
    <span data-ttu-id="b20f2-208">Jeśli klaster jest wdrożony za pomocą portalu hello, usługi równoważenia obciążenia hello są nazywane "LB Nazwa grupy zasobów hello-NodeTypename", po jednej dla każdego typu węzła.</span><span class="sxs-lookup"><span data-stu-id="b20f2-208">If you deployed your cluster by using hello portal, hello load balancers are named "LB-name of hello Resource group-NodeTypename", one for each node type.</span></span> <span data-ttu-id="b20f2-209">Ponieważ nazwy usługi równoważenia obciążenia hello różnią się tylko w obrębie grupy zasobów, najlepiej wyszukiwania je w obszarze określonej grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="b20f2-209">Since hello load balancer names are unique only within a resource group, it is best if you search for them under a specific resource group.</span></span>
   
    ![Zrzut ekranu pokazujący Dodawanie tooa sondowania załadować równoważenia w portalu hello.][AddingProbes]
2. <span data-ttu-id="b20f2-211">Dodaj nowe reguły toohello modułu równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-211">Add a new rule toohello load balancer.</span></span>
   
    <span data-ttu-id="b20f2-212">Dodaj nowy toohello reguły sama usługa równoważenia obciążenia przy użyciu sondowania hello, utworzony w poprzednim kroku hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-212">Add a new rule toohello same load balancer by using hello probe that you created in hello previous step.</span></span>
   
    ![Dodawanie nowej reguły równoważenia obciążenia tooa w portalu hello.][AddingLBRules]

### <a name="placement-properties"></a><span data-ttu-id="b20f2-214">Właściwości umieszczania</span><span class="sxs-lookup"><span data-stu-id="b20f2-214">Placement properties</span></span>
<span data-ttu-id="b20f2-215">Dla każdego typu węzła hello możesz dodać niestandardowe właściwości umieszczania mają toouse w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-215">For each of hello node types, you can add custom placement properties that you want toouse in your applications.</span></span> <span data-ttu-id="b20f2-216">Typ NodeType jest używanej bez dodawania go jawnie właściwości domyślnej.</span><span class="sxs-lookup"><span data-stu-id="b20f2-216">NodeType is a default property that you can use without adding it explicitly.</span></span>

> [!NOTE]
> <span data-ttu-id="b20f2-217">Szczegółowe informacje na temat użycia hello ograniczeń umieszczania, właściwości węzła i jak toodefine, znajduje się w sekcji toohello "Umieszczania ograniczenia i właściwości węzła" hello dokumentu zasobu klastra sieci szkieletowej programu Service Manager w [opisujące Your klastra ](service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="b20f2-217">For details on hello use of placement constraints, node properties, and how toodefine them, refer toohello section "Placement Constraints and Node Properties" in hello Service Fabric Cluster Resource Manager Document on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>
> 
> 

### <a name="capacity-metrics"></a><span data-ttu-id="b20f2-218">Metryki pojemności</span><span class="sxs-lookup"><span data-stu-id="b20f2-218">Capacity metrics</span></span>
<span data-ttu-id="b20f2-219">Dla każdego typu węzła hello możesz dodać niestandardowe metryki pojemności mają toouse w obciążenia tooreport aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b20f2-219">For each of hello node types, you can add custom capacity metrics that you want toouse in your applications tooreport load.</span></span> <span data-ttu-id="b20f2-220">Szczegółowe informacje dotyczące użycia hello obciążenia tooreport metryki pojemności, toohello dokumentów zasobu klastra sieci szkieletowej programu Service Manager znajduje się w [opisujące Your klastra](service-fabric-cluster-resource-manager-cluster-description.md) i [metryki i obciążenia](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="b20f2-220">For details on hello use of capacity metrics tooreport load, refer toohello Service Fabric Cluster Resource Manager Documents on [Describing Your Cluster](service-fabric-cluster-resource-manager-cluster-description.md) and [Metrics and Load](service-fabric-cluster-resource-manager-metrics.md).</span></span>

### <a name="fabric-upgrade-settings---health-polices"></a><span data-ttu-id="b20f2-221">Zasady kondycji sieci szkieletowej ustawienia uaktualnienia —</span><span class="sxs-lookup"><span data-stu-id="b20f2-221">Fabric upgrade settings - Health polices</span></span>
<span data-ttu-id="b20f2-222">Można określić, czy zasady niestandardowe kondycji dla uaktualnienia programu fabric.</span><span class="sxs-lookup"><span data-stu-id="b20f2-222">You can specify custom health polices for fabric upgrade.</span></span> <span data-ttu-id="b20f2-223">Jeśli ustawiono tooAutomatic Twojego klastra sieci szkieletowej uaktualnień, te zasady Pobierz zastosowane toohello pierwszą fazę hello sieci szkieletowej automatycznych uaktualnień.</span><span class="sxs-lookup"><span data-stu-id="b20f2-223">If you have set your cluster tooAutomatic fabric upgrades, then these policies get applied toohello Phase-1 of hello automatic fabric upgrades.</span></span>
<span data-ttu-id="b20f2-224">Jeśli ustawiono klastra sieci szkieletowej ręczne uaktualnienia, a następnie te zasady zastosowane każdorazowo wybrania nowej wersji wyzwalania tookick systemu hello poza uaktualnienia programu fabric hello w klastrze.</span><span class="sxs-lookup"><span data-stu-id="b20f2-224">If you have set your cluster for Manual fabric upgrades, then these policies get applied each time you select a new version triggering hello system tookick off hello fabric upgrade in your cluster.</span></span> <span data-ttu-id="b20f2-225">Jeśli nie zastępują zasady hello, używane są ustawienia domyślne hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-225">If you do not override hello policies, hello defaults are used.</span></span>

<span data-ttu-id="b20f2-226">Można określić zasady dotyczące kondycji niestandardowych hello lub przejrzyj hello bieżące ustawienia w obszarze bloku "uaktualnienia programu fabric" hello, wybierając hello Zaawansowane ustawienia uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b20f2-226">You can specify hello custom health policies or review hello current settings under hello "fabric upgrade" blade, by selecting hello advanced upgrade settings.</span></span> <span data-ttu-id="b20f2-227">Przejrzyj hello poniższej ilustracji na temat.</span><span class="sxs-lookup"><span data-stu-id="b20f2-227">Review hello following picture on how to.</span></span> 

![Zarządzanie zasadami kondycji niestandardowych][HealthPolices]

### <a name="customize-fabric-settings-for-your-cluster"></a><span data-ttu-id="b20f2-229">Dostosowywanie ustawień sieci szkieletowej dla klastra</span><span class="sxs-lookup"><span data-stu-id="b20f2-229">Customize Fabric settings for your cluster</span></span>
<span data-ttu-id="b20f2-230">Odwołuje się zbyt[ustawień sieci szkieletowej klastra sieci szkieletowej usług](service-fabric-cluster-fabric-settings.md) na co jest i jak można dostosować je.</span><span class="sxs-lookup"><span data-stu-id="b20f2-230">Refer too[service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md) on what and how you can customize them.</span></span>

### <a name="os-patches-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="b20f2-231">Poprawek systemu operacyjnego na powitania maszyny wirtualne wchodzące w skład klastra hello</span><span class="sxs-lookup"><span data-stu-id="b20f2-231">OS patches on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="b20f2-232">Odwołuje się zbyt[poprawki aplikacji aranżacji](service-fabric-patch-orchestration-application.md) którego można wdrożyć na poprawki tooinstall z klastra z usługi Windows Update w sposób orchestrated zachować dostępność usług hello cały czas hello.</span><span class="sxs-lookup"><span data-stu-id="b20f2-232">Refer too[Patch Orchestration Application](service-fabric-patch-orchestration-application.md) which can be deployed on your cluster tooinstall patches from Windows Update in an orchestrated manner, keeping hello services available all hello time.</span></span> 

### <a name="os-upgrades-on-hello-vms-that-make-up-hello-cluster"></a><span data-ttu-id="b20f2-233">Uaktualnień systemu operacyjnego na powitania maszyny wirtualne wchodzące w skład klastra hello</span><span class="sxs-lookup"><span data-stu-id="b20f2-233">OS upgrades on hello VMs that make up hello cluster</span></span>
<span data-ttu-id="b20f2-234">Jeśli musisz uaktualnić hello obrazu systemu operacyjnego na maszynach wirtualnych hello hello klastra, należy to robić jedną maszynę Wirtualną w czasie.</span><span class="sxs-lookup"><span data-stu-id="b20f2-234">If you must upgrade hello OS image on hello virtual machines of hello cluster, you must do it one VM at a time.</span></span> <span data-ttu-id="b20f2-235">Przydadzą się osobom odpowiedzialnym dla tego uaktualnienia — nie ma obecnie nie automatyzacji tego.</span><span class="sxs-lookup"><span data-stu-id="b20f2-235">You are responsible for this upgrade--there is currently no automation for this.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b20f2-236">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="b20f2-236">Next steps</span></span>
* <span data-ttu-id="b20f2-237">Dowiedz się, jak toocustomize niektóre hello [ustawień sieci szkieletowej klastra sieci szkieletowej usług](service-fabric-cluster-fabric-settings.md)</span><span class="sxs-lookup"><span data-stu-id="b20f2-237">Learn how toocustomize some of hello [service fabric cluster fabric settings](service-fabric-cluster-fabric-settings.md)</span></span>
* <span data-ttu-id="b20f2-238">Dowiedz się, jak za[i wylogowywanie skalowanie klastra](service-fabric-cluster-scale-up-down.md)</span><span class="sxs-lookup"><span data-stu-id="b20f2-238">Learn how too[scale your cluster in and out](service-fabric-cluster-scale-up-down.md)</span></span>
* <span data-ttu-id="b20f2-239">Dowiedz się więcej o [uaktualnienia aplikacji](service-fabric-application-upgrade.md)</span><span class="sxs-lookup"><span data-stu-id="b20f2-239">Learn about [application upgrades](service-fabric-application-upgrade.md)</span></span>

<!--Image references-->
[CertificateUpgrade]: ./media/service-fabric-cluster-upgrade/CertificateUpgrade2.png
[AddingProbes]: ./media/service-fabric-cluster-upgrade/addingProbes2.PNG
[AddingLBRules]: ./media/service-fabric-cluster-upgrade/addingLBRules.png
[HealthPolices]: ./media/service-fabric-cluster-upgrade/Manage_AutomodeWadvSettings.PNG
[ARMUpgradeMode]: ./media/service-fabric-cluster-upgrade/ARMUpgradeMode.PNG
[Create_Manualmode]: ./media/service-fabric-cluster-upgrade/Create_Manualmode.PNG
[Manage_Automaticmode]: ./media/service-fabric-cluster-upgrade/Manage_Automaticmode.PNG
