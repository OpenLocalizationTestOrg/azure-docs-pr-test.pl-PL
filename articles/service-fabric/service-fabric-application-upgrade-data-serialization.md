---
title: 'Uaktualnianie aplikacji: serializacja danych | Dokumentacja firmy Microsoft'
description: "Najlepsze rozwiązania dla serializacji danych i jak wpływa na uaktualnienia równoległe aplikacji."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="f4187-103">Jak serializacja danych wpływa na uaktualnienia aplikacji</span><span class="sxs-lookup"><span data-stu-id="f4187-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="f4187-104">W [aplikacji uaktualnienia stopniowego](service-fabric-application-upgrade.md), uaktualnienie ma zostać zastosowane do podzbioru węzłów, domeny uaktualnienia pojedynczo.</span><span class="sxs-lookup"><span data-stu-id="f4187-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="f4187-105">W trakcie tego procesu są niektórych domen uaktualnienia w nowszej wersji aplikacji i niektóre domen uaktualnienia znajdują się na starszej wersji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f4187-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="f4187-106">Podczas wdrożenia nowa wersja aplikacji musi mieć możliwość odczytu starą wersję danych, a starą wersję aplikacji musi mieć możliwość odczytu nowej wersji danych.</span><span class="sxs-lookup"><span data-stu-id="f4187-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="f4187-107">Jeśli format danych jest niezgodny z przodu i do tyłu, uaktualnienie może się nie powieść lub gorsza, może utraty lub uszkodzenia danych.</span><span class="sxs-lookup"><span data-stu-id="f4187-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="f4187-108">W tym artykule opisano, co stanowi formatu danych i oferuje najlepsze rozwiązania dotyczące zapewnienie, że dane są do przodu i do tyłu zgodne.</span><span class="sxs-lookup"><span data-stu-id="f4187-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="f4187-109">Co tworzą formatu danych?</span><span class="sxs-lookup"><span data-stu-id="f4187-109">What makes up your data format?</span></span>
<span data-ttu-id="f4187-110">W sieci szkieletowej usług Azure dane, które jest utrwalenia i replikacji pochodzi z klasy C#.</span><span class="sxs-lookup"><span data-stu-id="f4187-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="f4187-111">Dla aplikacji używających [niezawodnej kolekcje](service-fabric-reliable-services-reliable-collections.md), że dane są obiektów niezawodnej słowniki i kolejek.</span><span class="sxs-lookup"><span data-stu-id="f4187-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="f4187-112">Dla aplikacji używających [Reliable Actors](service-fabric-reliable-actors-introduction.md), czyli stanu zapasowy aktora.</span><span class="sxs-lookup"><span data-stu-id="f4187-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="f4187-113">Te klasy C# musi podlegać serializacji do utrwalenia i replikacji.</span><span class="sxs-lookup"><span data-stu-id="f4187-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="f4187-114">W związku z tym format danych został zdefiniowany przez pola i właściwości, które są serializowane, a także jak ich są serializowane.</span><span class="sxs-lookup"><span data-stu-id="f4187-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="f4187-115">Na przykład w `IReliableDictionary<int, MyClass>` dane są serializowane `int` i serializacji `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="f4187-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="f4187-116">Wynik zmianę formatu danych zmiany kodu</span><span class="sxs-lookup"><span data-stu-id="f4187-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="f4187-117">Ponieważ format danych jest określany przez klas C#, zmiany klasy może spowodować zmianę formatu danych.</span><span class="sxs-lookup"><span data-stu-id="f4187-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="f4187-118">Należy uważać, aby upewnić się, że uaktualnienie stopniowe może obsłużyć zmianę formatu danych.</span><span class="sxs-lookup"><span data-stu-id="f4187-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="f4187-119">Przykłady, które mogą powodować zmiany formatowania danych:</span><span class="sxs-lookup"><span data-stu-id="f4187-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="f4187-120">Dodawanie lub usuwanie pól lub właściwości</span><span class="sxs-lookup"><span data-stu-id="f4187-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="f4187-121">Zmiana nazwy pola lub właściwości</span><span class="sxs-lookup"><span data-stu-id="f4187-121">Renaming fields or properties</span></span>
* <span data-ttu-id="f4187-122">Zmiany typów pól lub właściwości</span><span class="sxs-lookup"><span data-stu-id="f4187-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="f4187-123">Zmiana nazwy klasy lub przestrzeni nazw</span><span class="sxs-lookup"><span data-stu-id="f4187-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="f4187-124">Kontrakt danych jako domyślnego elementu serializującego</span><span class="sxs-lookup"><span data-stu-id="f4187-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="f4187-125">Serializator jest zazwyczaj odpowiedzialny za odczytywanie danych i deserializacji go do wersji bieżącej, nawet jeśli dane znajdują się w starszej lub *nowszej* wersji.</span><span class="sxs-lookup"><span data-stu-id="f4187-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="f4187-126">Domyślnym elementem serializującym jest [serializator kontraktu danych](https://msdn.microsoft.com/library/ms733127.aspx), który zawiera reguły dobrze zdefiniowany kontroli wersji.</span><span class="sxs-lookup"><span data-stu-id="f4187-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="f4187-127">Kolekcje niezawodnej Zezwalaj serializatora do zastąpienia, ale Reliable Actors aktualnie nie.</span><span class="sxs-lookup"><span data-stu-id="f4187-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="f4187-128">Serializator danych odgrywa ważną rolę w naprawieniu uaktualnienia równoległe.</span><span class="sxs-lookup"><span data-stu-id="f4187-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="f4187-129">Serializator kontraktu danych jest serializator zalecane dla aplikacji sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="f4187-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="f4187-130">Jak format danych wpływa na uaktualnienia stopniowego</span><span class="sxs-lookup"><span data-stu-id="f4187-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="f4187-131">Podczas uaktualnienia stopniowego, istnieją dwa główne scenariusze, w którym serializator napotkać starszej lub *nowszej* wersji danych:</span><span class="sxs-lookup"><span data-stu-id="f4187-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="f4187-132">Po węzeł zostanie uaktualniony i uruchamia tworzenie kopii zapasowej, nowe serializator załaduje dane, które zostało utrwalone na dysku przez starszą wersję.</span><span class="sxs-lookup"><span data-stu-id="f4187-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="f4187-133">Podczas uaktualnienia stopniowego klastra będzie zawierać mieszanie starej i nowej wersji kodu.</span><span class="sxs-lookup"><span data-stu-id="f4187-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="f4187-134">Ponieważ replik może znajdować się w różnych domenach uaktualnienia i replik wysyłania danych do siebie, stary i/lub nowych wersji danych mogą wystąpić przez stary i/lub nowych wersji programu szeregującego.</span><span class="sxs-lookup"><span data-stu-id="f4187-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="f4187-135">"Nowa wersja" i "starą wersję" w tym miejscu można znaleźć wersji swój kod, który jest uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="f4187-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="f4187-136">"Nowe serializatora" odnosi się do kodu serializator, który jest wykonywany w nowej wersji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f4187-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="f4187-137">"Nowe dane" odwołuje się do serializacji klasy C# z nowej wersji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f4187-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="f4187-138">Dwie wersje formatu kodu i danych musi być zarówno do przodu i do tyłu zgodne.</span><span class="sxs-lookup"><span data-stu-id="f4187-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="f4187-139">Jeśli nie są zgodne, uaktualnienia stopniowego może zakończyć się niepowodzeniem lub dane mogą zostać utracone.</span><span class="sxs-lookup"><span data-stu-id="f4187-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="f4187-140">Uaktualnienie stopniowe może zakończyć się niepowodzeniem, ponieważ kod lub serializator może zgłaszać wyjątków lub fault po napotkaniu innych wersji.</span><span class="sxs-lookup"><span data-stu-id="f4187-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="f4187-141">Jeśli na przykład dodano nową właściwość, ale odrzuca je podczas deserializacji serializator stare dane mogą zostać utracone.</span><span class="sxs-lookup"><span data-stu-id="f4187-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="f4187-142">Kontrakt danych jest zalecanym rozwiązaniem dla zapewnienia, że dane są zgodne.</span><span class="sxs-lookup"><span data-stu-id="f4187-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="f4187-143">Ma ona versioning dobrze zdefiniowane zasady Dodawanie, usuwanie i zmiana pola.</span><span class="sxs-lookup"><span data-stu-id="f4187-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="f4187-144">Ma również obsługę zajmujących się nieznany pól, przechwytywanie do procesu serializacji i deserializacji i zajmujących się dziedziczenia klas.</span><span class="sxs-lookup"><span data-stu-id="f4187-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="f4187-145">Aby uzyskać więcej informacji, zobacz [kontraktu danych przy użyciu](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="f4187-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f4187-146">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="f4187-146">Next steps</span></span>
<span data-ttu-id="f4187-147">[Uaktualnianie aplikacji za pomocą Visual Studio](service-fabric-application-upgrade-tutorial.md) przeprowadzi Cię przez proces uaktualnienia aplikacji przy użyciu programu Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="f4187-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="f4187-148">[Uaktualnienie z aplikacji przy użyciu programu Powershell](service-fabric-application-upgrade-tutorial-powershell.md) przeprowadzi Cię przez proces uaktualnienia aplikacji przy użyciu programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f4187-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="f4187-149">Kontrolowanie sposobu uaktualnienia aplikacji przy użyciu [uaktualnienia parametrów](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="f4187-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="f4187-150">Dowiedz się, jak korzystać z zaawansowanych funkcji podczas uaktualniania aplikacji, odwołując się do [Tematy zaawansowane](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="f4187-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="f4187-151">Rozwiązywania typowych problemów w uaktualnień aplikacji, korzystając z procedury opisanej w [Rozwiązywanie problemów z uaktualnieniami aplikacji ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="f4187-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

