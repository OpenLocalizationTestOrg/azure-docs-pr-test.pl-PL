---
title: "Niestandardowe raporty kondycji sieci szkieletowej usług aaaAdd | Dokumentacja firmy Microsoft"
description: "W tym artykule opisano, jak toosend kondycji niestandardowych raportów jednostki kondycji sieci szkieletowej usług tooAzure. Zawiera zalecenia dotyczące projektowania i wdrażania raportów o kondycji jakości."
services: service-fabric
documentationcenter: .net
author: oanapl
manager: timlt
editor: 
ms.assetid: 0a00a7d2-510e-47d0-8aa8-24c851ea847f
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/19/2017
ms.author: oanapl
ms.openlocfilehash: 12c9f664e2a457b4e1e8f340873ca60ebcefb097
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="add-custom-service-fabric-health-reports"></a><span data-ttu-id="6bbb0-104">Dodawanie niestandardowych raportów kondycji usługi Service Fabric</span><span class="sxs-lookup"><span data-stu-id="6bbb0-104">Add custom Service Fabric health reports</span></span>
<span data-ttu-id="6bbb0-105">Sieć szkieletowa usług Azure wprowadza [model kondycji](service-fabric-health-introduction.md) tooflag zła klastra oraz warunki aplikacji na konkretnych obiektów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-105">Azure Service Fabric introduces a [health model](service-fabric-health-introduction.md) designed tooflag unhealthy cluster and application conditions on specific entities.</span></span> <span data-ttu-id="6bbb0-106">model kondycji Hello używa **Raporty kondycji** (składników systemu i watchdogs).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-106">hello health model uses **health reporters** (system components and watchdogs).</span></span> <span data-ttu-id="6bbb0-107">Celem Hello jest łatwe i szybkie diagnozowanie i naprawy.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-107">hello goal is easy and fast diagnosis and repair.</span></span> <span data-ttu-id="6bbb0-108">Moduły zapisujące usługi należy toothink wyprzedzeniem o kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-108">Service writers need toothink upfront about health.</span></span> <span data-ttu-id="6bbb0-109">Należy podać żadnych warunek, który może mieć wpływ na kondycję, zwłaszcza, jeśli może pomóc problemów flagi zamknąć toohello głównego.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-109">Any condition that can impact health should be reported on, especially if it can help flag problems close toohello root.</span></span> <span data-ttu-id="6bbb0-110">informacje o kondycji Hello można zapisać ilość czasu, na analizie i debugowania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-110">hello health information can save time and effort on debugging and investigation.</span></span> <span data-ttu-id="6bbb0-111">Witaj przydatność jest szczególnie wyczyszczone po hello usługa jest uruchomiona na dużą skalę w chmurze hello (prywatny czy Azure).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-111">hello usefulness is especially clear once hello service is up and running at scale in hello cloud (private or Azure).</span></span>

<span data-ttu-id="6bbb0-112">monitor raporty usługi sieć szkieletowa Hello określone warunki odsetek.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-112">hello Service Fabric reporters monitor identified conditions of interest.</span></span> <span data-ttu-id="6bbb0-113">Zgłaszają przy użyciu tych warunków na podstawie ich lokalnego widoku.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-113">They report on those conditions based on their local view.</span></span> <span data-ttu-id="6bbb0-114">Witaj [magazynu kondycji](service-fabric-health-introduction.md#health-store) agreguje dane kondycji wysyłane przez wszystkie toodetermine raporty, czy jednostki są globalnie dobrej kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-114">hello [health store](service-fabric-health-introduction.md#health-store) aggregates health data sent by all reporters toodetermine whether entities are globally healthy.</span></span> <span data-ttu-id="6bbb0-115">Hello model jest zamierzone toobe toouse sformatowanego, elastyczne i łatwe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-115">hello model is intended toobe rich, flexible, and easy toouse.</span></span> <span data-ttu-id="6bbb0-116">jakość Hello raportów o kondycji hello Określa dokładność hello widoku kondycji hello hello klastra.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-116">hello quality of hello health reports determines hello accuracy of hello health view of hello cluster.</span></span> <span data-ttu-id="6bbb0-117">Fałszywych alarmów, przedstawiających błędnie zła problemów może niekorzystnie wpłynąć na uaktualnienia lub innych usług używających danych kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-117">False positives that wrongly show unhealthy issues can negatively impact upgrades or other services that use health data.</span></span> <span data-ttu-id="6bbb0-118">Przykładami takich usług są usługi repair i mechanizmów alertów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-118">Examples of such services are repair services and alerting mechanisms.</span></span> <span data-ttu-id="6bbb0-119">W związku z tym rozwagą jest tooprovide potrzebne raporty, które przechwytywania warunki zainteresowanie hello najlepsze możliwe sposób.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-119">Therefore, some thought is needed tooprovide reports that capture conditions of interest in hello best possible way.</span></span>

<span data-ttu-id="6bbb0-120">toodesign i wdrożenie kondycji raportowania, watchdogs i składnikach systemu musi:</span><span class="sxs-lookup"><span data-stu-id="6bbb0-120">toodesign and implement health reporting, watchdogs and system components must:</span></span>

* <span data-ttu-id="6bbb0-121">Zdefiniuj warunek hello są zainteresowani, jak hello jest monitorowany i hello wpływ na funkcjonalność klastra lub aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-121">Define hello condition they are interested in, hello way it is monitored, and hello impact on hello cluster or application functionality.</span></span> <span data-ttu-id="6bbb0-122">Na podstawie tych informacji, decyduje o hello raportu właściwości oraz kondycji stanu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-122">Based on this information, decide on hello health report property and health state.</span></span>
* <span data-ttu-id="6bbb0-123">Określić hello [jednostki](service-fabric-health-introduction.md#health-entities-and-hierarchy) że hello raport dotyczy.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-123">Determine hello [entity](service-fabric-health-introduction.md#health-entities-and-hierarchy) that hello report applies to.</span></span>
* <span data-ttu-id="6bbb0-124">Ustal, gdzie hello raportowania jest wykonywana, z poziomu hello usługi lub wewnętrznych lub zewnętrznych programu alarmowego.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-124">Determine where hello reporting is done, from within hello service or from an internal or external watchdog.</span></span>
* <span data-ttu-id="6bbb0-125">Zdefiniuj źródło używane tooidentify hello reportera.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-125">Define a source used tooidentify hello reporter.</span></span>
* <span data-ttu-id="6bbb0-126">Wybierz strategię raportowania, okresowo lub na przejścia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-126">Choose a reporting strategy, either periodically or on transitions.</span></span> <span data-ttu-id="6bbb0-127">Witaj zalecany sposób jest okresowo, ponieważ wymaga prostsze kodu i jest mniej podatne tooerrors.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-127">hello recommended way is periodically, as it requires simpler code and is less prone tooerrors.</span></span>
* <span data-ttu-id="6bbb0-128">Jak długo hello raportu należy określić zła warunki powinny pozostać w magazynie kondycji hello i w jaki sposób ma zostać wyczyszczona.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-128">Determine how long hello report for unhealthy conditions should stay in hello health store and how it should be cleared.</span></span> <span data-ttu-id="6bbb0-129">Korzystając z tych informacji, zdecyduj, raport hello toolive i Usuń na wygaśnięcia zachowania w czasie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-129">Using this information, decide hello report's time toolive and remove-on-expiration behavior.</span></span>

<span data-ttu-id="6bbb0-130">Jak wspomniano, raportowanie może odbywać się od:</span><span class="sxs-lookup"><span data-stu-id="6bbb0-130">As mentioned, reporting can be done from:</span></span>

* <span data-ttu-id="6bbb0-131">Witaj monitorowane repliki usługi sieć szkieletowa usług.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-131">hello monitored Service Fabric service replica.</span></span>
* <span data-ttu-id="6bbb0-132">Wewnętrzny watchdogs wdrożony jako usługa sieci szkieletowej usług (na przykład sieci szkieletowej usług bezstanowych Usługa monitoruje warunki i generuje raporty).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-132">Internal watchdogs deployed as a Service Fabric service (for example, a Service Fabric stateless service that monitors conditions and issues reports).</span></span> <span data-ttu-id="6bbb0-133">Witaj watchdogs może być wdrożony wszystkie węzły lub może być skoligaconym toohello monitorowane usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-133">hello watchdogs can be deployed an all nodes or can be affinitized toohello monitored service.</span></span>
* <span data-ttu-id="6bbb0-134">Wewnętrzny watchdogs, uruchom na powitania węzłów sieci szkieletowej usług, które są *nie* zaimplementowane jako usługi sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-134">Internal watchdogs that run on hello Service Fabric nodes but are *not* implemented as Service Fabric services.</span></span>
* <span data-ttu-id="6bbb0-135">Zewnętrzne watchdogs zasobu hello sondowania z *poza* klastra sieci szkieletowej usług hello (na przykład monitorowania usługi, takiej jak Gomez).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-135">External watchdogs that probe hello resource from *outside* hello Service Fabric cluster (for example, monitoring service like Gomez).</span></span>

> [!NOTE]
> <span data-ttu-id="6bbb0-136">Fabrycznej hello klastra hello jest wypełniana wysyłane przez składniki systemu hello raportów o kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-136">Out of hello box, hello cluster is populated with health reports sent by hello system components.</span></span> <span data-ttu-id="6bbb0-137">Dowiedz się więcej o [przy użyciu kondycji systemu raportów do rozwiązywania problemów](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-137">Read more at [Using system health reports for troubleshooting](service-fabric-understand-and-troubleshoot-with-system-health-reports.md).</span></span> <span data-ttu-id="6bbb0-138">Witaj raporty użytkownika musi zostać wysłany [jednostki kondycji](service-fabric-health-introduction.md#health-entities-and-hierarchy) które już zostały utworzone przez hello system.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-138">hello user reports must be sent on [health entities](service-fabric-health-introduction.md#health-entities-and-hierarchy) that have already been created by hello system.</span></span>
> 
> 

<span data-ttu-id="6bbb0-139">Raz hello projektu raportowania kondycji jest wyczyszczone, łatwo można wysyłać raporty o kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-139">Once hello health reporting design is clear, health reports can be sent easily.</span></span> <span data-ttu-id="6bbb0-140">Można użyć [klienta fabricclient z rolą](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport kondycji, jeśli hello klastra nie jest [bezpiecznego](service-fabric-cluster-security.md) lub jeśli powitania klienta programu fabric ma uprawnienia administratora.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-140">You can use [FabricClient](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient) tooreport health if hello cluster is not [secure](service-fabric-cluster-security.md) or if hello fabric client has admin privileges.</span></span> <span data-ttu-id="6bbb0-141">Raportowanie może odbywać się za pośrednictwem hello interfejsu API przez przy użyciu [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), za pomocą programu PowerShell lub za pośrednictwem REST.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-141">Reporting can be done through hello API by using [FabricClient.HealthManager.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth), through PowerShell, or through REST.</span></span> <span data-ttu-id="6bbb0-142">Konfiguracja pokrętła partii raportów, aby uzyskać lepszą wydajność.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-142">Configuration knobs batch reports for improved performance.</span></span>

> [!NOTE]
> <span data-ttu-id="6bbb0-143">Raport kondycji jest synchroniczne, i reprezentuje tylko hello weryfikacji pracy na powitania po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-143">Report health is synchronous, and it represents only hello validation work on hello client side.</span></span> <span data-ttu-id="6bbb0-144">Witaj fakt, że hello raportu jest akceptowane przez hello kondycji klienta lub hello `Partition` lub `CodePackageActivationContext` obiektów nie oznacza, że jest ono stosowane w magazynie hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-144">hello fact that hello report is accepted by hello health client or hello `Partition` or `CodePackageActivationContext` objects doesn't mean that it is applied in hello store.</span></span> <span data-ttu-id="6bbb0-145">Jest wysyłane asynchronicznie, być może umieścić w zadaniu wsadowym razem z innymi raportami.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-145">It is sent asynchronously and possibly batched with other reports.</span></span> <span data-ttu-id="6bbb0-146">Hello przetwarzania na serwerze hello nadal może zakończyć się niepowodzeniem: numer sekwencyjny hello może być stałe, jednostki hello na powitania, które należy zastosować raport został usunięty, itp.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-146">hello processing on hello server may still fail: hello sequence number could be stale, hello entity on which hello report must be applied has been deleted, etc.</span></span>
> 
> 

## <a name="health-client"></a><span data-ttu-id="6bbb0-147">Kondycji klienta</span><span class="sxs-lookup"><span data-stu-id="6bbb0-147">Health client</span></span>
<span data-ttu-id="6bbb0-148">Raporty kondycji Hello są wysyłane toohello magazynu kondycji za pomocą klienta kondycji, które znajdują się wewnątrz powitania klienta sieci szkieletowej.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-148">hello health reports are sent toohello health store through a health client, which lives inside hello fabric client.</span></span> <span data-ttu-id="6bbb0-149">Witaj kondycji klienta można skonfigurować za pomocą hello następujące ustawienia:</span><span class="sxs-lookup"><span data-stu-id="6bbb0-149">hello health client can be configured with hello following settings:</span></span>

* <span data-ttu-id="6bbb0-150">**HealthReportSendInterval**: hello opóźnienia między hello czasie — raport hello jest dodany toohello klienta i hello czasu jest wysyłane toohello magazynu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-150">**HealthReportSendInterval**: hello delay between hello time hello report is added toohello client and hello time it is sent toohello health store.</span></span> <span data-ttu-id="6bbb0-151">Raporty toobatch używanych w pojedynczym komunikacie zamiast wysyłania jeden komunikat dla każdego raportu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-151">Used toobatch reports into a single message, rather than sending one message for each report.</span></span> <span data-ttu-id="6bbb0-152">Przetwarzanie wsadowe Hello poprawia wydajność.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-152">hello batching improves performance.</span></span> <span data-ttu-id="6bbb0-153">Wartość domyślna: 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-153">Default: 30 seconds.</span></span>
* <span data-ttu-id="6bbb0-154">**HealthReportRetrySendInterval**: interwał powitania, w których hello kondycji klienta wysyła ponownie kondycji wszystkich raportów toohello magazynu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-154">**HealthReportRetrySendInterval**: hello interval at which hello health client resends accumulated health reports toohello health store.</span></span> <span data-ttu-id="6bbb0-155">Wartość domyślna: 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-155">Default: 30 seconds.</span></span>
* <span data-ttu-id="6bbb0-156">**HealthOperationTimeout**: hello limit czasu dla komunikatu raport wysyłany toohello magazynu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-156">**HealthOperationTimeout**: hello timeout period for a report message sent toohello health store.</span></span> <span data-ttu-id="6bbb0-157">Jeśli upłynie limit czasu wiadomości, hello kondycji klient ponawia próbę go do momentu magazynu kondycji hello potwierdza hello raport został przetworzony.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-157">If a message times out, hello health client retries it until hello health store confirms that hello report has been processed.</span></span> <span data-ttu-id="6bbb0-158">Wartość domyślna: dwie minuty.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-158">Default: two minutes.</span></span>

> [!NOTE]
> <span data-ttu-id="6bbb0-159">Gdy są przetwarzane wsadowo hello raporty, powitania klienta programu fabric musi utrzymywać ich aktywność dla co najmniej hello tooensure HealthReportSendInterval, które są wysyłane.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-159">When hello reports are batched, hello fabric client must be kept alive for at least hello HealthReportSendInterval tooensure that they are sent.</span></span> <span data-ttu-id="6bbb0-160">Jeśli wiadomość hello zostało utracone lub hello magazynu kondycji nie może zastosować je ze względu na błędy tootransient, powitania klienta sieci szkieletowej muszą być przechowywane aktywności toogive dłużej go tooretry szansy.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-160">If hello message is lost or hello health store cannot apply them due tootransient errors, hello fabric client must be kept alive longer toogive it a chance tooretry.</span></span>
> 
> 

<span data-ttu-id="6bbb0-161">buforowanie Hello na powitania klienta ma unikatowości hello hello raportów pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-161">hello buffering on hello client takes hello uniqueness of hello reports into consideration.</span></span> <span data-ttu-id="6bbb0-162">Na przykład określonego zły osoby zgłaszającej zgłoszenie 100 raportów na sekundę na powitania sama właściwość hello tej samej jednostki, hello raporty są zamieniane na powitania ostatniej wersji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-162">For example, if a particular bad reporter is reporting 100 reports per second on hello same property of hello same entity, hello reports are replaced with hello last version.</span></span> <span data-ttu-id="6bbb0-163">Istnieje co najwyżej jeden taki raport w kolejce klienta hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-163">At most one such report exists in hello client queue.</span></span> <span data-ttu-id="6bbb0-164">Jeśli skonfigurowano przetwarzanie wsadowe hello liczbę raportów wysłano toohello magazynu kondycji jest tylko jeden interwał wysyłania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-164">If batching is configured, hello number of reports sent toohello health store is just one per send interval.</span></span> <span data-ttu-id="6bbb0-165">Ten raport jest hello ostatniego dodany raport, która odzwierciedla hello najbardziej bieżącego stanu jednostki hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-165">This report is hello last added report, which reflects hello most current state of hello entity.</span></span>
<span data-ttu-id="6bbb0-166">Określ parametry konfiguracji po `FabricClient` jest tworzony przez przekazanie [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) z hello żądane wartości dla wpisy dotyczące kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-166">Specify configuration parameters when `FabricClient` is created by passing [FabricClientSettings](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclientsettings) with hello desired values for health-related entries.</span></span>

<span data-ttu-id="6bbb0-167">Witaj poniższy przykład tworzy klienta sieci szkieletowej i określa, czy mają być wysyłane raporty hello po ich dodaniu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-167">hello following example creates a fabric client and specifies that hello reports should be sent when they are added.</span></span> <span data-ttu-id="6bbb0-168">Limity czasu i błędy, które można ponowić ponownych prób nastąpić co 40 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-168">On timeouts and errors that can be retried, retries happen every 40 seconds.</span></span>

```csharp
var clientSettings = new FabricClientSettings()
{
    HealthOperationTimeout = TimeSpan.FromSeconds(120),
    HealthReportSendInterval = TimeSpan.FromSeconds(0),
    HealthReportRetrySendInterval = TimeSpan.FromSeconds(40),
};
var fabricClient = new FabricClient(clientSettings);
```

<span data-ttu-id="6bbb0-169">Zaleca się pozostawienie sieci szkieletowej domyślne hello ustawienia klienta, które `HealthReportSendInterval` too30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-169">We recommend keeping hello default fabric client settings, which set `HealthReportSendInterval` too30 seconds.</span></span> <span data-ttu-id="6bbb0-170">To ustawienie zapewni optymalną wydajność toobatching ukończenia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-170">This setting ensures optimal performance due toobatching.</span></span> <span data-ttu-id="6bbb0-171">Krytyczne raportów, które muszą zostać przesłane tak szybko, jak to możliwe, należy użyć `HealthReportSendOptions` z Immediate `true` w [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-171">For critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true` in [FabricClient.HealthClient.ReportHealth](https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.healthclient.reporthealth) API.</span></span> <span data-ttu-id="6bbb0-172">Raporty natychmiastowego obejścia hello przetwarzanie wsadowe interwału.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-172">Immediate reports bypass hello batching interval.</span></span> <span data-ttu-id="6bbb0-173">Użyj tej flagi ostrożność; chcemy tootake zaletą hello kondycji klienta przetwarzanie wsadowe, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-173">Use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span> <span data-ttu-id="6bbb0-174">Natychmiastowe wysyłania jest również przydatny podczas zamykania powitania klienta sieci szkieletowej (na przykład procesu hello wykrył nieprawidłowy stan i musi tooshut tooprevent efekty uboczne w dół).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-174">Immediate send is also useful when hello fabric client is closing (for example, hello process has determined invalid state and needs tooshut down tooprevent side effects).</span></span> <span data-ttu-id="6bbb0-175">Zapewnia send optymalnych hello zebranych raportów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-175">It ensures a best-effort send of hello accumulated reports.</span></span> <span data-ttu-id="6bbb0-176">Po dodaniu jeden raport z flagą natychmiastowego hello kondycji klienta partii wszystkie raporty hello zgromadzonych od czasu ostatniego wysłania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-176">When one report is added with Immediate flag, hello health client batches all hello accumulated reports since last send.</span></span>

<span data-ttu-id="6bbb0-177">Takie same parametry można określić podczas tworzenia klastra tooa połączenia za pomocą programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-177">Same parameters can be specified when a connection tooa cluster is created through PowerShell.</span></span> <span data-ttu-id="6bbb0-178">Poniższy przykład Hello uruchamia klastra lokalnego tooa połączenia:</span><span class="sxs-lookup"><span data-stu-id="6bbb0-178">hello following example starts a connection tooa local cluster:</span></span>

```powershell
PS C:\> Connect-ServiceFabricCluster -HealthOperationTimeoutInSec 120 -HealthReportSendIntervalInSec 0 -HealthReportRetrySendIntervalInSec 40
True

ConnectionEndpoint   :
FabricClientSettings : {
                       ClientFriendlyName                   : PowerShell-1944858a-4c6d-465f-89c7-9021c12ac0bb
                       PartitionLocationCacheLimit          : 100000
                       PartitionLocationCacheBucketCount    : 1024
                       ServiceChangePollInterval            : 00:02:00
                       ConnectionInitializationTimeout      : 00:00:02
                       KeepAliveInterval                    : 00:00:20
                       HealthOperationTimeout               : 00:02:00
                       HealthReportSendInterval             : 00:00:00
                       HealthReportRetrySendInterval        : 00:00:40
                       NotificationGatewayConnectionTimeout : 00:00:00
                       NotificationCacheUpdateTimeout       : 00:00:00
                       }
GatewayInformation   : {
                       NodeAddress                          : localhost:19000
                       NodeId                               : 1880ec88a3187766a6da323399721f53
                       NodeInstanceId                       : 130729063464981219
                       NodeName                             : Node.1
                       }
```

<span data-ttu-id="6bbb0-179">Podobnie tooAPI, raporty można wysyłać przy użyciu `-Immediate` przełącznika toobe wysyłane natychmiast, niezależnie od hello `HealthReportSendInterval` wartość.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-179">Similarly tooAPI, reports can be sent using `-Immediate` switch toobe sent immediately, regardless of hello `HealthReportSendInterval` value.</span></span>

<span data-ttu-id="6bbb0-180">Dla pozostałych hello raporty są wysyłane bramy sieci szkieletowej usług toohello, którego klient wewnętrznej sieci szkieletowej.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-180">For REST, hello reports are sent toohello Service Fabric gateway, which has an internal fabric client.</span></span> <span data-ttu-id="6bbb0-181">Domyślnie ten klient jest skonfigurowany toosend raporty umieścić w zadaniu wsadowym co 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-181">By default, this client is configured toosend reports batched every 30 seconds.</span></span> <span data-ttu-id="6bbb0-182">Interwał partii powitania można zmienić za pomocą ustawienia konfiguracji klastra hello `HttpGatewayHealthReportSendInterval` na `HttpGateway`.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-182">You can change hello batch interval with hello cluster configuration setting `HttpGatewayHealthReportSendInterval` on `HttpGateway`.</span></span> <span data-ttu-id="6bbb0-183">Jak wspomniano, lepszym rozwiązaniem jest toosend hello raporty z `Immediate` wartość true.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-183">As mentioned, a better option is toosend hello reports with `Immediate` true.</span></span> 

> [!NOTE]
> <span data-ttu-id="6bbb0-184">tooensure, który nieautoryzowany usługi nie można utworzyć raportu kondycji przed hello jednostek w klastrze hello, skonfiguruj powitania serwera tooaccept żądania tylko zabezpieczonych klientów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-184">tooensure that unauthorized services can't report health against hello entities in hello cluster, configure hello server tooaccept requests only from secured clients.</span></span> <span data-ttu-id="6bbb0-185">Witaj `FabricClient` używane na potrzeby raportowania musi mieć z włączonymi zabezpieczeniami toobe toocommunicate stanie hello klastra (na przykład z uwierzytelnianiem Kerberos lub certyfikatów).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-185">hello `FabricClient` used for reporting must have security enabled toobe able toocommunicate with hello cluster (for example, with Kerberos or certificate authentication).</span></span> <span data-ttu-id="6bbb0-186">Przeczytaj więcej na temat [klastra zabezpieczeń](service-fabric-cluster-security.md).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-186">Read more about [cluster security](service-fabric-cluster-security.md).</span></span>
> 
> 

## <a name="report-from-within-low-privilege-services"></a><span data-ttu-id="6bbb0-187">Raport z niskim poziomem uprawnień Services</span><span class="sxs-lookup"><span data-stu-id="6bbb0-187">Report from within low privilege services</span></span>
<span data-ttu-id="6bbb0-188">Usługa sieci szkieletowej usług nie ma klastra toohello dostępu administratora, możesz zgłosić kondycji na jednostek z bieżącego kontekstu hello za pośrednictwem `Partition` lub `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-188">If Service Fabric services do not have admin access toohello cluster, you can report health on entities from hello current context through `Partition` or `CodePackageActivationContext`.</span></span>

* <span data-ttu-id="6bbb0-189">W przypadku usług bezstanowych użyj [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport na powitania bieżącego wystąpienia usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-189">For stateless services, use [IStatelessServicePartition.ReportInstanceHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatelessservicepartition.reportinstancehealth) tooreport on hello current service instance.</span></span>
* <span data-ttu-id="6bbb0-190">Usługi stanowej, użyj [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport na bieżącej repliki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-190">For stateful services, use [IStatefulServicePartition.ReportReplicaHealth](https://docs.microsoft.com/dotnet/api/system.fabric.istatefulservicepartition.reportreplicahealth) tooreport on current replica.</span></span>
* <span data-ttu-id="6bbb0-191">Użyj [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport na powitania bieżącego obiektu partycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-191">Use [IServicePartition.ReportPartitionHealth](https://docs.microsoft.com/dotnet/api/system.fabric.iservicepartition.reportpartitionhealth) tooreport on hello current partition entity.</span></span>
* <span data-ttu-id="6bbb0-192">Użyj [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport w bieżącej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-192">Use [CodePackageActivationContext.ReportApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportapplicationhealth) tooreport on current application.</span></span>
* <span data-ttu-id="6bbb0-193">Użyj [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport w bieżącej aplikacji hello wdrożone na powitania bieżącego węzła.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-193">Use [CodePackageActivationContext.ReportDeployedApplicationHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedapplicationhealth) tooreport on hello current application deployed on hello current node.</span></span>
* <span data-ttu-id="6bbb0-194">Użyj [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport na pakiet usługi dla aplikacji hello wdrożone na powitania bieżącego węzła.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-194">Use [CodePackageActivationContext.ReportDeployedServicePackageHealth](https://docs.microsoft.com/dotnet/api/system.fabric.codepackageactivationcontext.reportdeployedservicepackagehealth) tooreport on a service package for hello application deployed on hello current node.</span></span>

> [!NOTE]
> <span data-ttu-id="6bbb0-195">Witaj, `Partition` i hello `CodePackageActivationContext` przechowywania kondycji klient skonfigurowany przy użyciu ustawień domyślnych.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-195">Internally, hello `Partition` and hello `CodePackageActivationContext` hold a health client configured with default settings.</span></span> <span data-ttu-id="6bbb0-196">Zgodnie z objaśnieniem dla hello [kondycji klienta](service-fabric-report-health.md#health-client), raporty są umieszczane w partii i wysyłane przez czasomierz.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-196">As explained for hello [health client](service-fabric-report-health.md#health-client), reports are batched and sent on a timer.</span></span> <span data-ttu-id="6bbb0-197">obiekty Hello powinny być przechowywane aktywności toohave raportu hello toosend szansy.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-197">hello objects should be kept alive toohave a chance toosend hello report.</span></span>
> 
> 

<span data-ttu-id="6bbb0-198">Można określić `HealthReportSendOptions` podczas wysyłania raportów za pośrednictwem `Partition` i `CodePackageActivationContext` kondycji interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-198">You can specify `HealthReportSendOptions` when sending reports through `Partition` and `CodePackageActivationContext` health APIs.</span></span> <span data-ttu-id="6bbb0-199">Jeśli masz krytyczne raportów, które muszą zostać przesłane tak szybko, jak to możliwe, użyj `HealthReportSendOptions` z Immediate `true`.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-199">If you have critical reports that must be sent as soon as possible, use `HealthReportSendOptions` with Immediate `true`.</span></span> <span data-ttu-id="6bbb0-200">Raporty natychmiastowego obejścia hello przetwarzanie wsadowe interwał hello wewnętrzny kondycji klienta.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-200">Immediate reports bypass hello batching interval of hello internal health client.</span></span> <span data-ttu-id="6bbb0-201">Jak wspomniano wcześniej, użyj tej flagi ostrożność; chcemy tootake zaletą hello kondycji klienta przetwarzanie wsadowe, jeśli to możliwe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-201">As mentioned before, use this flag with care; we want tootake advantage of hello health client batching whenever possible.</span></span>

## <a name="design-health-reporting"></a><span data-ttu-id="6bbb0-202">Projektowanie raportowania kondycji</span><span class="sxs-lookup"><span data-stu-id="6bbb0-202">Design health reporting</span></span>
<span data-ttu-id="6bbb0-203">Witaj pierwszym krokiem podczas generowania raportów wysokiej jakości identyfikuje hello warunki, które może wpłynąć na kondycję hello hello usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-203">hello first step in generating high-quality reports is identifying hello conditions that can impact hello health of hello service.</span></span> <span data-ttu-id="6bbb0-204">Wszelkie warunek, który może pomóc flagi problemów w usłudze hello lub klastra podczas jego uruchamiania--lub lepszy, zanim się stanie, problem — może potencjalnie zapisać miliardów dolarów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-204">Any condition that can help flag problems in hello service or cluster when it starts--or even better, before a problem happens--can potentially save billions of dollars.</span></span> <span data-ttu-id="6bbb0-205">Hello zalety mniej czas przestoju, mniejszą liczbę godzin nocy poświęcony na wykrywanie i naprawianie problemów i wyższe zadowolenia klienta.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-205">hello benefits include less down time, fewer night hours spent investigating and repairing issues, and higher customer satisfaction.</span></span>

<span data-ttu-id="6bbb0-206">Po zidentyfikowaniu warunki hello autorzy programu alarmowego muszą toofigure limit hello najlepsze sposób toomonitor je na równowaga między koszty i użyteczność.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-206">Once hello conditions are identified, watchdog writers need toofigure out hello best way toomonitor them for balance between overhead and usefulness.</span></span> <span data-ttu-id="6bbb0-207">Rozważmy na przykład usługi, który wykonuje obliczenia złożonych, które używają niektóre pliki tymczasowe w udziale.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-207">For example, consider a service that does complex calculations that use some temporary files on a share.</span></span> <span data-ttu-id="6bbb0-208">Programu alarmowego można monitorować hello udziału tooensure, że jest dostępna wystarczająca ilość miejsca.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-208">A watchdog could monitor hello share tooensure that enough space is available.</span></span> <span data-ttu-id="6bbb0-209">Można go nasłuchiwania powiadomień o zmianach pliku lub katalogu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-209">It could listen for notifications of file or directory changes.</span></span> <span data-ttu-id="6bbb0-210">Można go raportować ostrzeżenie, jeśli próg góry, a zgłaszać błąd, gdy udział hello jest pełna.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-210">It could report a warning if an upfront threshold is reached, and report an error if hello share is full.</span></span> <span data-ttu-id="6bbb0-211">Na ostrzeżenie, można uruchomić system naprawy, czyszczenie starszych plików w udziale hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-211">On a warning, a repair system could start cleaning up older files on hello share.</span></span> <span data-ttu-id="6bbb0-212">W przypadku wystąpienia błędu systemu naprawy można przenieść węzła tooanother repliki usługi hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-212">On an error, a repair system could move hello service replica tooanother node.</span></span> <span data-ttu-id="6bbb0-213">Należy pamiętać, opisu stanów warunku hello pod względem kondycji: hello stan hello warunek, który jest uznawana za dobrej kondycji (ok) lub złej kondycji (ostrzeżenia lub błędu).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-213">Note how hello condition states are described in terms of health: hello state of hello condition that can be considered healthy (ok) or unhealthy (warning or error).</span></span>

<span data-ttu-id="6bbb0-214">Po ustawieniu hello szczegóły monitorowania, moduł zapisujący programu alarmowego musi toofigure się jak tooimplement hello programu alarmowego.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-214">Once hello monitoring details are set, a watchdog writer needs toofigure out how tooimplement hello watchdog.</span></span> <span data-ttu-id="6bbb0-215">Jeśli warunki hello można ustalić na podstawie w ramach usługi hello, programu alarmowego hello mogą być częścią sama usługa hello monitorowane.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-215">If hello conditions can be determined from within hello service, hello watchdog can be part of hello monitored service itself.</span></span> <span data-ttu-id="6bbb0-216">Na przykład hello kodu usługi można sprawdzanie hello udziału, a następnie składają raporty za każdym razem, gdy próbuje toowrite pliku.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-216">For example, hello service code can check hello share usage, and then report every time it tries toowrite a file.</span></span> <span data-ttu-id="6bbb0-217">Witaj zaletą tej metody jest raportowania proste.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-217">hello advantage of this approach is that reporting is simple.</span></span> <span data-ttu-id="6bbb0-218">Należy zachować ostrożność usterki programu alarmowego tooprevent z wpływu na funkcjonalność usługi hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-218">Care must be taken tooprevent watchdog bugs from impacting hello service functionality.</span></span>

<span data-ttu-id="6bbb0-219">Raportowania w ramach usługi monitorowane hello nie zawsze jest opcją.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-219">Reporting from within hello monitored service is not always an option.</span></span> <span data-ttu-id="6bbb0-220">Strażnika w ramach usługi hello może nie być możliwe toodetect hello warunków.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-220">A watchdog within hello service may not be able toodetect hello conditions.</span></span> <span data-ttu-id="6bbb0-221">Nie może mieć hello logikę i dane toomake hello określenie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-221">It may not have hello logic or data toomake hello determination.</span></span> <span data-ttu-id="6bbb0-222">koszty Hello monitorowania warunków hello może być wysokie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-222">hello overhead of monitoring hello conditions may be high.</span></span> <span data-ttu-id="6bbb0-223">warunki Hello również może nie być tooa określonej usługi, ale zamiast tego na interakcje między usługami.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-223">hello conditions also may not be specific tooa service, but instead affect interactions between services.</span></span> <span data-ttu-id="6bbb0-224">Innym rozwiązaniem jest watchdogs toohave w klastrze hello jako osobne procesy.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-224">Another option is toohave watchdogs in hello cluster as separate processes.</span></span> <span data-ttu-id="6bbb0-225">Hello watchdogs monitorowanie warunków hello i raport, bez wywierania wpływu na powitania usług w dowolny sposób.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-225">hello watchdogs monitor hello conditions and report, without affecting hello main services in any way.</span></span> <span data-ttu-id="6bbb0-226">Na przykład watchdogs te można zaimplementowane jako usługi bezstanowej w hello tej samej aplikacji wdrożone na wszystkich węzłach lub hello samych węzłów jako usługa hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-226">For example, these watchdogs could be implemented as stateless services in hello same application, deployed on all nodes or on hello same nodes as hello service.</span></span>

<span data-ttu-id="6bbb0-227">Czasami programu alarmowego uruchomiona w klastrze hello nie jest opcją albo.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-227">Sometimes, a watchdog running in hello cluster is not an option either.</span></span> <span data-ttu-id="6bbb0-228">Gdy warunek hello monitorowane jest dostępności hello lub funkcji usługi hello użytkownicy widzą go, jest najlepszym watchdogs hello toohave w hello w tym samym miejscu jako hello użytkownika klientów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-228">If hello monitored condition is hello availability or functionality of hello service as users see it, it's best toohave hello watchdogs in hello same place as hello user clients.</span></span> <span data-ttu-id="6bbb0-229">Istnieje, można przetestować operacji hello w hello tych samych użytkowników sposób połączeń telefonicznych z nimi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-229">There, they can test hello operations in hello same way users call them.</span></span> <span data-ttu-id="6bbb0-230">Na przykład można mieć programu alarmowego, znajduje się poza klastrem hello, wystawia żądań toohello usługi i sprawdza hello opóźnienia i poprawność wyników hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-230">For example, you can have a watchdog that lives outside hello cluster, issues requests toohello service, and checks hello latency and correctness of hello result.</span></span> <span data-ttu-id="6bbb0-231">(Dla usługi Kalkulator, na przykład 2 + 2 zwróci 4 w rozsądnym czasie?)</span><span class="sxs-lookup"><span data-stu-id="6bbb0-231">(For a calculator service, for example, does 2+2 return 4 in a reasonable amount of time?)</span></span>

<span data-ttu-id="6bbb0-232">Po sfinalizowany szczegóły dotyczące programu alarmowego hello, należy podjąć decyzję dotyczącą na identyfikator źródła, który unikatowo identyfikuje go.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-232">Once hello watchdog details have been finalized, you should decide on a source ID that uniquely identifies it.</span></span> <span data-ttu-id="6bbb0-233">Jeśli wiele watchdogs z hello mieszkają tego samego typu w hello klastra, klienci muszą raportu na różnych jednostkach, lub, jeśli ich raport dotyczący hello tej samej jednostki, użyj innego źródła Identyfikatora lub właściwości.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-233">If multiple watchdogs of hello same type are living in hello cluster, they must report on different entities, or, if they report on hello same entity, use different source ID or property.</span></span> <span data-ttu-id="6bbb0-234">W ten sposób ich raporty mogą współistnieć.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-234">This way, their reports can coexist.</span></span> <span data-ttu-id="6bbb0-235">Właściwość Hello raport o kondycji hello powinien przechwytywania warunku hello monitorowane.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-235">hello property of hello health report should capture hello monitored condition.</span></span> <span data-ttu-id="6bbb0-236">(Na przykład hello powyżej, może być właściwości hello **ShareSize**.) Jeśli wiele raportów stosować toohello sam warunek, hello właściwość powinna zawierać informacje dynamiczne umożliwia toocoexist raportów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-236">(For hello example above, hello property could be **ShareSize**.) If multiple reports apply toohello same condition, hello property should contain some dynamic information that allows reports toocoexist.</span></span> <span data-ttu-id="6bbb0-237">Na przykład, jeśli wiele udziałów muszą toobe monitorowane, nazwa właściwości hello może być **ShareSize sharename**.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-237">For example, if multiple shares need toobe monitored, hello property name can be **ShareSize-sharename**.</span></span>

> [!NOTE]
> <span data-ttu-id="6bbb0-238">Czy *nie* Użyj informacji o stanie tookeep hello kondycji magazynu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-238">Do *not* use hello health store tookeep status information.</span></span> <span data-ttu-id="6bbb0-239">Należy podać tylko informacje dotyczące kondycji jako kondycji jako tej oceny kondycji informacji wpływa na powitania jednostki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-239">Only health-related information should be reported as health, as this information impacts hello health evaluation of an entity.</span></span> <span data-ttu-id="6bbb0-240">magazynu kondycji Hello nie został zaprojektowany jako magazynu ogólnego przeznaczenia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-240">hello health store was not designed as a general-purpose store.</span></span> <span data-ttu-id="6bbb0-241">Używa tooaggregate logiki oceny kondycji wszystkich danych do stanu kondycji hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-241">It uses health evaluation logic tooaggregate all data into hello health state.</span></span> <span data-ttu-id="6bbb0-242">Wysyłanie informacji niepowiązanych toohealth (takich jak raportowanie stanu ze stanem kondycji OK) bez wpływu na powitania zagregowane stan kondycji, ale może negatywnie wpłynąć na wydajność magazynu kondycji hello hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-242">Sending information unrelated toohealth (like reporting status with a health state of OK) doesn't impact hello aggregated health state, but it can negatively affect hello performance of hello health store.</span></span>
> 
> 

<span data-ttu-id="6bbb0-243">Hello dalej podjęcie decyzji, czy znajduje się na które tooreport jednostki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-243">hello next decision point is which entity tooreport on.</span></span> <span data-ttu-id="6bbb0-244">W większości przypadków hello warunku hello wyraźnie idetifies hello jednostki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-244">Most of hello time, hello condition clearly idetifies hello entity.</span></span> <span data-ttu-id="6bbb0-245">Wybierz jednostki hello z najlepsze możliwe stopnia szczegółowości.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-245">Choose hello entity with best possible granularity.</span></span> <span data-ttu-id="6bbb0-246">Jeśli warunek ma wpływ na wszystkie repliki na partycji, raport dotyczący hello partycji, nie na powitania usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-246">If a condition impacts all replicas in a partition, report on hello partition, not on hello service.</span></span> <span data-ttu-id="6bbb0-247">Brak sytuacjach wyjątkowych, gdy potrzebne jest więcej myśl, mimo że.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-247">There are corner cases where more thought is needed, though.</span></span> <span data-ttu-id="6bbb0-248">Jeśli warunek hello ma wpływ na jednostkę, takich jak repliki, ale hello desire jest warunek hello toohave oflagowane więcej niż czas trwania hello życia repliki, należy podać na powitania partycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-248">If hello condition impacts an entity, such as a replica, but hello desire is toohave hello condition flagged for more than hello duration of replica life, then it should be reported on hello partition.</span></span> <span data-ttu-id="6bbb0-249">W przeciwnym razie po usunięciu hello repliki magazynu kondycji hello czyści jego raporty.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-249">Otherwise, when hello replica is deleted, hello health store cleans up all its reports.</span></span> <span data-ttu-id="6bbb0-250">Autorzy programu alarmowego muszą myśleć o hello okresy istnienia hello jednostki i hello raportu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-250">Watchdog writers must think about hello lifetimes of hello entity and hello report.</span></span> <span data-ttu-id="6bbb0-251">Musi być jasne podczas raportu należy oczyścić z magazynu (na przykład błędu zgłoszonego z jednostką już ma zastosowanie).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-251">It must be clear when a report should be cleaned up from a store (for example, when an error reported on an entity no longer applies).</span></span>

<span data-ttu-id="6bbb0-252">Oto przykład, w którym umieszcza ze sobą, I opisano punktów hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-252">Let's look at an example that puts together hello points I described.</span></span> <span data-ttu-id="6bbb0-253">Należy rozważyć aplikacji usługi sieć szkieletowa składa się z głównym usługi stanowej trwałe i dodatkowej usługi bezstanowej wdrożone na wszystkich węzłach (jeden typ dodatkowej usługi dla poszczególnych typów zadań).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-253">Consider a Service Fabric application composed of a master stateful persistent service and secondary stateless services deployed on all nodes (one secondary service type for each type of task).</span></span> <span data-ttu-id="6bbb0-254">wzorzec Hello ma kolejki przetwarzania zawierającej toobe polecenia wykonywane przez pomocnicze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-254">hello master has a processing queue that contains commands toobe executed by secondaries.</span></span> <span data-ttu-id="6bbb0-255">Hello pomocnicze bazy danych wykonaj hello żądań przychodzących i wysyłanie sygnałów wstecz potwierdzenia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-255">hello secondaries execute hello incoming requests and send back acknowledgement signals.</span></span> <span data-ttu-id="6bbb0-256">Jeden warunek, który może być monitorowany jest hello hello kolejki przetwarzania wzorca.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-256">One condition that could be monitored is hello length of hello master processing queue.</span></span> <span data-ttu-id="6bbb0-257">Jeśli długość kolejki głównej hello osiągnie próg, ostrzeżenie jest raportowana.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-257">If hello master queue length reaches a threshold, a warning is reported.</span></span> <span data-ttu-id="6bbb0-258">Ostrzeżenie Hello wskazuje, że hello pomocnicze bazy danych nie może obsłużyć obciążenia hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-258">hello warning indicates that hello secondaries can't handle hello load.</span></span> <span data-ttu-id="6bbb0-259">Jeśli kolejki hello osiągnie hello maksymalną długość polecenia są usuwane, jest zgłaszany błąd, jako hello usługi nie można odzyskać.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-259">If hello queue reaches hello maximum length and commands are dropped, an error is reported, as hello service can't recover.</span></span> <span data-ttu-id="6bbb0-260">Witaj raporty mogą być we właściwości hello **QueueStatus**.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-260">hello reports can be on hello property **QueueStatus**.</span></span> <span data-ttu-id="6bbb0-261">programu alarmowego Hello znajdują się wewnątrz hello usługi i jest okresowo przesyłane na powitania wzorca repliki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-261">hello watchdog lives inside hello service, and it's sent periodically on hello master primary replica.</span></span> <span data-ttu-id="6bbb0-262">czas Hello toolive wynosi dwie minuty, a wysłaniem okresowo co 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-262">hello time toolive is two minutes, and it's sent periodically every 30 seconds.</span></span> <span data-ttu-id="6bbb0-263">Jeśli hello podstawowy ulegnie awarii, raport hello jest automatycznie czyszczone z magazynu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-263">If hello primary goes down, hello report is cleaned up automatically from store.</span></span> <span data-ttu-id="6bbb0-264">Jeśli repliki usługi hello jest uruchomiony, ale jest typu lub inne problemy, hello raportu wygaśnie w magazynie kondycji hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-264">If hello service replica is up, but it is deadlocked or having other issues, hello report expires in hello health store.</span></span> <span data-ttu-id="6bbb0-265">W takim przypadku jednostki hello jest oceniane w błąd.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-265">In this case, hello entity is evaluated at error.</span></span>

<span data-ttu-id="6bbb0-266">Inny warunek, który może być monitorowany jest czas wykonania zadania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-266">Another condition that can be monitored is task execution time.</span></span> <span data-ttu-id="6bbb0-267">Witaj wzorca dystrybuuje zadania toohello pomocnicze bazy danych na podstawie hello zadań typu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-267">hello master distributes tasks toohello secondaries based on hello task type.</span></span> <span data-ttu-id="6bbb0-268">W zależności od projektu hello wzorca hello można sondować hello pomocnicze bazy danych dla stanu zadania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-268">Depending on hello design, hello master could poll hello secondaries for task status.</span></span> <span data-ttu-id="6bbb0-269">Po wykonaniu go można również poczekaj sygnały wstecz potwierdzenia toosend pomocnicze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-269">It could also wait for secondaries toosend back acknowledgement signals when they are done.</span></span> <span data-ttu-id="6bbb0-270">W drugim przypadku hello należy uważać sytuacjach toodetect gdzie struktury pomocnicze bazy danych lub komunikaty zostaną utracone.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-270">In hello second case, care must be taken toodetect situations where secondaries die or messages are lost.</span></span> <span data-ttu-id="6bbb0-271">Jedną z opcji jest dla wzorca toosend hello toohello żądanie ping sam dodatkowej, której odsyła jego stan.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-271">One option is for hello master toosend a ping request toohello same secondary, which sends back its status.</span></span> <span data-ttu-id="6bbb0-272">Jeśli brak stan nie zostanie odebrana, głównego hello uzna awarii i zmienia harmonogram zadań hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-272">If no status is received, hello master considers it a failure and reschedules hello task.</span></span> <span data-ttu-id="6bbb0-273">To zachowanie zakłada, że zadania hello są idempotentności.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-273">This behavior assumes that hello tasks are idempotent.</span></span>

<span data-ttu-id="6bbb0-274">warunek Hello monitorowane można przekonwertować jako ostrzeżenie, jeśli zadanie hello nie odbywa się w określonym czasie (**t1**, na przykład 10 minut).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-274">hello monitored condition can be translated as a warning if hello task is not done in a certain time (**t1**, for example 10 minutes).</span></span> <span data-ttu-id="6bbb0-275">Jeśli hello zadanie nie zostało ukończone w czasie (**t2**, na przykład 20 minut), hello monitorowane warunku można przetłumaczyć jako błąd.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-275">If hello task is not completed in time (**t2**, for example 20 minutes), hello monitored condition can be translated as Error.</span></span> <span data-ttu-id="6bbb0-276">Ta raportowania może odbywać się na wiele sposobów:</span><span class="sxs-lookup"><span data-stu-id="6bbb0-276">This reporting can be done in multiple ways:</span></span>

* <span data-ttu-id="6bbb0-277">repliki podstawowej wzorca Hello raporty okresowo od siebie samego.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-277">hello master primary replica reports on itself periodically.</span></span> <span data-ttu-id="6bbb0-278">Może mieć jedną właściwość dla wszystkich zadań oczekujących w kolejce hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-278">You can have one property for all pending tasks in hello queue.</span></span> <span data-ttu-id="6bbb0-279">Jeśli co najmniej jedno zadanie trwa dłużej, stan raportu hello we właściwości hello **PendingTasks** jest ostrzeżenia lub błędu, zależnie od potrzeb.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-279">If at least one task takes longer, hello report status on hello property **PendingTasks** is a warning or error, as appropriate.</span></span> <span data-ttu-id="6bbb0-280">Jeśli nie ma żadnych oczekujących zadań lub wszystkich zadań rozpoczął wykonywanie sekwencji, stan raportu hello jest OK.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-280">If there are no pending tasks or all tasks started execution, hello report status is OK.</span></span> <span data-ttu-id="6bbb0-281">zadania Hello są trwałe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-281">hello tasks are persistent.</span></span> <span data-ttu-id="6bbb0-282">Jeśli hello podstawowy ulegnie awarii, hello nowo podwyższenia poziomu podstawowego nadal tooreport poprawnie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-282">If hello primary goes down, hello newly promoted primary can continue tooreport properly.</span></span>
* <span data-ttu-id="6bbb0-283">Inny proces programu alarmowego (w chmurze hello lub zewnętrznego) sprawdza hello zadania (z zewnątrz, na podstawie hello żądanego wyniku zadania) toosee, jeśli zostały one zakończone.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-283">Another watchdog process (in hello cloud or external) checks hello tasks (from outside, based on hello desired task result) toosee if they are completed.</span></span> <span data-ttu-id="6bbb0-284">Jeśli ich nie przestrzega hello progów, raport jest wysyłany na powitania głównej usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-284">If they do not respect hello thresholds, a report is sent on hello master service.</span></span> <span data-ttu-id="6bbb0-285">Raport jest również przesyłany dla każdego zadania, który obejmuje hello identyfikatora zadania, takie jak **PendingTask + taskId**.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-285">A report is also sent on each task that includes hello task identifier, like **PendingTask+taskId**.</span></span> <span data-ttu-id="6bbb0-286">Raporty mają być wysyłane tylko w stan złej kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-286">Reports should be sent only on unhealthy states.</span></span> <span data-ttu-id="6bbb0-287">Ustaw czas toolive tooa kilka minut i oznacz toobe raporty hello usuwane, gdy wygasną tooensure oczyszczania.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-287">Set time toolive tooa few minutes, and mark hello reports toobe removed when they expire tooensure cleanup.</span></span>
* <span data-ttu-id="6bbb0-288">Hello dodatkowej, która wykonuje zadania raportów, gdy trwa dłużej niż oczekiwano toorun go.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-288">hello secondary that is executing a task reports when it takes longer than expected toorun it.</span></span> <span data-ttu-id="6bbb0-289">Raporty dla wystąpienia usługi hello we właściwości hello **PendingTasks**.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-289">It reports on hello service instance on hello property **PendingTasks**.</span></span> <span data-ttu-id="6bbb0-290">Raport Hello określa hello wystąpienie usługi, które występują problemy, ale nie przechwytuje hello sytuacji, gdy zaniku hello wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-290">hello report pinpoints hello service instance that has issues, but it doesn't capture hello situation where hello instance dies.</span></span> <span data-ttu-id="6bbb0-291">Raporty Hello są następnie wyczyścić.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-291">hello reports are cleaned up then.</span></span> <span data-ttu-id="6bbb0-292">Można go raport dotyczący hello dodatkowej usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-292">It could report on hello secondary service.</span></span> <span data-ttu-id="6bbb0-293">Hello dodatkowej wykona hello zadań, wystąpienie dodatkowej hello czyści hello raportu z magazynu hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-293">If hello secondary completes hello task, hello secondary instance clears hello report from hello store.</span></span> <span data-ttu-id="6bbb0-294">Raport Hello nie przechwytuje hello sytuacji, gdy komunikat potwierdzenia hello zostaną utracone i hello zadanie nie zostało zakończone z punktu widzenia głównego hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-294">hello report doesn't capture hello situation where hello acknowledgement message is lost and hello task is not finished from hello master's point of view.</span></span>

<span data-ttu-id="6bbb0-295">Jednak hello raportowania odbywa się w przypadku hello opisane powyżej, raporty hello są przechwytywane kondycji aplikacji podczas oceny kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-295">However hello reporting is done in hello cases described above, hello reports are captured in application health when health is evaluated.</span></span>

## <a name="report-periodically-vs-on-transition"></a><span data-ttu-id="6bbb0-296">Raport okresowo a na przejście</span><span class="sxs-lookup"><span data-stu-id="6bbb0-296">Report periodically vs. on transition</span></span>
<span data-ttu-id="6bbb0-297">Używając raportowania modelu kondycji hello watchdogs raporty można wysyłać okresowo lub przejścia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-297">By using hello health reporting model, watchdogs can send reports periodically or on transitions.</span></span> <span data-ttu-id="6bbb0-298">Hello zalecany sposób programu alarmowego raportowania jest okresowo, ponieważ kod hello jest znacznie prostsza i mniej podatna tooerrors.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-298">hello recommended way for watchdog reporting is periodically, because hello code is much simpler and less prone tooerrors.</span></span> <span data-ttu-id="6bbb0-299">Hello watchdogs należy dążyć toobe najprostszą możliwe tooavoid usterki, które mogą powodować nieprawidłowe raporty.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-299">hello watchdogs must strive toobe as simple as possible tooavoid bugs that trigger incorrect reports.</span></span> <span data-ttu-id="6bbb0-300">Niepoprawna *zła* wpływ na raporty oceny kondycji i scenariusze, w oparciu o kondycji, w tym uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-300">Incorrect *unhealthy* reports impact health evaluations and scenarios based on health, including upgrades.</span></span> <span data-ttu-id="6bbb0-301">Niepoprawna *dobrej kondycji* raporty ukrycie problemów w klastrze hello, co nie jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-301">Incorrect *healthy* reports hide issues in hello cluster, which is not desired.</span></span>

<span data-ttu-id="6bbb0-302">Okresowe raportowania programu alarmowego hello można zaimplementować z czasomierzem.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-302">For periodic reporting, hello watchdog can be implemented with a timer.</span></span> <span data-ttu-id="6bbb0-303">Wywołanie zwrotne czasomierza programu alarmowego hello można Sprawdź stan hello i wysłać raport na podstawie bieżącego stanu hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-303">On a timer callback, hello watchdog can check hello state and send a report based on hello current state.</span></span> <span data-ttu-id="6bbb0-304">Nie ma żadnych toosee potrzeba, który raport został wysłany wcześniej lub wprowadzić żadnych optymalizacji pod względem obsługi wiadomości.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-304">There is no need toosee which report was sent previously or make any optimizations in terms of messaging.</span></span> <span data-ttu-id="6bbb0-305">Hello kondycji klienta jest przetwarzanie wsadowe toohelp logiki z wydajnością.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-305">hello health client has batching logic toohelp with performance.</span></span> <span data-ttu-id="6bbb0-306">Gdy hello kondycji klienta jest aktywne, ponowną wewnętrznie aż do raportu hello zostaje potwierdzony przez magazynu kondycji hello lub programu alarmowego hello generuje raport nowszej z hello tego samego obiektu, właściwości i źródła.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-306">While hello health client is kept alive, it retries internally until hello report is acknowledged by hello health store or hello watchdog generates a newer report with hello same entity, property, and source.</span></span>

<span data-ttu-id="6bbb0-307">Raporty dotyczące przejścia wymaga obsługi dokładne stanu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-307">Reporting on transitions requires careful handling of state.</span></span> <span data-ttu-id="6bbb0-308">programu alarmowego Hello monitoruje niektóre warunki i raporty tylko wtedy, gdy zmianie hello warunków.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-308">hello watchdog monitors some conditions and reports only when hello conditions change.</span></span> <span data-ttu-id="6bbb0-309">Witaj do góry nogami takie podejście jest potrzebne są mniej raportów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-309">hello upside of this approach is that fewer reports are needed.</span></span> <span data-ttu-id="6bbb0-310">Wadą interfejsu Hello jest złożone hello logiki programu alarmowego hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-310">hello downside is that hello logic of hello watchdog is complex.</span></span> <span data-ttu-id="6bbb0-311">programu alarmowego Hello muszą zachować warunki hello lub raportów hello, dzięki czemu można je kontrolowanego toodetermine zmian stanu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-311">hello watchdog must maintain hello conditions or hello reports, so that they can be inspected toodetermine state changes.</span></span> <span data-ttu-id="6bbb0-312">W tryb failover należy uważać z raportami dodane, ale nie zostały jeszcze wysłane toohello magazynu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-312">On failover, care must be taken with reports added, but not yet sent toohello health store.</span></span> <span data-ttu-id="6bbb0-313">numer sekwencyjny Hello musi być coraz większe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-313">hello sequence number must be ever-increasing.</span></span> <span data-ttu-id="6bbb0-314">Jeśli nie, raporty hello odrzucone jako przestarzałe.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-314">If not, hello reports are rejected as stale.</span></span> <span data-ttu-id="6bbb0-315">W rzadkich przypadkach hello gdzie poniesienia utraty danych synchronizacji mogą być wymagane między hello stan osoby zgłaszającej hello i stan hello hello kondycji magazynu.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-315">In hello rare cases where data loss is incurred, synchronization may be needed between hello state of hello reporter and hello state of hello health store.</span></span>

<span data-ttu-id="6bbb0-316">Raporty dotyczące przejścia sens dla usług raportowania, za pomocą `Partition` lub `CodePackageActivationContext`.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-316">Reporting on transitions makes sense for services reporting on themselves, through `Partition` or `CodePackageActivationContext`.</span></span> <span data-ttu-id="6bbb0-317">Gdy hello lokalnego obiektu (repliki lub wdrożony pakiet usługi / wdrożonych aplikacji) jest usunięty, jego raporty zostaną również usunięte.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-317">When hello local object (replica or deployed service package / deployed application) is removed, all its reports are also removed.</span></span> <span data-ttu-id="6bbb0-318">To automatyczne oczyszczanie zwalnia hello potrzebę synchronizacja osoby zgłaszającej i magazynu kondycji.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-318">This automatic cleanup relaxes hello need for synchronization between reporter and health store.</span></span> <span data-ttu-id="6bbb0-319">Jeśli raport hello jest partycji nadrzędnej lub aplikacji nadrzędnej, należy uważać, pracy awaryjnej tooavoid starych raportów w magazynie kondycji hello na.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-319">If hello report is for parent partition or parent application, care must be taken on failover tooavoid stale reports in hello health store.</span></span> <span data-ttu-id="6bbb0-320">Logika musi zostać dodany stan hello toomaintain i wyczyść hello raportu z magazynu, jeśli nie jest już potrzebne.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-320">Logic must be added toomaintain hello correct state and clear hello report from store when not needed anymore.</span></span>

## <a name="implement-health-reporting"></a><span data-ttu-id="6bbb0-321">Implementowanie raportowania kondycji</span><span class="sxs-lookup"><span data-stu-id="6bbb0-321">Implement health reporting</span></span>
<span data-ttu-id="6bbb0-322">Po zatwierdzeniu hello jednostki i raport szczegóły Wyczyść, wysyłania raportów o kondycji jest możliwe za pośrednictwem interfejsu API hello, programu PowerShell lub REST.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-322">Once hello entity and report details are clear, sending health reports can be done through hello API, PowerShell, or REST.</span></span>

### <a name="api"></a><span data-ttu-id="6bbb0-323">Interfejs API</span><span class="sxs-lookup"><span data-stu-id="6bbb0-323">API</span></span>
<span data-ttu-id="6bbb0-324">tooreport za pośrednictwem hello interfejsu API, należy toocreate typu jednostki toohello określonego raportu kondycji, które mają tooreport na.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-324">tooreport through hello API, you need toocreate a health report specific toohello entity type they want tooreport on.</span></span> <span data-ttu-id="6bbb0-325">Nadaj hello raport tooa kondycji klienta.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-325">Give hello report tooa health client.</span></span> <span data-ttu-id="6bbb0-326">Można również utworzyć informacje o kondycji i przekaż go toocorrect metod raportowania na `Partition` lub `CodePackageActivationContext` tooreport na bieżącym jednostek.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-326">Alternatively, create a health information and pass it toocorrect reporting methods on `Partition` or `CodePackageActivationContext` tooreport on current entities.</span></span>

<span data-ttu-id="6bbb0-327">Witaj poniższy przykład przedstawia okresowych raportów z strażnika w ramach klastra hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-327">hello following example shows periodic reporting from a watchdog within hello cluster.</span></span> <span data-ttu-id="6bbb0-328">programu alarmowego Hello sprawdza, czy zasób zewnętrzny można uzyskać z w węźle.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-328">hello watchdog checks whether an external resource can be accessed from within a node.</span></span> <span data-ttu-id="6bbb0-329">zasób Hello są wymagane przez aplikacji hello manifestu usługi.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-329">hello resource is needed by a service manifest within hello application.</span></span> <span data-ttu-id="6bbb0-330">Jeśli hello zasób jest niedostępny, hello innych usług w aplikacji hello mogą nadal działać prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-330">If hello resource is unavailable, hello other services within hello application can still function properly.</span></span> <span data-ttu-id="6bbb0-331">W związku z tym hello raport jest wysyłany na powitania wdrożone usługi pakietu jednostki co 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-331">Therefore, hello report is sent on hello deployed service package entity every 30 seconds.</span></span>

```csharp
private static Uri ApplicationName = new Uri("fabric:/WordCount");
private static string ServiceManifestName = "WordCount.Service";
private static string NodeName = FabricRuntime.GetNodeContext().NodeName;
private static Timer ReportTimer = new Timer(new TimerCallback(SendReport), null, 30 * 1000, 30 * 1000);
private static FabricClient Client = new FabricClient(new FabricClientSettings() { HealthReportSendInterval = TimeSpan.FromSeconds(0) });

public static void SendReport(object obj)
{
    // Test whether hello resource can be accessed from hello node
    HealthState healthState = this.TestConnectivityToExternalResource();

    // Send report on deployed service package, as hello connectivity is needed by hello specific service manifest
    // and can be different on different nodes
    var deployedServicePackageHealthReport = new DeployedServicePackageHealthReport(
        ApplicationName,
        ServiceManifestName,
        NodeName,
        new HealthInformation("ExternalSourceWatcher", "Connectivity", healthState));

    // TODO: handle exception. Code omitted for snippet brevity.
    // Possible exceptions: FabricException with error codes
    // FabricHealthStaleReport (non-retryable, hello report is already queued on hello health client),
    // FabricHealthMaxReportsReached (retryable; user should retry with exponential delay until hello report is accepted).
    Client.HealthManager.ReportHealth(deployedServicePackageHealthReport);
}
```

### <a name="powershell"></a><span data-ttu-id="6bbb0-332">PowerShell</span><span class="sxs-lookup"><span data-stu-id="6bbb0-332">PowerShell</span></span>
<span data-ttu-id="6bbb0-333">Wysyłanie raportów o kondycji z  **ServiceFabric wysyłania*EntityType*HealthReport **.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-333">Send health reports with **Send-ServiceFabric*EntityType*HealthReport**.</span></span>

<span data-ttu-id="6bbb0-334">Witaj poniższy przykład przedstawia okresowych raportów na wartościach Procesora w węźle.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-334">hello following example shows periodic reporting on CPU values on a node.</span></span> <span data-ttu-id="6bbb0-335">Raporty Hello mają być wysyłane co 30 sekund i mają czasu toolive wynosi dwie minuty.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-335">hello reports should be sent every 30 seconds, and they have a time toolive of two minutes.</span></span> <span data-ttu-id="6bbb0-336">Jeśli wygasną, osoby zgłaszającej hello występują problemy, więc węzeł hello jest oceniane w błąd.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-336">If they expire, hello reporter has issues, so hello node is evaluated at error.</span></span> <span data-ttu-id="6bbb0-337">Gdy hello Procesora jest powyżej wartości progowej, hello raportu ma stan kondycji ostrzeżenia.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-337">When hello CPU is above a threshold, hello report has a health state of warning.</span></span> <span data-ttu-id="6bbb0-338">Jeśli hello Procesora pozostaje powyżej progu przez ponad hello skonfigurowany czas, będzie zgłaszane jako błąd.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-338">When hello CPU remains above a threshold for more than hello configured time, it's reported as an error.</span></span> <span data-ttu-id="6bbb0-339">W przeciwnym razie osoby zgłaszającej hello wysyła kondycję OK.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-339">Otherwise, hello reporter sends a health state of OK.</span></span>

```powershell
PS C:\> Send-ServiceFabricNodeHealthReport -NodeName Node.1 -HealthState Warning -SourceId PowershellWatcher -HealthProperty CPU -Description "CPU is above 80% threshold" -TimeToLiveSec 120

PS C:\> Get-ServiceFabricNodeHealth -NodeName Node.1
NodeName              : Node.1
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='CPU', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.FM
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 5
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Fabric node is up.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : CPU
                        HealthState           : Warning
                        SequenceNumber        : 130741236814913394
                        SentAt                : 4/21/2015 9:01:21 PM
                        ReceivedAt            : 4/21/2015 9:01:21 PM
                        TTL                   : 00:02:00
                        Description           : CPU is above 80% threshold
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:01:21 PM
```

<span data-ttu-id="6bbb0-340">Hello poniższy przykład raporty przejściowej ostrzeżenie dotyczące repliki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-340">hello following example reports a transient warning on a replica.</span></span> <span data-ttu-id="6bbb0-341">Najpierw pobiera identyfikator partycji: hello, a następnie hello identyfikator repliki usługi hello, który jest zainteresowana.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-341">It first gets hello partition ID and then hello replica ID for hello service it is interested in.</span></span> <span data-ttu-id="6bbb0-342">Następnie wysyła raport z **PowershellWatcher** we właściwości hello **ResourceDependency**.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-342">It then sends a report from **PowershellWatcher** on hello property **ResourceDependency**.</span></span> <span data-ttu-id="6bbb0-343">Raport Hello ma znaczenie tylko dwóch minut, a zostanie usunięte z magazynu hello automatycznie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-343">hello report is of interest for only two minutes, and it is removed from hello store automatically.</span></span>

```powershell
PS C:\> $partitionId = (Get-ServiceFabricPartition -ServiceName fabric:/WordCount/WordCount.Service).PartitionId

PS C:\> $replicaId = (Get-ServiceFabricReplica -PartitionId $partitionId | where {$_.ReplicaRole -eq "Primary"}).ReplicaId

PS C:\> Send-ServiceFabricReplicaHealthReport -PartitionId $partitionId -ReplicaId $replicaId -HealthState Warning -SourceId PowershellWatcher -HealthProperty ResourceDependency -Description "hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes." -TimeToLiveSec 120 -RemoveWhenExpired

PS C:\> Get-ServiceFabricReplicaHealth  -PartitionId $partitionId -ReplicaOrInstanceId $replicaId


PartitionId           : 8f82daff-eb68-4fd9-b631-7a37629e08c0
ReplicaId             : 130740415594605869
AggregatedHealthState : Warning
UnhealthyEvaluations  :
                        Unhealthy event: SourceId='PowershellWatcher', Property='ResourceDependency', HealthState='Warning', ConsiderWarningAsError=false.

HealthEvents          :
                        SourceId              : System.RA
                        Property              : State
                        HealthState           : Ok
                        SequenceNumber        : 130740768777734943
                        SentAt                : 4/21/2015 8:01:17 AM
                        ReceivedAt            : 4/21/2015 8:02:12 AM
                        TTL                   : Infinite
                        Description           : Replica has been created.
                        RemoveWhenExpired     : False
                        IsExpired             : False
                        Transitions           : ->Ok = 4/21/2015 8:02:12 AM

                        SourceId              : PowershellWatcher
                        Property              : ResourceDependency
                        HealthState           : Warning
                        SequenceNumber        : 130741243777723555
                        SentAt                : 4/21/2015 9:12:57 PM
                        ReceivedAt            : 4/21/2015 9:12:57 PM
                        TTL                   : 00:02:00
                        Description           : hello external resource that hello primary is using has been rebooted at 4/21/2015 9:01:21 PM. Expect processing delays for a few minutes.
                        RemoveWhenExpired     : True
                        IsExpired             : False
                        Transitions           : ->Warning = 4/21/2015 9:12:32 PM
```

### <a name="rest"></a><span data-ttu-id="6bbb0-344">REST</span><span class="sxs-lookup"><span data-stu-id="6bbb0-344">REST</span></span>
<span data-ttu-id="6bbb0-345">Wysyłanie raportów o kondycji za pomocą usługi REST z żądania POST, przejdź toohello potrzeby jednostki, które ma w opis raportu kondycji hello treści hello.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-345">Send health reports using REST with POST requests that go toohello desired entity and have in hello body hello health report description.</span></span> <span data-ttu-id="6bbb0-346">Na przykład, zobacz, jak REST toosend [klastra raportów o kondycji](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) lub [raportów o kondycji usługi](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span><span class="sxs-lookup"><span data-stu-id="6bbb0-346">For example, see how toosend REST [cluster health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-cluster) or [service health reports](https://docs.microsoft.com/rest/api/servicefabric/report-the-health-of-a-service).</span></span> <span data-ttu-id="6bbb0-347">Obsługiwane są wszystkie jednostki.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-347">All entities are supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="6bbb0-348">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="6bbb0-348">Next steps</span></span>
<span data-ttu-id="6bbb0-349">Na podstawie danych kondycji hello, moduły zapisujące usługi i Administratorzy klastra/aplikacji można traktować informacji hello tooconsume sposobów.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-349">Based on hello health data, service writers and cluster/application administrators can think of ways tooconsume hello information.</span></span> <span data-ttu-id="6bbb0-350">Na przykład można ustawić alerty oparte na kondycji stanu toocatch poważne problemy, zanim one powodować awarie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-350">For example, they can set up alerts based on health status toocatch severe issues before they provoke outages.</span></span> <span data-ttu-id="6bbb0-351">Administratorzy mogą również skonfigurować naprawy systemów toofix problemów automatycznie.</span><span class="sxs-lookup"><span data-stu-id="6bbb0-351">Administrators can also set up repair systems toofix issues automatically.</span></span>

[<span data-ttu-id="6bbb0-352">Wprowadzenie tooService kondycji sieci szkieletowej monitorowania</span><span class="sxs-lookup"><span data-stu-id="6bbb0-352">Introduction tooService Fabric health Monitoring</span></span>](service-fabric-health-introduction.md)

[<span data-ttu-id="6bbb0-353">Wyświetl raporty dotyczące kondycji sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="6bbb0-353">View Service Fabric health reports</span></span>](service-fabric-view-entities-aggregated-health.md)

[<span data-ttu-id="6bbb0-354">Jak tooreport i zaznacz pole wyboru usługi kondycji</span><span class="sxs-lookup"><span data-stu-id="6bbb0-354">How tooreport and check service health</span></span>](service-fabric-diagnostics-how-to-report-and-check-service-health.md)

[<span data-ttu-id="6bbb0-355">Użyj systemowych raportów kondycji do rozwiązywania problemów</span><span class="sxs-lookup"><span data-stu-id="6bbb0-355">Use system health reports for troubleshooting</span></span>](service-fabric-understand-and-troubleshoot-with-system-health-reports.md)

[<span data-ttu-id="6bbb0-356">Monitorowanie i diagnozowania usług lokalnie</span><span class="sxs-lookup"><span data-stu-id="6bbb0-356">Monitor and diagnose services locally</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

[<span data-ttu-id="6bbb0-357">Uaktualnianie aplikacji sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="6bbb0-357">Service Fabric application upgrade</span></span>](service-fabric-application-upgrade.md)

