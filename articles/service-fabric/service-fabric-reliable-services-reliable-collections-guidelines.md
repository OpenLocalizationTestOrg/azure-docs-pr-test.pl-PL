---
title: "aaaGuidelines & zalecenia dotyczące niezawodnej kolekcji w sieci szkieletowej usług Azure | Dokumentacja firmy Microsoft"
description: "Wskazówki i zalecenia dotyczące używania kolekcji niezawodnej sieci szkieletowej usług"
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/3/2017
ms.author: mcoskun
ms.openlocfilehash: bcdbc9d013bc044e06c43761e7f515c7e4bf340c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="guidelines-and-recommendations-for-reliable-collections-in-azure-service-fabric"></a><span data-ttu-id="824c2-103">Wskazówki i zalecenia dotyczące niezawodnej kolekcji w sieci szkieletowej usług Azure</span><span class="sxs-lookup"><span data-stu-id="824c2-103">Guidelines and recommendations for Reliable Collections in Azure Service Fabric</span></span>
<span data-ttu-id="824c2-104">Ta sekcja zawiera wskazówki dotyczące korzystania niezawodnej Menedżer stanu i niezawodne kolekcji.</span><span class="sxs-lookup"><span data-stu-id="824c2-104">This section provides guidelines for using Reliable State Manager and Reliable Collections.</span></span> <span data-ttu-id="824c2-105">Celem Hello jest toohelp użytkownikom uniknąć typowych problemów.</span><span class="sxs-lookup"><span data-stu-id="824c2-105">hello goal is toohelp users avoid common pitfalls.</span></span>

<span data-ttu-id="824c2-106">wytyczne Hello są zorganizowane jako proste zalecenia prefiksem warunki hello *czy*, *rozważ*, *należy unikać* i *nie*.</span><span class="sxs-lookup"><span data-stu-id="824c2-106">hello guidelines are organized as simple recommendations prefixed with hello terms *Do*, *Consider*, *Avoid* and *Do not*.</span></span>

* <span data-ttu-id="824c2-107">Nie należy modyfikować niestandardowego typu zwrócone przez operacje odczytu obiektu (na przykład `TryPeekAsync` lub `TryGetValueAsync`).</span><span class="sxs-lookup"><span data-stu-id="824c2-107">Do not modify an object of custom type returned by read operations (for example, `TryPeekAsync` or `TryGetValueAsync`).</span></span> <span data-ttu-id="824c2-108">Niezawodne kolekcje, podobnie jak kolekcji współbieżnych zwracać obiekty toohello odwołania, a nie kopię.</span><span class="sxs-lookup"><span data-stu-id="824c2-108">Reliable Collections, just like Concurrent Collections, return a reference toohello objects and not a copy.</span></span>
* <span data-ttu-id="824c2-109">Czy hello bezpośrednich kopii zwrócił obiekt typu niestandardowego przed zmodyfikowaniem go.</span><span class="sxs-lookup"><span data-stu-id="824c2-109">Do deep copy hello returned object of a custom type before modifying it.</span></span> <span data-ttu-id="824c2-110">Ponieważ wbudowane typy i struktury są przebiegu przez wartość, nie trzeba toodo bezpośrednich kopii na nich.</span><span class="sxs-lookup"><span data-stu-id="824c2-110">Since structs and built-in types are pass-by-value, you do not need toodo a deep copy on them.</span></span>
* <span data-ttu-id="824c2-111">Nie używaj `TimeSpan.MaxValue` dla limitu czasu.</span><span class="sxs-lookup"><span data-stu-id="824c2-111">Do not use `TimeSpan.MaxValue` for time-outs.</span></span> <span data-ttu-id="824c2-112">Limity czasu powinna być używana toodetect zakleszczenie.</span><span class="sxs-lookup"><span data-stu-id="824c2-112">Time-outs should be used toodetect deadlocks.</span></span>
* <span data-ttu-id="824c2-113">Nie używaj transakcji po została zatwierdzona, zostało przerwane lub usunięty.</span><span class="sxs-lookup"><span data-stu-id="824c2-113">Do not use a transaction after it has been committed, aborted, or disposed.</span></span>
* <span data-ttu-id="824c2-114">Nie należy używać wyliczenie poza zasięgiem transakcji hello, który został utworzony.</span><span class="sxs-lookup"><span data-stu-id="824c2-114">Do not use an enumeration outside of hello transaction scope it was created in.</span></span>
* <span data-ttu-id="824c2-115">Nie twórz transakcji w innej transakcji `using` instrukcji, ponieważ może to spowodować zakleszczenie.</span><span class="sxs-lookup"><span data-stu-id="824c2-115">Do not create a transaction within another transaction’s `using` statement because it can cause deadlocks.</span></span>
* <span data-ttu-id="824c2-116">Upewnij się, że Twoje `IComparable<TKey>` implementacja jest prawidłowa.</span><span class="sxs-lookup"><span data-stu-id="824c2-116">Do ensure that your `IComparable<TKey>` implementation is correct.</span></span> <span data-ttu-id="824c2-117">Hello system przejmuje zależności `IComparable<TKey>` do scalenia punkty kontrolne i wierszy.</span><span class="sxs-lookup"><span data-stu-id="824c2-117">hello system takes dependency on `IComparable<TKey>` for merging checkpoints and rows.</span></span>
* <span data-ttu-id="824c2-118">Należy używać blokowania aktualizacji podczas odczytywania elementu tooupdate zamiar go tooprevent klasy zakleszczenia.</span><span class="sxs-lookup"><span data-stu-id="824c2-118">Do use Update lock when reading an item with an intention tooupdate it tooprevent a certain class of deadlocks.</span></span>
* <span data-ttu-id="824c2-119">Pomyśl o pozostawieniu elementów (na przykład TKey + TValue niezawodnej słownika) poniżej 80 KB: hello mniejszych lepiej.</span><span class="sxs-lookup"><span data-stu-id="824c2-119">Consider keeping your items (for example, TKey + TValue for Reliable Dictionary) below 80 KBytes: smaller hello better.</span></span> <span data-ttu-id="824c2-120">Zmniejsza ilość hello wymagań we/wy sterty dużych obiektów użycia jak również dysków i sieci.</span><span class="sxs-lookup"><span data-stu-id="824c2-120">This reduces hello amount of Large Object Heap usage as well as disk and network IO requirements.</span></span> <span data-ttu-id="824c2-121">Często zmniejsza replikowanie danych zduplikowanych, gdy tylko jeden niewielką część hello wartość jest aktualizowana.</span><span class="sxs-lookup"><span data-stu-id="824c2-121">Often, it reduces replicating duplicate data when only one small part of hello value is being updated.</span></span> <span data-ttu-id="824c2-122">Typowe tooachieve sposób w słowniku niezawodnej to toobreak Twojego wierszy w toomultiple wierszy.</span><span class="sxs-lookup"><span data-stu-id="824c2-122">Common way tooachieve this in Reliable Dictionary, is toobreak your rows in toomultiple rows.</span></span>
* <span data-ttu-id="824c2-123">Należy wziąć pod uwagę przy użyciu kopii zapasowej i przywracania odzyskiwania po awarii toohave funkcji.</span><span class="sxs-lookup"><span data-stu-id="824c2-123">Consider using backup and restore functionality toohave disaster recovery.</span></span>
* <span data-ttu-id="824c2-124">Unikaj mieszanie operacje pojedynczej jednostki i operacje obejmujące wiele urządzeń (np. `GetCountAsync`, `CreateEnumerableAsync`) w hello transakcji tego samego powodu toohello izolacji różnych poziomów.</span><span class="sxs-lookup"><span data-stu-id="824c2-124">Avoid mixing single entity operations and multi-entity operations (e.g `GetCountAsync`, `CreateEnumerableAsync`) in hello same transaction due toohello different isolation levels.</span></span>
* <span data-ttu-id="824c2-125">Obsługa InvalidOperationException.</span><span class="sxs-lookup"><span data-stu-id="824c2-125">Do handle InvalidOperationException.</span></span> <span data-ttu-id="824c2-126">Transakcje użytkowników może zostać przerwane przez system hello różnych powodów.</span><span class="sxs-lookup"><span data-stu-id="824c2-126">User transactions can be aborted by hello system for variety of reasons.</span></span> <span data-ttu-id="824c2-127">Na przykład gdy hello niezawodnej Menedżer stanów jest zmiana jego rolą poza podstawowej lub transakcji długotrwałe blokuje obcinania dziennika transakcyjne hello.</span><span class="sxs-lookup"><span data-stu-id="824c2-127">For example, when hello Reliable State Manager is changing its role out of Primary or when a long-running transaction is blocking truncation of hello transactional log.</span></span> <span data-ttu-id="824c2-128">W takich przypadkach użytkownik może odbierać InvalidOperationException wskazujący, że ich transakcji został już zakończony.</span><span class="sxs-lookup"><span data-stu-id="824c2-128">In such cases, user may receive InvalidOperationException indicating that their transaction has already been terminated.</span></span> <span data-ttu-id="824c2-129">Przy założeniu, nie zażądano zakończenia hello hello transakcji przez użytkownika hello, najlepsze sposób toohandle tego wyjątku jest toodispose hello transakcji, sprawdź, czy token anulowania hello zostały sygnalizowane (lub zostały zmienione hello roli repliki hello), a jeśli nie Utwórz nową transakcję i spróbuj ponownie.</span><span class="sxs-lookup"><span data-stu-id="824c2-129">Assuming, hello termination of hello transaction was not requested by hello user, best way toohandle this exception is toodispose hello transaction, check if hello cancellation token has been signaled (or hello role of hello replica has been changed), and if not create a new transaction and retry.</span></span>  

<span data-ttu-id="824c2-130">Poniżej przedstawiono niektóre tookeep rzeczy pamiętać:</span><span class="sxs-lookup"><span data-stu-id="824c2-130">Here are some things tookeep in mind:</span></span>

* <span data-ttu-id="824c2-131">Hello domyślny limit czasu wynosi cztery sekund dla wszystkich hello niezawodnej kolekcji interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="824c2-131">hello default time-out is four seconds for all hello Reliable Collection APIs.</span></span> <span data-ttu-id="824c2-132">Większość użytkowników należy używać hello domyślny limit czasu.</span><span class="sxs-lookup"><span data-stu-id="824c2-132">Most users should use hello default time-out.</span></span>
* <span data-ttu-id="824c2-133">Witaj domyślny token anulowania jest `CancellationToken.None` w wszystkich interfejsów API niezawodnej kolekcji.</span><span class="sxs-lookup"><span data-stu-id="824c2-133">hello default cancellation token is `CancellationToken.None` in all Reliable Collections APIs.</span></span>
* <span data-ttu-id="824c2-134">Parametr typu klucza Hello (*TKey*) dla słownika niezawodnej poprawnie musi implementować `GetHashCode()` i `Equals()`.</span><span class="sxs-lookup"><span data-stu-id="824c2-134">hello key type parameter (*TKey*) for a Reliable Dictionary must correctly implement `GetHashCode()` and `Equals()`.</span></span> <span data-ttu-id="824c2-135">Klucze muszą być niezmienialne.</span><span class="sxs-lookup"><span data-stu-id="824c2-135">Keys must be immutable.</span></span>
* <span data-ttu-id="824c2-136">tooachieve wysoka dostępność dla hello niezawodnej kolekcje, każda usługa powinna mieć co najmniej docelowej i repliki minimalny rozmiar 3.</span><span class="sxs-lookup"><span data-stu-id="824c2-136">tooachieve high availability for hello Reliable Collections, each service should have at least a target and minimum replica set size of 3.</span></span>
* <span data-ttu-id="824c2-137">Operacje odczytu na powitania dodatkowej może odczytać wersje, które nie są zatwierdzone kworum.</span><span class="sxs-lookup"><span data-stu-id="824c2-137">Read operations on hello secondary may read versions that are not quorum committed.</span></span>
  <span data-ttu-id="824c2-138">Oznacza to, że wersji danych, które są odczytywane z jednej dodatkowej może FAŁSZ postępem.</span><span class="sxs-lookup"><span data-stu-id="824c2-138">This means that a version of data that is read from a single secondary might be false progressed.</span></span>
  <span data-ttu-id="824c2-139">Odczyty z podstawowego zawsze są stabilne: może nie być false biegiem czasu.</span><span class="sxs-lookup"><span data-stu-id="824c2-139">Reads from Primary are always stable: can never be false progressed.</span></span>

### <a name="next-steps"></a><span data-ttu-id="824c2-140">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="824c2-140">Next steps</span></span>
* [<span data-ttu-id="824c2-141">Praca z elementami Reliable Collections</span><span class="sxs-lookup"><span data-stu-id="824c2-141">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="824c2-142">Transakcje i blokad</span><span class="sxs-lookup"><span data-stu-id="824c2-142">Transactions and Locks</span></span>](service-fabric-reliable-services-reliable-collections-transactions-locks.md)
* [<span data-ttu-id="824c2-143">Menedżer stanu niezawodnych i wewnętrzne kolekcji</span><span class="sxs-lookup"><span data-stu-id="824c2-143">Reliable State Manager and Collection Internals</span></span>](service-fabric-reliable-services-reliable-collections-internals.md)
* <span data-ttu-id="824c2-144">Zarządzanie danymi</span><span class="sxs-lookup"><span data-stu-id="824c2-144">Managing Data</span></span>
  * [<span data-ttu-id="824c2-145">Tworzenie kopii zapasowej i przywracanie</span><span class="sxs-lookup"><span data-stu-id="824c2-145">Backup and Restore</span></span>](service-fabric-reliable-services-backup-restore.md)
  * [<span data-ttu-id="824c2-146">Powiadomienia</span><span class="sxs-lookup"><span data-stu-id="824c2-146">Notifications</span></span>](service-fabric-reliable-services-notifications.md)
  * [<span data-ttu-id="824c2-147">Serializacja i uaktualniania</span><span class="sxs-lookup"><span data-stu-id="824c2-147">Serialization and Upgrade</span></span>](service-fabric-application-upgrade-data-serialization.md)
  * [<span data-ttu-id="824c2-148">Stan niezawodny Menedżera konfiguracji</span><span class="sxs-lookup"><span data-stu-id="824c2-148">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* <span data-ttu-id="824c2-149">Inne</span><span class="sxs-lookup"><span data-stu-id="824c2-149">Others</span></span>
  * [<span data-ttu-id="824c2-150">Niezawodne usługi szybki start</span><span class="sxs-lookup"><span data-stu-id="824c2-150">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
  * [<span data-ttu-id="824c2-151">Dokumentacja dla deweloperów niezawodnej kolekcji</span><span class="sxs-lookup"><span data-stu-id="824c2-151">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)
