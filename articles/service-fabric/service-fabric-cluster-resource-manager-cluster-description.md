---
title: "Opis klastra Menedżera zasobów aaaCluster | Dokumentacja firmy Microsoft"
description: "Określając domen błędów, uaktualnienia domen, właściwości węzła i pojemności węzła dla hello Menedżera zasobów klastra, opisujący klastra sieci szkieletowej usług."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f2822075976bd54402af5ad56991b5b360dfb1d8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="5e3cf-103">Opisujące klastra sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="5e3cf-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="5e3cf-104">Hello zasobu klastra sieci szkieletowej programu Service Manager zapewnia kilka mechanizmów opisujące klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-104">hello Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="5e3cf-105">W czasie wykonywania hello Cluster Resource Manager korzysta z tej informacji tooensure wysoką dostępność usług hello uruchomionych w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-105">During runtime, hello Cluster Resource Manager uses this information tooensure high availability of hello services running in hello cluster.</span></span> <span data-ttu-id="5e3cf-106">Wymuszając te reguły ważne również podejmie zużycie zasobów hello toooptimize w ramach klastra hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-106">While enforcing these important rules, it also attempts toooptimize hello resource consumption within hello cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="5e3cf-107">Kluczowe pojęcia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-107">Key concepts</span></span>
<span data-ttu-id="5e3cf-108">Witaj Menedżera zasobów klastra obsługuje kilka funkcji, które opisują klastra:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-108">hello Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="5e3cf-109">Domen błędów</span><span class="sxs-lookup"><span data-stu-id="5e3cf-109">Fault Domains</span></span>
* <span data-ttu-id="5e3cf-110">Domen uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-110">Upgrade Domains</span></span>
* <span data-ttu-id="5e3cf-111">Właściwości węzła</span><span class="sxs-lookup"><span data-stu-id="5e3cf-111">Node Properties</span></span>
* <span data-ttu-id="5e3cf-112">Możliwości węzła</span><span class="sxs-lookup"><span data-stu-id="5e3cf-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="5e3cf-113">Domeny błędów</span><span class="sxs-lookup"><span data-stu-id="5e3cf-113">Fault domains</span></span>
<span data-ttu-id="5e3cf-114">Domeny błędów jest części skoordynowanego awarii.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="5e3cf-115">Jedna maszyna jest domeny błędów (od momentu jego może zakończyć się niepowodzeniem na jego własnej dla różnych powodów, power dostaw błędów toodrive błędów toobad kart oprogramowania układowego).</span><span class="sxs-lookup"><span data-stu-id="5e3cf-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures toodrive failures toobad NIC firmware).</span></span> <span data-ttu-id="5e3cf-116">Maszyny połączonych toohello są tego samego przełącznika Ethernet w hello tej samej domenie błędów, jak są maszyny udostępniania jednego źródła zasilania lub w pojedynczej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-116">Machines connected toohello same Ethernet switch are in hello same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="5e3cf-117">Ponieważ jest to fizyczne dla toooverlap błędów sprzętu domen błędów są z założenia hierarchiczna i są reprezentowane jako identyfikatory URI w sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-117">Since it's natural for hardware faults toooverlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="5e3cf-118">Należy pamiętać, że domen błędów są poprawnie skonfigurowane, ponieważ usługi Service Fabric korzysta z tej informacji toosafely miejsce usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information toosafely place services.</span></span> <span data-ttu-id="5e3cf-119">Usługi sieć szkieletowa nie ma tooplace usługi tak, aby hello utraty domeny błędów (spowodowany awarią hello niektórych składnika) powoduje, że toogo usług w dół.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-119">Service Fabric doesn't want tooplace services such that hello loss of a Fault Domain (caused by hello failure of some component) causes a service toogo down.</span></span> <span data-ttu-id="5e3cf-120">W hello środowiska platformy Azure w sieci szkieletowej usług używa hello domeny błędów informacji dostarczonych przez toocorrectly środowiska hello skonfigurować hello węzłów w klastrze hello w Twoim imieniu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-120">In hello Azure environment Service Fabric uses hello Fault Domain information provided by hello environment toocorrectly configure hello nodes in hello cluster on your behalf.</span></span> <span data-ttu-id="5e3cf-121">Dla usługi sieci szkieletowej autonomiczny, domen błędów są zdefiniowane w czasie hello klastra hello jest skonfigurowany</span><span class="sxs-lookup"><span data-stu-id="5e3cf-121">For Service Fabric Standalone, Fault Domains are defined at hello time that hello cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="5e3cf-122">Jest ważne, że hello informacji o domenie błędów pod warunkiem, że tooService sieci szkieletowej są dokładne.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-122">It is important that hello Fault Domain information provided tooService Fabric is accurate.</span></span> <span data-ttu-id="5e3cf-123">Na przykład załóżmy, że węzły klastra usługi sieć szkieletowa działają wewnątrz 10 maszyn wirtualnych na hostach fizycznych pięć.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="5e3cf-124">W takim przypadku mimo 10 maszyn wirtualnych, jest tylko 5 różnych (najwyższego poziomu) domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="5e3cf-125">Udostępnianie hello, w tym samym hoście fizycznym powoduje, że tooshare maszyn wirtualnych hello tej samej domenie błędów głównego, ponieważ hello obsługi maszyn wirtualnych koordynowane błąd, jeśli nie powiedzie się ich hosta fizycznego.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-125">Sharing hello same physical host causes VMs tooshare hello same root fault domain, since hello VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="5e3cf-126">Ponieważ sieci szkieletowej usług oczekuje hello domenie awarii węzła nie toochange.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-126">Since Service Fabric expects hello Fault Domain of a node not toochange.</span></span> <span data-ttu-id="5e3cf-127">Inne mechanizmy zapewniania wysokiej dostępności hello maszyn wirtualnych, takie jak [maszyn wirtualnych wysokiej dostępności](https://technet.microsoft.com/en-us/library/cc967323.aspx), użyj przezroczystego migracji maszyn wirtualnych z jednego hosta tooanother.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-127">Other mechanisms of ensuring high availability of hello VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host tooanother.</span></span> <span data-ttu-id="5e3cf-128">Te mechanizmy ponowne konfigurowanie lub nie Powiadamiaj hello uruchamiania kodu wewnątrz hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-128">These mechanisms do not reconfigure or notify hello running code inside hello VM.</span></span> <span data-ttu-id="5e3cf-129">Tak, są one **nieobsługiwane** jako środowiska do uruchamiania usługi sieć szkieletowa klastrów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="5e3cf-130">Usługa sieci szkieletowej powinna być stosowanej technologii tylko wysokiej dostępności hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-130">Service Fabric should be hello only high-availability technology employed.</span></span> <span data-ttu-id="5e3cf-131">Mechanizmy, takie jak migracja maszyny Wirtualnej sieci SAN, lub inne osoby nie są konieczne.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="5e3cf-132">Jeśli używany w połączeniu z usługi Service Fabric tych mechanizmów _zmniejszyć_ aplikacji dostępność i niezawodność, ponieważ ich wprowadzenie dodatkowej złożoności, Dodaj scentralizowane źródła błędu i wykorzystania niezawodność i Strategie dostępności, które powodują konflikt z aliasami w sieci szkieletowej usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="5e3cf-133">Hello rysunku poniżej możemy kolor wszystkich jednostek hello wchodzących w skład domeny tooFault i listy wszystkich hello różnych domen błędów, które powoduje.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-133">In hello graphic below we color all hello entities that contribute tooFault Domains and list all hello different Fault Domains that result.</span></span> <span data-ttu-id="5e3cf-134">W tym przykładzie mamy centrów danych ("DC"), stojakami ("R") i bloki ("B").</span><span class="sxs-lookup"><span data-stu-id="5e3cf-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="5e3cf-135">Powrotne Jeśli każdy blok zawiera więcej niż jednej maszyny wirtualnej, mogą występować innej warstwy w hello hierarchii domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in hello Fault Domain hierarchy.</span></span>

<span data-ttu-id="5e3cf-136"><center>
![Węzły zorganizowane za pośrednictwem domen błędów][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="5e3cf-137">W czasie wykonywania hello zasobu klastra sieci szkieletowej programu Service Manager uwzględnia hello domen błędów w klastrze hello i planów układów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-137">During runtime, hello Service Fabric Cluster Resource Manager considers hello Fault Domains in hello cluster and plans layouts.</span></span> <span data-ttu-id="5e3cf-138">Witaj stanowe repliki lub bezstanowych wystąpień dla danej usługi są dystrybuowane, dzięki czemu są one w oddzielnych domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-138">hello stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="5e3cf-139">Dystrybucję usługi hello domen błędów gwarantuje, że dostępność hello hello usługi nie zostanie naruszony, gdy domeny błędów nie powiodło się na dowolnym poziomie hierarchii hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-139">Distributing hello service across fault domains ensures hello availability of hello service is not compromised when a Fault Domain fails at any level of hello hierarchy.</span></span>

<span data-ttu-id="5e3cf-140">Menedżer zasobów klastra usługi sieć szkieletowa nie szczególną uwagę liczbę warstw w hello hierarchii domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="5e3cf-141">Jednak spróbuje tooensure, który hello utraty jednej części hierarchii hello bez wpływu na usługi uruchomione w nim.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-141">However, it tries tooensure that hello loss of any one portion of hello hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="5e3cf-142">Najlepiej, jeśli istnieją hello samą liczbę węzłów na każdym poziomie hierarchii w hello hierarchii domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-142">It is best if there are hello same number of nodes at each level of depth in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="5e3cf-143">Jeśli hello "drzewa" domen błędów jest niezrównoważone w klastrze, utrudni dla hello toofigure Menedżera zasobów klastra limit alokacji najlepsze hello usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-143">If hello “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for hello Cluster Resource Manager toofigure out hello best allocation of services.</span></span> <span data-ttu-id="5e3cf-144">Imbalanced układów domen błędów oznacza hello stratę niektórych domen wpływ hello dostępności usług więcej niż innych domen.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-144">Imbalanced Fault Domains layouts mean that hello loss of some domains impact hello availability of services more than other domains.</span></span> <span data-ttu-id="5e3cf-145">W związku z tym rozerwana hello Menedżera zasobów klastra między dwa cele: chce toouse hello komputerów w domenie "duże" przez umieszczenie na nich usługi i chce tooplace usług w innych domenach, dzięki czemu utrata hello domeny nie powoduje problemów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-145">As a result, hello Cluster Resource Manager is torn between two goals: It wants toouse hello machines in that “heavy” domain by placing services on them, and it wants tooplace services in other domains so that hello loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="5e3cf-146">Jak wyglądają imbalanced domen?</span><span class="sxs-lookup"><span data-stu-id="5e3cf-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="5e3cf-147">W poniższym diagramie hello zostanie przedstawiony dwóch układów innego klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-147">In hello diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="5e3cf-148">W pierwszym przykładzie hello hello węzły są rozmieszczane równomiernie między hello domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-148">In hello first example, hello nodes are distributed evenly across hello Fault Domains.</span></span> <span data-ttu-id="5e3cf-149">W drugim przykładzie hello jednej domenie błędów ma wiele więcej węzłów niż hello innych domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-149">In hello second example, one Fault Domain has many more nodes than hello other Fault Domains.</span></span> 

<span data-ttu-id="5e3cf-150"><center>
![Dwa układów innego klastra][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="5e3cf-151">Na platformie Azure wybór hello domeny błędów zawiera węzeł odbywa się.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-151">In Azure, hello choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="5e3cf-152">Jednak w zależności od hello liczba węzłów, które należy udostępnić można nadal na końcu domen błędów z większą liczbę węzłów w je od innych.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-152">However, depending on hello number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="5e3cf-153">Na przykład, że masz pięć domen błędów w klastrze hello, ale udostępniać siedmiu węzłów dla danego NodeType.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-153">For example, say you have five Fault Domains in hello cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="5e3cf-154">W takim przypadku hello dwóch pierwszych domen błędów końcowa więcej węzłów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-154">In this case, hello first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="5e3cf-155">Jeśli będziesz kontynuować toodeploy więcej elementów NodeType z tylko kilka wystąpień, pogarsza się wraz z pobiera hello problem.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-155">If you continue toodeploy more NodeTypes with only a couple instances, hello problem gets worse.</span></span> <span data-ttu-id="5e3cf-156">Z tego powodu zaleca tego hello liczby węzłów w każdy typ węzła jest wielokrotnością liczby hello liczba domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-156">For this reason it's recommended that hello number of nodes in each node type is a multiple of hello number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="5e3cf-157">Domen uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-157">Upgrade domains</span></span>
<span data-ttu-id="5e3cf-158">Domeny uaktualnienia są kolejnej funkcji, która pomaga hello zasobu klastra sieci szkieletowej programu Service Manager zrozumieć układu hello hello klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-158">Upgrade Domains are another feature that helps hello Service Fabric Cluster Resource Manager understand hello layout of hello cluster.</span></span> <span data-ttu-id="5e3cf-159">Zestawy węzłów, które są uaktualniane na powitania Definiowanie domen uaktualnienia tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-159">Upgrade Domains define sets of nodes that are upgraded at hello same time.</span></span> <span data-ttu-id="5e3cf-160">Informacje o uaktualnienia domen hello Pomoc Menedżera zasobów klastra i organizowania operacje zarządzania, takie jak uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-160">Upgrade Domains help hello Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="5e3cf-161">Domen uaktualnienia są znacznie, takich jak domen błędów, jednak z kilku podstawowych różnic.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="5e3cf-162">Najpierw obszarów awarie sprzętowe skoordynowanego Definiowanie domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="5e3cf-163">Uaktualnienia domen, na hello drugiej strony, są zdefiniowane przez zasady.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-163">Upgrade Domains, on hello other hand, are defined by policy.</span></span> <span data-ttu-id="5e3cf-164">Pobierz toodecide ile mają, zamiast go dyktowanie hello środowisko.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-164">You get toodecide how many you want, rather than it being dictated by hello environment.</span></span> <span data-ttu-id="5e3cf-165">Może mieć dowolną liczbę domen uaktualnienia, jak węzłów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="5e3cf-166">Inna różnica między domenach awarii i uaktualniania domen jest uaktualnienia domen nie są hierarchicznej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="5e3cf-167">Zamiast tego są one bardziej przypominają prostych tagów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="5e3cf-168">Hello Poniższy diagram przedstawia trzy domen uaktualnienia są rozkładane na trzy domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-168">hello following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="5e3cf-169">Przedstawia on także jeden możliwe umieszczania dla trzech różnych repliki usługi stanowej, gdzie każdy kończy się w różnych usterek i domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="5e3cf-170">Ta umieszczania umożliwia hello utraty domeny błędów w hello środka uaktualnieniu usługi i jeszcze jedna kopia hello kodu i danych.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-170">This placement allows hello loss of a Fault Domain while in hello middle of a service upgrade and still have one copy of hello code and data.</span></span>  

<span data-ttu-id="5e3cf-171"><center>
![Umieszczanie o domenach awarii i uaktualniania][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="5e3cf-172">Brak zalet i wad toohaving dużej liczby domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-172">There are pros and cons toohaving large numbers of Upgrade Domains.</span></span> <span data-ttu-id="5e3cf-173">Więcej domen uaktualnienia oznacza, że każdy krok uaktualniania hello jest bardziej szczegółowe i w związku z tym wpływa na mniejszą liczbę węzłów lub usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-173">More Upgrade Domains means each step of hello upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="5e3cf-174">W związku z tym usług mniej ma toomove jednocześnie, wprowadzenie do systemu hello mniejsza ilość danych churn.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-174">As a result, fewer services have toomove at a time, introducing less churn into hello system.</span></span> <span data-ttu-id="5e3cf-175">Zwykle niezawodności tooimprove, ponieważ jest mniejsza usługi hello wpływ jakikolwiek problem wprowadzone podczas uaktualnienia hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-175">This tends tooimprove reliability, since less of hello service is impacted by any issue introduced during hello upgrade.</span></span> <span data-ttu-id="5e3cf-176">Więcej domen uaktualnienia oznacza również wymagają mniej dostępne buforu na innych węzłach toohandle hello skutków hello uaktualnienie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-176">More Upgrade Domains also means that you need less available buffer on other nodes toohandle hello impact of hello upgrade.</span></span> <span data-ttu-id="5e3cf-177">Na przykład jeśli masz pięć domen uaktualnienia węzłów hello w każdym są Obsługa około 20% ruchu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-177">For example, if you have five Upgrade Domains, hello nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="5e3cf-178">Jeśli potrzebujesz tootake dół tej domeny uaktualnienia do uaktualnienia, aby obciążenie zwykle musi toogo innym.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-178">If you need tootake down that Upgrade Domain for an upgrade, that load usually needs toogo somewhere.</span></span> <span data-ttu-id="5e3cf-179">Ponieważ masz cztery pozostałe domeny uaktualnienia, każdy musi mieć miejsce na około 5% Całkowity ruch związany z hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of hello total traffic.</span></span> <span data-ttu-id="5e3cf-180">Więcej domen uaktualnienia oznacza, że należy mniej buforu hello węzłach klastra hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-180">More Upgrade Domains means you need less buffer on hello nodes in hello cluster.</span></span> <span data-ttu-id="5e3cf-181">Rozważmy na przykład, jeśli zamiast tego masz 10 domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="5e3cf-182">W takim przypadku każdy UD czy tylko obsługiwał około 10% Całkowity ruch związany z hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-182">In that case, each UD would only be handling about 10% of hello total traffic.</span></span> <span data-ttu-id="5e3cf-183">Podczas uaktualniania kroki do klastra hello, każdej domeny, będzie potrzebny tylko toohave miejsce na około 1.1% hello ruch związany z.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-183">When an upgrade steps through hello cluster, each domain would only need toohave room for about 1.1% of hello total traffic.</span></span> <span data-ttu-id="5e3cf-184">Więcej domen uaktualnienia zwykle pozwalają toorun węzły na zwiększenie użycia, ponieważ należy pojemności mniejszej zastrzeżone.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-184">More Upgrade Domains generally allow you toorun your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="5e3cf-185">Witaj dotyczy to także domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-185">hello same is true for Fault Domains.</span></span>  

<span data-ttu-id="5e3cf-186">Wadą Hello podwyższonego posiadanie wielu domen uaktualnienia jest, że uaktualnień często tootake dłużej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-186">hello downside of having many Upgrade Domains is that upgrades tend tootake longer.</span></span> <span data-ttu-id="5e3cf-187">Sieć szkieletowa usług oczekuje krótkim czasie po zakończeniu uaktualnienia domeny i sprawdza przed rozpoczęciem powitalne tooupgrade kolejnego.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting tooupgrade hello next one.</span></span> <span data-ttu-id="5e3cf-188">Te opóźnienia włączyć wykrywanie problemów wprowadzone przez hello uaktualnienia, aby mogła być kontynuowana hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-188">These delays enable detecting issues introduced by hello upgrade before hello upgrade proceeds.</span></span> <span data-ttu-id="5e3cf-189">zależnościami Hello jest dopuszczalne, ponieważ uniemożliwia nieprawidłowych zmian w czasie wpływających na zbyt dużej ilości hello usługi.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-189">hello tradeoff is acceptable because it prevents bad changes from affecting too much of hello service at a time.</span></span>

<span data-ttu-id="5e3cf-190">Za mało domen uaktualnienia ma wiele ujemna efekty uboczne — podczas każdej poszczególne domeny uaktualnienia nie działa i uaktualniany duża część ogólną wydajność jest niedostępny.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="5e3cf-191">Na przykład jeśli masz tylko trzy domeny uaktualnienia są tworzone w dół około 1/3 ogólnej usługi lub wydajność klastra naraz.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="5e3cf-192">Jednocześnie o tak wiele usług w dół nie pożądane, ponieważ mają wystarczającą wydajność toohave w hello reszty obciążenie hello toohandle klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-192">Having so much of your service down at once isn’t desirable since you have toohave enough capacity in hello rest of your cluster toohandle hello workload.</span></span> <span data-ttu-id="5e3cf-193">Obsługa tego buforu oznacza, że podczas normalnego działania te węzły są załadowane mniejsze niż w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="5e3cf-194">Powoduje to zwiększenie kosztów hello uruchomienia usługi.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-194">This increases hello cost of running your service.</span></span>

<span data-ttu-id="5e3cf-195">Brak nie rzeczywistych limit toohello całkowitą liczbę błędów lub domen uaktualnienia w środowisku lub ograniczeń jak zachodziły na siebie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-195">There’s no real limit toohello total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="5e3cf-196">Inaczej mówiąc, istnieje kilka typowych wzorców:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="5e3cf-197">Domena awarii oraz domen uaktualnienia mapowane 1:1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="5e3cf-198">Jedną domenę uaktualnienia na węzeł (fizycznych lub wirtualnych wystąpienie systemu operacyjnego)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="5e3cf-199">Model "rozłożone" lub "macierzy" gdzie hello błędów domen i domen uaktualnienia formularz macierzy z zwykle maszynami ukośne podziały hello w dół</span><span class="sxs-lookup"><span data-stu-id="5e3cf-199">A “striped” or “matrix” model where hello Fault Domains and Upgrade Domains form a matrix with machines usually running down hello diagonals</span></span>

<span data-ttu-id="5e3cf-200"><center>
![Błąd i układy domena uaktualnienia][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="5e3cf-201">Istnieje nie najlepsze odpowiedzi które toochoose układu, każdy ma kilka zalet i wad.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-201">There’s no best answer which layout toochoose, each has some pros and cons.</span></span> <span data-ttu-id="5e3cf-202">Na przykład hello 1FD:1UD model działa tooset proste.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-202">For example, hello 1FD:1UD model is simple tooset up.</span></span> <span data-ttu-id="5e3cf-203">Hello jest najbliższe osób, które są używane do 1 domeny uaktualnień na węzeł modelu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-203">hello 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="5e3cf-204">Podczas uaktualniania każdego węzła jest aktualizowana niezależnie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="5e3cf-205">Jest to podobne toohow małych zestawów maszyn zostały uaktualnione ręcznie w przeszłości hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-205">This is similar toohow small sets of machines were upgraded manually in hello past.</span></span> 

<span data-ttu-id="5e3cf-206">najbardziej typowe model Hello jest hello FD/UD macierzy, gdzie hello FDs i UDs tabeli i węzły są umieszczane uruchamianie wzdłuż hello ukośnych.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-206">hello most common model is hello FD/UD matrix, where hello FDs and UDs form a table and nodes are placed starting along hello diagonal.</span></span> <span data-ttu-id="5e3cf-207">To jest model hello używany domyślnie w klastrach usługi sieć szkieletowa na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-207">This is hello model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="5e3cf-208">W przypadku klastrów z węzłami wiele wszystko, co kończy się wyszukiwanie like wzór dense macierzy hello powyżej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-208">For clusters with many nodes everything ends up looking like hello dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="5e3cf-209">Ograniczenia usterek i domeny uaktualnienia i efekty</span><span class="sxs-lookup"><span data-stu-id="5e3cf-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="5e3cf-210">Witaj Menedżera zasobów klastra traktuje desire hello tookeep usługi równoważone awarii i uaktualniania domeny jako ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-210">hello Cluster Resource Manager treats hello desire tookeep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="5e3cf-211">Można znaleźć więcej informacji na temat ograniczeń [w tym artykule](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="5e3cf-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="5e3cf-212">Witaj usterek i domeny uaktualnienia stanu ograniczenia: "dla partycji dana usługa nigdy nie należy różnica *więcej niż jeden* hello wiele obiektów usługi (wystąpień usługi bezstanowej lub usługi stanowej repliki) między dwiema domenami."</span><span class="sxs-lookup"><span data-stu-id="5e3cf-212">hello Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in hello number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="5e3cf-213">Zapobiega to niektórych przenosi lub zasady, które naruszają to ograniczenie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="5e3cf-214">Oto przykład.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-214">Let's look at one example.</span></span> <span data-ttu-id="5e3cf-215">Załóżmy, że mamy klastra z sześciu węzłów skonfigurowany z pięciu domen błędów i pięć domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="5e3cf-216">FD0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-216">FD0</span></span> | <span data-ttu-id="5e3cf-217">FD1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-217">FD1</span></span> | <span data-ttu-id="5e3cf-218">FD2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-218">FD2</span></span> | <span data-ttu-id="5e3cf-219">FD3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-219">FD3</span></span> | <span data-ttu-id="5e3cf-220">FD4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="5e3cf-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-221">**UD0**</span></span> |<span data-ttu-id="5e3cf-222">N1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-222">N1</span></span> | | | | |
| <span data-ttu-id="5e3cf-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-223">**UD1**</span></span> |<span data-ttu-id="5e3cf-224">N6</span><span class="sxs-lookup"><span data-stu-id="5e3cf-224">N6</span></span> |<span data-ttu-id="5e3cf-225">N2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-225">N2</span></span> | | | |
| <span data-ttu-id="5e3cf-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-226">**UD2**</span></span> | | |<span data-ttu-id="5e3cf-227">N3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-227">N3</span></span> | | |
| <span data-ttu-id="5e3cf-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-228">**UD3**</span></span> | | | |<span data-ttu-id="5e3cf-229">N4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-229">N4</span></span> | |
| <span data-ttu-id="5e3cf-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-230">**UD4**</span></span> | | | | |<span data-ttu-id="5e3cf-231">N5</span><span class="sxs-lookup"><span data-stu-id="5e3cf-231">N5</span></span> |

<span data-ttu-id="5e3cf-232">Teraz załóżmy, że firma Microsoft Tworzenie usługi z TargetReplicaSetSize (lub dla usługi bezstanowej jako wartość InstanceCount) pięć.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="5e3cf-233">Witaj replik ziemi na N1 N5.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-233">hello replicas land on N1-N5.</span></span> <span data-ttu-id="5e3cf-234">W rzeczywistości N6 nie jest nigdy używane niezależnie od tego, ile usługi, takie jak ta, którą utworzysz.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="5e3cf-235">Ale Dlaczego?</span><span class="sxs-lookup"><span data-stu-id="5e3cf-235">But why?</span></span> <span data-ttu-id="5e3cf-236">Przyjrzyjmy się hello różnica między hello bieżący układ i co się stanie, jeśli wybrano opcję N6.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-236">Let's look at hello difference between hello current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="5e3cf-237">Oto układu hello firma Microsoft uzyskano i hello całkowitej liczby replik na usterek i domeny uaktualnienia:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-237">Here's hello layout we got and hello total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="5e3cf-238">FD0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-238">FD0</span></span> | <span data-ttu-id="5e3cf-239">FD1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-239">FD1</span></span> | <span data-ttu-id="5e3cf-240">FD2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-240">FD2</span></span> | <span data-ttu-id="5e3cf-241">FD3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-241">FD3</span></span> | <span data-ttu-id="5e3cf-242">FD4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-242">FD4</span></span> | <span data-ttu-id="5e3cf-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="5e3cf-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="5e3cf-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-244">**UD0**</span></span> |<span data-ttu-id="5e3cf-245">R1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-245">R1</span></span> | | | | |<span data-ttu-id="5e3cf-246">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-246">1</span></span> |
| <span data-ttu-id="5e3cf-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-247">**UD1**</span></span> | |<span data-ttu-id="5e3cf-248">R2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-248">R2</span></span> | | | |<span data-ttu-id="5e3cf-249">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-249">1</span></span> |
| <span data-ttu-id="5e3cf-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-250">**UD2**</span></span> | | |<span data-ttu-id="5e3cf-251">R3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-251">R3</span></span> | | |<span data-ttu-id="5e3cf-252">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-252">1</span></span> |
| <span data-ttu-id="5e3cf-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-253">**UD3**</span></span> | | | |<span data-ttu-id="5e3cf-254">R4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-254">R4</span></span> | |<span data-ttu-id="5e3cf-255">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-255">1</span></span> |
| <span data-ttu-id="5e3cf-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-256">**UD4**</span></span> | | | | |<span data-ttu-id="5e3cf-257">R5</span><span class="sxs-lookup"><span data-stu-id="5e3cf-257">R5</span></span> |<span data-ttu-id="5e3cf-258">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-258">1</span></span> |
| <span data-ttu-id="5e3cf-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-259">**FDTotal**</span></span> |<span data-ttu-id="5e3cf-260">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-260">1</span></span> |<span data-ttu-id="5e3cf-261">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-261">1</span></span> |<span data-ttu-id="5e3cf-262">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-262">1</span></span> |<span data-ttu-id="5e3cf-263">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-263">1</span></span> |<span data-ttu-id="5e3cf-264">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-264">1</span></span> |- |

<span data-ttu-id="5e3cf-265">Ten układ jest równoważony pod względem węzłów na domenie błędów i domeny uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="5e3cf-266">Jest również ze zrównoważonym pod względem hello liczby replik na usterek i domeny uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-266">It is also balanced in terms of hello number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="5e3cf-267">Każda domena ma hello tej samej liczby węzłów i hello tej samej liczby replik.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-267">Each domain has hello same number of nodes and hello same number of replicas.</span></span>

<span data-ttu-id="5e3cf-268">Teraz Przyjrzyjmy się co się stanie, jeśli ma użyliśmy N6 zamiast N2.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="5e3cf-269">Jak będzie replik hello rozdzielona następnie?</span><span class="sxs-lookup"><span data-stu-id="5e3cf-269">How would hello replicas be distributed then?</span></span>

|  | <span data-ttu-id="5e3cf-270">FD0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-270">FD0</span></span> | <span data-ttu-id="5e3cf-271">FD1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-271">FD1</span></span> | <span data-ttu-id="5e3cf-272">FD2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-272">FD2</span></span> | <span data-ttu-id="5e3cf-273">FD3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-273">FD3</span></span> | <span data-ttu-id="5e3cf-274">FD4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-274">FD4</span></span> | <span data-ttu-id="5e3cf-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="5e3cf-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="5e3cf-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-276">**UD0**</span></span> |<span data-ttu-id="5e3cf-277">R1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-277">R1</span></span> | | | | |<span data-ttu-id="5e3cf-278">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-278">1</span></span> |
| <span data-ttu-id="5e3cf-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-279">**UD1**</span></span> |<span data-ttu-id="5e3cf-280">R5</span><span class="sxs-lookup"><span data-stu-id="5e3cf-280">R5</span></span> | | | | |<span data-ttu-id="5e3cf-281">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-281">1</span></span> |
| <span data-ttu-id="5e3cf-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-282">**UD2**</span></span> | | |<span data-ttu-id="5e3cf-283">R2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-283">R2</span></span> | | |<span data-ttu-id="5e3cf-284">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-284">1</span></span> |
| <span data-ttu-id="5e3cf-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-285">**UD3**</span></span> | | | |<span data-ttu-id="5e3cf-286">R3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-286">R3</span></span> | |<span data-ttu-id="5e3cf-287">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-287">1</span></span> |
| <span data-ttu-id="5e3cf-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-288">**UD4**</span></span> | | | | |<span data-ttu-id="5e3cf-289">R4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-289">R4</span></span> |<span data-ttu-id="5e3cf-290">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-290">1</span></span> |
| <span data-ttu-id="5e3cf-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-291">**FDTotal**</span></span> |<span data-ttu-id="5e3cf-292">2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-292">2</span></span> |<span data-ttu-id="5e3cf-293">0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-293">0</span></span> |<span data-ttu-id="5e3cf-294">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-294">1</span></span> |<span data-ttu-id="5e3cf-295">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-295">1</span></span> |<span data-ttu-id="5e3cf-296">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-296">1</span></span> |- |

<span data-ttu-id="5e3cf-297">Ten układ narusza naszych definicji hello ograniczenia domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-297">This layout violates our definition for hello Fault Domain constraint.</span></span> <span data-ttu-id="5e3cf-298">FD0 ma dwie repliki podczas FD1 ma wartość 0, wprowadzania hello rozróżnia FD0 i FD1 całkowitej liczby dwa.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-298">FD0 has two replicas, while FD1 has zero, making hello difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="5e3cf-299">Witaj Menedżera zasobów klastra nie zezwala na to rozmieszczenie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-299">hello Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="5e3cf-300">Podobnie jeśli mamy pobrane N2 i N6 (zamiast N1, jak i N2) możemy uzyskać:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="5e3cf-301">FD0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-301">FD0</span></span> | <span data-ttu-id="5e3cf-302">FD1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-302">FD1</span></span> | <span data-ttu-id="5e3cf-303">FD2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-303">FD2</span></span> | <span data-ttu-id="5e3cf-304">FD3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-304">FD3</span></span> | <span data-ttu-id="5e3cf-305">FD4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-305">FD4</span></span> | <span data-ttu-id="5e3cf-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="5e3cf-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="5e3cf-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-307">**UD0**</span></span> | | | | | |<span data-ttu-id="5e3cf-308">0</span><span class="sxs-lookup"><span data-stu-id="5e3cf-308">0</span></span> |
| <span data-ttu-id="5e3cf-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-309">**UD1**</span></span> |<span data-ttu-id="5e3cf-310">R5</span><span class="sxs-lookup"><span data-stu-id="5e3cf-310">R5</span></span> |<span data-ttu-id="5e3cf-311">R1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-311">R1</span></span> | | | |<span data-ttu-id="5e3cf-312">2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-312">2</span></span> |
| <span data-ttu-id="5e3cf-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-313">**UD2**</span></span> | | |<span data-ttu-id="5e3cf-314">R2</span><span class="sxs-lookup"><span data-stu-id="5e3cf-314">R2</span></span> | | |<span data-ttu-id="5e3cf-315">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-315">1</span></span> |
| <span data-ttu-id="5e3cf-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-316">**UD3**</span></span> | | | |<span data-ttu-id="5e3cf-317">R3</span><span class="sxs-lookup"><span data-stu-id="5e3cf-317">R3</span></span> | |<span data-ttu-id="5e3cf-318">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-318">1</span></span> |
| <span data-ttu-id="5e3cf-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-319">**UD4**</span></span> | | | | |<span data-ttu-id="5e3cf-320">R4</span><span class="sxs-lookup"><span data-stu-id="5e3cf-320">R4</span></span> |<span data-ttu-id="5e3cf-321">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-321">1</span></span> |
| <span data-ttu-id="5e3cf-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="5e3cf-322">**FDTotal**</span></span> |<span data-ttu-id="5e3cf-323">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-323">1</span></span> |<span data-ttu-id="5e3cf-324">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-324">1</span></span> |<span data-ttu-id="5e3cf-325">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-325">1</span></span> |<span data-ttu-id="5e3cf-326">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-326">1</span></span> |<span data-ttu-id="5e3cf-327">1</span><span class="sxs-lookup"><span data-stu-id="5e3cf-327">1</span></span> |- |

<span data-ttu-id="5e3cf-328">Ten układ jest równoważony pod względem domen błędów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="5e3cf-329">Jednak obecnie go narusza ograniczenie domeny uaktualnienia hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-329">However, now it's violating hello Upgrade Domain constraint.</span></span> <span data-ttu-id="5e3cf-330">Jest to spowodowane UD0 nie zero replik UD1 ma dwa.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="5e3cf-331">W związku z tym ten układ również jest nieprawidłowy i nie można pobrać przez hello Menedżera zasobów klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-331">Therefore, this layout is also invalid and won't be picked by hello Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="5e3cf-332">Konfigurowanie usterek i domen uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="5e3cf-333">Definiowanie domen błędów i uaktualnienia domeny odbywa się automatycznie w Azure obsługiwane wdrożenia usługi sieć szkieletowa usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="5e3cf-334">Sieć szkieletowa usług przejmuje i używa informacji o środowisku hello z platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-334">Service Fabric picks up and uses hello environment information from Azure.</span></span>

<span data-ttu-id="5e3cf-335">Jeśli tworzenia własnego klastra (lub mają toorun określonego topologii w rozwoju) możesz podać informacje o domenie błędów i domeny uaktualnienia hello samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-335">If you’re creating your own cluster (or want toorun a particular topology in development), you can provide hello Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="5e3cf-336">W tym przykładzie definiujemy dziewięć węzła lokalnego klastra projektowego obejmującej trzy "centrów danych" (każdy z trzech stojakami).</span><span class="sxs-lookup"><span data-stu-id="5e3cf-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="5e3cf-337">Ten klaster ma również trzy domeny uaktualnienia rozłożone na tych trzech centrów danych.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="5e3cf-338">Przykład Witaj konfiguracji znajduje się poniżej:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-338">An example of hello configuration is below:</span></span> 

<span data-ttu-id="5e3cf-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="5e3cf-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="5e3cf-340">za pomocą pliku ClusterConfig.json we wdrożeniach autonomicznych</span><span class="sxs-lookup"><span data-stu-id="5e3cf-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="5e3cf-341">Podczas definiowania klastrów za pomocą usługi Azure Resource Manager, domenach awarii i uaktualniania domeny są przypisywane przez platformę Azure.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="5e3cf-342">W związku z tym definicja hello typy węzłów i zestawy skalowania maszyny wirtualnej w szablonie usługi Azure Resource Manager nie obejmuje domena awarii lub uaktualnienia domeny.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-342">Therefore, hello definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="5e3cf-343">Właściwości węzła i ograniczenia dotyczące umieszczania</span><span class="sxs-lookup"><span data-stu-id="5e3cf-343">Node properties and placement constraints</span></span>
<span data-ttu-id="5e3cf-344">Czasami (w rzeczywistości w większości przypadków hello), który ma tooensure toowant, który niektórych obciążeń Uruchom tylko dla niektórych typów węzłów w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-344">Sometimes (in fact, most of hello time) you’re going toowant tooensure that certain workloads run only on certain types of nodes in hello cluster.</span></span> <span data-ttu-id="5e3cf-345">Na przykład niektóre obciążenie może wymagać GPU lub dyski SSD, a niektóre nie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="5e3cf-346">Doskonałe przykład docelowych obciążeń tooparticular sprzętu jest niemal każdego tam n warstwowa architektury.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-346">A great example of targeting hardware tooparticular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="5e3cf-347">Niektórych maszyn i służyć jako hello frontonu lub interfejsu API obsługujący strony aplikacji hello są uwidocznione toohello klientów lub hello internet.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-347">Certain machines serve as hello front end or API serving side of hello application and are exposed toohello clients or hello internet.</span></span> <span data-ttu-id="5e3cf-348">Różnych maszynach, często z zasoby sprzętowe obsługi zadań hello hello warstw obliczeń lub magazynu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-348">Different machines, often with different hardware resources, handle hello work of hello compute or storage layers.</span></span> <span data-ttu-id="5e3cf-349">Są to zazwyczaj _nie_ bezpośrednio widoczne tooclients lub hello internet.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-349">These are usually _not_ directly exposed tooclients or hello internet.</span></span> <span data-ttu-id="5e3cf-350">Sieci szkieletowej usług oczekuje, że istnieją przypadki, w której obciążeń w szczególności muszą toorun w konfiguracjach konkretnego sprzętu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-350">Service Fabric expects that there are cases where particular workloads need toorun on particular hardware configurations.</span></span> <span data-ttu-id="5e3cf-351">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-351">For example:</span></span>

* <span data-ttu-id="5e3cf-352">istniejącą aplikację n warstwowa został "unosiło i przesunięte" w środowisku sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="5e3cf-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="5e3cf-353">Obciążenie potrzebuje toorun na temat sprzętu dla wydajności, skala lub ze względów bezpieczeństwa izolacji</span><span class="sxs-lookup"><span data-stu-id="5e3cf-353">a workload wants toorun on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="5e3cf-354">Obciążenia powinna zostać odizolowana od innych obciążeń powodów przez zasady lub zasobów</span><span class="sxs-lookup"><span data-stu-id="5e3cf-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="5e3cf-355">Usługi konfiguracji, tego rodzaju toosupport pierwszej klasie pojęcie tagi, które mogą być zastosowane toonodes ma sieci szkieletowej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-355">toosupport these sorts of configurations, Service Fabric has a first class notion of tags that can be applied toonodes.</span></span> <span data-ttu-id="5e3cf-356">Tagi te są nazywane **— właściwości węzła**.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-356">These tags are called **node properties**.</span></span> <span data-ttu-id="5e3cf-357">**Ograniczenia dotyczące umieszczania** są instrukcje hello dołączony tooindividual usług, które wybierz dla co najmniej jednej właściwości węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-357">**Placement constraints** are hello statements attached tooindividual services that select for one or more node properties.</span></span> <span data-ttu-id="5e3cf-358">Ograniczenia dotyczące umieszczania zdefiniować, gdzie mają być uruchamiane usługi.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="5e3cf-359">zestaw ograniczeń Hello jest otwarty — wszystkie pary klucz/wartość można pracować.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-359">hello set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="5e3cf-360"><center>
![Układ różnych obciążeń klastra][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="5e3cf-361">Wbudowane właściwości węzła</span><span class="sxs-lookup"><span data-stu-id="5e3cf-361">Built in node properties</span></span>
<span data-ttu-id="5e3cf-362">Sieć szkieletowa usług definiuje właściwości węzła niektóre domyślne, które mogą być używane automatycznie bez hello użytkownika mającego toodefine je.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-362">Service Fabric defines some default node properties that can be used automatically without hello user having toodefine them.</span></span> <span data-ttu-id="5e3cf-363">Witaj domyślne właściwości zdefiniowane w każdym węźle to hello **NodeType** i hello **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-363">hello default properties defined at each node are hello **NodeType** and hello **NodeName**.</span></span> <span data-ttu-id="5e3cf-364">Tak na przykład można zapisać jako ograniczenia umieszczania `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="5e3cf-365">Ogólnie rzecz biorąc znaleźliśmy NodeType toobe jedna z właściwości hello najczęściej używane.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-365">Generally we have found NodeType toobe one of hello most commonly used properties.</span></span> <span data-ttu-id="5e3cf-366">Jest przydatne, ponieważ odpowiada ona 1:1 z typem maszyny.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="5e3cf-367">Każdy typ maszyny odpowiada tooa typu obciążenia w tradycyjny n poziomowej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-367">Each type of machine corresponds tooa type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="5e3cf-368"><center>
![Ograniczenia dotyczące umieszczania i właściwości węzła][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="5e3cf-369">Ograniczenia umieszczania i składni właściwości węzła</span><span class="sxs-lookup"><span data-stu-id="5e3cf-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="5e3cf-370">wartość Hello określony we właściwości węzła hello może być typu string, bool, lub podpisany za długo.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-370">hello value specified in hello node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="5e3cf-371">Instrukcja Hello usługa hello jest nazywany położenia *ograniczenia* ponieważ ogranicza, gdzie hello usługa może zostać uruchomiona w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-371">hello statement at hello service is called a placement *constraint* since it constrains where hello service can run in hello cluster.</span></span> <span data-ttu-id="5e3cf-372">ograniczenie Hello można wszystkie logiczne instrukcji, która działa na powitania właściwości innego węzła w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-372">hello constraint can be any Boolean statement that operates on hello different node properties in hello cluster.</span></span> <span data-ttu-id="5e3cf-373">selektory prawidłowy Hello w tych instrukcjach logiczne są:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-373">hello valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="5e3cf-374">warunkowe sprawdza, czy tworzenie konkretnego instrukcje</span><span class="sxs-lookup"><span data-stu-id="5e3cf-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="5e3cf-375">— Instrukcja</span><span class="sxs-lookup"><span data-stu-id="5e3cf-375">Statement</span></span> | <span data-ttu-id="5e3cf-376">Składnia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="5e3cf-377">"równe"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-377">"equal to"</span></span> | <span data-ttu-id="5e3cf-378">"=="</span><span class="sxs-lookup"><span data-stu-id="5e3cf-378">"=="</span></span> |
| <span data-ttu-id="5e3cf-379">"nie równa się"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-379">"not equal to"</span></span> | <span data-ttu-id="5e3cf-380">"!="</span><span class="sxs-lookup"><span data-stu-id="5e3cf-380">"!="</span></span> |
| <span data-ttu-id="5e3cf-381">"większe niż"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-381">"greater than"</span></span> | <span data-ttu-id="5e3cf-382">">"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-382">">"</span></span> |
| <span data-ttu-id="5e3cf-383">"większe lub równe"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-383">"greater than or equal to"</span></span> | <span data-ttu-id="5e3cf-384">">="</span><span class="sxs-lookup"><span data-stu-id="5e3cf-384">">="</span></span> |
| <span data-ttu-id="5e3cf-385">"mniejsze niż"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-385">"less than"</span></span> | <span data-ttu-id="5e3cf-386">"<"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-386">"<"</span></span> |
| <span data-ttu-id="5e3cf-387">"mniejsze niż lub równe"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-387">"less than or equal to"</span></span> | <span data-ttu-id="5e3cf-388">"<="</span><span class="sxs-lookup"><span data-stu-id="5e3cf-388">"<="</span></span> |

2) <span data-ttu-id="5e3cf-389">wartość logiczna instrukcje dla operacji grupowania i logicznych</span><span class="sxs-lookup"><span data-stu-id="5e3cf-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="5e3cf-390">— Instrukcja</span><span class="sxs-lookup"><span data-stu-id="5e3cf-390">Statement</span></span> | <span data-ttu-id="5e3cf-391">Składnia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="5e3cf-392">"i"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-392">"and"</span></span> | <span data-ttu-id="5e3cf-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-393">"&&"</span></span> |
| <span data-ttu-id="5e3cf-394">"lub"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-394">"or"</span></span> | <span data-ttu-id="5e3cf-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="5e3cf-396">"nie"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-396">"not"</span></span> | <span data-ttu-id="5e3cf-397">"!"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-397">"!"</span></span> |
| <span data-ttu-id="5e3cf-398">"grupy jako pojedynczej instrukcji"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-398">"group as single statement"</span></span> | <span data-ttu-id="5e3cf-399">"()"</span><span class="sxs-lookup"><span data-stu-id="5e3cf-399">"()"</span></span> |

<span data-ttu-id="5e3cf-400">Oto kilka przykładów podstawowy warunek ograniczający instrukcji.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="5e3cf-401">Tylko węzły, w którym hello ogólne instrukcji ograniczenia umieszczania ocenia zbyt "True" może mieć usługi hello umieścić na nim.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-401">Only nodes where hello overall placement constraint statement evaluates too“True” can have hello service placed on it.</span></span> <span data-ttu-id="5e3cf-402">Węzły, które nie mają właściwość zdefiniowaną są niezgodne z wszystkich ograniczeń umieszczania zawierającą tej właściwości.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="5e3cf-403">Załóżmy, że hello następującego węzła, które właściwości zostały zdefiniowane dla typu węzła:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-403">Let’s say that hello following node properties were defined for a given node type:</span></span>

<span data-ttu-id="5e3cf-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="5e3cf-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="5e3cf-405">za pomocą pliku ClusterConfig.json dla autonomicznych wdrożeniach lub Template.json dla platformy Azure hostowanej klastrów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="5e3cf-406">W węźle hello szablonu usługi Azure Resource Manager jest zwykle parametry typu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-406">In your Azure Resource Manager template hello node type is usually parameterized.</span></span> <span data-ttu-id="5e3cf-407">Jego wygląd "[parameters('vmNodeType1Name')]" zamiast "NodeType01".</span><span class="sxs-lookup"><span data-stu-id="5e3cf-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="5e3cf-408">Można utworzyć usługi umieszczania *ograniczenia* usług, takich jak następujące:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="5e3cf-409">C#</span><span class="sxs-lookup"><span data-stu-id="5e3cf-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="5e3cf-410">Środowiska PowerShell:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="5e3cf-411">Jeśli wszystkie węzły NodeType01 są prawidłowe, możesz też wybrać ten typ węzła z ograniczeniem hello "(NodeType == NodeType01)".</span><span class="sxs-lookup"><span data-stu-id="5e3cf-411">If all nodes of NodeType01 are valid, you can also select that node type with hello constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="5e3cf-412">Jest z hello chłodnych czynności dotyczących ograniczenia umieszczania usług, że mogą być aktualizowane dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-412">One of hello cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="5e3cf-413">Dlatego jeśli zajdzie potrzeba, można przenosić usługi klastrowania hello, dodawać i usuwać wymagania, np. Sieć szkieletowa usług odpowiada on za zapewnienie, że usługa hello pozostaje w górę i dostępne nawet wtedy, gdy tego rodzaju zmiany zostały wprowadzone.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-413">So if you need to, you can move a service around in hello cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that hello service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="5e3cf-414">C#:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="5e3cf-415">Środowiska PowerShell:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="5e3cf-416">Ograniczenia dotyczące umieszczania są określone dla każdego wystąpienia usługi o nazwie innej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="5e3cf-417">Zawsze przeprowadzać aktualizacje hello z (Zastąp) co został wcześniej określony.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-417">Updates always take hello place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="5e3cf-418">Definicja klastra Hello definiuje właściwości hello w węźle.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-418">hello cluster definition defines hello properties on a node.</span></span> <span data-ttu-id="5e3cf-419">Zmiana właściwości węzła wymaga uaktualnienia konfiguracji klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="5e3cf-420">Uaktualnienie właściwości węzła wymaga tooreport toorestart każdego węzła dotyczy nowej właściwości.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-420">Upgrading a node's properties requires each affected node toorestart tooreport its new properties.</span></span> <span data-ttu-id="5e3cf-421">Te uaktualnienia stopniowego są zarządzane przez sieć szkieletowa usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="5e3cf-422">Opisu i zarządzanie zasobami klastra</span><span class="sxs-lookup"><span data-stu-id="5e3cf-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="5e3cf-423">Jedną z najważniejszych zadań żadnych orchestrator jest toohelp hello Zarządzanie zużycie zasobów w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-423">One of hello most important jobs of any orchestrator is toohelp manage resource consumption in hello cluster.</span></span> <span data-ttu-id="5e3cf-424">Zarządzanie zasobami klastra może oznaczać kilka różnych rzeczy.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="5e3cf-425">Po pierwsze jest zapewnienie maszyny nie są przeciążone.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="5e3cf-426">Oznacza to, upewniając się, że maszyny nie są uruchomione usługi więcej niż ich może obsłużyć.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="5e3cf-427">Po drugie istnieje równoważenia i optymalizacji, czyli usług krytycznych toorunning wydajnie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-427">Second, there's balancing and optimization which is critical toorunning services efficiently.</span></span> <span data-ttu-id="5e3cf-428">Kosztu oferty usługi poufnych wprowadzenia ani wydajności nie może dopuścić toobe niektóre węzły gorących a inne zimnych.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-428">Cost effective or performance sensitive service offerings can't allow some nodes toobe hot while others are cold.</span></span> <span data-ttu-id="5e3cf-429">Węzły gorących prowadzić rywalizacji tooresource i pogorszenie wydajności i zimnych węzły reprezentują niewykorzystana zasobów i wyższe koszty.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-429">Hot nodes lead tooresource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="5e3cf-430">Sieć szkieletowa usług reprezentuje zasoby jako `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="5e3cf-431">Metryki są dowolnego zasobu logiczną lub fizyczną, które mają tooService toodescribe sieci szkieletowej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-431">Metrics are any logical or physical resource that you want toodescribe tooService Fabric.</span></span> <span data-ttu-id="5e3cf-432">Przykłady metryki to np. "WorkQueueDepth" lub "MemoryInMb".</span><span class="sxs-lookup"><span data-stu-id="5e3cf-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="5e3cf-433">Uzyskać informacji o zasoby fizyczne hello rządzących sieci szkieletowej usług w węzłach, zobacz [ładu zasobów](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="5e3cf-433">For information about hello physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="5e3cf-434">Aby uzyskać informacje na temat konfigurowania niestandardowych metryk i ich zastosowań, zobacz [w tym artykule](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="5e3cf-435">Metryki różnią się od ograniczenia rozmieszczanie i właściwości węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="5e3cf-436">Właściwości węzła są statyczne deskryptorów hello w poszczególnych węzłach.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-436">Node properties are static descriptors of hello nodes themselves.</span></span> <span data-ttu-id="5e3cf-437">Metryki opisano zasoby, które mają węzłów i że korzystać z usług uruchamianych w węźle.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="5e3cf-438">Właściwość węzła może być "HasSSD" i można ustawić tootrue, lub FAŁSZ.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-438">A node property could be "HasSSD" and could be set tootrue or false.</span></span> <span data-ttu-id="5e3cf-439">Witaj ilość dostępnego miejsca na tym dysków SSD i jaka jest używane przez usługi będą metrykę, takie jak "DriveSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="5e3cf-439">hello amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="5e3cf-440">Jest ważne toonote, który podobnie jak ograniczenia dotyczące umieszczania i właściwości węzła hello zasobu klastra sieci szkieletowej programu Service Manager nie zrozumieć, jakie nazwy hello hello metryki średniej.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-440">It is important toonote that just like for placement constraints and node properties, hello Service Fabric Cluster Resource Manager doesn't understand what hello names of hello metrics mean.</span></span> <span data-ttu-id="5e3cf-441">Nazwy metryki są tylko ciągi.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-441">Metric names are just strings.</span></span> <span data-ttu-id="5e3cf-442">Należy dobrze toodeclare jednostki jako część nazwy metryki hello, które są tworzone podczas może być niejednoznaczna.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-442">It is a good practice toodeclare units as a part of hello metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="5e3cf-443">Pojemność</span><span class="sxs-lookup"><span data-stu-id="5e3cf-443">Capacity</span></span>
<span data-ttu-id="5e3cf-444">Jeśli wyłączysz wszystkich zasobów *równoważenia*, Menedżer zasobów klastra usługi sieć szkieletowa będzie nadal upewnij się, że żaden węzeł nie zakończył za pośrednictwem jego pojemność.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="5e3cf-445">Zarządzanie przepełnienia pojemności jest możliwa, chyba że klaster hello jest zapełniony lub obciążenia hello jest większy niż dowolnego węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-445">Managing capacity overruns is possible unless hello cluster is too full or hello workload is larger than any node.</span></span> <span data-ttu-id="5e3cf-446">Pojemność jest inny *ograniczenia* tego hello Menedżera zasobów klastra używa toounderstand ilości zasobów, a węzeł ma.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-446">Capacity is another *constraint* that hello Cluster Resource Manager uses toounderstand how much of a resource a node has.</span></span> <span data-ttu-id="5e3cf-447">Pozostała pojemność jest również śledzona hello klastra jako całość.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-447">Remaining capacity is also tracked for hello cluster as a whole.</span></span> <span data-ttu-id="5e3cf-448">Zarówno hello pojemności, jak i zużycia hello na poziomie usługi hello są wyrażone w metryki.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-448">Both hello capacity and hello consumption at hello service level are expressed in terms of metrics.</span></span> <span data-ttu-id="5e3cf-449">Tak na przykład metryka hello może być "ClientConnections" i podany węzeł może mieć pojemność "ClientConnections" z 32768.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-449">So for example, hello metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="5e3cf-450">Inne węzły mogą mieć inne ograniczenia niektórych usługa jest uruchomiona w tym może węzła powiedz go obecnie zajmuje 32256 hello metryki "ClientConnections".</span><span class="sxs-lookup"><span data-stu-id="5e3cf-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of hello metric "ClientConnections".</span></span>

<span data-ttu-id="5e3cf-451">W czasie wykonywania hello Menedżera zasobów klastra śledzi pozostałe zasoby w klastrze hello i na węzłach.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-451">During runtime, hello Cluster Resource Manager tracks remaining capacity in hello cluster and on nodes.</span></span> <span data-ttu-id="5e3cf-452">W kolejności tootrack hello pojemności Menedżera zasobów klastra odejmuje użycia każdej usługi, z którym jest uruchomiona usługa hello pojemność węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-452">In order tootrack capacity hello Cluster Resource Manager subtracts each service's usage from node's capacity where hello service runs.</span></span> <span data-ttu-id="5e3cf-453">Dzięki tym informacjom hello zasobu klastra sieci szkieletowej programu Service Manager można dowiedzieć się, gdzie tooplace lub przenieść repliki tak, aby węzły nie przekazywane pojemności.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-453">With this information, hello Service Fabric Cluster Resource Manager can figure out where tooplace or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="5e3cf-454"><center>
![Węzły klastra i pojemności][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="5e3cf-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="5e3cf-455">C#:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="5e3cf-456">Środowiska PowerShell:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="5e3cf-457">Możesz sprawdzić możliwości zdefiniowane w manifeście klastra hello:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-457">You can see capacities defined in hello cluster manifest:</span></span>

<span data-ttu-id="5e3cf-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="5e3cf-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="5e3cf-459">za pomocą pliku ClusterConfig.json dla autonomicznych wdrożeniach lub Template.json dla platformy Azure hostowanej klastrów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="5e3cf-460">Zazwyczaj usługa załadować zmiany dynamicznie.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="5e3cf-461">Załóżmy, że obciążenie repliki "ClientConnections" zmieniła się z 1024 too2048, ale węzła hello była uruchomiona na następnie tylko była dostępna dla tej metryki wydajność 512.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-461">Say that a replica's load of "ClientConnections" changed from 1024 too2048, but hello node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="5e3cf-462">Teraz ta replika lub położenia wystąpienia jest nieprawidłowa, ponieważ nie ma wystarczającej ilości miejsca, w tym węźle.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="5e3cf-463">Witaj Menedżera zasobów klastra ma tookick w i uzyskać węzła hello niż pojemność.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-463">hello Cluster Resource Manager has tookick in and get hello node back below capacity.</span></span> <span data-ttu-id="5e3cf-464">Zmniejsza obciążenie hello węzeł, który znajduje się nad pojemności przenosząc przynajmniej jednej z replik hello lub wystąpień z węzłów tooother tego węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-464">It reduces load on hello node that is over capacity by moving one or more of hello replicas or instances from that node tooother nodes.</span></span> <span data-ttu-id="5e3cf-465">Podczas przenoszenia replik, hello Menedżera zasobów klastra próbuje koszt hello toominimize tych przepływów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-465">When moving replicas, hello Cluster Resource Manager tries toominimize hello cost of those movements.</span></span> <span data-ttu-id="5e3cf-466">Koszt przeniesienia została szczegółowo opisana w [w tym artykule](service-fabric-cluster-resource-manager-movement-cost.md) i bardziej o hello Menedżera zasobów klastra na ponowne równoważenie strategie i opisano reguły [tutaj](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="5e3cf-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about hello Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="5e3cf-467">Pojemność klastra</span><span class="sxs-lookup"><span data-stu-id="5e3cf-467">Cluster capacity</span></span>
<span data-ttu-id="5e3cf-468">W jaki sposób hello ogólną hello keep Menedżera zasobów klastra sieci szkieletowej usług klastra jest zapełniony?</span><span class="sxs-lookup"><span data-stu-id="5e3cf-468">So how does hello Service Fabric Cluster Resource Manager keep hello overall cluster from being too full?</span></span> <span data-ttu-id="5e3cf-469">Również z dynamicznego obciążenia nie istnieje wiele go wykonać.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="5e3cf-470">Usługi mogą mieć ich kolekcji obciążenia niezależnie od akcje wykonywane przez hello Menedżera zasobów klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-470">Services can have their load spike independently of actions taken by hello Cluster Resource Manager.</span></span> <span data-ttu-id="5e3cf-471">W związku z tym klastra za pomocą szerokie możliwości rozbudowy dzisiaj może być za słaby, gdy stanie się Słynne jutro.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="5e3cf-472">Inaczej mówiąc, brak niektórych formantów, które są rozszerzania tooprevent problemy.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-472">That said, there are some controls that are baked in tooprevent problems.</span></span> <span data-ttu-id="5e3cf-473">Witaj najpierw możemy jest zapobiec hello tworzeniu nowych obciążeń, które mogłoby spowodować pełne toobecome klastra hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-473">hello first thing we can do is prevent hello creation of new workloads that would cause hello cluster toobecome full.</span></span>

<span data-ttu-id="5e3cf-474">Powiedz tworzenia usługi bezstanowej, a ma niektóre obciążenia skojarzone z nim.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="5e3cf-475">Załóżmy, że usługa hello dba o metryki "DiskSpaceInMb" hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-475">Let’s say that hello service cares about hello "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="5e3cf-476">Załóżmy również, że jest będzie tooconsume pięciu jednostek "DiskSpaceInMb" dla każdego wystąpienia usługi hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-476">Let's also say that it is going tooconsume five units of "DiskSpaceInMb" for every instance of hello service.</span></span> <span data-ttu-id="5e3cf-477">Ma trzy wystąpienia usługi hello toocreate.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-477">You want toocreate three instances of hello service.</span></span> <span data-ttu-id="5e3cf-478">Wspaniale!</span><span class="sxs-lookup"><span data-stu-id="5e3cf-478">Great!</span></span> <span data-ttu-id="5e3cf-479">Tak, aby oznacza, że potrzebujemy 15 jednostek toobe "DiskSpaceInMb" istnieje w klastrze hello abyśmy tooeven być stanie toocreate wystąpień tych usług.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-479">So that means that we need 15 units of "DiskSpaceInMb" toobe present in hello cluster in order for us tooeven be able toocreate these service instances.</span></span> <span data-ttu-id="5e3cf-480">Hello Menedżera zasobów klastra stale oblicza hello pojemność i użycie wszystkie metryki, dzięki czemu można określić hello pojemności pozostałych w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-480">hello Cluster Resource Manager continually calculates hello capacity and consumption of each metric so it can determine hello remaining capacity in hello cluster.</span></span> <span data-ttu-id="5e3cf-481">Jeśli nie ma wystarczającej ilości miejsca, wywołanie usługi tworzenia hello hello odrzuca Menedżera zasobów klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-481">If there isn't enough space, hello Cluster Resource Manager rejects hello create service call.</span></span>

<span data-ttu-id="5e3cf-482">Ponieważ wymaganie hello jest tylko być dostępne jednostki 15, ten obszar może zostać przydzielony wiele różnych sposobów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-482">Since hello requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="5e3cf-483">Przykładowo może istnieć pozostałe jednostki pojemności w różnych węzłach 15 lub trzy pozostałe jednostki pojemności w pięciu różnych węzłach.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="5e3cf-484">Jeśli hello Menedżera zasobów klastra można rozmieszczanie rzeczy, dlatego na trzy węzły jest dostępna pięciu jednostek, umieszcza hello usługi.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-484">If hello Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places hello service.</span></span> <span data-ttu-id="5e3cf-485">Zmienianie rozmieszczenia klastra hello jest zwykle możliwe, chyba że klastra hello jest prawie pełna lub hello istniejących usług nie mogą być konsolidowane jakiegoś powodu.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-485">Rearranging hello cluster is usually possible unless hello cluster is almost full or hello existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="5e3cf-486">Buforowany pojemności</span><span class="sxs-lookup"><span data-stu-id="5e3cf-486">Buffered Capacity</span></span>
<span data-ttu-id="5e3cf-487">Pojemność buforowany jest inna funkcja hello Menedżera zasobów klastra.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-487">Buffered capacity is another feature of hello Cluster Resource Manager.</span></span> <span data-ttu-id="5e3cf-488">Umożliwia rezerwacji część hello ogólną pojemność węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-488">It allows reservation of some portion of hello overall node capacity.</span></span> <span data-ttu-id="5e3cf-489">Ten bufor pojemności jest usług tooplace używane tylko podczas uaktualniania i awarii węzła.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-489">This capacity buffer is only used tooplace services during upgrades and node failures.</span></span> <span data-ttu-id="5e3cf-490">Globalny określony buforowanego pojemności na metryki dla wszystkich węzłów.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="5e3cf-491">Wybierz pojemności hello zastrzeżone wartości Hello jest funkcją hello liczby awarii i domen uaktualnienia w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-491">hello value you pick for hello reserved capacity is a function of hello number of Fault and Upgrade Domains you have in hello cluster.</span></span> <span data-ttu-id="5e3cf-492">Więcej awarii i uaktualniania domeny oznacza, że z buforowanego pojemności może wybrać mniejszą liczbę.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="5e3cf-493">Jeśli masz więcej domen, można oczekiwać, że mniejszych ilości toobe Twojego klastra niedostępne podczas uaktualniania i awarii.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-493">If you have more domains, you can expect smaller amounts of your cluster toobe unavailable during upgrades and failures.</span></span> <span data-ttu-id="5e3cf-494">Określanie buforowane pojemności ma sens tylko jeśli masz także hello określonego węzła wydajności dla metryki.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-494">Specifying Buffered Capacity only makes sense if you have also specified hello node capacity for a metric.</span></span>

<span data-ttu-id="5e3cf-495">Poniżej przedstawiono przykład sposobu toospecify buforowane pojemności:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-495">Here's an example of how toospecify buffered capacity:</span></span>

<span data-ttu-id="5e3cf-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="5e3cf-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="5e3cf-497">za pomocą pliku ClusterConfig.json dla autonomicznych wdrożeniach lub Template.json dla platformy Azure hostowanej klastrów:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="5e3cf-498">Witaj tworzenia nowych usług nie powiedzie się, gdy hello klastra jest poza buforowanego wydajności dla metryki.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-498">hello creation of new services fails when hello cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="5e3cf-499">Zapobieganie hello tworzenia nowych usług toopreserve hello buforu zapewnia, że błędy i uaktualnienia nie spowodują toogo węzłów przeciążone.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-499">Preventing hello creation of new services toopreserve hello buffer ensures that upgrades and failures don’t cause nodes toogo over capacity.</span></span> <span data-ttu-id="5e3cf-500">Pojemność buforowany jest opcjonalne, ale jest zalecane w przypadku dowolnego klastra, który definiuje wydajności dla metryki.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="5e3cf-501">Witaj Menedżera zasobów klastra uwidacznia informacje dotyczące tego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="5e3cf-501">hello Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="5e3cf-502">Dla każdego metryki informacje te obejmują:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="5e3cf-503">Witaj buforowane ustawień możliwości</span><span class="sxs-lookup"><span data-stu-id="5e3cf-503">hello buffered capacity settings</span></span>
  - <span data-ttu-id="5e3cf-504">łączna pojemność Hello</span><span class="sxs-lookup"><span data-stu-id="5e3cf-504">hello total capacity</span></span>
  - <span data-ttu-id="5e3cf-505">Bieżące użycie Hello</span><span class="sxs-lookup"><span data-stu-id="5e3cf-505">hello current consumption</span></span>
  - <span data-ttu-id="5e3cf-506">Określa, czy jest uznawany za wszystkie metryki równoważenia lub nie</span><span class="sxs-lookup"><span data-stu-id="5e3cf-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="5e3cf-507">Statystyka hello odchylenie standardowe</span><span class="sxs-lookup"><span data-stu-id="5e3cf-507">statistics about hello standard deviation</span></span>
  - <span data-ttu-id="5e3cf-508">Witaj węzły, które mają hello większość i najmniejszego obciążenia</span><span class="sxs-lookup"><span data-stu-id="5e3cf-508">hello nodes which have hello most and least load</span></span>  
  
<span data-ttu-id="5e3cf-509">Poniżej przedstawiono przykład te dane wyjściowe:</span><span class="sxs-lookup"><span data-stu-id="5e3cf-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="5e3cf-510">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="5e3cf-510">Next steps</span></span>
* <span data-ttu-id="5e3cf-511">Aby uzyskać informacje dotyczące architektury i informacje przepływu hello w hello Menedżera zasobów klastra, zapoznaj się [w tym artykule](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-511">For information on hello architecture and information flow within hello Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="5e3cf-512">Definiowanie metryki defragmentacji jest jednym ze sposobów tooconsolidate obciążenie węzłów zamiast go rozkładanie. toolearn jak tooconfigure defragmentacji, zapoznaj się zbyt[w tym artykule](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-512">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="5e3cf-513">Rozpocznij od początku hello i [uzyskać toohello wprowadzenie zasobu klastra sieci szkieletowej programu Service Manager](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-513">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="5e3cf-514">toofind limit o jak hello Menedżera zasobów klastra zarządza i równoważy obciążenie klastra hello wyewidencjonować hello artykułu na [równoważenia obciążenia](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="5e3cf-514">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
