---
title: "aaaAzure odzyskiwania po awarii sieci szkieletowej usług | Dokumentacja firmy Microsoft"
description: "Sieć szkieletowa usług Azure oferuje możliwości hello niezbędne toodeal ze wszystkimi typami awarii. W tym artykule opisano typy hello awarii, które mogą wystąpić i w jaki sposób toodeal z nimi."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: ab49c4b9-74a8-4907-b75b-8d2ee84c6d90
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 04b8348fb63e8a1c76a8f722c4c8255b339908e2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="disaster-recovery-in-azure-service-fabric"></a><span data-ttu-id="59366-104">Odzyskiwanie po awarii w sieci szkieletowej usług Azure</span><span class="sxs-lookup"><span data-stu-id="59366-104">Disaster recovery in Azure Service Fabric</span></span>
<span data-ttu-id="59366-105">Istotną częścią dostarczanie wysokiej dostępności jest zapewnienie przełączniki wszystkich różnych typów błędów usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-105">A critical part of delivering high-availability is ensuring that services can survive all different types of failures.</span></span> <span data-ttu-id="59366-106">Jest to szczególnie ważne w przypadku błędów, które są nieplanowane i poza nimi formantu.</span><span class="sxs-lookup"><span data-stu-id="59366-106">This is especially important for failures that are unplanned and outside of your control.</span></span> <span data-ttu-id="59366-107">W tym artykule opisano niektóre często używanych trybów awarii, może być awarii, jeśli nie modelowane i zarządzane prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="59366-107">This article describes some common failure modes that could be disasters if not modeled and managed correctly.</span></span> <span data-ttu-id="59366-108">Omówiono także tootake czynniki oraz czynności, jeśli mimo wszystko się stało po awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-108">It also discuss mitigations and actions tootake if a disaster happened anyway.</span></span> <span data-ttu-id="59366-109">Celem Hello jest toolimit lub wyeliminowania hello ryzyko utraty danych lub przestoju, gdy występują awarie, planowane lub w przeciwnym razie wystąpić.</span><span class="sxs-lookup"><span data-stu-id="59366-109">hello goal is toolimit or eliminate hello risk of downtime or data loss when they occur failures, planned or otherwise, occur.</span></span>

## <a name="avoiding-disaster"></a><span data-ttu-id="59366-110">Unikanie po awarii</span><span class="sxs-lookup"><span data-stu-id="59366-110">Avoiding disaster</span></span>
<span data-ttu-id="59366-111">Podstawowym celem usługi sieć szkieletowa jest toohelp model zarówno środowiska i usług w taki sposób, że błąd typowych nie są awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-111">Service Fabric's primary goal is toohelp you model both your environment and your services in such a way that common failure types are not disasters.</span></span> 

<span data-ttu-id="59366-112">Ogólnie występują dwa typy scenariuszy awarii/awarii:</span><span class="sxs-lookup"><span data-stu-id="59366-112">In general there are two types of disaster/failure scenarios:</span></span>

1. <span data-ttu-id="59366-113">Błędy sprzętu lub oprogramowania</span><span class="sxs-lookup"><span data-stu-id="59366-113">Hardware or software faults</span></span>
2. <span data-ttu-id="59366-114">Błędy operacyjne</span><span class="sxs-lookup"><span data-stu-id="59366-114">Operational faults</span></span>

### <a name="hardware-and-software-faults"></a><span data-ttu-id="59366-115">Błędy sprzętu i oprogramowania</span><span class="sxs-lookup"><span data-stu-id="59366-115">Hardware and software faults</span></span>
<span data-ttu-id="59366-116">Błędy sprzęt i oprogramowanie są nieprzewidywalne.</span><span class="sxs-lookup"><span data-stu-id="59366-116">Hardware and software faults are unpredictable.</span></span> <span data-ttu-id="59366-117">Hello Najprostszym sposobem toosurvive błędów działa większej liczby kopii usługi hello łączone w granicach awarii sprzętu lub oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="59366-117">hello easiest way toosurvive faults is running more copies of hello service  spanned across hardware or software fault boundaries.</span></span> <span data-ttu-id="59366-118">Na przykład jeśli usługa jest uruchomiona tylko na jednej maszynie określonego, następnie hello awaria tego jedna maszyna jest awarii dla tej usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-118">For example, if your service is running only on one particular machine, then hello failure of that one machine is a disaster for that service.</span></span> <span data-ttu-id="59366-119">tooavoid prosty sposób Hello to po awarii jest tooensure, czy usługa hello rzeczywiście jest uruchomiona na wielu komputerach.</span><span class="sxs-lookup"><span data-stu-id="59366-119">hello simple way tooavoid this disaster is tooensure that hello service is actually running on multiple machines.</span></span> <span data-ttu-id="59366-120">Testowanie jest także niezbędne tooensure hello awarii jednej maszyny nie spowoduje zakłócenia hello usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-120">Testing is also necessary tooensure hello failure of one machine doesn't disrupt hello running service.</span></span> <span data-ttu-id="59366-121">Planowanie pojemności zapewnia wystąpienia zastąpienia można tworzyć innym miejscu i że spadek wydajności nie przeciążać hello pozostałych usług.</span><span class="sxs-lookup"><span data-stu-id="59366-121">Capacity planning ensures a replacement instance can be created elsewhere and that reduction in capacity doesn't overload hello remaining services.</span></span> <span data-ttu-id="59366-122">Witaj tego samego wzorca działa niezależnie od tego, co próbujesz tooavoid hello awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-122">hello same pattern works regardless of what you're trying tooavoid hello failure of.</span></span> <span data-ttu-id="59366-123">Na przykład.</span><span class="sxs-lookup"><span data-stu-id="59366-123">For example.</span></span> <span data-ttu-id="59366-124">w przypadku obaw o niepowodzeniu hello sieci SAN, możesz uruchomić przez wiele sieci SAN.</span><span class="sxs-lookup"><span data-stu-id="59366-124">if you're concerned about hello failure of a SAN, you run across multiple SANs.</span></span> <span data-ttu-id="59366-125">Jeśli masz obawy hello utraty stojak serwerów, możesz uruchomić między wieloma stojakami.</span><span class="sxs-lookup"><span data-stu-id="59366-125">If you're concerned about hello loss of a rack of servers, you run across multiple racks.</span></span> <span data-ttu-id="59366-126">Jeśli Obawiamy o utracie hello centrów danych, usługę należy uruchomić w wielu regionach platformy Azure lub centrów danych.</span><span class="sxs-lookup"><span data-stu-id="59366-126">If you're worried about hello loss of datacenters, your service should run across multiple Azure regions or datacenters.</span></span> 

<span data-ttu-id="59366-127">Podczas uruchamiania tego rodzaju łączonych tryb, nadal możesz podmiotu toosome typów jednoczesnych awarii, ale single i nawet wiele błędów określonego typu (ex: jednej maszyny Wirtualnej lub sieci niepowodzenie link) są realizowane automatycznie (i dlatego nie jest już "awarii").</span><span class="sxs-lookup"><span data-stu-id="59366-127">When running in this type of spanned mode, you're still subject toosome types of simultaneous failures, but single and even multiple failures of a particular type (ex: a single VM or network link failing) are automatically handled (and so no longer a "disaster").</span></span> <span data-ttu-id="59366-128">Sieć szkieletowa usług zawiera wiele mechanizmy rozszerzania hello klastra i uchwytów ponownie Przywracanie nie powiodło się węzły i usług.</span><span class="sxs-lookup"><span data-stu-id="59366-128">Service Fabric provides many mechanisms for expanding hello cluster and handles bringing failed nodes and services back.</span></span> <span data-ttu-id="59366-129">Sieci szkieletowej usług również umożliwia uruchamianie wielu wystąpień usług w kolejności tooavoid tych typów nieplanowanych awarii z zwroty do rzeczywistego awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-129">Service Fabric also allows running many instances of your services in order tooavoid these types of unplanned failures from turning into real disasters.</span></span>

<span data-ttu-id="59366-130">Może to być przyczyny, dlaczego uruchomienie toospan dostatecznie dużego wdrożenia za pośrednictwem błędów nie jest możliwe.</span><span class="sxs-lookup"><span data-stu-id="59366-130">There may be reasons why running a deployment large enough toospan over failures is not feasible.</span></span> <span data-ttu-id="59366-131">Na przykład może zająć więcej zasobów sprzętowych nie jesteś chce toopay dla toohello względne ryzyko awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-131">For example, it may take more hardware resources than you're not willing toopay for relative toohello chance of failure.</span></span> <span data-ttu-id="59366-132">Podczas pracy nad aplikacji rozproszonych, możliwe że przeskoków dodatkową komunikację lub stan replikacji koszty w odległości geograficznej powoduje, że można zaakceptować opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="59366-132">When dealing with distributed applications, it could be that additional communication hops or state replication costs across geographic distances causes unacceptable latency.</span></span> <span data-ttu-id="59366-133">Gdzie jest rysowany tego wiersza, różni się dla każdej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="59366-133">Where this line is drawn differs for each application.</span></span> <span data-ttu-id="59366-134">Dla oprogramowania błędów w szczególności hello wina może leżeć usługi hello próbujesz tooscale.</span><span class="sxs-lookup"><span data-stu-id="59366-134">For software faults specifically, hello fault could be in hello service that you are trying tooscale.</span></span> <span data-ttu-id="59366-135">W takim przypadku większej liczby kopii nie uniemożliwiają powitania po awarii, ponieważ warunek błędu hello są korelowane we wszystkich wystąpieniach hello.</span><span class="sxs-lookup"><span data-stu-id="59366-135">In this case more copies don't prevent hello disaster, since hello failure condition is correlated across all hello instances.</span></span>

### <a name="operational-faults"></a><span data-ttu-id="59366-136">Błędy operacyjne</span><span class="sxs-lookup"><span data-stu-id="59366-136">Operational faults</span></span>
<span data-ttu-id="59366-137">Nawet wtedy, gdy usługi są łączone na Witaj świecie z wielu zwolnienia, on nadal występują zdarzenia Fatalne.</span><span class="sxs-lookup"><span data-stu-id="59366-137">Even if your service is spanned across hello globe with many redundancies, it can still experience disastrous events.</span></span> <span data-ttu-id="59366-138">Na przykład jeśli ktoś przypadkowo ponownie konfiguruje hello nazwy dns dla usługi hello, lub usunięcie tego bezpośrednich.</span><span class="sxs-lookup"><span data-stu-id="59366-138">For example, if someone accidentally reconfigures hello dns name for hello service, or deletes it outright.</span></span> <span data-ttu-id="59366-139">Na przykład załóżmy, że ma stanowe usługi sieć szkieletowa usług, a ktoś przypadkowo usunięty tej usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-139">As an example, let's say you had a stateful Service Fabric service, and someone deleted that service accidentally.</span></span> <span data-ttu-id="59366-140">Jeżeli nie istnieje inne środki zaradcze, tej usługi, a wszystkie miała stanu hello jest obecnie usunięty.</span><span class="sxs-lookup"><span data-stu-id="59366-140">Unless there's some other mitigation, that service and all of hello state it had is now gone.</span></span> <span data-ttu-id="59366-141">Tego rodzaju operacyjne awarii ("Niestety") wymagają różne czynniki ograniczające i kroki odzyskiwania niż regularne nieplanowanych awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-141">These types of operational disasters ("oops") require different mitigations and steps for recovery than regular unplanned failures.</span></span> 

<span data-ttu-id="59366-142">Hello najlepszych metod tooavoid tego rodzaju błędów operacyjne mają</span><span class="sxs-lookup"><span data-stu-id="59366-142">hello best ways tooavoid these types of operational faults are to</span></span>
1. <span data-ttu-id="59366-143">Ograniczanie dostępu operacyjnego toohello środowiska</span><span class="sxs-lookup"><span data-stu-id="59366-143">restrict operational access toohello environment</span></span>
2. <span data-ttu-id="59366-144">ściśle inspekcji niebezpieczne operacje</span><span class="sxs-lookup"><span data-stu-id="59366-144">strictly audit dangerous operations</span></span>
3. <span data-ttu-id="59366-145">nałożyć automatyzacji, ręczne lub poza pasmem, zmiany i weryfikacji określonych zmian w środowisku rzeczywiste hello przed ich wprowadzania</span><span class="sxs-lookup"><span data-stu-id="59366-145">impose automation, prevent manual or out of band changes, and validate specific changes against hello actual environment before enacting them</span></span>
4. <span data-ttu-id="59366-146">Upewnij się, że destrukcyjnego operacji są "słowo soft".</span><span class="sxs-lookup"><span data-stu-id="59366-146">ensure that destructive operations are "soft".</span></span> <span data-ttu-id="59366-147">Elastyczne operacje nie zaczynają obowiązywać natychmiast lub może być cofnięte w ramach przedziałów czasu</span><span class="sxs-lookup"><span data-stu-id="59366-147">Soft operations don't take effect immediately or can be undone within some time window</span></span>

<span data-ttu-id="59366-148">Usługa Service Fabric realizuje niektórych mechanizmów tooprevent błędów operacyjne, takie jak dostarczanie [opartej na rolach](service-fabric-cluster-security-roles.md) ACL dla operacji klastra.</span><span class="sxs-lookup"><span data-stu-id="59366-148">Service Fabric provides some mechanisms tooprevent operational faults, such as providing [role-based](service-fabric-cluster-security-roles.md) access control for cluster operations.</span></span> <span data-ttu-id="59366-149">Jednak większość tych błędów operacyjne wymagają działań organizacji i innych systemów.</span><span class="sxs-lookup"><span data-stu-id="59366-149">However, most of these operational faults require organizational efforts and other systems.</span></span> <span data-ttu-id="59366-150">Sieć szkieletowa usług zapewniają mechanizmu dla pozostałych operacyjne błędów, głównie do tworzenia kopii zapasowej i przywracania dla stanowych usług.</span><span class="sxs-lookup"><span data-stu-id="59366-150">Service Fabric does provide some mechanism for surviving operational faults, most notably backup and restore for stateful services.</span></span>

## <a name="managing-failures"></a><span data-ttu-id="59366-151">Zarządzanie błędów</span><span class="sxs-lookup"><span data-stu-id="59366-151">Managing failures</span></span>
<span data-ttu-id="59366-152">Celem Hello usługi sieć szkieletowa jest prawie zawsze automatyczne zarządzanie błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-152">hello goal of Service Fabric is almost always automatic management of failures.</span></span> <span data-ttu-id="59366-153">Jednak w celu toohandle niektóre typy błędów, usługi muszą mieć dodatkowy kod.</span><span class="sxs-lookup"><span data-stu-id="59366-153">However, in order toohandle some types of failures, services must have additional code.</span></span> <span data-ttu-id="59366-154">Inne typy błędów powinna _nie_ automatycznie należy rozwiązać kwestie dotyczące bezpieczeństwa i biznesowych powodów ciągłości.</span><span class="sxs-lookup"><span data-stu-id="59366-154">Other types of failures should _not_ be automatically addressed because of safety and business continuity reasons.</span></span> 

### <a name="handling-single-failures"></a><span data-ttu-id="59366-155">Obsługa błędów pojedynczego</span><span class="sxs-lookup"><span data-stu-id="59366-155">Handling single failures</span></span>
<span data-ttu-id="59366-156">Pojedynczymi urządzeniami może zakończyć się niepowodzeniem dla wielu różnych przyczyn.</span><span class="sxs-lookup"><span data-stu-id="59366-156">Single machines can fail for all sorts of reasons.</span></span> <span data-ttu-id="59366-157">Niektóre z nich są przyczyny sprzętu, takich jak zasilacze i sieci na awarie sprzętowe.</span><span class="sxs-lookup"><span data-stu-id="59366-157">Some of these are hardware causes, like power supplies and networking hardware failures.</span></span> <span data-ttu-id="59366-158">Inne błędy są w oprogramowaniu.</span><span class="sxs-lookup"><span data-stu-id="59366-158">Other failures are in software.</span></span> <span data-ttu-id="59366-159">Obejmują one błędów hello rzeczywiste systemu operacyjnego i hello samej usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-159">These include failures of hello actual operating system and hello service itself.</span></span> <span data-ttu-id="59366-160">Sieć szkieletowa usług automatycznie wykrywa tego rodzaju błędów, łącznie z przypadkami, w której maszyna hello staje się odizolowany od innych maszyn powodu toonetwork problemów.</span><span class="sxs-lookup"><span data-stu-id="59366-160">Service Fabric automatically detects these types of failures, including cases where hello machine becomes isolated from other machines due toonetwork issues.</span></span>

<span data-ttu-id="59366-161">Niezależnie od typu hello usługi działa jedno wystąpienie wyniki w przestoju dla tej usługi Jeśli tego pojedynczej kopii hello kodu nie powiedzie się z jakiegokolwiek powodu.</span><span class="sxs-lookup"><span data-stu-id="59366-161">Regardless of hello type of service, running a single instance results in downtime for that service if that single copy of hello code fails for any reason.</span></span> 

<span data-ttu-id="59366-162">W kolejności toohandle dowolnego pojedynczego uszkodzenia hello najprostszy, co możesz zrobić jest tooensure, która domyślnie usługi uruchamiane na więcej niż jeden węzeł.</span><span class="sxs-lookup"><span data-stu-id="59366-162">In order toohandle any single failure, hello simplest thing you can do is tooensure that your services run on more than one node by default.</span></span> <span data-ttu-id="59366-163">W przypadku usług bezstanowych można to zrobić za mające `InstanceCount` większą niż 1.</span><span class="sxs-lookup"><span data-stu-id="59366-163">For stateless services, this can be accomplished by having an `InstanceCount` greater than 1.</span></span> <span data-ttu-id="59366-164">Dla stanowych usług zalecane minimalne hello jest zawsze `TargetReplicaSetSize` i `MinReplicaSetSize` co najmniej 3.</span><span class="sxs-lookup"><span data-stu-id="59366-164">For stateful services, hello minimum recommendation is always a `TargetReplicaSetSize` and `MinReplicaSetSize` of at least 3.</span></span> <span data-ttu-id="59366-165">Uruchamianie większej liczby kodu usługi kopii gwarantuje, że usługa może obsłużyć automatycznie dowolnego pojedynczego uszkodzenia.</span><span class="sxs-lookup"><span data-stu-id="59366-165">Running more copies of your service code ensures that your service can handle any single failure automatically.</span></span> 

### <a name="handling-coordinated-failures"></a><span data-ttu-id="59366-166">Koordynowane Obsługa błędów</span><span class="sxs-lookup"><span data-stu-id="59366-166">Handling coordinated failures</span></span>
<span data-ttu-id="59366-167">Błędy skoordynowanego może się zdarzyć w klastrze tooeither planowane lub nieplanowane infrastruktury błędów i zmiany lub zmiany oprogramowania planowane.</span><span class="sxs-lookup"><span data-stu-id="59366-167">Coordinated failures can happen in a cluster due tooeither planned or unplanned infrastructure failures and changes, or planned software changes.</span></span> <span data-ttu-id="59366-168">Sieć szkieletowa usług modele infrastruktury strefach skoordynowanego awarii jako domen błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-168">Service Fabric models infrastructure zones that experience coordinated failures as Fault Domains.</span></span> <span data-ttu-id="59366-169">Obszary, które wystąpią zmiany oprogramowania skoordynowanego są modelowane jako domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="59366-169">Areas that will experience coordinated software changes are modeled as Upgrade Domains.</span></span> <span data-ttu-id="59366-170">Więcej informacji o domenach awarii i uaktualniania znajduje się w [tego dokumentu](service-fabric-cluster-resource-manager-cluster-description.md) opisujący Topologia klastra i definicji.</span><span class="sxs-lookup"><span data-stu-id="59366-170">More information about fault and upgrade domains is in [this document](service-fabric-cluster-resource-manager-cluster-description.md) that describes cluster topology and definition.</span></span>

<span data-ttu-id="59366-171">Domyślnie usługa sieć szkieletowa uwzględnia domenach awarii i uaktualniania podczas planowania, gdzie mają być uruchamiane z usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-171">By default Service Fabric considers fault and upgrade domains when planning where your services should run.</span></span> <span data-ttu-id="59366-172">Domyślnie usługi sieć szkieletowa próbuje tooensure uruchomienia usług w kilku domenach awarii i uaktualniania, jeśli wprowadzenia zmiany planowane lub nieplanowane usługi są dostępne.</span><span class="sxs-lookup"><span data-stu-id="59366-172">By default, Service Fabric tries tooensure that your services run across several fault and upgrade domains so if planned or unplanned changes happen your services remain available.</span></span> 

<span data-ttu-id="59366-173">Na przykład załóżmy, że błąd źródła zasilania jednocześnie powoduje stojak toofail maszyny.</span><span class="sxs-lookup"><span data-stu-id="59366-173">For example, let's say that failure of a power source causes a rack of machines toofail simultaneously.</span></span> <span data-ttu-id="59366-174">Z wielu kopii uruchamiania hello utraty wiele maszyn uszkodzenie domeny błędów usługi hello zmieni się w innym tylko przykładem pojedynczego uszkodzenia dla danej usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-174">With multiple copies of hello service running hello loss of many machines in fault domain failure turns into just another example of single failure for a given service.</span></span> <span data-ttu-id="59366-175">Jest to, dlaczego jest zarządzanie domen błędów krytycznych tooensuring wysoką dostępność usług.</span><span class="sxs-lookup"><span data-stu-id="59366-175">This is why managing fault domains is critical tooensuring high availability of your services.</span></span> <span data-ttu-id="59366-176">Gdy usługa sieć szkieletowa usług działających na platformie Azure, automatycznie są zarządzane domen błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-176">When running Service Fabric in Azure, fault domains are managed automatically.</span></span> <span data-ttu-id="59366-177">W innych środowiskach może nie być.</span><span class="sxs-lookup"><span data-stu-id="59366-177">In other environments they may not be.</span></span> <span data-ttu-id="59366-178">Jeśli tworzysz klastrach lokalnie, można się toomap i poprawnie zaplanować układu domeny błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-178">If you're building your own clusters on premises, be sure toomap and plan your fault domain layout correctly.</span></span>

<span data-ttu-id="59366-179">Domen uaktualnienia są przydatne do modelowania obszarów, gdzie oprogramowania będzie toobe uaktualniony w hello sam czas.</span><span class="sxs-lookup"><span data-stu-id="59366-179">Upgrade Domains are useful for modeling areas where software is going toobe upgraded at hello same time.</span></span> <span data-ttu-id="59366-180">W związku z tym domen uaktualnienia również często zdefiniować granice hello, gdy oprogramowanie jest wyłączona podczas planowanych uaktualnień.</span><span class="sxs-lookup"><span data-stu-id="59366-180">Because of this, Upgrade Domains also often define hello boundaries where software is taken down during planned upgrades.</span></span> <span data-ttu-id="59366-181">Uaktualnienia platformy Service Fabric i usług wykonaj hello samego modelu.</span><span class="sxs-lookup"><span data-stu-id="59366-181">Upgrades of both Service Fabric and your services follow hello same model.</span></span> <span data-ttu-id="59366-182">Aby uzyskać więcej informacji na wprowadzanie uaktualnień, domen uaktualnienia i hello model kondycji sieci szkieletowej usług, która pomaga zapobiegać niezamierzonych zmian wpływających na powitania klastra i usługi Zobacz tych dokumentów:</span><span class="sxs-lookup"><span data-stu-id="59366-182">For more on rolling upgrades, upgrade domains, and hello Service Fabric health model that helps prevent unintended changes from impacting hello cluster and your service, see these documents:</span></span>

 - [<span data-ttu-id="59366-183">Uaktualnianie aplikacji</span><span class="sxs-lookup"><span data-stu-id="59366-183">Application Upgrade</span></span>](service-fabric-application-upgrade.md)
 - [<span data-ttu-id="59366-184">Samouczek uaktualnienia aplikacji</span><span class="sxs-lookup"><span data-stu-id="59366-184">Application Upgrade Tutorial</span></span>](service-fabric-application-upgrade-tutorial.md)
 - [<span data-ttu-id="59366-185">Model kondycji sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="59366-185">Service Fabric Health Model</span></span>](service-fabric-health-introduction.md)

<span data-ttu-id="59366-186">Można zwizualizować układu hello klastra przy użyciu dostępnych w mapie klastrów hello [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span><span class="sxs-lookup"><span data-stu-id="59366-186">You can visualize hello layout of your cluster using hello cluster map provided in [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span></span>

<span data-ttu-id="59366-187"><center>
![Węzły rozmieszczenie domen błędów w narzędziu Service Fabric Explorer][sfx-cluster-map]
</center></span><span class="sxs-lookup"><span data-stu-id="59366-187"><center>
![Nodes spread across fault domains in Service Fabric Explorer][sfx-cluster-map]
</center></span></span>

> [!NOTE]
> <span data-ttu-id="59366-188">Modelowanie obszarów awarii uaktualnień stopniowych, uruchamianie wielu wystąpień kodu usługi i stanu, tooensure reguły umieszczania usług Uruchom w domenach awarii i uaktualniania, a monitorowanie kondycji wbudowanych są po prostu **niektórych** z hello funkcje platformy Service Fabric zawiera w błędy z zwroty do awarii i kolejność tookeep normalne wykrycia problemów operacyjnych.</span><span class="sxs-lookup"><span data-stu-id="59366-188">Modeling areas of failure, rolling upgrades, running many instances of your service code and state, placement rules tooensure your services run across fault and upgrade domains, and built-in health monitoring are just **some** of hello features that Service Fabric provides in order tookeep normal operational issues and failures from turning into disasters.</span></span> 
>

### <a name="handling-simultaneous-hardware-or-software-failures"></a><span data-ttu-id="59366-189">Obsługa jednoczesnych awarii sprzętu lub oprogramowania</span><span class="sxs-lookup"><span data-stu-id="59366-189">Handling simultaneous hardware or software failures</span></span>
<span data-ttu-id="59366-190">Powyżej zajmowaliśmy pojedynczego błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-190">Above we talked about single failures.</span></span> <span data-ttu-id="59366-191">Jak widać, są łatwe toohandle zarówno bezstanowych i stanowych usług przez przechowywanie większej liczby kopii hello kodu (i stanu) uruchomionych w domenach awarii i uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="59366-191">As you can see, are easy toohandle for both stateless and stateful services just by keeping more copies of hello code (and state) running across fault and upgrade domains.</span></span> <span data-ttu-id="59366-192">Również możliwe wielu jednoczesnych losowe awarie.</span><span class="sxs-lookup"><span data-stu-id="59366-192">Multiple simultaneous random failures can also happen.</span></span> <span data-ttu-id="59366-193">Są to bardziej prawdopodobne toolead tooan rzeczywiste awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-193">These are more likely toolead tooan actual disaster.</span></span>


### <a name="random-failures-leading-tooservice-failures"></a><span data-ttu-id="59366-194">Losowe awarie wiodące tooservice błędów</span><span class="sxs-lookup"><span data-stu-id="59366-194">Random failures leading tooservice failures</span></span>
<span data-ttu-id="59366-195">Załóżmy, że usługa hello miał `InstanceCount` 5 i kilka węzłów uruchomionych wystąpień tych wszystkich nie powiodło się w hello sam czas.</span><span class="sxs-lookup"><span data-stu-id="59366-195">Let's say that hello service had an `InstanceCount` of 5, and several nodes running those instances all failed at hello same time.</span></span> <span data-ttu-id="59366-196">Sieć szkieletowa usług reaguje automatycznego tworzenia wystąpień zamiany na innych węzłach.</span><span class="sxs-lookup"><span data-stu-id="59366-196">Service Fabric responds by automatically creating replacement instances on other nodes.</span></span> <span data-ttu-id="59366-197">Tworzenie wymiany, dopóki usługa hello jest ponownie tooits żądaną liczbę wystąpień jest kontynuowane.</span><span class="sxs-lookup"><span data-stu-id="59366-197">It will continue creating replacements until hello service is back tooits desired instance count.</span></span> <span data-ttu-id="59366-198">Inny przykład załóżmy, że wystąpił usługi bezstanowej z `InstanceCount`-1, co oznacza działa we wszystkich węzłach klastra hello prawidłowe.</span><span class="sxs-lookup"><span data-stu-id="59366-198">As another example, let's say there was a stateless service with an `InstanceCount`of -1, meaning it runs on all valid nodes in hello cluster.</span></span> <span data-ttu-id="59366-199">Załóżmy, że niektóre z tych wystąpień były toofail.</span><span class="sxs-lookup"><span data-stu-id="59366-199">Let's say that some of those instances were toofail.</span></span> <span data-ttu-id="59366-200">W takim przypadku usługa sieci szkieletowej powiadomienia hello usługi nie jest w stanie żądaną i próbuje toocreate hello wystąpień w węzłach hello, gdy są one Brak.</span><span class="sxs-lookup"><span data-stu-id="59366-200">In this case, Service Fabric notices that hello service is not in its desired state, and tries toocreate hello instances on hello nodes where they are missing.</span></span> 

<span data-ttu-id="59366-201">Dla stanowych usług sytuacji hello zależy od tego, czy usługa hello utrwalił stanu lub nie.</span><span class="sxs-lookup"><span data-stu-id="59366-201">For stateful services hello situation depends on whether hello service has persisted state or not.</span></span> <span data-ttu-id="59366-202">Także od tego, ile usługa hello repliki i ile nie powiodło się.</span><span class="sxs-lookup"><span data-stu-id="59366-202">It also depends on how many replicas hello service had and how many failed.</span></span> <span data-ttu-id="59366-203">Określanie, czy dla usługi stanowej wystąpił awarii i zarządzanie nią jest zgodna z trzech etapów:</span><span class="sxs-lookup"><span data-stu-id="59366-203">Determining whether a disaster occurred for a stateful service and managing it follows three stages:</span></span>

1. <span data-ttu-id="59366-204">Określanie, jeśli nastąpiła utrata kworum lub nie</span><span class="sxs-lookup"><span data-stu-id="59366-204">Determining if there has been quorum loss or not</span></span>
 - <span data-ttu-id="59366-205">Utrata kworum jest dowolnym momencie większość hello repliki usługi stanowej działają na powitania tym samym czasie, w tym hello podstawowej.</span><span class="sxs-lookup"><span data-stu-id="59366-205">A quorum loss is any time a majority of hello replicas of a stateful service are down at hello same time, including hello Primary.</span></span>
2. <span data-ttu-id="59366-206">Określanie, czy utraty kworum hello jest stałe</span><span class="sxs-lookup"><span data-stu-id="59366-206">Determining if hello quorum loss is permanent or not</span></span>
 - <span data-ttu-id="59366-207">W większości przypadków hello błędy są przejściowej.</span><span class="sxs-lookup"><span data-stu-id="59366-207">Most of hello time, failures are transient.</span></span> <span data-ttu-id="59366-208">Procesy, zostaną ponownie uruchomione, węzły są ponownie uruchamiane maszyny wirtualne są dalszymi, poprawianego partycje sieciowe.</span><span class="sxs-lookup"><span data-stu-id="59366-208">Processes are restarted, nodes are restarted, VMs are relaunched, network partitions heal.</span></span> <span data-ttu-id="59366-209">Czasami jednak błędy są trwałe.</span><span class="sxs-lookup"><span data-stu-id="59366-209">Sometimes though, failures are permanent.</span></span> 
    - <span data-ttu-id="59366-210">Dla usługi bez trwałych stanu awarii kworum lub większej liczby replikami wyniki _natychmiast_ w wyniku utraty kworum trwałych.</span><span class="sxs-lookup"><span data-stu-id="59366-210">For services without persisted state, a failure of a quorum or more of replicas results _immediately_ in permanent quorum loss.</span></span> <span data-ttu-id="59366-211">Gdy sieć szkieletowa usług wykryje utraty kworum w stanowe usługi trwałe, natychmiast przebieg dataloss toostep 3 przez zadeklarowanie (możliwości).</span><span class="sxs-lookup"><span data-stu-id="59366-211">When Service Fabric detects quorum loss in a stateful non-persistent service, it immediately proceeds toostep 3 by declaring (potential) dataloss.</span></span> <span data-ttu-id="59366-212">Postępowanie toodataloss ma sens, ponieważ sieć szkieletowa usług wie, że żaden punkt oczekiwanie na powitania wstecz toocome repliki, ponieważ nawet jeśli zostały one odzyskane może być pusta.</span><span class="sxs-lookup"><span data-stu-id="59366-212">Proceeding toodataloss makes sense because Service Fabric knows that there's no point in waiting for hello replicas toocome back, because even if they were recovered they would be empty.</span></span>
    - <span data-ttu-id="59366-213">Dla stanowych usług trwałe awarii kworum lub większej liczby replikami powoduje, że usługi sieć szkieletowa toostart oczekiwania na powitania replik ponownie toocome i przywracania kworum.</span><span class="sxs-lookup"><span data-stu-id="59366-213">For stateful persistent services, a failure of a quorum or more of replicas causes Service Fabric toostart waiting for hello replicas toocome back and restore quorum.</span></span> <span data-ttu-id="59366-214">To powoduje awarię usług dla każdego _zapisuje_ toohello wpływu partycji (lub "zestawu replik") hello usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-214">This results in a service outage for any _writes_ toohello affected partition (or "replica set") of hello service.</span></span> <span data-ttu-id="59366-215">Jednak odczyty nadal może być możliwe gwarancje spójności mniejsze.</span><span class="sxs-lookup"><span data-stu-id="59366-215">However, reads may still be possible with reduced consistency guarantees.</span></span> <span data-ttu-id="59366-216">Hello domyślna ilość czasu usługi sieć szkieletowa czeka na przywrócić toobe kworum jest nieskończone, ponieważ postępowania jest zdarzeniem dataloss (potencjalnych) i posiada inne ryzyka.</span><span class="sxs-lookup"><span data-stu-id="59366-216">hello default amount of time that Service Fabric waits for quorum toobe restored is infinite, since proceeding is a (potential) dataloss event and carries other risks.</span></span> <span data-ttu-id="59366-217">Zastępowanie domyślnego hello `QuorumLossWaitDuration` wartość jest możliwe, ale nie jest zalecane.</span><span class="sxs-lookup"><span data-stu-id="59366-217">Overriding hello default `QuorumLossWaitDuration` value is possible but is not recommended.</span></span> <span data-ttu-id="59366-218">Zamiast tego w tej chwili wszystkich działań należy hello toorestore dół replik.</span><span class="sxs-lookup"><span data-stu-id="59366-218">Instead at this time, all efforts should be made toorestore hello down replicas.</span></span> <span data-ttu-id="59366-219">Wymaga to dostarczają hello węzłów, które działają w kopii zapasowej i zapewnienie, że ich zainstaluj dyski hello przechowywania do stanu trwałego hello lokalnego.</span><span class="sxs-lookup"><span data-stu-id="59366-219">This requires bringing hello nodes that are down back up, and ensuring that they can remount hello drives where they stored hello local persistent state.</span></span> <span data-ttu-id="59366-220">Utrata kworum hello jest spowodowany przez niepowodzenie procesu, usługi sieć szkieletowa automatycznie próbuje toorecreate hello procesów i uruchomić ponownie replik hello zawartych w nich.</span><span class="sxs-lookup"><span data-stu-id="59366-220">If hello quorum loss is caused by process failure, Service Fabric automatically tries toorecreate hello processes and restart hello replicas inside them.</span></span> <span data-ttu-id="59366-221">W przypadku niepowodzenia usługi sieć szkieletowa Raporty kondycji błędy.</span><span class="sxs-lookup"><span data-stu-id="59366-221">If this fails, Service Fabric reports health errors.</span></span> <span data-ttu-id="59366-222">Jeśli te mogą zostać rozwiązane następnie repliki hello zwykle powrotu.</span><span class="sxs-lookup"><span data-stu-id="59366-222">If these can be resolved then hello replicas usually come back.</span></span> <span data-ttu-id="59366-223">Czasami jednak hello replik nie może zostać przywrócone.</span><span class="sxs-lookup"><span data-stu-id="59366-223">Sometimes, though, hello replicas can't be brought back.</span></span> <span data-ttu-id="59366-224">Na przykład dysków hello nie wszystkie powiodło się lub hello maszyny fizycznie zniszczenia jakiś sposób.</span><span class="sxs-lookup"><span data-stu-id="59366-224">For example, hello drives may all have failed, or hello machines physically destroyed somehow.</span></span> <span data-ttu-id="59366-225">W takich przypadkach teraz zostały zdarzenia utraty kworum trwałych.</span><span class="sxs-lookup"><span data-stu-id="59366-225">In these cases, we now have a permanent quorum loss event.</span></span> <span data-ttu-id="59366-226">toostop sieci szkieletowej usług tootell oczekiwanie na powitania dół toocome replik, administrator klastra musi ustalić, które partycje, których dotyczy usługi i wywołać hello `Repair-ServiceFabricPartition -PartitionId` lub ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="59366-226">tootell Service Fabric toostop waiting for hello down replicas toocome back, a cluster administrator must determine which partitions of which services are affected and call hello `Repair-ServiceFabricPartition -PartitionId` or ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` API.</span></span>  <span data-ttu-id="59366-227">Ten interfejs API umożliwia określenie hello identyfikator hello partycji toomove poza QuorumLoss i do potencjalnych dataloss.</span><span class="sxs-lookup"><span data-stu-id="59366-227">This API allows specifying hello ID of hello partition toomove out of QuorumLoss and into potential dataloss.</span></span>

> [!NOTE]
> <span data-ttu-id="59366-228">Jest _nigdy nie_ bezpieczne toouse ten interfejs API innych niż w sposób docelowych z określonymi partycjami.</span><span class="sxs-lookup"><span data-stu-id="59366-228">It is _never_ safe toouse this API other than in a targeted way against specific partitions.</span></span> 
>

3. <span data-ttu-id="59366-229">Określenie, czy nastąpiła utrata danych rzeczywistych i przywracanie z kopii zapasowej</span><span class="sxs-lookup"><span data-stu-id="59366-229">Determining if there has been actual data loss, and restoring from backups</span></span>
  - <span data-ttu-id="59366-230">Gdy usługa sieć szkieletowa wywołuje hello `OnDataLossAsync` metody jest zawsze z powodu _podejrzane_ dataloss.</span><span class="sxs-lookup"><span data-stu-id="59366-230">When Service Fabric calls hello `OnDataLossAsync` method it is always because of _suspected_ dataloss.</span></span> <span data-ttu-id="59366-231">Sieć szkieletowa usług gwarantuje, że to wywołanie jest dostarczany toohello _najlepsze_ pozostałe repliki.</span><span class="sxs-lookup"><span data-stu-id="59366-231">Service Fabric ensures that this call is delivered toohello _best_ remaining replica.</span></span> <span data-ttu-id="59366-232">Jest to, niezależnie od repliki wprowadził hello większości postępu.</span><span class="sxs-lookup"><span data-stu-id="59366-232">This is whichever replica has made hello most progress.</span></span> <span data-ttu-id="59366-233">Witaj Przyczyna zawsze powiedzieć _podejrzanych_ dataloss jest ta replika pozostałych hello może faktycznie wszystkich stanów w tej samej jak podczas spadek hello podstawowej.</span><span class="sxs-lookup"><span data-stu-id="59366-233">hello reason we always say _suspected_ dataloss is that it is possible that hello remaining replica actually has all same state as hello Primary did when it went down.</span></span> <span data-ttu-id="59366-234">Jednak bez tego stanu toocompare go, nie istnieje dobry sposób dla sieci szkieletowej usług lub operatory tooknow upewnić się.</span><span class="sxs-lookup"><span data-stu-id="59366-234">However, without that state toocompare it to, there's no good way for Service Fabric or operators tooknow for sure.</span></span> <span data-ttu-id="59366-235">W tym momencie usługi sieć szkieletowa również zna hello innych replik nie będzie można ponownie.</span><span class="sxs-lookup"><span data-stu-id="59366-235">At this point, Service Fabric also knows hello other replicas are not coming back.</span></span> <span data-ttu-id="59366-236">Który była decyzja hello wysyłane w przypadku zatrzymania oczekiwanie na powitania tooresolve utraty kworum, sama.</span><span class="sxs-lookup"><span data-stu-id="59366-236">That was hello decision made when we stopped waiting for hello quorum loss tooresolve itself.</span></span> <span data-ttu-id="59366-237">najlepszy plan działania usługi hello Hello jest zwykle toofreeze i poczekaj określonych interwencji administratora.</span><span class="sxs-lookup"><span data-stu-id="59366-237">hello best course of action for hello service is usually toofreeze and wait for specific administrative intervention.</span></span> <span data-ttu-id="59366-238">To samo co Typowa implementacja hello `OnDataLossAsync` Wykonaj metodę?</span><span class="sxs-lookup"><span data-stu-id="59366-238">So what does a typical implementation of hello `OnDataLossAsync` method do?</span></span>
  - <span data-ttu-id="59366-239">Po pierwsze, dziennika `OnDataLossAsync` zostało wyzwolone i szybko włączyć wszystkie niezbędne alertach.</span><span class="sxs-lookup"><span data-stu-id="59366-239">First, log that `OnDataLossAsync` has been triggered, and fire off any necessary administrative alerts.</span></span>
   - <span data-ttu-id="59366-240">Zwykle w tym momencie toopause i poczekaj dalszych decyzji i toobe ręczne akcje podjęte.</span><span class="sxs-lookup"><span data-stu-id="59366-240">Usually at this point, toopause and wait for further decisions and manual actions toobe taken.</span></span> <span data-ttu-id="59366-241">To dlatego nawet jeśli kopie zapasowe są dostępne potrzebnych toobe przygotowane.</span><span class="sxs-lookup"><span data-stu-id="59366-241">This is because even if backups are available they may need toobe prepared.</span></span> <span data-ttu-id="59366-242">Na przykład jeśli dwóch różnych usług koordynuje informacje, tych kopii zapasowych może być konieczne toobe zmodyfikowane w tooensure kolejność, która po przywracania hello się stanie, że informacje hello te dwie usługi interesujących jest spójna.</span><span class="sxs-lookup"><span data-stu-id="59366-242">For example, if two different services coordinate information, those backups may need toobe modified in order tooensure that once hello restore happens that hello information those two services care about is consistent.</span></span> 
  - <span data-ttu-id="59366-243">Często jest również inne dane telemetryczne ani wylotu hello usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-243">Often there is also some other telemetry or exhaust from hello service.</span></span> <span data-ttu-id="59366-244">Te metadane mogą być zawarte w innych usługach lub w dziennikach.</span><span class="sxs-lookup"><span data-stu-id="59366-244">This metadata may be contained in other services or in logs.</span></span> <span data-ttu-id="59366-245">Te informacje mogą być używane toodetermine potrzebne, gdyby wszystkie wywołania odbierane i przetwarzane na powitania podstawowego, które nie znajdują się na replice określonej kopii zapasowej lub replikowanych toothis hello.</span><span class="sxs-lookup"><span data-stu-id="59366-245">This information can be used needed toodetermine if there were any calls received and processed at hello primary that were not present in hello backup or replicated toothis particular replica.</span></span> <span data-ttu-id="59366-246">To może być konieczne toobe toohello powtórzony lub została dodana w kopii zapasowej przed przywrócenie jest możliwe.</span><span class="sxs-lookup"><span data-stu-id="59366-246">These may need toobe replayed or added toohello backup before restoration is feasible.</span></span>  
   - <span data-ttu-id="59366-247">Porównania hello pozostałych toothat stanu repliki zawarte w żadnej kopii zapasowej, które są dostępne.</span><span class="sxs-lookup"><span data-stu-id="59366-247">Comparisons of hello remaining replica's state toothat contained in any backups that are available.</span></span> <span data-ttu-id="59366-248">Jeśli przy użyciu kolekcji niezawodnej hello sieci szkieletowej usług, a następnie są narzędzi i przetwarza dostępne tak, opisana [w tym artykule](service-fabric-reliable-services-backup-restore.md).</span><span class="sxs-lookup"><span data-stu-id="59366-248">If using hello Service Fabric reliable collections then there are tools and processes available for doing so, described in [this article](service-fabric-reliable-services-backup-restore.md).</span></span> <span data-ttu-id="59366-249">Celem Hello jest toosee hello stanu w replice hello jest wystarczająca, czy również jakiego hello kopia zapasowa może nie istnieć.</span><span class="sxs-lookup"><span data-stu-id="59366-249">hello goal is toosee if hello state within hello replica is sufficient, or also what hello backup may be missing.</span></span>
  - <span data-ttu-id="59366-250">Raz hello porównanie wykonuje się, a jeśli niezbędne hello Przywracanie ukończone, kodu usługi hello powinien zwrócić wartość true, jeśli wprowadzono zmiany stanu.</span><span class="sxs-lookup"><span data-stu-id="59366-250">Once hello comparison is done, and if necessary hello restore completed, hello service code should return true if any state changes were made.</span></span> <span data-ttu-id="59366-251">Jeżeli repliki hello określone zostało hello najlepiej dostępne kopię hello stanu i nie wprowadził zmian, zostanie zwrócona wartość false.</span><span class="sxs-lookup"><span data-stu-id="59366-251">If hello replica determined that it was hello best available copy of hello state and made no changes, then return false.</span></span> <span data-ttu-id="59366-252">Wartość TRUE wskazuje, że jakaś _innych_ pozostałych repliki mogą być niezgodne z tym kontem.</span><span class="sxs-lookup"><span data-stu-id="59366-252">True indicates that any _other_ remaining replicas may now be inconsistent with this one.</span></span> <span data-ttu-id="59366-253">Będzie można porzucić i ponownie skompilowany od tej repliki.</span><span class="sxs-lookup"><span data-stu-id="59366-253">They will be dropped and rebuilt from this replica.</span></span> <span data-ttu-id="59366-254">Wartość FAŁSZ oznacza, że stan nie wprowadzono żadnych zmian, więc hello innych replik można zachować ich.</span><span class="sxs-lookup"><span data-stu-id="59366-254">False indicates that no state changes were made, so hello other replicas can keep what they have.</span></span> 

<span data-ttu-id="59366-255">Jest bardzo ważny, że autorów usługi rozwiązaniem potencjalne dataloss i scenariuszy awarii, przed usług kiedykolwiek są wdrażane w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="59366-255">It is critically important that service authors practice potential dataloss and failure scenarios before services are ever deployed in production.</span></span> <span data-ttu-id="59366-256">tooprotect przed hello możliwości dataloss, ważne jest, tooperiodically [Utwórz kopię zapasową stanu hello](service-fabric-reliable-services-backup-restore.md) dowolnego magazynu geograficznie nadmiarowego tooa usług stanowych.</span><span class="sxs-lookup"><span data-stu-id="59366-256">tooprotect against hello possibility of dataloss, it is important tooperiodically [back up hello state](service-fabric-reliable-services-backup-restore.md) of any of your stateful services tooa geo-redundant store.</span></span> <span data-ttu-id="59366-257">Upewnij się że toorestore możliwości hello go.</span><span class="sxs-lookup"><span data-stu-id="59366-257">You must also ensure that you have hello ability toorestore it.</span></span> <span data-ttu-id="59366-258">Ponieważ kopie zapasowe wielu różnych usług są wykonywane w różnym czasie, należy tooensure po przywróceniu usługi ma spójny widok siebie nawzajem.</span><span class="sxs-lookup"><span data-stu-id="59366-258">Since backups of many different services are taken at different times, you need tooensure that after a restore your services have a consistent view of each other.</span></span> <span data-ttu-id="59366-259">Rozważmy na przykład sytuacji, w której jedna usługa generuje numer i zapisze go, a następnie wysyła tooanother usługi, która przechowuje on także.</span><span class="sxs-lookup"><span data-stu-id="59366-259">For example, consider a situation where one service generates a number and stores it, then sends it tooanother service that also stores it.</span></span> <span data-ttu-id="59366-260">Po przywróceniu może się okazać, że hello usługi drugi ma numer hello, ale hello najpierw nie, ponieważ jego kopii zapasowej nie zawiera tej operacji.</span><span class="sxs-lookup"><span data-stu-id="59366-260">After a restore, you might discover that hello second service has hello number but hello first does not, because it's backup didn't include that operation.</span></span>

<span data-ttu-id="59366-261">Jeśli okaże się, że pozostałych hello repliki są niewystarczające toocontinue od scenariusza dataloss i nie można odtworzyć stanu usługi z telemetrii lub spalin, hello częstotliwości kopii zapasowych określa Twoje najlepsze możliwe cel punktu odzyskiwania należy (RPO) .</span><span class="sxs-lookup"><span data-stu-id="59366-261">If you find out that hello remaining replicas are insufficient toocontinue from in a dataloss scenario, and you can't reconstruct service state from telemetry or exhaust, hello frequency of your backups determines your best possible recovery point objective (RPO).</span></span> <span data-ttu-id="59366-262">Sieć szkieletowa usług oferuje wiele narzędzi do testowania różnych scenariuszy awarii, w tym stałe kworum i dataloss wymagające Przywracanie z kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="59366-262">Service Fabric provides many tools for testing various failure scenarios, including permanent quorum and dataloss requiring restoration from a backup.</span></span> <span data-ttu-id="59366-263">Te scenariusze są dołączone jako część narzędzia testowania usługi sieć szkieletowa, zarządza hello usługi analizy błędów.</span><span class="sxs-lookup"><span data-stu-id="59366-263">These scenarios are included as a part of Service Fabric's testability tools, managed by hello Fault Analysis Service.</span></span> <span data-ttu-id="59366-264">Więcej informacji dotyczących tych narzędzi i wzorce jest dostępna [tutaj](service-fabric-testability-overview.md).</span><span class="sxs-lookup"><span data-stu-id="59366-264">More info on those tools and patterns is available [here](service-fabric-testability-overview.md).</span></span> 

> [!NOTE]
> <span data-ttu-id="59366-265">Usługi systemu również mogą występować utraty kworum wpływu hello jest zagrożona toohello określonej usługi.</span><span class="sxs-lookup"><span data-stu-id="59366-265">System services can also suffer quorum loss, with hello impact being specific toohello service in question.</span></span> <span data-ttu-id="59366-266">Na przykład utrata kworum w usłudze nazewnictwa hello ma wpływ na rozpoznawania nazw, natomiast utrata kworum w usłudze Menedżer trybu failover hello blokowanie tworzenia nowych usług i pracy w trybie Failover.</span><span class="sxs-lookup"><span data-stu-id="59366-266">For instance, quorum loss in hello naming service impacts name resolution, whereas quorum loss in hello failover manager service blocks new service creation and failovers.</span></span> <span data-ttu-id="59366-267">Gdy usługi systemowe platformy Service Fabric hello wykonaj hello wzorca takie same jak usług do zarządzania stanem, nie jest zalecane czy powinny podejmować toomove je poza utraty kworum i do potencjalnych dataloss.</span><span class="sxs-lookup"><span data-stu-id="59366-267">While hello Service Fabric system services follow hello same pattern as your services for state management, it is not recommended that you should attempt toomove them out of Quorum Loss and into potential dataloss.</span></span> <span data-ttu-id="59366-268">zalecenie Hello jest w zamian za[poszukuje](service-fabric-support.md) toodetermine rozwiązania, które jest celem tooyour konkretnej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="59366-268">hello recommendation is instead too[seek support](service-fabric-support.md) toodetermine a solution that is targeted tooyour specific situation.</span></span>  <span data-ttu-id="59366-269">Zazwyczaj jest oczekiwania pożądane toosimply do hello replik zwracany w dół.</span><span class="sxs-lookup"><span data-stu-id="59366-269">Usually it is preferable toosimply wait until hello down replicas return.</span></span>
>

## <a name="availability-of-hello-service-fabric-cluster"></a><span data-ttu-id="59366-270">Dostępność hello klastra sieci szkieletowej usług</span><span class="sxs-lookup"><span data-stu-id="59366-270">Availability of hello Service Fabric cluster</span></span>
<span data-ttu-id="59366-271">Ogólnie rzecz biorąc samego klastra usługi sieć szkieletowa hello jest bardzo rozproszone środowisko z żadnego pojedynczego punktu awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-271">Generally speaking, hello Service Fabric cluster itself is a highly distributed environment with no single points of failure.</span></span> <span data-ttu-id="59366-272">Błąd dowolnego pojedynczego węzła nie spowoduje dostępności lub problemy ze zgodnością w przypadku klastra hello głównie, ponieważ usługi systemowe platformy Service Fabric hello wykonaj hello tych samych wskazówek wydanego wcześniej: one są zawsze uruchamiane z co najmniej trzech repliki domyślnie i tych, uruchamiania usług systemowych, które są bezstanowych we wszystkich węzłach.</span><span class="sxs-lookup"><span data-stu-id="59366-272">A failure of any one node will not cause availability or reliability issues for hello cluster, primarily because hello Service Fabric system services follow hello same guidelines provided earlier: they always run with three or more replicas by default, and those system services that are stateless run on all nodes.</span></span> <span data-ttu-id="59366-273">pełni rozpowszechnianych Hello źródłowej sieci szkieletowej usług sieci i warstwy wykrywania awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-273">hello underlying Service Fabric networking and failure detection layers are fully distributed.</span></span> <span data-ttu-id="59366-274">Większość usług systemu może zostać również przebudowany z metadanych w klastrze hello lub wiedzieć, jak tooresynchronize ich stan w innych miejscach.</span><span class="sxs-lookup"><span data-stu-id="59366-274">Most system services can be rebuilt from metadata in hello cluster, or know how tooresynchronize their state from other places.</span></span> <span data-ttu-id="59366-275">dostępność Hello hello klastra można złamane, gdy usługi systemowe pobranie do kworum utraty sytuacji takich jak opisane powyżej.</span><span class="sxs-lookup"><span data-stu-id="59366-275">hello availability of hello cluster can become compromised if system services get into quorum loss situations like those described above.</span></span> <span data-ttu-id="59366-276">W takich przypadkach może nie być możliwe tooperform niektórych operacji w klastrze hello, takich jak uruchomienie uaktualnienia lub wdrażania nowych usług, ale samego klastra hello jest nadal uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="59366-276">In these cases you may not be able tooperform certain operations on hello cluster like starting an upgrade or deploying new services, but hello cluster itself is still up.</span></span> <span data-ttu-id="59366-277">O ile nie wymagają one zapisy toohello usług toocontinue funkcjonowaniem pozostanie uruchomiona w tych warunkach usług na już uruchomione.</span><span class="sxs-lookup"><span data-stu-id="59366-277">Services on already running will remain running in these conditions unless they require writes toohello system services toocontinue functioning.</span></span> <span data-ttu-id="59366-278">Na przykład jeśli hello menedżera trybu Failover jest w wyniku utraty kworum wszystkie usługi będą nadal toorun, ale żadnych usług, które nie są nie będą mogli tooautomatically ponownego uruchomienia, ponieważ wymaga to hello zaangażowania hello menedżera trybu Failover.</span><span class="sxs-lookup"><span data-stu-id="59366-278">For example, if hello Failover Manager is in quorum loss all services will continue toorun, but any services that fail will not be able tooautomatically restart, since this requires hello involvement of hello Failover Manager.</span></span> 

### <a name="failures-of-a-datacenter-or-azure-region"></a><span data-ttu-id="59366-279">Awarii centrum danych lub region platformy Azure</span><span class="sxs-lookup"><span data-stu-id="59366-279">Failures of a datacenter or Azure region</span></span>
<span data-ttu-id="59366-280">W rzadkich przypadkach centrum danych fizycznych może stać się tymczasowo niedostępny z powodu tooloss łączności sieciowej lub zasilania.</span><span class="sxs-lookup"><span data-stu-id="59366-280">In rare cases, a physical data center can become temporarily unavailable due tooloss of power or network connectivity.</span></span> <span data-ttu-id="59366-281">W takich przypadkach swoich klastrów platformy Service Fabric i usług w centrum danych lub regionu Azure będą niedostępne.</span><span class="sxs-lookup"><span data-stu-id="59366-281">In these cases, your Service Fabric clusters and services in that datacenter or Azure region will be unavailable.</span></span> <span data-ttu-id="59366-282">Jednak _danych jest zachowywana_.</span><span class="sxs-lookup"><span data-stu-id="59366-282">However, _your data is preserved_.</span></span> <span data-ttu-id="59366-283">Aktualizacje dla klastrów działających na platformie Azure, można wyświetlić na awarie na powitania [strony stanu platformy Azure][azure-status-dashboard].</span><span class="sxs-lookup"><span data-stu-id="59366-283">For clusters running in Azure, you can view updates on outages on hello [Azure status page][azure-status-dashboard].</span></span> <span data-ttu-id="59366-284">W hello bardzo mało prawdopodobne zdarzenie centrum danych fizycznych częściowo lub całkowicie zniszczone żadnych klastrów sieci szkieletowej usług hostowanych lub hello usług zawartych w nich mogą zostać utracone.</span><span class="sxs-lookup"><span data-stu-id="59366-284">In hello highly unlikely event that a physical data center is partially or fully destroyed, any Service Fabric clusters hosted there or hello services inside them could be lost.</span></span> <span data-ttu-id="59366-285">W tym wszelkie stanu kopii zapasowej nie poza tym centrum danych lub regionu.</span><span class="sxs-lookup"><span data-stu-id="59366-285">This includes any state not backed up outside of that datacenter or region.</span></span>

<span data-ttu-id="59366-286">Brak dwa różne strategie pozostałych hello stałych lub utrzymujących awarii jednego centrum danych lub regionu.</span><span class="sxs-lookup"><span data-stu-id="59366-286">There's two different strategies for surviving hello permanent or sustained failure of a single datacenter or region.</span></span> 

1. <span data-ttu-id="59366-287">Uruchom oddzielne klastry sieci szkieletowej usług w wielu regionach takich i korzystanie z mechanizmu dla trybu failover i powrotu po awarii między tych środowisk.</span><span class="sxs-lookup"><span data-stu-id="59366-287">Run separate Service Fabric clusters in multiple such regions, and utilize some mechanism for failover and fail-back between these environments.</span></span> <span data-ttu-id="59366-288">Tego rodzaju wielu klastrów aktywny aktywny lub aktywny / pasywny model wymaga dodatkowego kodu zarządzanie i operacje.</span><span class="sxs-lookup"><span data-stu-id="59366-288">This sort of multi-cluster active-active or active-passive model requires additional management and operations code.</span></span> <span data-ttu-id="59366-289">To wymaga również, że koordynacji kopii zapasowych z usług hello w jednym centrum danych lub regionu, aby były dostępne w innych centrów danych lub regionach, gdy dla jednego nie powiedzie się.</span><span class="sxs-lookup"><span data-stu-id="59366-289">This also requires coordination of backups from hello services in one datacenter or region so that they are available in other datacenters or regions when one fails.</span></span> 
2. <span data-ttu-id="59366-290">Uruchom jednego klastra usługi sieć szkieletowa, obejmującej wiele centrów danych lub regionach.</span><span class="sxs-lookup"><span data-stu-id="59366-290">Run a single Service Fabric cluster that spans multiple datacenters or regions.</span></span> <span data-ttu-id="59366-291">Witaj minimalnej obsługiwanej konfiguracji dla tego jest trzech centrów danych lub regionach.</span><span class="sxs-lookup"><span data-stu-id="59366-291">hello minimum supported configuration for this is three datacenters or regions.</span></span> <span data-ttu-id="59366-292">Witaj zalecane liczbie regionów lub centrów danych osiągnie wartość 5.</span><span class="sxs-lookup"><span data-stu-id="59366-292">hello recommended number of regions or datacenters is five.</span></span> <span data-ttu-id="59366-293">Wymaga to bardziej złożona Topologia klastra.</span><span class="sxs-lookup"><span data-stu-id="59366-293">This requires a more complex cluster topology.</span></span> <span data-ttu-id="59366-294">Witaj zaletą tego modelu jest jednak czy awarii jednego centrum danych lub regionu jest konwertowany na normalne błąd w danych po awarii.</span><span class="sxs-lookup"><span data-stu-id="59366-294">However, hello benefit of this model is that failure of one datacenter or region is converted from a disaster into a normal failure.</span></span> <span data-ttu-id="59366-295">Te błędy są obsługiwane przez hello mechanizmy, które działają w przypadku klastrów w pojedynczym regionie.</span><span class="sxs-lookup"><span data-stu-id="59366-295">These failures can be handled by hello mechanisms that work for clusters within a single region.</span></span> <span data-ttu-id="59366-296">Domen błędów domen uaktualnienia i reguły umieszczania usługi sieć szkieletowa upewnij się, że obciążenia są dystrybuowane, tak aby ich tolerować błędy normalnego.</span><span class="sxs-lookup"><span data-stu-id="59366-296">Fault domains, upgrade domains, and Service Fabric's placement rules ensure workloads are distributed so that they tolerate normal failures.</span></span> <span data-ttu-id="59366-297">Aby uzyskać więcej informacji dotyczących zasad, które mogą pomóc działać usługi, w tym typie klastra, przeczytaj na [zasad umieszczania](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md)</span><span class="sxs-lookup"><span data-stu-id="59366-297">For more information on policies that can help operate services in this type of cluster, read up on [placement policies](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md)</span></span>

### <a name="random-failures-leading-toocluster-failures"></a><span data-ttu-id="59366-298">Losowe awarie wiodące toocluster błędów</span><span class="sxs-lookup"><span data-stu-id="59366-298">Random failures leading toocluster failures</span></span>
<span data-ttu-id="59366-299">Sieć szkieletowa usług ma koncepcji hello węzłów inicjatora.</span><span class="sxs-lookup"><span data-stu-id="59366-299">Service Fabric has hello concept of Seed Nodes.</span></span> <span data-ttu-id="59366-300">Są to węzły, które zachować dostępność hello hello podstawowej klastra.</span><span class="sxs-lookup"><span data-stu-id="59366-300">These are nodes that maintain hello availability of hello underlying cluster.</span></span> <span data-ttu-id="59366-301">Te węzły pomoc pozostaje klastra hello tooensure się przez ustanawiania dzierżawy na innych węzłach i służących jako tiebreakers podczas niektóre rodzaje awarie sieci.</span><span class="sxs-lookup"><span data-stu-id="59366-301">These nodes help tooensure hello cluster remains up by establishing leases with other nodes and serving as tiebreakers during certain kinds of network failures.</span></span> <span data-ttu-id="59366-302">Jeśli nie zostaną one zwrócone losowe awarie usunięcia większości węzłów inicjatora hello w klastrze hello, hello klastra zostaje automatycznie zamknięty.</span><span class="sxs-lookup"><span data-stu-id="59366-302">If random failures remove a majority of hello seed nodes in hello cluster and they are not brought back, hello cluster automatically shuts down.</span></span> <span data-ttu-id="59366-303">Na platformie Azure, są automatycznie zarządzane węzłów inicjatora: są rozłożone domenach hello dostępne awarii i uaktualniania, a jeśli jeden węzeł zostanie usunięty z klastra hello innego zostanie utworzona w tym miejscu.</span><span class="sxs-lookup"><span data-stu-id="59366-303">In Azure, Seed Nodes are automatically managed: they are distributed over hello available fault and upgrade domains, and if a single seed node is removed from hello cluster another one will be created in its place.</span></span> 

<span data-ttu-id="59366-304">Zarówno w przypadku autonomicznych klastrów sieci szkieletowej usług, jak i Azure "Podstawowego typu węzła" hello jest hello, który uruchamia hello ziarna.</span><span class="sxs-lookup"><span data-stu-id="59366-304">In both standalone Service Fabric clusters and Azure, hello "Primary Node Type" is hello one that runs hello seeds.</span></span> <span data-ttu-id="59366-305">Podczas definiowania typu węzła podstawowego, usługi sieć szkieletowa automatycznie skorzystają hello liczby węzłów, tworząc węzłów inicjatora too9 i 9 replik każdej hello usług systemowych.</span><span class="sxs-lookup"><span data-stu-id="59366-305">When defining a primary node type, Service Fabric will automatically take advantage of hello number of nodes provided by creating up too9 seed nodes and 9 replicas of each of hello system services.</span></span> <span data-ttu-id="59366-306">Jeśli zestaw losowe awarie przyjmuje się większość tych replik usługi systemu jednocześnie, hello usług systemowych wprowadź utraty kworum, możemy opisanych powyżej.</span><span class="sxs-lookup"><span data-stu-id="59366-306">If a set of random failures takes out a majority of those system service replicas simultaneously, hello system services will enter quorum loss, as we described above.</span></span> <span data-ttu-id="59366-307">W przypadku utraty Większość węzłów inicjatora hello hello klastra zostanie zamknięty wkrótce po.</span><span class="sxs-lookup"><span data-stu-id="59366-307">If a majority of hello seed nodes are lost, hello cluster will shut down soon after.</span></span>

## <a name="next-steps"></a><span data-ttu-id="59366-308">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="59366-308">Next steps</span></span>
- <span data-ttu-id="59366-309">Dowiedz się, jak toosimulate różnych błędów przy użyciu hello [framework testowania](service-fabric-testability-overview.md)</span><span class="sxs-lookup"><span data-stu-id="59366-309">Learn how toosimulate various failures using hello [testability framework](service-fabric-testability-overview.md)</span></span>
- <span data-ttu-id="59366-310">Przeczytaj inne zasoby odzyskiwania po awarii i wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="59366-310">Read other disaster-recovery and high-availability resources.</span></span> <span data-ttu-id="59366-311">Firma Microsoft udostępniła dużej liczby wskazówek na następujące tematy.</span><span class="sxs-lookup"><span data-stu-id="59366-311">Microsoft has published a large amount of guidance on these topics.</span></span> <span data-ttu-id="59366-312">Gdy niektóre z tych dokumentów odwołują się techniki toospecific do użycia w innych produktów, zawierają wiele ogólne najlepsze rozwiązania, które można zastosować w kontekście sieci szkieletowej usług hello również:</span><span class="sxs-lookup"><span data-stu-id="59366-312">While some of these documents refer toospecific techniques for use in other products, they contain many general best practices you can apply in hello Service Fabric context as well:</span></span>
  - [<span data-ttu-id="59366-313">Lista kontrolna dotycząca dostępności</span><span class="sxs-lookup"><span data-stu-id="59366-313">Availability checklist</span></span>](../best-practices-availability-checklist.md)
  - [<span data-ttu-id="59366-314">Wykonywanie wyszczególniania odzyskiwania po awarii</span><span class="sxs-lookup"><span data-stu-id="59366-314">Performing a disaster recovery drill</span></span>](../sql-database/sql-database-disaster-recovery-drills.md)
  - <span data-ttu-id="59366-315">[Odzyskiwanie po awarii i wysoką dostępność aplikacji Azure][dr-ha-guide]</span><span class="sxs-lookup"><span data-stu-id="59366-315">[Disaster recovery and high availability for Azure applications][dr-ha-guide]</span></span>
- <span data-ttu-id="59366-316">Uzyskaj informacje o [opcjach pomocy technicznej usługi Service Fabric](service-fabric-support.md)</span><span class="sxs-lookup"><span data-stu-id="59366-316">Learn about [Service Fabric support options](service-fabric-support.md)</span></span>

<!-- External links -->

[repair-partition-ps]: https://msdn.microsoft.com/library/mt163522.aspx
[azure-status-dashboard]:https://azure.microsoft.com/status/
[azure-regions]: https://azure.microsoft.com/regions/
[dr-ha-guide]: https://msdn.microsoft.com/library/azure/dn251004.aspx


<!-- Images -->

[sfx-cluster-map]: ./media/service-fabric-disaster-recovery/sfx-clustermap.png
