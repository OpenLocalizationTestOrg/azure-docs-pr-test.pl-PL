---
title: "Kontroli: Komunikacja usługi | Dokumentacja firmy Microsoft"
description: "Usługi do komunikacji jest punktem krytyczne integracji aplikacji sieci szkieletowej usług. W tym artykule omówiono zagadnienia dotyczące projektowania i testowania technik."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: 017557df-fb59-4e4a-a65d-2732f29255b8
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 4a8f941c1e8e641384a9ee3a1149dabaaf9983cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-testability-scenarios-service-communication"></a><span data-ttu-id="e3d49-104">Scenariusze testowania usługi Service Fabric: komunikacji usługi</span><span class="sxs-lookup"><span data-stu-id="e3d49-104">Service Fabric testability scenarios: Service communication</span></span>
<span data-ttu-id="e3d49-105">Powierzchnia zorientowane na usługę architektury style naturalnie w sieci szkieletowej usług Azure i Mikrousług.</span><span class="sxs-lookup"><span data-stu-id="e3d49-105">Microservices and service-oriented architectural styles surface naturally in Azure Service Fabric.</span></span> <span data-ttu-id="e3d49-106">W tych typów architektury rozproszonej składnikowa mikrousługi aplikacji zwykle składają się z wielu usług, które wymagają tootalk tooeach innych.</span><span class="sxs-lookup"><span data-stu-id="e3d49-106">In these types of distributed architectures, componentized microservice applications are typically composed of multiple services that need tootalk tooeach other.</span></span> <span data-ttu-id="e3d49-107">W przypadku najprostszym nawet hello zazwyczaj masz co najmniej usługi bezstanowej sieci web i usługi magazynu danych stanowe wymagającym toocommunicate.</span><span class="sxs-lookup"><span data-stu-id="e3d49-107">In even hello simplest cases, you generally have at least a stateless web service and a stateful data storage service that need toocommunicate.</span></span>

<span data-ttu-id="e3d49-108">Usługi do komunikacji jest punktem krytyczne integracji aplikacji, ponieważ każda usługa przedstawia zdalnej usługi tooother interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="e3d49-108">Service-to-service communication is a critical integration point of an application, because each service exposes a remote API tooother services.</span></span> <span data-ttu-id="e3d49-109">Praca z zestawu granice interfejsu API, które zwykle obejmuje we/wy wymaga niektórych opieki z dobrym ilością testowania i weryfikacji.</span><span class="sxs-lookup"><span data-stu-id="e3d49-109">Working with a set of API boundaries that involves I/O generally requires some care, with a good amount of testing and validation.</span></span>

<span data-ttu-id="e3d49-110">Gdy granice te usługi są połączone ze sobą w rozproszonym systemie są liczne toomake zagadnienia:</span><span class="sxs-lookup"><span data-stu-id="e3d49-110">There are numerous considerations toomake when these service boundaries are wired together in a distributed system:</span></span>

* <span data-ttu-id="e3d49-111">*Protokół transportu*.</span><span class="sxs-lookup"><span data-stu-id="e3d49-111">*Transport protocol*.</span></span> <span data-ttu-id="e3d49-112">Maksymalnej przepływności zostanie użyty HTTP współdziałania zwiększone lub binarne protokołu niestandardowego?</span><span class="sxs-lookup"><span data-stu-id="e3d49-112">Will you use HTTP for increased interoperability, or a custom binary protocol for maximum throughput?</span></span>
* <span data-ttu-id="e3d49-113">*Obsługa błędów*.</span><span class="sxs-lookup"><span data-stu-id="e3d49-113">*Error handling*.</span></span> <span data-ttu-id="e3d49-114">Sposób trwałe i przejściowych błędów obsługi?</span><span class="sxs-lookup"><span data-stu-id="e3d49-114">How will permanent and transient errors be handled?</span></span> <span data-ttu-id="e3d49-115">Co się stanie, jeśli usługa jest przenoszony tooa inny węzeł?</span><span class="sxs-lookup"><span data-stu-id="e3d49-115">What will happen when a service moves tooa different node?</span></span>
* <span data-ttu-id="e3d49-116">*Limity czasu i opóźnienia*.</span><span class="sxs-lookup"><span data-stu-id="e3d49-116">*Timeouts and latency*.</span></span> <span data-ttu-id="e3d49-117">W aplikacjach rozwiązania jak każdej warstwy usług obsłuży opóźnienia za pośrednictwem hello stosu i toohello użytkowników?</span><span class="sxs-lookup"><span data-stu-id="e3d49-117">In multitiered applications, how will each service layer handle latency through hello stack and toohello user?</span></span>

<span data-ttu-id="e3d49-118">Czy używany jest jeden składniki komunikacji wbudowanej usługi hello dostarczony przez sieć szkieletowa usług lub tworzenia własnych, testowanie hello interakcje między usług jest odporność tooensuring krytyczne w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e3d49-118">Whether you use one of hello built-in service communication components provided by Service Fabric or you build your own, testing hello interactions between your services is critical tooensuring resiliency in your application.</span></span>

## <a name="prepare-for-services-toomove"></a><span data-ttu-id="e3d49-119">Przygotowanie do toomove usług</span><span class="sxs-lookup"><span data-stu-id="e3d49-119">Prepare for services toomove</span></span>
<span data-ttu-id="e3d49-120">Wystąpienie usługi może poruszanie się w czasie.</span><span class="sxs-lookup"><span data-stu-id="e3d49-120">Service instances may move around over time.</span></span> <span data-ttu-id="e3d49-121">Jest to szczególnie istotne, skonfigurowanymi metryki dostosowane niestandardowych zasobów optymalne równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="e3d49-121">This is especially true when they are configured with load metrics for custom-tailored optimal resource balancing.</span></span> <span data-ttu-id="e3d49-122">Sieć szkieletowa usług przenosi Twojej toomaximize wystąpień usługi ich dostępności nawet podczas uaktualnienia, praca awaryjna skalowalnego w poziomie i innych sytuacjach, w których odbywa się za pośrednictwem istnienia hello rozproszonego systemu.</span><span class="sxs-lookup"><span data-stu-id="e3d49-122">Service Fabric moves your service instances toomaximize their availability even during upgrades, failovers, scale-out, and other situations that occur over hello lifetime of a distributed system.</span></span>

<span data-ttu-id="e3d49-123">Jak usługi poruszanie się w klastrze hello, klientów i innych usług powinny być przygotowane toohandle dwa scenariusze one mówiąc tooa usługi:</span><span class="sxs-lookup"><span data-stu-id="e3d49-123">As services move around in hello cluster, your clients and other services should be prepared toohandle two scenarios when they talk tooa service:</span></span>

* <span data-ttu-id="e3d49-124">repliki wystąpienia lub partycji usługi Hello zostały przeniesione od czasu ostatniego należy zawsze mówię tooit hello.</span><span class="sxs-lookup"><span data-stu-id="e3d49-124">hello service instance or partition replica has moved since hello last time you talked tooit.</span></span> <span data-ttu-id="e3d49-125">Jest to normalne część cyklu życia usług, a powinien być oczekiwany toohappen okres istnienia hello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e3d49-125">This is a normal part of a service lifecycle, and it should be expected toohappen during hello lifetime of your application.</span></span>
* <span data-ttu-id="e3d49-126">repliki wystąpienia lub partycji usługi Hello jest hello proces przechodzenia.</span><span class="sxs-lookup"><span data-stu-id="e3d49-126">hello service instance or partition replica is in hello process of moving.</span></span> <span data-ttu-id="e3d49-127">Mimo że w sieci szkieletowej usług występuje bardzo szybko pracy awaryjnej usługi z jednego węzła tooanother, mogą występować opóźnienia w dostępności Jeśli hello komunikacji składnik usługi jest powolne toostart.</span><span class="sxs-lookup"><span data-stu-id="e3d49-127">Although failover of a service from one node tooanother occurs very quickly in Service Fabric, there may be a delay in availability if hello communication component of your service is slow toostart.</span></span>

<span data-ttu-id="e3d49-128">Bezpiecznie obsługi tych scenariuszy jest ważna w przypadku systemu smooth uruchomiona.</span><span class="sxs-lookup"><span data-stu-id="e3d49-128">Handling these scenarios gracefully is important for a smooth-running system.</span></span> <span data-ttu-id="e3d49-129">toodo tak, należy pamiętać, że:</span><span class="sxs-lookup"><span data-stu-id="e3d49-129">toodo so, keep in mind that:</span></span>

* <span data-ttu-id="e3d49-130">Każda usługa, które mogą być połączone toohas *adres* nasłuchującej na (na przykład HTTP lub Websocket).</span><span class="sxs-lookup"><span data-stu-id="e3d49-130">Every service that can be connected toohas an *address* that it listens on (for example, HTTP or WebSockets).</span></span> <span data-ttu-id="e3d49-131">Przenosi wystąpienie usługi lub partycję, zmienia jego adres punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="e3d49-131">When a service instance or partition moves, its address endpoint changes.</span></span> <span data-ttu-id="e3d49-132">(Przesyłane tooa inny węzeł, używając innego adresu IP). Jeśli używasz składniki komunikacji wbudowanej hello one obsłuży ponowne rozpoznawania adresów usługi dla Ciebie.</span><span class="sxs-lookup"><span data-stu-id="e3d49-132">(It moves tooa different node with a different IP address.) If you're using hello built-in communication components, they will handle re-resolving service addresses for you.</span></span>
* <span data-ttu-id="e3d49-133">Prawdopodobnie wystąpił tymczasowy wzrost opóźnienia usługi podczas uruchamiania wystąpienia usługi hello się jego odbiornika ponownie.</span><span class="sxs-lookup"><span data-stu-id="e3d49-133">There may be a temporary increase in service latency as hello service instance starts up its listener again.</span></span> <span data-ttu-id="e3d49-134">Zależy to od jak szybko usługi hello otwiera odbiornika powitania po przeniesieniu hello wystąpienie usługi.</span><span class="sxs-lookup"><span data-stu-id="e3d49-134">This depends on how quickly hello service opens hello listener after hello service instance is moved.</span></span>
* <span data-ttu-id="e3d49-135">Istniejących połączeń muszą toobe zamknięte i otwarte ponownie po hello usługi zostanie otwarty w nowym węźle.</span><span class="sxs-lookup"><span data-stu-id="e3d49-135">Any existing connections need toobe closed and reopened after hello service opens on a new node.</span></span> <span data-ttu-id="e3d49-136">Bezpieczne węzła zamknięcia lub ponownego uruchomienia umożliwia czas dla istniejących toobe połączeń prawidłowe zamknięcie.</span><span class="sxs-lookup"><span data-stu-id="e3d49-136">A graceful node shutdown or restart allows time for existing connections toobe shut down gracefully.</span></span>

### <a name="test-it-move-service-instances"></a><span data-ttu-id="e3d49-137">Należy przeprowadzić test: Przenieś wystąpienia usługi</span><span class="sxs-lookup"><span data-stu-id="e3d49-137">Test it: Move service instances</span></span>
<span data-ttu-id="e3d49-138">Za pomocą narzędzia do testowania usługi Service Fabric, można tworzyć tootest scenariusza testu tych sytuacji na różne sposoby:</span><span class="sxs-lookup"><span data-stu-id="e3d49-138">By using Service Fabric's testability tools, you can author a test scenario tootest these situations in different ways:</span></span>

1. <span data-ttu-id="e3d49-139">Przenieś usługi stanowej repliki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="e3d49-139">Move a stateful service's primary replica.</span></span>
   
    <span data-ttu-id="e3d49-140">Witaj repliki podstawowej partycji usługi stanowej można przenieść dla dowolnej liczby powodów.</span><span class="sxs-lookup"><span data-stu-id="e3d49-140">hello primary replica of a stateful service partition can be moved for any number of reasons.</span></span> <span data-ttu-id="e3d49-141">Użyj tego tootarget hello replikę podstawową toosee określonej partycji, jak przenieść Twojej usługi w bibliotece react toohello w bardzo kontrolowany sposób.</span><span class="sxs-lookup"><span data-stu-id="e3d49-141">Use this tootarget hello primary replica of a specific partition toosee how your services react toohello move in a very controlled manner.</span></span>
   
    ```powershell
   
    PS > Move-ServiceFabricPrimaryReplica -PartitionId 6faa4ffa-521a-44e9-8351-dfca0f7e0466 -ServiceName fabric:/MyApplication/MyService
   
    ```
2. <span data-ttu-id="e3d49-142">Zatrzymanie węzła.</span><span class="sxs-lookup"><span data-stu-id="e3d49-142">Stop a node.</span></span>
   
    <span data-ttu-id="e3d49-143">Po zatrzymaniu węzeł sieci szkieletowej usług przenosi wszystkie hello wystąpień lub partycje, które były na tym tooone węzeł z usługi hello inne dostępne węzły w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="e3d49-143">When a node is stopped, Service Fabric moves all of hello service instances or partitions that were on that node tooone of hello other available nodes in hello cluster.</span></span> <span data-ttu-id="e3d49-144">Użyj tej sytuacji, gdy węzeł ma utracone z klastra i wszystkich wystąpień usługi hello i replik w tym węźle ma toomove tootest.</span><span class="sxs-lookup"><span data-stu-id="e3d49-144">Use this tootest a situation where a node is lost from your cluster and all of hello service instances and replicas on that node have toomove.</span></span>
   
    <span data-ttu-id="e3d49-145">Węzeł można zatrzymać za pomocą programu PowerShell hello **Stop ServiceFabricNode** polecenia cmdlet:</span><span class="sxs-lookup"><span data-stu-id="e3d49-145">You can stop a node by using hello PowerShell **Stop-ServiceFabricNode** cmdlet:</span></span>
   
    ```powershell
   
    PS > Restart-ServiceFabricNode -NodeName Node_1
   
    ```

## <a name="maintain-service-availability"></a><span data-ttu-id="e3d49-146">Obsługa dostępność usługi</span><span class="sxs-lookup"><span data-stu-id="e3d49-146">Maintain service availability</span></span>
<span data-ttu-id="e3d49-147">Jako platforma usługi sieć szkieletowa jest zaprojektowana tooprovide wysoką dostępność usług.</span><span class="sxs-lookup"><span data-stu-id="e3d49-147">As a platform, Service Fabric is designed tooprovide high availability of your services.</span></span> <span data-ttu-id="e3d49-148">Ale w ekstremalnych przypadkach problemy związane z infrastrukturą podstawowej nadal powodują niedostępności.</span><span class="sxs-lookup"><span data-stu-id="e3d49-148">But in extreme cases, underlying infrastructure problems can still cause unavailability.</span></span> <span data-ttu-id="e3d49-149">Zbyt jest ważne tootest dla tych scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="e3d49-149">It is important tootest for these scenarios, too.</span></span>

<span data-ttu-id="e3d49-150">Usługi stanowej korzystania ze stanu tooreplicate systemu kworum wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="e3d49-150">Stateful services use a quorum-based system tooreplicate state for high availability.</span></span> <span data-ttu-id="e3d49-151">Oznacza to, że kworum replik wymaga operacje zapisu dla toobe tooperform dostępne.</span><span class="sxs-lookup"><span data-stu-id="e3d49-151">This means that a quorum of replicas needs toobe available tooperform write operations.</span></span> <span data-ttu-id="e3d49-152">W rzadkich przypadkach, takich jak awaria sprzętu powszechnie kworum replik nie mogą być dostępne.</span><span class="sxs-lookup"><span data-stu-id="e3d49-152">In rare cases, such as a widespread hardware failure, a quorum of replicas may not be available.</span></span> <span data-ttu-id="e3d49-153">W takich przypadkach nie będą mogli tooperform operacji zapisu, ale nadal będzie można tooperform operacji odczytu.</span><span class="sxs-lookup"><span data-stu-id="e3d49-153">In these cases, you will not be able tooperform write operations, but you will still be able tooperform read operations.</span></span>

### <a name="test-it-write-operation-unavailability"></a><span data-ttu-id="e3d49-154">Należy przeprowadzić test: niedostępności operację zapisu</span><span class="sxs-lookup"><span data-stu-id="e3d49-154">Test it: Write operation unavailability</span></span>
<span data-ttu-id="e3d49-155">Przy użyciu narzędzia do testowania hello w sieci szkieletowej usług, można wstrzyknąć błędów, która powoduje utratę kworum jako test.</span><span class="sxs-lookup"><span data-stu-id="e3d49-155">By using hello testability tools in Service Fabric, you can inject a fault that induces quorum loss as a test.</span></span> <span data-ttu-id="e3d49-156">Mimo że takiej sytuacji jest rzadko, ważne jest, czy klienci i usługi, które są zależne od usługi stanowej są przygotowywane toohandle sytuacji, gdy nie może podjąć tooit żądań zapisu.</span><span class="sxs-lookup"><span data-stu-id="e3d49-156">Although such a scenario is rare, it is important that clients and services that depend on a stateful service are prepared toohandle situations where they cannot make write requests tooit.</span></span> <span data-ttu-id="e3d49-157">Ważne jest również czy sama usługa hello stanowe zna tej możliwości i można bezpiecznie powiadamia toocallers.</span><span class="sxs-lookup"><span data-stu-id="e3d49-157">It is also important that hello stateful service itself is aware of this possibility and can gracefully communicate it toocallers.</span></span>

<span data-ttu-id="e3d49-158">Utrata kworum może wywołać przy użyciu programu PowerShell hello **Invoke ServiceFabricPartitionQuorumLoss** polecenia cmdlet:</span><span class="sxs-lookup"><span data-stu-id="e3d49-158">You can induce quorum loss by using hello PowerShell **Invoke-ServiceFabricPartitionQuorumLoss** cmdlet:</span></span>

```powershell

PS > Invoke-ServiceFabricPartitionQuorumLoss -ServiceName fabric:/Myapplication/MyService -QuorumLossMode QuorumReplicas -QuorumLossDurationInSeconds 20

```

<span data-ttu-id="e3d49-159">W tym przykładzie ustawiliśmy `QuorumLossMode` zbyt`QuorumReplicas` tooindicate, która ma utraty kworum tooinduce bez konieczności przełączania w dół wszystkie repliki.</span><span class="sxs-lookup"><span data-stu-id="e3d49-159">In this example, we set `QuorumLossMode` too`QuorumReplicas` tooindicate that we want tooinduce quorum loss without taking down all replicas.</span></span> <span data-ttu-id="e3d49-160">W ten sposób operacje odczytu są nadal możliwe.</span><span class="sxs-lookup"><span data-stu-id="e3d49-160">This way, read operations are still possible.</span></span> <span data-ttu-id="e3d49-161">Scenariusz, w którym cały partycji jest niedostępny, tootest tego przełącznika można ustawić także`AllReplicas`.</span><span class="sxs-lookup"><span data-stu-id="e3d49-161">tootest a scenario where an entire partition is unavailable, you can set this switch too`AllReplicas`.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e3d49-162">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="e3d49-162">Next steps</span></span>
[<span data-ttu-id="e3d49-163">Dowiedz się więcej na temat testowania czynności</span><span class="sxs-lookup"><span data-stu-id="e3d49-163">Learn more about testability actions</span></span>](service-fabric-testability-actions.md)

[<span data-ttu-id="e3d49-164">Dowiedz się więcej o scenariuszach kontroli</span><span class="sxs-lookup"><span data-stu-id="e3d49-164">Learn more about testability scenarios</span></span>](service-fabric-testability-scenarios.md)

