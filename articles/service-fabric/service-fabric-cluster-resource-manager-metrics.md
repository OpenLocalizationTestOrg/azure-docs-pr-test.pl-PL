---
title: "za pomocą metryki obciążenia Azure mikrousługi aaaManage | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat sposób użycia zasobów usługi tooconfigure i użyj metryk w toomanage sieci szkieletowej usług."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 0d622ea6-a7c7-4bef-886b-06e6b85a97fb
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 592dc749ce30683a1e439a702b7d0dc0a638276f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="managing-resource-consumption-and-load-in-service-fabric-with-metrics"></a><span data-ttu-id="2af0a-103">Zarządzanie zużycia zasobów i obciążenia w sieci szkieletowej usług o metryki</span><span class="sxs-lookup"><span data-stu-id="2af0a-103">Managing resource consumption and load in Service Fabric with metrics</span></span>
<span data-ttu-id="2af0a-104">*Metryki* zasoby hello Twojej usługi najważniejsze informacje, które są udostępniane przez hello węzłów w klastrze hello.</span><span class="sxs-lookup"><span data-stu-id="2af0a-104">*Metrics* are hello resources that your services care about and which are provided by hello nodes in hello cluster.</span></span> <span data-ttu-id="2af0a-105">Metryka to wszystko, które mają toomanage w kolejności tooimprove lub monitor wydajności hello usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-105">A metric is anything that you want toomanage in order tooimprove or monitor hello performance of your services.</span></span> <span data-ttu-id="2af0a-106">Mogą na przykład obserwować tooknow zużycie pamięci, jeśli usługa jest przeciążony.</span><span class="sxs-lookup"><span data-stu-id="2af0a-106">For example, you might watch memory consumption tooknow if your service is overloaded.</span></span> <span data-ttu-id="2af0a-107">Użyj innego jest toofigure się, czy można przenieść usługę hello innym miejscu, gdzie pamięci jest mniejsza ograniczonego w kolejności tooget lepszą wydajność.</span><span class="sxs-lookup"><span data-stu-id="2af0a-107">Another use is toofigure out whether hello service could move elsewhere where memory is less constrained in order tooget better performance.</span></span>

<span data-ttu-id="2af0a-108">Np. użycia pamięci, dysku i procesora CPU przedstawiono metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-108">Things like Memory, Disk, and CPU usage are examples of metrics.</span></span> <span data-ttu-id="2af0a-109">Te metryki są metryki fizycznych, zasobów, które odpowiadają toophysical zasobów w węźle hello, wymagającym toobe zarządzane.</span><span class="sxs-lookup"><span data-stu-id="2af0a-109">These metrics are physical metrics, resources that correspond toophysical resources on hello node that need toobe managed.</span></span> <span data-ttu-id="2af0a-110">Metryki mogą być również (i często są) logicznej metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-110">Metrics can also be (and commonly are) logical metrics.</span></span> <span data-ttu-id="2af0a-111">Metryki logiczne są elementy, takie jak "MyWorkQueueDepth" lub "MessagesToProcess" lub "TotalRecords".</span><span class="sxs-lookup"><span data-stu-id="2af0a-111">Logical metrics are things like “MyWorkQueueDepth” or "MessagesToProcess" or "TotalRecords".</span></span> <span data-ttu-id="2af0a-112">Metryki logiczne są zdefiniowane przez aplikację, a pośrednio odpowiada toosome zużycie zasobów fizycznych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-112">Logical metrics are application-defined and indirectly correspond toosome physical resource consumption.</span></span> <span data-ttu-id="2af0a-113">Metryki logiczne są często używane, może być twarde toomeasure i raportu zużycia zasobów fizycznych na podstawie-service.</span><span class="sxs-lookup"><span data-stu-id="2af0a-113">Logical metrics are common because it can be hard toomeasure and report consumption of physical resources on a per-service basis.</span></span> <span data-ttu-id="2af0a-114">złożoność Hello pomiarów i raportowania własne fizycznych metryki jest również, dlaczego Usługa Service Fabric realizuje niektóre domyślne metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-114">hello complexity of measuring and reporting your own physical metrics is also why Service Fabric provides some default metrics.</span></span>

## <a name="default-metrics"></a><span data-ttu-id="2af0a-115">Domyślne metryki</span><span class="sxs-lookup"><span data-stu-id="2af0a-115">Default metrics</span></span>
<span data-ttu-id="2af0a-116">Załóżmy, że chcesz tooget Rozpoczęto zapisywanie i wdrażania usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-116">Let’s say that you want tooget started writing and deploying your service.</span></span> <span data-ttu-id="2af0a-117">W tym momencie nie wiadomo, jakie zasoby fizyczne lub logiczne zużywa.</span><span class="sxs-lookup"><span data-stu-id="2af0a-117">At this point you don’t know what physical or logical resources it consumes.</span></span> <span data-ttu-id="2af0a-118">To świetnie!</span><span class="sxs-lookup"><span data-stu-id="2af0a-118">That’s fine!</span></span> <span data-ttu-id="2af0a-119">Hello zasobu klastra sieci szkieletowej programu Service Manager używa niektóre domyślne metryki, jeśli określono nie innych metryk.</span><span class="sxs-lookup"><span data-stu-id="2af0a-119">hello Service Fabric Cluster Resource Manager uses some default metrics when no other metrics are specified.</span></span> <span data-ttu-id="2af0a-120">Są to:</span><span class="sxs-lookup"><span data-stu-id="2af0a-120">They are:</span></span>

  - <span data-ttu-id="2af0a-121">PrimaryCount — liczba replik podstawowych, w węźle hello</span><span class="sxs-lookup"><span data-stu-id="2af0a-121">PrimaryCount - count of Primary replicas on hello node</span></span> 
  - <span data-ttu-id="2af0a-122">ReplicaCount — liczba całkowita stanowe replik w węźle hello</span><span class="sxs-lookup"><span data-stu-id="2af0a-122">ReplicaCount - count of total stateful replicas on hello node</span></span>
  - <span data-ttu-id="2af0a-123">Liczba — liczba wszystkich obiektów usługi (bezstanowe i stanowe) w węźle hello</span><span class="sxs-lookup"><span data-stu-id="2af0a-123">Count - count of all service objects (stateless and stateful) on hello node</span></span>

| <span data-ttu-id="2af0a-124">Metryka</span><span class="sxs-lookup"><span data-stu-id="2af0a-124">Metric</span></span> | <span data-ttu-id="2af0a-125">Obciążenia bezstanowe wystąpienia</span><span class="sxs-lookup"><span data-stu-id="2af0a-125">Stateless Instance Load</span></span> | <span data-ttu-id="2af0a-126">Stanowe dodatkowej obciążenia</span><span class="sxs-lookup"><span data-stu-id="2af0a-126">Stateful Secondary Load</span></span> | <span data-ttu-id="2af0a-127">Stanowego obciążenia podstawowego</span><span class="sxs-lookup"><span data-stu-id="2af0a-127">Stateful Primary Load</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2af0a-128">PrimaryCount</span><span class="sxs-lookup"><span data-stu-id="2af0a-128">PrimaryCount</span></span> |<span data-ttu-id="2af0a-129">0</span><span class="sxs-lookup"><span data-stu-id="2af0a-129">0</span></span> |<span data-ttu-id="2af0a-130">0</span><span class="sxs-lookup"><span data-stu-id="2af0a-130">0</span></span> |<span data-ttu-id="2af0a-131">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-131">1</span></span> |
| <span data-ttu-id="2af0a-132">ReplicaCount</span><span class="sxs-lookup"><span data-stu-id="2af0a-132">ReplicaCount</span></span> |<span data-ttu-id="2af0a-133">0</span><span class="sxs-lookup"><span data-stu-id="2af0a-133">0</span></span> |<span data-ttu-id="2af0a-134">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-134">1</span></span> |<span data-ttu-id="2af0a-135">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-135">1</span></span> |
| <span data-ttu-id="2af0a-136">Licznik</span><span class="sxs-lookup"><span data-stu-id="2af0a-136">Count</span></span> |<span data-ttu-id="2af0a-137">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-137">1</span></span> |<span data-ttu-id="2af0a-138">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-138">1</span></span> |<span data-ttu-id="2af0a-139">1</span><span class="sxs-lookup"><span data-stu-id="2af0a-139">1</span></span> |

<span data-ttu-id="2af0a-140">W przypadku obciążeń podstawowych hello domyślne metryki Podaj zadowalający dystrybucji pracy hello klastra.</span><span class="sxs-lookup"><span data-stu-id="2af0a-140">For basic workloads, hello default metrics provide a decent distribution of work in hello cluster.</span></span> <span data-ttu-id="2af0a-141">W hello poniższy przykład Zobacz, co się stanie po możemy utworzyć dwie usługi i polegać na powitania domyślne metryki dla równoważenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-141">In hello following example, let’s see what happens when we create two services and rely on hello default metrics for balancing.</span></span> <span data-ttu-id="2af0a-142">Hello pierwszej usługi jest usługi stanowej trzy partycji i replik docelowy Ustaw rozmiar trzech.</span><span class="sxs-lookup"><span data-stu-id="2af0a-142">hello first service is a stateful service with three partitions and a target replica set size of three.</span></span> <span data-ttu-id="2af0a-143">Usługa drugi Hello jest usługi bezstanowej z jednej partycji i liczby wystąpień trzy.</span><span class="sxs-lookup"><span data-stu-id="2af0a-143">hello second service is a stateless service with one partition and an instance count of three.</span></span>

<span data-ttu-id="2af0a-144">Oto, możesz uzyskać:</span><span class="sxs-lookup"><span data-stu-id="2af0a-144">Here's what you get:</span></span>

<span data-ttu-id="2af0a-145"><center>
![Układ klastra z domyślne metryki][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="2af0a-145"><center>
![Cluster Layout with Default Metrics][Image1]
</center></span></span>

<span data-ttu-id="2af0a-146">Niektóre toonote rzeczy:</span><span class="sxs-lookup"><span data-stu-id="2af0a-146">Some things toonote:</span></span>
  - <span data-ttu-id="2af0a-147">Repliki podstawowej dla usługi stanowej hello są rozproszone na kilku węzłów</span><span class="sxs-lookup"><span data-stu-id="2af0a-147">Primary replicas for hello stateful service are distributed across several nodes</span></span>
  - <span data-ttu-id="2af0a-148">Repliki dla tej samej partycji są w różnych węzłach hello</span><span class="sxs-lookup"><span data-stu-id="2af0a-148">Replicas for hello same partition are on different nodes</span></span>
  - <span data-ttu-id="2af0a-149">Całkowita liczba Hello kolory podstawowe i pomocnicze bazy danych jest dystrybuowane w hello klastra</span><span class="sxs-lookup"><span data-stu-id="2af0a-149">hello total number of primaries and secondaries is distributed in hello cluster</span></span>
  - <span data-ttu-id="2af0a-150">Całkowita liczba obiektów usługi Hello równomiernie są przydzielane na każdym węźle</span><span class="sxs-lookup"><span data-stu-id="2af0a-150">hello total number of service objects are evenly allocated on each node</span></span>

<span data-ttu-id="2af0a-151">Dobrym!</span><span class="sxs-lookup"><span data-stu-id="2af0a-151">Good!</span></span>

<span data-ttu-id="2af0a-152">Witaj domyślne metryki ponosić działa jako rozpoczęcia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-152">hello default metrics work great as a start.</span></span> <span data-ttu-id="2af0a-153">Jednak hello domyślne metryki tylko prowadzi należy do tej pory.</span><span class="sxs-lookup"><span data-stu-id="2af0a-153">However, hello default metrics will only carry you so far.</span></span> <span data-ttu-id="2af0a-154">Na przykład: co to jest hello prawdopodobieństwo, że partycjonowania hello schemat można pobrać wyników doskonale nawet wykorzystania przez wszystkie partycje?</span><span class="sxs-lookup"><span data-stu-id="2af0a-154">For example: What's hello likelihood that hello partitioning scheme you picked results in perfectly even utilization by all partitions?</span></span> <span data-ttu-id="2af0a-155">Co to jest stosowany hello hello obciążenia dla danej usługi jest stałe wraz z upływem czasu lub nawet po prostu hello sam między wieloma partycjami teraz?</span><span class="sxs-lookup"><span data-stu-id="2af0a-155">What’s hello chance that hello load for a given service is constant over time, or even just hello same across multiple partitions right now?</span></span>

<span data-ttu-id="2af0a-156">Można uruchomić z właśnie hello domyślne metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-156">You could run with just hello default metrics.</span></span> <span data-ttu-id="2af0a-157">Jednak taka zwykle oznacza, że Twoje użycie klastra mniejszą i nierówna bardziej, niż chcesz.</span><span class="sxs-lookup"><span data-stu-id="2af0a-157">However, doing so usually means that your cluster utilization is lower and more uneven than you’d like.</span></span> <span data-ttu-id="2af0a-158">Jest to spowodowane hello domyślne metryki nie adaptacyjną i zakładają, że wszystko, co jest równoważne.</span><span class="sxs-lookup"><span data-stu-id="2af0a-158">This is because hello default metrics aren't adaptive and presume everything is equivalent.</span></span> <span data-ttu-id="2af0a-159">Na przykład podstawowego, który jest zajęty i który nie jest zarówno współtworzenia "1" toohello PrimaryCount metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-159">For example, a Primary that is busy and one that is not both contribute "1" toohello PrimaryCount metric.</span></span> <span data-ttu-id="2af0a-160">W najgorszym przypadku hello przy użyciu tylko hello domyślne metryki może również spowodować overscheduled węzłów, co powoduje problemy z wydajnością.</span><span class="sxs-lookup"><span data-stu-id="2af0a-160">In hello worst case, using only hello default metrics can also result in overscheduled nodes resulting in performance issues.</span></span> <span data-ttu-id="2af0a-161">Jeśli interesuje Cię uzyskanie hello większości poza klastrem i unikanie problemów z wydajnością, należy toouse niestandardowych metryk i raportowania dynamicznego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-161">If you're interested in getting hello most out of your cluster and avoiding performance issues, you need toouse custom metrics and dynamic load reporting.</span></span>

## <a name="custom-metrics"></a><span data-ttu-id="2af0a-162">Metryki niestandardowe</span><span class="sxs-lookup"><span data-stu-id="2af0a-162">Custom metrics</span></span>
<span data-ttu-id="2af0a-163">Metryki są konfigurowane na poszczególnych o nazwie usług wystąpień podczas tworzenia usługi hello.</span><span class="sxs-lookup"><span data-stu-id="2af0a-163">Metrics are configured on a per-named-service-instance basis when you’re creating hello service.</span></span>

<span data-ttu-id="2af0a-164">Niektóre właściwości opisujące go ma wszystkie metryki: nazwę, waga i obciążenia domyślne.</span><span class="sxs-lookup"><span data-stu-id="2af0a-164">Any metric has some properties that describe it: a name, a weight, and a default load.</span></span>

* <span data-ttu-id="2af0a-165">Nazwa metryki: Nazwa hello hello metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-165">Metric Name: hello name of hello metric.</span></span> <span data-ttu-id="2af0a-166">Nazwa metryki Hello jest unikatowym identyfikatorem dla metryki hello w ramach klastra hello z punktu widzenia hello Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="2af0a-166">hello metric name is a unique identifier for hello metric within hello cluster from hello Resource Manager’s perspective.</span></span>
* <span data-ttu-id="2af0a-167">Waga: Waga metryki Określa jak ważne ta metryka jest względna toohello innych metryk dla tej usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-167">Weight: Metric weight defines how important this metric is relative toohello other metrics for this service.</span></span>
* <span data-ttu-id="2af0a-168">Obciążenia domyślne: hello domyślne obciążenia odpowiada inaczej w zależności od tego, czy usługa hello jest bezstanowych i stanowych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-168">Default Load: hello default load is represented differently depending on whether hello service is stateless or stateful.</span></span>
  * <span data-ttu-id="2af0a-169">W przypadku usług bezstanowych wszystkie metryki ma jedną właściwość o nazwie DefaultLoad</span><span class="sxs-lookup"><span data-stu-id="2af0a-169">For stateless services, each metric has a single property named DefaultLoad</span></span>
  * <span data-ttu-id="2af0a-170">Dla stanowych usług można zdefiniować:</span><span class="sxs-lookup"><span data-stu-id="2af0a-170">For stateful services you define:</span></span>
    * <span data-ttu-id="2af0a-171">PrimaryDefaultLoad: pobiera tej usługi hello domyślna ilość ta metryka, w podstawowym</span><span class="sxs-lookup"><span data-stu-id="2af0a-171">PrimaryDefaultLoad: hello default amount of this metric this service consumes when it is a Primary</span></span>
    * <span data-ttu-id="2af0a-172">SecondaryDefaultLoad: pobiera tej usługi hello domyślna ilość ta metryka, czasie pomocniczego</span><span class="sxs-lookup"><span data-stu-id="2af0a-172">SecondaryDefaultLoad: hello default amount of this metric this service consumes when it is a Secondary</span></span>

> [!NOTE]
> <span data-ttu-id="2af0a-173">Jeśli zdefiniujesz metryki niestandardowe i ma domyślne too_also_ metryki hello, musisz too_explicitly_ Dodaj hello domyślne metryki kopii i zdefiniuj wagi i wartości dla nich.</span><span class="sxs-lookup"><span data-stu-id="2af0a-173">If you define custom metrics and you want too_also_ use hello default metrics, you need too_explicitly_ add hello default metrics back and define weights and values for them.</span></span> <span data-ttu-id="2af0a-174">Jest to spowodowane należy zdefiniować relację hello hello domyślne metryki i Twoje metryki niestandardowe.</span><span class="sxs-lookup"><span data-stu-id="2af0a-174">This is because you must define hello relationship between hello default metrics and your custom metrics.</span></span> <span data-ttu-id="2af0a-175">Na przykład może być potrzebne informacje ConnectionCount lub WorkQueueDepth więcej niż podstawowy dystrybucji.</span><span class="sxs-lookup"><span data-stu-id="2af0a-175">For example, maybe you care about ConnectionCount or WorkQueueDepth more than Primary distribution.</span></span> <span data-ttu-id="2af0a-176">Domyślne wagi hello hello PrimaryCount metryka jest wysoki, więc ma tooreduce on tooMedium po dodaniu z innych tooensure metryki one pierwszeństwo.</span><span class="sxs-lookup"><span data-stu-id="2af0a-176">By default hello weight of hello PrimaryCount metric is High, so you want tooreduce it tooMedium when you add your other metrics tooensure they take precedence.</span></span>
>

### <a name="defining-metrics-for-your-service---an-example"></a><span data-ttu-id="2af0a-177">Definiowanie metryki dla usługi — przykład</span><span class="sxs-lookup"><span data-stu-id="2af0a-177">Defining metrics for your service - an example</span></span>
<span data-ttu-id="2af0a-178">Załóżmy, że chcesz hello następującej konfiguracji:</span><span class="sxs-lookup"><span data-stu-id="2af0a-178">Let’s say you want hello following configuration:</span></span>

  - <span data-ttu-id="2af0a-179">Metryka o nazwie "ConnectionCount" raportów usługi</span><span class="sxs-lookup"><span data-stu-id="2af0a-179">Your service reports a metric named "ConnectionCount”</span></span>
  - <span data-ttu-id="2af0a-180">Należy także toouse hello domyślne metryki</span><span class="sxs-lookup"><span data-stu-id="2af0a-180">You also want toouse hello default metrics</span></span> 
  - <span data-ttu-id="2af0a-181">Przycisk niektórych pomiarów i dowiedzieć się, że zwykle podstawową replikę tej usługi zajmuje 20 jednostek "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="2af0a-181">You’ve done some measurements and know that normally a Primary replica of that service takes up 20 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="2af0a-182">Pomocnicze bazy danych użyj 5 jednostek "ConnectionCount"</span><span class="sxs-lookup"><span data-stu-id="2af0a-182">Secondaries use 5 units of "ConnectionCount"</span></span>
  - <span data-ttu-id="2af0a-183">Wiesz, że "ConnectionCount" jest hello Metryka najważniejszych pod względem wydajności hello tej konkretnej usługi zarządzania</span><span class="sxs-lookup"><span data-stu-id="2af0a-183">You know that "ConnectionCount" is hello most important metric in terms of managing hello performance of this particular service</span></span>
  - <span data-ttu-id="2af0a-184">Nadal chcesz zrównoważonym replik podstawowych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-184">You still want Primary replicas balanced.</span></span> <span data-ttu-id="2af0a-185">Równoważenie replik podstawowych zazwyczaj dobrym pomysłem jest bez względu na okoliczności.</span><span class="sxs-lookup"><span data-stu-id="2af0a-185">Balancing primary replicas is generally a good idea no matter what.</span></span> <span data-ttu-id="2af0a-186">Pomaga to zapobiec utracie hello niektóre domeny węzła lub fault z wpływające na większości replik podstawowych wraz z jej.</span><span class="sxs-lookup"><span data-stu-id="2af0a-186">This helps prevent hello loss of some node or fault domain from impacting a majority of primary replicas along with it.</span></span> 
  - <span data-ttu-id="2af0a-187">W przeciwnym razie hello domyślne metryki są poprawnie</span><span class="sxs-lookup"><span data-stu-id="2af0a-187">Otherwise, hello default metrics are fine</span></span>

<span data-ttu-id="2af0a-188">Oto kod hello czy piszesz toocreate usługi za pomocą tej konfiguracji metryki:</span><span class="sxs-lookup"><span data-stu-id="2af0a-188">Here’s hello code that you would write toocreate a service with that metric configuration:</span></span>

<span data-ttu-id="2af0a-189">Kod:</span><span class="sxs-lookup"><span data-stu-id="2af0a-189">Code:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
StatefulServiceLoadMetricDescription connectionMetric = new StatefulServiceLoadMetricDescription();
connectionMetric.Name = "ConnectionCount";
connectionMetric.PrimaryDefaultLoad = 20;
connectionMetric.SecondaryDefaultLoad = 5;
connectionMetric.Weight = ServiceLoadMetricWeight.High;

StatefulServiceLoadMetricDescription primaryCountMetric = new StatefulServiceLoadMetricDescription();
primaryCountMetric.Name = "PrimaryCount";
primaryCountMetric.PrimaryDefaultLoad = 1;
primaryCountMetric.SecondaryDefaultLoad = 0;
primaryCountMetric.Weight = ServiceLoadMetricWeight.Medium;

StatefulServiceLoadMetricDescription replicaCountMetric = new StatefulServiceLoadMetricDescription();
replicaCountMetric.Name = "ReplicaCount";
replicaCountMetric.PrimaryDefaultLoad = 1;
replicaCountMetric.SecondaryDefaultLoad = 1;
replicaCountMetric.Weight = ServiceLoadMetricWeight.Low;

StatefulServiceLoadMetricDescription totalCountMetric = new StatefulServiceLoadMetricDescription();
totalCountMetric.Name = "Count";
totalCountMetric.PrimaryDefaultLoad = 1;
totalCountMetric.SecondaryDefaultLoad = 1;
totalCountMetric.Weight = ServiceLoadMetricWeight.Low;

serviceDescription.Metrics.Add(connectionMetric);
serviceDescription.Metrics.Add(primaryCountMetric);
serviceDescription.Metrics.Add(replicaCountMetric);
serviceDescription.Metrics.Add(totalCountMetric);

await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="2af0a-190">Środowiska PowerShell:</span><span class="sxs-lookup"><span data-stu-id="2af0a-190">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ConnectionCount,High,20,5”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

> [!NOTE]
> <span data-ttu-id="2af0a-191">Witaj powyżej przykłady i hello pozostałej części tego dokumentu opisano zarządzanie metryki na podstawie ciągu o nazwie — usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-191">hello above examples and hello rest of this document describe managing metrics on a per-named-service basis.</span></span> <span data-ttu-id="2af0a-192">Możliwe jest również możliwe toodefine metryki dla usługi w punkcie usług hello _typu_ poziom.</span><span class="sxs-lookup"><span data-stu-id="2af0a-192">It is also possible toodefine metrics for your services at hello service _type_ level.</span></span> <span data-ttu-id="2af0a-193">Jest to osiągnąć, określając je w manifestach Twojej usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-193">This is accomplished by specifying them in your service manifests.</span></span> <span data-ttu-id="2af0a-194">Definiowanie metryki na poziomie typu nie jest zalecane z kilku powodów.</span><span class="sxs-lookup"><span data-stu-id="2af0a-194">Defining type level metrics is not recommended for several reasons.</span></span> <span data-ttu-id="2af0a-195">pierwsze urząd Hello są nazwy metryki często określonego środowiska.</span><span class="sxs-lookup"><span data-stu-id="2af0a-195">hello first reason is that metric names are frequently environment-specific.</span></span> <span data-ttu-id="2af0a-196">Jeżeli nie istnieje ostateczne kontraktu w miejscu, nie może być się, że tego Metryka hello "Rdzeni" w jednym środowisku nie "MiliCores" lub "Rdzeni" w innych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-196">Unless there is a firm contract in place, you cannot be sure that hello metric "Cores" in one environment isn't "MiliCores" or "CoReS" in others.</span></span> <span data-ttu-id="2af0a-197">Jeśli Twoje metryki są zdefiniowane w manifeście należy toocreate nowe manifesty na środowisko.</span><span class="sxs-lookup"><span data-stu-id="2af0a-197">If your metrics are defined in your manifest you need toocreate new manifests per environment.</span></span> <span data-ttu-id="2af0a-198">Prowadzi to zwykle tooa mnożenie różnych manifestów tylko drobne różnice, które mogą spowodować trudności toomanagement.</span><span class="sxs-lookup"><span data-stu-id="2af0a-198">This usually leads tooa proliferation of different manifests with only minor differences, which can lead toomanagement difficulties.</span></span>  
>
> <span data-ttu-id="2af0a-199">Metryka obciążenia często są przypisywane na podstawie poszczególnych o nazwie usług wystąpień.</span><span class="sxs-lookup"><span data-stu-id="2af0a-199">Metric loads are commonly assigned on a per-named-service-instance basis.</span></span> <span data-ttu-id="2af0a-200">Na przykład, załóżmy, że utworzyć jedno wystąpienie powitania dla CustomerA, który plany toouse go obsłużyć rzadziej.</span><span class="sxs-lookup"><span data-stu-id="2af0a-200">For example, let's say you create one instance of hello service for CustomerA who plans toouse it only lightly.</span></span> <span data-ttu-id="2af0a-201">Również Załóżmy, że utworzyć inny dla CustomerB mającego większe obciążenie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-201">Let's also say you create another for CustomerB who has a larger workload.</span></span> <span data-ttu-id="2af0a-202">W takim przypadku będzie prawdopodobnie wskazana będzie domyślna hello tootweak ładuje dla tych usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-202">In this case, you'd probably want tootweak hello default loads for those services.</span></span> <span data-ttu-id="2af0a-203">Jeśli masz metryki i obciążeń zdefiniowany za pomocą manifestów i chcesz toosupport tego scenariusza, wymaga innej aplikacji i typów usług dla każdego klienta.</span><span class="sxs-lookup"><span data-stu-id="2af0a-203">If you have metrics and loads defined via manifests and you want toosupport this scenario, it requires different application and service types for each customer.</span></span> <span data-ttu-id="2af0a-204">wartości Hello zdefiniowanych w czasie tworzenia usługi przesłaniają akcje zdefiniowane w manifeście hello, można użyć tego tooset hello określonych wartości domyślnych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-204">hello values defined at service creation time override those defined in hello manifest, so you could use that tooset hello specific defaults.</span></span> <span data-ttu-id="2af0a-205">Jednak operacją powoduje, że wartości hello zadeklarowany w hello manifestów toonot odpowiada te usługi hello działa z.</span><span class="sxs-lookup"><span data-stu-id="2af0a-205">However, doing that causes hello values declared in hello manifests toonot match those hello service actually runs with.</span></span> <span data-ttu-id="2af0a-206">Może to spowodować tooconfusion.</span><span class="sxs-lookup"><span data-stu-id="2af0a-206">This can lead tooconfusion.</span></span> 
>

<span data-ttu-id="2af0a-207">Dla przypomnienia: Jeśli chcesz toouse hello domyślne metryki, nie należy tootouch hello metryki kolekcji na wszystkich lub czy jakieś szczególne podczas tworzenia usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-207">As a reminder: if you just want toouse hello default metrics, you don’t need tootouch hello metrics collection at all or do anything special when creating your service.</span></span> <span data-ttu-id="2af0a-208">Hello domyślne metryki uzyskać użyć automatycznie, gdy nie zdefiniowano żadnych innych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="2af0a-208">hello default metrics get used automatically when no others are defined.</span></span> 

<span data-ttu-id="2af0a-209">Teraz przejdźmy do każdego z tych ustawień bardziej szczegółowo i omówione hello ma to wpływ na zachowanie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-209">Now, let's go through each of these settings in more detail and talk about hello behavior that it influences.</span></span>

## <a name="load"></a><span data-ttu-id="2af0a-210">Ładowanie</span><span class="sxs-lookup"><span data-stu-id="2af0a-210">Load</span></span>
<span data-ttu-id="2af0a-211">Witaj całego punktu definiowania metryk jest toorepresent niektóre obciążenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-211">hello whole point of defining metrics is toorepresent some load.</span></span> <span data-ttu-id="2af0a-212">*Obciążenia* jest, jaka część danej metryki jest używany przez niektóre wystąpienia usługi lub replikę z danego węzła.</span><span class="sxs-lookup"><span data-stu-id="2af0a-212">*Load* is how much of a given metric is consumed by some service instance or replica on a given node.</span></span> <span data-ttu-id="2af0a-213">Obciążenia można skonfigurować w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-213">Load can be configured at almost any point.</span></span> <span data-ttu-id="2af0a-214">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="2af0a-214">For example:</span></span>

  - <span data-ttu-id="2af0a-215">Obciążenia można zdefiniować podczas tworzenia usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-215">Load can be defined when a service is created.</span></span> <span data-ttu-id="2af0a-216">Ta metoda jest wywoływana _obciążenia domyślne_.</span><span class="sxs-lookup"><span data-stu-id="2af0a-216">This is called _default load_.</span></span>
  - <span data-ttu-id="2af0a-217">metryki informacji Hello, w tym domyślnego ładuje usługi można zaktualizowane po utworzeniu hello usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-217">hello metric information, including default loads, for a service can updated after hello service is created.</span></span> <span data-ttu-id="2af0a-218">Ta metoda jest wywoływana _uaktualnianie usługi_.</span><span class="sxs-lookup"><span data-stu-id="2af0a-218">This is called _updating a service_.</span></span> 
  - <span data-ttu-id="2af0a-219">Witaj obciążenia dla danej partycji można resetowania toohello domyślne wartości dla tej usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-219">hello loads for a given partition can be reset toohello default values for that service.</span></span> <span data-ttu-id="2af0a-220">Ta metoda jest wywoływana _zresetowania obciążenia partycji_.</span><span class="sxs-lookup"><span data-stu-id="2af0a-220">This is called _resetting partition load_.</span></span>
  - <span data-ttu-id="2af0a-221">Obciążenia mogą być zgłaszane na poszczególnych obiektów usługi dynamicznie w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="2af0a-221">Load can be reported on a per service object basis dynamically during runtime.</span></span> <span data-ttu-id="2af0a-222">Ta metoda jest wywoływana _raportowania obciążenia_.</span><span class="sxs-lookup"><span data-stu-id="2af0a-222">This is called _reporting load_.</span></span> 
  
<span data-ttu-id="2af0a-223">Wszystkie te strategii znajdują się w hello sama usługa swojego okresu istnienia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-223">All of these strategies can be used within hello same service over its lifetime.</span></span> 

## <a name="default-load"></a><span data-ttu-id="2af0a-224">Domyślne obciążenia</span><span class="sxs-lookup"><span data-stu-id="2af0a-224">Default load</span></span>
<span data-ttu-id="2af0a-225">*Domyślne obciążenia* jest znacznie metryki hello zużywa każdego obiektu usługi (bezstanowych wystąpienia lub stanowych repliki) tej usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-225">*Default load* is how much of hello metric each service object (stateless instance or stateful replica) of this service consumes.</span></span> <span data-ttu-id="2af0a-226">Hello Menedżera zasobów klastra używa tego numeru obciążenia hello hello obiektu usługi, dopóki nie odbierze inne informacje, takie jak raportu dynamicznego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-226">hello Cluster Resource Manager uses this number for hello load of hello service object until it receives other information, such as a dynamic load report.</span></span> <span data-ttu-id="2af0a-227">W przypadku prostszych usług obciążenie domyślne hello jest definicji statycznych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-227">For simpler services, hello default load is a static definition.</span></span> <span data-ttu-id="2af0a-228">obciążenia domyślne Hello nigdy nie są aktualizowane i jest używany czas ich istnienia hello hello usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-228">hello default load is never updated and is used for hello lifetime of hello service.</span></span> <span data-ttu-id="2af0a-229">Domyślne ładuje Wielkiej działa proste pojemności planowanie scenariuszy, w którym niektórych ilości zasobów dedykowanych toodifferent obciążenia i nie należy zmieniać.</span><span class="sxs-lookup"><span data-stu-id="2af0a-229">Default loads works great for simple capacity planning scenarios where certain amounts of resources are dedicated toodifferent workloads and do not change.</span></span>

> [!NOTE]
> <span data-ttu-id="2af0a-230">Aby uzyskać więcej informacji dotyczących zarządzania pojemności i definiowanie pojemności dla hello węzłów w klastrze, zobacz [w tym artykule](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="2af0a-230">For more information on capacity management and defining capacities for hello nodes in your cluster, please see [this article](service-fabric-cluster-resource-manager-cluster-description.md#capacity).</span></span>
> 

<span data-ttu-id="2af0a-231">Hello Menedżera zasobów klastra umożliwia toospecify usługi stanowej obciążenia różne domyślne kolory podstawowe i pomocnicze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-231">hello Cluster Resource Manager allows stateful services toospecify a different default load for their Primaries and Secondaries.</span></span> <span data-ttu-id="2af0a-232">Usługi bezstanowej można określić tylko jedną wartość, która dotyczy tooall wystąpień.</span><span class="sxs-lookup"><span data-stu-id="2af0a-232">Stateless services can only specify one value that applies tooall instances.</span></span> <span data-ttu-id="2af0a-233">Dla stanowych usług obciążenia domyślne hello replik podstawowe i pomocnicze są zwykle różnych, ponieważ repliki są różnego rodzaju pracy w każdej roli.</span><span class="sxs-lookup"><span data-stu-id="2af0a-233">For stateful services, hello default load for Primary and Secondary replicas are typically different since replicas do different kinds of work in each role.</span></span> <span data-ttu-id="2af0a-234">Na przykład kolory podstawowe zwykle służą odczytów i zapisów i obsługę większości obciążeń obliczeniowych hello, gdy nie chcesz pomocnicze bazy danych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-234">For example, Primaries usually serve both reads and writes, and handle most of hello computational burden, while secondaries do not.</span></span> <span data-ttu-id="2af0a-235">Zazwyczaj hello domyślne obciążenia dla repliki podstawowej jest wyższa niż hello domyślne obciążenia dla replik pomocniczych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-235">Usually hello default load for a primary replica is higher than hello default load for secondary replicas.</span></span> <span data-ttu-id="2af0a-236">liczb rzeczywistych Hello powinien zależeć odpowiednie wartości.</span><span class="sxs-lookup"><span data-stu-id="2af0a-236">hello real numbers should depend on your own measurements.</span></span>

## <a name="dynamic-load"></a><span data-ttu-id="2af0a-237">Obciążenie dynamicznego</span><span class="sxs-lookup"><span data-stu-id="2af0a-237">Dynamic load</span></span>
<span data-ttu-id="2af0a-238">Załóżmy, że działała usługi przez pewien czas.</span><span class="sxs-lookup"><span data-stu-id="2af0a-238">Let’s say that you’ve been running your service for a while.</span></span> <span data-ttu-id="2af0a-239">Niektóre monitorowania z zostały zauważyć, że:</span><span class="sxs-lookup"><span data-stu-id="2af0a-239">With some monitoring, you’ve noticed that:</span></span>

1. <span data-ttu-id="2af0a-240">Niektóre partycje lub wystąpienia danej usługi zużywać więcej zasobów niż inne</span><span class="sxs-lookup"><span data-stu-id="2af0a-240">Some partitions or instances of a given service consume more resources than others</span></span>
2. <span data-ttu-id="2af0a-241">Niektóre usługi mają obciążenia, która różni się w czasie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-241">Some services have load that varies over time.</span></span>

<span data-ttu-id="2af0a-242">Istnieje wiele rzeczy, które mogły spowodować tego rodzaju wahania obciążenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-242">There's lots of things that could cause these types of load fluctuations.</span></span> <span data-ttu-id="2af0a-243">Na przykład różnych usług lub partycje są skojarzone z różnych klientów z innymi wymaganiami.</span><span class="sxs-lookup"><span data-stu-id="2af0a-243">For example, different services or partitions are associated with different customers with different requirements.</span></span> <span data-ttu-id="2af0a-244">Obciążenia można również zmienić, ponieważ hello ilość pracy hello usługi zmienia się w hello porach dnia hello.</span><span class="sxs-lookup"><span data-stu-id="2af0a-244">Load could also change because hello amount of work hello service does varies over hello course of hello day.</span></span> <span data-ttu-id="2af0a-245">Niezależnie od przyczyny hello jest zwykle nie jeden numer używanego dla domyślnego.</span><span class="sxs-lookup"><span data-stu-id="2af0a-245">Regardless of hello reason, there’s usually no single number that you can use for default.</span></span> <span data-ttu-id="2af0a-246">Jest to szczególnie istotne, kiedy ma tooget hello większość wykorzystania hello klastra.</span><span class="sxs-lookup"><span data-stu-id="2af0a-246">This is especially true if you want tooget hello most utilization out of hello cluster.</span></span> <span data-ttu-id="2af0a-247">Wartość, wybrać domyślne obciążenia jest niewłaściwy niektóre hello czasu.</span><span class="sxs-lookup"><span data-stu-id="2af0a-247">Any value you pick for default load is wrong some of hello time.</span></span> <span data-ttu-id="2af0a-248">Nieprawidłowe domyślne ładuje spowodować hello Menedżera zasobów klastra za pośrednictwem lub w obszarze alokacji zasobów.</span><span class="sxs-lookup"><span data-stu-id="2af0a-248">Incorrect default loads result in hello Cluster Resource Manager either over or under allocating resources.</span></span> <span data-ttu-id="2af0a-249">W związku z tym masz węzłów, które są powyżej lub poniżej wykorzystywane nawet hello Menedżera zasobów klastra sądzi, że klaster hello jest rozmieszczana.</span><span class="sxs-lookup"><span data-stu-id="2af0a-249">As a result, you have nodes that are over or under utilized even though hello Cluster Resource Manager thinks hello cluster is balanced.</span></span> <span data-ttu-id="2af0a-250">Domyślne obciążenia są nadal dobrej, ponieważ zapewniają niektóre informacje do umieszczenia początkowej, ale nie są one zakończenie wątku dla obciążeń prawdziwe.</span><span class="sxs-lookup"><span data-stu-id="2af0a-250">Default loads are still good since they provide some information for initial placement, but they're not a complete story for real workloads.</span></span> <span data-ttu-id="2af0a-251">Przechwytywanie tooaccurately zmiany wymagań dotyczących zasobów, hello Menedżera zasobów klastra umożliwia każdego tooupdate obiektu usługi własną obciążenia w czasie wykonywania.</span><span class="sxs-lookup"><span data-stu-id="2af0a-251">tooaccurately capture changing resource requirements, hello Cluster Resource Manager allows each service object tooupdate its own load during runtime.</span></span> <span data-ttu-id="2af0a-252">Jest to obciążenie dynamicznego raportowania.</span><span class="sxs-lookup"><span data-stu-id="2af0a-252">This is called dynamic load reporting.</span></span>

<span data-ttu-id="2af0a-253">Raporty Obciążenie dynamicznego Zezwalaj tooadjust repliki lub wystąpień ich alokacji/zgłosił obciążenia metryk przez ich istnienia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-253">Dynamic load reports allow replicas or instances tooadjust their allocation/reported load of metrics over their lifetime.</span></span> <span data-ttu-id="2af0a-254">Repliki usługi lub wystąpienia, który był niskich i bezczynny będzie zazwyczaj raport, aby korzystał z niskim ilości danej metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-254">A service replica or instance that was cold and not doing any work would usually report that it was using low amounts of a given metric.</span></span> <span data-ttu-id="2af0a-255">Replika zajęta lub wystąpienie rozpoczną przesyłanie raportów o tym, że używają więcej.</span><span class="sxs-lookup"><span data-stu-id="2af0a-255">A busy replica or instance would report that they are using more.</span></span>

<span data-ttu-id="2af0a-256">Raportowania obciążenia dla repliki lub wystąpienie pozwala hello tooreorganize Menedżera zasobów klastra hello pojedynczej usługi obiektów hello klastra.</span><span class="sxs-lookup"><span data-stu-id="2af0a-256">Reporting load per replica or instance allows hello Cluster Resource Manager tooreorganize hello individual service objects in hello cluster.</span></span> <span data-ttu-id="2af0a-257">Reorganizacja usług hello pomaga, upewnij się, że otrzymują hello zasoby, które wymagają.</span><span class="sxs-lookup"><span data-stu-id="2af0a-257">Reorganizing hello services helps ensure that they get hello resources they require.</span></span> <span data-ttu-id="2af0a-258">Zajęty usługi skutecznie Uzyskaj zbyt "odzyskać" zasoby od innych repliki lub wystąpienia, które są aktualnie ten mniej pracy lub niskie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-258">Busy services effectively get too"reclaim" resources from other replicas or instances that are currently cold or doing less work.</span></span>

<span data-ttu-id="2af0a-259">W ramach niezawodnej usługi hello kodu tooreport obciążenia dynamicznie wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="2af0a-259">Within Reliable Services, hello code tooreport load dynamically looks like this:</span></span>

<span data-ttu-id="2af0a-260">Kod:</span><span class="sxs-lookup"><span data-stu-id="2af0a-260">Code:</span></span>

```csharp
this.Partition.ReportLoad(new List<LoadMetric> { new LoadMetric("CurrentConnectionCount", 1234), new LoadMetric("metric1", 42) });
```

<span data-ttu-id="2af0a-261">Usługa może raportować na dowolnym metryki hello zdefiniowane w czasie tworzenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-261">A service can report on any of hello metrics defined for it at creation time.</span></span> <span data-ttu-id="2af0a-262">Jeśli usługa raporty obciążenia dla metryki, który nie jest skonfigurowany toouse, sieci szkieletowej usług ignoruje tego raportu.</span><span class="sxs-lookup"><span data-stu-id="2af0a-262">If a service reports load for a metric that it is not configured toouse, Service Fabric ignores that report.</span></span> <span data-ttu-id="2af0a-263">Jeśli istnieją inne metryki zgłoszone w hello sam czas, które są prawidłowe, te raporty są akceptowane.</span><span class="sxs-lookup"><span data-stu-id="2af0a-263">If there are other metrics reported at hello same time that are valid, those reports are accepted.</span></span> <span data-ttu-id="2af0a-264">Kod usługi można mierzyć i raportu hello wszystkie metryki wiadomo, jak i operatory można określić hello metryki konfiguracji toouse bez konieczności toochange hello usługi kodu.</span><span class="sxs-lookup"><span data-stu-id="2af0a-264">Service code can measure and report all hello metrics it knows how to, and operators can specify hello metric configuration toouse without having toochange hello service code.</span></span> 

### <a name="updating-a-services-metric-configuration"></a><span data-ttu-id="2af0a-265">Trwa aktualizowanie konfiguracji metryki usługi</span><span class="sxs-lookup"><span data-stu-id="2af0a-265">Updating a service's metric configuration</span></span>
<span data-ttu-id="2af0a-266">listy Hello metryki skojarzonych z usługą hello i właściwości hello tych metryk może być aktualizowany dynamicznie, gdy usługa hello jest na żywo.</span><span class="sxs-lookup"><span data-stu-id="2af0a-266">hello list of metrics associated with hello service, and hello properties of those metrics can be updated dynamically while hello service is live.</span></span> <span data-ttu-id="2af0a-267">Dzięki temu eksperymenty i elastyczność.</span><span class="sxs-lookup"><span data-stu-id="2af0a-267">This allows for experimentation and flexibility.</span></span> <span data-ttu-id="2af0a-268">Przykłady gdy jest to przydatne są:</span><span class="sxs-lookup"><span data-stu-id="2af0a-268">Some examples of when this is useful are:</span></span>

  - <span data-ttu-id="2af0a-269">wyłączanie Metryka z raportem buggy określonej usługi</span><span class="sxs-lookup"><span data-stu-id="2af0a-269">disabling a metric with a buggy report for a particular service</span></span>
  - <span data-ttu-id="2af0a-270">ponowne konfigurowanie hello wagi metryki na podstawie żądanego zachowania</span><span class="sxs-lookup"><span data-stu-id="2af0a-270">reconfiguring hello weights of metrics based on desired behavior</span></span>
  - <span data-ttu-id="2af0a-271">Włączanie nowej Metryka tylko wtedy, gdy kod hello został już wdrożony i zweryfikować za pośrednictwem innych mechanizmów</span><span class="sxs-lookup"><span data-stu-id="2af0a-271">enabling a new metric only after hello code has already been deployed and validated via other mechanisms</span></span>
  - <span data-ttu-id="2af0a-272">Zmiana hello domyślne obciążenia dla usługi na podstawie obserwowanych zachowania i zużycia</span><span class="sxs-lookup"><span data-stu-id="2af0a-272">changing hello default load for a service based on observed behavior and consumption</span></span>

<span data-ttu-id="2af0a-273">Witaj głównego interfejsy API do zmiany konfiguracji metryki są `FabricClient.ServiceManagementClient.UpdateServiceAsync` w języku C# i `Update-ServiceFabricService` w programie PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2af0a-273">hello main APIs for changing metric configuration are `FabricClient.ServiceManagementClient.UpdateServiceAsync` in C# and `Update-ServiceFabricService` in PowerShell.</span></span> <span data-ttu-id="2af0a-274">Niezależnie od informacje z poniższych interfejsów API zastępuje hello istniejących informacji metryki dla usługi hello natychmiast.</span><span class="sxs-lookup"><span data-stu-id="2af0a-274">Whatever information you specify with these APIs replaces hello existing metric information for hello service immediately.</span></span> 

## <a name="mixing-default-load-values-and-dynamic-load-reports"></a><span data-ttu-id="2af0a-275">Mieszanie domyślne wartości obciążenia i raportów obciążenia dynamiczne</span><span class="sxs-lookup"><span data-stu-id="2af0a-275">Mixing default load values and dynamic load reports</span></span>
<span data-ttu-id="2af0a-276">Domyślne obciążenia i dynamiczna obciążenia mogą być używane dla hello tę samą usługę.</span><span class="sxs-lookup"><span data-stu-id="2af0a-276">Default load and dynamic loads can be used for hello same service.</span></span> <span data-ttu-id="2af0a-277">Gdy usługa korzysta zarówno obciążenia domyślne i raportów obciążenia dynamicznego, obciążenia domyślna służy jako szacunkową dopóki wyświetlani dynamicznych raportów.</span><span class="sxs-lookup"><span data-stu-id="2af0a-277">When a service utilizes both default load and dynamic load reports, default load serves as an estimate until dynamic reports show up.</span></span> <span data-ttu-id="2af0a-278">Domyślne obciążenia jest prawidłowa, ponieważ umożliwia hello Menedżera zasobów klastra coś toowork z.</span><span class="sxs-lookup"><span data-stu-id="2af0a-278">Default load is good because it gives hello Cluster Resource Manager something toowork with.</span></span> <span data-ttu-id="2af0a-279">obciążenia domyślne Hello umożliwia hello tooplace Menedżera zasobów klastra obiektów usługi hello w lokalizacjach dobrej podczas ich tworzenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-279">hello default load allows hello Cluster Resource Manager tooplace hello service objects in good locations when they are created.</span></span> <span data-ttu-id="2af0a-280">Jeśli podano żadnych informacji obciążenia domyślne, umieszczania usług jest skutecznie losowych.</span><span class="sxs-lookup"><span data-stu-id="2af0a-280">If no default load information is provided, placement of services is effectively random.</span></span> <span data-ttu-id="2af0a-281">Nadejściu raportów obciążenia później hello początkowej umieszczania losowe często jest nieprawidłowy i hello Menedżera zasobów klastra ma toomove usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-281">When load reports arrive later hello initial random placement is often wrong and hello Cluster Resource Manager has toomove services.</span></span>

<span data-ttu-id="2af0a-282">Teraz pobrać naszych poprzedni przykład i zobacz, co się stanie po dodamy niektóre metryki niestandardowe i raportowania dynamicznego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="2af0a-282">Let’s take our previous example and see what happens when we add some custom metrics and dynamic load reporting.</span></span> <span data-ttu-id="2af0a-283">W tym przykładzie używamy "MemoryInMb" jako przykład metryka.</span><span class="sxs-lookup"><span data-stu-id="2af0a-283">In this example, we use “MemoryInMb” as an example metric.</span></span>

> [!NOTE]
> <span data-ttu-id="2af0a-284">Pamięć jest jednym z hello systemu metryki sieci szkieletowej usług można [regulują zasobów](service-fabric-resource-governance.md), i raportowania samodzielnie jest zazwyczaj trudne.</span><span class="sxs-lookup"><span data-stu-id="2af0a-284">Memory is one of hello system metrics that Service Fabric can [resource govern](service-fabric-resource-governance.md), and reporting it yourself is typically difficult.</span></span> <span data-ttu-id="2af0a-285">Nie faktycznie Oczekujemy Cię tooreport na zużycie pamięci; Pamięć jest używana jako toolearning pomocy o możliwości hello hello Menedżera zasobów klastra.</span><span class="sxs-lookup"><span data-stu-id="2af0a-285">We don't actually expect you tooreport on Memory consumption; Memory is used here as an aid toolearning about hello capabilities of hello Cluster Resource Manager.</span></span>
>

<span data-ttu-id="2af0a-286">Załóżmy zakładają, możemy początkowo utworzony usługi stanowej hello ze hello następujące polecenie:</span><span class="sxs-lookup"><span data-stu-id="2af0a-286">Let’s presume that we initially created hello stateful service with hello following command:</span></span>

<span data-ttu-id="2af0a-287">Środowiska PowerShell:</span><span class="sxs-lookup"><span data-stu-id="2af0a-287">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("MemoryInMb,High,21,11”,"PrimaryCount,Medium,1,0”,"ReplicaCount,Low,1,1”,"Count,Low,1,1”)
```

<span data-ttu-id="2af0a-288">Dla przypomnienia ta składnia jest ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span><span class="sxs-lookup"><span data-stu-id="2af0a-288">As a reminder, this syntax is ("MetricName, MetricWeight, PrimaryDefaultLoad, SecondaryDefaultLoad").</span></span>

<span data-ttu-id="2af0a-289">Zobaczmy, jakie jeden układ możliwe klastra może wyglądać jak:</span><span class="sxs-lookup"><span data-stu-id="2af0a-289">Let's see what one possible cluster layout could look like:</span></span>

<span data-ttu-id="2af0a-290"><center>
![Klaster zrównoważony z domyślnych i niestandardowych metryk][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="2af0a-290"><center>
![Cluster Balanced with both Default and Custom metrics][Image2]
</center></span></span>

<span data-ttu-id="2af0a-291">Kilka rzeczy, które są warto zauważyć:</span><span class="sxs-lookup"><span data-stu-id="2af0a-291">Some things that are worth noting:</span></span>

* <span data-ttu-id="2af0a-292">Każdej repliki pomocniczej w partycji może mieć własne obciążenia</span><span class="sxs-lookup"><span data-stu-id="2af0a-292">Secondary replicas within a partition can each have their own load</span></span>
* <span data-ttu-id="2af0a-293">Ogólne metryki hello Szukaj zrównoważonym.</span><span class="sxs-lookup"><span data-stu-id="2af0a-293">Overall hello metrics look balanced.</span></span> <span data-ttu-id="2af0a-294">Pamięci, hello proporcje hello maksymalna i minimalna obciążenia jest 1,75 (hello węzła z hello większości obciążenia jest N3, hello jest najmniej N2 i 28/16 = 1,75).</span><span class="sxs-lookup"><span data-stu-id="2af0a-294">For Memory, hello ratio between hello maximum and minimum load is 1.75 (hello node with hello most load is N3, hello least is N2, and 28/16 = 1.75).</span></span>

<span data-ttu-id="2af0a-295">Istnieje kilka kwestii, które nadal potrzebujemy tooexplain:</span><span class="sxs-lookup"><span data-stu-id="2af0a-295">There are some things that we still need tooexplain:</span></span>

* <span data-ttu-id="2af0a-296">Co to ustalić, czy stosunek 1,75 było uzasadnione?</span><span class="sxs-lookup"><span data-stu-id="2af0a-296">What determined whether a ratio of 1.75 was reasonable or not?</span></span> <span data-ttu-id="2af0a-297">Jak hello Menedżera zasobów klastra sprawdzić czy jest wystarczająca, czy istnieje więcej toodo pracy?</span><span class="sxs-lookup"><span data-stu-id="2af0a-297">How does hello Cluster Resource Manager know if that’s good enough or if there is more work toodo?</span></span>
* <span data-ttu-id="2af0a-298">Gdy równoważenia stanie?</span><span class="sxs-lookup"><span data-stu-id="2af0a-298">When does balancing happen?</span></span>
* <span data-ttu-id="2af0a-299">Co oznacza że pamięci zostało ważona "High"?</span><span class="sxs-lookup"><span data-stu-id="2af0a-299">What does it mean that Memory was weighted “High”?</span></span>

## <a name="metric-weights"></a><span data-ttu-id="2af0a-300">Metryki wagi</span><span class="sxs-lookup"><span data-stu-id="2af0a-300">Metric weights</span></span>
<span data-ttu-id="2af0a-301">Śledzenie hello same metryki w różnych usługach jest ważna.</span><span class="sxs-lookup"><span data-stu-id="2af0a-301">Tracking hello same metrics across different services is important.</span></span> <span data-ttu-id="2af0a-302">Czy widoku globalnego jest co pozwalają hello zużycie tootrack Menedżera zasobów klastra w klastrze hello równoważenie zużycie na węzłach i upewnij się, że węzły nie przekazywane pojemności.</span><span class="sxs-lookup"><span data-stu-id="2af0a-302">That global view is what allows hello Cluster Resource Manager tootrack consumption in hello cluster, balance consumption across nodes, and ensure that nodes don’t go over capacity.</span></span> <span data-ttu-id="2af0a-303">Jednak usługi mogą mieć różne widoki jako toohello znaczenie hello tę samą metrykę.</span><span class="sxs-lookup"><span data-stu-id="2af0a-303">However, services may have different views as toohello importance of hello same metric.</span></span> <span data-ttu-id="2af0a-304">Ponadto w klastrze z wieloma metryki i wiele usług doskonale zrównoważonym rozwiązania może nie istnieć dla wszystkich metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-304">Also, in a cluster with many metrics and lots of services, perfectly balanced solutions may not exist for all metrics.</span></span> <span data-ttu-id="2af0a-305">Jak hello Menedżera zasobów klastra powinna obsługiwać tych sytuacji?</span><span class="sxs-lookup"><span data-stu-id="2af0a-305">How should hello Cluster Resource Manager handle these situations?</span></span>

<span data-ttu-id="2af0a-306">Metryki wag Zezwalaj hello toodecide Menedżera zasobów klastra, jak toobalance hello klastra po doskonałe odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-306">Metric weights allow hello Cluster Resource Manager toodecide how toobalance hello cluster when there’s no perfect answer.</span></span> <span data-ttu-id="2af0a-307">Metryki wag również umożliwić hello toobalance Menedżera zasobów klastra określonych usług inaczej.</span><span class="sxs-lookup"><span data-stu-id="2af0a-307">Metric weights also allow hello Cluster Resource Manager toobalance specific services differently.</span></span> <span data-ttu-id="2af0a-308">Metryki mogą mieć czterech wagi różnych poziomów: Zero, niski, średni i wysoki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-308">Metrics can have four different weight levels: Zero, Low, Medium, and High.</span></span> <span data-ttu-id="2af0a-309">Metryka o wadze Zero wspiera nic podczas określania, czy elementy są zrównoważonym lub nie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-309">A metric with a weight of Zero contributes nothing when considering whether things are balanced or not.</span></span> <span data-ttu-id="2af0a-310">Jednak jej obciążenia nadal wpływ toocapacity zarządzania.</span><span class="sxs-lookup"><span data-stu-id="2af0a-310">However, its load does still contribute toocapacity management.</span></span> <span data-ttu-id="2af0a-311">Metryki Zero wagę są nadal przydatne i są często używane jako część zachowanie usługi i monitorowania wydajności.</span><span class="sxs-lookup"><span data-stu-id="2af0a-311">Metrics with Zero weight are still useful and are frequently used as a part of service behavior and performance monitoring.</span></span> <span data-ttu-id="2af0a-312">[W tym artykule](service-fabric-diagnostics-event-generation-infra.md) zamieszczono więcej informacji dotyczących użycia hello metryk do monitorowania i diagnostyki usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-312">[This article](service-fabric-diagnostics-event-generation-infra.md) provides more information on hello use of metrics for monitoring and diagnostics of your services.</span></span> 

<span data-ttu-id="2af0a-313">Witaj rzeczywistego wpływ różne metryki obciążenia w klastrze hello jest tym hello Menedżera zasobów klastra generuje różnych rozwiązań.</span><span class="sxs-lookup"><span data-stu-id="2af0a-313">hello real impact of different metric weights in hello cluster is that hello Cluster Resource Manager generates different solutions.</span></span> <span data-ttu-id="2af0a-314">Wag metryki Poinformuj hello Menedżera zasobów klastra, czy niektóre metryki są ważniejsze od innych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="2af0a-314">Metric weights tell hello Cluster Resource Manager that certain metrics are more important than others.</span></span> <span data-ttu-id="2af0a-315">Jeśli nie istnieje żadne hello doskonałe rozwiązanie Menedżera zasobów klastra można preferowane rozwiązania, które saldo hello wyższej ważoną metryki lepsze.</span><span class="sxs-lookup"><span data-stu-id="2af0a-315">When there's no perfect solution hello Cluster Resource Manager can prefer solutions which balance hello higher weighted metrics better.</span></span> <span data-ttu-id="2af0a-316">Jeśli usługa sądzi określonej metryki jest bez znaczenia, może znajdzie ich używania tego metryki imbalanced.</span><span class="sxs-lookup"><span data-stu-id="2af0a-316">If a service thinks a particular metric is unimportant, it may find their use of that metric imbalanced.</span></span> <span data-ttu-id="2af0a-317">Dzięki temu innego tooget usługi nawet dystrybucji niektóre metryki, która jest ważna tooit.</span><span class="sxs-lookup"><span data-stu-id="2af0a-317">This allows another service tooget an even distribution of some metric that is important tooit.</span></span>

<span data-ttu-id="2af0a-318">Oto przykład niektórych raportów obciążenia i metrykę, jak różne przeprowadzi wyniki w różnych alokacji w hello klastra.</span><span class="sxs-lookup"><span data-stu-id="2af0a-318">Let’s look at an example of some load reports and how different metric weights results in different allocations in hello cluster.</span></span> <span data-ttu-id="2af0a-319">W tym przykładzie przedstawiono, że przełączenie hello względną wagę metryki hello powoduje hello toocreate Menedżera zasobów klastra uzgodnienia różnych usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-319">In this example, we see that switching hello relative weight of hello metrics causes hello Cluster Resource Manager toocreate different arrangements of services.</span></span>

<span data-ttu-id="2af0a-320"><center>
![Przykład waga metryki i jak wpływa na rozwiązań do równoważenia][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="2af0a-320"><center>
![Metric Weight Example and Its Impact on Balancing Solutions][Image3]
</center></span></span>

<span data-ttu-id="2af0a-321">W tym przykładzie istnieją cztery różne usługi, wszystkie wartości różnych raportowania dla dwóch różnych metryki MetricA i MetricB.</span><span class="sxs-lookup"><span data-stu-id="2af0a-321">In this example, there are four different services, all reporting different values for two different metrics, MetricA and MetricB.</span></span> <span data-ttu-id="2af0a-322">W przypadku jednego wszystkich usług hello zdefiniuj MetricA jest jednym z najważniejszych hello (wagi = wysoki) i MetricB jako nieistotnych (wagi = niski).</span><span class="sxs-lookup"><span data-stu-id="2af0a-322">In one case, all hello services define MetricA is hello most important one (Weight = High) and MetricB as unimportant (Weight = Low).</span></span> <span data-ttu-id="2af0a-323">W związku z tym widzimy się, że ten hello Menedżera zasobów klastra umieszcza hello usługi tak, aby lepiej jest zrównoważonym niż MetricB MetricA.</span><span class="sxs-lookup"><span data-stu-id="2af0a-323">As a result, we see that hello Cluster Resource Manager places hello services so that MetricA is better balanced than MetricB.</span></span> <span data-ttu-id="2af0a-324">"Lepiej zrównoważonym" oznacza, że MetricA ma mniejszy ma odchylenie standardowe niższe niż MetricB.</span><span class="sxs-lookup"><span data-stu-id="2af0a-324">"Better balanced" means that MetricA has a lower has a lower standard deviation than MetricB.</span></span> <span data-ttu-id="2af0a-325">W drugim przypadku hello możemy wycofać hello wag metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-325">In hello second case, we reverse hello metric weights.</span></span> <span data-ttu-id="2af0a-326">W związku z tym hello Menedżera zasobów klastra zamienia usług A i B toocome się z alokacją, gdzie MetricB lepiej jest zrównoważonym niż MetricA.</span><span class="sxs-lookup"><span data-stu-id="2af0a-326">As a result, hello Cluster Resource Manager swaps services A and B toocome up with an allocation where MetricB is better balanced than MetricA.</span></span>

> [!NOTE]
> <span data-ttu-id="2af0a-327">Metryki wag określają, jak powinna saldo hello Menedżera zasobów klastra, ale nie podczas równoważenia powinno się zdarzyć.</span><span class="sxs-lookup"><span data-stu-id="2af0a-327">Metric weights determine how hello Cluster Resource Manager should balance, but not when balancing should happen.</span></span> <span data-ttu-id="2af0a-328">Aby uzyskać więcej informacji na temat funkcji równoważenia, zapoznaj się z [w tym artykule](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-328">For more information on balancing, check out [this article](service-fabric-cluster-resource-manager-balancing.md)</span></span>
>

### <a name="global-metric-weights"></a><span data-ttu-id="2af0a-329">Globalne wag metryki</span><span class="sxs-lookup"><span data-stu-id="2af0a-329">Global metric weights</span></span>
<span data-ttu-id="2af0a-330">Załóżmy, że ServiceA definiuje MetricA jako wagi wysokiej i ServiceB ustawia wagi hello MetricA tooLow lub Zero.</span><span class="sxs-lookup"><span data-stu-id="2af0a-330">Let's say ServiceA defines MetricA as weight High, and ServiceB sets hello weight for MetricA tooLow or Zero.</span></span> <span data-ttu-id="2af0a-331">Co to jest hello wagi rzeczywiste kończy się używany?</span><span class="sxs-lookup"><span data-stu-id="2af0a-331">What’s hello actual weight that ends up getting used?</span></span>

<span data-ttu-id="2af0a-332">Istnieje wiele wagi, śledzonych dla każdego metryki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-332">There are multiple weights that are tracked for every metric.</span></span> <span data-ttu-id="2af0a-333">Waga pierwszy Hello jest hello zdefiniowanych dla metryki powitania po utworzeniu hello usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-333">hello first weight is hello one defined for hello metric when hello service is created.</span></span> <span data-ttu-id="2af0a-334">Witaj innych waga jest globalne wagi, która jest obliczana automatycznie.</span><span class="sxs-lookup"><span data-stu-id="2af0a-334">hello other weight is a global weight, which is computed automatically.</span></span> <span data-ttu-id="2af0a-335">podczas oceniania rozwiązania, Hello Menedżera zasobów klastra używa oba te wagi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-335">hello Cluster Resource Manager uses both these weights when scoring solutions.</span></span> <span data-ttu-id="2af0a-336">Biorąc pod uwagę zarówno wag jest ważne.</span><span class="sxs-lookup"><span data-stu-id="2af0a-336">Taking both weights into account is important.</span></span> <span data-ttu-id="2af0a-337">Dzięki temu hello toobalance Menedżera zasobów klastra każdej usługi tooits zgodnie z właścicielem priorytetów i upewnij się również klastra hello, jako całość jest poprawnie przydzielone.</span><span class="sxs-lookup"><span data-stu-id="2af0a-337">This allows hello Cluster Resource Manager toobalance each service according tooits own priorities, and also ensure that hello cluster as a whole is allocated correctly.</span></span>

<span data-ttu-id="2af0a-338">Co się stanie, jeśli hello Menedżera zasobów klastra nie zależy Ci na zachowaniu saldo zarówno globalne i lokalne?</span><span class="sxs-lookup"><span data-stu-id="2af0a-338">What would happen if hello Cluster Resource Manager didn’t care about both global and local balance?</span></span> <span data-ttu-id="2af0a-339">Jest również łatwe tooconstruct rozwiązania, który globalnie równoważy, ale co spowodować równowadze zasobów niska dla poszczególnych usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-339">Well, it’s easy tooconstruct solutions that are globally balanced, but which result in poor resource balance for individual services.</span></span> <span data-ttu-id="2af0a-340">Hello poniższy przykład załóżmy przyjrzeć się skonfigurowano tylko hello domyślne metryki usługi i zobacz, co się dzieje, gdy tylko globalne saldo jest uznawany za:</span><span class="sxs-lookup"><span data-stu-id="2af0a-340">In hello following example, let’s look at a service configured with just hello default metrics, and see what happens when only global balance is considered:</span></span>

<span data-ttu-id="2af0a-341"><center>
![Witaj wpływu globalnego rozwiązania tylko][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="2af0a-341"><center>
![hello Impact of a Global Only Solution][Image4]
</center></span></span>

<span data-ttu-id="2af0a-342">Hello top przykład oparte tylko na globalnego równoważenia w rzeczywistości jest rozmieszczana hello klastra jako całość.</span><span class="sxs-lookup"><span data-stu-id="2af0a-342">In hello top example based only on global balance, hello cluster as a whole is indeed balanced.</span></span> <span data-ttu-id="2af0a-343">Witaj sama liczba kolory podstawowe i hello takie same na wszystkich węzłach jest liczba całkowita replik.</span><span class="sxs-lookup"><span data-stu-id="2af0a-343">All nodes have hello same count of primaries and hello same number total replicas.</span></span> <span data-ttu-id="2af0a-344">Jednak jeśli przyjrzymy się hello rzeczywisty wpływ tej alokacji nie jest tak dobre: hello utraty dowolnego węzła ma wpływ określonego obciążenia nieproporcjonalnie, ponieważ zajmuje całe jego kolory podstawowe.</span><span class="sxs-lookup"><span data-stu-id="2af0a-344">However, if you look at hello actual impact of this allocation it’s not so good: hello loss of any node impacts a particular workload disproportionately, because it takes out all of its primaries.</span></span> <span data-ttu-id="2af0a-345">Na przykład jeśli pierwszy węzeł hello nie powiedzie się hello kolory trzy podstawowe dla hello trzech różnych partycji hello koło usługi wszystkie zostałyby utracone.</span><span class="sxs-lookup"><span data-stu-id="2af0a-345">For example, if hello first node fails hello three primaries for hello three different partitions of hello Circle service would all be lost.</span></span> <span data-ttu-id="2af0a-346">Z drugiej strony hello trójkąt i sześciokąt usług mają ich utratę repliki partycji.</span><span class="sxs-lookup"><span data-stu-id="2af0a-346">Conversely, hello Triangle and Hexagon services have their partitions lose a replica.</span></span> <span data-ttu-id="2af0a-347">Powoduje to nie przerw w działaniu, oprócz posiadania hello toorecover dół repliki.</span><span class="sxs-lookup"><span data-stu-id="2af0a-347">This causes no disruption, other than having toorecover hello down replica.</span></span>

<span data-ttu-id="2af0a-348">W przykładzie dolnej hello hello Menedżera zasobów klastra został rozesłany replik hello oparte na obu hello saldo globalnym i dla usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-348">In hello bottom example, hello Cluster Resource Manager has distributed hello replicas based on both hello global and per-service balance.</span></span> <span data-ttu-id="2af0a-349">Podczas obliczania oceny hello hello rozwiązania daje większość hello wagi toohello globalne rozwiązanie i usług tooindividual części (można konfigurować).</span><span class="sxs-lookup"><span data-stu-id="2af0a-349">When calculating hello score of hello solution it gives most of hello weight toohello global solution, and a (configurable) portion tooindividual services.</span></span> <span data-ttu-id="2af0a-350">Globalne saldo metryka jest obliczany na podstawie hello średnią hello ważonych metryki z każdej usługi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-350">Global balance for a metric is calculated based on hello average of hello metric weights from each service.</span></span> <span data-ttu-id="2af0a-351">Każda usługa jest rozmieszczana zgodnie z tooits własnych zdefiniowanych metryki wagi.</span><span class="sxs-lookup"><span data-stu-id="2af0a-351">Each service is balanced according tooits own defined metric weights.</span></span> <span data-ttu-id="2af0a-352">Dzięki temu równoważy hello usług między sobą zgodnie z tootheir własnych potrzeb.</span><span class="sxs-lookup"><span data-stu-id="2af0a-352">This ensures that hello services are balanced within themselves according tootheir own needs.</span></span> <span data-ttu-id="2af0a-353">W związku z tym jeśli hello pierwszego węzła w tym samym nie powiedzie się niepowodzenie hello jest dystrybuowana do wszystkich partycji wszystkich usług.</span><span class="sxs-lookup"><span data-stu-id="2af0a-353">As a result, if hello same first node fails hello failure is distributed across all partitions of all services.</span></span> <span data-ttu-id="2af0a-354">tooeach wpływ Hello jest hello takie same.</span><span class="sxs-lookup"><span data-stu-id="2af0a-354">hello impact tooeach is hello same.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2af0a-355">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="2af0a-355">Next steps</span></span>
- <span data-ttu-id="2af0a-356">Aby uzyskać więcej informacji na temat konfigurowania usługi [informacje na temat konfigurowania usługi](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-356">For more information on configuring services, [Learn about configuring Services](service-fabric-cluster-resource-manager-configure-services.md)(service-fabric-cluster-resource-manager-configure-services.md)</span></span>
- <span data-ttu-id="2af0a-357">Definiowanie metryki defragmentacji jest jednym ze sposobów tooconsolidate obciążenie węzłów zamiast go rozkładanie. toolearn jak tooconfigure defragmentacji, zapoznaj się zbyt[w tym artykule](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-357">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
- <span data-ttu-id="2af0a-358">toofind limit o jak hello Menedżera zasobów klastra zarządza i równoważy obciążenie klastra hello wyewidencjonować hello artykułu na [równoważenia obciążenia](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-358">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="2af0a-359">Rozpocznij od początku hello i [uzyskać toohello wprowadzenie zasobu klastra sieci szkieletowej programu Service Manager](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-359">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
- <span data-ttu-id="2af0a-360">Koszt przeniesienia jest jednym ze sposobów sygnalizowania toohello Menedżera zasobów klastra, że niektóre usługi są toomove droższe niż inne.</span><span class="sxs-lookup"><span data-stu-id="2af0a-360">Movement Cost is one way of signaling toohello Cluster Resource Manager that certain services are more expensive toomove than others.</span></span> <span data-ttu-id="2af0a-361">toolearn więcej informacji na temat koszt przeniesienia odwoływać się za[w tym artykule](service-fabric-cluster-resource-manager-movement-cost.md)</span><span class="sxs-lookup"><span data-stu-id="2af0a-361">toolearn more about movement cost, refer too[this article](service-fabric-cluster-resource-manager-movement-cost.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-cluster-layout-with-default-metrics.png
[Image2]:./media/service-fabric-cluster-resource-manager-metrics/Service-Fabric-Resource-Manager-Dynamic-Load-Reports.png
[Image3]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-metric-weights-impact.png
[Image4]:./media/service-fabric-cluster-resource-manager-metrics/cluster-resource-manager-global-vs-local-balancing.png
