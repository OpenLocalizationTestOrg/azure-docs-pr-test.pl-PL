---
title: "Replikacja IIS wielowarstwowych na podstawie aplikacji sieci web przy użyciu usługi Azure Site Recovery | Dokumentacja firmy Microsoft"
description: "W tym artykule opisano sposób replikowania IIS sieci web farmy maszyn wirtualnych za pomocą usługi Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: gauravd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: nisoneji
ms.openlocfilehash: 4ac79df703de00ac009d9845772d8be740e74f29
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="replicate-a-multi-tier-iis-based-web-application-using-azure-site-recovery"></a><span data-ttu-id="94ba5-103">Replikowanie aplikacji sieci web usług IIS na podstawie wielowarstwową przy użyciu usługi Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="94ba5-103">Replicate a multi-tier IIS based web application using Azure Site Recovery</span></span>

## <a name="overview"></a><span data-ttu-id="94ba5-104">Omówienie</span><span class="sxs-lookup"><span data-stu-id="94ba5-104">Overview</span></span>


<span data-ttu-id="94ba5-105">Oprogramowanie to aparat wydajności biznesowej w organizacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-105">Application software is the engine of business productivity in an organization.</span></span> <span data-ttu-id="94ba5-106">Różne aplikacje sieci web może obsługiwać różnych celów w organizacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-106">Various web applications can serve different purposes in an organization.</span></span> <span data-ttu-id="94ba5-107">Niektóre z nich, takie jak lista płac przetwarzania, aplikacje finansowe i klientów witryn sieci Web może być najwyższym krytyczne dla organizacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-107">Some of these like payroll processing, financial applications and customer facing websites can be utmost critical for an organization.</span></span> <span data-ttu-id="94ba5-108">Ważne dla organizacji, które mają i uruchomiona na wszystkich razy, aby zapobiec utracie wydajności, a co więcej chronić żadnych obrazu brand organizacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-108">It will be important for the organization to have them up and running at all times to prevent loss of productivity and more importantly prevent any damage to the brand image of the organization.</span></span>

<span data-ttu-id="94ba5-109">Aplikacje sieci web krytyczne są zwykle tworzone jako wielowarstwowe aplikacje sieci web, bazy danych i aplikacji na różnych warstw.</span><span class="sxs-lookup"><span data-stu-id="94ba5-109">Critical web applications are typically set up as multi-tier applications with the web, database and application on different tiers.</span></span> <span data-ttu-id="94ba5-110">Oprócz są rozkładane do różnych warstw, aplikacje mogą również przy użyciu wielu serwerów w poszczególnych warstwach ruch równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="94ba5-110">Apart from being spread across various tiers, the applications may also be using multiple servers in each tier to load balance the traffic.</span></span> <span data-ttu-id="94ba5-111">Ponadto mapowania między warstwami różnych i na serwerze sieci web może być oparty na statycznych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="94ba5-111">Moreover, the mappings between various tiers and on the web server may be based on static IP addresses.</span></span> <span data-ttu-id="94ba5-112">W tryb failover niektóre z tych mapowań będzie muszą zostać zaktualizowane, zwłaszcza, jeśli masz wiele witryn sieci Web, które są skonfigurowane na serwerze sieci web.</span><span class="sxs-lookup"><span data-stu-id="94ba5-112">On failover, some of these mappings will need to be updated, especially, if you have multiple websites configured on the web server.</span></span> <span data-ttu-id="94ba5-113">W przypadku aplikacji sieci web przy użyciu protokołu SSL powiązania certyfikatu będzie muszą zostać zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="94ba5-113">In case of web applications using SSL, certificate bindings will need to be updated.</span></span>

<span data-ttu-id="94ba5-114">Metod tradycyjnych odzyskiwania na podstawie — replikacja obejmują wykonywanie kopii zapasowych różnych plików konfiguracji, ustawienia rejestru, powiązania, niestandardowych składników (COM lub .NET), zawartość i także certyfikaty i odzyskiwanie plików za pomocą zestawu wymagane ręczne wykonanie czynności.</span><span class="sxs-lookup"><span data-stu-id="94ba5-114">Traditional non-replication based recovery methods involve backing up of various configuration files, registry settings, bindings, custom components (COM or .NET), content and also certificates and recovering the files through a set of manual steps.</span></span> <span data-ttu-id="94ba5-115">Te techniki są jasno obciążeniem, błąd podatnych na błędy i nie skalowalności.</span><span class="sxs-lookup"><span data-stu-id="94ba5-115">These techniques are clearly cumbersome, error prone and not scalable.</span></span> <span data-ttu-id="94ba5-116">Jest na przykład, łatwe w miarę zapomnij wykonywanie kopii zapasowej certyfikatów i pozostać z wyborem nie, ale kupić nowe certyfikaty serwera po pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="94ba5-116">It is, for example, easily possible for you to forget backing up certificates and be left with no choice but to buy new certificates for the server after failover.</span></span>

<span data-ttu-id="94ba5-117">Dobre rozwiązanie odzyskiwania po awarii, powinno umożliwić modelowania planów odzyskiwania wokół powyższych architekturach aplikacji złożonych, a także mieć możliwość dodawania kroków dostosowane do obsługi aplikacji mapowań między różnych warstw, dlatego zapewnienie pojedynczym kliknięciem czy zrzut rozwiązanie w przypadku awarii, co może prowadzić do dolnej RTO.</span><span class="sxs-lookup"><span data-stu-id="94ba5-117">A good disaster recovery solution, should allow modeling of recovery plans around the above complex application architectures and also have the ability to add customized steps to handle application mappings between various tiers hence providing a single-click sure shot solution in the event of a disaster leading to a lower RTO.</span></span>


<span data-ttu-id="94ba5-118">W tym artykule opisano sposób chronić usług IIS na podstawie sieci web aplikacji za pomocą [usługi Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="94ba5-118">This article describes how to protect an IIS based web application using a [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="94ba5-119">W tym artykule opisano najlepsze rozwiązania dotyczące replikacji trzy warstwy aplikacji sieci web usług IIS na podstawie na platformie Azure, jak wyszczególniania odzyskiwania po awarii oraz sposób pracy awaryjnej aplikacji na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="94ba5-119">This article will cover best practices for replicating a three tier IIS based web application to Azure, how you can do a disaster recovery drill, and how you can failover the application to Azure.</span></span>


## <a name="prerequisites"></a><span data-ttu-id="94ba5-120">Wymagania wstępne</span><span class="sxs-lookup"><span data-stu-id="94ba5-120">Prerequisites</span></span>

<span data-ttu-id="94ba5-121">Przed rozpoczęciem upewnij się, że należy zrozumieć następujące kwestie:</span><span class="sxs-lookup"><span data-stu-id="94ba5-121">Before you start, make sure you understand the following:</span></span>

1. [<span data-ttu-id="94ba5-122">Replikacja maszyny wirtualnej na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="94ba5-122">Replicating a virtual machine to Azure</span></span>](site-recovery-vmware-to-azure.md)
1. <span data-ttu-id="94ba5-123">Jak [projektowania sieci odzyskiwania](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="94ba5-123">How to [design a recovery network](site-recovery-network-design.md)</span></span>
1. [<span data-ttu-id="94ba5-124">Ten test trybu failover na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="94ba5-124">Doing a test failover to Azure</span></span>](./site-recovery-test-failover-to-azure.md)
1. [<span data-ttu-id="94ba5-125">Podczas pracy w trybie failover na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="94ba5-125">Doing a failover to Azure</span></span>](site-recovery-failover.md)
1. <span data-ttu-id="94ba5-126">Jak [replikacji kontrolera domeny](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="94ba5-126">How to [replicate a domain controller](site-recovery-active-directory.md)</span></span>
1. <span data-ttu-id="94ba5-127">Jak [replikacji programu SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="94ba5-127">How to [replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="deployment-patterns"></a><span data-ttu-id="94ba5-128">Wzorce wdrożenia</span><span class="sxs-lookup"><span data-stu-id="94ba5-128">Deployment patterns</span></span>
<span data-ttu-id="94ba5-129">Aplikacji sieci web usług IIS na podstawie zwykle obejmuje jedną z następujących wzorców wdrożenia:</span><span class="sxs-lookup"><span data-stu-id="94ba5-129">An IIS based web application typically follows one of the following deployment patterns:</span></span>

<span data-ttu-id="94ba5-130">** Wdrożenia wzorzec 1 ** usług IIS na podstawie kolektywu serwerów sieci web z Routing(ARR) żądania aplikacji, serwer usług IIS i Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="94ba5-130">**Deployment pattern 1 ** An IIS based web farm  with Application Request Routing(ARR), IIS Server and Microsoft SQL Server.</span></span>

![Wzorzec wdrożenia](./media/site-recovery-iis/deployment-pattern1.png)

<span data-ttu-id="94ba5-132">**Wzorzec wdrożenia 2** usług IIS na podstawie kolektywu serwerów sieci web z Routing(ARR) żądania aplikacji, serwer usług IIS, serwera aplikacji i programu Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="94ba5-132">**Deployment pattern 2** An IIS based web farm with Application Request Routing(ARR), IIS Server, Application Server, and Microsoft SQL Server.</span></span>


![Wzorzec wdrożenia](./media/site-recovery-iis/deployment-pattern2.png)

## <a name="site-recovery-support"></a><span data-ttu-id="94ba5-134">Obsługa odzyskiwania lokacji</span><span class="sxs-lookup"><span data-stu-id="94ba5-134">Site Recovery support</span></span>

<span data-ttu-id="94ba5-135">Na potrzeby tworzenia maszyn wirtualnych VMware tego artykułu z serwerem usług IIS w wersji 7.5 w systemie Windows Server 2012 R2 Enterprise były używane.</span><span class="sxs-lookup"><span data-stu-id="94ba5-135">For the purpose of creating this article VMware virtual machines with IIS Server version 7.5 on Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="94ba5-136">Ponieważ replikacja z lokacji odzyskiwania jest niezależny od aplikacji, zalecenia zawarte w tym miejscu powinny przechowywane w następujących scenariuszach, jak również i dla różnych wersji programu IIS.</span><span class="sxs-lookup"><span data-stu-id="94ba5-136">As site recovery replication is application agnostic, the recommendations provided here are expected to hold on following scenarios as well and for different version of IIS.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="94ba5-137">Źródłowa i docelowa</span><span class="sxs-lookup"><span data-stu-id="94ba5-137">Source and target</span></span>

<span data-ttu-id="94ba5-138">**Scenariusz**</span><span class="sxs-lookup"><span data-stu-id="94ba5-138">**Scenario**</span></span> | <span data-ttu-id="94ba5-139">**Do lokacji dodatkowej**</span><span class="sxs-lookup"><span data-stu-id="94ba5-139">**To a secondary site**</span></span> | <span data-ttu-id="94ba5-140">**Na platformie Azure**</span><span class="sxs-lookup"><span data-stu-id="94ba5-140">**To Azure**</span></span>
--- | --- | ---
<span data-ttu-id="94ba5-141">**Funkcja Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="94ba5-141">**Hyper-V**</span></span> | <span data-ttu-id="94ba5-142">Tak</span><span class="sxs-lookup"><span data-stu-id="94ba5-142">Yes</span></span> | <span data-ttu-id="94ba5-143">Tak</span><span class="sxs-lookup"><span data-stu-id="94ba5-143">Yes</span></span>
<span data-ttu-id="94ba5-144">**VMware**</span><span class="sxs-lookup"><span data-stu-id="94ba5-144">**VMware**</span></span> | <span data-ttu-id="94ba5-145">Tak</span><span class="sxs-lookup"><span data-stu-id="94ba5-145">Yes</span></span> | <span data-ttu-id="94ba5-146">Tak</span><span class="sxs-lookup"><span data-stu-id="94ba5-146">Yes</span></span>
<span data-ttu-id="94ba5-147">**Serwer fizyczny**</span><span class="sxs-lookup"><span data-stu-id="94ba5-147">**Physical server**</span></span> | <span data-ttu-id="94ba5-148">Nie</span><span class="sxs-lookup"><span data-stu-id="94ba5-148">No</span></span> | <span data-ttu-id="94ba5-149">Tak</span><span class="sxs-lookup"><span data-stu-id="94ba5-149">Yes</span></span>

## <a name="replicate-virtual-machines"></a><span data-ttu-id="94ba5-150">Replikowanie maszyn wirtualnych</span><span class="sxs-lookup"><span data-stu-id="94ba5-150">Replicate virtual machines</span></span>

<span data-ttu-id="94ba5-151">Postępuj zgodnie z [w tych wskazówkach](site-recovery-vmware-to-azure.md) do rozpoczęcia replikacji wszystkich usług IIS sieci web farmy maszyn wirtualnych na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="94ba5-151">Follow [this guidance](site-recovery-vmware-to-azure.md) to start replicating all the IIS web farm virtual machines to Azure.</span></span>

<span data-ttu-id="94ba5-152">Jeśli jest używany statyczny adres IP, należy określić adres IP, który ma maszyny wirtualnej w [ **docelowy adres IP** ](./site-recovery-replicate-vmware-to-azure.md#view-and-manage-vm-properties) ustawienie w ustawieniach obliczeń i sieci.</span><span class="sxs-lookup"><span data-stu-id="94ba5-152">If you are using a static IP then specify the IP that you want the virtual machine to take in the [**Target IP**](./site-recovery-replicate-vmware-to-azure.md#view-and-manage-vm-properties) setting in Compute and Network settings.</span></span>

![Adres IP obiektu docelowego](./media/site-recovery-active-directory/dns-target-ip.png)


## <a name="creating-a-recovery-plan"></a><span data-ttu-id="94ba5-154">Tworzenie planu odzyskiwania</span><span class="sxs-lookup"><span data-stu-id="94ba5-154">Creating a recovery plan</span></span>

<span data-ttu-id="94ba5-155">Plan odzyskiwania umożliwia sekwencjonowania pracę awaryjną różnych warstw w wielowarstwowej aplikacji, w związku z tym zachowaniu spójności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-155">A recovery plan allows sequencing the failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="94ba5-156">Wykonaj następujące czynności, podczas tworzenia planu odzyskiwania dla aplikacji sieci web w wielowarstwowych.</span><span class="sxs-lookup"><span data-stu-id="94ba5-156">Follow the below steps while creating a recovery plan for a multi-tier web application.</span></span>  <span data-ttu-id="94ba5-157">[Dowiedz się więcej o tworzeniu planu odzyskiwania](./site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="94ba5-157">[Learn more about creating a recovery plan](./site-recovery-create-recovery-plans.md).</span></span>

### <a name="adding-virtual-machines-to-failover-groups"></a><span data-ttu-id="94ba5-158">Dodawanie maszyn wirtualnych do trybu failover grupy</span><span class="sxs-lookup"><span data-stu-id="94ba5-158">Adding virtual machines to failover groups</span></span>
<span data-ttu-id="94ba5-159">Typowa aplikacja sieci web usług IIS wielowarstwowych będzie składać się z warstwy bazy danych SQL maszyn wirtualnych, warstwa sieci web utworzoną przez serwer usług IIS i warstwy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-159">A typical multi-tier IIS web application will consist of a database tier with SQL virtual machines, the web tier constituted by a IIS server and an application tier.</span></span> <span data-ttu-id="94ba5-160">Dodaj wszystkie maszyny wirtualne do innej grupy oparte na warstwę poniżej.</span><span class="sxs-lookup"><span data-stu-id="94ba5-160">Add all these virtual machines to different group based on tier as below.</span></span> <span data-ttu-id="94ba5-161">[Dowiedz się więcej o dostosowanie planu odzyskiwania](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="94ba5-161">[Learn more about customising recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

1. <span data-ttu-id="94ba5-162">Tworzenie planu odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-162">Create a recovery plan.</span></span> <span data-ttu-id="94ba5-163">Dodaj maszyny wirtualne warstwy bazy danych w grupy 1-Sprawdź, czy ostatnie są zamknięcia i włączane pierwszej.</span><span class="sxs-lookup"><span data-stu-id="94ba5-163">Add the database tier virtual machines under Group 1 to ensure that they are shutdown last and brought up first.</span></span>

1. <span data-ttu-id="94ba5-164">Dodaj maszyny wirtualne warstwy aplikacji, w obszarze grupy 2 w taki sposób, że są włączane po włączane warstwy bazy danych.</span><span class="sxs-lookup"><span data-stu-id="94ba5-164">Add the application tier virtual machines under Group 2 such that they are brought up after the database tier has been brought up.</span></span>

1. <span data-ttu-id="94ba5-165">Dodaj maszyny wirtualne warstwy sieci web w grupa 3 w taki sposób, że są włączane po włączane warstwy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-165">Add the web tier virtual machines in Group 3 such that they are brought up after the application tier has been brought up.</span></span>

1. <span data-ttu-id="94ba5-166">Dodaj maszyny wirtualne równoważenia obciążenia w grupie 4 taki sposób, że są włączane po włączane warstwa sieci web.</span><span class="sxs-lookup"><span data-stu-id="94ba5-166">Add load balance virtual machines in Group 4 such that they are brought up after the web tier has been brought up.</span></span>


### <a name="adding-scripts-to-the-recovery-plan"></a><span data-ttu-id="94ba5-167">Dodawanie skryptów do planu odzyskiwania</span><span class="sxs-lookup"><span data-stu-id="94ba5-167">Adding scripts to the recovery plan</span></span>
<span data-ttu-id="94ba5-168">Konieczne może być czy niektóre operacje na maszynach wirtualnych platformy Azure post trybu failover i testowanie trybu failover Aby poprawnie funkcja kolektywu serwerów sieci web usług IIS.</span><span class="sxs-lookup"><span data-stu-id="94ba5-168">You may need to do some operations on the Azure virtual machines post failover/Test failover to make IIS web farm function correctly.</span></span> <span data-ttu-id="94ba5-169">Można zautomatyzować operację trybu failover post, takich jak aktualizacja wpisu DNS, zmiana powiązania witryny, zmiany w parametrach połączenia, dodając odpowiednie skrypty w planie odzyskiwania, jak pokazano poniżej.</span><span class="sxs-lookup"><span data-stu-id="94ba5-169">You can automate the post failover operation like updating DNS entry, changing site binding, change  in connection string  by adding corresponding scripts in the recovery plan as below.</span></span> <span data-ttu-id="94ba5-170">[Dowiedz się więcej na temat dodawania skryptu planu odzyskiwania](./site-recovery-create-recovery-plans.md#add-scripts).</span><span class="sxs-lookup"><span data-stu-id="94ba5-170">[Learn more about add script recovery plan](./site-recovery-create-recovery-plans.md#add-scripts).</span></span>

#### <a name="dns-update"></a><span data-ttu-id="94ba5-171">Aktualizację DNS</span><span class="sxs-lookup"><span data-stu-id="94ba5-171">DNS Update</span></span>
<span data-ttu-id="94ba5-172">Jeśli DNS jest skonfigurowany do dynamicznej aktualizacji DNS, a następnie maszyn wirtualnych zwykle po rozpoczęciu aktualizacji DNS z nowego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="94ba5-172">If the DNS is configured for dynamic DNS update then virtual machines usually update the DNS with the new IP once they start.</span></span> <span data-ttu-id="94ba5-173">Jeśli chcesz dodać jawne krok, aby zaktualizować DNS o nowe adresy IP maszyn wirtualnych, a następnie dodaj ją [skrypt w celu zaktualizowania IP w systemie DNS](https://aka.ms/asr-dns-update) akcji post na grupach planu odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-173">If you want to add an explicit step to update DNS with the new IPs of the virtual machines then add this [script to update IP in DNS](https://aka.ms/asr-dns-update) as a post action on recovery plan groups.</span></span>  

#### <a name="connection-string-in-an-applications-webconfig"></a><span data-ttu-id="94ba5-174">Parametry połączenia w pliku web.config aplikacji</span><span class="sxs-lookup"><span data-stu-id="94ba5-174">Connection string in an application’s web.config</span></span>
<span data-ttu-id="94ba5-175">Ciąg połączenia określa witryny sieci web, który komunikuje się z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="94ba5-175">The connection string specifies the database that the web site communicates with.</span></span>

<span data-ttu-id="94ba5-176">Jeśli parametry połączenia przyjmuje nazwę maszyny wirtualnej bazy danych, żadne dalsze czynności będą potrzebne post trybu failover, a aplikacja będzie automatycznie komunikować się z bazą danych.</span><span class="sxs-lookup"><span data-stu-id="94ba5-176">If the connection string carries the name of the database virtual machine, no further steps will be needed post failover and the application will be able to automatically communicate to the DB.</span></span> <span data-ttu-id="94ba5-177">Ponadto jeśli adres IP dla maszyny wirtualnej bazy danych jest zachowywana, go nie będzie potrzebna, aby zaktualizować parametry połączenia.</span><span class="sxs-lookup"><span data-stu-id="94ba5-177">Also, if the IP address for the database virtual machine is retained, it will not be needed to update the connection string.</span></span> <span data-ttu-id="94ba5-178">Jeśli parametry połączenia odwołuje się do maszyny wirtualnej bazy danych przy użyciu adresu IP, będzie musiała zostać zaktualizowane po pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="94ba5-178">If the connection string refers to the database virtual machine using an IP address, it will need to be updated post failover.</span></span> <span data-ttu-id="94ba5-179">Na przykład</span><span class="sxs-lookup"><span data-stu-id="94ba5-179">E.g.</span></span> <span data-ttu-id="94ba5-180">poniżej punkty ciągu połączenia z bazą danych z adresem IP 127.0.1.2</span><span class="sxs-lookup"><span data-stu-id="94ba5-180">the below connection string points to the DB with IP 127.0.1.2</span></span>

        <?xml version="1.0" encoding="utf-8"?>
        <configuration>
        <connectionStrings>
        <add name="ConnStringDb1" connectionString="Data Source= 127.0.1.2\SqlExpress; Initial Catalog=TestDB1;Integrated Security=False;" />
        </connectionStrings>
        </configuration>

<span data-ttu-id="94ba5-181">Parametry połączenia w warstwa sieci web można zaktualizować przez dodanie [skryptu aktualizacji połączenia usług IIS](https://aka.ms/asr-update-webtier-script-classic) po grupa 3 w planie odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-181">You can update the connection string in web tier by adding [IIS connection update script](https://aka.ms/asr-update-webtier-script-classic) after Group 3 in the recovery plan.</span></span>

#### <a name="site-bindings-for-the-application"></a><span data-ttu-id="94ba5-182">Powiązania witryny dla aplikacji</span><span class="sxs-lookup"><span data-stu-id="94ba5-182">Site bindings for the application</span></span>
<span data-ttu-id="94ba5-183">Każda witryna składa się z powiązania informacje, które obejmują typ powiązania, adres IP, jaką serwera IIS nasłuchuje żądań dla witryny, numer portu i nazwy hostów dla tej lokacji.</span><span class="sxs-lookup"><span data-stu-id="94ba5-183">Every site consists of binding information that includes the type of binding, the IP address at which the IIS server listens to the requests for the site, the port number and the host names for the site.</span></span> <span data-ttu-id="94ba5-184">W czasie pracy awaryjnej te powiązania może muszą zostać zaktualizowane w przypadku zmiany adresów IP skojarzonych z nimi.</span><span class="sxs-lookup"><span data-stu-id="94ba5-184">At the time of a failover, these bindings might need to be updated if there is a change in the IP address associated with them.</span></span>

> [!NOTE]
>
> <span data-ttu-id="94ba5-185">Po oznaczeniu "wszystkie nieprzypisane" dla powiązania witryny, tak jak w poniższym przykładzie, nie będzie konieczne zaktualizowanie tej pracy awaryjnej post powiązania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-185">If you have marked ‘all unassigned’ for the site binding as in the example below, you will not need to update this binding post failover.</span></span> <span data-ttu-id="94ba5-186">Ponadto, jeśli adres IP skojarzony z lokacją nie ulega zmianie post trybu failover, powiązania witryny muszą nie można zaktualizować (przechowywania adresu IP jest zależna od architektury sieci i podsieci przypisane do lokacji głównej i odzyskiwania lokacji i dlatego mogą lub może nie być możliwe dla Twojej organizacji.)</span><span class="sxs-lookup"><span data-stu-id="94ba5-186">Also, if the IP address associated with a site is not changed post failover, the site binding need not be updated (Retention of the IP address depends on the network architecture and subnets assigned to the primary and recovery sites and hence may or may not be feasible for your organization.)</span></span>

![Powiązanie SSL](./media/site-recovery-iis/sslbinding.png)

<span data-ttu-id="94ba5-188">Jeśli adres IP został skojarzony z lokacją, należy zaktualizować wszystkie powiązania witryny przy użyciu nowego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="94ba5-188">If you have associated the IP address with a site, you will need to update all site bindings with the new IP address.</span></span> <span data-ttu-id="94ba5-189">Możesz dodać [skryptu aktualizacji warstwy sieci Web usług IIS](https://aka.ms/asr-web-tier-update-runbook-classic) po grupa 3 w planie odzyskiwania, aby zmienić powiązania witryny.</span><span class="sxs-lookup"><span data-stu-id="94ba5-189">You can add [IIS Web tier update script](https://aka.ms/asr-web-tier-update-runbook-classic) after Group 3 in recovery plan to change the site bindings.</span></span>


#### <a name="update-load-balancer-ip-address"></a><span data-ttu-id="94ba5-190">Zaktualizuj adres IP usługi równoważenia obciążenia</span><span class="sxs-lookup"><span data-stu-id="94ba5-190">Update load balancer IP address</span></span>
<span data-ttu-id="94ba5-191">Jeśli masz Routing żądań aplikacji maszyny wirtualnej, dodać [skryptu trybu failover IIS ARR](https://aka.ms/asr-iis-arrtier-failover-script-classic) po 4 grupy można zaktualizować adresu IP.</span><span class="sxs-lookup"><span data-stu-id="94ba5-191">If you have  Application Request Routing virtual machine, add [IIS ARR  failover script](https://aka.ms/asr-iis-arrtier-failover-script-classic) after Group 4 to update the IP address.</span></span>

#### <a name="the-ssl-cert-binding-for-an-https-connection"></a><span data-ttu-id="94ba5-192">Powiązania certyfikatu SSL dla połączenia https</span><span class="sxs-lookup"><span data-stu-id="94ba5-192">The SSL cert binding for an https connection</span></span>
<span data-ttu-id="94ba5-193">Witryny sieci Web może mieć skojarzone certyfikatu SSL, która pomaga w celu zapewnienia bezpiecznej komunikacji między serwer sieci Web i przeglądarki użytkownika.</span><span class="sxs-lookup"><span data-stu-id="94ba5-193">Websites can have an associated SSL certificate that helps in ensuring a secure communication between the webserver and the user’s browser.</span></span> <span data-ttu-id="94ba5-194">Jeśli witryna sieci Web ma połączenie https i powiązanie witryny https skojarzony adres IP serwera IIS wraz z powiązaniem certyfikatu SSL, nowe powiązanie witryny należy można dodać certyfikatu z adresem IP Failover post maszyny wirtualnej usług IIS.</span><span class="sxs-lookup"><span data-stu-id="94ba5-194">If the website has an https connection and an associated https site binding to the IP address of the IIS server with an SSL cert binding, a new site binding will need to be added for the cert with the IP of the IIS virtual machine post failover.</span></span>

<span data-ttu-id="94ba5-195">Certyfikat SSL mogą być wystawiane przed-</span><span class="sxs-lookup"><span data-stu-id="94ba5-195">The SSL cert can be issued against-</span></span>

<span data-ttu-id="94ba5-196">) w pełni kwalifikowaną nazwę domeny witryny sieci Web</span><span class="sxs-lookup"><span data-stu-id="94ba5-196">a) The fully qualified domain name of the website</span></span><br>
<span data-ttu-id="94ba5-197">(b) nazwa serwera</span><span class="sxs-lookup"><span data-stu-id="94ba5-197">b) The name of the server</span></span><br>
<span data-ttu-id="94ba5-198">c) certyfikat uniwersalny, dla nazwy domeny</span><span class="sxs-lookup"><span data-stu-id="94ba5-198">c) A wildcard certificate for the domain name</span></span><br>
<span data-ttu-id="94ba5-199">d) adres IP — Jeśli certyfikat SSL jest wystawiony na podstawie adresu IP serwera usług IIS, inny certyfikat SSL musi być wystawiony na podstawie adresu IP serwera usług IIS w witrynie platformy Azure i będzie trzeba utworzyć dodatkowe powiązania SSL dla tego certyfikatu.</span><span class="sxs-lookup"><span data-stu-id="94ba5-199">d) An IP address – If the SSL cert is issued against the IP of the IIS server, another SSL cert needs to be issued against the IP address of the IIS server on the Azure site and an additional SSL binding for this certificate will need to be created.</span></span> <span data-ttu-id="94ba5-200">W związku z tym zaleca się nie używać certyfikatu SSL wystawiony na podstawie adresu IP.</span><span class="sxs-lookup"><span data-stu-id="94ba5-200">Hence, it is advisable to not use an SSL cert issued against IP.</span></span> <span data-ttu-id="94ba5-201">To jest opcja mniej powszechnie używane i wkrótce zostaną wycofane zgodnie z harmonogramem nowych zmian forum urzędu certyfikacji/przeglądarki.</span><span class="sxs-lookup"><span data-stu-id="94ba5-201">This is a less widely used option and will soon be deprecated as per new CA/browser forum changes.</span></span>

#### <a name="update-the-dependency-between-the-web-and-the-application-tier"></a><span data-ttu-id="94ba5-202">Aktualizuj zależności między sieci web a warstwą aplikacji</span><span class="sxs-lookup"><span data-stu-id="94ba5-202">Update the dependency between the web and the application tier</span></span>
<span data-ttu-id="94ba5-203">Jeśli masz zależność określonych aplikacji na podstawie adresu IP maszyn wirtualnych, należy zaktualizować tej pracy awaryjnej post zależności.</span><span class="sxs-lookup"><span data-stu-id="94ba5-203">If you have an application specific dependency based on the IP address of the virtual machines, you need to update this dependency post failover.</span></span>

## <a name="doing-a-test-failover"></a><span data-ttu-id="94ba5-204">Ten test trybu failover</span><span class="sxs-lookup"><span data-stu-id="94ba5-204">Doing a test failover</span></span>
<span data-ttu-id="94ba5-205">Postępuj zgodnie z [w tych wskazówkach](site-recovery-test-failover-to-azure.md) przeprowadzić test trybu failover.</span><span class="sxs-lookup"><span data-stu-id="94ba5-205">Follow [this guidance](site-recovery-test-failover-to-azure.md) to do a test failover.</span></span>

1.  <span data-ttu-id="94ba5-206">Przejdź do portalu Azure i wybierz magazyn usług odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-206">Go to Azure portal and select your Recovery Service vault.</span></span>
1.  <span data-ttu-id="94ba5-207">Polecenie planu odzyskiwania utworzone dla kolektywu serwerów sieci web usług IIS.</span><span class="sxs-lookup"><span data-stu-id="94ba5-207">Click on the recovery plan created for IIS web farm.</span></span>
1.  <span data-ttu-id="94ba5-208">Kliknij na "Test trybu Failover".</span><span class="sxs-lookup"><span data-stu-id="94ba5-208">Click on 'Test Failover'.</span></span>
1.  <span data-ttu-id="94ba5-209">Wybierz punkt odzyskiwania i sieć wirtualna platformy Azure, aby rozpocząć proces test trybu failover.</span><span class="sxs-lookup"><span data-stu-id="94ba5-209">Select recovery point and Azure virtual network to start the test failover process.</span></span>
1.  <span data-ttu-id="94ba5-210">Po skonfigurowaniu dodatkowej środowiska można wykonywać z operacji sprawdzania poprawności.</span><span class="sxs-lookup"><span data-stu-id="94ba5-210">Once the secondary environment is up, you can perform your validations.</span></span>
1.  <span data-ttu-id="94ba5-211">Po zakończeniu operacji sprawdzania poprawności, wybierz opcję "Ukończenie operacji sprawdzania poprawności" i testowe środowisko trybu failover zostaną wyczyszczone.</span><span class="sxs-lookup"><span data-stu-id="94ba5-211">Once the validations are complete, you can select ‘Validations complete’ and the test failover environment will be cleaned.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="94ba5-212">Podczas pracy w trybie failover</span><span class="sxs-lookup"><span data-stu-id="94ba5-212">Doing a failover</span></span>
<span data-ttu-id="94ba5-213">Postępuj zgodnie z [w tych wskazówkach](site-recovery-failover.md) podczas wprowadzania trybu failover.</span><span class="sxs-lookup"><span data-stu-id="94ba5-213">Follow [this guidance](site-recovery-failover.md) when you are doing a failover.</span></span>

1.  <span data-ttu-id="94ba5-214">Przejdź do portalu Azure i wybierz magazyn usług odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="94ba5-214">Go to Azure portal and select your Recovery Service vault.</span></span>
1.  <span data-ttu-id="94ba5-215">Polecenie planu odzyskiwania utworzone dla kolektywu serwerów sieci web usług IIS.</span><span class="sxs-lookup"><span data-stu-id="94ba5-215">Click on the recovery plan created for IIS web farm.</span></span>
1.  <span data-ttu-id="94ba5-216">Kliknij pozycję "Failover".</span><span class="sxs-lookup"><span data-stu-id="94ba5-216">Click on 'Failover'.</span></span>
1.  <span data-ttu-id="94ba5-217">Wybierz punkt odzyskiwania, aby rozpocząć proces trybu failover.</span><span class="sxs-lookup"><span data-stu-id="94ba5-217">Select recovery point to start the failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="94ba5-218">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="94ba5-218">Next steps</span></span>
<span data-ttu-id="94ba5-219">Użytkownik może dowiedzieć się więcej o [replikacji z innych aplikacji](site-recovery-workload.md) przy użyciu usługi Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="94ba5-219">You can learn more about [replicate other applications](site-recovery-workload.md) using Site Recovery.</span></span>
