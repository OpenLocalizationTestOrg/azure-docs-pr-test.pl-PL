---
title: "aaaHow wykonuje pracę tooAzure replikacji funkcji Hyper-V w usłudze Site Recovery? | Microsoft Docs"
description: "Ten artykuł zawiera omówienie sposobu działania replikacji funkcji Hyper-V w usłudze Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: e982806b4d6cdec2f71f82d8c73c17cc50ad3c33
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-hyper-v-replication-tooazure-work"></a><span data-ttu-id="86cb0-104">Jak działa tooAzure replikacji funkcji Hyper-V?</span><span class="sxs-lookup"><span data-stu-id="86cb0-104">How does Hyper-V replication tooAzure work?</span></span>

<span data-ttu-id="86cb0-105">Przeczytaj ten artykuł toounderstand hello architektury i przepływy pracy dotyczące tooAzure replikacji funkcji Hyper-V za pomocą hello [usługi Azure Site Recovery](site-recovery-overview.md) usługi.</span><span class="sxs-lookup"><span data-stu-id="86cb0-105">Read this article toounderstand hello architecture and workflows for Hyper-V replication tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="86cb0-106">Opublikuj wszelkie komentarze u dołu hello tego artykułu lub hello [Forum usług odzyskiwania Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="86cb0-106">Post any comments at hello bottom of this article, or in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="86cb0-107">Można replikować powitania po tooAzure:</span><span class="sxs-lookup"><span data-stu-id="86cb0-107">You can replicate hello following tooAzure:</span></span>
- <span data-ttu-id="86cb0-108">**Funkcja Hyper-V z programem VMM**: Maszyny wirtualne znajdujące się na lokalnych hostach funkcji Hyper-V zarządzanych w chmurach programu System Center Virtual Machine Manager (VMM).</span><span class="sxs-lookup"><span data-stu-id="86cb0-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="86cb0-109">Na hostach może działać dowolny [obsługiwany system operacyjny](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span><span class="sxs-lookup"><span data-stu-id="86cb0-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="86cb0-110">Replikować możesz maszyny wirtualne funkcji Hyper-V, na których działa dowolny system operacyjny gościa [obsługiwany przez funkcję Hyper-V i platformę Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="86cb0-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="86cb0-111">**Funkcja Hyper-V bez programu VMM**: Lokalne maszyny wirtualne znajdujące się na hostach funkcji Hyper-V, które nie są zarządzane w chmurach programu VMM.</span><span class="sxs-lookup"><span data-stu-id="86cb0-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="86cb0-112">Hostów można uruchomić dowolną hello [obsługiwanych systemów operacyjnych](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span><span class="sxs-lookup"><span data-stu-id="86cb0-112">Hosts can run any of hello [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="86cb0-113">Replikować możesz maszyny wirtualne funkcji Hyper-V, na których działa dowolny system operacyjny gościa [obsługiwany przez funkcję Hyper-V i platformę Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="86cb0-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="86cb0-114">Składniki architektury</span><span class="sxs-lookup"><span data-stu-id="86cb0-114">Architectural components</span></span>

<span data-ttu-id="86cb0-115">**Obszar**</span><span class="sxs-lookup"><span data-stu-id="86cb0-115">**Area**</span></span> | <span data-ttu-id="86cb0-116">**Składnik**</span><span class="sxs-lookup"><span data-stu-id="86cb0-116">**Component**</span></span> | <span data-ttu-id="86cb0-117">**Szczegóły**</span><span class="sxs-lookup"><span data-stu-id="86cb0-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="86cb0-118">**Azure**</span><span class="sxs-lookup"><span data-stu-id="86cb0-118">**Azure**</span></span> | <span data-ttu-id="86cb0-119">W przypadku platformy Azure konieczne jest posiadanie konta platformy Microsoft Azure, konta usługi Azure Storage i sieci platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="86cb0-120">Konta magazynu i sieci mogą być kontami opartymi na usłudze Resource Manager lub kontami klasycznymi.</span><span class="sxs-lookup"><span data-stu-id="86cb0-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="86cb0-121">Replikowane dane są przechowywane na koncie magazynu hello i maszyn wirtualnych platformy Azure są tworzone z danymi hello replikowane czasie pracy awaryjnej z lokacji lokalnej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-121">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="86cb0-122">Hello maszynach wirtualnych platformy Azure połączyć toohello sieci wirtualnej platformy Azure, gdy są tworzone.</span><span class="sxs-lookup"><span data-stu-id="86cb0-122">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="86cb0-123">**Serwer VMM**</span><span class="sxs-lookup"><span data-stu-id="86cb0-123">**VMM server**</span></span> | <span data-ttu-id="86cb0-124">Hosty funkcji Hyper-V znajdujące się w chmurach programu VMM</span><span class="sxs-lookup"><span data-stu-id="86cb0-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="86cb0-125">Jeśli hosty funkcji Hyper-V są zarządzane w chmurach programu VMM, należy zarejestrować serwer VMM hello w powitalne magazyn usług odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="86cb0-125">If Hyper-V hosts are managed in VMM clouds, you register hello VMM server in hello Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="86cb0-126">Na serwerze VMM hello zainstalowaniu hello dostawcy usługi Site Recovery tooorchestrate replikacji z platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-126">On hello VMM server you install hello Site Recovery Provider tooorchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="86cb0-127">Należy logiczne i sieci maszyn wirtualnych skonfigurowanie mapowania sieci tooconfigure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-127">You need logical and VM networks set up tooconfigure network mapping.</span></span> <span data-ttu-id="86cb0-128">Sieć maszyny Wirtualnej powinny być połączone tooa sieci logicznej, która ma powiązanego z chmurą hello.</span><span class="sxs-lookup"><span data-stu-id="86cb0-128">A VM network should be linked tooa logical network that's associated with hello cloud.</span></span>
<span data-ttu-id="86cb0-129">**Host funkcji Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="86cb0-129">**Hyper-V host**</span></span> | <span data-ttu-id="86cb0-130">Serwery funkcji Hyper-V można wdrożyć z użyciem serwera VMM lub bez niego.</span><span class="sxs-lookup"><span data-stu-id="86cb0-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="86cb0-131">Jeśli serwer VMM nie jest, hello dostawcy usługi Site Recovery jest zainstalowany na powitania hosta tooorchestrate replikacji z usługą Site Recovery za pośrednictwem hello internet.</span><span class="sxs-lookup"><span data-stu-id="86cb0-131">If there's no VMM server, hello Site Recovery Provider is installed on hello host tooorchestrate replication with Site Recovery over hello internet.</span></span> <span data-ttu-id="86cb0-132">W przypadku serwera programu VMM, hello dostawca jest zainstalowany na nim, a nie na powitania hosta.</span><span class="sxs-lookup"><span data-stu-id="86cb0-132">If there's a VMM server, hello Provider is installed on it, and not on hello host.</span></span><br/><br/> <span data-ttu-id="86cb0-133">agent usług odzyskiwania Hello jest zainstalowany na powitania hosta toohandle danych replikacji.</span><span class="sxs-lookup"><span data-stu-id="86cb0-133">hello Recovery Services agent is installed on hello host toohandle data replication.</span></span><br/><br/> <span data-ttu-id="86cb0-134">Komunikacja z hello dostawca i hello agent jest bezpieczna i szyfrowana.</span><span class="sxs-lookup"><span data-stu-id="86cb0-134">Communications from both hello Provider and hello agent are secure and encrypted.</span></span> <span data-ttu-id="86cb0-135">Zreplikowane dane w usłudze Azure Storage również są szyfrowane.</span><span class="sxs-lookup"><span data-stu-id="86cb0-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="86cb0-136">**Maszyny wirtualne funkcji Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="86cb0-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="86cb0-137">Należy na serwerze hosta funkcji Hyper-V hello przynajmniej jednej maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-137">You need one or more VMs on hello Hyper-V host server.</span></span> | <span data-ttu-id="86cb0-138">Nic nie wymaga tooexplicitly zainstalowanych na maszynach wirtualnych</span><span class="sxs-lookup"><span data-stu-id="86cb0-138">Nothing needs tooexplicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="86cb0-139">Kroki wdrażania</span><span class="sxs-lookup"><span data-stu-id="86cb0-139">Deployment steps</span></span>

1. <span data-ttu-id="86cb0-140">**Azure**: skonfigurowaniu hello Azure składników.</span><span class="sxs-lookup"><span data-stu-id="86cb0-140">**Azure**: You set up hello Azure components.</span></span> <span data-ttu-id="86cb0-141">Przed rozpoczęciem wdrażania usługi Site Recovery zaleca się skonfigurowanie kont magazynu i sieci.</span><span class="sxs-lookup"><span data-stu-id="86cb0-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="86cb0-142">**Magazyn**: Utwórz magazyn usługi Recovery Services na potrzeby usługi Site Recovery i skonfiguruj ustawienia magazynu, co obejmuje skonfigurowanie ustawień źródła i celu, skonfigurowanie zasad replikacji i włączenie replikacji.</span><span class="sxs-lookup"><span data-stu-id="86cb0-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="86cb0-143">**Źródło i cel**:</span><span class="sxs-lookup"><span data-stu-id="86cb0-143">**Source and target**:</span></span>
    - <span data-ttu-id="86cb0-144">**Hosty funkcji Hyper-V w chmurach VMM**: W ramach określania ustawień źródła, można pobrać i zainstalować hello dostawcy usługi Azure Site Recovery na serwerze VMM hello i hello agenta usług odzyskiwania Azure na każdym hoście funkcji Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="86cb0-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install hello Azure Site Recovery Provider on hello VMM server, and hello Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="86cb0-145">Źródło Hello będzie powitania serwera VMM.</span><span class="sxs-lookup"><span data-stu-id="86cb0-145">hello source will be hello VMM server.</span></span> <span data-ttu-id="86cb0-146">obiekt docelowy Hello jest Azure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-146">hello target is Azure.</span></span>
    - <span data-ttu-id="86cb0-147">Hosty funkcji Hyper-V bez programu VMM: po określeniu ustawienia źródła można pobrać i zainstalować hello dostawca i agent na każdym hoście funkcji Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="86cb0-147">Hyper-V hosts without VMM: When you specify source settings, you download and install hello Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="86cb0-148">Podczas wdrażania zebrać hello hostów do lokacji funkcji Hyper-V i określić tę lokację jako źródło hello.</span><span class="sxs-lookup"><span data-stu-id="86cb0-148">During deployment you gather hello hosts into a Hyper-V site, and specify this site as hello source.</span></span> <span data-ttu-id="86cb0-149">obiekt docelowy Hello jest Azure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-149">hello target is Azure.</span></span>

    <span data-ttu-id="86cb0-150">![Replikacja VMM/funkcji Hyper-V tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![tooAzure replikacji lokacji funkcji Hyper-V](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="86cb0-150">![Hyper-V/VMM replication tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="86cb0-151">**Zasady replikacji**: Utwórz zasady replikacji dla chmury VMM lub lokacji hello funkcji Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="86cb0-151">**Replication policy**: You create a replication policy for hello Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="86cb0-152">Hello zasady są stosowane tooall maszyn wirtualnych znajdujących się na hostach w witrynie hello lub w chmurze.</span><span class="sxs-lookup"><span data-stu-id="86cb0-152">hello policy is applied tooall VMs located on hosts in hello site or cloud.</span></span>
5. <span data-ttu-id="86cb0-153">**Włącz replikację**: Włącz replikację maszyn wirtualnych funkcji Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="86cb0-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="86cb0-154">Zgodnie z ustawieniami zasad replikacji hello następuje Replikacja początkowa.</span><span class="sxs-lookup"><span data-stu-id="86cb0-154">Initial replication occurs in accordance with hello replication policy settings.</span></span> <span data-ttu-id="86cb0-155">Dane zmiany są śledzone, i replikacji tooAzure zmiany różnicowe uruchamia się po zakończeniu replikacji początkowej hello.</span><span class="sxs-lookup"><span data-stu-id="86cb0-155">Data changes are tracked, and replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="86cb0-156">Śledzone zmiany elementu są przechowywane w pliku hrl.</span><span class="sxs-lookup"><span data-stu-id="86cb0-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="86cb0-157">**Testowanie trybu failover**: Uruchamianie testu toomake trybu failover, czy wszystko działa zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="86cb0-157">**Test failover**:  You run a test failover toomake sure everything's working as expected.</span></span>

<span data-ttu-id="86cb0-158">Dowiedz się więcej o wdrażaniu:</span><span class="sxs-lookup"><span data-stu-id="86cb0-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="86cb0-159">Rozpoczynanie pracy z tooAzure replikacji maszyny Wirtualnej funkcji Hyper-V — z programem VMM</span><span class="sxs-lookup"><span data-stu-id="86cb0-159">Get started with Hyper-V VM replication tooAzure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="86cb0-160">Rozpoczynanie pracy z tooAzure replikacji maszyny Wirtualnej funkcji Hyper-V - bez programu VMM</span><span class="sxs-lookup"><span data-stu-id="86cb0-160">Get started with Hyper-V VM replication tooAzure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="86cb0-161">Przepływ pracy replikacji funkcji Hyper-V</span><span class="sxs-lookup"><span data-stu-id="86cb0-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="86cb0-162">Włączanie ochrony</span><span class="sxs-lookup"><span data-stu-id="86cb0-162">Enable protection</span></span>

1. <span data-ttu-id="86cb0-163">Po włączeniu ochrony dla maszyny Wirtualnej funkcji Hyper-V w hello portalu Azure lub lokalnie, hello **Włącz ochronę** uruchamia.</span><span class="sxs-lookup"><span data-stu-id="86cb0-163">After you enable protection for a Hyper-V VM, in hello Azure portal or on-premises, hello **Enable protection** starts.</span></span>
2. <span data-ttu-id="86cb0-164">Witaj zadanie sprawdza, czy maszyna hello spełnia wymagania wstępne, przed wywołaniem hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset replikacji z ustawieniami hello skonfigurowano.</span><span class="sxs-lookup"><span data-stu-id="86cb0-164">hello job checks that hello machine complies with prerequisites, before invoking hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset up replication with hello settings you've configured.</span></span>
3. <span data-ttu-id="86cb0-165">zadanie Hello rozpoczyna się Replikacja początkowa wywołując hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) — metoda, tooinitialize Pełna replikacja maszyny Wirtualnej i wysyłania hello wirtualna tooAzure dysków wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="86cb0-165">hello job starts initial replication by invoking hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, tooinitialize a full VM replication, and send hello VM's virtual disks tooAzure.</span></span>
4. <span data-ttu-id="86cb0-166">Można monitorować zadanie hello w hello **zadania** kartę.      ![Lista zadań](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Szczegóły zadania Włącz ochronę](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="86cb0-166">You can monitor hello job in hello **Jobs** tab.      ![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="86cb0-167">Replikacja początkowa</span><span class="sxs-lookup"><span data-stu-id="86cb0-167">Initial replication</span></span>

1. <span data-ttu-id="86cb0-168">Po wyzwoleniu replikacji początkowej tworzona jest [migawka maszyny wirtualnej funkcji Hyper-V](https://technet.microsoft.com/library/dd560637.aspx).</span><span class="sxs-lookup"><span data-stu-id="86cb0-168">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="86cb0-169">Wirtualne dyski twarde są replikowane pojedynczo, dopóki nie są one wszystkich skopiowanych tooAzure.</span><span class="sxs-lookup"><span data-stu-id="86cb0-169">Virtual hard disks are replicated one by one until they're all copied tooAzure.</span></span> <span data-ttu-id="86cb0-170">Go może potrwać kilka minut w zależności od hello rozmiar maszyny Wirtualnej, a przepustowość sieci.</span><span class="sxs-lookup"><span data-stu-id="86cb0-170">It could take a while, depending on hello VM size, and network bandwidth.</span></span> <span data-ttu-id="86cb0-171">toooptimize użycie sieci, zobacz [jak toomanage lokalnymi użycia przepustowości sieci ochrony tooAzure](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="86cb0-171">toooptimize your network usage, see [How toomanage on-premises tooAzure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="86cb0-172">Jeśli zmiany dysku są wykonywane, gdy Replikacja początkowa jest w toku, hello Tracker replikacji repliki funkcji Hyper-V będzie śledził te zmiany jako dzienniki replikacji funkcji Hyper-V (hrl).</span><span class="sxs-lookup"><span data-stu-id="86cb0-172">If disk changes occur while initial replication is in progress, hello Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="86cb0-173">Te pliki znajdują się w hello tym samym folderze co dyski hello.</span><span class="sxs-lookup"><span data-stu-id="86cb0-173">These files are located in hello same folder as hello disks.</span></span> <span data-ttu-id="86cb0-174">Każdy dysk ma skojarzony plik hrl wysyłanej toosecondary magazynu.</span><span class="sxs-lookup"><span data-stu-id="86cb0-174">Each disk has an associated .hrl file that will be sent toosecondary storage.</span></span>
4. <span data-ttu-id="86cb0-175">Witaj pliki migawki i dziennika zużywają zasoby dysku w trakcie replikacji początkowej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-175">hello snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="86cb0-176">Po zakończeniu replikacji początkowej hello, hello migawki maszyny Wirtualnej jest usuwana.</span><span class="sxs-lookup"><span data-stu-id="86cb0-176">When hello initial replication finishes, hello VM snapshot is deleted.</span></span> <span data-ttu-id="86cb0-177">Przyrostowe zmiany dysków w dzienniku hello są zsynchronizowane i scalone toohello dysku nadrzędnego.</span><span class="sxs-lookup"><span data-stu-id="86cb0-177">Delta disk changes in hello log are synchronized and merged toohello parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="86cb0-178">Finalizowanie ochrony</span><span class="sxs-lookup"><span data-stu-id="86cb0-178">Finalize protection</span></span>

1. <span data-ttu-id="86cb0-179">Po replikacji początkowej hello zakończeniu hello **Finalizuj ochronę na maszynie wirtualnej hello** zadania konfiguruje ustawienia sieciowe i inne ustawienia po replikacji, aby hello maszyna wirtualna jest chroniona.</span><span class="sxs-lookup"><span data-stu-id="86cb0-179">After hello initial replication finishes, hello **Finalize protection on hello virtual machine** job configures network and other post-replication settings, so that hello virtual machine is protected.</span></span>
    <span data-ttu-id="86cb0-180">![Zadanie Finalizuj ochronę](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="86cb0-180">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="86cb0-181">Jeśli replikujesz tooAzure, może być konieczne tootweak hello ustawień dla maszyny wirtualnej hello tak, aby była gotowa do pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-181">If you're replicating tooAzure, you might need tootweak hello settings for hello virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="86cb0-182">W tym momencie możesz uruchomić test toocheck trybu failover, który wszystko działa zgodnie z oczekiwaniami.</span><span class="sxs-lookup"><span data-stu-id="86cb0-182">At this point you can run a test failover toocheck everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="86cb0-183">Replikacja różnicowa</span><span class="sxs-lookup"><span data-stu-id="86cb0-183">Delta replication</span></span>

1. <span data-ttu-id="86cb0-184">Po replikacji początkowej hello synchronizacja przyrostowa rozpoczyna się, zgodnie z ustawieniami replikacji.</span><span class="sxs-lookup"><span data-stu-id="86cb0-184">After hello initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="86cb0-185">Witaj Tracker replikacji repliki funkcji Hyper-V śledzi hello zmiany tooa wirtualnego dysku twardego jako pliki hrl.</span><span class="sxs-lookup"><span data-stu-id="86cb0-185">hello Hyper-V Replica Replication Tracker tracks hello changes tooa virtual hard disk as .hrl files.</span></span> <span data-ttu-id="86cb0-186">Z każdym dyskiem skonfigurowanym pod kątem replikacji jest skojarzony plik hrl.</span><span class="sxs-lookup"><span data-stu-id="86cb0-186">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="86cb0-187">Ten dziennik jest wysyłany konta magazynu toohello klienta po zakończeniu replikacji początkowej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-187">This log is sent toohello customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="86cb0-188">Kiedy dziennika tooAzure przesyłania, hello zmiany dysku podstawowego hello są śledzone w innym pliku dziennika, w hello tego samego katalogu.</span><span class="sxs-lookup"><span data-stu-id="86cb0-188">When a log is in transit tooAzure, hello changes in hello primary disk are tracked in another log file, in hello same directory.</span></span>
3. <span data-ttu-id="86cb0-189">Podczas replikacji początkowej i różnicowych można monitorować hello maszyny Wirtualnej w hello widok maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-189">During initial and delta replication, you can monitor hello VM in hello VM view.</span></span> <span data-ttu-id="86cb0-190">[Dowiedz się więcej](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="86cb0-190">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="86cb0-191">Synchronizacja replikacji</span><span class="sxs-lookup"><span data-stu-id="86cb0-191">Replication synchronization</span></span>

1. <span data-ttu-id="86cb0-192">Jeśli replikacja różnicowa nie powiedzie się, a pełna replikacja byłaby kosztowna pod względem przepustowości lub czasu, maszyna wirtualna jest oznaczana do ponownej synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="86cb0-192">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="86cb0-193">Na przykład jeśli pliki hrl będą zajmować hello dostępu 50% rozmiaru dysku hello, następnie hello maszyny Wirtualnej zostaną oznaczone ponownej synchronizacji.</span><span class="sxs-lookup"><span data-stu-id="86cb0-193">For example, if hello .hrl files reach 50% of hello disk size, then hello VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="86cb0-194">Ponowna synchronizacja minimalizuje hello ilość danych przesyłanych przez obliczaniu sum kontrolnych hello źródłowych i docelowych maszyn wirtualnych oraz wysyłaniu tylko danych różnicowych hello.</span><span class="sxs-lookup"><span data-stu-id="86cb0-194">Resynchronization minimizes hello amount of data sent by computing checksums of hello source and target virtual machines, and sending only hello delta data.</span></span> <span data-ttu-id="86cb0-195">Ponowna synchronizacja używa algorytmu dzielenia na fragmenty o stałym bloku. Za jego pomocą pliki źródłowe i docelowe są dzielone na stałe fragmenty.</span><span class="sxs-lookup"><span data-stu-id="86cb0-195">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="86cb0-196">Sumy kontrolne dla każdego fragmentu są generowane, a następnie porównuje toodetermine, która blokuje z miejsca docelowego hello źródła potrzeby toobe toohello zastosowane.</span><span class="sxs-lookup"><span data-stu-id="86cb0-196">Checksums for each chunk are generated and then compared toodetermine which blocks from hello source need toobe applied toohello target.</span></span>
3. <span data-ttu-id="86cb0-197">Po ukończeniu ponownej synchronizacji replikacja różnicowa powinna zostać wznowiona.</span><span class="sxs-lookup"><span data-stu-id="86cb0-197">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="86cb0-198">Domyślnie ponowna synchronizacja jest zaplanowane toorun automatycznie poza godzinami pracy, ale możesz ponownie ręcznie zsynchronizować maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="86cb0-198">By default resynchronization is scheduled toorun automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="86cb0-199">Na przykład możesz wznowić ponowną synchronizację, jeśli wystąpi awaria sieci lub inna awaria.</span><span class="sxs-lookup"><span data-stu-id="86cb0-199">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="86cb0-200">toodo, wybierz opcję hello maszyny Wirtualnej w portalu hello > **ponownie zsynchronizować**.</span><span class="sxs-lookup"><span data-stu-id="86cb0-200">toodo this, select hello VM in hello portal > **Resynchronize**.</span></span>

    ![Ręczna ponowna synchronizacja](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="86cb0-202">Ponowne próby</span><span class="sxs-lookup"><span data-stu-id="86cb0-202">Retries</span></span>

<span data-ttu-id="86cb0-203">Jeśli wystąpi błąd replikacji, może zostać użyty wbudowany mechanizm ponawiania.</span><span class="sxs-lookup"><span data-stu-id="86cb0-203">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="86cb0-204">Tę logikę można podzielić na dwie kategorie:</span><span class="sxs-lookup"><span data-stu-id="86cb0-204">This logic can be classified into two categories:</span></span>

<span data-ttu-id="86cb0-205">**Kategoria**</span><span class="sxs-lookup"><span data-stu-id="86cb0-205">**Category**</span></span> | <span data-ttu-id="86cb0-206">**Szczegóły**</span><span class="sxs-lookup"><span data-stu-id="86cb0-206">**Details**</span></span>
--- | ---
<span data-ttu-id="86cb0-207">**Błąd nieodwracalny**</span><span class="sxs-lookup"><span data-stu-id="86cb0-207">**Non-recoverable errors**</span></span> | <span data-ttu-id="86cb0-208">Nie jest podejmowana próba ponowienia.</span><span class="sxs-lookup"><span data-stu-id="86cb0-208">No retry is attempted.</span></span> <span data-ttu-id="86cb0-209">Maszyna wirtualna będzie mieć stan **Krytyczny** i będzie wymagana interwencja administratora.</span><span class="sxs-lookup"><span data-stu-id="86cb0-209">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="86cb0-210">Przykłady te błędy: przerwany łańcuch wirtualnego dysku twardego; Nieprawidłowy stan dla repliki hello wirtualna; Błędy uwierzytelnianie sieciowe: błędy autoryzacji; Maszyna wirtualna nie znaleziono błędy (w przypadku autonomicznych serwerów funkcji Hyper-V)</span><span class="sxs-lookup"><span data-stu-id="86cb0-210">Examples of these errors include: broken VHD chain; Invalid state for hello replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="86cb0-211">**Błędy odwracalne**</span><span class="sxs-lookup"><span data-stu-id="86cb0-211">**Recoverable errors**</span></span> | <span data-ttu-id="86cb0-212">Wykonywane co interwał replikacji, przy użyciu wykładniczej wycofania zwiększającą interwał ponawiania prób powitania od początku hello hello pierwsza próba 1, 2, 4, 8, a następnie 10 minut.</span><span class="sxs-lookup"><span data-stu-id="86cb0-212">Retries occur every replication interval, using an exponential back-off that increases hello retry interval from hello start of hello first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="86cb0-213">Jeśli błąd będzie się powtarzać, ponowne próby będą wykonywane co 30 minut.</span><span class="sxs-lookup"><span data-stu-id="86cb0-213">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="86cb0-214">Są to na przykład błędy sieci, błędy małej ilości miejsca na dysku i warunki małej ilości pamięci</span><span class="sxs-lookup"><span data-stu-id="86cb0-214">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="86cb0-215">Cykl życia ochrony i odzyskiwania</span><span class="sxs-lookup"><span data-stu-id="86cb0-215">Protection and recovery lifecycle</span></span>

![przepływ pracy](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="86cb0-217">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="86cb0-217">Next steps</span></span>

- <span data-ttu-id="86cb0-218">[Check deployment prerequisites](site-recovery-prereq.md) (Sprawdzanie wymagań wstępnych dotyczących wdrożenia)</span><span class="sxs-lookup"><span data-stu-id="86cb0-218">[Check deployment prerequisites](site-recovery-prereq.md)</span></span>
- <span data-ttu-id="86cb0-219">Rozwiązywanie problemów:</span><span class="sxs-lookup"><span data-stu-id="86cb0-219">Troubleshoot with:</span></span>
    - [<span data-ttu-id="86cb0-220">Monitorowanie i rozwiązywanie problemów z ochroną</span><span class="sxs-lookup"><span data-stu-id="86cb0-220">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - <span data-ttu-id="86cb0-221">[Help from Microsoft support](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support) (Pomoc techniczna od firmy Microsoft)</span><span class="sxs-lookup"><span data-stu-id="86cb0-221">[Help from Microsoft support](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)</span></span>
    - <span data-ttu-id="86cb0-222">[Common errors and resolutions](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions) (Typowe błędy i rozwiązania)</span><span class="sxs-lookup"><span data-stu-id="86cb0-222">[Common errors and resolutions](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)</span></span>
