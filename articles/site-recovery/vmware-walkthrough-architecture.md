---
title: Architektura hello aaaReview tooAzure replikacji VMware | Dokumentacja firmy Microsoft
description: "Ten artykuł zawiera omówienie składników i architektury używane podczas replikowania lokalnych maszyn wirtualnych VMware tooAzure z hello usługi Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 7acb1d8e83a846dca79e175fd1af9324f2c31e65
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-vmware-replication-tooazure"></a><span data-ttu-id="eb31b-103">Krok 1: Przejrzyj hello architektura tooAzure replikacji VMware</span><span class="sxs-lookup"><span data-stu-id="eb31b-103">Step 1: Review hello architecture for VMware replication tooAzure</span></span>

<span data-ttu-id="eb31b-104">W tym artykule opisano składniki hello i procesy używane podczas replikowania lokalnych przy użyciu hello tooAzure maszyny wirtualne VMware [usługi Azure Site Recovery](site-recovery-overview.md) usługi.</span><span class="sxs-lookup"><span data-stu-id="eb31b-104">This article describes hello components and processes used when replicating on-premises VMware virtual machines tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="eb31b-105">Opublikuj wszelkie komentarze u dołu hello w tym artykule, lub zadać pytania w hello [Forum usług odzyskiwania Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="eb31b-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="eb31b-106">Składniki architektury</span><span class="sxs-lookup"><span data-stu-id="eb31b-106">Architectural components</span></span>

<span data-ttu-id="eb31b-107">Witaj tabela zawiera podsumowanie hello potrzebnych składników.</span><span class="sxs-lookup"><span data-stu-id="eb31b-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="eb31b-108">**Składnik**</span><span class="sxs-lookup"><span data-stu-id="eb31b-108">**Component**</span></span> | <span data-ttu-id="eb31b-109">**Wymaganie**</span><span class="sxs-lookup"><span data-stu-id="eb31b-109">**Requirement**</span></span> | <span data-ttu-id="eb31b-110">**Szczegóły**</span><span class="sxs-lookup"><span data-stu-id="eb31b-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="eb31b-111">**Azure**</span><span class="sxs-lookup"><span data-stu-id="eb31b-111">**Azure**</span></span> | <span data-ttu-id="eb31b-112">Potrzebujesz subskrypcji platformy Azure, konto usługi Azure storage i sieć platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="eb31b-113">Replikowane dane są przechowywane na koncie magazynu hello.</span><span class="sxs-lookup"><span data-stu-id="eb31b-113">Replicated data is stored in hello storage account.</span></span> <span data-ttu-id="eb31b-114">Maszyny wirtualne platformy Azure są tworzone z danymi hello replikowane czasie pracy awaryjnej z lokacji lokalnej.</span><span class="sxs-lookup"><span data-stu-id="eb31b-114">Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="eb31b-115">Hello maszynach wirtualnych platformy Azure połączyć toohello sieci wirtualnej platformy Azure, gdy są tworzone.</span><span class="sxs-lookup"><span data-stu-id="eb31b-115">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="eb31b-116">**Serwer konfiguracji**</span><span class="sxs-lookup"><span data-stu-id="eb31b-116">**Configuration server**</span></span> | <span data-ttu-id="eb31b-117">Pojedynczy lokalnego serwera zarządzania (maszyna wirtualna oprogramowania VMware) uruchamia wszystkie hello lokalnymi składnikami usługi Site Recovery hello wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="eb31b-117">A single on-premises management server (VMware VM) that runs all hello on-premises Site Recovery components for hello deployment.</span></span> <span data-ttu-id="eb31b-118">Należą do konfiguracji serwera, serwer przetwarzania, główny serwer docelowy.</span><span class="sxs-lookup"><span data-stu-id="eb31b-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="eb31b-119">składnik serwera konfiguracji Hello koordynuje komunikacji między lokalną i platformą Azure i zarządza replikacji danych.</span><span class="sxs-lookup"><span data-stu-id="eb31b-119">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="eb31b-120">**Serwer przetwarzania**:</span><span class="sxs-lookup"><span data-stu-id="eb31b-120">**Process server**:</span></span>  | <span data-ttu-id="eb31b-121">Instalowany domyślnie na powitania serwera konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-121">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="eb31b-122">Działa jako brama replikacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-122">Acts as a replication gateway.</span></span> <span data-ttu-id="eb31b-123">Odbiera dane replikacji, optymalizuje je przy użyciu pamięci podręcznej, kompresji i szyfrowania i wysyła je tooAzure magazynu.</span><span class="sxs-lookup"><span data-stu-id="eb31b-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="eb31b-124">serwer przetwarzania Hello również obsługę instalacji wypychanej hello mobilności usługi tooprotected maszyn i przeprowadza automatyczne odnajdywanie maszyn wirtualnych VMware.</span><span class="sxs-lookup"><span data-stu-id="eb31b-124">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="eb31b-125">Wraz z rozwojem wdrożenia można dodać dodatkowych oddzielnych dedykowanych procesów serwerów toohandle zwiększenie wielkości ruchu replikacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-125">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="eb31b-126">**Główny serwer docelowy**</span><span class="sxs-lookup"><span data-stu-id="eb31b-126">**Master target server**</span></span> | <span data-ttu-id="eb31b-127">Instalowany domyślnie na serwerze konfiguracji lokalne powitania.</span><span class="sxs-lookup"><span data-stu-id="eb31b-127">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="eb31b-128">Służy do obsługi replikacji danych podczas powrotu po awarii z platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="eb31b-129">W przypadku dużego ruchu powrotu po awarii można wdrożyć oddzielny główny serwer docelowy na potrzeby obsługi powrotu po awarii.</span><span class="sxs-lookup"><span data-stu-id="eb31b-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="eb31b-130">**Serwery VMware**</span><span class="sxs-lookup"><span data-stu-id="eb31b-130">**VMware servers**</span></span> | <span data-ttu-id="eb31b-131">Na serwerach ESXi vSphere hostowane są maszyny wirtualne VMware, a firma Microsoft zaleca vCenter server toomanage hello hostów.</span><span class="sxs-lookup"><span data-stu-id="eb31b-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="eb31b-132">Możesz dodać magazyn usług odzyskiwania tooyour serwerów VMware.</span><span class="sxs-lookup"><span data-stu-id="eb31b-132">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="eb31b-133">**Zreplikowane maszyny**</span><span class="sxs-lookup"><span data-stu-id="eb31b-133">**Replicated machines**</span></span> | <span data-ttu-id="eb31b-134">Witaj usługi mobilności zostanie zainstalowana na każdej maszyny Wirtualnej VMware można replikować.</span><span class="sxs-lookup"><span data-stu-id="eb31b-134">hello Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="eb31b-135">Na każdym komputerze lub z instalacją wypychaną z serwera przetwarzania hello może być ręcznie zainstalowana.</span><span class="sxs-lookup"><span data-stu-id="eb31b-135">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="eb31b-136">**Rysunek 1: Składniki tooAzure VMware**</span><span class="sxs-lookup"><span data-stu-id="eb31b-136">**Figure 1: VMware tooAzure components**</span></span>

![Składniki](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="eb31b-138">Proces replikacji</span><span class="sxs-lookup"><span data-stu-id="eb31b-138">Replication process</span></span>

1. <span data-ttu-id="eb31b-139">Należy skonfigurować wdrożenie hello, takie jak lokalnymi i składniki platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-139">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="eb31b-140">W magazynie usług odzyskiwania hello Określ hello replikacji źródłowym i docelowym, skonfiguruj serwer konfiguracji hello, Utwórz zasady replikacji, wdrożyć usługę mobilności hello włączyć replikację i testować tryb failover.</span><span class="sxs-lookup"><span data-stu-id="eb31b-140">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="eb31b-141">Replikacja maszyny, zgodnie z zasadami replikacji hello i początkowej kopii danych hello jest tooAzure replikowanego magazynu.</span><span class="sxs-lookup"><span data-stu-id="eb31b-141">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
3. <span data-ttu-id="eb31b-142">Po zakończeniu replikacji początkowej, rozpoczyna się replikacja tooAzure zmian różnicowych.</span><span class="sxs-lookup"><span data-stu-id="eb31b-142">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="eb31b-143">Śledzone zmiany dla maszyny są przechowywane w pliku hrl.</span><span class="sxs-lookup"><span data-stu-id="eb31b-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="eb31b-144">Replikacji maszyny komunikacji z serwerem konfiguracji hello na porcie 443 protokołu HTTPS dla ruchu przychodzącego dla zarządzania replikacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-144">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="eb31b-145">Replikacji maszyny wysyłania replikacji danych toohello procesu serwera na porcie HTTPS 9443 dla ruchu przychodzącego (może być modyfikowany).</span><span class="sxs-lookup"><span data-stu-id="eb31b-145">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="eb31b-146">Serwer konfiguracji Hello organizuje Zarządzanie replikacją z platformą Azure za pośrednictwem portu HTTPS 443 dla ruchu wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="eb31b-146">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="eb31b-147">serwer przetwarzania Hello odbiera dane z maszyn źródłowych, optymalizuje i szyfruje go i wysyła je tooAzure magazynu za pośrednictwem portu 443 wychodzących.</span><span class="sxs-lookup"><span data-stu-id="eb31b-147">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="eb31b-148">Włączenie spójności wielu maszyn wirtualnych, następnie maszyn w grupie replikacji hello komunikują się ze sobą za pośrednictwem portu 20004.</span><span class="sxs-lookup"><span data-stu-id="eb31b-148">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="eb31b-149">Funkcja spójności wielu maszyn wirtualnych jest używana, jeśli wiele maszyn zostanie połączonych w grupę replikacji, która współużytkuje punkty odzyskiwania spójne na poziomie awarii i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="eb31b-150">Jest to przydatne, jeśli są uruchomione maszyny hello tego samego obciążenia i wymagają toobe spójne.</span><span class="sxs-lookup"><span data-stu-id="eb31b-150">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
4. <span data-ttu-id="eb31b-151">Ruch jest ponad tooAzure replikowanego magazynu publiczne punkty końcowe, hello internet.</span><span class="sxs-lookup"><span data-stu-id="eb31b-151">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="eb31b-152">Alternatywnie można użyć [publicznej komunikacji równorzędnej](../expressroute/expressroute-circuit-peerings.md#public-peering) usługi Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="eb31b-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="eb31b-153">Replikowanie ruchu za pośrednictwem sieci VPN lokacja lokacja z lokalnej lokacji tooAzure nie jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="eb31b-153">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>


<span data-ttu-id="eb31b-154">**Rysunek 2: VMware tooAzure replikacji**</span><span class="sxs-lookup"><span data-stu-id="eb31b-154">**Figure 2: VMware tooAzure replication**</span></span>

![Rozszerzone](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="eb31b-156">Proces pracy w trybie failover i podczas powrotu po awarii</span><span class="sxs-lookup"><span data-stu-id="eb31b-156">Failover and failback process</span></span>

1. <span data-ttu-id="eb31b-157">Po upewnieniu się, że ten test trybu failover działa zgodnie z oczekiwaniami, możesz uruchomić tooAzure niezaplanowanych operacji Failover zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="eb31b-157">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="eb31b-158">Planowane przejście w tryb failover nie jest obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="eb31b-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="eb31b-159">Można przełączyć jednego komputera lub utworzyć [planów odzyskiwania](site-recovery-create-recovery-plans.md), toofail przez wiele maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="eb31b-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="eb31b-160">Po przejściu w tryb failover na platformie Azure zostaną utworzone repliki maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="eb31b-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="eb31b-161">Tryb failover toostart podczas uzyskiwania dostępu do hello obciążenia zatwierdzeniu z hello repliki maszyny Wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-161">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="eb31b-162">Po ponownym udostępnieniu głównej lokacji lokalnej można do niej powrócić po awarii.</span><span class="sxs-lookup"><span data-stu-id="eb31b-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="eb31b-163">Konfigurowanie infrastruktury powrotu po awarii, rozpoczęcia replikacji z głównej toohello lokacji dodatkowej hello hello maszyny i uruchomić nieplanowanego trybu failover z lokacji dodatkowej hello.</span><span class="sxs-lookup"><span data-stu-id="eb31b-163">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="eb31b-164">Po zatwierdzeniu tej pracy awaryjnej, dane będą wstecz lokalnymi i tooAzure replikacji tooenable należy ponownie.</span><span class="sxs-lookup"><span data-stu-id="eb31b-164">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="eb31b-165">Dowiedz się więcej</span><span class="sxs-lookup"><span data-stu-id="eb31b-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="eb31b-166">Istnieje kilka wymagań powrotu po awarii:</span><span class="sxs-lookup"><span data-stu-id="eb31b-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="eb31b-167">**Tymczasowy serwer przetwarzania na platformie Azure**: Jeśli chcesz toofail platformy Azure z po pracy awaryjnej należy tooset zapasowej maszyny Wirtualnej platformy Azure, skonfigurowany jako serwer przetwarzania, toohandle replikacja z platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-167">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="eb31b-168">Po zakończeniu powrotu po awarii można usunąć tę maszynę wirtualną.</span><span class="sxs-lookup"><span data-stu-id="eb31b-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="eb31b-169">**Połączenia sieci VPN**: powrotu po awarii należy połączenie sieci VPN (lub usługa Azure ExpressRoute) skonfiguruj z hello sieć platformy Azure toohello lokalnej lokacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="eb31b-170">**Oddzielny lokalny główny serwer docelowy**: hello lokalny główny serwer docelowy obsługuje powrót po awarii.</span><span class="sxs-lookup"><span data-stu-id="eb31b-170">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="eb31b-171">Hello główny serwer docelowy jest instalowany domyślnie na serwerze zarządzania hello, ale w przypadku powrotu po awarii większych ilości ruchu należy skonfigurować oddzielny lokalny główny serwer docelowy do tego celu.</span><span class="sxs-lookup"><span data-stu-id="eb31b-171">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="eb31b-172">**Zasady powrotu po awarii**: tooyour wstecz tooreplicate lokalnej lokacji, należy zasady powrotu po awarii.</span><span class="sxs-lookup"><span data-stu-id="eb31b-172">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="eb31b-173">Są one tworzone automatycznie podczas tworzenia zasad replikacji.</span><span class="sxs-lookup"><span data-stu-id="eb31b-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="eb31b-174">**Infrastruktura VMware**: musisz powrócić tooan lokalnej maszyny Wirtualnej VMware.</span><span class="sxs-lookup"><span data-stu-id="eb31b-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="eb31b-175">Oznacza to, że należy lokalnej infrastruktury VMware, nawet jeśli replikujesz lokalnych serwerów fizycznych tooAzure.</span><span class="sxs-lookup"><span data-stu-id="eb31b-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="eb31b-176">**Rysunek 3: Powrót po awarii między oprogramowaniem VMware i serwerem fizycznym**</span><span class="sxs-lookup"><span data-stu-id="eb31b-176">**Figure 3: VMware/physical failback**</span></span>

![Powrót po awarii](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="eb31b-178">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="eb31b-178">Next steps</span></span>

<span data-ttu-id="eb31b-179">Przejdź do zbyt[krok 2: Sprawdź wymagania wstępne i ograniczenia](vmware-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="eb31b-179">Go too[Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
