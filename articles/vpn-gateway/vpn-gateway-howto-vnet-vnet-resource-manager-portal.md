---
title: "Łączenie sieci wirtualnej platformy Azure z inną siecią wirtualną: Portal | Microsoft Docs"
description: "Utwórz połączenie usługi bramy VPN Gateway między sieciami wirtualnymi przy użyciu usługi Resource Manager i witryny Azure Portal."
services: vpn-gateway
documentationcenter: na
author: cherylmc
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: a7015cfc-764b-46a1-bfac-043d30a275df
ms.service: vpn-gateway
ms.devlang: na
ms.topic: hero-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/02/2017
ms.author: cherylmc
ms.openlocfilehash: 0293495a9cbdab1fc797d9948e4cbb7759b1ba54
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="configure-a-vnet-to-vnet-vpn-gateway-connection-using-the-azure-portal"></a><span data-ttu-id="bffdb-103">Konfigurowanie połączenia bramy sieci VPN między sieciami wirtualnymi przy użyciu witryny Azure Portal</span><span class="sxs-lookup"><span data-stu-id="bffdb-103">Configure a VNet-to-VNet VPN gateway connection using the Azure portal</span></span>

<span data-ttu-id="bffdb-104">Ten artykuł pokazuje, jak utworzyć połączenie bramy sieci VPN między sieciami wirtualnymi.</span><span class="sxs-lookup"><span data-stu-id="bffdb-104">This article shows you how to create a VPN gateway connection between virtual networks.</span></span> <span data-ttu-id="bffdb-105">Sieci wirtualne mogą być zlokalizowane w tych samych lub różnych regionach i mogą funkcjonować w ramach tej samej lub różnych subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-105">The virtual networks can be in the same or different regions, and from the same or different subscriptions.</span></span> <span data-ttu-id="bffdb-106">W przypadku łączenia sieci wirtualnych z różnych subskrypcji subskrypcje nie muszą być skojarzone z tą samą dzierżawą usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bffdb-106">When connecting VNets from different subscriptions, the subscriptions do not need to be associated with the same Active Directory tenant.</span></span> 

<span data-ttu-id="bffdb-107">Kroki podane w tym artykule mają zastosowanie do modelu wdrażania przy użyciu usługi Resource Manager i użyto w nich witryny Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="bffdb-107">The steps in this article apply to the Resource Manager deployment model and use the Azure portal.</span></span> <span data-ttu-id="bffdb-108">Tę konfigurację możesz również utworzyć przy użyciu innego narzędzia wdrażania lub modelu wdrażania, wybierając inną opcję z następującej listy:</span><span class="sxs-lookup"><span data-stu-id="bffdb-108">You can also create this configuration using a different deployment tool or deployment model by selecting a different option from the following list:</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="bffdb-109">Witryna Azure Portal</span><span class="sxs-lookup"><span data-stu-id="bffdb-109">Azure portal</span></span>](vpn-gateway-howto-vnet-vnet-resource-manager-portal.md)
> * [<span data-ttu-id="bffdb-110">PowerShell</span><span class="sxs-lookup"><span data-stu-id="bffdb-110">PowerShell</span></span>](vpn-gateway-vnet-vnet-rm-ps.md)
> * [<span data-ttu-id="bffdb-111">Interfejs wiersza polecenia platformy Azure</span><span class="sxs-lookup"><span data-stu-id="bffdb-111">Azure CLI</span></span>](vpn-gateway-howto-vnet-vnet-cli.md)
> * [<span data-ttu-id="bffdb-112">Portal Azure (klasyczny)</span><span class="sxs-lookup"><span data-stu-id="bffdb-112">Azure portal (classic)</span></span>](vpn-gateway-howto-vnet-vnet-portal-classic.md)
> * [<span data-ttu-id="bffdb-113">Łączenie różnych modeli wdrażania — witryna Azure Portal</span><span class="sxs-lookup"><span data-stu-id="bffdb-113">Connect different deployment models - Azure portal</span></span>](vpn-gateway-connect-different-deployment-models-portal.md)
> * [<span data-ttu-id="bffdb-114">Łączenie różnych modeli wdrażania — program PowerShell</span><span class="sxs-lookup"><span data-stu-id="bffdb-114">Connect different deployment models - PowerShell</span></span>](vpn-gateway-connect-different-deployment-models-powershell.md)
>
>

![Diagram połączenia między sieciami wirtualnymi (v2v)](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/v2vrmps.png)

<span data-ttu-id="bffdb-116">Proces nawiązywania połączenia między dwiema sieciami wirtualnymi przebiega podobnie do procesu łączenia sieci wirtualnej z lokacją lokalną.</span><span class="sxs-lookup"><span data-stu-id="bffdb-116">Connecting a virtual network to another virtual network (VNet-to-VNet) is similar to connecting a VNet to an on-premises site location.</span></span> <span data-ttu-id="bffdb-117">Oba typy połączeń wykorzystują bramę sieci VPN, aby zapewnić bezpieczny tunel z użyciem protokołu IPsec/IKE.</span><span class="sxs-lookup"><span data-stu-id="bffdb-117">Both connectivity types use a VPN gateway to provide a secure tunnel using IPsec/IKE.</span></span> <span data-ttu-id="bffdb-118">Jeśli Twoje sieci wirtualne znajdują się w tym samym regionie, warto rozważyć połączenie ich za pomocą komunikacji równorzędnej sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="bffdb-118">If your VNets are in the same region, you may want to consider connecting them using VNet Peering.</span></span> <span data-ttu-id="bffdb-119">W przypadku komunikacji równorzędnej sieci wirtualnych nie jest używana brama sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="bffdb-119">VNet peering does not use a VPN gateway.</span></span> <span data-ttu-id="bffdb-120">Aby uzyskać więcej informacji, zobacz temat [Komunikacja równorzędna sieci wirtualnych](../virtual-network/virtual-network-peering-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bffdb-120">For more information, see [VNet peering](../virtual-network/virtual-network-peering-overview.md).</span></span>

<span data-ttu-id="bffdb-121">Komunikację między sieciami wirtualnymi można łączyć z konfiguracjami obejmującymi wiele lokacji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-121">VNet-to-VNet communication can be combined with multi-site configurations.</span></span> <span data-ttu-id="bffdb-122">Pozwala to tworzyć topologie sieci, które łączą wdrożenia obejmujące wiele lokalizacji z połączeniami między sieciami wirtualnymi, jak pokazano na poniższym diagramie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-122">This lets you establish network topologies that combine cross-premises connectivity with inter-virtual network connectivity, as shown in the following diagram:</span></span>

<span data-ttu-id="bffdb-123">![Informacje o połączeniach](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/aboutconnections.png "Informacje o połączeniach")</span><span class="sxs-lookup"><span data-stu-id="bffdb-123">![About connections](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/aboutconnections.png "About connections")</span></span>

### <a name="why-connect-virtual-networks"></a><span data-ttu-id="bffdb-124">Dlaczego łączy się sieci wirtualne?</span><span class="sxs-lookup"><span data-stu-id="bffdb-124">Why connect virtual networks?</span></span>

<span data-ttu-id="bffdb-125">Sieci wirtualne można łączyć z następujących powodów:</span><span class="sxs-lookup"><span data-stu-id="bffdb-125">You may want to connect virtual networks for the following reasons:</span></span>

* <span data-ttu-id="bffdb-126">**Niezależna od regionu nadmiarowość i obecność geograficzna**</span><span class="sxs-lookup"><span data-stu-id="bffdb-126">**Cross region geo-redundancy and geo-presence**</span></span>
  
  * <span data-ttu-id="bffdb-127">Można tworzyć własne replikacje geograficzne lub przeprowadzać synchronizację z bezpiecznym połączeniem bez przechodzenia przez punkty końcowe dostępne z Internetu.</span><span class="sxs-lookup"><span data-stu-id="bffdb-127">You can set up your own geo-replication or synchronization with secure connectivity without going over Internet-facing endpoints.</span></span>
  * <span data-ttu-id="bffdb-128">Usługi Azure Traffic Manager i Load Balancer pozwalają skonfigurować obciążenie o wysokiej dostępności z nadmiarowością geograficzną w wielu regionach świadczenia usługi Azure.</span><span class="sxs-lookup"><span data-stu-id="bffdb-128">With Azure Traffic Manager and Load Balancer, you can set up highly available workload with geo-redundancy across multiple Azure regions.</span></span> <span data-ttu-id="bffdb-129">Istotnym przykładem jest konfiguracja ustawienia SQL Zawsze włączone, w przypadku którego grupy dostępności rozciągają się na wiele regionów świadczenia usługi Azure.</span><span class="sxs-lookup"><span data-stu-id="bffdb-129">One important example is to set up SQL Always On with Availability Groups spreading across multiple Azure regions.</span></span>
* <span data-ttu-id="bffdb-130">**Regionalne aplikacje wielowarstwowe z izolacją lub granicami administracyjnymi**</span><span class="sxs-lookup"><span data-stu-id="bffdb-130">**Regional multi-tier applications with isolation or administrative boundary**</span></span>
  
  * <span data-ttu-id="bffdb-131">W ramach jednego regionu można skonfigurować aplikacje wielowarstwowe z wielu połączonych ze sobą sieci wirtualnych, korzystając z izolacji lub wymagań administracyjnych.</span><span class="sxs-lookup"><span data-stu-id="bffdb-131">Within the same region, you can set up multi-tier applications with multiple virtual networks connected together due to isolation or administrative requirements.</span></span>

<span data-ttu-id="bffdb-132">Więcej informacji na temat połączeń między sieciami wirtualnymi znajduje się w sekcji [Często zadawane pytania dotyczące połączeń między sieciami wirtualnymi](#faq) na końcu tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="bffdb-132">For more information about VNet-to-VNet connections, see the [VNet-to-VNet FAQ](#faq) at the end of this article.</span></span> <span data-ttu-id="bffdb-133">Pamiętaj, że jeśli Twoje sieci wirtualne należą do różnych subskrypcji, to nie można utworzyć połączenia w portalu.</span><span class="sxs-lookup"><span data-stu-id="bffdb-133">Note that if your VNets are in different subscriptions, you can't create the connection in the portal.</span></span> <span data-ttu-id="bffdb-134">Można użyć programu [PowerShell](vpn-gateway-vnet-vnet-rm-ps.md) lub [interfejsu wiersza polecenia](vpn-gateway-howto-vnet-vnet-cli.md).</span><span class="sxs-lookup"><span data-stu-id="bffdb-134">You can use [PowerShell](vpn-gateway-vnet-vnet-rm-ps.md) or [CLI](vpn-gateway-howto-vnet-vnet-cli.md).</span></span>

### <span data-ttu-id="bffdb-135"><a name="values"></a>Przykładowe ustawienia</span><span class="sxs-lookup"><span data-stu-id="bffdb-135"><a name="values"></a>Example settings</span></span>

<span data-ttu-id="bffdb-136">Korzystając z tych kroków w charakterze ćwiczenia, można użyć przykładowych wartości ustawień.</span><span class="sxs-lookup"><span data-stu-id="bffdb-136">When using these steps as an exercise, you can use the example settings values.</span></span> <span data-ttu-id="bffdb-137">W celach demonstracyjnych dla poszczególnych sieci wirtualnych używamy wielu przestrzeni adresowych.</span><span class="sxs-lookup"><span data-stu-id="bffdb-137">For example purposes, we use multiple address spaces for each VNet.</span></span> <span data-ttu-id="bffdb-138">Konfiguracje połączeń między sieciami wirtualnymi nie wymagają jednak wielu przestrzeni adresowych.</span><span class="sxs-lookup"><span data-stu-id="bffdb-138">However, VNet-to-VNet configurations don't require multiple address spaces.</span></span>

<span data-ttu-id="bffdb-139">**Wartości dla sieci TestVNet1:**</span><span class="sxs-lookup"><span data-stu-id="bffdb-139">**Values for TestVNet1:**</span></span>

* <span data-ttu-id="bffdb-140">Nazwa sieci wirtualnej: TestVNet1</span><span class="sxs-lookup"><span data-stu-id="bffdb-140">VNet Name: TestVNet1</span></span>
* <span data-ttu-id="bffdb-141">Przestrzeń adresowa: 10.11.0.0/16</span><span class="sxs-lookup"><span data-stu-id="bffdb-141">Address space: 10.11.0.0/16</span></span>
  * <span data-ttu-id="bffdb-142">Nazwa podsieci: FrontEnd</span><span class="sxs-lookup"><span data-stu-id="bffdb-142">Subnet name: FrontEnd</span></span>
  * <span data-ttu-id="bffdb-143">Zakres adresów podsieci: 10.11.0.0/24</span><span class="sxs-lookup"><span data-stu-id="bffdb-143">Subnet address range: 10.11.0.0/24</span></span>
* <span data-ttu-id="bffdb-144">Grupa zasobów: TestRG1</span><span class="sxs-lookup"><span data-stu-id="bffdb-144">Resource Group: TestRG1</span></span>
* <span data-ttu-id="bffdb-145">Lokalizacja: Wschodnie stany USA</span><span class="sxs-lookup"><span data-stu-id="bffdb-145">Location: East US</span></span>
* <span data-ttu-id="bffdb-146">Przestrzeń adresowa: 10.12.0.0/16</span><span class="sxs-lookup"><span data-stu-id="bffdb-146">Address Space: 10.12.0.0/16</span></span>
  * <span data-ttu-id="bffdb-147">Nazwa podsieci: BackEnd</span><span class="sxs-lookup"><span data-stu-id="bffdb-147">Subnet name: BackEnd</span></span>
  * <span data-ttu-id="bffdb-148">Zakres adresów podsieci: 10.12.0.0/24</span><span class="sxs-lookup"><span data-stu-id="bffdb-148">Subnet address range: 10.12.0.0/24</span></span>
* <span data-ttu-id="bffdb-149">Nazwa podsieci bramy: GatewaySubnet (zostanie automatycznie wypełniona w portalu)</span><span class="sxs-lookup"><span data-stu-id="bffdb-149">Gateway Subnet name: GatewaySubnet (this will auto-fill in the portal)</span></span>
  * <span data-ttu-id="bffdb-150">Zakres adresów podsieci bramy: 10.11.255.0/27</span><span class="sxs-lookup"><span data-stu-id="bffdb-150">Gateway Subnet address range: 10.11.255.0/27</span></span>
* <span data-ttu-id="bffdb-151">Serwer DNS: użyj adresu IP serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="bffdb-151">DNS Server: Use the IP address of your DNS Server</span></span>
* <span data-ttu-id="bffdb-152">Nazwa bramy sieci wirtualnej: TestVNet1GW</span><span class="sxs-lookup"><span data-stu-id="bffdb-152">Virtual Network Gateway Name: TestVNet1GW</span></span>
* <span data-ttu-id="bffdb-153">Typ bramy: VPN</span><span class="sxs-lookup"><span data-stu-id="bffdb-153">Gateway Type: VPN</span></span>
* <span data-ttu-id="bffdb-154">Typ sieci VPN: oparta na trasach</span><span class="sxs-lookup"><span data-stu-id="bffdb-154">VPN type: Route-based</span></span>
* <span data-ttu-id="bffdb-155">Jednostka SKU: wybierz jednostkę SKU bramy, która ma być używana.</span><span class="sxs-lookup"><span data-stu-id="bffdb-155">SKU: Select the Gateway SKU you want to use</span></span>
* <span data-ttu-id="bffdb-156">Publiczna nazwa adresu IP: TestVNet1GWIP</span><span class="sxs-lookup"><span data-stu-id="bffdb-156">Public IP address name: TestVNet1GWIP</span></span>
* <span data-ttu-id="bffdb-157">Wartości połączenia:</span><span class="sxs-lookup"><span data-stu-id="bffdb-157">Connection values:</span></span>
  * <span data-ttu-id="bffdb-158">Nazwa: TestVNet1toTestVNet4</span><span class="sxs-lookup"><span data-stu-id="bffdb-158">Name: TestVNet1toTestVNet4</span></span>
  * <span data-ttu-id="bffdb-159">Klucz współużytkowany: klucz współużytkowany można utworzyć samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-159">Shared key: You can create the shared key yourself.</span></span> <span data-ttu-id="bffdb-160">W tym przykładzie użyjemy wartości abc123.</span><span class="sxs-lookup"><span data-stu-id="bffdb-160">For this example, we'll use abc123.</span></span> <span data-ttu-id="bffdb-161">Ważne jest, aby podczas tworzenia połączenia między sieciami wirtualnymi, wartości były zgodne.</span><span class="sxs-lookup"><span data-stu-id="bffdb-161">The important thing is that when you create the connection between the VNets, the value must match.</span></span>

<span data-ttu-id="bffdb-162">**Wartości dla sieci TestVNet4:**</span><span class="sxs-lookup"><span data-stu-id="bffdb-162">**Values for TestVNet4:**</span></span>

* <span data-ttu-id="bffdb-163">Nazwa sieci wirtualnej: TestVNet4</span><span class="sxs-lookup"><span data-stu-id="bffdb-163">VNet Name: TestVNet4</span></span>
* <span data-ttu-id="bffdb-164">Przestrzeń adresowa: 10.41.0.0/16</span><span class="sxs-lookup"><span data-stu-id="bffdb-164">Address space: 10.41.0.0/16</span></span>
  * <span data-ttu-id="bffdb-165">Nazwa podsieci: FrontEnd</span><span class="sxs-lookup"><span data-stu-id="bffdb-165">Subnet name: FrontEnd</span></span>
  * <span data-ttu-id="bffdb-166">Zakres adresów podsieci: 10.41.0.0/24</span><span class="sxs-lookup"><span data-stu-id="bffdb-166">Subnet address range: 10.41.0.0/24</span></span>
* <span data-ttu-id="bffdb-167">Grupa zasobów: TestRG1</span><span class="sxs-lookup"><span data-stu-id="bffdb-167">Resource Group: TestRG1</span></span>
* <span data-ttu-id="bffdb-168">Lokalizacja: West US</span><span class="sxs-lookup"><span data-stu-id="bffdb-168">Location: West US</span></span>
* <span data-ttu-id="bffdb-169">Przestrzeń adresowa: 10.42.0.0/16</span><span class="sxs-lookup"><span data-stu-id="bffdb-169">Address Space: 10.42.0.0/16</span></span>
  * <span data-ttu-id="bffdb-170">Nazwa podsieci: BackEnd</span><span class="sxs-lookup"><span data-stu-id="bffdb-170">Subnet name: BackEnd</span></span>
  * <span data-ttu-id="bffdb-171">Zakres adresów podsieci: 10.42.0.0/24</span><span class="sxs-lookup"><span data-stu-id="bffdb-171">Subnet address range: 10.42.0.0/24</span></span>
* <span data-ttu-id="bffdb-172">Nazwa podsieci bramy: GatewaySubnet (zostanie automatycznie wypełniona w portalu)</span><span class="sxs-lookup"><span data-stu-id="bffdb-172">GatewaySubnet name: GatewaySubnet (this will auto-fill in the portal)</span></span>
  * <span data-ttu-id="bffdb-173">Zakres adresów podsieci GatewaySubnet: 10.41.255.0/27</span><span class="sxs-lookup"><span data-stu-id="bffdb-173">GatewaySubnet address range: 10.41.255.0/27</span></span>
* <span data-ttu-id="bffdb-174">Serwer DNS: użyj adresu IP serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="bffdb-174">DNS Server: Use the IP address of your DNS Server</span></span>
* <span data-ttu-id="bffdb-175">Nazwa bramy sieci wirtualnej: TestVNet4GW</span><span class="sxs-lookup"><span data-stu-id="bffdb-175">Virtual Network Gateway Name: TestVNet4GW</span></span>
* <span data-ttu-id="bffdb-176">Typ bramy: VPN</span><span class="sxs-lookup"><span data-stu-id="bffdb-176">Gateway Type: VPN</span></span>
* <span data-ttu-id="bffdb-177">Typ sieci VPN: oparta na trasach</span><span class="sxs-lookup"><span data-stu-id="bffdb-177">VPN type: Route-based</span></span>
* <span data-ttu-id="bffdb-178">Jednostka SKU: wybierz jednostkę SKU bramy, która ma być używana.</span><span class="sxs-lookup"><span data-stu-id="bffdb-178">SKU: Select the Gateway SKU you want to use</span></span>
* <span data-ttu-id="bffdb-179">Nazwa publicznego adresu IP: TestVNet4GWIP</span><span class="sxs-lookup"><span data-stu-id="bffdb-179">Public IP address name: TestVNet4GWIP</span></span>
* <span data-ttu-id="bffdb-180">Wartości połączenia:</span><span class="sxs-lookup"><span data-stu-id="bffdb-180">Connection values:</span></span>
  * <span data-ttu-id="bffdb-181">Nazwa: TestVNet4toTestVNet1</span><span class="sxs-lookup"><span data-stu-id="bffdb-181">Name: TestVNet4toTestVNet1</span></span>
  * <span data-ttu-id="bffdb-182">Klucz współużytkowany: klucz współużytkowany można utworzyć samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-182">Shared key: You can create the shared key yourself.</span></span> <span data-ttu-id="bffdb-183">W tym przykładzie użyjemy wartości abc123.</span><span class="sxs-lookup"><span data-stu-id="bffdb-183">For this example, we'll use abc123.</span></span> <span data-ttu-id="bffdb-184">Ważne jest, aby podczas tworzenia połączenia między sieciami wirtualnymi, wartości były zgodne.</span><span class="sxs-lookup"><span data-stu-id="bffdb-184">The important thing is that when you create the connection between the VNets, the value must match.</span></span>

## <span data-ttu-id="bffdb-185"><a name="CreatVNet"></a>1. Tworzenie i konfigurowanie sieci TestVNet1</span><span class="sxs-lookup"><span data-stu-id="bffdb-185"><a name="CreatVNet"></a>1. Create and configure TestVNet1</span></span>
<span data-ttu-id="bffdb-186">Jeśli masz już sieć wirtualną, sprawdź, czy ustawienia są zgodne z projektem bramy sieci VPN.</span><span class="sxs-lookup"><span data-stu-id="bffdb-186">If you already have a VNet, verify that the settings are compatible with your VPN gateway design.</span></span> <span data-ttu-id="bffdb-187">Zwróć szczególną uwagę na wszelkie podsieci, które mogą pokrywać się z innymi sieciami.</span><span class="sxs-lookup"><span data-stu-id="bffdb-187">Pay particular attention to any subnets that may overlap with other networks.</span></span> <span data-ttu-id="bffdb-188">Obecność nakładających się podsieci spowoduje, że połączenie nie będzie działać prawidłowo.</span><span class="sxs-lookup"><span data-stu-id="bffdb-188">If you have overlapping subnets, your connection won't work properly.</span></span> <span data-ttu-id="bffdb-189">Jeśli sieć wirtualną skonfigurowano poprawnie, można rozpocząć wykonywanie kroków z sekcji [Określanie serwera DNS](#dns).</span><span class="sxs-lookup"><span data-stu-id="bffdb-189">If your VNet is configured with the correct settings, you can begin the steps in the [Specify a DNS server](#dns) section.</span></span>

### <a name="to-create-a-virtual-network"></a><span data-ttu-id="bffdb-190">Aby utworzyć sieć wirtualną</span><span class="sxs-lookup"><span data-stu-id="bffdb-190">To create a virtual network</span></span>
[!INCLUDE [vpn-gateway-basic-vnet-rm-portal](../../includes/vpn-gateway-basic-vnet-rm-portal-include.md)]

## <span data-ttu-id="bffdb-191"><a name="subnets"></a>2. Dodawanie dodatkowej przestrzeni adresowej i tworzenie podsieci</span><span class="sxs-lookup"><span data-stu-id="bffdb-191"><a name="subnets"></a>2. Add additional address space and create subnets</span></span>
<span data-ttu-id="bffdb-192">Po utworzeniu sieci wirtualnej można dodać do niej dodatkową przestrzeń adresową oraz utworzyć podsieci.</span><span class="sxs-lookup"><span data-stu-id="bffdb-192">You can add additional address space and create subnets once your VNet has been created.</span></span>

[!INCLUDE [vpn-gateway-additional-address-space](../../includes/vpn-gateway-additional-address-space-include.md)]

## <span data-ttu-id="bffdb-193"><a name="gatewaysubnet"></a>3. Tworzenie podsieci bramy</span><span class="sxs-lookup"><span data-stu-id="bffdb-193"><a name="gatewaysubnet"></a>3. Create a gateway subnet</span></span>
<span data-ttu-id="bffdb-194">Przed połączeniem sieci wirtualnej z bramą należy najpierw utworzyć podsieć bramy sieci wirtualnej, z którą ma zostać nawiązane połączenie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-194">Before connecting your virtual network to a gateway, you first need to create the gateway subnet for the virtual network to which you want to connect.</span></span> <span data-ttu-id="bffdb-195">Jeśli to możliwe, najlepiej utworzyć podsieć bramy przy użyciu bloku CIDR /28 lub /27 w celu zapewnienia wystarczającej liczby adresów IP, aby uwzględnić wymagania dotyczące dodatkowych przyszłych konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-195">If possible, it's best to create a gateway subnet using a CIDR block of /28 or /27 in order to provide enough IP addresses to accommodate additional future configuration requirements.</span></span>

<span data-ttu-id="bffdb-196">Jeśli tworzysz tę konfigurację w ramach ćwiczenia, użyj [przykładowych ustawień](#values) podczas tworzenia podsieci bramy.</span><span class="sxs-lookup"><span data-stu-id="bffdb-196">If you are creating this configuration as an exercise, refer to these [Example settings](#values) when creating your gateway subnet.</span></span>

[!INCLUDE [vpn-gateway-no-nsg](../../includes/vpn-gateway-no-nsg-include.md)]

### <a name="to-create-a-gateway-subnet"></a><span data-ttu-id="bffdb-197">Aby utworzyć podsieć bramy</span><span class="sxs-lookup"><span data-stu-id="bffdb-197">To create a gateway subnet</span></span>
[!INCLUDE [vpn-gateway-add-gwsubnet-rm-portal](../../includes/vpn-gateway-add-gwsubnet-rm-portal-include.md)]

## <span data-ttu-id="bffdb-198"><a name="dns"></a>4. Określanie serwera DNS (opcjonalne)</span><span class="sxs-lookup"><span data-stu-id="bffdb-198"><a name="dns"></a>4. Specify a DNS server (optional)</span></span>
<span data-ttu-id="bffdb-199">Serwer DNS nie jest wymagany w przypadku połączenia typu sieć wirtualna-sieć wirtualna.</span><span class="sxs-lookup"><span data-stu-id="bffdb-199">DNS is not required for VNet-to-VNet connections.</span></span> <span data-ttu-id="bffdb-200">Jeśli jednak chcesz korzystać z funkcji rozpoznawania nazw dla zasobów, które zostały wdrożone w Twojej sieci wirtualnej, określ serwer DNS.</span><span class="sxs-lookup"><span data-stu-id="bffdb-200">However, if you want to have name resolution for resources that are deployed to your virtual network, you should specify a DNS server.</span></span> <span data-ttu-id="bffdb-201">To ustawienie umożliwia określenie serwera DNS, który ma być używany do rozpoznawania nazw dla tej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-201">This setting lets you specify the DNS server that you want to use for name resolution for this virtual network.</span></span> <span data-ttu-id="bffdb-202">Nie powoduje ono jednak utworzenia serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="bffdb-202">It does not create a DNS server.</span></span>

[!INCLUDE [vpn-gateway-add-dns-rm-portal](../../includes/vpn-gateway-add-dns-rm-portal-include.md)]

## <span data-ttu-id="bffdb-203"><a name="VNetGateway"></a>5. Tworzenie bramy sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="bffdb-203"><a name="VNetGateway"></a>5. Create a virtual network gateway</span></span>
<span data-ttu-id="bffdb-204">W tym kroku zostaje utworzona brama dla sieci wirtualnej użytkownika.</span><span class="sxs-lookup"><span data-stu-id="bffdb-204">In this step, you create the virtual network gateway for your VNet.</span></span> <span data-ttu-id="bffdb-205">Tworzenie bramy często może trwać 45 minut lub dłużej, w zależności od wybranej jednostki SKU bramy.</span><span class="sxs-lookup"><span data-stu-id="bffdb-205">Creating a gateway can often take 45 minutes or more, depending on the selected gateway SKU.</span></span> <span data-ttu-id="bffdb-206">W przypadku tworzenia tej konfiguracji w ramach ćwiczenia można korzystać z [przykładowych ustawień](#values).</span><span class="sxs-lookup"><span data-stu-id="bffdb-206">If you are creating this configuration as an exercise, you can refer to the [Example settings](#values).</span></span>

### <a name="to-create-a-virtual-network-gateway"></a><span data-ttu-id="bffdb-207">Aby utworzyć bramę sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="bffdb-207">To create a virtual network gateway</span></span>
[!INCLUDE [vpn-gateway-add-gw-rm-portal](../../includes/vpn-gateway-add-gw-rm-portal-include.md)]

## <span data-ttu-id="bffdb-208"><a name="CreateTestVNet4"></a>6. Tworzenie i konfigurowanie sieci TestVNet4</span><span class="sxs-lookup"><span data-stu-id="bffdb-208"><a name="CreateTestVNet4"></a>6. Create and configure TestVNet4</span></span>
<span data-ttu-id="bffdb-209">Po skonfigurowaniu sieci TestVNet1 utwórz sieć TestVNet4, powtarzając poprzednie kroki, używając wartości dla sieci TestVNet4.</span><span class="sxs-lookup"><span data-stu-id="bffdb-209">Once you've configured TestVNet1, create TestVNet4 by repeating the previous steps, replacing the values with those of TestVNet4.</span></span> <span data-ttu-id="bffdb-210">Przed skonfigurowaniem sieci TestVNet4 nie musisz czekać, aż tworzenie bramy sieci wirtualnej dla sieci TestVNet1 zostanie zakończone.</span><span class="sxs-lookup"><span data-stu-id="bffdb-210">You don't need to wait until the virtual network gateway for TestVNet1 has finished creating before configuring TestVNet4.</span></span> <span data-ttu-id="bffdb-211">Jeśli używasz własnych wartości, upewnij się, że przestrzenie adresowe nie pokrywają się z żadnymi sieciami wirtualnymi, z którymi chcesz się połączyć.</span><span class="sxs-lookup"><span data-stu-id="bffdb-211">If you are using your own values, make sure that the address spaces don't overlap with any of the VNets that you want to connect to.</span></span>

## <span data-ttu-id="bffdb-212"><a name="TestVNet1Connection"></a>7. Konfigurowanie połączenia TestVNet1</span><span class="sxs-lookup"><span data-stu-id="bffdb-212"><a name="TestVNet1Connection"></a>7. Configure the TestVNet1 connection</span></span>
<span data-ttu-id="bffdb-213">Po zakończeniu tworzenia bram sieci wirtualnej (zarówno dla sieci TestVNet1, jak i TestVNet4) można utworzyć połączenia między bramami sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="bffdb-213">When the virtual network gateways for both TestVNet1 and TestVNet4 have completed, you can create your virtual network gateway connections.</span></span> <span data-ttu-id="bffdb-214">W tej sekcji opisano tworzenie połączenia z sieci VNet1 do sieci VNet4.</span><span class="sxs-lookup"><span data-stu-id="bffdb-214">In this section, you will create a connection from VNet1 to VNet4.</span></span> <span data-ttu-id="bffdb-215">Następujące kroki działają tylko w przypadku sieci wirtualnych należących do tej samej subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-215">These steps work only for VNets in the same subscription.</span></span> <span data-ttu-id="bffdb-216">Jeśli Twoje sieci wirtualne znajdują się w różnych subskrypcjach, do utworzenia połączenia musisz użyć programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bffdb-216">If your VNets are in different subscriptions, you must use PowerShell to make the connection.</span></span> <span data-ttu-id="bffdb-217">Zobacz artykuł [PowerShell](vpn-gateway-vnet-vnet-rm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="bffdb-217">See the [PowerShell](vpn-gateway-vnet-vnet-rm-ps.md) article.</span></span>

1. <span data-ttu-id="bffdb-218">W sekcji **Wszystkie zasoby** przejdź do bramy swojej sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="bffdb-218">In **All resources**, navigate to the virtual network gateway for your VNet.</span></span> <span data-ttu-id="bffdb-219">(np. **TestVNet1GW**).</span><span class="sxs-lookup"><span data-stu-id="bffdb-219">For example, **TestVNet1GW**.</span></span> <span data-ttu-id="bffdb-220">Kliknij pozycję **TestVNet1GW**, aby otworzyć blok bramy sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-220">Click **TestVNet1GW** to open the virtual network gateway blade.</span></span>
   
    <span data-ttu-id="bffdb-221">![Blok połączeń](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/settings_connection.png "Blok połączeń")</span><span class="sxs-lookup"><span data-stu-id="bffdb-221">![Connections blade](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/settings_connection.png "Connections blade")</span></span>
2. <span data-ttu-id="bffdb-222">Kliknij przycisk **+Dodaj**, aby otworzyć blok **Dodaj połączenie**.</span><span class="sxs-lookup"><span data-stu-id="bffdb-222">Click **+Add** to open the **Add connection** blade.</span></span>
3. <span data-ttu-id="bffdb-223">W bloku **Dodaj połączenie** wpisz nazwę połączenia w polu nazwy</span><span class="sxs-lookup"><span data-stu-id="bffdb-223">On the **Add connection** blade, in the name field, type a name for your connection.</span></span> <span data-ttu-id="bffdb-224">(np. **TestVNet1toTestVNet4**).</span><span class="sxs-lookup"><span data-stu-id="bffdb-224">For example, **TestVNet1toTestVNet4**.</span></span>
   
    <span data-ttu-id="bffdb-225">![Nazwa połączenia](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/v1tov4.png "Nazwa połączenia")</span><span class="sxs-lookup"><span data-stu-id="bffdb-225">![Connection name](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/v1tov4.png "Connection name")</span></span>
4. <span data-ttu-id="bffdb-226">Dla opcji **Typ połączenia**</span><span class="sxs-lookup"><span data-stu-id="bffdb-226">For **Connection type**.</span></span> <span data-ttu-id="bffdb-227">wybierz z listy rozwijanej pozycję **Sieć wirtualna-sieć wirtualna**.</span><span class="sxs-lookup"><span data-stu-id="bffdb-227">select **VNet-to-VNet** from the dropdown.</span></span>
5. <span data-ttu-id="bffdb-228">Wartość pola **Pierwsza brama sieci wirtualnej** zostaje podana automatycznie, ponieważ połączenie jest tworzone z określonej bramy sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-228">The **First virtual network gateway** field value is automatically filled in because you are creating this connection from the specified virtual network gateway.</span></span>
6. <span data-ttu-id="bffdb-229">Pole **Druga brama sieci wirtualnej** jest bramą sieci wirtualnej sieci wirtualnej, z którą chcesz utworzyć połączenie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-229">The **Second virtual network gateway** field is the virtual network gateway of the VNet that you want to create a connection to.</span></span> <span data-ttu-id="bffdb-230">Kliknij pozycję **Wybierz inną bramę sieci wirtualnej**, aby otworzyć blok **Wybieranie bramy sieci wirtualnej**.</span><span class="sxs-lookup"><span data-stu-id="bffdb-230">Click **Choose another virtual network gateway** to open the **Choose virtual network gateway** blade.</span></span>
   
    <span data-ttu-id="bffdb-231">![Dodawanie połączenia](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/add_connection.png "Dodawanie połączenia")</span><span class="sxs-lookup"><span data-stu-id="bffdb-231">![Add connection](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/add_connection.png "Add a connection")</span></span>
7. <span data-ttu-id="bffdb-232">Wyświetl bramy sieci wirtualnej wymienione w tym bloku.</span><span class="sxs-lookup"><span data-stu-id="bffdb-232">View the virtual network gateways that are listed on this blade.</span></span> <span data-ttu-id="bffdb-233">Pamiętaj, że wyświetlane są tylko bramy sieci wirtualnej objęte subskrypcją.</span><span class="sxs-lookup"><span data-stu-id="bffdb-233">Notice that only virtual network gateways that are in your subscription are listed.</span></span> <span data-ttu-id="bffdb-234">Jeśli chcesz połączyć się z bramą sieci wirtualnej, której nie ma w Twojej subskrypcji, zapoznaj się z [artykułem dotyczącym programu PowerShell](vpn-gateway-vnet-vnet-rm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="bffdb-234">If you want to connect to a virtual network gateway that is not in your subscription, please use the [PowerShell article](vpn-gateway-vnet-vnet-rm-ps.md).</span></span> 
8. <span data-ttu-id="bffdb-235">Kliknij bramę sieci wirtualnej, z którą chcesz nawiązać połączenie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-235">Click the virtual network gateway that you want to connect to.</span></span>
9. <span data-ttu-id="bffdb-236">W polu **Klucz współużytkowany** wpisz klucz, który będzie używany dla tego połączenia.</span><span class="sxs-lookup"><span data-stu-id="bffdb-236">In the **Shared key** field, type a shared key for your connection.</span></span> <span data-ttu-id="bffdb-237">Klucz można wygenerować lub utworzyć samodzielnie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-237">You can generate or create this key yourself.</span></span> <span data-ttu-id="bffdb-238">W przypadku połączenia lokacja-lokacja używany klucz jest dokładnie taki sam dla urządzenia lokalnego oraz połączenia bramy sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-238">In a site-to-site connection, the key you use would be exactly the same for your on-premises device and your virtual network gateway connection.</span></span> <span data-ttu-id="bffdb-239">Koncepcja jest tutaj podobna, z tym że zamiast połączenia z urządzeniem sieci VPN następuje połączenie z inną bramą sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-239">The concept is similar here, except that rather than connecting to a VPN device, you are connecting to another virtual network gateway.</span></span>
   
    <span data-ttu-id="bffdb-240">![Klucz współużytkowany](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/sharedkey.png "Klucz współużytkowany")</span><span class="sxs-lookup"><span data-stu-id="bffdb-240">![Shared key](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/sharedkey.png "Shared key")</span></span>
10. <span data-ttu-id="bffdb-241">Kliknij przycisk **OK** na dole bloku, aby zapisać zmiany.</span><span class="sxs-lookup"><span data-stu-id="bffdb-241">Click **OK** at the bottom of the blade to save your changes.</span></span>

## <span data-ttu-id="bffdb-242"><a name="TestVNet4Connection"></a>8. Konfigurowanie połączenia z siecią TestVNet4</span><span class="sxs-lookup"><span data-stu-id="bffdb-242"><a name="TestVNet4Connection"></a>8. Configure the TestVNet4 connection</span></span>
<span data-ttu-id="bffdb-243">Następnie utwórz połączenie z sieci TestVNet4 do sieci TestVNet1.</span><span class="sxs-lookup"><span data-stu-id="bffdb-243">Next, create a connection from TestVNet4 to TestVNet1.</span></span> <span data-ttu-id="bffdb-244">Zastosuj tę samą metodę, która została użyta do utworzenia połączenia z sieci TestVNet1 do sieci TestVNet4.</span><span class="sxs-lookup"><span data-stu-id="bffdb-244">Use the same method that you used to create the connection from TestVNet1 to TestVNet4.</span></span> <span data-ttu-id="bffdb-245">Pamiętaj, aby użyć tego samego klucza współużytkowanego.</span><span class="sxs-lookup"><span data-stu-id="bffdb-245">Make sure that you use the same shared key.</span></span>

## <span data-ttu-id="bffdb-246"><a name="VerifyConnection"></a>9. Weryfikowanie połączenia</span><span class="sxs-lookup"><span data-stu-id="bffdb-246"><a name="VerifyConnection"></a>9. Verify your connection</span></span>
<span data-ttu-id="bffdb-247">Zweryfikuj połączenie.</span><span class="sxs-lookup"><span data-stu-id="bffdb-247">Verify the connection.</span></span> <span data-ttu-id="bffdb-248">Dla każdej bramy sieci wirtualnej wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="bffdb-248">For each virtual network gateway, do the following:</span></span>

1. <span data-ttu-id="bffdb-249">Znajdź blok bramy sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="bffdb-249">Locate the blade for the virtual network gateway.</span></span> <span data-ttu-id="bffdb-250">(np. **TestVNet4GW**).</span><span class="sxs-lookup"><span data-stu-id="bffdb-250">For example, **TestVNet4GW**.</span></span> 
2. <span data-ttu-id="bffdb-251">W bloku bramy sieci wirtualnej kliknij opcję **Połączenia**, aby wyświetlić blok połączeń bramy sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="bffdb-251">On the virtual network gateway blade, click **Connections** to view the connections blade for the virtual network gateway.</span></span>

<span data-ttu-id="bffdb-252">Wyświetl połączenia i zweryfikuj stan.</span><span class="sxs-lookup"><span data-stu-id="bffdb-252">View the connections and verify the status.</span></span> <span data-ttu-id="bffdb-253">Po utworzeniu połączenia zostanie wyświetlony stan z wartościami **Powodzenie** i **Połączono**.</span><span class="sxs-lookup"><span data-stu-id="bffdb-253">Once the connection is created, you will see **Succeeded** and **Connected** as the Status values.</span></span>

<span data-ttu-id="bffdb-254">![Powodzenie](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/connected.png "Powodzenie")</span><span class="sxs-lookup"><span data-stu-id="bffdb-254">![Succeeded](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/connected.png "Succeeded")</span></span>

<span data-ttu-id="bffdb-255">Możesz kliknąć dwukrotnie każde połączenie, aby wyświetlić więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-255">You can double-click each connection separately to view more information about the connection.</span></span>

<span data-ttu-id="bffdb-256">![Podstawy](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/essentials.png "Podstawy")</span><span class="sxs-lookup"><span data-stu-id="bffdb-256">![Essentials](./media/vpn-gateway-howto-vnet-vnet-resource-manager-portal/essentials.png "Essentials")</span></span>

## <span data-ttu-id="bffdb-257"><a name="faq"></a>Często zadawane pytania dotyczące połączeń między sieciami wirtualnymi</span><span class="sxs-lookup"><span data-stu-id="bffdb-257"><a name="faq"></a>VNet-to-VNet FAQ</span></span>
<span data-ttu-id="bffdb-258">Ta sekcja zawiera odpowiedzi na często zadawane pytań dotyczące połączeń między sieciami wirtualnymi.</span><span class="sxs-lookup"><span data-stu-id="bffdb-258">View the FAQ details for additional information about VNet-to-VNet connections.</span></span>

[!INCLUDE [vpn-gateway-vnet-vnet-faq](../../includes/vpn-gateway-vnet-vnet-faq-include.md)]

## <a name="next-steps"></a><span data-ttu-id="bffdb-259">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="bffdb-259">Next steps</span></span>
<span data-ttu-id="bffdb-260">Po zakończeniu procesu nawiązywania połączenia można dodać do sieci wirtualnych maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="bffdb-260">Once your connection is complete, you can add virtual machines to your virtual networks.</span></span> <span data-ttu-id="bffdb-261">Zobacz [dokumentację dotyczącą maszyn wirtualnych](https://docs.microsoft.com/azure/#pivot=services&panel=Compute), aby uzyskać więcej informacji.</span><span class="sxs-lookup"><span data-stu-id="bffdb-261">See the [Virtual Machines documentation](https://docs.microsoft.com/azure/#pivot=services&panel=Compute) for more information.</span></span>
