---
title: "Partycjonowanie i skalowanie w poziomie w usłudze Azure DB rozwiązania Cosmos | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat działa jak partycjonowania bazy danych rozwiązania Cosmos Azure, jak skonfigurować partycje i kluczy partycji i Wybieranie klucza prawego partycji aplikacji."
services: cosmos-db
author: arramac
manager: jhubbard
editor: monicar
documentationcenter: 
ms.assetid: cac9a8cd-b5a3-4827-8505-d40bb61b2416
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: arramac
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: e2d2847276e553d7511241ff323c3e00aad8e5c9
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/03/2017
---
# <a name="how-to-partition-and-scale-in-azure-cosmos-db"></a><span data-ttu-id="fea4c-103">Jak partycji i skali w usłudze Azure DB rozwiązania Cosmos</span><span class="sxs-lookup"><span data-stu-id="fea4c-103">How to partition and scale in Azure Cosmos DB</span></span>

<span data-ttu-id="fea4c-104">[Bazy danych programu Microsoft Azure rozwiązania Cosmos](https://azure.microsoft.com/services/cosmos-db/) jest usługą bazy danych globalnych, rozproszone i wiele modeli pomaga osiągnąć szybkie, przewidywalną wydajność i skalę bezproblemowo wraz z aplikacji jako ich przyrostu.</span><span class="sxs-lookup"><span data-stu-id="fea4c-104">[Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is a global distributed, multi-model database service designed to help you achieve fast, predictable performance and scale seamlessly along with your application as it grows.</span></span> <span data-ttu-id="fea4c-105">Ten artykuł zawiera omówienie sposobu partycjonowania działa dla wszystkich modeli danych w usłudze Azure DB rozwiązania Cosmos i w tym artykule opisano, jak można skonfigurować bazy danych Azure rozwiązania Cosmos kontenery skutecznie skalowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-105">This article provides an overview of how partitioning works for all the data models in Azure Cosmos DB, and describes how you can configure Azure Cosmos DB containers to effectively scale your applications.</span></span>

<span data-ttu-id="fea4c-106">Partycjonowanie i klucze partycji są uwzględniane w tym Azure piątek wideo z Scott Hanselman i Azure rozwiązania Cosmos DB główny Engineering Menedżer Shireesh Thota.</span><span class="sxs-lookup"><span data-stu-id="fea4c-106">Partitioning and partition keys are also covered in this Azure Friday video with Scott Hanselman and Azure Cosmos DB Principal Engineering Manager, Shireesh Thota.</span></span>

> [!VIDEO https://channel9.msdn.com/Shows/Azure-Friday/Azure-DocumentDB-Elastic-Scale-Partitioning/player]
> 

## <a name="partitioning-in-azure-cosmos-db"></a><span data-ttu-id="fea4c-107">Podział na partycje w Azure rozwiązania Cosmos bazy danych</span><span class="sxs-lookup"><span data-stu-id="fea4c-107">Partitioning in Azure Cosmos DB</span></span>
<span data-ttu-id="fea4c-108">W usłudze Azure DB rozwiązania Cosmos można przechowywać i zapytania na danych bez schematu wraz z czasem odpowiedzi kolejności z milisekundy na dowolnym poziomie.</span><span class="sxs-lookup"><span data-stu-id="fea4c-108">In Azure Cosmos DB, you can store and query schema-less data with order-of-millisecond response times at any scale.</span></span> <span data-ttu-id="fea4c-109">Rozwiązania cosmos DB zawiera kontenery do przechowywania danych o nazwie **kolekcje (dla dokumentu), wykresy lub tabele**.</span><span class="sxs-lookup"><span data-stu-id="fea4c-109">Cosmos DB provides containers for storing data called **collections (for document), graphs, or tables**.</span></span> <span data-ttu-id="fea4c-110">Kontenery są zasoby logiczne i może obejmować co najmniej jednej partycji fizycznej lub serwerów.</span><span class="sxs-lookup"><span data-stu-id="fea4c-110">Containers are logical resources and can span one or more physical partitions or servers.</span></span> <span data-ttu-id="fea4c-111">Liczba partycji zależy od rozwiązania Cosmos bazy danych na podstawie rozmiaru magazynu i udostępnionej przepływności kontenera.</span><span class="sxs-lookup"><span data-stu-id="fea4c-111">The number of partitions is determined by Cosmos DB based on the storage size and the provisioned throughput of the container.</span></span> <span data-ttu-id="fea4c-112">Każdej partycji w bazie danych rozwiązania Cosmos ma stałą kopie dysków SSD magazynu skojarzone z nim i są replikowane w celu zapewnienia wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="fea4c-112">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span></span> <span data-ttu-id="fea4c-113">Zarządzanie partycji pełni zarządza bazy danych Azure rozwiązania Cosmos i nie trzeba pisania złożonego kodu lub Zarządzanie partycjami.</span><span class="sxs-lookup"><span data-stu-id="fea4c-113">Partition management is fully managed by Azure Cosmos DB, and you do not have to write complex code or manage your partitions.</span></span> <span data-ttu-id="fea4c-114">Kontenery DB rozwiązania cosmos jest nieograniczony pod względem pamięci masowej i przepływność.</span><span class="sxs-lookup"><span data-stu-id="fea4c-114">Cosmos DB containers are unlimited in terms of storage and throughput.</span></span> 

![poziomy](./media/introduction/azure-cosmos-db-partitioning.png) 

<span data-ttu-id="fea4c-116">Partycjonowanie jest niewidoczny dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-116">Partitioning is transparent to your application.</span></span> <span data-ttu-id="fea4c-117">Rozwiązania cosmos bazy danych obsługuje szybkie odczyty i zapisy, zapytania logiki transakcyjnej, poziomy spójności i szczegółowej kontroli dostępu za pomocą metody/interfejsów API do zasobu jeden kontener.</span><span class="sxs-lookup"><span data-stu-id="fea4c-117">Cosmos DB supports fast reads and writes, queries, transactional logic, consistency levels, and fine-grained access control via methods/APIs to a single container resource.</span></span> <span data-ttu-id="fea4c-118">Usługa obsługuje dystrybuowanie danych na partycje i routingu żądań zapytań do prawej partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-118">The service handles distributing data across partitions and routing query requests to the right partition.</span></span> 

<span data-ttu-id="fea4c-119">Jak działa partycjonowania?</span><span class="sxs-lookup"><span data-stu-id="fea4c-119">How does partitioning work?</span></span> <span data-ttu-id="fea4c-120">Każdy element musi mieć klucz partycji i klucz wiersza, które identyfikują go.</span><span class="sxs-lookup"><span data-stu-id="fea4c-120">Each item must have a partition key and a row key, which uniquely identify it.</span></span> <span data-ttu-id="fea4c-121">Klucz partycji działa jako partycji logicznej danych oraz zapewnia rozwiązania Cosmos DB z granicą fizycznych dystrybucję danych partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-121">Your partition key acts as a logical partition for your data, and provides Cosmos DB with a natural boundary for distributing data across partitions.</span></span> <span data-ttu-id="fea4c-122">Krótko mówiąc Oto jak partycjonowania działa w usłudze Azure DB rozwiązania Cosmos:</span><span class="sxs-lookup"><span data-stu-id="fea4c-122">In brief, here is how partitioning works in Azure Cosmos DB:</span></span>

* <span data-ttu-id="fea4c-123">Udostępnić kontener DB rozwiązania Cosmos z `T` przepływności żądania/s</span><span class="sxs-lookup"><span data-stu-id="fea4c-123">You provision a Cosmos DB container with `T` requests/s throughput</span></span>
* <span data-ttu-id="fea4c-124">W tle DB rozwiązania Cosmos przepisy potrzebny, aby obsługiwać partycje `T` żądania/s.</span><span class="sxs-lookup"><span data-stu-id="fea4c-124">Behind the scenes, Cosmos DB provisions partitions needed to serve `T` requests/s.</span></span> <span data-ttu-id="fea4c-125">Jeśli `T` jest większa niż maksymalna przepustowość dla każdej partycji `t`, następnie DB rozwiązania Cosmos przepisy `N`  =  `T/t` partycji</span><span class="sxs-lookup"><span data-stu-id="fea4c-125">If `T` is higher than the maximum throughput per partition `t`, then Cosmos DB provisions `N` = `T/t` partitions</span></span>
* <span data-ttu-id="fea4c-126">Rozwiązania cosmos DB klawiszy skrótów obszaru klucza partycji są przydziela równomiernie w poprzek `N` partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-126">Cosmos DB allocates the key space of partition key hashes evenly across the `N` partitions.</span></span> <span data-ttu-id="fea4c-127">Tak każda partycja (partycji fizycznej) obsługuje wartości klucza partycji 1-N (partycje logiczne)</span><span class="sxs-lookup"><span data-stu-id="fea4c-127">So, each partition (physical partition) hosts 1-N partition key values (logical partitions)</span></span>
* <span data-ttu-id="fea4c-128">Gdy partycji fizycznej `p` osiągnie limit magazynu DB rozwiązania Cosmos bezproblemowo dzieli `p` do dwóch nowych partycji `p1` i `p2` i rozpowszechnia wartości odpowiadających około połowa klucze do każdej partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-128">When a physical partition `p` reaches its storage limit, Cosmos DB seamlessly splits `p` into two new partitions `p1` and `p2` and distributes values corresponding to roughly half the keys to each of the partitions.</span></span> <span data-ttu-id="fea4c-129">Tę samą operację jest niewidoczny dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-129">This split operation is invisible to your application.</span></span>
* <span data-ttu-id="fea4c-130">Podobnie, podczas udostępniania przepływności wyższy niż `t*N` przepływności, DB rozwiązania Cosmos dzieli jedną lub więcej partycji do obsługi wyższej przepustowości</span><span class="sxs-lookup"><span data-stu-id="fea4c-130">Similarly, when you provision throughput higher than `t*N` throughput, Cosmos DB splits one or more of your partitions to support the higher throughput</span></span>

<span data-ttu-id="fea4c-131">Semantyka kluczy partycji są nieco inne odpowiadające semantykę każdego API, jak pokazano w poniższej tabeli:</span><span class="sxs-lookup"><span data-stu-id="fea4c-131">The semantics for partition keys are slightly different to match the semantics of each API, as shown in the following table:</span></span>

| <span data-ttu-id="fea4c-132">Interfejs API</span><span class="sxs-lookup"><span data-stu-id="fea4c-132">API</span></span> | <span data-ttu-id="fea4c-133">Klucz partycji</span><span class="sxs-lookup"><span data-stu-id="fea4c-133">Partition Key</span></span> | <span data-ttu-id="fea4c-134">Klucz wiersza</span><span class="sxs-lookup"><span data-stu-id="fea4c-134">Row Key</span></span> |
| --- | --- | --- |
| <span data-ttu-id="fea4c-135">DocumentDB</span><span class="sxs-lookup"><span data-stu-id="fea4c-135">DocumentDB</span></span> | <span data-ttu-id="fea4c-136">Ścieżka do klucza partycji niestandardowych</span><span class="sxs-lookup"><span data-stu-id="fea4c-136">custom partition key path</span></span> | <span data-ttu-id="fea4c-137">stałe`id`</span><span class="sxs-lookup"><span data-stu-id="fea4c-137">fixed `id`</span></span> | 
| <span data-ttu-id="fea4c-138">MongoDB</span><span class="sxs-lookup"><span data-stu-id="fea4c-138">MongoDB</span></span> | <span data-ttu-id="fea4c-139">klucz w niezależnych niestandardowych</span><span class="sxs-lookup"><span data-stu-id="fea4c-139">custom shard key</span></span>  | <span data-ttu-id="fea4c-140">stałe`_id`</span><span class="sxs-lookup"><span data-stu-id="fea4c-140">fixed `_id`</span></span> | 
| <span data-ttu-id="fea4c-141">Graph</span><span class="sxs-lookup"><span data-stu-id="fea4c-141">Graph</span></span> | <span data-ttu-id="fea4c-142">Właściwość klucza partycji niestandardowych</span><span class="sxs-lookup"><span data-stu-id="fea4c-142">custom partition key property</span></span> | <span data-ttu-id="fea4c-143">stałe`id`</span><span class="sxs-lookup"><span data-stu-id="fea4c-143">fixed `id`</span></span> | 
| <span data-ttu-id="fea4c-144">Tabela</span><span class="sxs-lookup"><span data-stu-id="fea4c-144">Table</span></span> | <span data-ttu-id="fea4c-145">stałe`PartitionKey`</span><span class="sxs-lookup"><span data-stu-id="fea4c-145">fixed `PartitionKey`</span></span> | <span data-ttu-id="fea4c-146">stałe`RowKey`</span><span class="sxs-lookup"><span data-stu-id="fea4c-146">fixed `RowKey`</span></span> | 

<span data-ttu-id="fea4c-147">Rozwiązania cosmos DB używa skrótu na podstawie partycjonowania.</span><span class="sxs-lookup"><span data-stu-id="fea4c-147">Cosmos DB uses hash-based partitioning.</span></span> <span data-ttu-id="fea4c-148">Podczas zapisywania elementu DB rozwiązania Cosmos skróty wartość klucza partycji i umożliwia określenie, które partycji do przechowywania elementu w wyniku skrótu.</span><span class="sxs-lookup"><span data-stu-id="fea4c-148">When you write an item, Cosmos DB hashes the partition key value and use the hashed result to determine which partition to store the item in.</span></span> <span data-ttu-id="fea4c-149">Rozwiązania cosmos bazy danych są przechowywane wszystkie elementy z tym samym kluczem partycji w tej samej partycji fizycznej.</span><span class="sxs-lookup"><span data-stu-id="fea4c-149">Cosmos DB stores all items with the same partition key in the same physical partition.</span></span> <span data-ttu-id="fea4c-150">Wybór klucza partycji jest ważnych decyzji, które należy podjąć w czasie projektowania.</span><span class="sxs-lookup"><span data-stu-id="fea4c-150">The choice of the partition key is an important decision that you have to make at design time.</span></span> <span data-ttu-id="fea4c-151">Należy wybrać nazwę właściwości, który ma szeroki zakres wartości i ma nawet wzorce dostępu.</span><span class="sxs-lookup"><span data-stu-id="fea4c-151">You must pick a property name that has a wide range of values and has even access patterns.</span></span>

> [!NOTE]
> <span data-ttu-id="fea4c-152">Jest najlepszym rozwiązaniem będzie mieć klucz partycji wiele różnych wartości (co najmniej 100s-1000).</span><span class="sxs-lookup"><span data-stu-id="fea4c-152">It is a best practice to have a partition key with many distinct values (100s-1000s at a minimum).</span></span>
>

<span data-ttu-id="fea4c-153">Kontenery DB rozwiązania Cosmos Azure mogą być tworzone jako "fixed" lub "nieograniczone."</span><span class="sxs-lookup"><span data-stu-id="fea4c-153">Azure Cosmos DB containers can be created as "fixed" or "unlimited."</span></span> <span data-ttu-id="fea4c-154">Kontenery o stałym rozmiarze mieć maksymalnie 10 GB i 10 000 RU/s przepustowości.</span><span class="sxs-lookup"><span data-stu-id="fea4c-154">Fixed-size containers have a maximum limit of 10 GB and 10,000 RU/s throughput.</span></span> <span data-ttu-id="fea4c-155">Niektóre funkcje interfejsu API umożliwiają klucza partycji można pominąć kontenerów o stałym rozmiarze.</span><span class="sxs-lookup"><span data-stu-id="fea4c-155">Some APIs allow the partition key to be omitted for fixed-size containers.</span></span> <span data-ttu-id="fea4c-156">Aby utworzyć kontener jako nieograniczone, należy określić minimalną przepustowość 2500 RU/s.</span><span class="sxs-lookup"><span data-stu-id="fea4c-156">To create a container as unlimited, you must specify a minimum throughput of 2500 RU/s.</span></span>

## <a name="partitioning-and-provisioned-throughput"></a><span data-ttu-id="fea4c-157">Partycjonowania i zainicjowaną przepływności</span><span class="sxs-lookup"><span data-stu-id="fea4c-157">Partitioning and provisioned throughput</span></span>
<span data-ttu-id="fea4c-158">Rozwiązania cosmos DB zaprojektowano pod kątem przewidywalnej wydajności.</span><span class="sxs-lookup"><span data-stu-id="fea4c-158">Cosmos DB is designed for predictable performance.</span></span> <span data-ttu-id="fea4c-159">Po utworzeniu kontenera zarezerwować przepływność w zakresie  **[jednostek żądania](request-units.md) (RU) na sekundę z dodatkiem potencjalnych dla RU minutę**.</span><span class="sxs-lookup"><span data-stu-id="fea4c-159">When you create a container, you reserve throughput in terms of **[request units](request-units.md) (RU) per second with a potential add-on for RU per minute**.</span></span> <span data-ttu-id="fea4c-160">Każde żądanie przypisano dodatkowego jednostki żądania, która jest proporcjonalny do liczby zasobów systemowych, takich jak procesor CPU, pamięci i wykorzystanych w ramach operacji We/Wy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-160">Each request is assigned a request unit charge that is proportionate to the amount of system resources like CPU, Memory, and IO consumed by the operation.</span></span> <span data-ttu-id="fea4c-161">Odczyt dokumentu 1 KB z spójność sesji zużywa jednostki żądania.</span><span class="sxs-lookup"><span data-stu-id="fea4c-161">A read of a 1-KB document with Session consistency consumes one request unit.</span></span> <span data-ttu-id="fea4c-162">Odczytu wynosi 1 RU niezależnie od liczby elementów przechowywane i liczbę jednoczesnych żądań, w którym są uruchomione w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="fea4c-162">A read is 1 RU regardless of the number of items stored or the number of concurrent requests running at the same time.</span></span> <span data-ttu-id="fea4c-163">Większe elementy wymagają wyższych jednostki żądania w zależności od rozmiaru.</span><span class="sxs-lookup"><span data-stu-id="fea4c-163">Larger items require higher request units depending on the size.</span></span> <span data-ttu-id="fea4c-164">Jeśli wiesz, rozmiar jednostki i liczba odczytów potrzebnych do obsługi aplikacji, można udostępnić dokładną ilość wymaganych przez aplikację do odczytu wymaga przepływności.</span><span class="sxs-lookup"><span data-stu-id="fea4c-164">If you know the size of your entities and the number of reads you need to support for your application, you can provision the exact amount of throughput required for your application's read needs.</span></span> 

> [!NOTE]
> <span data-ttu-id="fea4c-165">Uzyskanie pełnej przepływności kontenera, musisz wybrać klucza partycji, który umożliwia równomierne rozkładanie żądań między niektórych wartości klucza partycji distinct.</span><span class="sxs-lookup"><span data-stu-id="fea4c-165">To achieve the full throughput of the container, you must choose a partition key that allows you to evenly distribute requests among some distinct partition key values.</span></span>
> 
> 

<a name="designing-for-partitioning"></a>
## <a name="working-with-the-azure-cosmos-db-apis"></a><span data-ttu-id="fea4c-166">Praca z Azure rozwiązania Cosmos DB API</span><span class="sxs-lookup"><span data-stu-id="fea4c-166">Working with the Azure Cosmos DB APIs</span></span>
<span data-ttu-id="fea4c-167">Portalu Azure lub interfejsu wiersza polecenia Azure umożliwia tworzenie kontenerów i skalować je w dowolnym momencie.</span><span class="sxs-lookup"><span data-stu-id="fea4c-167">You can use the Azure portal or Azure CLI to create containers and scale them at any time.</span></span> <span data-ttu-id="fea4c-168">W tej sekcji przedstawiono sposób tworzenia kontenery i określ definicję klucza przepływności i partycji w każdej z obsługiwanych interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="fea4c-168">This section shows how to create containers and specify the throughput and partition key definition in each of the supported APIs.</span></span>

### <a name="documentdb-api"></a><span data-ttu-id="fea4c-169">Interfejs API usługi DocumentDB</span><span class="sxs-lookup"><span data-stu-id="fea4c-169">DocumentDB API</span></span>
<span data-ttu-id="fea4c-170">Poniższy przykład przedstawia sposób tworzenia kontenera (kolekcja) przy użyciu interfejsu API usługi DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="fea4c-170">The following sample shows how to create a container (collection) using the DocumentDB API.</span></span> <span data-ttu-id="fea4c-171">Szczegółowe informacje można znaleźć [partycjonowania z interfejsem API usługi DocumentDB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="fea4c-171">You can find more details in [Partitioning with DocumentDB API](partition-data.md).</span></span>

```csharp
DocumentClient client = new DocumentClient(new Uri(endpoint), authKey);
await client.CreateDatabaseAsync(new Database { Id = "db" });

DocumentCollection myCollection = new DocumentCollection();
myCollection.Id = "coll";
myCollection.PartitionKey.Paths.Add("/deviceId");

await client.CreateDocumentCollectionAsync(
    UriFactory.CreateDatabaseUri("db"),
    myCollection,
    new RequestOptions { OfferThroughput = 20000 });
```

<span data-ttu-id="fea4c-172">Można znaleźć elementu (dokument) przy użyciu `GET` metody interfejsu API REST lub przy użyciu `ReadDocumentAsync` w jednym z zestawów SDK.</span><span class="sxs-lookup"><span data-stu-id="fea4c-172">You can read an item (document) using the `GET` method in the REST API or using `ReadDocumentAsync` in one of the SDKs.</span></span>

```csharp
// Read document. Needs the partition key and the ID to be specified
DeviceReading document = await client.ReadDocumentAsync<DeviceReading>(
  UriFactory.CreateDocumentUri("db", "coll", "XMS-001-FE24C"), 
  new RequestOptions { PartitionKey = new PartitionKey("XMS-0001") });
```

### <a name="mongodb-api"></a><span data-ttu-id="fea4c-173">Interfejs API usługi MongoDB</span><span class="sxs-lookup"><span data-stu-id="fea4c-173">MongoDB API</span></span>
<span data-ttu-id="fea4c-174">Przy użyciu interfejsu API bazy danych MongoDB można utworzyć kolekcję podzielonej przez ulubionego narzędzia, sterownika lub zestawu SDK.</span><span class="sxs-lookup"><span data-stu-id="fea4c-174">With the MongoDB API, you can create a sharded collection through your favorite tool, driver, or SDK.</span></span> <span data-ttu-id="fea4c-175">W tym przykładzie używamy powłoki Mongo w celu utworzenia kolekcji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-175">In this example, we use the Mongo Shell for the collection creation.</span></span>

<span data-ttu-id="fea4c-176">W powłoki Mongo:</span><span class="sxs-lookup"><span data-stu-id="fea4c-176">In the Mongo Shell:</span></span>

```
db.runCommand( { shardCollection: "admin.people", key: { region: "hashed" } } )
```
    
<span data-ttu-id="fea4c-177">Wyniki:</span><span class="sxs-lookup"><span data-stu-id="fea4c-177">Results:</span></span>

```JSON
{
    "_t" : "ShardCollectionResponse",
    "ok" : 1,
    "collectionsharded" : "admin.people"
}
```

### <a name="table-api"></a><span data-ttu-id="fea4c-178">Interfejs API tabel</span><span class="sxs-lookup"><span data-stu-id="fea4c-178">Table API</span></span>

<span data-ttu-id="fea4c-179">Przy użyciu interfejsu API tabeli określ przepustowość dla tabel w konfiguracji appSettings dla aplikacji:</span><span class="sxs-lookup"><span data-stu-id="fea4c-179">With the Table API, you specify the throughput for tables in the appSettings configuration for your application:</span></span>

```xml
<configuration>
    <appSettings>
      <!--Table creation options -->
      <add key="TableThroughput" value="700"/>
    </appSettings>
</configuration>
```

<span data-ttu-id="fea4c-180">Następnie można utworzyć tabeli za pomocą magazynu tabel Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="fea4c-180">Then you create a table using the Azure Table storage SDK.</span></span> <span data-ttu-id="fea4c-181">Klucz partycji niejawnie zostanie utworzona jako `PartitionKey` wartość.</span><span class="sxs-lookup"><span data-stu-id="fea4c-181">The partition key is implicitly created as the `PartitionKey` value.</span></span> 

```csharp
CloudTableClient tableClient = storageAccount.CreateCloudTableClient();

CloudTable table = tableClient.GetTableReference("people");
table.CreateIfNotExists();
```

<span data-ttu-id="fea4c-182">Można pobrać pojedynczą jednostką przy użyciu następującego fragmentu kodu:</span><span class="sxs-lookup"><span data-stu-id="fea4c-182">You can retrieve a single entity using the following snippet:</span></span>

```csharp
// Create a retrieve operation that takes a customer entity.
TableOperation retrieveOperation = TableOperation.Retrieve<CustomerEntity>("Smith", "Ben");

// Execute the retrieve operation.
TableResult retrievedResult = table.Execute(retrieveOperation);
```
<span data-ttu-id="fea4c-183">Zobacz [programowania z użyciem interfejsu API tabeli](tutorial-develop-table-dotnet.md) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="fea4c-183">See [Developing with the Table API](tutorial-develop-table-dotnet.md) for more details.</span></span>

### <a name="graph-api"></a><span data-ttu-id="fea4c-184">Interfejs API programu Graph</span><span class="sxs-lookup"><span data-stu-id="fea4c-184">Graph API</span></span>

<span data-ttu-id="fea4c-185">Z interfejsu API programu Graph musi używać portalu Azure lub interfejsu wiersza polecenia utworzyć kontenerów.</span><span class="sxs-lookup"><span data-stu-id="fea4c-185">With the Graph API, you must use the Azure portal or CLI to create containers.</span></span> <span data-ttu-id="fea4c-186">Alternatywnie ponieważ bazy danych Azure rozwiązania Cosmos jest wiele modeli, umożliwia jeden z innymi modelami tworzyć i skalować kontenera programu graph.</span><span class="sxs-lookup"><span data-stu-id="fea4c-186">Alternatively, since Azure Cosmos DB is multi-model, you can use one of the other models to create and scale your graph container.</span></span>

<span data-ttu-id="fea4c-187">Możesz przeczytać wierzchołków ani przy użyciu klucza partycji i identyfikator w Gremlin krawędzi.</span><span class="sxs-lookup"><span data-stu-id="fea4c-187">You can read any vertex or edge using the partition key and id in Gremlin.</span></span> <span data-ttu-id="fea4c-188">Na przykład na wykresie region ("USA") jako klucza partycji i "Seattle" jako klucza wiersza, można znaleźć wierzchołka, używając następującej składni:</span><span class="sxs-lookup"><span data-stu-id="fea4c-188">For example, for a graph with region ("USA") as the partition key, and "Seattle" as the row key, you can find a vertex using the following syntax:</span></span>

```
g.V(['USA', 'Seattle'])
```

<span data-ttu-id="fea4c-189">Takie same z krawędziami, możesz odwoływać się krawędzi przy użyciu klucza partycji i klucz wiersza.</span><span class="sxs-lookup"><span data-stu-id="fea4c-189">Same with edges, you can reference an edge using the partition key and row key.</span></span>

```
g.E(['USA', 'I5'])
```

<span data-ttu-id="fea4c-190">Zobacz [Gremlin Obsługa rozwiązania Cosmos DB](gremlin-support.md) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="fea4c-190">See [Gremlin support for Cosmos DB](gremlin-support.md) for more details.</span></span>


<a name="designing-for-partitioning"></a>
## <a name="designing-for-partitioning"></a><span data-ttu-id="fea4c-191">Projektowanie dla partycji</span><span class="sxs-lookup"><span data-stu-id="fea4c-191">Designing for partitioning</span></span>
<span data-ttu-id="fea4c-192">Skalować skutecznie bazy danych rozwiązania Cosmos platformy Azure, musisz wybierz stanowi dobry klucz partycji podczas tworzenia Twojej kontenera.</span><span class="sxs-lookup"><span data-stu-id="fea4c-192">To scale effectively with Azure Cosmos DB, you need to pick a good partition key when you create your container.</span></span> <span data-ttu-id="fea4c-193">Istnieją dwie najważniejsze kwestie dotyczące wybierania klucza partycji:</span><span class="sxs-lookup"><span data-stu-id="fea4c-193">There are two key considerations for choosing a partition key:</span></span>

* <span data-ttu-id="fea4c-194">**Granic zapytania i transakcji**: wybór klucza partycji powinien równoważyć potrzeby korzystanie z transakcje wymaganie rozpowszechniają jednostek wielu kluczy partycji, aby upewnić się, skalowalna.</span><span class="sxs-lookup"><span data-stu-id="fea4c-194">**Boundary for query and transactions**: Your choice of partition key should balance the need to enable the use of transactions against the requirement to distribute your entities across multiple partition keys to ensure a scalable solution.</span></span> <span data-ttu-id="fea4c-195">W jednym extreme można ustawić ten sam klucz partycji dla wszystkich elementów, ale może to ograniczyć skalowalności rozwiązania.</span><span class="sxs-lookup"><span data-stu-id="fea4c-195">At one extreme, you could set the same partition key for all your items, but this may limit the scalability of your solution.</span></span> <span data-ttu-id="fea4c-196">Y. można przypisać klucza partycji unikatowy dla każdego elementu, którego będzie wysoce skalowalna, ale może uniemożliwić korzystanie z transakcji krzyżowego dokumentu za pomocą procedur składowanych i wyzwalaczy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-196">At the other extreme, you could assign a unique partition key for each item, which would be highly scalable but would prevent you from using cross document transactions via stored procedures and triggers.</span></span> <span data-ttu-id="fea4c-197">Klucz partycji idealna to jedną, która pozwala na użycie wydajność zapytań i ma Kardynalność wystarczające do upewnij się, że rozwiązanie jest skalowalna.</span><span class="sxs-lookup"><span data-stu-id="fea4c-197">An ideal partition key is one that enables you to use efficient queries and that has sufficient cardinality to ensure your solution is scalable.</span></span> 
* <span data-ttu-id="fea4c-198">**Nie magazynu i wydajności wąskich gardeł**: ważne jest, aby wybrać właściwość, która umożliwia zapis do być rozproszone na różnych różne wartości.</span><span class="sxs-lookup"><span data-stu-id="fea4c-198">**No storage and performance bottlenecks**: It is important to pick a property that allows writes to be distributed across various distinct values.</span></span> <span data-ttu-id="fea4c-199">Żądania do tego samego klucza partycji nie może przekraczać przepływność jednej partycji, są ograniczane.</span><span class="sxs-lookup"><span data-stu-id="fea4c-199">Requests to the same partition key cannot exceed the throughput of a single partition, and are throttled.</span></span> <span data-ttu-id="fea4c-200">Dlatego jest ważne pobrać klucz partycji, który nie powoduje "punkty aktywne" w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-200">So it is important to pick a partition key that does not result in "hot spots" within your application.</span></span> <span data-ttu-id="fea4c-201">Ponieważ wszystkie dane dla klucza jednej partycji musi być przechowywany w partycji, zalecane jest aby uniknąć klucze partycji o dużych ilości danych dla tej samej wartości.</span><span class="sxs-lookup"><span data-stu-id="fea4c-201">Since all the data for a single partition key must be stored within a partition, it is also recommended to avoid partition keys that have high volumes of data for the same value.</span></span> 

<span data-ttu-id="fea4c-202">Oto kilka rzeczywistych scenariuszy i klucze partycji dla każdego:</span><span class="sxs-lookup"><span data-stu-id="fea4c-202">Let's look at a few real-world scenarios, and good partition keys for each:</span></span>
* <span data-ttu-id="fea4c-203">W przypadku wdrażania zaplecza profilu użytkownika, identyfikator użytkownika jest dobrym rozwiązaniem w przypadku klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-203">If you’re implementing a user profile backend, then the user ID is a good choice for partition key.</span></span>
* <span data-ttu-id="fea4c-204">Jeśli są przechowywane dane IoT na przykład stanu urządzenia, identyfikator urządzenia jest dobrym rozwiązaniem w przypadku klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-204">If you’re storing IoT data for example, device state, a device ID is a good choice for partition key.</span></span>
* <span data-ttu-id="fea4c-205">Jeśli używasz bazy danych Azure rozwiązania Cosmos rejestrowanie dane szeregów czasowych, identyfikator hosta lub procesu jest dobrym rozwiązaniem w przypadku klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-205">If you’re using Azure Cosmos DB for logging time-series data, then the hostname or process ID is a good choice for partition key.</span></span>
* <span data-ttu-id="fea4c-206">Jeśli masz architektura wielodostępnej, identyfikator dzierżawy jest dobrym rozwiązaniem w przypadku klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-206">If you have a multi-tenant architecture, the tenant ID is a good choice for partition key.</span></span>

<span data-ttu-id="fea4c-207">W niektórych zastosowań takich jak profile IoT i użytkownika, klucz partycji może być taki sam jak identyfikator (klucz dokumentu).</span><span class="sxs-lookup"><span data-stu-id="fea4c-207">In some use cases like IoT and user profiles, the partition key might be the same as your id (document key).</span></span> <span data-ttu-id="fea4c-208">W innych, takie jak czas dane serii może być kluczem partycji, który jest inny niż identyfikator.</span><span class="sxs-lookup"><span data-stu-id="fea4c-208">In others like the time series data, you might have a partition key that’s different than the id.</span></span>

### <a name="partitioning-and-loggingtime-series-data"></a><span data-ttu-id="fea4c-209">Partycjonowania i rejestrowanie szeregi danych</span><span class="sxs-lookup"><span data-stu-id="fea4c-209">Partitioning and logging/time-series data</span></span>
<span data-ttu-id="fea4c-210">Jeden z typowe przypadki użycia DB rozwiązania Cosmos jest rejestrowanie i telemetrii.</span><span class="sxs-lookup"><span data-stu-id="fea4c-210">One of the common use cases of Cosmos DB is for logging and telemetry.</span></span> <span data-ttu-id="fea4c-211">Należy wybrać stanowi dobry klucz partycji, ponieważ może być konieczne odczytu/zapisu ogromnych ilości danych.</span><span class="sxs-lookup"><span data-stu-id="fea4c-211">It is important to pick a good partition key since you might need to read/write vast volumes of data.</span></span> <span data-ttu-id="fea4c-212">Wybór zależy od odczytu i zapisu stawki i rodzaje zapytań, które chcesz uruchomić.</span><span class="sxs-lookup"><span data-stu-id="fea4c-212">The choice depends on your read and write rates and kinds of queries you expect to run.</span></span> <span data-ttu-id="fea4c-213">Poniżej przedstawiono kilka wskazówek na temat wybierania stanowi dobry klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-213">Here are some tips on how to choose a good partition key.</span></span>

* <span data-ttu-id="fea4c-214">Jeśli Twoje przypadek użycia obejmuje mała liczba zapisuje nagromadzeniem dłuższy czas i trzeba zapytania według zakresów sygnatury czasowe i inne filtry, a następnie za pomocą pakietu zbiorczego sygnatury czasowej, na przykład data jako klucza partycji jest dobre rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="fea4c-214">If your use case involves a small rate of writes accumulating over a long period of time, and need to query by ranges of timestamps and other filters, then using a rollup of the timestamp, for example,  date as a partition key is a good approach.</span></span> <span data-ttu-id="fea4c-215">Umożliwia zapytania przez wszystkie dane dotyczące daty z jednej partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-215">This allows you to query over all the data for a date from a single partition.</span></span> 
* <span data-ttu-id="fea4c-216">Jeśli obciążenie napisano ciężki, który jest bardziej popularne, należy użyć klucza partycji, który nie jest oparty na sygnatury czasowej, dzięki czemu DB rozwiązania Cosmos można rozpowszechniają zapisy równomiernie różnych partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-216">If your workload is written heavy, which is more common, you should use a partition key that’s not based on timestamp so that Cosmos DB can distribute writes evenly across various partitions.</span></span> <span data-ttu-id="fea4c-217">W tym miejscu nazwę hosta, identyfikator procesu, identyfikator działania lub inna właściwość o dużej kardynalności jest dobrym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="fea4c-217">Here a hostname, process ID, activity ID, or another property with high cardinality is a good choice.</span></span> 
* <span data-ttu-id="fea4c-218">Trzeci podejście jest hybrydowego co gdzie masz wiele kontenerów, po jednym dla każdego dnia miesięcznie, a klucz partycji to szczegółowe właściwości, takie jak nazwa hosta.</span><span class="sxs-lookup"><span data-stu-id="fea4c-218">A third approach is a hybrid one where you have multiple containers, one for each day/month and the partition key is a granular property like hostname.</span></span> <span data-ttu-id="fea4c-219">To ustawienie korzyści, które można ustawić różne przepływności oparte na przedział czasu, na przykład kontener dla bieżącego miesiąca jest udostępniane z wyższej przepustowości ponieważ służy on odczyty i zapisy, ostatnich miesięcy z niższą przepływność od momentu ich tylko obsługiwać operacji odczytu.</span><span class="sxs-lookup"><span data-stu-id="fea4c-219">This has the benefit that you can set different throughput based on the time window, for example, the container for the current month is provisioned with higher throughput since it serves reads and writes, whereas previous months with lower throughput since they only serve reads.</span></span>

### <a name="partitioning-and-multi-tenancy"></a><span data-ttu-id="fea4c-220">Partycjonowanie i obsługi wielu dzierżawców</span><span class="sxs-lookup"><span data-stu-id="fea4c-220">Partitioning and multi-tenancy</span></span>
<span data-ttu-id="fea4c-221">W przypadku wdrażania aplikacji wielodostępnych, przy użyciu rozwiązania Cosmos DB, istnieją dwa popularne wzorce — klucz partycji co dla każdego dzierżawcy i jeden kontener dla każdego dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-221">If you are implementing a multi-tenant application using Cosmos DB, there are two popular patterns – one partition key per tenant, and one container per tenant.</span></span> <span data-ttu-id="fea4c-222">Poniżej przedstawiono zalet i wad dla każdego:</span><span class="sxs-lookup"><span data-stu-id="fea4c-222">Here are the pros and cons for each:</span></span>

* <span data-ttu-id="fea4c-223">Jeden klucz partycji dla poszczególnych dzierżawców: W tym modelu dzierżaw są zawsze umieszczane w jeden kontener.</span><span class="sxs-lookup"><span data-stu-id="fea4c-223">One Partition Key per tenant: In this model, tenants are collocated within a single container.</span></span> <span data-ttu-id="fea4c-224">Ale zapytań i wstawiania dla elementów w ramach pojedynczej dzierżawy można wykonywać na jednej partycji.</span><span class="sxs-lookup"><span data-stu-id="fea4c-224">But queries and inserts for items within a single tenant can be performed against a single partition.</span></span> <span data-ttu-id="fea4c-225">Można też wdrożyć logiki transakcyjnej dla wszystkich elementów w ramach dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-225">You can also implement transactional logic across all items within a tenant.</span></span> <span data-ttu-id="fea4c-226">Ponieważ wielu dzierżawców udostępnić kontener, można zmniejszyć koszty pamięci masowej i przepływność puli zasobów dla dzierżawcy w jeden kontener zamiast inicjowania obsługi administracyjnej dodatkowych wysokość dla każdego dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-226">Since multiple tenants share a container, you can save storage and throughput costs by pooling resources for tenants within a single container rather than provisioning extra headroom for each tenant.</span></span> <span data-ttu-id="fea4c-227">Wadą jest to, że nie masz izolację wydajności dla każdego dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-227">The drawback is that you do not have performance isolation per tenant.</span></span> <span data-ttu-id="fea4c-228">Zwiększa wydajność/przepływności dotyczą vs całego kontenera zwiększa docelowej dla dzierżawców.</span><span class="sxs-lookup"><span data-stu-id="fea4c-228">Performance/throughput increases apply to the entire container vs targeted increases for tenants.</span></span>
* <span data-ttu-id="fea4c-229">Jeden kontener dla poszczególnych dzierżawców: każdy dzierżawca ma własnych kontenera.</span><span class="sxs-lookup"><span data-stu-id="fea4c-229">One Container per tenant: Each tenant has its own container.</span></span> <span data-ttu-id="fea4c-230">W tym modelu może zarezerwować wydajności dla każdego dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fea4c-230">In this model, you can reserve performance per tenant.</span></span> <span data-ttu-id="fea4c-231">Rozwiązania Cosmos DB nowe Obsługa administracyjna model cenowy, ten model jest bardziej ekonomiczne rozwiązanie dla wielu dzierżawców aplikacji z kilku dzierżawcami.</span><span class="sxs-lookup"><span data-stu-id="fea4c-231">With Cosmos DB's new provisioning pricing model, this model is more cost-effective for multi-tenant applications with a few tenants.</span></span>

<span data-ttu-id="fea4c-232">Można również użyć kombinacji/warstwowego podejścia, umożliwiający collocates małych dzierżawcy i przeprowadzanie migracji większych dzierżawcy do ich własnych kontenera.</span><span class="sxs-lookup"><span data-stu-id="fea4c-232">You can also use a combination/tiered approach that collocates small tenants and migrates larger tenants to their own container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fea4c-233">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="fea4c-233">Next steps</span></span>
<span data-ttu-id="fea4c-234">W tym artykule podaliśmy omówienie omówienie pojęć i najlepsze rozwiązania dotyczące partycjonowania z jakiegokolwiek interfejsu API Azure rozwiązania Cosmos bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fea4c-234">In this article, we provided an overview for an overview of concepts and best practices for partitioning with any Azure Cosmos DB API.</span></span> 

* <span data-ttu-id="fea4c-235">Dowiedz się więcej o [udostępnionej przepływności w usłudze Azure DB rozwiązania Cosmos](request-units.md)</span><span class="sxs-lookup"><span data-stu-id="fea4c-235">Learn about [provisioned throughput in Azure Cosmos DB](request-units.md)</span></span>
* <span data-ttu-id="fea4c-236">Dowiedz się więcej o [globalne dystrybucji w usłudze Azure DB rozwiązania Cosmos](distribute-data-globally.md)</span><span class="sxs-lookup"><span data-stu-id="fea4c-236">Learn about [global distribution in Azure Cosmos DB](distribute-data-globally.md)</span></span>



