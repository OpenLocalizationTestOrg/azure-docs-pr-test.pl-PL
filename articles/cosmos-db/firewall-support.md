---
title: "Obsługa zapory DB rozwiązania Cosmos aaaAzure & IP kontrola dostępu | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak zasady kontroli dostępu IP toouse zapory obsługują na kontach bazy danych Azure DB rozwiązania Cosmos."
keywords: "Kontrola dostępu do adresu IP, obsługi zapory"
services: cosmos-db
author: shahankur11
manager: jhubbard
editor: 
tags: azure-resource-manager
documentationcenter: 
ms.assetid: c1b9ede0-ed93-411a-ac9a-62c113a8e887
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/22/2017
ms.author: ankshah
ms.openlocfilehash: b5cdbdb28e9d7ee0fd0ea54aad277167b699929f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="azure-cosmos-db-firewall-support"></a><span data-ttu-id="70e5d-104">Obsługa zapory w usłudze Azure DB rozwiązania Cosmos</span><span class="sxs-lookup"><span data-stu-id="70e5d-104">Azure Cosmos DB firewall support</span></span>
<span data-ttu-id="70e5d-105">toosecure dane przechowywane na koncie Azure DB rozwiązania Cosmos bazy danych, rozwiązania Cosmos Azure DB udostępnił pomocy technicznej dla hasła, na podstawie [modelu autoryzacji](https://msdn.microsoft.com/library/azure/dn783368.aspx) , która zawiera kod uwierzytelniania wiadomości Hash-based silne (HMAC).</span><span class="sxs-lookup"><span data-stu-id="70e5d-105">toosecure data stored in an Azure Cosmos DB database account, Azure Cosmos DB has provided support for a secret based [authorization model](https://msdn.microsoft.com/library/azure/dn783368.aspx) that utilizes a strong Hash-based message authentication code (HMAC).</span></span> <span data-ttu-id="70e5d-106">Teraz ponadto klucz tajny toohello na podstawie modelu autoryzacji, bazy danych rozwiązania Cosmos Azure obsługuje zasady na kontroli dostępu na podstawie adresu IP dla strony Obsługa zapory dla ruchu przychodzącego.</span><span class="sxs-lookup"><span data-stu-id="70e5d-106">Now, in addition toohello secret based authorization model, Azure Cosmos DB supports policy driven IP-based access controls for inbound firewall support.</span></span> <span data-ttu-id="70e5d-107">Ten model jest bardzo podobne reguły zapory toohello systemu tradycyjne bazy danych i zapewnia dodatkowy poziom zabezpieczeń toohello konto bazy danych Azure DB rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="70e5d-107">This model is very similar toohello firewall rules of a traditional database system and provides an additional level of security toohello Azure Cosmos DB database account.</span></span> <span data-ttu-id="70e5d-108">Z tym modelem można skonfigurować dostępne tylko z zatwierdzonych zbiór maszyny toobe konta bazy danych DB rozwiązania Cosmos Azure lub usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="70e5d-108">With this model, you can now configure an Azure Cosmos DB database account toobe accessible only from an approved set of machines and/or cloud services.</span></span> <span data-ttu-id="70e5d-109">Dostęp tooAzure DB rozwiązania Cosmos zasoby z tych zestawów zatwierdzonych komputery i usługi wymagają nadal hello wywołującego toopresent token prawidłowego autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="70e5d-109">Access tooAzure Cosmos DB resources from these approved sets of machines and services still require hello caller toopresent a valid authorization token.</span></span>

## <a name="ip-access-control-overview"></a><span data-ttu-id="70e5d-110">Omówienie kontroli dostępu dla adresu IP</span><span class="sxs-lookup"><span data-stu-id="70e5d-110">IP access control overview</span></span>
<span data-ttu-id="70e5d-111">Domyślnie konto bazy danych Azure DB rozwiązania Cosmos jest dostępny z publicznej sieci internet, tak długo, jak długo Żądanie hello towarzyszy token prawidłowego autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="70e5d-111">By default, an Azure Cosmos DB database account is accessible from public internet as long as hello request is accompanied by a valid authorization token.</span></span> <span data-ttu-id="70e5d-112">Kontrola dostępu oparta na zasadach IP tooconfigure hello użytkownik musi podać hello zbiór adresów IP i zakresów adresów IP w toobe formularza CIDR uwzględnione jako hello białej listy adresów IP klienta, konto bazy danych.</span><span class="sxs-lookup"><span data-stu-id="70e5d-112">tooconfigure IP policy-based access control, hello user must provide hello set of IP addresses or IP address ranges in CIDR form toobe included as hello allowed list of client IPs for a given database account.</span></span> <span data-ttu-id="70e5d-113">Po zastosowaniu tej konfiguracji wszystkich żądań wysyłanych z komputerów spoza tej listy dozwolonych jest blokowana przez serwer hello.</span><span class="sxs-lookup"><span data-stu-id="70e5d-113">Once this configuration is applied, all requests originating from machines outside this allowed list will be blocked by hello server.</span></span>  <span data-ttu-id="70e5d-114">połączenie Hello przetwarzania przepływu dla hello kontroli dostępu na podstawie adresu IP jest opisana w powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="70e5d-114">hello connection processing flow for hello IP-based access control is described in hello following diagram.</span></span>

![Diagram przedstawiający proces łączenia hello kontroli dostępu na podstawie adresu IP](./media/firewall-support/firewall-support-flow.png)

## <a name="connections-from-cloud-services"></a><span data-ttu-id="70e5d-116">Połączenia z usługi w chmurze</span><span class="sxs-lookup"><span data-stu-id="70e5d-116">Connections from cloud services</span></span>
<span data-ttu-id="70e5d-117">Na platformie Azure usługi w chmurze są bardzo typowy sposób do hostowania warstwy środkowej logiki usługi przy użyciu bazy danych Azure rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="70e5d-117">In Azure, cloud services are a very common way for hosting middle tier service logic using Azure Cosmos DB.</span></span> <span data-ttu-id="70e5d-118">tooenable tooan dostępu do bazy danych Azure rozwiązania Cosmos konto bazy danych z usługi w chmurze, hello publicznego adresu IP usługi w chmurze hello musi być dodany toohello dozwolona lista adresów IP skojarzonych z Twoim kontem bazy danych Azure DB rozwiązania Cosmos przez [Konfigurowanie Witaj zasad kontroli dostępu IP](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="70e5d-118">tooenable access tooan Azure Cosmos DB database account from a cloud service, hello public IP address of hello cloud service must be added toohello allowed list of IP addresses associated with your Azure Cosmos DB database account by [configuring hello IP access control policy](#configure-ip-policy).</span></span>  <span data-ttu-id="70e5d-119">To sprawia, że wszystkie wystąpienia roli usługi w chmurze mogą tooyour dostępu do bazy danych Azure rozwiązania Cosmos konta bazy danych.</span><span class="sxs-lookup"><span data-stu-id="70e5d-119">This ensures that all role instances of cloud services have access tooyour Azure Cosmos DB database account.</span></span> <span data-ttu-id="70e5d-120">Można pobrać adresów IP dla usług w chmurze w hello portalu Azure, jak pokazano w powitania po zrzut ekranu.</span><span class="sxs-lookup"><span data-stu-id="70e5d-120">You can retrieve IP addresses for your cloud services in hello Azure portal, as shown in hello following screenshot.</span></span>

![Zrzut ekranu przedstawiający hello publicznego adresu IP wyświetlane w portalu Azure hello usługi w chmurze](./media/firewall-support/public-ip-addresses.png)

<span data-ttu-id="70e5d-122">Skalowanie usługi w chmurze, dodając rolę dodatkowe wystąpienia tych nowych wystąpień automatycznie ma konto bazy danych Azure DB rozwiązania Cosmos toohello dostępu, ponieważ są one częścią hello sama usługa w chmurze.</span><span class="sxs-lookup"><span data-stu-id="70e5d-122">When you scale out your cloud service by adding additional role instance(s), those new instances will automatically have access toohello Azure Cosmos DB database account since they are part of hello same cloud service.</span></span>

## <a name="connections-from-virtual-machines"></a><span data-ttu-id="70e5d-123">Połączenia z maszyn wirtualnych</span><span class="sxs-lookup"><span data-stu-id="70e5d-123">Connections from virtual machines</span></span>
<span data-ttu-id="70e5d-124">[Maszyny wirtualne](https://azure.microsoft.com/services/virtual-machines/) lub [zestawy skalowania maszyny wirtualnej](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) mogą być również używane toohost usług warstwy środkowej przy użyciu bazy danych Azure rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="70e5d-124">[Virtual machines](https://azure.microsoft.com/services/virtual-machines/) or [virtual machine scale sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) can also be used toohost middle tier services using Azure Cosmos DB.</span></span>  <span data-ttu-id="70e5d-125">tooconfigure hello Azure DB rozwiązania Cosmos bazy danych konta tooallow dostęp z maszyn wirtualnych, publicznych adresów IP maszyny wirtualnej i/lub zestaw skali maszyny wirtualnej musi być skonfigurowany jako jeden hello dozwolone adresy IP dla konta bazy danych Azure DB rozwiązania Cosmos przez [Konfigurowanie zasad kontroli dostępu IP hello](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="70e5d-125">tooconfigure hello Azure Cosmos DB database account tooallow access from virtual machines, public IP addresses of virtual machine and/or virtual machine scale set must be configured as one of hello allowed IP addresses for your Azure Cosmos DB database account by [configuring hello IP access control policy](#configure-ip-policy).</span></span> <span data-ttu-id="70e5d-126">Można pobrać adresów IP dla maszyn wirtualnych w hello portalu Azure, jak pokazano w powitania po zrzut ekranu.</span><span class="sxs-lookup"><span data-stu-id="70e5d-126">You can retrieve IP addresses for virtual machines in hello Azure portal, as shown in hello following screenshot.</span></span>

![Zrzut ekranu przedstawiający publicznego adresu IP dla maszyny wirtualnej, wyświetlane w portalu Azure hello](./media/firewall-support/public-ip-addresses-dns.png)

<span data-ttu-id="70e5d-128">Podczas dodawania grupy toohello wystąpień dodatkowe maszyny wirtualnej, są automatycznie udostępniane konto bazy danych Azure DB rozwiązania Cosmos tooyour dostępu.</span><span class="sxs-lookup"><span data-stu-id="70e5d-128">When you add additional virtual machine instances toohello group, they are automatically provided access tooyour Azure Cosmos DB database account.</span></span>

## <a name="connections-from-hello-internet"></a><span data-ttu-id="70e5d-129">Połączenia z hello internet</span><span class="sxs-lookup"><span data-stu-id="70e5d-129">Connections from hello internet</span></span>
<span data-ttu-id="70e5d-130">Podczas dostępu bazy danych Azure rozwiązania Cosmos bazy danych konta z komputera na hello internet, hello adres IP klienta lub zakresu adresów IP maszyny hello musi być dodany toohello białej listy adresów IP do hello Azure DB rozwiązania Cosmos konta bazy danych.</span><span class="sxs-lookup"><span data-stu-id="70e5d-130">When you access an Azure Cosmos DB database account from a computer on hello internet, hello client IP address or IP address range of hello machine must be added toohello allowed list of IP address for hello Azure Cosmos DB database account.</span></span> 

## <span data-ttu-id="70e5d-131"><a id="configure-ip-policy"></a>Konfigurowanie zasad kontroli dostępu IP hello</span><span class="sxs-lookup"><span data-stu-id="70e5d-131"><a id="configure-ip-policy"></a> Configuring hello IP access control policy</span></span>
<span data-ttu-id="70e5d-132">zasady kontroli dostępu IP Hello można ustawić w hello portalu Azure lub programistycznie za pomocą [interfejsu wiersza polecenia Azure](cli-samples.md), [programu Azure Powershell](powershell-samples.md), lub hello [interfejsu API REST](/rest/api/documentdb/) aktualizując hello `ipRangeFilter` właściwości.</span><span class="sxs-lookup"><span data-stu-id="70e5d-132">hello IP access control policy can be set in hello Azure portal, or programmatically through [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), or hello [REST API](/rest/api/documentdb/) by updating hello `ipRangeFilter` property.</span></span> <span data-ttu-id="70e5d-133">Zakresy adresów IP musi być przecinkami oddzielone i nie może zawierać spacji.</span><span class="sxs-lookup"><span data-stu-id="70e5d-133">IP addresses/ranges must be comma separated and must not contain any spaces.</span></span> <span data-ttu-id="70e5d-134">Przykład: "13.91.6.132,13.91.6.1/24".</span><span class="sxs-lookup"><span data-stu-id="70e5d-134">Example: "13.91.6.132,13.91.6.1/24".</span></span> <span data-ttu-id="70e5d-135">Podczas aktualizowania konta bazy danych za pomocą tych metod, można toopopulate się, że wszystkie tooprevent właściwości hello zresetowanie ustawień toodefault.</span><span class="sxs-lookup"><span data-stu-id="70e5d-135">When updating your database account through these methods, be sure toopopulate all of hello properties tooprevent resetting toodefault settings.</span></span>

> [!NOTE]
> <span data-ttu-id="70e5d-136">Przez włączenie IP zasady kontroli dostępu dla konta bazy danych Azure rozwiązania Cosmos bazy danych, wszystkie tooyour dostępu do bazy danych Azure rozwiązania Cosmos konto bazy danych z komputerów poza hello skonfigurowane dozwolone listę zakresów adresów IP są zablokowane.</span><span class="sxs-lookup"><span data-stu-id="70e5d-136">By enabling an IP access control policy for your Azure Cosmos DB database account, all access tooyour Azure Cosmos DB database account from machines outside hello configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="70e5d-137">Z tym modelem przeglądanie hello operacji płaszczyzna danych z portalu hello będzie również integralności hello zablokowanych tooensure kontroli dostępu.</span><span class="sxs-lookup"><span data-stu-id="70e5d-137">By virtue of this model, browsing hello data plane operation from hello portal will also be blocked tooensure hello integrity of access control.</span></span>

<span data-ttu-id="70e5d-138">Programowanie toosimplify hello portalu Azure ułatwia Identyfikuj i Dodaj adres IP hello toohello komputera klienta, z białej listy, dzięki czemu aplikacje działające na tym komputerze dostęp hello konta bazy danych Azure rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="70e5d-138">toosimplify development, hello Azure portal helps you identify and add hello IP of your client machine toohello allowed list, so that apps running your machine can access hello Azure Cosmos DB account.</span></span> <span data-ttu-id="70e5d-139">Należy pamiętać, wykryto tutaj adres IP klienta hello widziany przez hello portal.</span><span class="sxs-lookup"><span data-stu-id="70e5d-139">Note that hello client IP address here is detected as seen by hello portal.</span></span> <span data-ttu-id="70e5d-140">Może być powitania klienta adres IP komputera, ale może być również hello adres IP bramy sieci.</span><span class="sxs-lookup"><span data-stu-id="70e5d-140">It may be hello client IP address of your machine, but it could also be hello IP address of your network gateway.</span></span> <span data-ttu-id="70e5d-141">Nie zapomnij tooremove zanim będzie tooproduction.</span><span class="sxs-lookup"><span data-stu-id="70e5d-141">Do not forget tooremove it before going tooproduction.</span></span>

<span data-ttu-id="70e5d-142">tooset hello IP zasad kontroli dostępu w hello portalu Azure, przejdź do bloku konta usługi Azure DB rozwiązania Cosmos toohello, kliknij przycisk **zapory** w menu nawigacji hello, następnie kliknij przycisk **ON**</span><span class="sxs-lookup"><span data-stu-id="70e5d-142">tooset hello IP access control policy in hello Azure portal, navigate toohello Azure Cosmos DB account blade, click **Firewall** in hello navigation menu, then click **ON**</span></span> 

![Zrzut ekranu pokazujący sposób tooopen hello bloku zapory w hello portalu Azure](./media/firewall-support/azure-portal-firewall.png)

<span data-ttu-id="70e5d-144">W okienku nowe hello, określ, czy hello portalu Azure może uzyskać dostęp do konta hello i dodać inne adresów i zakresów zależnie od potrzeb, a następnie kliknij **zapisać**.</span><span class="sxs-lookup"><span data-stu-id="70e5d-144">In hello new pane, specify whether hello Azure portal can access hello account, and add other addresses and ranges as appropriate, then click **Save**.</span></span>  

> [!NOTE]
> <span data-ttu-id="70e5d-145">Po włączeniu zasady kontroli dostępu IP należy adres IP hello tooadd dla hello dostępu toomaintain portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="70e5d-145">When you enable an IP access control policy, you need tooadd hello IP address for hello Azure portal toomaintain access.</span></span> <span data-ttu-id="70e5d-146">Witaj portalu adresy IP są:</span><span class="sxs-lookup"><span data-stu-id="70e5d-146">hello portal IP addresses are:</span></span>
> |<span data-ttu-id="70e5d-147">Region</span><span class="sxs-lookup"><span data-stu-id="70e5d-147">Region</span></span>|<span data-ttu-id="70e5d-148">Adres IP</span><span class="sxs-lookup"><span data-stu-id="70e5d-148">IP address</span></span>|
> |------|----------|
> |<span data-ttu-id="70e5d-149">Wszystkie regiony, z wyjątkiem tych określonych poniżej</span><span class="sxs-lookup"><span data-stu-id="70e5d-149">All regions except those specified below</span></span>| <span data-ttu-id="70e5d-150">104.42.195.92</span><span class="sxs-lookup"><span data-stu-id="70e5d-150">104.42.195.92</span></span>|
> |<span data-ttu-id="70e5d-151">Niemcy</span><span class="sxs-lookup"><span data-stu-id="70e5d-151">Germany</span></span>|<span data-ttu-id="70e5d-152">51.4.229.218</span><span class="sxs-lookup"><span data-stu-id="70e5d-152">51.4.229.218</span></span>|
> |<span data-ttu-id="70e5d-153">Chiny</span><span class="sxs-lookup"><span data-stu-id="70e5d-153">China</span></span>|<span data-ttu-id="70e5d-154">139.217.8.252</span><span class="sxs-lookup"><span data-stu-id="70e5d-154">139.217.8.252</span></span>|
> |<span data-ttu-id="70e5d-155">Administracja USA — Arizona</span><span class="sxs-lookup"><span data-stu-id="70e5d-155">US Gov Arizona</span></span>|<span data-ttu-id="70e5d-156">52.244.48.71</span><span class="sxs-lookup"><span data-stu-id="70e5d-156">52.244.48.71</span></span>|
>

![Zrzut ekranu pokazujący sposób tooconfigure ustawień zapory w hello portalu Azure](./media/firewall-support/azure-portal-firewall-configure.png)

## <a name="troubleshooting-hello-ip-access-control-policy"></a><span data-ttu-id="70e5d-158">Rozwiązywanie problemów z zasad kontroli dostępu IP hello</span><span class="sxs-lookup"><span data-stu-id="70e5d-158">Troubleshooting hello IP access control policy</span></span>
### <a name="portal-operations"></a><span data-ttu-id="70e5d-159">Operacje portalu</span><span class="sxs-lookup"><span data-stu-id="70e5d-159">Portal operations</span></span>
<span data-ttu-id="70e5d-160">Przez włączenie IP zasady kontroli dostępu dla konta bazy danych Azure rozwiązania Cosmos bazy danych, wszystkie tooyour dostępu do bazy danych Azure rozwiązania Cosmos konto bazy danych z komputerów poza hello skonfigurowane dozwolone listę zakresów adresów IP są zablokowane.</span><span class="sxs-lookup"><span data-stu-id="70e5d-160">By enabling an IP access control policy for your Azure Cosmos DB database account, all access tooyour Azure Cosmos DB database account from machines outside hello configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="70e5d-161">W związku z tym jeśli chcesz tooenable danych portalu płaszczyzny operacje takie jak przeglądanie kolekcje i kwerendy dokumentów, potrzebujesz tooexplicitly dostęp do usługi Azure portalu przy użyciu hello **zapory** bloku w portalu hello.</span><span class="sxs-lookup"><span data-stu-id="70e5d-161">Therefore if you want tooenable portal data plane operations like browsing collections and query documents, you need tooexplicitly allow Azure portal access using hello **Firewall** blade in hello portal.</span></span> 

![Zrzut ekranu pokazujący sposób tooenable toohello dostęp do portalu Azure](./media/firewall-support/azure-portal-access-firewall.png)

### <a name="sdk--rest-api"></a><span data-ttu-id="70e5d-163">Zestaw SDK & Rest API</span><span class="sxs-lookup"><span data-stu-id="70e5d-163">SDK & Rest API</span></span>
<span data-ttu-id="70e5d-164">Dla zabezpieczeń ze względu na dostęp za pomocą zestawu SDK lub interfejsu API REST z komputerów nie na powitania listy dozwolonych zwróci ogólnego 404 odpowiedzi nie znaleziono z nie dodatkowych szczegółów.</span><span class="sxs-lookup"><span data-stu-id="70e5d-164">For security reasons, access via SDK or REST API from machines not on hello allowed list will return a generic 404 Not Found response with no additional details.</span></span> <span data-ttu-id="70e5d-165">Sprawdź, czy dozwolony hello IP liście skonfigurowane dla konfiguracji prawidłowe zasady hello tooensure konta bazy danych Azure rozwiązania Cosmos bazy danych jest zastosowane tooyour konto bazy danych Azure DB rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="70e5d-165">Please verify hello IP allowed list configured for your Azure Cosmos DB database account tooensure hello correct policy configuration is applied tooyour Azure Cosmos DB database account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="70e5d-166">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="70e5d-166">Next steps</span></span>
<span data-ttu-id="70e5d-167">Aby uzyskać informacje o sieci Zobacz wskazówki dotyczące wydajności związanych z [porady dotyczące wydajności](performance-tips.md).</span><span class="sxs-lookup"><span data-stu-id="70e5d-167">For information about network related performance tips, see [Performance tips](performance-tips.md).</span></span>

