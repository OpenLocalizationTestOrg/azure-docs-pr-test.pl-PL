---
title: "porady aaaPerformance - Azure rozwiązania Cosmos bazy danych NoSQL | Dokumentacja firmy Microsoft"
description: "Dowiedz się wydajność bazy danych Azure DB rozwiązania Cosmos tooimprove opcje konfiguracji klienta"
keywords: "jak tooimprove bazy danych wydajności"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 94ff155e-f9bc-488f-8c7a-5e7037091bb9
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: mimig
ms.openlocfilehash: 4f3e82ae5048e3dbc20b0fd891a2d3aa22adf3fc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tips-for-azure-cosmos-db"></a><span data-ttu-id="5f25f-104">Porady dotyczące wydajności dla bazy danych Azure rozwiązania Cosmos</span><span class="sxs-lookup"><span data-stu-id="5f25f-104">Performance tips for Azure Cosmos DB</span></span>
<span data-ttu-id="5f25f-105">Azure DB rozwiązania Cosmos jest szybkie i elastyczne rozproszoną bazę danych, która skaluje bezproblemowo gwarantowane opóźnienia i przepływności.</span><span class="sxs-lookup"><span data-stu-id="5f25f-105">Azure Cosmos DB is a fast and flexible distributed database that scales seamlessly with guaranteed latency and throughput.</span></span> <span data-ttu-id="5f25f-106">Nie ma toomake architektura najważniejszych zmian lub zapisu tooscale złożonego kodu bazy danych za pomocą rozwiązania Cosmos bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-106">You do not have toomake major architecture changes or write complex code tooscale your database with Cosmos DB.</span></span> <span data-ttu-id="5f25f-107">Skalowanie w górę i w dół sprowadza się do jednego wywołania interfejsu API lub [zestawu SDK wywołania metody](set-throughput.md#set-throughput-sdk).</span><span class="sxs-lookup"><span data-stu-id="5f25f-107">Scaling up and down is as easy as making a single API call or [SDK method call](set-throughput.md#set-throughput-sdk).</span></span> <span data-ttu-id="5f25f-108">Ponieważ DB rozwiązania Cosmos jest dostępny za pośrednictwem połączeń sieci są jednak optymalizacje po stronie klienta, możesz wprowadzić tooachieve najwyższą wydajność.</span><span class="sxs-lookup"><span data-stu-id="5f25f-108">However, because Cosmos DB is accessed via network calls there are client-side optimizations you can make tooachieve peak performance.</span></span>

<span data-ttu-id="5f25f-109">Dlatego jeśli "jak poprawić wydajność mojej bazy danych?"</span><span class="sxs-lookup"><span data-stu-id="5f25f-109">So if you're asking "How can I improve my database performance?"</span></span> <span data-ttu-id="5f25f-110">Należy wziąć pod uwagę hello następujące opcje:</span><span class="sxs-lookup"><span data-stu-id="5f25f-110">consider hello following options:</span></span>

## <a name="networking"></a><span data-ttu-id="5f25f-111">Sieć</span><span class="sxs-lookup"><span data-stu-id="5f25f-111">Networking</span></span>
<a id="direct-connection"></a>

1. <span data-ttu-id="5f25f-112">**Zasady połączeń: Użyj trybu bezpośredniego połączenia**</span><span class="sxs-lookup"><span data-stu-id="5f25f-112">**Connection policy: Use direct connection mode**</span></span>

    <span data-ttu-id="5f25f-113">Jak klient nawiąże połączenie tooCosmos bazy danych ma istotny wpływ na wydajność, szczególnie pod względem obserwowanych opóźnienia po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="5f25f-113">How a client connects tooCosmos DB has important implications on performance, especially in terms of observed client-side latency.</span></span> <span data-ttu-id="5f25f-114">Dostępne są dwa ustawienia konfiguracji klucza dla konfiguracji klienta połączenia zasady — połączenie hello *tryb* i hello [połączenia *protokołu*](#connection-protocol).</span><span class="sxs-lookup"><span data-stu-id="5f25f-114">There are two key configuration settings available for configuring client Connection Policy – hello connection *mode* and hello [connection *protocol*](#connection-protocol).</span></span>  <span data-ttu-id="5f25f-115">Witaj dwie dostępne tryby to:</span><span class="sxs-lookup"><span data-stu-id="5f25f-115">hello two available modes are:</span></span>

   1. <span data-ttu-id="5f25f-116">Tryb bramy (ustawienie domyślne)</span><span class="sxs-lookup"><span data-stu-id="5f25f-116">Gateway Mode (default)</span></span>
   2. <span data-ttu-id="5f25f-117">W trybie bezpośrednim</span><span class="sxs-lookup"><span data-stu-id="5f25f-117">Direct Mode</span></span>

      <span data-ttu-id="5f25f-118">Tryb bramy jest obsługiwana na wszystkich platformach zestawu SDK i jest domyślnym hello skonfigurowane.</span><span class="sxs-lookup"><span data-stu-id="5f25f-118">Gateway Mode is supported on all SDK platforms and is hello configured default.</span></span>  <span data-ttu-id="5f25f-119">Gdy aplikacja działa w sieci firmowej z ograniczeń zapory strict, tryb bramy jest najlepszym wyborem hello, ponieważ używa standardowego portu HTTPS hello i jeden punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="5f25f-119">If your application runs within a corporate network with strict firewall restrictions, Gateway Mode is hello best choice since it uses hello standard HTTPS port and a single endpoint.</span></span> <span data-ttu-id="5f25f-120">Witaj zależnościami wydajność, jednak tryb bramy obejmuje przeskoku dodatkowe sieci, za każdym razem, gdy danych jest odczytywanych lub zapisywanych tooCosmos bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-120">hello performance tradeoff, however, is that Gateway Mode involves an additional network hop every time data is read or written tooCosmos DB.</span></span> <span data-ttu-id="5f25f-121">W związku z tym w trybie bezpośrednim oferuje lepszą wydajność powodu toofewer przeskoków sieciowych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-121">Because of this, Direct Mode offers better performance due toofewer network hops.</span></span>
<a id="use-tcp"></a>
2. <span data-ttu-id="5f25f-122">**Zasady połączeń: używanie protokołu TCP hello**</span><span class="sxs-lookup"><span data-stu-id="5f25f-122">**Connection policy: Use hello TCP protocol**</span></span>

    <span data-ttu-id="5f25f-123">Podczas korzystania z trybu bezpośredniego, istnieją dwie opcje protokołu:</span><span class="sxs-lookup"><span data-stu-id="5f25f-123">When using Direct Mode, there are two protocol options available:</span></span>

   * <span data-ttu-id="5f25f-124">TCP</span><span class="sxs-lookup"><span data-stu-id="5f25f-124">TCP</span></span>
   * <span data-ttu-id="5f25f-125">HTTPS</span><span class="sxs-lookup"><span data-stu-id="5f25f-125">HTTPS</span></span>

     <span data-ttu-id="5f25f-126">Rozwiązania cosmos DB zapewnia prosty i Otwórz model programowania RESTful za pośrednictwem protokołu HTTPS.</span><span class="sxs-lookup"><span data-stu-id="5f25f-126">Cosmos DB offers a simple and open RESTful programming model over HTTPS.</span></span> <span data-ttu-id="5f25f-127">Ponadto zapewnia ona wydajne protokołu TCP, który jest również RESTful jego model komunikacji i jest dostępna za pośrednictwem powitania klienta .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="5f25f-127">Additionally, it offers an efficient TCP protocol, which is also RESTful in its communication model and is available through hello .NET client SDK.</span></span> <span data-ttu-id="5f25f-128">Bezpośrednie TCP i HTTPS używają protokołu SSL dla początkowego uwierzytelniania i szyfrowania ruchu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-128">Both Direct TCP and HTTPS use SSL for initial authentication and encrypting traffic.</span></span> <span data-ttu-id="5f25f-129">Aby uzyskać najlepszą wydajność Użyj hello protokołu TCP, gdy jest to możliwe.</span><span class="sxs-lookup"><span data-stu-id="5f25f-129">For best performance, use hello TCP protocol when possible.</span></span>

     <span data-ttu-id="5f25f-130">Korzystając z protokołu TCP w trybie bramy, TCP Port 443 jest hello DB rozwiązania Cosmos portu, a 10255 jest hello portu interfejsu API bazy danych MongoDB.</span><span class="sxs-lookup"><span data-stu-id="5f25f-130">When using TCP in Gateway Mode, TCP Port 443 is hello Cosmos DB port, and 10255 is hello MongoDB API port.</span></span> <span data-ttu-id="5f25f-131">Korzystając z protokołu TCP w trybie bezpośredniego w portach bramy toohello dodanie, należy tooensure hello portu zakresie 10000 i 20000 jest otwarty, ponieważ DB rozwiązania Cosmos wykorzystuje porty dynamiczne TCP.</span><span class="sxs-lookup"><span data-stu-id="5f25f-131">When using TCP in Direct Mode, in addition toohello Gateway ports, you need tooensure hello port range between 10000 and 20000 is open because Cosmos DB uses dynamic TCP ports.</span></span> <span data-ttu-id="5f25f-132">Jeśli te porty nie są otwarte i ponów próbę toouse TCP, komunikat o błędzie 503 Usługa niedostępna.</span><span class="sxs-lookup"><span data-stu-id="5f25f-132">If these ports are not open and you attempt toouse TCP, you receive a 503 Service Unavailable error.</span></span>

     <span data-ttu-id="5f25f-133">Tryb łączności Hello jest skonfigurowany podczas konstruowania hello hello wystąpienia DocumentClient z parametrem ConnectionPolicy hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-133">hello Connectivity Mode is configured during hello construction of hello DocumentClient instance with hello ConnectionPolicy parameter.</span></span> <span data-ttu-id="5f25f-134">Jeśli używany jest tryb Direct, hello protokołu można również ustawić w ramach parametru ConnectionPolicy hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-134">If Direct Mode is used, hello Protocol can also be set within hello ConnectionPolicy parameter.</span></span>

    ```C#
    var serviceEndpoint = new Uri("https://contoso.documents.net");
    var authKey = new "your authKey from hello Azure portal";
    DocumentClient client = new DocumentClient(serviceEndpoint, authKey,
    new ConnectionPolicy
    {
        ConnectionMode = ConnectionMode.Direct,
        ConnectionProtocol = Protocol.Tcp
    });
    ```

    <span data-ttu-id="5f25f-135">Ponieważ TCP jest obsługiwany tylko w trybie bezpośredniego, jeśli używany jest tryb bramy następnie powitalne protokołu HTTPS jest zawsze używana toocommunicate z hello bramy i hello wartości protokołu hello ConnectionPolicy jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="5f25f-135">Because TCP is only supported in Direct Mode, if Gateway Mode is used, then hello HTTPS protocol is always used toocommunicate with hello Gateway and hello Protocol value in hello ConnectionPolicy is ignored.</span></span>

    ![Ilustracja hello zasady połączenia bazy danych Azure rozwiązania Cosmos](./media/performance-tips/connection-policy.png)

3. <span data-ttu-id="5f25f-137">**Wywołaj opóźnienia uruchomienia tooavoid OpenAsync na pierwsze żądanie**</span><span class="sxs-lookup"><span data-stu-id="5f25f-137">**Call OpenAsync tooavoid startup latency on first request**</span></span>

    <span data-ttu-id="5f25f-138">Domyślnie hello pierwsze żądanie ma większego opóźnienia, ponieważ zawiera ona tabelę routingu toofetch hello adres.</span><span class="sxs-lookup"><span data-stu-id="5f25f-138">By default, hello first request has a higher latency because it has toofetch hello address routing table.</span></span> <span data-ttu-id="5f25f-139">tooavoid najpierw zażądać tego opóźnienia uruchomienia na powitania, powinny wywoływać OpenAsync() raz podczas inicjowania w następujący sposób.</span><span class="sxs-lookup"><span data-stu-id="5f25f-139">tooavoid this startup latency on hello first request, you should call OpenAsync() once during initialization as follows.</span></span>

        await client.OpenAsync();
   <a id="same-region"></a>
4. <span data-ttu-id="5f25f-140">**Klienci, w tym samym regionie Azure wydajności w ten sposób rozmieszczać**</span><span class="sxs-lookup"><span data-stu-id="5f25f-140">**Collocate clients in same Azure region for performance**</span></span>

    <span data-ttu-id="5f25f-141">Jeśli to możliwe, Umieść wywołanie DB rozwiązania Cosmos w aplikacji hello tego samego regionu hello rozwiązania Cosmos DB bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-141">When possible, place any applications calling Cosmos DB in hello same region as hello Cosmos DB database.</span></span> <span data-ttu-id="5f25f-142">Przybliżony porównanie wywołuje tooCosmos bazy danych w ramach hello, w tym samym regionie ukończona w ciągu 1 i 2 ms, ale hello opóźnienia między hello zachód i wschodniego z hello jest USA > 50 ms.</span><span class="sxs-lookup"><span data-stu-id="5f25f-142">For an approximate comparison, calls tooCosmos DB within hello same region complete within 1-2 ms, but hello latency between hello West and East coast of hello US is >50 ms.</span></span> <span data-ttu-id="5f25f-143">Tego opóźnienia prawdopodobnie mogą się różnić od toorequest żądania, w zależności od hello trasy hello żądań przesyłanych z powitania klienta toohello centrum danych Azure granic.</span><span class="sxs-lookup"><span data-stu-id="5f25f-143">This latency can likely vary from request toorequest depending on hello route taken by hello request as it passes from hello client toohello Azure datacenter boundary.</span></span> <span data-ttu-id="5f25f-144">Hello najniższe możliwe opóźnienia uzyskuje się poprzez zapewnienie wywołania hello aplikacji znajduje się w obrębie hello tego samego regionu Azure hello obsługi administracyjnej punktu końcowego DB rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="5f25f-144">hello lowest possible latency is achieved by ensuring hello calling application is located within hello same Azure region as hello provisioned Cosmos DB endpoint.</span></span> <span data-ttu-id="5f25f-145">Aby uzyskać listę dostępnych regionów, zobacz [regiony platformy Azure](https://azure.microsoft.com/regions/#services).</span><span class="sxs-lookup"><span data-stu-id="5f25f-145">For a list of available regions, see [Azure Regions](https://azure.microsoft.com/regions/#services).</span></span>

    <span data-ttu-id="5f25f-146">![Ilustracja hello zasady połączenia bazy danych Azure rozwiązania Cosmos](./media/performance-tips/same-region.png)
   <a id="increase-threads"></a></span><span class="sxs-lookup"><span data-stu-id="5f25f-146">![Illustration of hello Azure Cosmos DB connection policy](./media/performance-tips/same-region.png)
<a id="increase-threads"></a></span></span>
5. <span data-ttu-id="5f25f-147">**Zwiększenie liczby wątków/zadań**</span><span class="sxs-lookup"><span data-stu-id="5f25f-147">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="5f25f-148">Ponieważ wywołania tooAzure rozwiązania Cosmos bazy danych są wykonywane za pośrednictwem sieci hello, może być konieczne toovary hello stopień równoległości żądania, aby aplikacja kliencka hello zużywa bardzo mało czasu oczekiwania między żądaniami.</span><span class="sxs-lookup"><span data-stu-id="5f25f-148">Since calls tooAzure Cosmos DB are made over hello network, you may need toovary hello degree of parallelism of your requests so that hello client application spends very little time waiting between requests.</span></span> <span data-ttu-id="5f25f-149">Na przykład, jeśli używasz. W sieci [Biblioteka zadań równoległych](https://msdn.microsoft.com//library/dd460717.aspx), utworzyć w kolejności hello 100s zadań odczytu lub zapisu tooCosmos bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-149">For example, if you're using .NET's [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), create in hello order of 100s of Tasks reading or writing tooCosmos DB.</span></span>

## <a name="sdk-usage"></a><span data-ttu-id="5f25f-150">Użycie zestawu SDK</span><span class="sxs-lookup"><span data-stu-id="5f25f-150">SDK Usage</span></span>
1. <span data-ttu-id="5f25f-151">**Zainstaluj hello najnowszych zestawu SDK**</span><span class="sxs-lookup"><span data-stu-id="5f25f-151">**Install hello most recent SDK**</span></span>

    <span data-ttu-id="5f25f-152">zestawy SDK DB rozwiązania Cosmos Hello są stale ulepszone tooprovide hello najlepszą wydajność.</span><span class="sxs-lookup"><span data-stu-id="5f25f-152">hello Cosmos DB SDKs are constantly being improved tooprovide hello best performance.</span></span> <span data-ttu-id="5f25f-153">Zobacz hello [SDK DB rozwiązania Cosmos](documentdb-sdk-dotnet.md) toodetermine stron hello najnowszych zestawu SDK i przejrzyj ulepszenia.</span><span class="sxs-lookup"><span data-stu-id="5f25f-153">See hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) pages toodetermine hello most recent SDK and review improvements.</span></span>
2. <span data-ttu-id="5f25f-154">**Za pomocą klienta DB rozwiązania Cosmos pojedyncze hello czas ich istnienia aplikacji**</span><span class="sxs-lookup"><span data-stu-id="5f25f-154">**Use a singleton Cosmos DB client for hello lifetime of your application**</span></span>

    <span data-ttu-id="5f25f-155">Należy zauważyć, że każde wystąpienie DocumentClient wątkowo i wykonuje zarządzania wydajność połączenia i adres buforowanie w trybie bezpośredniego.</span><span class="sxs-lookup"><span data-stu-id="5f25f-155">Note that each DocumentClient instance is thread-safe and performs efficient connection management and address caching when operating in Direct Mode.</span></span> <span data-ttu-id="5f25f-156">Zarządzanie połączeniami wydajne tooallow i większą wydajność przez DocumentClient, jest zalecane toouse pojedyncze wystąpienie DocumentClient dla domeny AppDomain hello czas ich istnienia aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-156">tooallow efficient connection management and better performance by DocumentClient, it is recommended toouse a single instance of DocumentClient per AppDomain for hello lifetime of hello application.</span></span>

   <a id="max-connection"></a>
3. <span data-ttu-id="5f25f-157">**Zwiększ System.Net MaxConnections na host w trybie bramy**</span><span class="sxs-lookup"><span data-stu-id="5f25f-157">**Increase System.Net MaxConnections per host when using Gateway mode**</span></span>

    <span data-ttu-id="5f25f-158">Żądania rozwiązania cosmos bazy danych są wykonywane za pośrednictwem protokołu HTTPS/REST w trybie bramy i zostały poddane toohello domyślnego połączenia limitu na nazwę hosta lub adres IP.</span><span class="sxs-lookup"><span data-stu-id="5f25f-158">Cosmos DB requests are made over HTTPS/REST when using Gateway mode, and are subjected toohello default connection limit per hostname or IP address.</span></span> <span data-ttu-id="5f25f-159">Tooset hello MaxConnections tooa wyższa wartość (100-1000) może być konieczne, dzięki czemu hello biblioteki klienta może korzystać z wielu równoczesnych połączeń tooCosmos bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-159">You may need tooset hello MaxConnections tooa higher value (100-1000) so that hello client library can utilize multiple simultaneous connections tooCosmos DB.</span></span> <span data-ttu-id="5f25f-160">W hello zestawu .NET SDK 1.8.0 i powyżej, hello wartości domyślnej dla [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) jest 50 i toochange hello wartości, można ustawić hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit ](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa wyższej wartości.</span><span class="sxs-lookup"><span data-stu-id="5f25f-160">In hello .NET SDK 1.8.0 and above, hello default value for [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 and toochange hello value, you can set hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa higher value.</span></span>   
4. <span data-ttu-id="5f25f-161">**Dostrajanie równoległe zapytania dla kolekcji partycjonowanych**</span><span class="sxs-lookup"><span data-stu-id="5f25f-161">**Tuning parallel queries for partitioned collections**</span></span>

     <span data-ttu-id="5f25f-162">Zestaw SDK .NET usługi DocumentDB wersji 1.9.0 i powyżej zapytania równoległe pomocy technicznej, umożliwiające tooquery kolekcję partycjonowaną równolegle (zobacz [Praca z hello zestawów SDK](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) i hello związane z [przykłady kodu](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) dla więcej informacji o).</span><span class="sxs-lookup"><span data-stu-id="5f25f-162">DocumentDB .NET SDK version 1.9.0 and above support parallel queries, which enable you tooquery a partitioned collection in parallel (see [Working with hello SDKs](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) and hello related [code samples](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) for more info).</span></span> <span data-ttu-id="5f25f-163">Zapytania równoległe są zaprojektowane tooimprove zapytania opóźnienia i przepływności przez ich odpowiednika szeregowego.</span><span class="sxs-lookup"><span data-stu-id="5f25f-163">Parallel queries are designed tooimprove query latency and throughput over their serial counterpart.</span></span> <span data-ttu-id="5f25f-164">Zapytania równoległe podać dwa parametry czy użytkowników można dostosować Dopasuj toocustom ich wymaganiami, () MaxDegreeOfParallelism: toocontrol hello maksymalną liczbę partycji następnie można tworzyć zapytania równoległe i (b) MaxBufferedItemCount: numer hello toocontrol wstępnie pobranych wyniki.</span><span class="sxs-lookup"><span data-stu-id="5f25f-164">Parallel queries provide two parameters that users can tune toocustom-fit their requirements, (a) MaxDegreeOfParallelism: toocontrol hello maximum number of partitions then can be queried in parallel, and (b) MaxBufferedItemCount: toocontrol hello number of pre-fetched results.</span></span>

    <span data-ttu-id="5f25f-165">() ***dostrajanie MaxDegreeOfParallelism\: *** równoległe zapytania działa badając równocześnie wiele partycji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-165">(a) ***Tuning MaxDegreeOfParallelism\:*** Parallel query works by querying multiple partitions in parallel.</span></span> <span data-ttu-id="5f25f-166">Jednak dane z poszczególnych zbieranie podzielonym na partycje jest pobierana szeregowo względem toohello zapytania.</span><span class="sxs-lookup"><span data-stu-id="5f25f-166">However, data from an individual partitioned collect is fetched serially with respect toohello query.</span></span> <span data-ttu-id="5f25f-167">Tak ustawienie hello MaxDegreeOfParallelism toohello liczby partycji ma hello maksymalną szansy osiągnięcia hello większości wydajność zapytań, pod warunkiem pozostają inne warunki systemu hello takie same.</span><span class="sxs-lookup"><span data-stu-id="5f25f-167">So, setting hello MaxDegreeOfParallelism toohello number of partitions has hello maximum chance of achieving hello most performant query, provided all other system conditions remain hello same.</span></span> <span data-ttu-id="5f25f-168">Jeśli nie znasz hello liczby partycji, można ustawić hello MaxDegreeOfParallelism tooa dużą liczbą i hello system wybiera minimum hello (liczba partycji, dane wejściowe podane przez użytkownika), jak hello MaxDegreeOfParallelism.</span><span class="sxs-lookup"><span data-stu-id="5f25f-168">If you don't know hello number of partitions, you can set hello MaxDegreeOfParallelism tooa high number, and hello system chooses hello minimum (number of partitions, user provided input) as hello MaxDegreeOfParallelism.</span></span>

    <span data-ttu-id="5f25f-169">Jest ważne toonote, który równoległe zapytań produktu hello najważniejsze korzyści, jeśli dane hello jest równomiernie rozłożona wszystkie partycje z zapytaniem toohello zakresie.</span><span class="sxs-lookup"><span data-stu-id="5f25f-169">It is important toonote that parallel queries produce hello best benefits if hello data is evenly distributed across all partitions with respect toohello query.</span></span> <span data-ttu-id="5f25f-170">Jeśli hello podzielona na partycje kolekcja jest podzielona na partycje sposób wszystkich lub większości hello danych zwróconych przez kwerendę koncentrują się w kilku partycji (jedną partycję w najgorszym przypadku), a następnie hello wydajności kwerendy hello czy wydajność w ruchu przez te partycje.</span><span class="sxs-lookup"><span data-stu-id="5f25f-170">If hello partitioned collection is partitioned such a way that all or a majority of hello data returned by a query is concentrated in a few partitions (one partition in worst case), then hello performance of hello query would be bottlenecked by those partitions.</span></span>

    <span data-ttu-id="5f25f-171">(b) ***dostrajanie MaxBufferedItemCount\: *** zapytania równoległe jest zaprojektowana pobierania toopre wyniki podczas bieżącej partii hello wyników jest przetwarzana przez powitania klienta.</span><span class="sxs-lookup"><span data-stu-id="5f25f-171">(b) ***Tuning MaxBufferedItemCount\:*** Parallel query is designed toopre-fetch results while hello current batch of results is being processed by hello client.</span></span> <span data-ttu-id="5f25f-172">Witaj pobierania pomaga w ogólnej poprawy opóźnienia zapytania.</span><span class="sxs-lookup"><span data-stu-id="5f25f-172">hello pre-fetching helps in overall latency improvement of a query.</span></span> <span data-ttu-id="5f25f-173">MaxBufferedItemCount jest hello parametru toolimit hello liczba pobranych wstępnie wyników.</span><span class="sxs-lookup"><span data-stu-id="5f25f-173">MaxBufferedItemCount is hello parameter toolimit hello number of pre-fetched results.</span></span> <span data-ttu-id="5f25f-174">Ustawienie MaxBufferedItemCount toohello oczekuje się, że liczba wyników zwróconych (lub większa liczba) umożliwia hello zapytania tooreceive maksymalna korzystna pobierania.</span><span class="sxs-lookup"><span data-stu-id="5f25f-174">Setting MaxBufferedItemCount toohello expected number of results returned (or a higher number) allows hello query tooreceive maximum benefit from pre-fetching.</span></span>

    <span data-ttu-id="5f25f-175">Zauważ, że działa wcześniej pobrano hello sam sposób niezależnie od hello MaxDegreeOfParallelism, i istnieje pojedynczy bufor hello danych z wszystkich partycji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-175">Note that pre-fetching works hello same way irrespective of hello MaxDegreeOfParallelism, and there is a single buffer for hello data from all partitions.</span></span>  
5. <span data-ttu-id="5f25f-176">**Włącz GC po stronie serwera**</span><span class="sxs-lookup"><span data-stu-id="5f25f-176">**Turn on server-side GC**</span></span>

    <span data-ttu-id="5f25f-177">W niektórych przypadkach może pomóc zmniejszenie częstotliwości hello operacji wyrzucania elementów bezużytecznych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-177">Reducing hello frequency of garbage collection may help in some cases.</span></span> <span data-ttu-id="5f25f-178">W środowisku .NET, należy ustawić [gcserver —](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span><span class="sxs-lookup"><span data-stu-id="5f25f-178">In .NET, set [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span></span>
6. <span data-ttu-id="5f25f-179">**Implementowanie wycofywania odstępach RetryAfter**</span><span class="sxs-lookup"><span data-stu-id="5f25f-179">**Implement backoff at RetryAfter intervals**</span></span>

    <span data-ttu-id="5f25f-180">Podczas testowania wydajności, należy zwiększyć obciążenie dopóki mała liczba żądań pobrania ograniczany.</span><span class="sxs-lookup"><span data-stu-id="5f25f-180">During performance testing, you should increase load until a small rate of requests get throttled.</span></span> <span data-ttu-id="5f25f-181">Jeśli ograniczenie, aplikacja kliencka hello powinna wycofywania na ograniczania dla hello serwer określony interwał ponawiania prób.</span><span class="sxs-lookup"><span data-stu-id="5f25f-181">If throttled, hello client application should backoff on throttle for hello server-specified retry interval.</span></span> <span data-ttu-id="5f25f-182">Przestrzeganie wycofywania hello zapewnia spędzają na skraca czas oczekiwania między kolejnymi próbami.</span><span class="sxs-lookup"><span data-stu-id="5f25f-182">Respecting hello backoff ensures that you spend minimal amount of time waiting between retries.</span></span> <span data-ttu-id="5f25f-183">Obsługa zasad ponawiania znajduje się w wersji 1.8.0 lub nowszym z usługi DocumentDB hello [.NET](documentdb-sdk-dotnet.md) i [Java](documentdb-sdk-java.md), wersja 1.9.0 i nowszymi wersjami z hello [Node.js](documentdb-sdk-node.md) i [ Python](documentdb-sdk-python.md), oraz we wszystkich obsługiwanych wersjach hello [.NET Core](documentdb-sdk-dotnet-core.md) zestawów SDK.</span><span class="sxs-lookup"><span data-stu-id="5f25f-183">Retry policy support is included in Version 1.8.0 and above of hello DocumentDB [.NET](documentdb-sdk-dotnet.md) and [Java](documentdb-sdk-java.md), version 1.9.0 and above of hello [Node.js](documentdb-sdk-node.md) and [Python](documentdb-sdk-python.md), and all supported versions of hello [.NET Core](documentdb-sdk-dotnet-core.md) SDKs.</span></span> <span data-ttu-id="5f25f-184">Aby uzyskać więcej informacji, zobacz [Exceeding zastrzeżone ograniczenia przepływności](request-units.md#RequestRateTooLarge) i [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span><span class="sxs-lookup"><span data-stu-id="5f25f-184">For more information, see [Exceeding reserved throughput limits](request-units.md#RequestRateTooLarge) and [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span></span>
7. <span data-ttu-id="5f25f-185">**Skalowanie w poziomie obciążenia klientami**</span><span class="sxs-lookup"><span data-stu-id="5f25f-185">**Scale out your client-workload**</span></span>

    <span data-ttu-id="5f25f-186">Jeśli testujesz na poziomach wysokiej przepływności (> 50 000 RU/s), może stać się powitania klienta aplikacji hello "wąskie gardło" powodu toohello maszyny nakładanie się na użycie procesora CPU lub sieci.</span><span class="sxs-lookup"><span data-stu-id="5f25f-186">If you are testing at high throughput levels (>50,000 RU/s), hello client application may become hello bottleneck due toohello machine capping out on CPU or Network utilization.</span></span> <span data-ttu-id="5f25f-187">Jeśli osiągnąć tego punktu, można kontynuować dodatkowe konto bazy danych rozwiązania Cosmos hello toopush przez skalowania aplikacji klienta na wielu serwerach.</span><span class="sxs-lookup"><span data-stu-id="5f25f-187">If you reach this point, you can continue toopush hello Cosmos DB account further by scaling out your client applications across multiple servers.</span></span>
8. <span data-ttu-id="5f25f-188">**Dokument pamięci podręcznej URI na mniejsze opóźnienia odczytu**</span><span class="sxs-lookup"><span data-stu-id="5f25f-188">**Cache document URIs for lower read latency**</span></span>

    <span data-ttu-id="5f25f-189">Dokument pamięci podręcznej URI, jeśli to możliwe, aby uzyskać najlepszą wydajność odczytu hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-189">Cache document URIs whenever possible for hello best read performance.</span></span>
   <a id="tune-page-size"></a>
9. <span data-ttu-id="5f25f-190">**Dostosuj rozmiar strony powitania dla źródła danych zapytania/odczytu w celu poprawy wydajności**</span><span class="sxs-lookup"><span data-stu-id="5f25f-190">**Tune hello page size for queries/read feeds for better performance**</span></span>

    <span data-ttu-id="5f25f-191">Podczas wykonywania masowego odczytać dokumentów za pomocą funkcji (na przykład ReadDocumentFeedAsync) źródło odczytu lub, jeśli zapytania SQL usługi DocumentDB, hello wyniki są zwracane w sposób segmentu, jeśli zestaw wyników hello jest zbyt duży.</span><span class="sxs-lookup"><span data-stu-id="5f25f-191">When performing a bulk read of documents using read feed functionality (for example, ReadDocumentFeedAsync) or when issuing a DocumentDB SQL query, hello results are returned in a segmented fashion if hello result set is too large.</span></span> <span data-ttu-id="5f25f-192">Domyślnie są zwracane w fragmentów 100 elementów lub 1 MB, jednego z tych limitów trafień pierwszej.</span><span class="sxs-lookup"><span data-stu-id="5f25f-192">By default, results are returned in chunks of 100 items or 1 MB, whichever limit is hit first.</span></span>

    <span data-ttu-id="5f25f-193">tooreduce hello liczba sieciowe tooretrieve rund wymagane wszystkie odpowiednie wyniki, możesz zwiększyć rozmiar strony hello przy użyciu too1000 tooup nagłówek żądania x-ms-max elementu count.</span><span class="sxs-lookup"><span data-stu-id="5f25f-193">tooreduce hello number of network round trips required tooretrieve all applicable results, you can increase hello page size using x-ms-max-item-count request header tooup too1000.</span></span> <span data-ttu-id="5f25f-194">W przypadkach, gdy muszą toodisplay tylko kilka wyniki, na przykład jeśli użytkownik interfejsu lub aplikacji interfejsu API zwraca tylko 10 powoduje raz, hello strony rozmiar too10 tooreduce hello przepływności używane dla operacji odczytu i zapytania można także zmniejszyć.</span><span class="sxs-lookup"><span data-stu-id="5f25f-194">In cases where you need toodisplay only a few results, for example, if your user interface or application API returns only 10 results a time, you can also decrease hello page size too10 tooreduce hello throughput consumed for reads and queries.</span></span>

    <span data-ttu-id="5f25f-195">Można również ustawić rozmiar strony hello przy użyciu hello dostępne zestawy SDK DB rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="5f25f-195">You may also set hello page size using hello available Cosmos DB SDKs.</span></span>  <span data-ttu-id="5f25f-196">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="5f25f-196">For example:</span></span>

        IQueryable<dynamic> authorResults = client.CreateDocumentQuery(documentCollection.SelfLink, "SELECT p.Author FROM Pages p WHERE p.Title = 'About Seattle'", new FeedOptions { MaxItemCount = 1000 });
10. <span data-ttu-id="5f25f-197">**Zwiększenie liczby wątków/zadań**</span><span class="sxs-lookup"><span data-stu-id="5f25f-197">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="5f25f-198">Zobacz [zwiększyć liczbę wątków/zadania](#increase-threads) w hello sekcji sieci.</span><span class="sxs-lookup"><span data-stu-id="5f25f-198">See [Increase number of threads/tasks](#increase-threads) in hello Networking section.</span></span>

11. <span data-ttu-id="5f25f-199">**Użyj przetwarzania przez hosta 64-bitowych**</span><span class="sxs-lookup"><span data-stu-id="5f25f-199">**Use 64-bit host processing**</span></span>

    <span data-ttu-id="5f25f-200">w procesie 32-bitowego hosta działa Hello zestawu SDK usługi DocumentDB, gdy używasz zestawu SDK .NET usługi DocumentDB w wersji 1.11.4 lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="5f25f-200">hello DocumentDB SDK works in a 32-bit host process when you are using DocumentDB .NET SDK version 1.11.4 and above.</span></span> <span data-ttu-id="5f25f-201">Jeśli używasz krzyżowego partycji zapytania przetwarzania przez hosta 64-bitowych jest zalecane zwiększonej wydajności.</span><span class="sxs-lookup"><span data-stu-id="5f25f-201">However, if you are using cross partition queries, 64-bit host processing is recommended for improved performance.</span></span> <span data-ttu-id="5f25f-202">następujące typy aplikacji Hello mają 32-bitowego hosta przetworzyć jako domyślny hello, tak w kolejności toochange to too64-bitowy, wykonaj następujące czynności na podstawie typu aplikacji hello:</span><span class="sxs-lookup"><span data-stu-id="5f25f-202">hello following types of applications have 32-bit host process as hello default, so in order toochange that too64-bit, follow these steps based on hello type of your application:</span></span>

    - <span data-ttu-id="5f25f-203">Dla pliku wykonywalnego aplikacji, można to zrobić przez zaznaczenie pola hello **preferowane jest 32-bitowych** opcję hello **właściwości projektu** okna na powitania **kompilacji** kartę.</span><span class="sxs-lookup"><span data-stu-id="5f25f-203">For Executable applications, this can be done by unchecking hello **Prefer 32-bit** option in hello **Project Properties** window, on hello **Build** tab.</span></span>

    - <span data-ttu-id="5f25f-204">VSTest podstawie projekty testowe, można to zrobić, wybierając **Test**->**testowanie ustawień**->**domyślne architektury procesora jako X64**, z hello **Visual Studio Test** opcji menu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-204">For VSTest based test projects, this can be done by selecting **Test**->**Test Settings**->**Default Processor Architecture as X64**, from hello **Visual Studio Test** menu option.</span></span>

    - <span data-ttu-id="5f25f-205">Lokalnie wdrożonych aplikacji sieci Web ASP.NET, można to zrobić przez sprawdzenie hello **hello 64-bitowej wersji usług IIS Express dla witryn sieci web i projektów**w obszarze **narzędzia** -> ** Opcje**->**projekty i rozwiązania**->**sieci Web projektów**.</span><span class="sxs-lookup"><span data-stu-id="5f25f-205">For locally deployed ASP.NET Web applications, this can be done by checking hello **Use hello 64-bit version of IIS Express for web sites and projects**, under **Tools**->**Options**->**Projects and Solutions**->**Web Projects**.</span></span>

    - <span data-ttu-id="5f25f-206">Dla aplikacji sieci Web ASP.NET wdrożonego na platformie Azure, można to zrobić, wybierając hello **platforma jako 64-bitowych** w hello **ustawienia aplikacji** na powitania portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="5f25f-206">For ASP.NET Web applications deployed on Azure, this can be done by choosing hello **Platform as 64-bit** in hello **Application Settings** on hello Azure portal.</span></span>

## <a name="indexing-policy"></a><span data-ttu-id="5f25f-207">Zasady indeksowania</span><span class="sxs-lookup"><span data-stu-id="5f25f-207">Indexing Policy</span></span>
1. <span data-ttu-id="5f25f-208">**Użyj opóźnieniem indeksowania szybsze stawki wprowadzanie czasu godzinami szczytu**</span><span class="sxs-lookup"><span data-stu-id="5f25f-208">**Use lazy indexing for faster peak time ingestion rates**</span></span>

    <span data-ttu-id="5f25f-209">Rozwiązania cosmos DB umożliwia toospecify — na poziomie zbioru hello — zasady indeksowania, dzięki czemu toochoose Jeśli chcesz, aby dokumenty hello w toobe kolekcji, automatycznie indeksowane lub nie.</span><span class="sxs-lookup"><span data-stu-id="5f25f-209">Cosmos DB allows you toospecify – at hello collection level – an indexing policy, which enables you toochoose if you want hello documents in a collection toobe automatically indexed or not.</span></span>  <span data-ttu-id="5f25f-210">Ponadto można też między synchroniczne (spójność) i aktualizacje asynchroniczne indeksu (Lazy).</span><span class="sxs-lookup"><span data-stu-id="5f25f-210">In addition, you may also choose between synchronous (Consistent) and asynchronous (Lazy) index updates.</span></span> <span data-ttu-id="5f25f-211">Domyślnie indeks hello jest aktualizowany synchronicznie na każdym insert, Zamień lub Usuń kolekcję toohello dokumentu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-211">By default, hello index is updated synchronously on each insert, replace, or delete of a document toohello collection.</span></span> <span data-ttu-id="5f25f-212">Synchronicznie trybu umożliwia hello zapytania toohonor hello sam [poziomu spójności](consistency-levels.md) jak hello dokumentu odczytuje bez opóźnień dla indeksu hello zbyt "catch".</span><span class="sxs-lookup"><span data-stu-id="5f25f-212">Synchronously mode enables hello queries toohonor hello same [consistency level](consistency-levels.md) as that of hello document reads without any delay for hello index too“catch up".</span></span>

    <span data-ttu-id="5f25f-213">Indeksowanie z opóźnieniem może zostać uwzględnione w scenariuszach, w których dane są zapisywane w seria i chcesz tooindex Praca wymagana hello tooamortize zawartości przez dłuższy okres.</span><span class="sxs-lookup"><span data-stu-id="5f25f-213">Lazy indexing may be considered for scenarios in which data is written in bursts, and you want tooamortize hello work required tooindex content over a longer period of time.</span></span> <span data-ttu-id="5f25f-214">Indeksowanie z opóźnieniem umożliwia także toouse Twojego skutecznie zainicjowaniu przepływności i służą żądań zapisu w godzinach szczytu z minimalnym opóźnieniem.</span><span class="sxs-lookup"><span data-stu-id="5f25f-214">Lazy indexing also allows you toouse your provisioned throughput effectively and serve write requests at peak times with minimal latency.</span></span> <span data-ttu-id="5f25f-215">Jest ważne toonote, jednak, że jeśli indeksowanie z opóźnieniem jest włączone, wyniki zapytania są ostatecznie spójne niezależnie od skonfigurowanych dla konta DB rozwiązania Cosmos hello poziomu spójności hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-215">It is important toonote, however, that when lazy indexing is enabled, query results are eventually consistent regardless of hello consistency level configured for hello Cosmos DB account.</span></span>

    <span data-ttu-id="5f25f-216">W związku z tym spójne tryb indeksowania (IndexingPolicy.IndexingMode ustawiono tooConsistent) wiąże się z hello najwyższy żądania jednostkę opłatą na zapisu podczas opóźnieniem indeksowanie trybu (IndexingPolicy.IndexingMode ustawiono tooLazy) i nie indeksowania (IndexingPolicy.Automatic ustawiono tooFalse) ma koszt zerowy indeksowania w momencie hello zapisu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-216">Hence, Consistent indexing mode (IndexingPolicy.IndexingMode is set tooConsistent) incurs hello highest request unit charge per write, while Lazy indexing mode (IndexingPolicy.IndexingMode is set tooLazy) and no indexing (IndexingPolicy.Automatic is set tooFalse) have zero indexing cost at hello time of write.</span></span>
2. <span data-ttu-id="5f25f-217">**Wyklucz ścieżki nieużywane indeksowania dla szybsze zapisy**</span><span class="sxs-lookup"><span data-stu-id="5f25f-217">**Exclude unused paths from indexing for faster writes**</span></span>

    <span data-ttu-id="5f25f-218">Zasady indeksowania rozwiązania cosmos w DB umożliwia także toospecify dokumentu tooinclude ścieżki lub wykluczyć z indeksowania dzięki wykorzystaniu indeksowania ścieżki (IndexingPolicy.IncludedPaths i IndexingPolicy.ExcludedPaths).</span><span class="sxs-lookup"><span data-stu-id="5f25f-218">Cosmos DB’s indexing policy also allows you toospecify which document paths tooinclude or exclude from indexing by leveraging Indexing Paths (IndexingPolicy.IncludedPaths and IndexingPolicy.ExcludedPaths).</span></span> <span data-ttu-id="5f25f-219">Użycie Hello indeksowania ścieżki można oferują zapisu lepszą wydajność i dolnym indeksu magazynu w scenariuszach, w których hello wzorców zapytań nazywa się uprzednio indeksowania koszty są bezpośrednio skorelowane toohello liczbę unikatowych ścieżki zaindeksowane.</span><span class="sxs-lookup"><span data-stu-id="5f25f-219">hello use of indexing paths can offer improved write performance and lower index storage for scenarios in which hello query patterns are known beforehand, as indexing costs are directly correlated toohello number of unique paths indexed.</span></span>  <span data-ttu-id="5f25f-220">Na przykład hello następującego kodu pokazuje sposób tooexclude całą sekcję hello dokumentów ()</span><span class="sxs-lookup"><span data-stu-id="5f25f-220">For example, hello following code shows how tooexclude an entire section of hello documents (a.k.a.</span></span> <span data-ttu-id="5f25f-221">poddrzewo) indeksowania przy użyciu hello "*" symboli wieloznacznych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-221">a subtree) from indexing using hello "*" wildcard.</span></span>

    ```C#
    var collection = new DocumentCollection { Id = "excludedPathCollection" };
    collection.IndexingPolicy.IncludedPaths.Add(new IncludedPath { Path = "/*" });
    collection.IndexingPolicy.ExcludedPaths.Add(new ExcludedPath { Path = "/nonIndexedContent/*");
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), excluded);
    ```

    <span data-ttu-id="5f25f-222">Aby uzyskać więcej informacji, zobacz [Azure DB rozwiązania Cosmos zasady indeksowania](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="5f25f-222">For more information, see [Azure Cosmos DB indexing policies](indexing-policies.md).</span></span>

## <a name="throughput"></a><span data-ttu-id="5f25f-223">Przepływność</span><span class="sxs-lookup"><span data-stu-id="5f25f-223">Throughput</span></span>
<a id="measure-rus"></a>

1. <span data-ttu-id="5f25f-224">**Pomiar i dostrajania dla żądania niższe jednostek na sekundę użycia**</span><span class="sxs-lookup"><span data-stu-id="5f25f-224">**Measure and tune for lower request units/second usage**</span></span>

    <span data-ttu-id="5f25f-225">Rozwiązania cosmos DB oferuje bogaty zestaw operacji bazy danych, w tym relacyjnych i hierarchicznych zapytania z funkcji UDF, procedury składowane i wyzwalaczy — wszystkie działania w dokumentach hello w kolekcji bazy danych.</span><span class="sxs-lookup"><span data-stu-id="5f25f-225">Cosmos DB offers a rich set of database operations including relational and hierarchical queries with UDFs, stored procedures, and triggers – all operating on hello documents within a database collection.</span></span> <span data-ttu-id="5f25f-226">Hello kosztów związanych z każdym z tych operacji zależy od hello procesora CPU, we/wy i pamięci wymaganej toocomplete hello operacji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-226">hello cost associated with each of these operations varies based on hello CPU, IO, and memory required toocomplete hello operation.</span></span> <span data-ttu-id="5f25f-227">Zamiast analiza zasobów i zarządzania nimi sprzętu można traktować jednostki żądań (RU) jako pojedynczy miara tooperform wymagane zasoby hello różne operacje bazy danych i usługi żądania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-227">Instead of thinking about and managing hardware resources, you can think of a request unit (RU) as a single measure for hello resources required tooperform various database operations and service an application request.</span></span>

    <span data-ttu-id="5f25f-228">[Jednostek żądania](request-units.md) obsługi administracyjnej dla każdego konta bazy danych na podstawie liczby hello jednostki pojemności, które zakupu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-228">[Request units](request-units.md) are provisioned for each database account based on hello number of capacity units that you purchase.</span></span> <span data-ttu-id="5f25f-229">Zużycie jednostka żądania jest szacowana jako szybkość na sekundę.</span><span class="sxs-lookup"><span data-stu-id="5f25f-229">Request unit consumption is evaluated as a rate per second.</span></span> <span data-ttu-id="5f25f-230">Aplikacje, które przekraczają hello żądania elastycznie jednostki szybkości dla swojego konta jest ograniczona do momentu hello spada poniżej poziomu zarezerwowane dla konta hello hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-230">Applications that exceed hello provisioned request unit rate for their account is limited until hello rate drops below hello reserved level for hello account.</span></span> <span data-ttu-id="5f25f-231">Jeśli aplikacja wymaga wyższego poziomu przepływności, możesz kupić jej większą pojemność jednostki.</span><span class="sxs-lookup"><span data-stu-id="5f25f-231">If your application requires a higher level of throughput, you can purchase additional capacity units.</span></span>

    <span data-ttu-id="5f25f-232">złożoność Hello zapytania ma wpływ na liczbę jednostek żądania są używane dla operacji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-232">hello complexity of a query impacts how many Request Units are consumed for an operation.</span></span> <span data-ttu-id="5f25f-233">Hello liczba predykatów, rodzaj predykaty hello, liczba funkcji UDF i hello rozmiaru zestawu danych źródła hello wszystkie wpływ koszt hello zapytania operacji.</span><span class="sxs-lookup"><span data-stu-id="5f25f-233">hello number of predicates, nature of hello predicates, number of UDFs, and hello size of hello source data set all influence hello cost of query operations.</span></span>

    <span data-ttu-id="5f25f-234">koszty hello toomeasure żadnej operacji (Tworzenie, aktualizowanie lub usuwanie), sprawdź nagłówek x-ms żądania — opłata hello (lub równoważne właściwości RequestCharge w ResourceResponse hello<T> lub FeedResponse<T> w hello zestawu .NET SDK) toomeasure Witaj liczba jednostek żądania używanych przez te operacje.</span><span class="sxs-lookup"><span data-stu-id="5f25f-234">toomeasure hello overhead of any operation (create, update, or delete), inspect hello x-ms-request-charge header (or hello equivalent RequestCharge property in ResourceResponse<T> or FeedResponse<T> in hello .NET SDK) toomeasure hello number of request units consumed by these operations.</span></span>

    ```C#
    // Measure hello performance (request units) of writes
    ResourceResponse<Document> response = await client.CreateDocumentAsync(collectionSelfLink, myDocument);
    Console.WriteLine("Insert of document consumed {0} request units", response.RequestCharge);
    // Measure hello performance (request units) of queries
    IDocumentQuery<dynamic> queryable = client.CreateDocumentQuery(collectionSelfLink, queryString).AsDocumentQuery();
    while (queryable.HasMoreResults)
         {
              FeedResponse<dynamic> queryResponse = await queryable.ExecuteNextAsync<dynamic>();
              Console.WriteLine("Query batch consumed {0} request units", queryResponse.RequestCharge);
         }
    ```             

    <span data-ttu-id="5f25f-235">Witaj żądania zwrócony w nagłówku to jest część sieci udostępnionej przepływności (tj., RUs 2000 / s).</span><span class="sxs-lookup"><span data-stu-id="5f25f-235">hello request charge returned in this header is a fraction of your provisioned throughput (i.e., 2000 RUs / second).</span></span> <span data-ttu-id="5f25f-236">Na przykład hello poprzednie zapytanie zwraca 1000 dokumentów o rozmiarze 1KB, kosztów hello operacji hello wynosi 1000.</span><span class="sxs-lookup"><span data-stu-id="5f25f-236">For example, if hello preceding query returns 1000 1KB-documents, hello cost of hello operation is 1000.</span></span> <span data-ttu-id="5f25f-237">W efekcie w ciągu sekundy powitania serwera honoruje tylko dwa takich żądań przed ograniczania kolejnych żądań.</span><span class="sxs-lookup"><span data-stu-id="5f25f-237">As such, within one second, hello server honors only two such requests before throttling subsequent requests.</span></span> <span data-ttu-id="5f25f-238">Aby uzyskać więcej informacji, zobacz [jednostek żądania](request-units.md) i hello [Kalkulator jednostki żądania](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="5f25f-238">For more information, see [Request units](request-units.md) and hello [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>
<a id="429"></a>
2. <span data-ttu-id="5f25f-239">**Współczynnik ograniczanie żądań szybkość dojścia za duży**</span><span class="sxs-lookup"><span data-stu-id="5f25f-239">**Handle rate limiting/request rate too large**</span></span>

    <span data-ttu-id="5f25f-240">Klient próbuje tooexceed hello zarezerwowaną przepływnością dla konta, nie ma bez spadku wydajności na powitania serwera i nie stosowania przepływności poza poziom hello zastrzeżone.</span><span class="sxs-lookup"><span data-stu-id="5f25f-240">When a client attempts tooexceed hello reserved throughput for an account, there is no performance degradation at hello server and no use of throughput capacity beyond hello reserved level.</span></span> <span data-ttu-id="5f25f-241">powitania serwera zakończy preemptively hello żądanie RequestRateTooLarge (kod stanu HTTP 429) i zwracany hello nagłówka x-ms ponawiania — po ms wskazujący, że oczekiwania przed ponowną próbą wykonania żądania hello hello ilość czasu, w milisekundach hello użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5f25f-241">hello server will preemptively end hello request with RequestRateTooLarge (HTTP status code 429) and return hello x-ms-retry-after-ms header indicating hello amount of time, in milliseconds, that hello user must wait before reattempting hello request.</span></span>

        HTTP Status 429,
        Status Line: RequestRateTooLarge
        x-ms-retry-after-ms :100

    <span data-ttu-id="5f25f-242">zestawy SDK Hello wszystkie niejawnie catch tej odpowiedzi, Szanujemy hello określony serwer ponownych prób po nagłówek i ponów żądanie hello.</span><span class="sxs-lookup"><span data-stu-id="5f25f-242">hello SDKs all implicitly catch this response, respect hello server-specified retry-after header, and retry hello request.</span></span> <span data-ttu-id="5f25f-243">Hello Następna ponowna próba powiedzie się, chyba że Twoje konto jest uzyskiwany jednocześnie przez wielu klientów.</span><span class="sxs-lookup"><span data-stu-id="5f25f-243">Unless your account is being accessed concurrently by multiple clients, hello next retry will succeed.</span></span>

    <span data-ttu-id="5f25f-244">Jeśli masz więcej niż jednego klienta zbiorczo operacyjnego stale powyżej liczby żądań hello hello domyślną liczbę ponownych prób obecnie too9 zestaw wewnętrznie przez powitania klienta mogą być niewystarczające; w takim przypadku powitania klienta zgłasza DocumentClientException z aplikacją toohello 429 kodu stanu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-244">If you have more than one client cumulatively operating consistently above hello request rate, hello default retry count currently set too9 internally by hello client may not suffice; in this case, hello client throws a DocumentClientException with status code 429 toohello application.</span></span> <span data-ttu-id="5f25f-245">przez ustawienie hello RetryOptions w wystąpieniu ConnectionPolicy hello można zmienić Hello domyślnej liczby ponownych prób.</span><span class="sxs-lookup"><span data-stu-id="5f25f-245">hello default retry count can be changed by setting hello RetryOptions on hello ConnectionPolicy instance.</span></span> <span data-ttu-id="5f25f-246">Domyślnie hello DocumentClientException z kodem stanu 429 po skumulowany czas oczekiwania 30 sekund jest zwracany, gdy Żądanie hello nadal toooperate powyżej hello liczby żądań.</span><span class="sxs-lookup"><span data-stu-id="5f25f-246">By default, hello DocumentClientException with status code 429 is returned after a cumulative wait time of 30 seconds if hello request continues toooperate above hello request rate.</span></span> <span data-ttu-id="5f25f-247">Dzieje się tak nawet jeśli bieżąca liczba ponownych prób hello jest mniejsza od liczby ponownych prób max hello, jest to domyślny hello 9 lub wartości zdefiniowanej przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="5f25f-247">This occurs even when hello current retry count is less than hello max retry count, be it hello default of 9 or a user-defined value.</span></span>

    <span data-ttu-id="5f25f-248">Podczas automatycznego hello ponownego pomaga tooimprove odporności i użyteczność dla hello większość aplikacji, może ona w odds podczas wykonywania testów porównawczych wydajności, szczególnie gdy pomiaru opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="5f25f-248">While hello automated retry behavior helps tooimprove resiliency and usability for hello most applications, it might come at odds when doing performance benchmarks, especially when measuring latency.</span></span>  <span data-ttu-id="5f25f-249">Opóźnienie obserwowanych klienta Hello zostanie chwilowo wzrastają Jeśli eksperymentu hello trafienia powitania serwera przepustowości i powoduje, że powitania klienta ponawiania toosilently zestawu SDK.</span><span class="sxs-lookup"><span data-stu-id="5f25f-249">hello client-observed latency will spike if hello experiment hits hello server throttle and causes hello client SDK toosilently retry.</span></span> <span data-ttu-id="5f25f-250">Opóźnienie tooavoid wzrósł podczas eksperymenty wydajności miary hello opłat zwrócony przez każdej operacji i upewnij się, czy poniżej liczby żądań zastrzeżone hello działają żądania.</span><span class="sxs-lookup"><span data-stu-id="5f25f-250">tooavoid latency spikes during performance experiments, measure hello charge returned by each operation and ensure that requests are operating below hello reserved request rate.</span></span> <span data-ttu-id="5f25f-251">Aby uzyskać więcej informacji, zobacz [jednostek żądania](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="5f25f-251">For more information, see [Request units](request-units.md).</span></span>
3. <span data-ttu-id="5f25f-252">**Projekt dla mniejszych dokumentów dotyczących wyższej przepustowości**</span><span class="sxs-lookup"><span data-stu-id="5f25f-252">**Design for smaller documents for higher throughput**</span></span>

    <span data-ttu-id="5f25f-253">Witaj żądania (tj. koszt przetwarzania żądania) danego działania jest bezpośrednio skorelowane toohello rozmiar hello dokumentu.</span><span class="sxs-lookup"><span data-stu-id="5f25f-253">hello request charge (i.e. request processing cost) of a given operation is directly correlated toohello size of hello document.</span></span> <span data-ttu-id="5f25f-254">Operacje na dużych dokumentów koszty były wyższe niż operacje dla małych dokumentów.</span><span class="sxs-lookup"><span data-stu-id="5f25f-254">Operations on large documents cost more than operations for small documents.</span></span>

## <a name="next-steps"></a><span data-ttu-id="5f25f-255">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="5f25f-255">Next steps</span></span>
<span data-ttu-id="5f25f-256">Dla przykładowej aplikacji, tooevaluate DB rozwiązania Cosmos w scenariuszach wysokiej wydajności na kilka komputerów klienckich, zobacz [wydajności i skalowania testowanie za pomocą rozwiązania Cosmos DB](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="5f25f-256">For a sample application used tooevaluate Cosmos DB for high-performance scenarios on a few client machines, see [Performance and scale testing with Cosmos DB](performance-testing.md).</span></span>

<span data-ttu-id="5f25f-257">Toolearn więcej informacji na temat projektowania aplikacji zapewnienia skalowalności i wysokiej wydajności, zobacz też [dzielenia na partycje i skalowania w usłudze Azure DB rozwiązania Cosmos](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="5f25f-257">Also, toolearn more about designing your application for scale and high performance, see [Partitioning and scaling in Azure Cosmos DB](partition-data.md).</span></span>
