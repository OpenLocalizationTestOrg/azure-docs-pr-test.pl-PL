---
title: "aaaOnline kopia zapasowa i przywracanie z bazy danych Azure rozwiązania Cosmos | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak tooperform automatyczne kopie zapasowe i przywracanie bazy danych z bazy danych Azure rozwiązania Cosmos."
keywords: Kopia zapasowa i przywracanie, tworzenie kopii zapasowej online
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: a0b464c95681dfc7b5462b02bf04c2c43d6bc16f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="690ed-104">Automatyczne tworzenie kopii zapasowej online i przywracania bazy danych Azure rozwiązania Cosmos</span><span class="sxs-lookup"><span data-stu-id="690ed-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="690ed-105">Azure DB rozwiązania Cosmos automatycznie wykonuje kopie zapasowe wszystkich danych w regularnych odstępach czasu.</span><span class="sxs-lookup"><span data-stu-id="690ed-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="690ed-106">Hello automatycznego tworzenia kopii zapasowych woluminów bez wpływu na wydajność hello lub dostępności operacji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="690ed-106">hello automatic backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="690ed-107">Kopie zapasowe są przechowywane oddzielnie w innej usłudze magazynu, a te kopie zapasowe globalnie są replikowane w celu odporność regionalnej awarii.</span><span class="sxs-lookup"><span data-stu-id="690ed-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="690ed-108">Hello automatycznego tworzenia kopii zapasowej są przeznaczone dla scenariuszy podczas przypadkowego usunięcia z kontenera Comos DB i później wymagają danych odzyskiwania lub rozwiązanie odzyskiwania po awarii.</span><span class="sxs-lookup"><span data-stu-id="690ed-108">hello automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="690ed-109">W tym artykule rozpoczyna się od szybkie drużyn hello danych nadmiarowości i dostępności w bazie danych rozwiązania Cosmos, a następnie omówiono tworzenie kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="690ed-109">This article starts with a quick recap of hello data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="690ed-110">Wysoka dostępność rozwiązania Cosmos DB — podsumowanie</span><span class="sxs-lookup"><span data-stu-id="690ed-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="690ed-111">Rozwiązania cosmos bazy danych jest zaprojektowana toobe [globalnie rozproszone](distribute-data-globally.md) — umożliwia przepływności tooscale w różnych regionach platformy Azure oraz zasad zmiennych przezroczysty wielu interfejsów API i pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="690ed-111">Cosmos DB is designed toobe [globally distributed](distribute-data-globally.md) – it allows you tooscale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="690ed-112">Jako ofertę bazy danych systemu [dostępności 99,99% SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db), wszystkie hello zapisy do bazy danych rozwiązania Cosmos są dyski toolocal trwale zatwierdzone przez kworum replik w obrębie centrum danych lokalnych przed potwierdzeniem toohello klienta.</span><span class="sxs-lookup"><span data-stu-id="690ed-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all hello writes in Cosmos DB are durably committed toolocal disks by a quorum of replicas within a local data center before acknowledging toohello client.</span></span> <span data-ttu-id="690ed-113">Należy pamiętać, że hello wysokiej dostępności rozwiązania Cosmos DB korzysta z lokalnej pamięci masowej i nie zależy od żadnych technologie magazynu zewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="690ed-113">Note that hello high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="690ed-114">Ponadto jeśli konta bazy danych jest skojarzony z więcej niż jeden region platformy Azure, programu zapisy są replikowane za pomocą innych regionów, a także.</span><span class="sxs-lookup"><span data-stu-id="690ed-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="690ed-115">tooscale przepływności i dostępu do danych w małych opóźnień, może mieć wiele regionów skojarzonych z Twoim kontem bazy danych, według uznania w trybie odczytu.</span><span class="sxs-lookup"><span data-stu-id="690ed-115">tooscale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="690ed-116">W każdym regionie odczytu dane hello (zreplikowana) trwale jest trwała dla zestawu replik.</span><span class="sxs-lookup"><span data-stu-id="690ed-116">In each read region, hello (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="690ed-117">Jak pokazano na powitania po diagramu, jeden kontener DB rozwiązania Cosmos jest [poziomie partycjonowanej](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="690ed-117">As illustrated in hello following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="690ed-118">"Partycji" jest oznaczona okrąg powitania po diagramu, a każda partycja jest zyskuje dużą dostępność za pośrednictwem zestawu replik.</span><span class="sxs-lookup"><span data-stu-id="690ed-118">A “partition” is denoted by a circle in hello following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="690ed-119">Jest to dystrybucji lokalne powitania w pojedynczym regionie Azure (wskazywane przez hello osi X).</span><span class="sxs-lookup"><span data-stu-id="690ed-119">This is hello local distribution within a single Azure region (denoted by hello X axis).</span></span> <span data-ttu-id="690ed-120">Ponadto każda partycja (z jego odpowiedniego zestawu replik) jest globalnie dystrybuowane w różnych regionach skojarzonych z Twoim kontem bazy danych (na przykład, w tym ilustracji hello trzech regionach — wschodnie stany USA, zachodnie stany USA i Indie środkowe).</span><span class="sxs-lookup"><span data-stu-id="690ed-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration hello three regions – East US, West US and Central India).</span></span> <span data-ttu-id="690ed-121">"Ustaw partycji" Hello jest globalnie rozproszone jednostki składającej się z wielu kopii danych w każdym regionie (wskazywane przez osi hello Y).</span><span class="sxs-lookup"><span data-stu-id="690ed-121">hello “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by hello Y axis).</span></span> <span data-ttu-id="690ed-122">Można przypisać priorytet regionów toohello skojarzonych z Twoim kontem bazy danych i DB rozwiązania Cosmos będzie przezroczysty następny region toohello trybu failover w przypadku awarii.</span><span class="sxs-lookup"><span data-stu-id="690ed-122">You can assign priority toohello regions associated with your database account and Cosmos DB will transparently failover toohello next region in case of disaster.</span></span> <span data-ttu-id="690ed-123">Można też ręcznie symulować trybu failover tootest hello end-to-end dostępności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="690ed-123">You can also manually simulate failover tootest hello end-to-end availability of your application.</span></span>  

<span data-ttu-id="690ed-124">Witaj poniższym obrazie przedstawiono hello wysoki stopień nadmiarowość DB rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="690ed-124">hello following image illustrates hello high degree of redundancy with Cosmos DB.</span></span>

![Wysoki stopień nadmiarowość DB rozwiązania Cosmos](./media/online-backup-and-restore/redundancy.png)

![Wysoki stopień nadmiarowość DB rozwiązania Cosmos](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="690ed-127">Kopie zapasowe pełne, automatyczne, online</span><span class="sxs-lookup"><span data-stu-id="690ed-127">Full, automatic, online backups</span></span>
<span data-ttu-id="690ed-128">Niestety po usunięciu Moje kontener lub bazy danych!</span><span class="sxs-lookup"><span data-stu-id="690ed-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="690ed-129">Rozwiązania Cosmos DB nie tylko z danych, ale hello kopie zapasowe danych są również awarii tooregional wysokiej nadmiarowe i odporność.</span><span class="sxs-lookup"><span data-stu-id="690ed-129">With Cosmos DB, not only your data, but hello backups of your data are also made highly redundant and resilient tooregional disasters.</span></span> <span data-ttu-id="690ed-130">Te automatyczne kopie zapasowe są obecnie wykonane co cztery godziny, a najnowszy 2 kopie zapasowe są przechowywane przez cały czas.</span><span class="sxs-lookup"><span data-stu-id="690ed-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="690ed-131">Jeśli hello danych jest przypadkowo usunięty lub uszkodzony, skontaktuj [skontaktuj się z pomocą techniczną platformy Azure](https://azure.microsoft.com/support/options/) w 8 godzin.</span><span class="sxs-lookup"><span data-stu-id="690ed-131">If hello data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="690ed-132">Hello kopii zapasowych woluminów bez wpływu na wydajność hello lub dostępności operacji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="690ed-132">hello backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="690ed-133">Rozwiązania cosmos bazy danych trwa hello kopii zapasowej w tle hello bez korzystanie z RUs elastycznie i wpływu na wydajność hello i bez wpływu na dostępność hello bazy danych.</span><span class="sxs-lookup"><span data-stu-id="690ed-133">Cosmos DB takes hello backup in hello background without consuming your provisioned RUs or affecting hello performance and without affecting hello availability of your database.</span></span> 

<span data-ttu-id="690ed-134">W przeciwieństwie do danych, która znajduje się wewnątrz rozwiązania Cosmos DB hello automatycznego tworzenia kopii zapasowych są przechowywane w usłudze magazyn obiektów Blob Azure.</span><span class="sxs-lookup"><span data-stu-id="690ed-134">Unlike your data that is stored inside Cosmos DB, hello automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="690ed-135">tooguarantee hello Niskie opóźnienie/wydajne przekazywania hello migawki kopii zapasowej jest tooan przekazane wystąpienie magazynu obiektów Blob platformy Azure, w tym samym regionie co hello bieżący obszar zapisu konta bazy danych DB rozwiązania Cosmos hello.</span><span class="sxs-lookup"><span data-stu-id="690ed-135">tooguarantee hello low latency/efficient upload, hello snapshot of your backup is uploaded tooan instance of Azure Blob storage in hello same region as hello current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="690ed-136">Dla odporność regionalnej awarii każdej migawki kopii zapasowej danych w magazynie obiektów Blob Azure ponownie są replikowane za pomocą region tooanother magazynu geograficznie nadmiarowego (GRS).</span><span class="sxs-lookup"><span data-stu-id="690ed-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) tooanother region.</span></span> <span data-ttu-id="690ed-137">Witaj Poniższy diagram przedstawia hello całego kontenera DB rozwiązania Cosmos (ze wszystkich trzech partycje podstawowe w zachodnie stany USA, w tym przykładzie) kopia zapasowa jest tworzona w zdalnym konta magazynu obiektów Blob Azure w zachodnie stany USA, a następnie GRS replikowane tooEast NAS.</span><span class="sxs-lookup"><span data-stu-id="690ed-137">hello following diagram shows that hello entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated tooEast US.</span></span> 

<span data-ttu-id="690ed-138">Witaj poniższym obrazie przedstawiono okresowe pełne kopie zapasowe wszystkich jednostek rozwiązania Cosmos bazy danych grs w warstwie usługi Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="690ed-138">hello following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Okresowe pełne kopie zapasowe wszystkich jednostek rozwiązania Cosmos bazy danych grs w warstwie usługi Azure Storage](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="690ed-140">Okres przechowywania kopii zapasowych</span><span class="sxs-lookup"><span data-stu-id="690ed-140">Backup retention period</span></span>
<span data-ttu-id="690ed-141">Zgodnie z powyższym opisem bazy danych Azure rozwiązania Cosmos przyjmuje migawki danych co cztery godziny i zachowa ostatnie dwa migawki hello każdej partycji przez 30 dni.</span><span class="sxs-lookup"><span data-stu-id="690ed-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains hello last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="690ed-142">Na naszym przepisy dotyczące zgodności migawki zostaną usunięte po 90 dniach.</span><span class="sxs-lookup"><span data-stu-id="690ed-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="690ed-143">Jeśli chcesz toomaintain własne migawek, można opcji tooJSON eksportu hello w hello Azure DB rozwiązania Cosmos [narzędzia migracji danych](import-data.md#export-to-json-file) tooschedule dodatkowych kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="690ed-143">If you want toomaintain your own snapshots, you can use hello export tooJSON option in hello Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) tooschedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="690ed-144">Przywracanie bazy danych z kopii zapasowej online</span><span class="sxs-lookup"><span data-stu-id="690ed-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="690ed-145">Jeśli został przypadkowo usunięty z bazy danych lub kolekcji, możesz [pliku biletu pomocy technicznej](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) lub [z działem pomocy technicznej platformy Azure](https://azure.microsoft.com/support/options/) toorestore hello dane z ostatnich automatyczne kopie zapasowe hello.</span><span class="sxs-lookup"><span data-stu-id="690ed-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) toorestore hello data from hello last automatic backup.</span></span> <span data-ttu-id="690ed-146">Jeśli potrzebujesz toorestore bazy danych z powodu problemu z uszkodzenie danych, zobacz [obsługi uszkodzenie danych](#handling-data-corruption) zgodnie z potrzebami tootake dodatkowe kroki tooprevent hello uszkodzone dane z penetrującymi hello kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="690ed-146">If you need toorestore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need tootake additional steps tooprevent hello corrupted data from penetrating hello backups.</span></span> <span data-ttu-id="690ed-147">Określoną migawkę z kopii zapasowej toobe przywrócić DB rozwiązania Cosmos wymaga hello danych był dostępny na czas trwania hello hello cyklu tworzenia kopii zapasowych dla tej migawki.</span><span class="sxs-lookup"><span data-stu-id="690ed-147">For a specific snapshot of your backup toobe restored, Cosmos DB requires that hello data was available for hello duration of hello backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="690ed-148">Obsługa uszkodzenie danych</span><span class="sxs-lookup"><span data-stu-id="690ed-148">Handling data corruption</span></span>
<span data-ttu-id="690ed-149">Azure DB rozwiązania Cosmos zachowuje hello ostatnich dwóch kopii zapasowych wykonanych dla każdej partycji w systemie hello.</span><span class="sxs-lookup"><span data-stu-id="690ed-149">Azure Cosmos DB retains hello last two backups of every partition in hello system.</span></span> <span data-ttu-id="690ed-150">Ten model dobrze działa przy kontenerze (kolekcję dokumentów, wykres, tabelę) lub bazy danych zostaną przypadkowo usunięte od czasu ostatniej wersji hello mogą zostać przywrócone.</span><span class="sxs-lookup"><span data-stu-id="690ed-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of hello last versions can be restored.</span></span> <span data-ttu-id="690ed-151">Jednak w hello case, podczas gdy użytkownicy mogą wprowadzać problem uszkodzenie danych, bazy danych Azure rozwiązania Cosmos może mieć świadomości hello uszkodzenie danych i możliwe, że hello uszkodzenie może mieć przejścia hello kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="690ed-151">However, in hello case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of hello data corruption, and it is possible that hello corruption may have penetrated hello backups.</span></span> <span data-ttu-id="690ed-152">Jak uszkodzenie zostanie wykryte, należy usunąć hello uszkodzony kontenera (kolekcji wykres/tabeli), aby tworzenie kopii zapasowych są chronione przed zastąpieniem z uszkodzone dane.</span><span class="sxs-lookup"><span data-stu-id="690ed-152">As soon as corruption is detected, you should delete hello corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="690ed-153">Ponieważ hello ostatniej kopii zapasowej może być czterech godzin, hello użytkownika można wdrożyć [zmienić źródła](change-feed.md) toocapture i zapisać hello ostatnich czterech godzin warto danych przed usunięciem hello kontenera.</span><span class="sxs-lookup"><span data-stu-id="690ed-153">Since hello last backup could be four hours old, hello user can employ [change feed](change-feed.md) toocapture and store hello last four hours worth of data before deleting hello container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="690ed-154">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="690ed-154">Next steps</span></span>

<span data-ttu-id="690ed-155">tooreplicate bazy danych w wielu centrach danych, zobacz [dystrybucji danych globalnie DB rozwiązania Cosmos](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="690ed-155">tooreplicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="690ed-156">toofile skontaktuj się z pomocą techniczną platformy Azure, [założyć zgłoszenie z portalu Azure hello](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="690ed-156">toofile contact Azure Support, [file a ticket from hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

