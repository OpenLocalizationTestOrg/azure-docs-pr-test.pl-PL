---
title: "aaaSQL zapytania metryki dla usługi interfejsu API Azure rozwiązania Cosmos bazy danych usługi DocumentDB | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat sposobu tooinstrument i debugowania hello wydajność kwerend SQL Azure DB rozwiązania Cosmos żądań."
keywords: "Składnia SQL, zapytanie sql, zapytania sql, język zapytań json, koncepcje bazy danych i zapytania sql, funkcje agregujące"
services: cosmos-db
documentationcenter: 
author: arramac
manager: jhubbard
editor: monicar
ms.assetid: b2fa8e8f-7291-45a3-9bd1-7284ed9077f8
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/15/2017
ms.author: arramac
ms.openlocfilehash: 2fee3786b7d48d254162699471943e316764b003
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="tuning-query-performance-with-azure-cosmos-db"></a><span data-ttu-id="72e32-104">Dostrajanie wydajności kwerend z bazy danych Azure rozwiązania Cosmos</span><span class="sxs-lookup"><span data-stu-id="72e32-104">Tuning query performance with Azure Cosmos DB</span></span>
<span data-ttu-id="72e32-105">Udostępnia bazę danych systemu Azure rozwiązania Cosmos [interfejsu API SQL na potrzeby zapytań o dane](documentdb-sql-query.md), bez konieczności schematu lub indeksów pomocniczych.</span><span class="sxs-lookup"><span data-stu-id="72e32-105">Azure Cosmos DB provides a [SQL API for querying data](documentdb-sql-query.md), without requiring schema or secondary indexes.</span></span> <span data-ttu-id="72e32-106">Ten artykuł zawiera następujące informacje dla deweloperów hello:</span><span class="sxs-lookup"><span data-stu-id="72e32-106">This article provides hello following information for developers:</span></span>

* <span data-ttu-id="72e32-107">Ogólne szczegóły dotyczące sposobu działania wykonanie kwerendy SQL Azure rozwiązania Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="72e32-107">High-level details on how Azure Cosmos DB's SQL query execution works</span></span>
* <span data-ttu-id="72e32-108">Szczegółowe informacje o nagłówkach żądań i odpowiedzi zapytania i opcje zestawu SDK klienta</span><span class="sxs-lookup"><span data-stu-id="72e32-108">Details on query request and response headers, and client SDK options</span></span>
* <span data-ttu-id="72e32-109">Wskazówki i najlepsze rozwiązania dotyczące wydajności zapytań</span><span class="sxs-lookup"><span data-stu-id="72e32-109">Tips and best practices for query performance</span></span>
* <span data-ttu-id="72e32-110">Przykłady sposobu toodebug statystyk wykonywania SQL tooutilize kwerendy wydajności</span><span class="sxs-lookup"><span data-stu-id="72e32-110">Examples of how tooutilize SQL execution statistics toodebug query performance</span></span>

## <a name="about-sql-query-execution"></a><span data-ttu-id="72e32-111">Wykonanie kwerendy SQL — informacje</span><span class="sxs-lookup"><span data-stu-id="72e32-111">About SQL query execution</span></span>

<span data-ttu-id="72e32-112">W usłudze Azure DB rozwiązania Cosmos, przechowywanie danych w kontenerach, które mogą rosnąć tooany [rozmiaru lub żądania przepływności](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-112">In Azure Cosmos DB, you store data in containers, which can grow tooany [storage size or request throughput](partition-data.md).</span></span> <span data-ttu-id="72e32-113">Azure DB rozwiązania Cosmos bezproblemowo skaluje danych przez fizyczne partycji w ramach przyrostu danych toohandle obejmuje hello lub wzrost udostępnionej przepływności.</span><span class="sxs-lookup"><span data-stu-id="72e32-113">Azure Cosmos DB seamlessly scales data across physical partitions under hello covers toohandle data growth or increase in provisioned throughput.</span></span> <span data-ttu-id="72e32-114">Można wydać kontenera tooany zapytań SQL przy użyciu hello interfejsu API REST lub jednego z obsługiwanych hello [zestawów SDK usługi DocumentDB](documentdb-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-114">You can issue SQL queries tooany container using hello REST API or one of hello supported [DocumentDB SDKs](documentdb-sdk-dotnet.md).</span></span>

<span data-ttu-id="72e32-115">Krótki przegląd partycjonowania: Definiowanie klucza partycji, takich jak "Miasto", który określa sposób danych jest podzielić na partycje fizycznych.</span><span class="sxs-lookup"><span data-stu-id="72e32-115">A brief overview of partitioning: you define a partition key like "city", which determines how data is split across physical partitions.</span></span> <span data-ttu-id="72e32-116">Klucz jednej partycji tooa należące danych (na przykład "Miasto" == "Seattle") są przechowywane w partycji fizycznej, ale zwykle jednej partycji fizycznej ma wiele kluczy partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-116">Data belonging tooa single partition key (for example, "city" == "Seattle") is stored within a physical partition, but typically a single physical partition has multiple partition keys.</span></span> <span data-ttu-id="72e32-117">Gdy partycji osiągnie rozmiar magazynu, hello usługa bezproblemowo dzieli partycji hello na dwóch nowych partycji i dzieli klucza partycji hello równomiernie między tych partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-117">When a partition reaches its storage size, hello service seamlessly splits hello partition into two new partitions, and divides hello partition key evenly across these partitions.</span></span> <span data-ttu-id="72e32-118">Ponieważ partycje są przejściowe, hello interfejsów API użyć abstrakcję "zakresem kluczy partycji", oznaczająca hello zakresy wartości skrótów klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-118">Since partitions are transient, hello APIs use an abstraction of a "partition key range", which denotes hello ranges of partition key hashes.</span></span> 

<span data-ttu-id="72e32-119">Podczas generowania zapytania tooAzure DB rozwiązania Cosmos hello SDK wykonuje te kroki logiczne:</span><span class="sxs-lookup"><span data-stu-id="72e32-119">When you issue a query tooAzure Cosmos DB, hello SDK performs these logical steps:</span></span>

* <span data-ttu-id="72e32-120">Przeanalizować plan wykonania zapytania hello toodetermine hello SQL zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-120">Parse hello SQL query toodetermine hello query execution plan.</span></span> 
* <span data-ttu-id="72e32-121">Jeśli zapytanie hello zawiera filtru względem hello klucza partycji, takich jak `SELECT * FROM c WHERE c.city = "Seattle"`, jest kierowany tooa pojedynczy partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-121">If hello query includes a filter against hello partition key, like `SELECT * FROM c WHERE c.city = "Seattle"`, it is routed tooa single partition.</span></span> <span data-ttu-id="72e32-122">Jeśli hello zapytanie nie ma filtr klucza partycji, a następnie jest wykonywany w wszystkie partycje, a wyniki są łączone po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="72e32-122">If hello query does not have a filter on partition key, then it is executed in all partitions, and results are merged client side.</span></span>
* <span data-ttu-id="72e32-123">Hello zapytanie jest wykonywane w ramach każdej partycji w serii lub równoległego, na podstawie konfiguracji klienta.</span><span class="sxs-lookup"><span data-stu-id="72e32-123">hello query is executed within each partition in series or parallel, based on client configuration.</span></span> <span data-ttu-id="72e32-124">W ramach każdej partycji hello zapytanie może być jeden lub więcej rund w zależności od złożoności zapytania hello, skonfigurowany rozmiar strony, a elastycznie przepływność kolekcji hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-124">Within each partition, hello query might make one or more round trips depending on hello query complexity, configured page size, and provisioned throughput of hello collection.</span></span> <span data-ttu-id="72e32-125">Każde wykonanie zwraca liczbę hello [jednostek żądania](request-units.md) używane przez wykonanie zapytania i opcjonalnie statystyk wykonywania zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-125">Each execution returns hello number of [request units](request-units.md) consumed by query execution, and optionally, query execution statistics.</span></span> 
* <span data-ttu-id="72e32-126">Hello SDK wykonuje podsumowania wyników zapytania hello na partycje.</span><span class="sxs-lookup"><span data-stu-id="72e32-126">hello SDK performs a summarization of hello query results across partitions.</span></span> <span data-ttu-id="72e32-127">Na przykład jeśli zapytanie hello obejmuje ORDER BY w partycji, wyniki z poszczególnych partycji są sortowane scalania tooreturn wyniki globalnie posortowane.</span><span class="sxs-lookup"><span data-stu-id="72e32-127">For example, if hello query involves an ORDER BY across partitions, then results from individual partitions are merge-sorted tooreturn results in globally sorted order.</span></span> <span data-ttu-id="72e32-128">Jeśli zapytanie hello jest agregacją, takich jak `COUNT`, liczby hello z poszczególnych partycji jest równy określonemu procentowi tooproduce hello ogólnej liczby.</span><span class="sxs-lookup"><span data-stu-id="72e32-128">If hello query is an aggregation like `COUNT`, hello counts from individual partitions are summed tooproduce hello overall count.</span></span>

<span data-ttu-id="72e32-129">Witaj zestawy SDK zapewniają różne opcje w celu wykonywania zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-129">hello SDKs provide various options for query execution.</span></span> <span data-ttu-id="72e32-130">Na przykład w środowisku .NET te opcje są dostępne w hello `FeedOptions` klasy.</span><span class="sxs-lookup"><span data-stu-id="72e32-130">For example, in .NET these options are available in hello `FeedOptions` class.</span></span> <span data-ttu-id="72e32-131">Witaj poniższej tabeli opisano te opcje i ich wpływ na czas wykonania zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-131">hello following table describes these options and how they impact query execution time.</span></span> 

| <span data-ttu-id="72e32-132">Opcja</span><span class="sxs-lookup"><span data-stu-id="72e32-132">Option</span></span> | <span data-ttu-id="72e32-133">Opis</span><span class="sxs-lookup"><span data-stu-id="72e32-133">Description</span></span> |
| ------ | ----------- |
| `EnableCrossPartitionQuery` | <span data-ttu-id="72e32-134">Należy ustawić tootrue dla dowolnego zapytania, które wymaga toobe wykonywane przez więcej niż jednej partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-134">Must be set tootrue for any query that requires toobe executed across more than one partition.</span></span> <span data-ttu-id="72e32-135">Jest to jawne flagi tooenable możesz toomake kompromisy świadome wydajności w czasie tworzenia.</span><span class="sxs-lookup"><span data-stu-id="72e32-135">This is an explicit flag tooenable you toomake conscious performance tradeoffs during development time.</span></span> |
| `EnableScanInQuery` | <span data-ttu-id="72e32-136">Musi być ustawiona tootrue, jeśli zdecydowano poza indeksowania, ale mimo to chcesz toorun hello zapytania za pomocą skanowania.</span><span class="sxs-lookup"><span data-stu-id="72e32-136">Must be set tootrue if you have opted out of indexing, but want toorun hello query via a scan anyway.</span></span> <span data-ttu-id="72e32-137">Tylko dotyczy indeksowania hello zażądał filtr ścieżki jest wyłączona.</span><span class="sxs-lookup"><span data-stu-id="72e32-137">Only applicable if indexing for hello requested filter path is disabled.</span></span> | 
| `MaxItemCount` | <span data-ttu-id="72e32-138">Witaj maksymalną liczbę elementów tooreturn na serwer toohello obiegu.</span><span class="sxs-lookup"><span data-stu-id="72e32-138">hello maximum number of items tooreturn per round trip toohello server.</span></span> <span data-ttu-id="72e32-139">Ustawienie zbyt-1, możesz pozwolić, aby powitania serwera zarządzania hello liczbę elementów.</span><span class="sxs-lookup"><span data-stu-id="72e32-139">By setting too-1, you can let hello server manage hello number of items.</span></span> <span data-ttu-id="72e32-140">Alternatywnie można obniżyć tooretrieve to wartość tylko niewielka liczba elementów na obiegu.</span><span class="sxs-lookup"><span data-stu-id="72e32-140">Or, you can lower this value tooretrieve only a small number of items per round trip.</span></span> 
| `MaxBufferedItemCount` | <span data-ttu-id="72e32-141">Jest to opcja po stronie klienta i używane zużycie pamięci hello toolimit, podczas wykonywania różnych partycji ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="72e32-141">This is a client-side option, and used toolimit hello memory consumption when performing cross-partition ORDER BY.</span></span> <span data-ttu-id="72e32-142">Wyższa wartość pomaga zmniejszenia opóźnienia hello sortowania różnych partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-142">A higher value helps reduce hello latency of cross-partition sorting.</span></span> |
| `MaxDegreeOfParallelism` | <span data-ttu-id="72e32-143">Pobiera lub ustawia hello liczba jednoczesnych operacji podczas równoległego wykonywania zapytań w hello usługi Azure DocumentDB bazy danych należy uruchomić po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="72e32-143">Gets or sets hello number of concurrent operations run client side during parallel query execution in hello Azure DocumentDB database service.</span></span> <span data-ttu-id="72e32-144">Wartość właściwości dodatnią ogranicza hello liczbę jednoczesnych operacji toohello ustaw wartość.</span><span class="sxs-lookup"><span data-stu-id="72e32-144">A positive property value limits hello number of concurrent operations toohello set value.</span></span> <span data-ttu-id="72e32-145">Jeśli jest ustawiona tooless niż 0, hello system automatycznie decyduje hello liczba jednoczesnych operacji toorun.</span><span class="sxs-lookup"><span data-stu-id="72e32-145">If it is set tooless than 0, hello system automatically decides hello number of concurrent operations toorun.</span></span> |
| `PopulateQueryMetrics` | <span data-ttu-id="72e32-146">Czas ładowania umożliwia szczegółowe rejestrowanie statystyk czasu trwania fazy wykonywania zapytania, takie jak czas kompilacji, czas pętli indeksu i dokumentu.</span><span class="sxs-lookup"><span data-stu-id="72e32-146">Enables detailed logging of statistics of time spent in various phases of query execution like compilation time, index loop time, and document load time.</span></span> <span data-ttu-id="72e32-147">Problemy z wydajnością zapytania toodiagnose pomocą techniczną platformy Azure mogą udostępniać dane wyjściowe statystyki zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-147">You can share output from query statistics with Azure Support toodiagnose query performance issues.</span></span> |
| `RequestContinuation` | <span data-ttu-id="72e32-148">Wykonanie kwerendy można wznowić przez przekazywanie token kontynuacji nieprzezroczyste hello zwrócony przez każde zapytanie.</span><span class="sxs-lookup"><span data-stu-id="72e32-148">You can resume query execution by passing in hello opaque continuation token returned by any query.</span></span> <span data-ttu-id="72e32-149">token kontynuacji Hello hermetyzuje stan wszystkich wymaganych do wykonywania zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-149">hello continuation token encapsulates all state required for query execution.</span></span> |
| `ResponseContinuationTokenLimitInKb` | <span data-ttu-id="72e32-150">Można ograniczyć hello maksymalny rozmiar hello token kontynuacji zwrócony przez serwer hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-150">You can limit hello maximum size of hello continuation token returned by hello server.</span></span> <span data-ttu-id="72e32-151">Może być potrzebny tooset tego hosta aplikacji ma limity rozmiaru nagłówka odpowiedzi.</span><span class="sxs-lookup"><span data-stu-id="72e32-151">You might need tooset this if your application host has limits on response header size.</span></span> <span data-ttu-id="72e32-152">To ustawienie może zwiększyć hello ogólny czas trwania i RUs używane dla hello zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-152">Setting this may increase hello overall duration and RUs consumed for hello query.</span></span>  |

<span data-ttu-id="72e32-153">Na przykład wytłumaczone przedstawiono przykładowe zapytanie na klucz partycji, Żądana kolekcja o `/city` jako partycja hello klucza i elastycznie o 100 000 RU/s przepustowości.</span><span class="sxs-lookup"><span data-stu-id="72e32-153">For example, let's take an example query on partition key requested on a collection with `/city` as hello partition key and provisioned with 100,000 RU/s of throughput.</span></span> <span data-ttu-id="72e32-154">To zapytanie przy użyciu żądania `CreateDocumentQuery<T>` w środowisku .NET, takie jak następujące hello:</span><span class="sxs-lookup"><span data-stu-id="72e32-154">You request this query using `CreateDocumentQuery<T>` in .NET like hello following:</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
        MaxItemCount = -1, 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();
```

<span data-ttu-id="72e32-155">Witaj fragment SDK przedstawionych powyżej, odpowiada toohello następujące żądania interfejsu API REST:</span><span class="sxs-lookup"><span data-stu-id="72e32-155">hello SDK snippet shown above, corresponds toohello following REST API request:</span></span>

```
POST https://arramacquerymetrics-westus.documents.azure.com/dbs/db/colls/sample/docs HTTP/1.1
x-ms-continuation: 
x-ms-documentdb-isquery: True
x-ms-max-item-count: -1
x-ms-documentdb-query-enablecrosspartition: True
x-ms-documentdb-query-parallelizecrosspartitionquery: True
x-ms-documentdb-query-iscontinuationexpected: True
x-ms-documentdb-populatequerymetrics: True
x-ms-date: Tue, 27 Jun 2017 21:52:18 GMT
authorization: type%3dmaster%26ver%3d1.0%26sig%3drp1Hi83Y8aVV5V6LzZ6xhtQVXRAMz0WNMnUuvriUv%2b4%3d
x-ms-session-token: 7:8,6:2008,5:8,4:2008,3:8,2:2008,1:8,0:8,9:8,8:4008
Cache-Control: no-cache
x-ms-consistency-level: Session
User-Agent: documentdb-dotnet-sdk/1.14.1 Host/32-bit MicrosoftWindowsNT/6.2.9200.0
x-ms-version: 2017-02-22
Accept: application/json
Content-Type: application/query+json
Host: arramacquerymetrics-westus.documents.azure.com
Content-Length: 52
Expect: 100-continue

{"query":"SELECT * FROM c WHERE c.city = 'Seattle'"}
```

<span data-ttu-id="72e32-156">Każdej stronie wykonywania zapytania odpowiada tooa interfejsu API REST `POST` z hello `Accept: application/query+json` nagłówka i hello zapytanie SQL w treści hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-156">Each query execution page corresponds tooa REST API `POST` with hello `Accept: application/query+json` header, and hello SQL query in hello body.</span></span> <span data-ttu-id="72e32-157">Każde zapytanie sprawia, że jeden lub więcej server toohello komunikacji dwustronnej z hello `x-ms-continuation` token powtarzana między wykonaniem tooresume powitania klienta i serwera.</span><span class="sxs-lookup"><span data-stu-id="72e32-157">Each query makes one or more round trips toohello server with hello `x-ms-continuation` token echoed between hello client and server tooresume execution.</span></span> <span data-ttu-id="72e32-158">Opcje konfiguracji Hello w FeedOptions są przekazywane toohello serwera w formie hello nagłówki żądania.</span><span class="sxs-lookup"><span data-stu-id="72e32-158">hello configuration options in FeedOptions are passed toohello server in hello form of request headers.</span></span> <span data-ttu-id="72e32-159">Na przykład `MaxItemCount` odpowiada za`x-ms-max-item-count`.</span><span class="sxs-lookup"><span data-stu-id="72e32-159">For example, `MaxItemCount` corresponds too`x-ms-max-item-count`.</span></span> 

<span data-ttu-id="72e32-160">Witaj żądania zwraca następujące hello (obcięty dla czytelności) odpowiedzi:</span><span class="sxs-lookup"><span data-stu-id="72e32-160">hello request returns hello following (truncated for readability) response:</span></span>

```
HTTP/1.1 200 Ok
Cache-Control: no-store, no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: application/json
Server: Microsoft-HTTPAPI/2.0
Strict-Transport-Security: max-age=31536000
x-ms-last-state-change-utc: Tue, 27 Jun 2017 21:01:57.561 GMT
x-ms-resource-quota: documentSize=10240;documentsSize=10485760;documentsCount=-1;collectionSize=10485760;
x-ms-resource-usage: documentSize=1;documentsSize=884;documentsCount=2000;collectionSize=1408;
x-ms-item-count: 2000
x-ms-schemaversion: 1.3
x-ms-alt-content-path: dbs/db/colls/sample
x-ms-content-path: +9kEANVq0wA=
x-ms-xp-role: 1
x-ms-documentdb-query-metrics: totalExecutionTimeInMs=33.67;queryCompileTimeInMs=0.06;queryLogicalPlanBuildTimeInMs=0.02;queryPhysicalPlanBuildTimeInMs=0.10;queryOptimizationTimeInMs=0.00;VMExecutionTimeInMs=32.56;indexLookupTimeInMs=0.36;documentLoadTimeInMs=9.58;systemFunctionExecuteTimeInMs=0.00;userFunctionExecuteTimeInMs=0.00;retrievedDocumentCount=2000;retrievedDocumentSize=1125600;outputDocumentCount=2000;writeOutputTimeInMs=18.10;indexUtilizationRatio=1.00
x-ms-request-charge: 604.42
x-ms-serviceversion: version=1.14.34.4
x-ms-activity-id: 0df8b5f6-83b9-4493-abda-cce6d0f91486
x-ms-session-token: 2:2008
x-ms-gatewayversion: version=1.14.33.2
Date: Tue, 27 Jun 2017 21:59:49 GMT
```

<span data-ttu-id="72e32-161">nagłówki odpowiedzi klucza Hello zwracane z kwerendy hello Uwzględnij hello następujące elementy:</span><span class="sxs-lookup"><span data-stu-id="72e32-161">hello key response headers returned from hello query include hello following:</span></span>

| <span data-ttu-id="72e32-162">Opcja</span><span class="sxs-lookup"><span data-stu-id="72e32-162">Option</span></span> | <span data-ttu-id="72e32-163">Opis</span><span class="sxs-lookup"><span data-stu-id="72e32-163">Description</span></span> |
| ------ | ----------- |
| `x-ms-item-count` | <span data-ttu-id="72e32-164">Witaj liczbę zwracanych w odpowiedzi hello elementów.</span><span class="sxs-lookup"><span data-stu-id="72e32-164">hello number of items returned in hello response.</span></span> <span data-ttu-id="72e32-165">To jest zależna od hello dostarczony `x-ms-max-item-count`, hello liczba elementów, które można zmieścić w ramach rozmiar ładunku odpowiedzi maksymalną hello, hello udostępnionej przepływności i czasu wykonywania zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-165">This is dependent on hello supplied `x-ms-max-item-count`, hello number of items that can be fit within hello maximum response payload size, hello provisioned throughput, and query execution time.</span></span> |  
| `x-ms-continuation:` | <span data-ttu-id="72e32-166">wykonanie token tooresume kontynuacji Hello hello zapytania, jeśli dostępne są dodatkowe wyniki.</span><span class="sxs-lookup"><span data-stu-id="72e32-166">hello continuation token tooresume execution of hello query, if additional results are available.</span></span> | 
| `x-ms-documentdb-query-metrics` | <span data-ttu-id="72e32-167">Statystyka zapytania Hello hello wykonywania.</span><span class="sxs-lookup"><span data-stu-id="72e32-167">hello query statistics for hello execution.</span></span> <span data-ttu-id="72e32-168">Jest to ciąg rozdzielany zawierający statystyk czasu poświęcony na powitania fazy wykonywania zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-168">This is a delimited string containing statistics of time spent in hello various phases of query execution.</span></span> <span data-ttu-id="72e32-169">Jeśli zwrócony `x-ms-documentdb-populatequerymetrics` ustawiono zbyt`True`.</span><span class="sxs-lookup"><span data-stu-id="72e32-169">Returned if `x-ms-documentdb-populatequerymetrics` is set too`True`.</span></span> | 
| `x-ms-request-charge` | <span data-ttu-id="72e32-170">Witaj liczba [jednostek żądania](request-units.md) używane przez hello zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-170">hello number of [request units](request-units.md) consumed by hello query.</span></span> | 

<span data-ttu-id="72e32-171">Aby uzyskać więcej informacji o opcjach i nagłówki żądania interfejsu API REST hello, zobacz [zapytań zasobów przy użyciu interfejsu API REST usługi DocumentDB hello](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span><span class="sxs-lookup"><span data-stu-id="72e32-171">For details on hello REST API request headers and options, see [Querying resources using hello DocumentDB REST API](https://docs.microsoft.com/rest/api/documentdb/querying-documentdb-resources-using-the-rest-api).</span></span>

## <a name="best-practices-for-query-performance"></a><span data-ttu-id="72e32-172">Najlepsze rozwiązania dotyczące wydajności zapytań</span><span class="sxs-lookup"><span data-stu-id="72e32-172">Best practices for query performance</span></span>
<span data-ttu-id="72e32-173">Oto Hello hello najbardziej typowych czynników, które mają wpływ na wydajność kwerend bazy danych Azure rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="72e32-173">hello following are hello most common factors that impact Azure Cosmos DB query performance.</span></span> <span data-ttu-id="72e32-174">Firma Microsoft głębiej do szczegółów każdego z tych tematów w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="72e32-174">We dig deeper into each of these topics in this article.</span></span>

| <span data-ttu-id="72e32-175">Współczynnik</span><span class="sxs-lookup"><span data-stu-id="72e32-175">Factor</span></span> | <span data-ttu-id="72e32-176">Porada</span><span class="sxs-lookup"><span data-stu-id="72e32-176">Tip</span></span> | 
| ------ | -----| 
| <span data-ttu-id="72e32-177">Aprowizowana przepływność</span><span class="sxs-lookup"><span data-stu-id="72e32-177">Provisioned throughput</span></span> | <span data-ttu-id="72e32-178">Zmierz RU dla kwerendy i zapewnić hello wymagane udostępnionej przepływności dla zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-178">Measure RU per query, and ensure that you have hello required provisioned throughput for your queries.</span></span> | 
| <span data-ttu-id="72e32-179">Partycjonowanie i kluczy partycji</span><span class="sxs-lookup"><span data-stu-id="72e32-179">Partitioning and partition keys</span></span> | <span data-ttu-id="72e32-180">Preferuj zapytania o wartości klucza partycji hello w klauzuli filtru powitania dla małych opóźnieniach.</span><span class="sxs-lookup"><span data-stu-id="72e32-180">Favor queries with hello partition key value in hello filter clause for low latency.</span></span> |
| <span data-ttu-id="72e32-181">Opcje zestawu SDK i zapytań</span><span class="sxs-lookup"><span data-stu-id="72e32-181">SDK and query options</span></span> | <span data-ttu-id="72e32-182">Postępuj zgodnie z zestawu SDK najlepszych rozwiązań, takich jak bezpośrednie połączenie między i Dostosuj opcje wykonywania zapytania po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="72e32-182">Follow SDK best practices like direct connectivity, and tune client-side query execution options.</span></span> |
| <span data-ttu-id="72e32-183">Opóźnienie sieci</span><span class="sxs-lookup"><span data-stu-id="72e32-183">Network latency</span></span> | <span data-ttu-id="72e32-184">Konta dla sieci obciążenie w pomiaru i używać wielu interfejsów API tooread z hello najbliżej regionu.</span><span class="sxs-lookup"><span data-stu-id="72e32-184">Account for network overhead in measurement, and use multi-homing APIs tooread from hello nearest region.</span></span> |
| <span data-ttu-id="72e32-185">Zasady indeksowania</span><span class="sxs-lookup"><span data-stu-id="72e32-185">Indexing Policy</span></span> | <span data-ttu-id="72e32-186">Upewnij się, że masz wymagane hello ścieżki/zasady indeksowania dla zapytania hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-186">Ensure that you have hello required indexing paths/policy for hello query.</span></span> |
| <span data-ttu-id="72e32-187">Metryki wykonywania kwerendy</span><span class="sxs-lookup"><span data-stu-id="72e32-187">Query execution metrics</span></span> | <span data-ttu-id="72e32-188">Przeanalizuj hello zapytania wykonywania metryki tooidentify potencjalnych ponownego kształtów zapytań i danych.</span><span class="sxs-lookup"><span data-stu-id="72e32-188">Analyze hello query execution metrics tooidentify potential rewrites of query and data shapes.</span></span>  |

### <a name="provisioned-throughput"></a><span data-ttu-id="72e32-189">Aprowizowana przepływność</span><span class="sxs-lookup"><span data-stu-id="72e32-189">Provisioned throughput</span></span>
<span data-ttu-id="72e32-190">Do rozwiązania Cosmos bazy danych możesz utworzyć kontenery danych, każda z zarezerwowaną przepływnością wyrażoną w żądaniu jednostki (RU) na sekundę.</span><span class="sxs-lookup"><span data-stu-id="72e32-190">In Cosmos DB, you create containers of data, each with reserved throughput expressed in request units (RU) per-second.</span></span> <span data-ttu-id="72e32-191">Odczyt dokumentu 1 KB jest 1 RU i każdej operacji (w tym zapytań) jest znormalizowana tooa stała liczba RUs w oparciu o jego złożoność.</span><span class="sxs-lookup"><span data-stu-id="72e32-191">A read of a 1-KB document is 1 RU, and every operation (including queries) is normalized tooa fixed number of RUs based on its complexity.</span></span> <span data-ttu-id="72e32-192">Na przykład, jeśli masz 1000 elastycznie RU/s dla Twojego kontenera i masz zapytania, takie jak `SELECT * FROM c WHERE c.city = 'Seattle'` która zużywa 5 RUs, a następnie przeprowadzić (1000 RU/s) / (5 RU na zapytanie) = 200 zapytania/s takie zapytania na sekundę.</span><span class="sxs-lookup"><span data-stu-id="72e32-192">For example, if you have 1000 RU/s provisioned for your container, and you have a query like `SELECT * FROM c WHERE c.city = 'Seattle'` that consumes 5 RUs, then you can perform (1000 RU/s) / (5 RU/query) = 200 query/s such queries per second.</span></span> 

<span data-ttu-id="72e32-193">Po przesłaniu zapytania więcej niż 200 na sekundę hello usługa jest uruchamiana limitów szybkości żądań przychodzących ponad 200/s.</span><span class="sxs-lookup"><span data-stu-id="72e32-193">If you submit more than 200 queries/sec, hello service starts rate-limiting incoming requests above 200/s.</span></span> <span data-ttu-id="72e32-194">Hello zestawy SDK automatycznie obsługi przypadek, wykonując wycofywania/ponów próbę, w związku z tym można zauważyć większego opóźnienia dla tych zapytań.</span><span class="sxs-lookup"><span data-stu-id="72e32-194">hello SDKs automatically handle this case by performing a backoff/retry, therefore you might notice a higher latency for these queries.</span></span> <span data-ttu-id="72e32-195">Zwiększenie toohello przepływności hello udostępniane wymagana wartość zwiększa Twojego zapytania opóźnienia i przepływności.</span><span class="sxs-lookup"><span data-stu-id="72e32-195">Increasing hello provisioned throughput toohello required value improves your query latency and throughput.</span></span> 

<span data-ttu-id="72e32-196">Zobacz toolearn więcej informacji na temat jednostek żądania [jednostek żądania](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-196">toolearn more about request units, see [Request units](request-units.md).</span></span>

### <a name="partitioning-and-partition-keys"></a><span data-ttu-id="72e32-197">Partycjonowanie i kluczy partycji</span><span class="sxs-lookup"><span data-stu-id="72e32-197">Partitioning and partition keys</span></span>
<span data-ttu-id="72e32-198">Z bazy danych rozwiązania Cosmos platformy Azure zwykle zapytania wykonaj w powitania po zamówienia najszybszym/najbardziej efektywne tooslower/mniej wydajne.</span><span class="sxs-lookup"><span data-stu-id="72e32-198">With Azure Cosmos DB, typically queries perform in hello following order from fastest/most efficient tooslower/less efficient.</span></span> 

* <span data-ttu-id="72e32-199">Pobierz klucz jednej partycji i klucz</span><span class="sxs-lookup"><span data-stu-id="72e32-199">GET on a single partition key and item key</span></span>
* <span data-ttu-id="72e32-200">Zapytanie z klauzuli filtru dla klucza jednej partycji</span><span class="sxs-lookup"><span data-stu-id="72e32-200">Query with a filter clause on a single partition key</span></span>
* <span data-ttu-id="72e32-201">Zapytanie bez klauzuli filtru równości lub zakres na dowolną właściwość</span><span class="sxs-lookup"><span data-stu-id="72e32-201">Query without an equality or range filter clause on any property</span></span>
* <span data-ttu-id="72e32-202">Zapytanie bez filtrów</span><span class="sxs-lookup"><span data-stu-id="72e32-202">Query without filters</span></span>

<span data-ttu-id="72e32-203">Bada tego tooconsult potrzeby wszystkie partycje muszą większego opóźnienia i może wykorzystać RUs wyższy.</span><span class="sxs-lookup"><span data-stu-id="72e32-203">Queries that need tooconsult all partitions need higher latency, and can consume higher RUs.</span></span> <span data-ttu-id="72e32-204">Ponieważ każda partycja zawiera automatycznego indeksowania względem wszystkich właściwości, hello zapytania mogą być przekazywane wydajnie z hello indeksu w tym przypadku.</span><span class="sxs-lookup"><span data-stu-id="72e32-204">Since each partition has automatic indexing against all properties, hello query can be served efficiently from hello index in this case.</span></span> <span data-ttu-id="72e32-205">Można wykonać zapytania, obejmujące szybsze partycje przy użyciu opcji równoległości hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-205">You can make queries that span partitions faster by using hello parallelism options.</span></span>

<span data-ttu-id="72e32-206">Zobacz toolearn więcej informacji na temat partycjonowania i kluczy partycji [partycjonowania w usłudze Azure DB rozwiązania Cosmos](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-206">toolearn more about partitioning and partition keys, see [Partitioning in Azure Cosmos DB](partition-data.md).</span></span>

### <a name="sdk-and-query-options"></a><span data-ttu-id="72e32-207">Opcje zestawu SDK i zapytań</span><span class="sxs-lookup"><span data-stu-id="72e32-207">SDK and query options</span></span>
<span data-ttu-id="72e32-208">Zobacz [porady dotyczące wydajności](performance-tips.md) i [testowania wydajności](performance-testing.md) dla jak tooget hello najlepszej wydajności po stronie klienta z bazy danych usługi Azure rozwiązania Cosmos.</span><span class="sxs-lookup"><span data-stu-id="72e32-208">See [Performance Tips](performance-tips.md) and [Performance testing](performance-testing.md) for how tooget hello best client-side performance from Azure Cosmos DB.</span></span> <span data-ttu-id="72e32-209">Obejmuje to przy użyciu hello najnowsze zestawów SDK, konfigurowanie konfiguracje specyficzne dla platformy, takich jak domyślną liczbę połączeń, częstotliwość operacji wyrzucania elementów bezużytecznych i przy użyciu opcji łączności lekkie, takich jak bezpośrednio/TCP.</span><span class="sxs-lookup"><span data-stu-id="72e32-209">This includes using hello latest SDKs, configuring platform-specific configurations like default number of connections, frequency of garbage collection, and using lightweight connectivity options like Direct/TCP.</span></span> 


#### <a name="max-item-count"></a><span data-ttu-id="72e32-210">Liczba maksymalna liczba elementów.</span><span class="sxs-lookup"><span data-stu-id="72e32-210">Max Item Count</span></span>
<span data-ttu-id="72e32-211">W przypadku kwerend hello wartość `MaxItemCount` może mieć znaczący wpływ na czas kwerendy end-to-end.</span><span class="sxs-lookup"><span data-stu-id="72e32-211">For queries, hello value of `MaxItemCount` can have a significant impact on end-to-end query time.</span></span> <span data-ttu-id="72e32-212">Każdy Rundy serwera toohello zwróci nie więcej niż hello liczba elementów w `MaxItemCount` (domyślnie: 100 elementów).</span><span class="sxs-lookup"><span data-stu-id="72e32-212">Each round trip toohello server will return no more than hello number of items in `MaxItemCount` (Default of 100 items).</span></span> <span data-ttu-id="72e32-213">Ustawienie tej wartości wyższej tooa (-1 jest maksymalną i zalecanym) poprawia ogólną czasu trwania kwerendy poprzez ograniczenie hello liczby rund między serwerem a klientem, szczególnie w przypadku zapytań dotyczących dużych zestawów wyników.</span><span class="sxs-lookup"><span data-stu-id="72e32-213">Setting this tooa higher value (-1 is maximum, and recommended) will improve your query duration overall by limiting hello number of round trips between server and client, especially for queries with large result sets.</span></span>

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxItemCount = -1, 
    }).AsDocumentQuery();
```

#### <a name="max-degree-of-parallelism"></a><span data-ttu-id="72e32-214">Maksymalny stopień równoległości</span><span class="sxs-lookup"><span data-stu-id="72e32-214">Max Degree of Parallelism</span></span>
<span data-ttu-id="72e32-215">Dla zapytań, dostroić hello `MaxDegreeOfParallelism` tooidentify hello konfiguracje najlepsze dla aplikacji, zwłaszcza jeśli wykonywania zapytań między partycji (bez filtr na wartość klucza partycji hello).</span><span class="sxs-lookup"><span data-stu-id="72e32-215">For queries, tune hello `MaxDegreeOfParallelism` tooidentify hello best configurations for your application, especially if you perform cross-partition queries (without a filter on hello partition-key value).</span></span> <span data-ttu-id="72e32-216">`MaxDegreeOfParallelism`Steruje hello maksymalną liczbę równoległych zadań, tj. hello maksymalnie toobe partycje odwiedzi równolegle.</span><span class="sxs-lookup"><span data-stu-id="72e32-216">`MaxDegreeOfParallelism`  controls hello maximum number of parallel tasks, i.e., hello maximum of partitions toobe visited in parallel.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        MaxDegreeOfParallelism = -1, 
        EnableCrossPartitionQuery = true 
    }).AsDocumentQuery();
```

<span data-ttu-id="72e32-217">Załóżmy, że</span><span class="sxs-lookup"><span data-stu-id="72e32-217">Let’s assume that</span></span>
* <span data-ttu-id="72e32-218">D = Domyślna maksymalna liczba zadań równoległych (łączna liczba procesorów na powitania klienta maszynie =)</span><span class="sxs-lookup"><span data-stu-id="72e32-218">D = Default Maximum number of parallel tasks (= total number of processor in hello client machine)</span></span>
* <span data-ttu-id="72e32-219">P = określone przez użytkownika maksymalną liczbę równoległych zadań</span><span class="sxs-lookup"><span data-stu-id="72e32-219">P = User-specified maximum number of parallel tasks</span></span>
* <span data-ttu-id="72e32-220">N = liczba partycji, które wymaga toobe odwiedzi odpowiedzi na kwerendę</span><span class="sxs-lookup"><span data-stu-id="72e32-220">N = Number of partitions that needs  toobe visited for answering a query</span></span>

<span data-ttu-id="72e32-221">Poniżej przedstawiono efekty zapytania równoległe hello spowoduje zachowanie dla różnych wartości P.</span><span class="sxs-lookup"><span data-stu-id="72e32-221">Following are implications of how hello parallel queries would behave for different values of P.</span></span>
* <span data-ttu-id="72e32-222">(P == 0) = > Tryb szeregowe</span><span class="sxs-lookup"><span data-stu-id="72e32-222">(P == 0) => Serial Mode</span></span>
* <span data-ttu-id="72e32-223">(P == 1) = > maksymalna jednego zadania</span><span class="sxs-lookup"><span data-stu-id="72e32-223">(P == 1) => Maximum of one task</span></span>
* <span data-ttu-id="72e32-224">(P > 1) = > zadań równoległych Min (P, N)</span><span class="sxs-lookup"><span data-stu-id="72e32-224">(P > 1) => Min (P, N) parallel tasks</span></span> 
* <span data-ttu-id="72e32-225">(P < 1) = > zadań równoległych Min (N, D)</span><span class="sxs-lookup"><span data-stu-id="72e32-225">(P < 1) => Min (N, D) parallel tasks</span></span>

<span data-ttu-id="72e32-226">Informacje o wersji zestawu SDK i Zobacz szczegóły dotyczące zaimplementowanych klasy i metody [zestawów SDK usługi DocumentDB](documentdb-sdk-dotnet.md)</span><span class="sxs-lookup"><span data-stu-id="72e32-226">For SDK release notes, and details on implemented classes and methods see [DocumentDB SDKs](documentdb-sdk-dotnet.md)</span></span>

### <a name="network-latency"></a><span data-ttu-id="72e32-227">Opóźnienie sieci</span><span class="sxs-lookup"><span data-stu-id="72e32-227">Network latency</span></span>
<span data-ttu-id="72e32-228">Zobacz [dystrybucji globalnej bazy danych Azure rozwiązania Cosmos](tutorial-global-distribution-documentdb.md) jak tooset Konfigurowanie dystrybucji globalne i połączyć toohello najbliżej regionu.</span><span class="sxs-lookup"><span data-stu-id="72e32-228">See [Azure Cosmos DB global distribution](tutorial-global-distribution-documentdb.md) for how tooset up global distribution, and connect toohello closest region.</span></span> <span data-ttu-id="72e32-229">Opóźnienie sieci ma znaczący wpływ na wydajność zapytań, muszą toomake wiele rund lub pobrać dużych zestawu wyników z kwerendy hello.</span><span class="sxs-lookup"><span data-stu-id="72e32-229">Network latency has a significant impact on query performance when you need toomake multiple round-trips or retrieve a large result set from hello query.</span></span> 

<span data-ttu-id="72e32-230">Witaj sekcji metryki wykonywania zapytania wyjaśniono, jak tooretrieve hello serwera czas wykonywania kwerend ( `totalExecutionTimeInMs`), dzięki czemu można odróżnić czas przeznaczony na wykonanie kwerendy i czas przesyłania w sieci.</span><span class="sxs-lookup"><span data-stu-id="72e32-230">hello section on query execution metrics explains how tooretrieve hello server execution time of queries ( `totalExecutionTimeInMs`), so that you can differentiate between time spent in query execution and time spent in network transit.</span></span>

### <a name="indexing-policy"></a><span data-ttu-id="72e32-231">Zasady indeksowania</span><span class="sxs-lookup"><span data-stu-id="72e32-231">Indexing policy</span></span>
<span data-ttu-id="72e32-232">Zobacz [Konfigurowanie zasady indeksowania](indexing-policies.md) indeksowania ścieżki, rodzajów i tryby i ich wpływ na wykonanie kwerendy.</span><span class="sxs-lookup"><span data-stu-id="72e32-232">See [Configuring indexing policy](indexing-policies.md) for indexing paths, kinds, and modes, and how they impact query execution.</span></span> <span data-ttu-id="72e32-233">Domyślnie hello indeksowania zasad używa skrótu indeksowania dla ciągów, które obowiązuje dla zapytań o równość, ale nie dla zakresu zapytania/order przez zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-233">By default, hello indexing policy uses Hash indexing for strings, which is effective for equality queries, but not for range queries/order by queries.</span></span> <span data-ttu-id="72e32-234">Jeśli potrzebujesz kwerendy zakresu dla ciągów, zaleca się określenie hello typ indeksu zakresu dla wszystkich ciągów.</span><span class="sxs-lookup"><span data-stu-id="72e32-234">If you need range queries for strings, we recommend specifying hello Range index type for all strings.</span></span> 

## <a name="query-execution-metrics"></a><span data-ttu-id="72e32-235">Metryki wykonywania kwerendy</span><span class="sxs-lookup"><span data-stu-id="72e32-235">Query execution metrics</span></span>
<span data-ttu-id="72e32-236">Szczegółowe metryki na wykonanie kwerendy można uzyskać przez przekazywanie hello opcjonalne `x-ms-documentdb-populatequerymetrics` nagłówka (`FeedOptions.PopulateQueryMetrics` w hello zestawu .NET SDK).</span><span class="sxs-lookup"><span data-stu-id="72e32-236">You can obtain detailed metrics on query execution by passing in hello optional `x-ms-documentdb-populatequerymetrics` header (`FeedOptions.PopulateQueryMetrics` in hello .NET SDK).</span></span> <span data-ttu-id="72e32-237">Wartość zwracana w Hello `x-ms-documentdb-query-metrics` ma powitania po pary klucz wartość przeznaczone do zaawansowanego rozwiązywania problemów wykonanie zapytania.</span><span class="sxs-lookup"><span data-stu-id="72e32-237">hello value returned in `x-ms-documentdb-query-metrics` has hello following key-value pairs meant for advanced troubleshooting of query execution.</span></span> 

```cs
IDocumentQuery<dynamic> query = client.CreateDocumentQuery(
    UriFactory.CreateDocumentCollectionUri(DatabaseName, CollectionName), 
    "SELECT * FROM c WHERE c.city = 'Seattle'", 
    new FeedOptions 
    { 
        PopulateQueryMetrics = true, 
    }).AsDocumentQuery();

FeedResponse<dynamic> result = await query.ExecuteNextAsync();

// Returns metrics by partition key range Id
IReadOnlyDictionary<string, QueryMetrics> metrics = result.QueryMetrics;

```

| <span data-ttu-id="72e32-238">Metryka</span><span class="sxs-lookup"><span data-stu-id="72e32-238">Metric</span></span> | <span data-ttu-id="72e32-239">Jednostka</span><span class="sxs-lookup"><span data-stu-id="72e32-239">Unit</span></span> | <span data-ttu-id="72e32-240">Opis</span><span class="sxs-lookup"><span data-stu-id="72e32-240">Description</span></span> | 
| ------ | -----| ----------- |
| `totalExecutionTimeInMs` | <span data-ttu-id="72e32-241">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-241">milliseconds</span></span> | <span data-ttu-id="72e32-242">Czas wykonywania kwerendy</span><span class="sxs-lookup"><span data-stu-id="72e32-242">Query execution time</span></span> | 
| `queryCompileTimeInMs` | <span data-ttu-id="72e32-243">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-243">milliseconds</span></span> | <span data-ttu-id="72e32-244">Czas kompilacji kwerendy</span><span class="sxs-lookup"><span data-stu-id="72e32-244">Query compile time</span></span>  | 
| `queryLogicalPlanBuildTimeInMs` | <span data-ttu-id="72e32-245">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-245">milliseconds</span></span> | <span data-ttu-id="72e32-246">Plan logicznej zapytania toobuild czasu</span><span class="sxs-lookup"><span data-stu-id="72e32-246">Time toobuild logical query plan</span></span> | 
| `queryPhysicalPlanBuildTimeInMs` | <span data-ttu-id="72e32-247">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-247">milliseconds</span></span> | <span data-ttu-id="72e32-248">Plan zapytania fizycznych toobuild czasu</span><span class="sxs-lookup"><span data-stu-id="72e32-248">Time toobuild physical query plan</span></span> | 
| `queryOptimizationTimeInMs` | <span data-ttu-id="72e32-249">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-249">milliseconds</span></span> | <span data-ttu-id="72e32-250">Czas spędzony w zapytaniu optymalizacji</span><span class="sxs-lookup"><span data-stu-id="72e32-250">Time spent in optimizing query</span></span> | 
| `VMExecutionTimeInMs` | <span data-ttu-id="72e32-251">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-251">milliseconds</span></span> | <span data-ttu-id="72e32-252">Czas spędzony w czasie wykonywania kwerendy</span><span class="sxs-lookup"><span data-stu-id="72e32-252">Time spent in query runtime</span></span> | 
| `indexLookupTimeInMs` | <span data-ttu-id="72e32-253">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-253">milliseconds</span></span> | <span data-ttu-id="72e32-254">Czas spędzony w warstwie fizycznej indeksu</span><span class="sxs-lookup"><span data-stu-id="72e32-254">Time spent in physical index layer</span></span> | 
| `documentLoadTimeInMs` | <span data-ttu-id="72e32-255">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-255">milliseconds</span></span> | <span data-ttu-id="72e32-256">Czas ładowania dokumentów</span><span class="sxs-lookup"><span data-stu-id="72e32-256">Time spent in loading documents</span></span>  | 
| `systemFunctionExecuteTimeInMs` | <span data-ttu-id="72e32-257">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-257">milliseconds</span></span> | <span data-ttu-id="72e32-258">Łączny czas podczas wykonywania funkcji (wbudowane) systemu w milisekundach</span><span class="sxs-lookup"><span data-stu-id="72e32-258">Total time spent executing system (built-in) functions in milliseconds</span></span>  | 
| `userFunctionExecuteTimeInMs` | <span data-ttu-id="72e32-259">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-259">milliseconds</span></span> | <span data-ttu-id="72e32-260">Łączny czas podczas wykonywania funkcji zdefiniowanej przez użytkownika (w milisekundach)</span><span class="sxs-lookup"><span data-stu-id="72e32-260">Total time spent executing user-defined functions in milliseconds</span></span> | 
| `retrievedDocumentCount` | <span data-ttu-id="72e32-261">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-261">milliseconds</span></span> | <span data-ttu-id="72e32-262">Całkowita liczba pobranych dokumentów</span><span class="sxs-lookup"><span data-stu-id="72e32-262">Total number of retrieved documents</span></span>  | 
| `retrievedDocumentSize` | <span data-ttu-id="72e32-263">Bajty</span><span class="sxs-lookup"><span data-stu-id="72e32-263">bytes</span></span> | <span data-ttu-id="72e32-264">Całkowity rozmiar pobrane dokumentów w bajtach</span><span class="sxs-lookup"><span data-stu-id="72e32-264">Total size of retrieved documents in bytes</span></span>  | 
| `outputDocumentCount` | <span data-ttu-id="72e32-265">Liczba</span><span class="sxs-lookup"><span data-stu-id="72e32-265">count</span></span> | <span data-ttu-id="72e32-266">Liczba dokumentów, dane wyjściowe</span><span class="sxs-lookup"><span data-stu-id="72e32-266">Number of output documents</span></span> | 
| `writeOutputTimeInMs` | <span data-ttu-id="72e32-267">milisekundy</span><span class="sxs-lookup"><span data-stu-id="72e32-267">milliseconds</span></span> | <span data-ttu-id="72e32-268">Czas wykonywania kwerendy w milisekundach</span><span class="sxs-lookup"><span data-stu-id="72e32-268">Query execution time in milliseconds</span></span> | 
| `indexUtilizationRatio` | <span data-ttu-id="72e32-269">stosunek (< = 1)</span><span class="sxs-lookup"><span data-stu-id="72e32-269">ratio (<=1)</span></span> | <span data-ttu-id="72e32-270">Załadowano stosunek liczby dokumentów, które są dopasowane wg hello filtru toohello liczba dokumentów</span><span class="sxs-lookup"><span data-stu-id="72e32-270">Ratio of number of documents matched by hello filter toohello number of documents loaded</span></span>  | 

<span data-ttu-id="72e32-271">Hello klient zestawów SDK może wewnętrznie utworzyć wiele operacji tooserve hello zapytania w ramach każdej partycji.</span><span class="sxs-lookup"><span data-stu-id="72e32-271">hello client SDKs may internally make multiple query operations tooserve hello query within each partition.</span></span> <span data-ttu-id="72e32-272">Witaj klient wysyła więcej niż jedno wywołanie każdej partycji o większym hello całkowita liczba wyników `x-ms-max-item-count`, jeśli zapytanie hello przekracza hello udostępnionej przepływności dla partycji hello, lub jeśli hello ładunek zapytania osiągnie maksymalny rozmiar hello na stronie lub jeśli hello zapytania osiągnie hello System przydzielony limit czasu.</span><span class="sxs-lookup"><span data-stu-id="72e32-272">hello client makes more than one call per-partition if hello total results exceed `x-ms-max-item-count`, if hello query exceeds hello provisioned throughput for hello partition, or if hello query payload reaches hello maximum size per page, or if hello query reaches hello system allocated timeout limit.</span></span> <span data-ttu-id="72e32-273">Zwraca każde wykonanie zapytania z częściowa `x-ms-documentdb-query-metrics` dla tej strony.</span><span class="sxs-lookup"><span data-stu-id="72e32-273">Each partial query execution returns a `x-ms-documentdb-query-metrics` for that page.</span></span> 

<span data-ttu-id="72e32-274">Poniżej przedstawiono niektóre przykładowe zapytania i w jaki sposób toointerpret niektóre metryki hello zwrócone przez wykonanie zapytania:</span><span class="sxs-lookup"><span data-stu-id="72e32-274">Here are some sample queries, and how toointerpret some of hello metrics returned from query execution:</span></span> 

| <span data-ttu-id="72e32-275">Zapytanie</span><span class="sxs-lookup"><span data-stu-id="72e32-275">Query</span></span> | <span data-ttu-id="72e32-276">Metryka próbki</span><span class="sxs-lookup"><span data-stu-id="72e32-276">Sample Metric</span></span> | <span data-ttu-id="72e32-277">Opis</span><span class="sxs-lookup"><span data-stu-id="72e32-277">Description</span></span> | 
| ------ | -----| ----------- |
| `SELECT TOP 100 * FROM c` | `"RetrievedDocumentCount": 101` | <span data-ttu-id="72e32-278">Witaj liczba dokumentów pobierana jest 100 + 1 klauzuli TOP hello toomatch.</span><span class="sxs-lookup"><span data-stu-id="72e32-278">hello number of documents retrieved is 100+1 toomatch hello TOP clause.</span></span> <span data-ttu-id="72e32-279">Przede wszystkim jest zużywany czas kwerendy w `WriteOutputTime` i `DocumentLoadTime` ponieważ skanowania.</span><span class="sxs-lookup"><span data-stu-id="72e32-279">Query time is mostly spent in `WriteOutputTime` and `DocumentLoadTime` since it is a scan.</span></span> | 
| `SELECT TOP 500 * FROM c` | `"RetrievedDocumentCount": 501` | <span data-ttu-id="72e32-280">RetrievedDocumentCount jest teraz nowszej (500 + 1 toomatch hello klauzuli TOP).</span><span class="sxs-lookup"><span data-stu-id="72e32-280">RetrievedDocumentCount is now higher (500+1 toomatch hello TOP clause).</span></span> | 
| `SELECT * FROM c WHERE c.N = 55` | `"IndexLookupTime": "00:00:00.0009500"` | <span data-ttu-id="72e32-281">Około 0,9 ms odbywa się w IndexLookupTime dla klucza wyszukiwania, ponieważ jest on wyszukiwania indeksu `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="72e32-281">About 0.9 ms is spent in IndexLookupTime for a key lookup, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT * FROM c WHERE c.N > 55` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="72e32-282">Nieco więcej (1.7 ms) czas, w IndexLookupTime za pośrednictwem skanowania zakresu, ponieważ jest on wyszukiwania indeksu `/N/?`.</span><span class="sxs-lookup"><span data-stu-id="72e32-282">Slightly more time (1.7 ms) spent in IndexLookupTime over a range scan, because it's an index lookup on `/N/?`.</span></span> | 
| `SELECT TOP 500 c.N FROM c` | `"IndexLookupTime": "00:00:00.0017700"` | <span data-ttu-id="72e32-283">Sam czas spędzony na `DocumentLoadTime` jako poprzednich zapytań, ale niższe `WriteOutputTime` ponieważ możemy Cię projekcji tylko jedną właściwość.</span><span class="sxs-lookup"><span data-stu-id="72e32-283">Same time spent on `DocumentLoadTime` as previous queries, but lower `WriteOutputTime` because we're projecting only one property.</span></span> | 
| `SELECT TOP 500 udf.toPercent(c.N) FROM c` | `"UserDefinedFunctionExecutionTime": "00:00:00.2136500"` | <span data-ttu-id="72e32-284">Działania o 213 ms `UserDefinedFunctionExecutionTime` wykonywania hello UDF w każdej wartości `c.N`.</span><span class="sxs-lookup"><span data-stu-id="72e32-284">About 213 ms is spent in `UserDefinedFunctionExecutionTime` executing hello UDF on each value of `c.N`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(c.Name, 'Den')` | `"IndexLookupTime": "00:00:00.0006400", "SystemFunctionExecutionTime": "00:00:00.0074100"` | <span data-ttu-id="72e32-285">Działania około 0,6 ms `IndexLookupTime` na `/Name/?`.</span><span class="sxs-lookup"><span data-stu-id="72e32-285">About 0.6 ms is spent in `IndexLookupTime` on `/Name/?`.</span></span> <span data-ttu-id="72e32-286">Większość hello zapytania czas wykonania (ms ~ 7) w `SystemFunctionExecutionTime`.</span><span class="sxs-lookup"><span data-stu-id="72e32-286">Most of hello query execution time (~7 ms) in `SystemFunctionExecutionTime`.</span></span> |
| `SELECT TOP 500 c.Name FROM c WHERE STARTSWITH(LOWER(c.Name), 'den')` | `"IndexLookupTime": "00:00:00", "RetrievedDocumentCount": 2491,  "OutputDocumentCount": 500` | <span data-ttu-id="72e32-287">Ponieważ jest on używany jako skanowania jest przeprowadzana kwerenda `LOWER`, a 500 poza 2491 pobrane dokumenty zostaną zwrócone.</span><span class="sxs-lookup"><span data-stu-id="72e32-287">Query is performed as a scan because it uses `LOWER`, and 500 out of 2491 retrieved documents are returned.</span></span> |


## <a name="next-steps"></a><span data-ttu-id="72e32-288">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="72e32-288">Next steps</span></span>
* <span data-ttu-id="72e32-289">toolearn o operatorów zapytań SQL hello obsługiwane i słów kluczowych, zobacz [zapytania SQL](documentdb-sql-query.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-289">toolearn about hello supported SQL query operators and keywords, see [SQL query](documentdb-sql-query.md).</span></span> 
* <span data-ttu-id="72e32-290">Zobacz toolearn o jednostkach żądania [jednostek żądania](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="72e32-290">toolearn about request units, see [request units](request-units.md).</span></span>
* <span data-ttu-id="72e32-291">toolearn o zasady indeksowania, zobacz [indeksowania zasad](indexing-policies.md)</span><span class="sxs-lookup"><span data-stu-id="72e32-291">toolearn about indexing policy, see [indexing policy](indexing-policies.md)</span></span> 


