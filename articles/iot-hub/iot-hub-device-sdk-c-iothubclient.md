---
title: "urządzenia IoT aaaAzure zestawu SDK dla języka C - IoTHubClient | Dokumentacja firmy Microsoft"
description: "Jak toouse hello IoTHubClient biblioteki hello Azure IoT urządzenia zestawu SDK dla aplikacji dla urządzeń toocreate C komunikujących się z Centrum IoT."
services: iot-hub
documentationcenter: 
author: olivierbloch
manager: timlt
editor: 
ms.assetid: 828cf2bf-999d-4b8a-8a28-c7c901629600
ms.service: iot-hub
ms.devlang: cpp
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/06/2016
ms.author: obloch
ms.openlocfilehash: d1ece79e9ba6d1e5fd45cabb8fca393b24052e07
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="azure-iot-device-sdk-for-c--more-about-iothubclient"></a><span data-ttu-id="0ce61-103">Azure urządzenia IoT zestawu SDK dla języka C — więcej informacji na temat IoTHubClient</span><span class="sxs-lookup"><span data-stu-id="0ce61-103">Azure IoT device SDK for C – more about IoTHubClient</span></span>
<span data-ttu-id="0ce61-104">Witaj [najpierw artykuł](iot-hub-device-sdk-c-intro.md) w tej serii wprowadzone hello **urządzenia Azure IoT SDK dla języka C**. Tym artykule wyjaśniono, że istnieją dwie warstwy architektury w zestawie SDK.</span><span class="sxs-lookup"><span data-stu-id="0ce61-104">hello [first article](iot-hub-device-sdk-c-intro.md) in this series introduced hello **Azure IoT device SDK for C**. That article explained that there are two architectural layers in SDK.</span></span> <span data-ttu-id="0ce61-105">W podstawowej hello jest hello **IoTHubClient** biblioteki, który bezpośrednio prowadzi komunikację z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-105">At hello base is hello **IoTHubClient** library which directly manages communication with IoT Hub.</span></span> <span data-ttu-id="0ce61-106">Istnieje również hello **serializator** biblioteki, która tworzy znajdujący się na tooprovide szeregowanie usług.</span><span class="sxs-lookup"><span data-stu-id="0ce61-106">There's also hello **serializer** library that builds on top of that tooprovide serialization services.</span></span> <span data-ttu-id="0ce61-107">W tym artykule udostępnimy dodatkowych szczegółów na powitania **IoTHubClient** biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-107">In this article we'll provide additional detail on hello **IoTHubClient** library.</span></span>

<span data-ttu-id="0ce61-108">Witaj poprzednim artykule opisano sposób toouse hello **IoTHubClient** biblioteki toosend zdarzenia tooIoT koncentratora i odbierania wiadomości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-108">hello previous article described how toouse hello **IoTHubClient** library toosend events tooIoT Hub and receive messages.</span></span> <span data-ttu-id="0ce61-109">W tym artykule rozszerza tej dyskusji, wyjaśniający, jak zarządzać dokładnie toomore *podczas* wysyłać i odbierać dane, wprowadzenie toohello **interfejsów API niższego poziomu**.</span><span class="sxs-lookup"><span data-stu-id="0ce61-109">This article extends that discussion by explaining how toomore precisely manage *when* you send and receive data, introducing you toohello **lower-level APIs**.</span></span> <span data-ttu-id="0ce61-110">Prezentujemy również zasady jak tooevents właściwości tooattach (i pobrać wiadomości) przy użyciu właściwości hello obsługi funkcji w hello **IoTHubClient** biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-110">We'll also explain how tooattach properties tooevents (and retrieve them from messages) using hello property handling features in hello **IoTHubClient** library.</span></span> <span data-ttu-id="0ce61-111">Ponadto firma Microsoft udostępni dodatkowe objaśnienia dotyczące sposobów toohandle komunikatów odebranych z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-111">Finally, we'll provide additional explanation of different ways toohandle messages received from IoT Hub.</span></span>

<span data-ttu-id="0ce61-112">Witaj artykuł zawiera przez obejmujące kilka różnych tematów, tym więcej informacji o poświadczeniach urządzenia i sposobu toochange hello zachowanie hello **IoTHubClient** za pomocą opcji konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="0ce61-112">hello article concludes by covering a couple of miscellaneous topics, including more about device credentials and how toochange hello behavior of hello **IoTHubClient** through configuration options.</span></span>

<span data-ttu-id="0ce61-113">Użyjemy hello **IoTHubClient** SDK przykłady tooexplain tych tematów.</span><span class="sxs-lookup"><span data-stu-id="0ce61-113">We'll use hello **IoTHubClient** SDK samples tooexplain these topics.</span></span> <span data-ttu-id="0ce61-114">Toofollow wzdłuż, zobacz hello **Centrum iothub\_klienta\_próbki\_http** i **Centrum iothub\_klienta\_próbki\_amqp** aplikacji, które znajdują się w hello urządzenia Azure IoT SDK, aby przedstawionej C. wszystko, co opisano w hello następujące sekcje w tych przykładów.</span><span class="sxs-lookup"><span data-stu-id="0ce61-114">If you want toofollow along, see hello **iothub\_client\_sample\_http** and **iothub\_client\_sample\_amqp** applications that are included in hello Azure IoT device SDK for C. Everything described in hello following sections is demonstrated in these samples.</span></span>

<span data-ttu-id="0ce61-115">Można znaleźć hello [ **urządzenia Azure IoT SDK dla języka C** ](https://github.com/Azure/azure-iot-sdk-c) GitHub repozytorium i Wyświetl szczegóły hello interfejsu API w hello [dokumentacja interfejsu API C](https://azure.github.io/azure-iot-sdk-c/index.html).</span><span class="sxs-lookup"><span data-stu-id="0ce61-115">You can find hello [**Azure IoT device SDK for C**](https://github.com/Azure/azure-iot-sdk-c) GitHub repository and view details of hello API in hello [C API reference](https://azure.github.io/azure-iot-sdk-c/index.html).</span></span>

## <a name="hello-lower-level-apis"></a><span data-ttu-id="0ce61-116">Witaj interfejsów API niższego poziomu</span><span class="sxs-lookup"><span data-stu-id="0ce61-116">hello lower-level APIs</span></span>
<span data-ttu-id="0ce61-117">Hello poprzednim artykule opisano podstawowe operacje hello hello **IotHubClient** w kontekście hello hello **Centrum iothub\_klienta\_próbki\_amqp** aplikacja.</span><span class="sxs-lookup"><span data-stu-id="0ce61-117">hello previous article described hello basic operation of hello **IotHubClient** within hello context of hello **iothub\_client\_sample\_amqp** application.</span></span> <span data-ttu-id="0ce61-118">Na przykład wyjaśniono, jak tooinitialize hello bibliotekę przy użyciu tego kodu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-118">For example, it explained how tooinitialize hello library using this code.</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="0ce61-119">Opisano również, jak za pomocą tego zdarzenia toosend wywołania funkcji.</span><span class="sxs-lookup"><span data-stu-id="0ce61-119">It also described how toosend events using this function call.</span></span>

```
IoTHubClient_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message);
```

<span data-ttu-id="0ce61-120">Artykuł Hello są także opisane jak tooreceive wiadomości przez zarejestrowanie funkcję wywołania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="0ce61-120">hello article also described how tooreceive messages by registering a callback function.</span></span>

```
int receiveContext = 0;
IoTHubClient_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext);
```

<span data-ttu-id="0ce61-121">Artykuł Hello również pokazano, jak toofree zasobów przy użyciu kodu takie jak następujące hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-121">hello article also showed how toofree resources using code such as hello following.</span></span>

```
IoTHubClient_Destroy(iotHubClientHandle);
```

<span data-ttu-id="0ce61-122">Istnieją jednak tooeach funkcji Pomocnik tych interfejsów API:</span><span class="sxs-lookup"><span data-stu-id="0ce61-122">However there are companion functions tooeach of these APIs:</span></span>

* <span data-ttu-id="0ce61-123">IoTHubClient\_LL\_CreateFromConnectionString</span><span class="sxs-lookup"><span data-stu-id="0ce61-123">IoTHubClient\_LL\_CreateFromConnectionString</span></span>
* <span data-ttu-id="0ce61-124">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="0ce61-124">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="0ce61-125">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="0ce61-125">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="0ce61-126">IoTHubClient\_LL\_zniszczyć</span><span class="sxs-lookup"><span data-stu-id="0ce61-126">IoTHubClient\_LL\_Destroy</span></span>

<span data-ttu-id="0ce61-127">Wszystkie funkcje te obejmują "Wszystko" w hello Nazwa interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="0ce61-127">These functions all include “LL” in hello API name.</span></span> <span data-ttu-id="0ce61-128">Inną niż każda z tych funkcji hello parametry są identyczne tootheir z systemem innym niż LL odpowiedniki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-128">Other than that, hello parameters of each of these functions are identical tootheir non-LL counterparts.</span></span> <span data-ttu-id="0ce61-129">Jednak hello tych funkcji jest różny w jednym ze sposobów ważne.</span><span class="sxs-lookup"><span data-stu-id="0ce61-129">However, hello behavior of these functions is different in one important way.</span></span>

<span data-ttu-id="0ce61-130">Podczas wywoływania **IoTHubClient\_CreateFromConnectionString**, biblioteki podstawowej hello utworzyć nowego wątku działającym w tle hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-130">When you call **IoTHubClient\_CreateFromConnectionString**, hello underlying libraries create a new thread that runs in hello background.</span></span> <span data-ttu-id="0ce61-131">Wysyła zdarzenia do tego wątku i odbiera komunikaty z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-131">This thread sends events to, and receives messages from, IoT Hub.</span></span> <span data-ttu-id="0ce61-132">Nie takiego wątku jest tworzony podczas pracy z hello "Wszystko" interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="0ce61-132">No such thread is created when working with hello "LL" APIs.</span></span> <span data-ttu-id="0ce61-133">Tworzenie Hello wątku w tle hello jest dewelopera toohello wygody.</span><span class="sxs-lookup"><span data-stu-id="0ce61-133">hello creation of hello background thread is a convenience toohello developer.</span></span> <span data-ttu-id="0ce61-134">Nie masz tooworry o jawnie wysyłanie zdarzeń i odbieranie komunikatów z Centrum IoT — wykonywane automatycznie hello tła.</span><span class="sxs-lookup"><span data-stu-id="0ce61-134">You don’t have tooworry about explicitly sending events and receiving messages from IoT Hub -- it happens automatically in hello background.</span></span> <span data-ttu-id="0ce61-135">Z kolei hello "Wszystko" interfejsów API zapewniają jawne kontroluje komunikację z Centrum IoT, jeśli zajdzie taka potrzeba.</span><span class="sxs-lookup"><span data-stu-id="0ce61-135">In contrast, hello "LL" APIs give you explicit control over communication with IoT Hub, if you need it.</span></span>

<span data-ttu-id="0ce61-136">toounderstand to lepiej Przyjrzyjmy się przykładem:</span><span class="sxs-lookup"><span data-stu-id="0ce61-136">toounderstand this better, let’s look at an example:</span></span>

<span data-ttu-id="0ce61-137">Podczas wywoływania **IoTHubClient\_SendEventAsync**, co faktycznie robimy obciążające hello zdarzeń w buforze.</span><span class="sxs-lookup"><span data-stu-id="0ce61-137">When you call **IoTHubClient\_SendEventAsync**, what you're actually doing is putting hello event in a buffer.</span></span> <span data-ttu-id="0ce61-138">Witaj wątku w tle tworzone podczas wywoływania **IoTHubClient\_CreateFromConnectionString** stale monitoruje buforu i wysyła żadnych danych zawiera tooIoT koncentratora.</span><span class="sxs-lookup"><span data-stu-id="0ce61-138">hello background thread created when you call **IoTHubClient\_CreateFromConnectionString** continually monitors this buffer and sends any data that it contains tooIoT Hub.</span></span> <span data-ttu-id="0ce61-139">Dzieje się to w tle hello na powitania sam czas hello tego wątku głównego jest wykonywanie innych zadań.</span><span class="sxs-lookup"><span data-stu-id="0ce61-139">This happens in hello background at hello same time that hello main thread is performing other work.</span></span>

<span data-ttu-id="0ce61-140">Podobnie po rejestracji funkcję wywołania zwrotnego dla wiadomości przy użyciu **IoTHubClient\_SetMessageCallback**, jest poinstruowanie hello SDK toohave hello tła wątku wywołania funkcji wywołania zwrotnego hello, gdy wiadomość Odebrano, niezależnie od wątku głównego hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-140">Similarly, when you register a callback function for messages using **IoTHubClient\_SetMessageCallback**, you're instructing hello SDK toohave hello background thread invoke hello callback function when a message is received, independent of hello main thread.</span></span>

<span data-ttu-id="0ce61-141">Witaj "Wszystko" interfejsów API nie należy tworzyć wątku w tle.</span><span class="sxs-lookup"><span data-stu-id="0ce61-141">hello "LL" APIs don’t create a background thread.</span></span> <span data-ttu-id="0ce61-142">Zamiast tego nowy interfejs API musi zostać wywołana tooexplicitly wysyłania i odbierania danych z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-142">Instead, a new API must be called tooexplicitly send and receive data from IoT Hub.</span></span> <span data-ttu-id="0ce61-143">To jest przedstawiona w hello poniższy przykład.</span><span class="sxs-lookup"><span data-stu-id="0ce61-143">This is demonstrated in hello following example.</span></span>

<span data-ttu-id="0ce61-144">Witaj **Centrum iothub\_klienta\_próbki\_http** aplikacji, która znajduje się w hello pokazuje SDK hello interfejsów API niższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-144">hello **iothub\_client\_sample\_http** application that’s included in hello SDK demonstrates hello lower-level APIs.</span></span> <span data-ttu-id="0ce61-145">W tym przykładzie mamy wysłać zdarzenia tooIoT Centrum z kodem, takie jak następujące hello:</span><span class="sxs-lookup"><span data-stu-id="0ce61-145">In that sample, we send events tooIoT Hub with code such as hello following:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Message_%d_From_IoTHubClient_LL_Over_HTTP", i);
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));

IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="0ce61-146">Witaj pierwsze trzy wiersze Utwórz wiadomość hello i hello ostatni wiersz wysyła zdarzenie hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-146">hello first three lines create hello message, and hello last line sends hello event.</span></span> <span data-ttu-id="0ce61-147">Jednak jak już wspomniano, "Wysyłanie" hello zdarzenie oznacza, że dane hello jest po prostu umieścić w buforze.</span><span class="sxs-lookup"><span data-stu-id="0ce61-147">However, as mentioned previously, "sending" hello event means that hello data is simply placed in a buffer.</span></span> <span data-ttu-id="0ce61-148">Nic nie jest przesyłane w sieci hello podczas nazywamy **IoTHubClient\_LL\_SendEventAsync**.</span><span class="sxs-lookup"><span data-stu-id="0ce61-148">Nothing is transmitted on hello network when we call **IoTHubClient\_LL\_SendEventAsync**.</span></span> <span data-ttu-id="0ce61-149">W kolejności tooactually wejściowych hello danych tooIoT koncentratora, należy wywołać **IoTHubClient\_LL\_DoWork**w tym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="0ce61-149">In order tooactually ingress hello data tooIoT Hub, you must call **IoTHubClient\_LL\_DoWork**, as in this example:</span></span>

```
while (1)
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="0ce61-150">Ten kod (z hello **Centrum iothub\_klienta\_próbki\_http** aplikacji) wielokrotnie wywołuje **IoTHubClient\_LL\_DoWork** .</span><span class="sxs-lookup"><span data-stu-id="0ce61-150">This code (from hello **iothub\_client\_sample\_http** application) repeatedly calls **IoTHubClient\_LL\_DoWork**.</span></span> <span data-ttu-id="0ce61-151">Zawsze **IoTHubClient\_LL\_DoWork** jest wywoływana, wysyła niektórych zdarzeń z tooIoT buforu hello Centrum i pobiera ona wiadomość w kolejce wysyłania toohello urządzenia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-151">Each time **IoTHubClient\_LL\_DoWork** is called, it sends some events from hello buffer tooIoT Hub and it retrieves a queued message being sent toohello device.</span></span> <span data-ttu-id="0ce61-152">drugim przypadku Hello oznacza, że jeśli firma Microsoft zarejestrowana funkcja wywołania zwrotnego dla wiadomości, a następnie wywołania zwrotnego hello jest wywoływany (przy założeniu, że komunikaty są umieszczone w kolejce).</span><span class="sxs-lookup"><span data-stu-id="0ce61-152">hello latter case means that if we registered a callback function for messages, then hello callback is invoked (assuming any messages are queued up).</span></span> <span data-ttu-id="0ce61-153">Firma Microsoft będzie zarejestrowanych funkcję wywołania zwrotnego z kodem, takie jak następujące hello:</span><span class="sxs-lookup"><span data-stu-id="0ce61-153">We would have registered such a callback function with code such as hello following:</span></span>

```
IoTHubClient_LL_SetMessageCallback(iotHubClientHandle, ReceiveMessageCallback, &receiveContext)
```

<span data-ttu-id="0ce61-154">Hello przyczyny, że **IoTHubClient\_LL\_DoWork** jest często nazywana pętli jest to, że zawsze jest nazywana, wysyła *niektórych* buforowane tooIoT zdarzenia koncentratora i pobiera *hello obok* wiadomości w kolejce hello urządzenia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-154">hello reason that **IoTHubClient\_LL\_DoWork** is often called in a loop is that each time it’s called, it sends *some* buffered events tooIoT Hub and retrieves *hello next* message queued up for hello device.</span></span> <span data-ttu-id="0ce61-155">Każde wywołanie nie jest gwarantowana zdarzenia toosend buforowane lub tooretrieve wszystkich umieszczonych w kolejce wiadomości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-155">Each call isn’t guaranteed toosend all buffered events or tooretrieve all queued messages.</span></span> <span data-ttu-id="0ce61-156">Jeśli chcesz toosend wszystkie zdarzenia w hello buforu, a następnie kontynuuj na inne przetwarzania można zastąpić pętlę kodu, takie jak następujące hello:</span><span class="sxs-lookup"><span data-stu-id="0ce61-156">If you want toosend all events in hello buffer and then continue on with other processing you can replace this loop with code such as hello following:</span></span>

```
IOTHUB_CLIENT_STATUS status;

while ((IoTHubClient_LL_GetSendStatus(iotHubClientHandle, &status) == IOTHUB_CLIENT_OK) && (status == IOTHUB_CLIENT_SEND_STATUS_BUSY))
{
    IoTHubClient_LL_DoWork(iotHubClientHandle);
    ThreadAPI_Sleep(1000);
}
```

<span data-ttu-id="0ce61-157">Ten kod wywołuje **IoTHubClient\_LL\_DoWork** dopóki wszystkie zdarzenia w buforze hello zostały wysłane tooIoT koncentratora.</span><span class="sxs-lookup"><span data-stu-id="0ce61-157">This code calls **IoTHubClient\_LL\_DoWork** until all events in hello buffer have been sent tooIoT Hub.</span></span> <span data-ttu-id="0ce61-158">Należy pamiętać, że nie również oznacza otrzymanie wszystkie wiadomości w kolejce.</span><span class="sxs-lookup"><span data-stu-id="0ce61-158">Note this does not also imply that all queued messages have been received.</span></span> <span data-ttu-id="0ce61-159">Część hello przyczyną tego błędu jest, że sprawdzanie komunikatów "all" nie jest deterministyczna jako akcję.</span><span class="sxs-lookup"><span data-stu-id="0ce61-159">Part of hello reason for this is that checking for "all" messages isn’t as deterministic an action.</span></span> <span data-ttu-id="0ce61-160">Co się stanie, jeśli pobierasz "wszystkie" wiadomości powitania, ale następnie wysyłane innego urządzenia toohello natychmiast po?</span><span class="sxs-lookup"><span data-stu-id="0ce61-160">What happens if you retrieve "all" of hello messages, but then another one is sent toohello device immediately after?</span></span> <span data-ttu-id="0ce61-161">Lepsze toodeal sposób, z którego jest zaprogramowanych limitu czasu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-161">A better way toodeal with that is with a programmed timeout.</span></span> <span data-ttu-id="0ce61-162">Na przykład funkcja wywołania zwrotnego wiadomość hello można zresetować czasomierz za każdym razem, gdy jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="0ce61-162">For example, hello message callback function could reset a timer every time it’s invoked.</span></span> <span data-ttu-id="0ce61-163">Możesz następnie zapisywać logiki toocontinue przetwarzania, jeśli na przykład żadnych komunikatów nie odebrano w hello ostatnio *X* sekund.</span><span class="sxs-lookup"><span data-stu-id="0ce61-163">You can then write logic toocontinue processing if, for example, no messages have been received in hello last *X* seconds.</span></span>

<span data-ttu-id="0ce61-164">Po jest ingressing gotowego zdarzenia i odbieranie wiadomości, można się toocall hello odpowiedniej funkcji tooclean zasobów.</span><span class="sxs-lookup"><span data-stu-id="0ce61-164">When you’re finished ingressing events and receiving messages, be sure toocall hello corresponding function tooclean up resources.</span></span>

```
IoTHubClient_LL_Destroy(iotHubClientHandle);
```

<span data-ttu-id="0ce61-165">Zasadniczo istnieje tylko jeden zestaw interfejsów API toosend i odbierać dane z wątku w tle i inny zestaw interfejsów API, które hello samo bez hello wątku w tle.</span><span class="sxs-lookup"><span data-stu-id="0ce61-165">Basically there’s only one set of APIs toosend and receive data with a background thread and another set of APIs that does hello same thing without hello background thread.</span></span> <span data-ttu-id="0ce61-166">Wiele deweloperzy mogą preferować hello z systemem innym niż — wszystkie interfejsy API, ale hello interfejsów API niższego poziomu są przydatne, gdy hello Deweloper chce jawną kontrolę nad transmisji w sieci.</span><span class="sxs-lookup"><span data-stu-id="0ce61-166">A lot of developers may prefer hello non-LL APIs, but hello lower-level APIs are useful when hello developer wants explicit control over network transmissions.</span></span> <span data-ttu-id="0ce61-167">Na przykład niektóre urządzenia zbieranie danych przez czasu i zdarzeń wejściowych tylko w określonych odstępach czasu (na przykład, jeden raz na godzinę lub raz dziennie).</span><span class="sxs-lookup"><span data-stu-id="0ce61-167">For example, some devices collect data over time and only ingress events at specified intervals (for example, once an hour or once a day).</span></span> <span data-ttu-id="0ce61-168">Witaj hello kontroli tooexplicitly możliwości wysyłania i odbierania danych z Centrum IoT zapewnia interfejsy API niższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-168">hello lower-level APIs give you hello ability tooexplicitly control when you send and receive data from IoT Hub.</span></span> <span data-ttu-id="0ce61-169">Inne po prostu preferowane hello uproszczenia tego hello zapewniają interfejsów API niższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-169">Others will simply prefer hello simplicity that hello lower-level APIs provide.</span></span> <span data-ttu-id="0ce61-170">Wszystko, co się stanie w wątku głównego hello zamiast niektórych pracy w toku w tle hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-170">Everything happens on hello main thread rather than some work happening in hello background.</span></span>

<span data-ttu-id="0ce61-171">Niezależnie od tego modelu, należy wybrać, należy się toobe spójne w których interfejsy API jest używany.</span><span class="sxs-lookup"><span data-stu-id="0ce61-171">Whichever model you choose, be sure toobe consistent in which APIs you use.</span></span> <span data-ttu-id="0ce61-172">Po uruchomieniu przez wywołanie metody **IoTHubClient\_LL\_CreateFromConnectionString**, należy używać tylko hello odpowiadającego interfejsy API niższego poziomu do monitowania pracę:</span><span class="sxs-lookup"><span data-stu-id="0ce61-172">If you start by calling **IoTHubClient\_LL\_CreateFromConnectionString**, be sure you only use hello corresponding lower-level APIs for any follow-up work:</span></span>

* <span data-ttu-id="0ce61-173">IoTHubClient\_LL\_SendEventAsync</span><span class="sxs-lookup"><span data-stu-id="0ce61-173">IoTHubClient\_LL\_SendEventAsync</span></span>
* <span data-ttu-id="0ce61-174">IoTHubClient\_LL\_SetMessageCallback</span><span class="sxs-lookup"><span data-stu-id="0ce61-174">IoTHubClient\_LL\_SetMessageCallback</span></span>
* <span data-ttu-id="0ce61-175">IoTHubClient\_LL\_zniszczyć</span><span class="sxs-lookup"><span data-stu-id="0ce61-175">IoTHubClient\_LL\_Destroy</span></span>
* <span data-ttu-id="0ce61-176">IoTHubClient\_LL\_DoWork</span><span class="sxs-lookup"><span data-stu-id="0ce61-176">IoTHubClient\_LL\_DoWork</span></span>

<span data-ttu-id="0ce61-177">Hello przeciwną jest również wartość true.</span><span class="sxs-lookup"><span data-stu-id="0ce61-177">hello opposite is true as well.</span></span> <span data-ttu-id="0ce61-178">Jeśli na początku zasubskrybujesz **IoTHubClient\_CreateFromConnectionString**, a następnie użyj hello z systemem innym niż — wszystkie interfejsy API dla dowolnego dodatkowego przetwarzania.</span><span class="sxs-lookup"><span data-stu-id="0ce61-178">If you start with **IoTHubClient\_CreateFromConnectionString**, then use hello non-LL APIs for any additional processing.</span></span>

<span data-ttu-id="0ce61-179">W hello urządzenia Azure IoT SDK dla języka C, zobacz hello **Centrum iothub\_klienta\_próbki\_http** aplikacji pełny przykład hello niższego poziomu interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="0ce61-179">In hello Azure IoT device SDK for C, see hello **iothub\_client\_sample\_http** application for a complete example of hello lower-level APIs.</span></span> <span data-ttu-id="0ce61-180">Witaj **Centrum iothub\_klienta\_próbki\_amqp** aplikacji można odwoływać się pełny przykład hello nie - LL interfejsów API.</span><span class="sxs-lookup"><span data-stu-id="0ce61-180">hello **iothub\_client\_sample\_amqp** application can be referenced for a full example of hello non-LL APIs.</span></span>

## <a name="property-handling"></a><span data-ttu-id="0ce61-181">Obsługa właściwości</span><span class="sxs-lookup"><span data-stu-id="0ce61-181">Property handling</span></span>
<span data-ttu-id="0ce61-182">Do tej pory możemy zostały opisane wysyłanie danych, firma Microsoft już został odnosi toohello treści wiadomości powitania.</span><span class="sxs-lookup"><span data-stu-id="0ce61-182">So far when we've described sending data, we've been referring toohello body of hello message.</span></span> <span data-ttu-id="0ce61-183">Rozważmy na przykład ten kod:</span><span class="sxs-lookup"><span data-stu-id="0ce61-183">For example, consider this code:</span></span>

```
EVENT_INSTANCE message;
sprintf_s(msgText, sizeof(msgText), "Hello World");
message.messageHandle = IoTHubMessage_CreateFromByteArray((const unsigned char*)msgText, strlen(msgText));
IoTHubClient_LL_SendEventAsync(iotHubClientHandle, message.messageHandle, SendConfirmationCallback, &message)
```

<span data-ttu-id="0ce61-184">W tym przykładzie wysyła komunikat tooIoT Centrum hello tekst "Hello World".</span><span class="sxs-lookup"><span data-stu-id="0ce61-184">This example sends a message tooIoT Hub with hello text "Hello World."</span></span> <span data-ttu-id="0ce61-185">Centrum IoT umożliwia także właściwości toobe tooeach dołączonych wiadomości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-185">However, IoT Hub also allows properties toobe attached tooeach message.</span></span> <span data-ttu-id="0ce61-186">Właściwości są pary nazwa/wartość, które mogą być dołączone toohello wiadomości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-186">Properties are name/value pairs that can be attached toohello message.</span></span> <span data-ttu-id="0ce61-187">Możemy na przykład zmodyfikować hello poprzedniego kodu tooattach komunikat toohello właściwości:</span><span class="sxs-lookup"><span data-stu-id="0ce61-187">For example, we can modify hello previous code tooattach a property toohello message:</span></span>

```
MAP_HANDLE propMap = IoTHubMessage_Properties(message.messageHandle);
sprintf_s(propText, sizeof(propText), "%d", i);
Map_AddOrUpdate(propMap, "SequenceNumber", propText);
```

<span data-ttu-id="0ce61-188">Rozpoczniemy wywołując **IoTHubMessage\_właściwości** i przekazanie jej hello obsługi wiadomości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-188">We start by calling **IoTHubMessage\_Properties** and passing it hello handle of our message.</span></span> <span data-ttu-id="0ce61-189">Co mamy wrócić jest **mapy\_obsługi** odwołania, który pozwala toostart Dodawanie właściwości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-189">What we get back is a **MAP\_HANDLE** reference that enables us toostart adding properties.</span></span> <span data-ttu-id="0ce61-190">ostatnie Hello odbywa się przez wywołanie metody **mapy\_AddOrUpdate**, który przyjmuje odwołanie tooa mapy\_UCHWYTU, nazwa właściwości hello i wartość właściwości hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-190">hello latter is accomplished by calling **Map\_AddOrUpdate**, which takes a reference tooa MAP\_HANDLE, hello property name, and hello property value.</span></span> <span data-ttu-id="0ce61-191">W tym interfejsie API można dodać dowolną liczbę właściwości, jak firma Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0ce61-191">With this API we can add as many properties as we like.</span></span>

<span data-ttu-id="0ce61-192">Zdarzenia hello jest odczytywana od **usługi Event Hubs**, odbiornika hello można wyliczyć właściwości hello i pobieranie ich wartości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-192">When hello event is read from **Event Hubs**, hello receiver can enumerate hello properties and retrieve their corresponding values.</span></span> <span data-ttu-id="0ce61-193">Na przykład w środowisku .NET to może osiągnąć, uzyskując dostęp do hello [kolekcji właściwości w obiekcie EventData hello](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span><span class="sxs-lookup"><span data-stu-id="0ce61-193">For example, in .NET this would be accomplished by accessing hello [Properties collection on hello EventData object](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.eventdata.properties.aspx).</span></span>

<span data-ttu-id="0ce61-194">W poprzednim przykładzie hello możemy Cię dołączanie czy mamy wysłać tooIoT Centrum zdarzeń tooan właściwości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-194">In hello previous example, we’re attaching properties tooan event that we send tooIoT Hub.</span></span> <span data-ttu-id="0ce61-195">Właściwości można też dołączone toomessages odebranych z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-195">Properties can also be attached toomessages received from IoT Hub.</span></span> <span data-ttu-id="0ce61-196">Aby tooretrieve właściwości z komunikatu, możemy użyć kodu, takie jak następujące hello w naszej funkcji wywołania zwrotnego komunikat:</span><span class="sxs-lookup"><span data-stu-id="0ce61-196">If we want tooretrieve properties from a message, we can use code such as hello following in our message callback function:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .

    // Retrieve properties from hello message
    MAP_HANDLE mapProperties = IoTHubMessage_Properties(message);
    if (mapProperties != NULL)
    {
        const char*const* keys;
        const char*const* values;
        size_t propertyCount = 0;
        if (Map_GetInternals(mapProperties, &keys, &values, &propertyCount) == MAP_OK)
        {
            if (propertyCount > 0)
            {
                printf("Message Properties:\r\n");
                for (size_t index = 0; index < propertyCount; index++)
                {
                    printf("\tKey: %s Value: %s\r\n", keys[index], values[index]);
                }
                printf("\r\n");
            }
        }
    }

    . . .
}
```

<span data-ttu-id="0ce61-197">Witaj wywołanie za**IoTHubMessage\_właściwości** hello zwraca **mapy\_obsługi** odwołania.</span><span class="sxs-lookup"><span data-stu-id="0ce61-197">hello call too**IoTHubMessage\_Properties** returns hello **MAP\_HANDLE** reference.</span></span> <span data-ttu-id="0ce61-198">Następnie jest przekazywana odwołującymi się zbyt**mapy\_GetInternals** tooobtain tablicą tooan odwołanie wartości nazwy hello pary (a także liczbę właściwości hello).</span><span class="sxs-lookup"><span data-stu-id="0ce61-198">We then pass that reference too**Map\_GetInternals** tooobtain a reference tooan array of hello name/value pairs (as well as a count of hello properties).</span></span> <span data-ttu-id="0ce61-199">W tym momencie jest polegać wyliczania hello właściwości tooget toohello wartości, którą chcemy udostępnić.</span><span class="sxs-lookup"><span data-stu-id="0ce61-199">At that point it's a simple matter of enumerating hello properties tooget toohello values we want.</span></span>

<span data-ttu-id="0ce61-200">Nie masz toouse właściwości w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="0ce61-200">You don't have toouse properties in your application.</span></span> <span data-ttu-id="0ce61-201">Jednak jeśli potrzebujesz tooset ich na zdarzenia lub pobrać je z wiadomości, hello **IoTHubClient** biblioteki ułatwia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-201">However, if you need tooset them on events or retrieve them from messages, hello **IoTHubClient** library makes it easy.</span></span>

## <a name="message-handling"></a><span data-ttu-id="0ce61-202">Komunikat — Obsługa</span><span class="sxs-lookup"><span data-stu-id="0ce61-202">Message handling</span></span>
<span data-ttu-id="0ce61-203">Jak wspomniano wcześniej, gdy nadchodzą komunikaty z Centrum IoT hello **IoTHubClient** Biblioteka odpowiada za pomocą zarejestrowana funkcja wywołania zwrotnego.</span><span class="sxs-lookup"><span data-stu-id="0ce61-203">As stated previously, when messages arrive from IoT Hub hello **IoTHubClient** library responds by invoking a registered callback function.</span></span> <span data-ttu-id="0ce61-204">Brak parametru zwrotnego tej funkcji, która wymaga dodatkowych wyjaśnień.</span><span class="sxs-lookup"><span data-stu-id="0ce61-204">There is a return parameter of this function that deserves some additional explanation.</span></span> <span data-ttu-id="0ce61-205">Oto fragment hello funkcja wywołania zwrotnego w hello **Centrum iothub\_klienta\_próbki\_http** aplikacji przykładowej:</span><span class="sxs-lookup"><span data-stu-id="0ce61-205">Here’s an excerpt of hello callback function in hello **iothub\_client\_sample\_http** sample application:</span></span>

```
static IOTHUBMESSAGE_DISPOSITION_RESULT ReceiveMessageCallback(IOTHUB_MESSAGE_HANDLE message, void* userContextCallback)
{
    . . .
    return IOTHUBMESSAGE_ACCEPTED;
}
```

<span data-ttu-id="0ce61-206">Należy pamiętać, że typ zwracany hello **IOTHUBMESSAGE\_DYSPOZYCJI\_wynik** w tym przypadku zostanie zwrócona **IOTHUBMESSAGE\_ZAAKCEPTOWANE**.</span><span class="sxs-lookup"><span data-stu-id="0ce61-206">Note that hello return type is **IOTHUBMESSAGE\_DISPOSITION\_RESULT** and in this particular case we return **IOTHUBMESSAGE\_ACCEPTED**.</span></span> <span data-ttu-id="0ce61-207">Istnieją inne wartości, firma Microsoft może zwracać z tej funkcji zmiany sposobu hello **IoTHubClient** biblioteki reaguje toohello wywołanie zwrotne komunikatu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-207">There are other values we can return from this function that change how hello **IoTHubClient** library reacts toohello message callback.</span></span> <span data-ttu-id="0ce61-208">Oto opcje hello.</span><span class="sxs-lookup"><span data-stu-id="0ce61-208">Here are hello options.</span></span>

* <span data-ttu-id="0ce61-209">**IOTHUBMESSAGE\_ZAAKCEPTOWANE** — wiadomość hello został pomyślnie przetworzony.</span><span class="sxs-lookup"><span data-stu-id="0ce61-209">**IOTHUBMESSAGE\_ACCEPTED** – hello message has been processed successfully.</span></span> <span data-ttu-id="0ce61-210">Witaj **IoTHubClient** biblioteki nie wywoła funkcję wywołania zwrotnego hello ponownie z hello tego samego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-210">hello **IoTHubClient** library will not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="0ce61-211">**IOTHUBMESSAGE\_ODRZUCONE** — wiadomość hello nie została przetworzona i istnieje nie toodo desire hello dlatego w przyszłości.</span><span class="sxs-lookup"><span data-stu-id="0ce61-211">**IOTHUBMESSAGE\_REJECTED** – hello message was not processed and there is no desire toodo so in hello future.</span></span> <span data-ttu-id="0ce61-212">Witaj **IoTHubClient** biblioteki nie należy wywołać funkcję wywołania zwrotnego hello ponownie z hello tego samego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-212">hello **IoTHubClient** library should not invoke hello callback function again with hello same message.</span></span>
* <span data-ttu-id="0ce61-213">**IOTHUBMESSAGE\_ABANDONED** — wiadomość hello nie została przetworzona pomyślnie, ale hello **IoTHubClient** biblioteki należy wywołać funkcję wywołania zwrotnego hello ponownie z hello tego samego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-213">**IOTHUBMESSAGE\_ABANDONED** – hello message was not processed successfully, but hello **IoTHubClient** library should invoke hello callback function again with hello same message.</span></span>

<span data-ttu-id="0ce61-214">Dla hello pierwsze dwa kody powrotne, hello **IoTHubClient** biblioteki wysyła komunikat tooIoT wskazująca, że wiadomość hello koncentratora powinny być usuwane z kolejki urządzenia hello i nie można dostarczyć ponownie.</span><span class="sxs-lookup"><span data-stu-id="0ce61-214">For hello first two return codes, hello **IoTHubClient** library sends a message tooIoT Hub indicating that hello message should be deleted from hello device queue and not delivered again.</span></span> <span data-ttu-id="0ce61-215">Efekt netto Hello jest hello takie same (wiadomość hello jest usuwane z kolejki urządzenia hello), ale czy zaakceptowane lub odrzucone wiadomości powitania nadal jest rejestrowany.</span><span class="sxs-lookup"><span data-stu-id="0ce61-215">hello net effect is hello same (hello message is deleted from hello device queue), but whether hello message was accepted or rejected is still recorded.</span></span>  <span data-ttu-id="0ce61-216">Rejestrowanie tego rozróżnienie jest przydatne toosenders wiadomość hello, kto może nasłuchiwać opinii i sprawdzić, czy urządzenie ma zaakceptowane lub odrzucone danego komunikatu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-216">Recording this distinction is useful toosenders of hello message who can listen for feedback and find out if a device has accepted or rejected a particular message.</span></span>

<span data-ttu-id="0ce61-217">W przypadku ostatniego hello zostanie także wysłana wiadomość tooIoT koncentratora, ale oznacza ona tę wiadomość hello powinien być dostarczony ponownie.</span><span class="sxs-lookup"><span data-stu-id="0ce61-217">In hello last case a message is also sent tooIoT Hub, but it indicates that hello message should be redelivered.</span></span> <span data-ttu-id="0ce61-218">Zwykle będzie abandon komunikat, jeśli wystąpi błąd, ale chcę tootry tooprocess wiadomość hello ponownie.</span><span class="sxs-lookup"><span data-stu-id="0ce61-218">Typically you’ll abandon a message if you encounter some error but want tootry tooprocess hello message again.</span></span> <span data-ttu-id="0ce61-219">Z kolei odrzuca wiadomości jest odpowiednia, w przypadku wystąpienia nieodwracalnego błędu (lub po prostu zdecydować się, że nie chcesz, aby wiadomość hello tooprocess).</span><span class="sxs-lookup"><span data-stu-id="0ce61-219">In contrast, rejecting a message is appropriate when you encounter an unrecoverable error (or if you simply decide you don’t want tooprocess hello message).</span></span>

<span data-ttu-id="0ce61-220">W każdym przypadku należy pamiętać różnych kodów powrotnych hello, dzięki czemu można wywołać z hello zachowanie hello **IoTHubClient** biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-220">In any case, be aware of hello different return codes so that you can elicit hello behavior you want from hello **IoTHubClient** library.</span></span>

## <a name="alternate-device-credentials"></a><span data-ttu-id="0ce61-221">Poświadczenia alternatywne urządzenia</span><span class="sxs-lookup"><span data-stu-id="0ce61-221">Alternate device credentials</span></span>
<span data-ttu-id="0ce61-222">Jak opisano wcześniej, hello po pierwsze toodo podczas pracy z hello **IoTHubClient** biblioteka jest tooobtain **Centrum IOTHUB\_klienta\_obsługi** przy użyciu wywołania, takich jak hello następujące:</span><span class="sxs-lookup"><span data-stu-id="0ce61-222">As explained previously, hello first thing toodo when working with hello **IoTHubClient** library is tooobtain a **IOTHUB\_CLIENT\_HANDLE** with a call such as hello following:</span></span>

```
IOTHUB_CLIENT_HANDLE iotHubClientHandle;
iotHubClientHandle = IoTHubClient_CreateFromConnectionString(connectionString, AMQP_Protocol);
```

<span data-ttu-id="0ce61-223">Witaj argumenty za**IoTHubClient\_CreateFromConnectionString** są parametry połączenia urządzenia hello i parametr, który wskazuje protokołu hello używamy toocommunicate z Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-223">hello arguments too**IoTHubClient\_CreateFromConnectionString** are hello device connection string and a parameter that indicates hello protocol we use toocommunicate with IoT Hub.</span></span> <span data-ttu-id="0ce61-224">ciąg połączenia urządzenia Hello ma format, który wygląda następująco:</span><span class="sxs-lookup"><span data-stu-id="0ce61-224">hello device connection string has a format that appears as follows:</span></span>

```
HostName=IOTHUBNAME.IOTHUBSUFFIX;DeviceId=DEVICEID;SharedAccessKey=SHAREDACCESSKEY
```

<span data-ttu-id="0ce61-225">Istnieją cztery elementy informacji w tym ciągu: Nazwa centrum IoT, sufiks Centrum IoT identyfikator urządzenia i udostępniony klucz dostępu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-225">There are four pieces of information in this string: IoT Hub name, IoT Hub suffix, device ID, and shared access key.</span></span> <span data-ttu-id="0ce61-226">Uzyskaj hello pełną nazwę domeny (FQDN) z Centrum IoT podczas tworzenia wystąpienia Centrum IoT w portalu Azure hello — umożliwia nazwę Centrum IoT hello (hello pierwsza część hello FQDN) i sufiks Centrum IoT hello (hello reszty hello FQDN).</span><span class="sxs-lookup"><span data-stu-id="0ce61-226">You obtain hello fully qualified domain name (FQDN) of an IoT hub when you create your IoT hub instance in hello Azure portal — this gives you hello IoT hub name (hello first part of hello FQDN) and hello IoT hub suffix (hello rest of hello FQDN).</span></span> <span data-ttu-id="0ce61-227">Pobierz identyfikator urządzenia hello i hello udostępniony klucz dostępu podczas rejestrowania urządzenia z Centrum IoT (zgodnie z opisem w hello [poprzednim artykule](iot-hub-device-sdk-c-intro.md)).</span><span class="sxs-lookup"><span data-stu-id="0ce61-227">You get hello device ID and hello shared access key when you register your device with IoT Hub (as described in hello [previous article](iot-hub-device-sdk-c-intro.md)).</span></span>

<span data-ttu-id="0ce61-228">**IoTHubClient\_CreateFromConnectionString** umożliwia jednokierunkowej tooinitialize hello biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-228">**IoTHubClient\_CreateFromConnectionString** gives you one way tooinitialize hello library.</span></span> <span data-ttu-id="0ce61-229">Jeśli wolisz, możesz utworzyć nową **Centrum IOTHUB\_klienta\_obsługi** przy użyciu tych parametrów zamiast ciągu połączenia hello urządzenia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-229">If you prefer, you can create a new **IOTHUB\_CLIENT\_HANDLE** by using these individual parameters rather than hello device connection string.</span></span> <span data-ttu-id="0ce61-230">Jest to osiągane z hello następującego kodu:</span><span class="sxs-lookup"><span data-stu-id="0ce61-230">This is achieved with hello following code:</span></span>

```
IOTHUB_CLIENT_CONFIG iotHubClientConfig;
iotHubClientConfig.iotHubName = "";
iotHubClientConfig.deviceId = "";
iotHubClientConfig.deviceKey = "";
iotHubClientConfig.iotHubSuffix = "";
iotHubClientConfig.protocol = HTTP_Protocol;
IOTHUB_CLIENT_HANDLE iotHubClientHandle = IoTHubClient_LL_Create(&iotHubClientConfig);
```

<span data-ttu-id="0ce61-231">To umożliwia zrealizowanie hello odpowiednikiem **IoTHubClient\_CreateFromConnectionString**.</span><span class="sxs-lookup"><span data-stu-id="0ce61-231">This accomplishes hello same thing as **IoTHubClient\_CreateFromConnectionString**.</span></span>

<span data-ttu-id="0ce61-232">Może wydawać się oczywiste, warto toouse **IoTHubClient\_CreateFromConnectionString** zamiast tego pełniejsze metody inicjowania.</span><span class="sxs-lookup"><span data-stu-id="0ce61-232">It may seem obvious that you would want toouse **IoTHubClient\_CreateFromConnectionString** rather than this more verbose method of initialization.</span></span> <span data-ttu-id="0ce61-233">Należy pamiętać, że podczas rejestrowania urządzenia w Centrum IoT można pobrać jest identyfikator urządzenia i klucz urządzenia (nie w ciągu połączenia).</span><span class="sxs-lookup"><span data-stu-id="0ce61-233">Keep in mind, however, that when you register a device in IoT Hub what you get is a device ID and device key (not a connection string).</span></span> <span data-ttu-id="0ce61-234">Hello *explorer urządzenia* narzędzia zestawu SDK wprowadzone w hello [poprzednim artykule](iot-hub-device-sdk-c-intro.md) korzysta z bibliotek w hello **zestawu SDK usług Azure IoT** ciąg połączenia urządzenia hello toocreate z Identyfikator urządzenia Hello klucza urządzenia i nazwy hosta Centrum IoT.</span><span class="sxs-lookup"><span data-stu-id="0ce61-234">hello *device explorer* SDK tool introduced in hello [previous article](iot-hub-device-sdk-c-intro.md) uses libraries in hello **Azure IoT service SDK** toocreate hello device connection string from hello device ID, device key, and IoT Hub host name.</span></span> <span data-ttu-id="0ce61-235">Dlatego wywołanie **IoTHubClient\_LL\_Utwórz** może być preferowana, ponieważ wymaga kroku hello Generowanie ciągu połączenia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-235">So calling **IoTHubClient\_LL\_Create** may be preferable because it saves you hello step of generating a connection string.</span></span> <span data-ttu-id="0ce61-236">Należy użyć metody jest wygodne.</span><span class="sxs-lookup"><span data-stu-id="0ce61-236">Use whichever method is convenient.</span></span>

## <a name="configuration-options"></a><span data-ttu-id="0ce61-237">Opcje konfiguracji</span><span class="sxs-lookup"><span data-stu-id="0ce61-237">Configuration options</span></span>
<span data-ttu-id="0ce61-238">Do tej pory wszystkie elementy opisane o hello sposób hello **IoTHubClient** works biblioteki odzwierciedla jego zachowanie domyślne.</span><span class="sxs-lookup"><span data-stu-id="0ce61-238">So far everything described about hello way hello **IoTHubClient** library works reflects its default behavior.</span></span> <span data-ttu-id="0ce61-239">Istnieje jednak kilka opcji, które można ustawić toochange działania hello biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-239">However, there are a few options that you can set toochange how hello library works.</span></span> <span data-ttu-id="0ce61-240">Jest to osiągane przez wykorzystanie hello **IoTHubClient\_LL\_SetOption** interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="0ce61-240">This is accomplished by leveraging hello **IoTHubClient\_LL\_SetOption** API.</span></span> <span data-ttu-id="0ce61-241">Należy wziąć pod uwagę w tym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="0ce61-241">Consider this example:</span></span>

```
unsigned int timeout = 30000;
IoTHubClient_LL_SetOption(iotHubClientHandle, "timeout", &timeout);
```

<span data-ttu-id="0ce61-242">Istnieje kilka opcji, które są powszechnie stosowane:</span><span class="sxs-lookup"><span data-stu-id="0ce61-242">There are a couple of options that are commonly used:</span></span>

* <span data-ttu-id="0ce61-243">**SetBatching** (wartość logiczna) — Jeśli **true**, dane przesyłane tooIoT Centrum jest wysyłane w partiach.</span><span class="sxs-lookup"><span data-stu-id="0ce61-243">**SetBatching** (bool) – If **true**, then data sent tooIoT Hub is sent in batches.</span></span> <span data-ttu-id="0ce61-244">Jeśli **false**, komunikaty są wysyłane pojedynczo.</span><span class="sxs-lookup"><span data-stu-id="0ce61-244">If **false**, then messages are sent individually.</span></span> <span data-ttu-id="0ce61-245">Domyślnie Hello **false**.</span><span class="sxs-lookup"><span data-stu-id="0ce61-245">hello default is **false**.</span></span> <span data-ttu-id="0ce61-246">Należy pamiętać, że hello **SetBatching** dotyczy tylko protokołu toohello HTTP i nie toohello MQTT lub AMQP protokołów.</span><span class="sxs-lookup"><span data-stu-id="0ce61-246">Note that hello **SetBatching** option only applies toohello HTTP protocol and not toohello MQTT or AMQP protocols.</span></span>
* <span data-ttu-id="0ce61-247">**Limit czasu** (unsigned int) — ta wartość jest reprezentowana w milisekundach.</span><span class="sxs-lookup"><span data-stu-id="0ce61-247">**Timeout** (unsigned int) – This value is represented in milliseconds.</span></span> <span data-ttu-id="0ce61-248">Jeśli wysyła żądanie HTTP lub odebrania odpowiedzi trwa dłużej niż ten czas, a następnie połączenie hello upłynie limit czasu.</span><span class="sxs-lookup"><span data-stu-id="0ce61-248">If sending an HTTP request or receiving a response takes longer than this time, then hello connection times out.</span></span>

<span data-ttu-id="0ce61-249">Przetwarzanie wsadowe opcja Hello jest ważna.</span><span class="sxs-lookup"><span data-stu-id="0ce61-249">hello batching option is important.</span></span> <span data-ttu-id="0ce61-250">Domyślnie hello zdarzeń ingresses biblioteki indywidualnie (pojedyncze zdarzenie jest niezależnie od przypadku przekazania za**IoTHubClient\_LL\_SendEventAsync**).</span><span class="sxs-lookup"><span data-stu-id="0ce61-250">By default, hello library ingresses events individually (a single event is whatever you pass too**IoTHubClient\_LL\_SendEventAsync**).</span></span> <span data-ttu-id="0ce61-251">Jeśli jest przetwarzanie wsadowe opcja hello **true**, biblioteka hello gromadzi zdarzenia tyle jak go z buforu hello (up toohello maksymalny rozmiar wiadomości akceptujące Centrum IoT).</span><span class="sxs-lookup"><span data-stu-id="0ce61-251">If hello batching option is **true**, hello library collects as many events as it can from hello buffer (up toohello maximum message size that IoT Hub will accept).</span></span>  <span data-ttu-id="0ce61-252">Hello partii zdarzenia są wysyłane tooIoT Centrum w pojedynczym wywołaniu HTTP (hello pojedynczych zdarzeń są połączone w tablicy JSON).</span><span class="sxs-lookup"><span data-stu-id="0ce61-252">hello event batch is sent tooIoT Hub in a single HTTP call (hello individual events are bundled into a JSON array).</span></span> <span data-ttu-id="0ce61-253">Włączanie przetwarzanie wsadowe zwykle powoduje duża wydajność, ponieważ jest zmniejszenie przechodzenia do sieci.</span><span class="sxs-lookup"><span data-stu-id="0ce61-253">Enabling batching typically results in big performance gains since you’re reducing network round-trips.</span></span> <span data-ttu-id="0ce61-254">Ponadto znacząco zmniejsza przepustowości od wysyłania jednego zestawu nagłówków HTTP z partii zdarzeń, a nie zestaw nagłówki dla każdego wybranego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="0ce61-254">It also significantly reduces bandwidth since you are sending one set of HTTP headers with an event batch rather than a set of headers for each individual event.</span></span> <span data-ttu-id="0ce61-255">Jeśli nie masz toodo powód inaczej, zazwyczaj należy tooenable przetwarzanie wsadowe.</span><span class="sxs-lookup"><span data-stu-id="0ce61-255">Unless you have a specific reason toodo otherwise, typically you’ll want tooenable batching.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0ce61-256">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="0ce61-256">Next steps</span></span>
<span data-ttu-id="0ce61-257">W tym artykule opisano w zachowaniu hello szczegółów hello **IoTHubClient** Biblioteka odnaleziona w hello **urządzenia Azure IoT SDK dla języka C**. Dzięki tym informacjom powinien dysponować dobrą znajomością hello funkcji hello **IoTHubClient** biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-257">This article describes in detail hello behavior of hello **IoTHubClient** library found in hello **Azure IoT device SDK for C**. With this information, you should have a good understanding of hello capabilities of hello **IoTHubClient** library.</span></span> <span data-ttu-id="0ce61-258">Witaj [kolejnym artykule](iot-hub-device-sdk-c-serializer.md) zawiera szczegółowe informacje podobne na powitania **serializator** biblioteki.</span><span class="sxs-lookup"><span data-stu-id="0ce61-258">hello [next article](iot-hub-device-sdk-c-serializer.md) provides similar detail on hello **serializer** library.</span></span>

<span data-ttu-id="0ce61-259">toolearn więcej informacji na temat tworzenia Centrum IoT, zobacz hello [Azure IoT SDK][lnk-sdks].</span><span class="sxs-lookup"><span data-stu-id="0ce61-259">toolearn more about developing for IoT Hub, see hello [Azure IoT SDKs][lnk-sdks].</span></span>

<span data-ttu-id="0ce61-260">toofurther Poznaj możliwości hello Centrum IoT, zobacz:</span><span class="sxs-lookup"><span data-stu-id="0ce61-260">toofurther explore hello capabilities of IoT Hub, see:</span></span>

* <span data-ttu-id="0ce61-261">[Symuluje urządzenia Azure IoT krawędzi][lnk-iotedge]</span><span class="sxs-lookup"><span data-stu-id="0ce61-261">[Simulating a device with Azure IoT Edge][lnk-iotedge]</span></span>

[lnk-sdks]: iot-hub-devguide-sdks.md

[lnk-iotedge]: iot-hub-linux-iot-edge-simulated-device.md
