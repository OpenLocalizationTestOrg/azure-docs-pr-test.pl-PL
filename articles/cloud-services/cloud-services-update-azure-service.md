---
title: "Jak zaktualizować usługa w chmurze | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak zaktualizować usługi w chmurze na platformie Azure. Dowiedz się, jak aktualizacja usługi w chmurze będzie kontynuowana, aby zapewnić dostępność."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 2ba9676ed2afce7f18446642527971f5001b5ca7
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-update-a-cloud-service"></a><span data-ttu-id="ea444-104">Jak zaktualizować usługa w chmurze</span><span class="sxs-lookup"><span data-stu-id="ea444-104">How to update a cloud service</span></span>

<span data-ttu-id="ea444-105">Aktualizowanie usługi w chmurze, tym zarówno role i system operacyjny, gościa jest procesem trzech fazach.</span><span class="sxs-lookup"><span data-stu-id="ea444-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="ea444-106">Najpierw należy przekazać pliki binarne i pliki konfiguracji dla nowej usługi w chmurze lub wersja systemu operacyjnego.</span><span class="sxs-lookup"><span data-stu-id="ea444-106">First, the binaries and configuration files for the new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="ea444-107">Następnie Azure rezerwuje zasobów obliczeniowych i sieci dla usługi w chmurze na podstawie wymagań nowa wersja usługi chmury.</span><span class="sxs-lookup"><span data-stu-id="ea444-107">Next, Azure reserves compute and network resources for the cloud service based on the requirements of the new cloud service version.</span></span> <span data-ttu-id="ea444-108">Na koniec na platformie Azure przeprowadzane uaktualnienie stopniowe, aby zaktualizować przyrostowo dzierżawcy do nowej wersji lub Gość systemu operacyjnego, zachowując jego dostępność.</span><span class="sxs-lookup"><span data-stu-id="ea444-108">Finally, Azure performs a rolling upgrade to incrementally update the tenant to the new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="ea444-109">W tym artykule omówiono szczegóły ten ostatni krok — uaktualnienie stopniowe.</span><span class="sxs-lookup"><span data-stu-id="ea444-109">This article discusses the details of this last step – the rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="ea444-110">Aktualizacja usługi Azure</span><span class="sxs-lookup"><span data-stu-id="ea444-110">Update an Azure Service</span></span>
<span data-ttu-id="ea444-111">Azure organizuje wystąpienia roli w logiczne grupy o nazwie domen uaktualnienia (UD).</span><span class="sxs-lookup"><span data-stu-id="ea444-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="ea444-112">Domen uaktualnienia (UD) to logiczne zestawy wystąpień roli, które zostały zaktualizowane w grupie.</span><span class="sxs-lookup"><span data-stu-id="ea444-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="ea444-113">Aktualizacje platformy Azure w chmurze usługi UD jeden jednocześnie, dzięki czemu wystąpień w innych UDs, aby kontynuować, obsługująca ruch.</span><span class="sxs-lookup"><span data-stu-id="ea444-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs to continue serving traffic.</span></span>

<span data-ttu-id="ea444-114">Domyślna liczba domen uaktualnienia wynosi 5.</span><span class="sxs-lookup"><span data-stu-id="ea444-114">The default number of upgrade domains is 5.</span></span> <span data-ttu-id="ea444-115">Można określić różne liczby domen uaktualnienia w tym atrybucie upgradeDomainCount w pliku definicji usługi (csdef).</span><span class="sxs-lookup"><span data-stu-id="ea444-115">You can specify a different number of upgrade domains by including the upgradeDomainCount attribute in the service’s definition file (.csdef).</span></span> <span data-ttu-id="ea444-116">Aby uzyskać więcej informacji na temat atrybutu upgradeDomainCount, zobacz [schematu sieć Web](https://msdn.microsoft.com/library/azure/gg557553.aspx) lub [schematu proces roboczy](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="ea444-116">For more information about the upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="ea444-117">Po wykonaniu aktualizacji w miejscu z jednego lub większej liczby ról w usłudze Azure aktualizuje zestawy wystąpień roli zgodnie z domeną uaktualnienia, do którego należą.</span><span class="sxs-lookup"><span data-stu-id="ea444-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according to the upgrade domain to which they belong.</span></span> <span data-ttu-id="ea444-118">Aktualizacji platformy Azure, wszystkich wystąpień dla określonej domeny uaktualnienia — zatrzymywanie, aktualizowanie, przełącza je w tryb online — powrotem następnie przechodzi do następnej domeny.</span><span class="sxs-lookup"><span data-stu-id="ea444-118">Azure updates all of the instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto the next domain.</span></span> <span data-ttu-id="ea444-119">Zatrzymując tylko wystąpienia uruchomione w bieżącej domenie uaktualnienia Azure upewnia się, nastąpi aktualizacja najniższe możliwe wpływu na uruchomioną usługę.</span><span class="sxs-lookup"><span data-stu-id="ea444-119">By stopping only the instances running in the current upgrade domain, Azure makes sure that an update occurs with the least possible impact to the running service.</span></span> <span data-ttu-id="ea444-120">Aby uzyskać więcej informacji, zobacz [jak przebieg aktualizacji](#howanupgradeproceeds) dalszej części tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="ea444-120">For more information, see [How the update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="ea444-121">Podczas warunki **aktualizacji** i **uaktualnienia** ma nieco inne znaczenie w kontekście Azure, używane zamiennie procesów oraz opisy funkcji w tym dokumencie.</span><span class="sxs-lookup"><span data-stu-id="ea444-121">While the terms **update** and **upgrade** have slightly different meaning in the context Azure, they can be used interchangeably for the processes and descriptions of the features in this document.</span></span>
>
>

<span data-ttu-id="ea444-122">Usługi należy zdefiniować co najmniej dwóch wystąpień roli dla tej roli, należy zaktualizować w miejscu bez przestoju.</span><span class="sxs-lookup"><span data-stu-id="ea444-122">Your service must define at least two instances of a role for that role to be updated in-place without downtime.</span></span> <span data-ttu-id="ea444-123">Jeśli usługa zawiera tylko jedno wystąpienie jedną rolę, usługi będą niedostępne do momentu zakończenia aktualizacji w miejscu.</span><span class="sxs-lookup"><span data-stu-id="ea444-123">If the service consists of only one instance of one role, your service will be unavailable until the in-place update has finished.</span></span>

<span data-ttu-id="ea444-124">W tym temacie omówiono następujące informacje o aktualizacji platformy Azure:</span><span class="sxs-lookup"><span data-stu-id="ea444-124">This topic covers the following information about Azure updates:</span></span>

* [<span data-ttu-id="ea444-125">Dozwolone zmiany usługi podczas aktualizacji</span><span class="sxs-lookup"><span data-stu-id="ea444-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="ea444-126">Jak będzie kontynuowana uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="ea444-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="ea444-127">Wycofywanie aktualizacji</span><span class="sxs-lookup"><span data-stu-id="ea444-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="ea444-128">Inicjowanie wielu operacji mutating na bieżące wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="ea444-129">Rozkład ról domen uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="ea444-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="ea444-130">Dozwolone zmiany usługi podczas aktualizacji</span><span class="sxs-lookup"><span data-stu-id="ea444-130">Allowed service changes during an update</span></span>
<span data-ttu-id="ea444-131">W poniższej tabeli przedstawiono dozwolone zmiany do usługi podczas aktualizacji:</span><span class="sxs-lookup"><span data-stu-id="ea444-131">The following table shows the allowed changes to a service during an update:</span></span>

| <span data-ttu-id="ea444-132">Zmiany dozwolone hosting usług i ról</span><span class="sxs-lookup"><span data-stu-id="ea444-132">Changes permitted to hosting, services, and roles</span></span> | <span data-ttu-id="ea444-133">Aktualizacja w miejscu</span><span class="sxs-lookup"><span data-stu-id="ea444-133">In-place update</span></span> | <span data-ttu-id="ea444-134">Przemieszczanego (wymiany wirtualnych adresów IP)</span><span class="sxs-lookup"><span data-stu-id="ea444-134">Staged (VIP swap)</span></span> | <span data-ttu-id="ea444-135">Usuń i ponownie wdróż</span><span class="sxs-lookup"><span data-stu-id="ea444-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ea444-136">Wersja systemu operacyjnego</span><span class="sxs-lookup"><span data-stu-id="ea444-136">Operating system version</span></span> |<span data-ttu-id="ea444-137">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-137">Yes</span></span> |<span data-ttu-id="ea444-138">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-138">Yes</span></span> |<span data-ttu-id="ea444-139">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-139">Yes</span></span> |
| <span data-ttu-id="ea444-140">Poziom zaufania platformy .NET</span><span class="sxs-lookup"><span data-stu-id="ea444-140">.NET trust level</span></span> |<span data-ttu-id="ea444-141">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-141">Yes</span></span> |<span data-ttu-id="ea444-142">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-142">Yes</span></span> |<span data-ttu-id="ea444-143">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-143">Yes</span></span> |
| <span data-ttu-id="ea444-144">Rozmiar maszyny wirtualnej<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="ea444-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="ea444-145">Tak<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="ea444-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="ea444-146">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-146">Yes</span></span> |<span data-ttu-id="ea444-147">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-147">Yes</span></span> |
| <span data-ttu-id="ea444-148">Ustawienia magazynu lokalnego</span><span class="sxs-lookup"><span data-stu-id="ea444-148">Local storage settings</span></span> |<span data-ttu-id="ea444-149">Zwiększ tylko<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="ea444-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="ea444-150">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-150">Yes</span></span> |<span data-ttu-id="ea444-151">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-151">Yes</span></span> |
| <span data-ttu-id="ea444-152">Dodawanie lub usuwanie ról w usłudze</span><span class="sxs-lookup"><span data-stu-id="ea444-152">Add or remove roles in a service</span></span> |<span data-ttu-id="ea444-153">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-153">Yes</span></span> |<span data-ttu-id="ea444-154">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-154">Yes</span></span> |<span data-ttu-id="ea444-155">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-155">Yes</span></span> |
| <span data-ttu-id="ea444-156">Liczba wystąpień określonej roli</span><span class="sxs-lookup"><span data-stu-id="ea444-156">Number of instances of a particular role</span></span> |<span data-ttu-id="ea444-157">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-157">Yes</span></span> |<span data-ttu-id="ea444-158">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-158">Yes</span></span> |<span data-ttu-id="ea444-159">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-159">Yes</span></span> |
| <span data-ttu-id="ea444-160">Liczba lub typ punktów końcowych dla usługi</span><span class="sxs-lookup"><span data-stu-id="ea444-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="ea444-161">Tak<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="ea444-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="ea444-162">Nie</span><span class="sxs-lookup"><span data-stu-id="ea444-162">No</span></span> |<span data-ttu-id="ea444-163">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-163">Yes</span></span> |
| <span data-ttu-id="ea444-164">Nazwy i wartości ustawień konfiguracji</span><span class="sxs-lookup"><span data-stu-id="ea444-164">Names and values of configuration settings</span></span> |<span data-ttu-id="ea444-165">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-165">Yes</span></span> |<span data-ttu-id="ea444-166">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-166">Yes</span></span> |<span data-ttu-id="ea444-167">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-167">Yes</span></span> |
| <span data-ttu-id="ea444-168">Wartości (ale nie nazwy) ustawień konfiguracji</span><span class="sxs-lookup"><span data-stu-id="ea444-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="ea444-169">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-169">Yes</span></span> |<span data-ttu-id="ea444-170">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-170">Yes</span></span> |<span data-ttu-id="ea444-171">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-171">Yes</span></span> |
| <span data-ttu-id="ea444-172">Dodaj nowe certyfikaty</span><span class="sxs-lookup"><span data-stu-id="ea444-172">Add new certificates</span></span> |<span data-ttu-id="ea444-173">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-173">Yes</span></span> |<span data-ttu-id="ea444-174">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-174">Yes</span></span> |<span data-ttu-id="ea444-175">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-175">Yes</span></span> |
| <span data-ttu-id="ea444-176">Zmiana istniejących certyfikatów</span><span class="sxs-lookup"><span data-stu-id="ea444-176">Change existing certificates</span></span> |<span data-ttu-id="ea444-177">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-177">Yes</span></span> |<span data-ttu-id="ea444-178">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-178">Yes</span></span> |<span data-ttu-id="ea444-179">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-179">Yes</span></span> |
| <span data-ttu-id="ea444-180">Wdrażanie nowego kodu</span><span class="sxs-lookup"><span data-stu-id="ea444-180">Deploy new code</span></span> |<span data-ttu-id="ea444-181">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-181">Yes</span></span> |<span data-ttu-id="ea444-182">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-182">Yes</span></span> |<span data-ttu-id="ea444-183">Tak</span><span class="sxs-lookup"><span data-stu-id="ea444-183">Yes</span></span> |

<span data-ttu-id="ea444-184"><sup>1</sup> rozmiaru zmiany ograniczony do podzbioru dostępne dla usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="ea444-184"><sup>1</sup> Size change limited to the subset of sizes available for the cloud service.</span></span>

<span data-ttu-id="ea444-185"><sup>2</sup> wymaga zestawu SDK platformy Azure w wersji 1.5 lub nowszego.</span><span class="sxs-lookup"><span data-stu-id="ea444-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="ea444-186">Zmiana rozmiaru maszyny wirtualnej spowoduje zniszczenia danych lokalnych.</span><span class="sxs-lookup"><span data-stu-id="ea444-186">Changing the virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="ea444-187">Następujące elementy nie są obsługiwane podczas aktualizacji:</span><span class="sxs-lookup"><span data-stu-id="ea444-187">The following items are not supported during an update:</span></span>

* <span data-ttu-id="ea444-188">Zmiana nazwy roli.</span><span class="sxs-lookup"><span data-stu-id="ea444-188">Changing the name of a role.</span></span> <span data-ttu-id="ea444-189">Usuń, a następnie dodaj rolę z nową nazwą.</span><span class="sxs-lookup"><span data-stu-id="ea444-189">Remove and then add the role with the new name.</span></span>
* <span data-ttu-id="ea444-190">Zmiana liczby domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="ea444-190">Changing of the Upgrade Domain count.</span></span>
* <span data-ttu-id="ea444-191">Zmniejszenie rozmiaru zasobów lokalnych.</span><span class="sxs-lookup"><span data-stu-id="ea444-191">Decreasing the size of the local resources.</span></span>

<span data-ttu-id="ea444-192">W przypadku wprowadzania inne aktualizacje definicji usługi, takie jak zmniejszyć rozmiar zasobu lokalnego zamiast tego należy wykonać aktualizację wymiany adresów VIP.</span><span class="sxs-lookup"><span data-stu-id="ea444-192">If you are making other updates to your service's definition, such as decreasing the size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="ea444-193">Aby uzyskać więcej informacji, zobacz [wymiany wdrożenia](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="ea444-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="ea444-194">Jak będzie kontynuowana uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="ea444-194">How an upgrade proceeds</span></span>
<span data-ttu-id="ea444-195">Można zdecydować, czy chcesz zaktualizować wszystkie role w usłudze lub jedną rolę w usłudze.</span><span class="sxs-lookup"><span data-stu-id="ea444-195">You can decide whether you want to update all of the roles in your service or a single role in the service.</span></span> <span data-ttu-id="ea444-196">W obu przypadkach wszystkie wystąpienia każdej roli, który jest uaktualniany i muszą należeć do pierwszej domeny uaktualnienia są zatrzymane, uaktualnione i przywrócony do trybu online.</span><span class="sxs-lookup"><span data-stu-id="ea444-196">In either case, all instances of each role that is being upgraded and belong to the first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="ea444-197">Po ich przywróceniu online, wystąpień w drugiej domenie uaktualnienia są zatrzymane, uaktualnione i przywrócony do trybu online.</span><span class="sxs-lookup"><span data-stu-id="ea444-197">Once they are back online, the instances in the second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="ea444-198">Usługi w chmurze może mieć co najwyżej jedno uaktualnienie active naraz.</span><span class="sxs-lookup"><span data-stu-id="ea444-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="ea444-199">Uaktualnianie jest zawsze przeprowadzane przy użyciu najnowszej wersji usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="ea444-199">The upgrade is always performed against the latest version of the cloud service.</span></span>

<span data-ttu-id="ea444-200">Na poniższym diagramie przedstawiono, jak uaktualnianie będzie kontynuowane w przypadku uaktualniania wszystkich ról w usłudze:</span><span class="sxs-lookup"><span data-stu-id="ea444-200">The following diagram illustrates how the upgrade proceeds if you are upgrading all of the roles in the service:</span></span>

<span data-ttu-id="ea444-201">![Uaktualnij usługę](media/cloud-services-update-azure-service/IC345879.png "uaktualnianie usługi")</span><span class="sxs-lookup"><span data-stu-id="ea444-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="ea444-202">Ten dalej diagramie przedstawiono, jak aktualizacja będzie kontynuowana, Jeśli uaktualniasz tylko jedną rolę.</span><span class="sxs-lookup"><span data-stu-id="ea444-202">This next diagram illustrates how the update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="ea444-203">![Uaktualnienie roli](media/cloud-services-update-azure-service/IC345880.png "uaktualnienia roli")</span><span class="sxs-lookup"><span data-stu-id="ea444-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="ea444-204">Podczas aktualizacji automatycznych z kontrolerem sieci szkieletowej Azure okresowo ocenia kondycję usługi w chmurze do określania, kiedy jest bezpieczne przeprowadzenie UD dalej.</span><span class="sxs-lookup"><span data-stu-id="ea444-204">During an automatic update, the Azure Fabric Controller periodically evaluates the health of the cloud service to determine when it’s safe to walk the next UD.</span></span> <span data-ttu-id="ea444-205">Tej oceny kondycji jest wykonywane na podstawie-role i uwzględnia tylko wystąpienia w najnowszej wersji (tj. wystąpień z UDs, które już zostały udał).</span><span class="sxs-lookup"><span data-stu-id="ea444-205">This health evaluation is performed on a per-role basis and considers only instances in the latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="ea444-206">Sprawdza, czy minimalna liczba wystąpień roli dla każdej roli, zostały osiągnięte zadowalające stanu terminala.</span><span class="sxs-lookup"><span data-stu-id="ea444-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="ea444-207">Limit czasu uruchomienia wystąpienia roli</span><span class="sxs-lookup"><span data-stu-id="ea444-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="ea444-208">Kontroler sieci szkieletowej będą Odczekaj 30 minut dla każdego wystąpienia roli do przejścia rozpoczęte.</span><span class="sxs-lookup"><span data-stu-id="ea444-208">The Fabric Controller will wait 30 minutes for each role instance to reach a Started state.</span></span> <span data-ttu-id="ea444-209">Jeśli upłynie limit czasu, z kontrolerem sieci szkieletowej będą nadal przejście do następnego wystąpienia roli.</span><span class="sxs-lookup"><span data-stu-id="ea444-209">If the timeout duration elapses, the Fabric Controller will continue walking to the next role instance.</span></span>

### <a name="impact-to-drive-data-during-cloud-service-upgrades"></a><span data-ttu-id="ea444-210">Uaktualnia wpływu na dysk danych w usłudze w chmurze</span><span class="sxs-lookup"><span data-stu-id="ea444-210">Impact to drive data during Cloud Service upgrades</span></span>

<span data-ttu-id="ea444-211">Podczas uaktualniania do wielu wystąpień jednego wystąpienia usługi z usługą zostanie przeniesiony w dół podczas uaktualniania odbywa się ze względu na sposób usług Azure uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="ea444-211">When upgrading a service from a single instance to multiple instances your service will be brought down while the upgrade is performed due to the way Azure upgrades services.</span></span> <span data-ttu-id="ea444-212">Dostępność usługi umowę dotyczącą poziomu gwarantujących usługi ma zastosowanie tylko do usług, które zostały wdrożone za pomocą więcej niż jedno wystąpienie.</span><span class="sxs-lookup"><span data-stu-id="ea444-212">The service level agreement guaranteeing service availability only applies to services that are deployed with more than one instance.</span></span> <span data-ttu-id="ea444-213">Na poniższej liście opisano wpływ danych na każdym dysku każdego scenariusza uaktualniania usług Azure:</span><span class="sxs-lookup"><span data-stu-id="ea444-213">The following list describes how the data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="ea444-214">Scenariusz</span><span class="sxs-lookup"><span data-stu-id="ea444-214">Scenario</span></span>|<span data-ttu-id="ea444-215">Dysku c.</span><span class="sxs-lookup"><span data-stu-id="ea444-215">C Drive</span></span>|<span data-ttu-id="ea444-216">Dysk D</span><span class="sxs-lookup"><span data-stu-id="ea444-216">D Drive</span></span>|<span data-ttu-id="ea444-217">Dysk E</span><span class="sxs-lookup"><span data-stu-id="ea444-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="ea444-218">Ponowne uruchomienie maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="ea444-218">VM reboot</span></span>|<span data-ttu-id="ea444-219">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-219">Preserved</span></span>|<span data-ttu-id="ea444-220">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-220">Preserved</span></span>|<span data-ttu-id="ea444-221">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-221">Preserved</span></span>|
|<span data-ttu-id="ea444-222">Ponowne uruchomienie portalu</span><span class="sxs-lookup"><span data-stu-id="ea444-222">Portal reboot</span></span>|<span data-ttu-id="ea444-223">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-223">Preserved</span></span>|<span data-ttu-id="ea444-224">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-224">Preserved</span></span>|<span data-ttu-id="ea444-225">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-225">Destroyed</span></span>|
|<span data-ttu-id="ea444-226">Portal odtworzenia z obrazu</span><span class="sxs-lookup"><span data-stu-id="ea444-226">Portal reimage</span></span>|<span data-ttu-id="ea444-227">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-227">Preserved</span></span>|<span data-ttu-id="ea444-228">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-228">Destroyed</span></span>|<span data-ttu-id="ea444-229">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-229">Destroyed</span></span>|
|<span data-ttu-id="ea444-230">Uaktualnienie w miejscu</span><span class="sxs-lookup"><span data-stu-id="ea444-230">In-Place Upgrade</span></span>|<span data-ttu-id="ea444-231">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-231">Preserved</span></span>|<span data-ttu-id="ea444-232">Zachowane</span><span class="sxs-lookup"><span data-stu-id="ea444-232">Preserved</span></span>|<span data-ttu-id="ea444-233">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-233">Destroyed</span></span>|
|<span data-ttu-id="ea444-234">Węzeł migracji</span><span class="sxs-lookup"><span data-stu-id="ea444-234">Node migration</span></span>|<span data-ttu-id="ea444-235">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-235">Destroyed</span></span>|<span data-ttu-id="ea444-236">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-236">Destroyed</span></span>|<span data-ttu-id="ea444-237">Zniszczone</span><span class="sxs-lookup"><span data-stu-id="ea444-237">Destroyed</span></span>|

<span data-ttu-id="ea444-238">Należy pamiętać, że na liście powyżej dysku E: reprezentuje roli katalog główny dysku, a nie powinien być ustalony.</span><span class="sxs-lookup"><span data-stu-id="ea444-238">Note that, in the above list, the E: drive represents the role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="ea444-239">Zamiast tego należy użyć **RoleRoot %** zmiennej środowiskowej do reprezentowania dysku.</span><span class="sxs-lookup"><span data-stu-id="ea444-239">Instead, use the **%RoleRoot%** environment variable to represent the drive.</span></span>

<span data-ttu-id="ea444-240">Aby zminimalizować czas przestoju, podczas uaktualniania jednego wystąpienia usługi, należy wdrożyć nową usługę wielowystąpieniowy na serwerze i przeprowadzić wymiany wirtualnych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="ea444-240">To minimize the downtime when upgrading a single-instance service, deploy a new multi-instance service to the staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="ea444-241">Wycofywanie aktualizacji</span><span class="sxs-lookup"><span data-stu-id="ea444-241">Rollback of an update</span></span>
<span data-ttu-id="ea444-242">Azure zapewnia elastyczność w zarządzaniu usług podczas aktualizacji, co pozwala na zainicjowanie dodatkowe operacje w usłudze, po zaakceptowaniu żądania początkowego aktualizacji przez kontroler sieci szkieletowej Azure.</span><span class="sxs-lookup"><span data-stu-id="ea444-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after the initial update request is accepted by the Azure Fabric Controller.</span></span> <span data-ttu-id="ea444-243">Wycofywania można wykonać tylko w przypadku aktualizacji (zmiana konfiguracji) lub Trwa uaktualnianie **w toku** stanu wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-243">A rollback can only be performed when an update (configuration change) or upgrade is in the **in progress** state on the deployment.</span></span> <span data-ttu-id="ea444-244">Aktualizacji lub uaktualnieniu uważa się trwa tak długo, jak istnieje co najmniej jedno wystąpienie usługi, który nie został jeszcze zaktualizowany do nowej wersji.</span><span class="sxs-lookup"><span data-stu-id="ea444-244">An update or upgrade is considered to be in-progress as long as there is at least one instance of the service which has not yet been updated to the new version.</span></span> <span data-ttu-id="ea444-245">Aby sprawdzić, czy jest dozwolone wycofanie, sprawdź wartość flagi RollbackAllowed, zwracane przez [uzyskać wdrożenia](https://msdn.microsoft.com/library/azure/ee460804.aspx) i [pobrać właściwości usługi chmury](https://msdn.microsoft.com/library/azure/ee460806.aspx) operacje, jest ustawiony na wartość true.</span><span class="sxs-lookup"><span data-stu-id="ea444-245">To test whether a rollback is allowed, check the value of the RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set to true.</span></span>

> [!NOTE]
> <span data-ttu-id="ea444-246">Tylko warto wywołań wycofania na **w miejscu** aktualizacji lub uaktualnienia, ponieważ wymagają uaktualnienia wymiany adresów VIP zastępowanie jeden cały działającego wystąpienia usługi z inną.</span><span class="sxs-lookup"><span data-stu-id="ea444-246">It only makes sense to call Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="ea444-247">Wycofywanie aktualizacji w toku ma następujące skutki wdrożenia:</span><span class="sxs-lookup"><span data-stu-id="ea444-247">Rollback of an in-progress update has the following effects on the deployment:</span></span>

* <span data-ttu-id="ea444-248">Wszystkie wystąpienia roli, które były jeszcze nie zostały zaktualizowane lub uaktualnione do nowej wersji nie są zaktualizowane lub uaktualnione, ponieważ już uruchomionych wystąpień tych wersji docelowej usługi.</span><span class="sxs-lookup"><span data-stu-id="ea444-248">Any role instances which had not yet been updated or upgraded to the new version are not updated or upgraded, because those instances are already running the target version of the service.</span></span>
* <span data-ttu-id="ea444-249">Wszystkie wystąpienia roli, które były już zostały zaktualizowane lub uaktualnione do nowej wersji pakietu z (\*cspkg) pliku lub konfiguracji usługi (\*.cscfg) pliku (lub oba pliki) są przywracane do wersji sprzed uaktualnienia tych plików.</span><span class="sxs-lookup"><span data-stu-id="ea444-249">Any role instances which had already been updated or upgraded to the new version of the service package (\*.cspkg) file or the service configuration (\*.cscfg) file (or both files) are reverted to the pre-upgrade version of these files.</span></span>

<span data-ttu-id="ea444-250">Funkcjonalnie odbywa się przez następujące funkcje:</span><span class="sxs-lookup"><span data-stu-id="ea444-250">This functionally is provided by the following features:</span></span>

* <span data-ttu-id="ea444-251">[Wycofywania aktualizacji lub uaktualnienia](https://msdn.microsoft.com/library/azure/hh403977.aspx) operacja, która może być wywoływana dla aktualizacji konfiguracji (wyzwalane przez wywołanie metody [zmiany konfiguracji wdrożenia](https://msdn.microsoft.com/library/azure/ee460809.aspx)) lub uaktualnienia (wyzwalane przez wywołanie metody [uaktualniania wdrożenia](https://msdn.microsoft.com/library/azure/ee460793.aspx)) tak długo, jak istnieje co najmniej jedno wystąpienie usługi, który nie został jeszcze zaktualizowany do nowej wersji.</span><span class="sxs-lookup"><span data-stu-id="ea444-251">The [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in the service which has not yet been updated to the new version.</span></span>
* <span data-ttu-id="ea444-252">Element zablokowane i elementu RollbackAllowed, które są zwracane jako część treści odpowiedzi [uzyskać wdrożenia](https://msdn.microsoft.com/library/azure/ee460804.aspx) i [pobrać właściwości usługi chmury](https://msdn.microsoft.com/library/azure/ee460806.aspx) operacje:</span><span class="sxs-lookup"><span data-stu-id="ea444-252">The Locked element and the RollbackAllowed element, which are returned as part of the response body of the [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="ea444-253">Element zablokowany pozwala na wykrycie mutating operację można wywołać w ramach danego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-253">The Locked element allows you to detect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="ea444-254">RollbackAllowed element umożliwia wykrywanie, kiedy [wycofywania aktualizacji lub uaktualnienia](https://msdn.microsoft.com/library/azure/hh403977.aspx) operację można wywołać w danym wdrożeniu.</span><span class="sxs-lookup"><span data-stu-id="ea444-254">The RollbackAllowed element allows you to detect when the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="ea444-255">Aby można było przeprowadzić wycofanie, jest konieczne Sprawdź zarówno zablokowane i elementy RollbackAllowed.</span><span class="sxs-lookup"><span data-stu-id="ea444-255">In order to perform a rollback, you do not have to check both the Locked and the RollbackAllowed elements.</span></span> <span data-ttu-id="ea444-256">Wystarczające, aby upewnić się, że RollbackAllowed jest ustawiony na wartość true.</span><span class="sxs-lookup"><span data-stu-id="ea444-256">It suffices to confirm that RollbackAllowed is set to true.</span></span> <span data-ttu-id="ea444-257">Te elementy są zwracane tylko, jeśli te metody są wywoływane przy użyciu nagłówek żądania ustawioną wartość "x-ms-version: 2011-10-01" lub nowszej wersji.</span><span class="sxs-lookup"><span data-stu-id="ea444-257">These elements are only returned if these methods are invoked by using the request header set to “x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="ea444-258">Aby uzyskać więcej informacji o nagłówkach przechowywania wersji, zobacz [przechowywanie wersji usługi zarządzania](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="ea444-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="ea444-259">Istnieje kilka sytuacji, gdy wycofywania aktualizacji lub uaktualnienie nie jest obsługiwane, są to następujące dane:</span><span class="sxs-lookup"><span data-stu-id="ea444-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="ea444-260">Spadek zużycia zasobów lokalnych — Jeśli aktualizacja powoduje zwiększenie zasobów lokalnych roli platformy Azure nie zezwala na wycofanie.</span><span class="sxs-lookup"><span data-stu-id="ea444-260">Reduction in local resources - If the update increases the local resources for a role the Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="ea444-261">Limity przydziału — Jeśli aktualizacja została skali w dół operację, którą użytkownik może już nie ma wystarczającego przydziału obliczeń do wykonania operacji wycofywania.</span><span class="sxs-lookup"><span data-stu-id="ea444-261">Quota limitations - If the update was a scale down operation you may no longer have sufficient compute quota to complete the rollback operation.</span></span> <span data-ttu-id="ea444-262">Każda subskrypcja platformy Azure ma limit przydziału skojarzonych z nim określająca maksymalną liczbę rdzeni, które mogą być używane przez wszystkie usługi hostowanej, które należą do tej subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="ea444-262">Each Azure subscription has a quota associated with it that specifies the maximum number of cores which can be consumed by all hosted services that belong to that subscription.</span></span> <span data-ttu-id="ea444-263">Jeśli wykonania operacji wycofywania aktualizacji danego spowodowałaby subskrypcję za pośrednictwem przydziału, a następnie który wycofanie nie zostaną włączone.</span><span class="sxs-lookup"><span data-stu-id="ea444-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="ea444-264">Sytuacja wyścigu — Jeśli ukończono aktualizowanie początkowej, wycofanie nie jest możliwe.</span><span class="sxs-lookup"><span data-stu-id="ea444-264">Race condition - If the initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="ea444-265">Jest przykładem podczas wycofywania aktualizacji mogą być przydatne, jeśli używasz [uaktualniania wdrożenia](https://msdn.microsoft.com/library/azure/ee460793.aspx) jest wprowadzanie operacji w trybie ręcznym kontrolować szybkość, z jaką usługa hostowana główna uaktualnienia w miejscu do platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ea444-265">An example of when the rollback of an update might be useful is if you are using the [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode to control the rate at which a major in-place upgrade to your Azure hosted service is rolled out.</span></span>

<span data-ttu-id="ea444-266">Podczas wdrażania uaktualnienia należy wywołać [uaktualniania wdrożenia](https://msdn.microsoft.com/library/azure/ee460793.aspx) w trybie ręcznym i rozpocząć przeprowadzenie uaktualnienia domen.</span><span class="sxs-lookup"><span data-stu-id="ea444-266">During the rollout of the upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin to walk upgrade domains.</span></span> <span data-ttu-id="ea444-267">Jeśli w pewnym momencie podczas monitorowania uaktualnienia, należy zaznaczyć kilka wystąpień roli w pierwszych domen uaktualnienia, które należy zbadać ma przestać odpowiadać, można wywołać [wycofywania aktualizacji lub uaktualnienia](https://msdn.microsoft.com/library/azure/hh403977.aspx) operację wdrożenia, co spowoduje pozostawienie niezmienione wystąpień, które nie ma jeszcze uaktualniona i wystąpienia wycofania, które miały został uaktualniony do poprzedniego pakiet usługi i konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="ea444-267">If at some point, as you monitor the upgrade, you note some role instances in the first upgrade domains that you examine have become unresponsive, you can call the [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on the deployment, which will leave untouched the instances which had not yet been upgraded and rollback instances which had been upgraded to the previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="ea444-268">Inicjowanie wielu operacji mutating na bieżące wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="ea444-269">W niektórych przypadkach można zainicjować wiele równoczesnych operacji mutating na bieżące wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-269">In some cases you may want to initiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="ea444-270">Na przykład może wykonywać aktualizacji usługi i, gdy aktualizacja jest rozwijane między usługą, mają być niektóre zmiany, np. wycofanie ponownie aktualizację, zastosować inną aktualizację, lub nawet usuwać wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want to make some change, e.g. to roll the update back, apply a different update, or even delete the deployment.</span></span> <span data-ttu-id="ea444-271">Przypadek, w którym może to być konieczne jest, czy uaktualnianie usługi zawiera buggy kodu, co powoduje, że wystąpienie roli uaktualnionego wielokrotnie awarię.</span><span class="sxs-lookup"><span data-stu-id="ea444-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance to repeatedly crash.</span></span> <span data-ttu-id="ea444-272">W tym przypadku kontrolera sieci szkieletowej Azure nie będzie postęp w zastosowaniu której uaktualnić, ponieważ określono za małą liczbę wystąpień w uaktualnionym domeny są w dobrej kondycji.</span><span class="sxs-lookup"><span data-stu-id="ea444-272">In this case, the Azure Fabric Controller will not be able to make progress in applying that upgrade because an insufficient number of instances in the upgraded domain are healthy.</span></span> <span data-ttu-id="ea444-273">Ten stan jest określany jako *zatrzymane wdrożenia*.</span><span class="sxs-lookup"><span data-stu-id="ea444-273">This state is referred to as a *stuck deployment*.</span></span> <span data-ttu-id="ea444-274">Wdrożenia można przylegał Wycofywanie aktualizacji lub stosowania aktualizacji świeże na górze niepowodzenie jeden.</span><span class="sxs-lookup"><span data-stu-id="ea444-274">You can unstick the deployment by rolling back the update or applying a fresh update over top of the failing one.</span></span>

<span data-ttu-id="ea444-275">Po początkowej żądanie aktualizacji lub uaktualnienia usługi zostały odebrane przez kontroler sieci szkieletowej Azure, możesz przystąpić do kolejnych operacji mutacja.</span><span class="sxs-lookup"><span data-stu-id="ea444-275">Once the initial request to update or upgrade the service has been received by the Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="ea444-276">Oznacza to, że nie masz oczekiwania na zakończenie przed rozpoczęciem inna operacja mutating początkowej operacji.</span><span class="sxs-lookup"><span data-stu-id="ea444-276">That is, you do not have to wait for the initial operation to complete before you can start another mutating operation.</span></span>

<span data-ttu-id="ea444-277">Inicjowanie drugiej operacji aktualizacji, podczas pierwszej aktualizacji jest wykonywana będzie wykonywać podobne do operacji wycofywania.</span><span class="sxs-lookup"><span data-stu-id="ea444-277">Initiating a second update operation while the first update is ongoing will perform similar to the rollback operation.</span></span> <span data-ttu-id="ea444-278">Druga aktualizacja jest w trybie automatycznym, pierwsza domena uaktualnienia zostanie uaktualniony natychmiast, prawdopodobnie prowadzące do wystąpienia z wielu domen uaktualnienia jest w trybie offline, w tym samym punkcie w czasie.</span><span class="sxs-lookup"><span data-stu-id="ea444-278">If the second update is in automatic mode, the first upgrade domain will be upgraded immediately, possibly leading to instances from multiple upgrade domains being offline at the same point in time.</span></span>

<span data-ttu-id="ea444-279">Operacje mutating są następujące: [zmiany konfiguracji wdrożenia](https://msdn.microsoft.com/library/azure/ee460809.aspx), [uaktualniania wdrożenia](https://msdn.microsoft.com/library/azure/ee460793.aspx), [stan wdrożenia aktualizacji](https://msdn.microsoft.com/library/azure/ee460808.aspx), [usunąć wdrożenia](https://msdn.microsoft.com/library/azure/ee460815.aspx), i [wycofywania aktualizacji lub uaktualnienia](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="ea444-279">The mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="ea444-280">Dwie operacje [uzyskać wdrożenia](https://msdn.microsoft.com/library/azure/ee460804.aspx) i [pobrać właściwości usługi chmury](https://msdn.microsoft.com/library/azure/ee460806.aspx), zwraca flagę zablokowany, które można zbadać w celu ustalenia, czy mutating operację można wywołać w ramach danego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="ea444-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return the Locked flag which can be examined to determine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="ea444-281">Aby można było wywołać wersji tych metod, która zwraca flagę zablokowany, należy ustawić wartość nagłówka żądania "x-ms-version: 2011-10-01" lub nowszego.</span><span class="sxs-lookup"><span data-stu-id="ea444-281">In order to call the version of these methods which returns the Locked flag, you must set request header to “x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="ea444-282">Aby uzyskać więcej informacji o nagłówkach przechowywania wersji, zobacz [przechowywanie wersji usługi zarządzania](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="ea444-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="ea444-283">Rozkład ról domen uaktualnienia</span><span class="sxs-lookup"><span data-stu-id="ea444-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="ea444-284">Azure równomiernie rozdziela wystąpień roli dla pewnej liczby domen uaktualnienia, które można skonfigurować jako część pliku definicji (csdef) usługi.</span><span class="sxs-lookup"><span data-stu-id="ea444-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of the service definition (.csdef) file.</span></span> <span data-ttu-id="ea444-285">Maksymalna liczba domen uaktualnienia wynosi 20, a wartość domyślna to 5.</span><span class="sxs-lookup"><span data-stu-id="ea444-285">The max number of upgrade domains is 20 and the default is 5.</span></span> <span data-ttu-id="ea444-286">Aby uzyskać więcej informacji na temat sposobu modyfikowania pliku definicji usługi, zobacz [schematu definicji usługi Azure (pliki csdef pliku)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="ea444-286">For more information about how to modify the service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="ea444-287">Na przykład jeśli rola użytkownika ma dziesięć wystąpień, domyślnie każdej z domen zawiera dwa wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="ea444-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="ea444-288">Jeśli rola użytkownika ma 14 wystąpień, cztery domen uaktualnienia zawiera trzy wystąpienia i piątej domeny zawiera dwa.</span><span class="sxs-lookup"><span data-stu-id="ea444-288">If your role has 14 instances, then four of the upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="ea444-289">Domen uaktualnienia są oznaczone symbolem liczony od zera indeks: pierwsza domena uaktualnienia ma identyfikator równy 0, a druga domena uaktualnienia ma identyfikator równy 1 i tak dalej.</span><span class="sxs-lookup"><span data-stu-id="ea444-289">Upgrade domains are identified with a zero-based index: the first upgrade domain has an ID of 0, and the second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="ea444-290">Na poniższym diagramie przedstawiono, jak usługi niż zawiera dwie role są dystrybuowane gdy usługa definiuje dwie domeny uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="ea444-290">The following diagram illustrates how a service than contains two roles are distributed when the service defines two upgrade domains.</span></span> <span data-ttu-id="ea444-291">Usługa jest uruchomiona osiem wystąpień roli sieci web i dziewięć wystąpień roli procesu roboczego.</span><span class="sxs-lookup"><span data-stu-id="ea444-291">The service is running eight instances of the web role and nine instances of the worker role.</span></span>

<span data-ttu-id="ea444-292">![Dystrybucji domen uaktualnienia](media/cloud-services-update-azure-service/IC345533.png "dystrybucji domen uaktualnienia")</span><span class="sxs-lookup"><span data-stu-id="ea444-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="ea444-293">Należy pamiętać, że Azure kontroluje sposób przydzielania wystąpień domen uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="ea444-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="ea444-294">Nie jest możliwe określenie, które wystąpienia są przydzielone do domeny, które.</span><span class="sxs-lookup"><span data-stu-id="ea444-294">It's not possible to specify which instances are allocated to which domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="ea444-295">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="ea444-295">Next steps</span></span>
[<span data-ttu-id="ea444-296">Jak zarządzać usługi w chmurze</span><span class="sxs-lookup"><span data-stu-id="ea444-296">How to Manage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="ea444-297">Jak monitorować usługi w chmurze</span><span class="sxs-lookup"><span data-stu-id="ea444-297">How to Monitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="ea444-298">Jak skonfigurować usługi w chmurze</span><span class="sxs-lookup"><span data-stu-id="ea444-298">How to Configure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
