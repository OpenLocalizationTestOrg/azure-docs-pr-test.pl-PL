---
title: "Rozwiązywanie problemów z usługi w chmurze przy użyciu usługi Application Insights | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak rozwiązywanie problemów dotyczących usługi w chmurze przy użyciu usługi Application Insights do przetwarzania danych z diagnostyki Azure."
services: cloud-services
documentationcenter: .net
author: sbtron
manager: timlt
editor: tysonn
ms.assetid: e93f387b-ef29-4731-ae41-0676722accb6
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/23/2017
ms.author: saurabh
ms.openlocfilehash: 4001ca908ff00b1a40829d687589080e9b07b18a
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-cloud-services-using-application-insights"></a><span data-ttu-id="e10c2-103">Rozwiązywanie problemów z usługi w chmurze przy użyciu usługi Application Insights</span><span class="sxs-lookup"><span data-stu-id="e10c2-103">Troubleshoot Cloud Services using Application Insights</span></span>
<span data-ttu-id="e10c2-104">Z [Azure SDK 2.8](https://azure.microsoft.com/downloads/) i rozszerzenie diagnostycznych platformy Azure w wersji 1.5, możesz wysłać dane diagnostyczne platformy Azure dla usługi w chmurze bezpośrednio z usługą Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-104">With [Azure SDK 2.8](https://azure.microsoft.com/downloads/) and Azure diagnostics extension 1.5, you can send Azure Diagnostics data for your Cloud Service directly to Application Insights.</span></span> <span data-ttu-id="e10c2-105">Dzienniki są zbierane przez diagnostyki Azure&mdash;w tym dzienniki aplikacji, dzienniki zdarzeń systemu Windows, dzienniki zdarzeń systemu Windows i liczniki wydajności&mdash;mogą być wysyłane do usługi Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-105">The logs collected by Azure Diagnostics&mdash;including application logs, Windows Event Logs, ETW Logs, and performance counters&mdash;can be sent to Application Insights.</span></span> <span data-ttu-id="e10c2-106">Następnie można zwizualizować te informacje w portalu usługi Application Insights interfejsu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="e10c2-106">You can then visualize this information in the Application Insights portal UI.</span></span> <span data-ttu-id="e10c2-107">Zestaw SDK usługi Application Insights umożliwia następnie Uzyskaj wgląd w dzienniki, które pochodzą z aplikacji, a także systemu i danych na poziomie infrastruktury, która pochodzi z diagnostyki Azure i metryki.</span><span class="sxs-lookup"><span data-stu-id="e10c2-107">You can then use the Application Insights SDK to get insights into metrics and logs that come from your application, as well as the system and infrastructure-level data that comes from Azure Diagnostics.</span></span>

## <a name="configure-azure-diagnostics-to-send-data-to-application-insights"></a><span data-ttu-id="e10c2-108">Skonfiguruj diagnostyki Azure w celu wysyłania danych do usługi Application Insights</span><span class="sxs-lookup"><span data-stu-id="e10c2-108">Configure Azure Diagnostics to send data to Application Insights</span></span>
<span data-ttu-id="e10c2-109">Wykonaj następujące kroki, aby skonfigurować projekt usługi w chmurze na wysyłanie danych diagnostycznych Azure do usługi Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-109">Follow these steps to set up your cloud service project to send Azure Diagnostics data to Application Insights.</span></span>

1. <span data-ttu-id="e10c2-110">W Eksploratorze rozwiązań programu Visual Studio, kliknij prawym przyciskiem myszy rolę i wybierz **właściwości** można otworzyć projektanta roli.</span><span class="sxs-lookup"><span data-stu-id="e10c2-110">In Visual Studio Solution Explorer, right-click a role and select **Properties** to open the Role designer.</span></span>

    ![Właściwości roli Eksploratora rozwiązań][1]

2. <span data-ttu-id="e10c2-112">W **diagnostyki** sekcji projektanta roli, wybierz opcję **Wyślij dane diagnostyczne do usługi Application Insights** opcji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-112">In the **Diagnostics** section of the Role designer, select the **Send diagnostics data to Application Insights** option.</span></span>

    ![Projektant roli Wyślij dane diagnostyczne do usługi application insights][2]

3. <span data-ttu-id="e10c2-114">W wyskakującym oknie dialogowym Wybierz zasób usługi Application Insights, które chcesz wysyłać dane diagnostyczne platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="e10c2-114">In the dialog box that pops up, select the Application Insights resource that you want to send the Azure diagnostics data to.</span></span> <span data-ttu-id="e10c2-115">Okno dialogowe umożliwia wybierz istniejący zasób usługi Application Insights z subskrypcji lub ręcznie określić klucz instrumentacji dla zasobu usługi Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-115">The dialog box allows you to select an existing Application Insights resource from your subscription or to manually specify an instrumentation key for an Application Insights resource.</span></span> <span data-ttu-id="e10c2-116">Aby uzyskać więcej informacji na temat tworzenia zasobu usługi Application Insights, zobacz [utworzyć nowy zasób usługi Application Insights](../application-insights/app-insights-create-new-resource.md).</span><span class="sxs-lookup"><span data-stu-id="e10c2-116">For more information on creating an Application Insights resource, see [Create a new Application Insights resource](../application-insights/app-insights-create-new-resource.md).</span></span>

    ![Wybierz zasób usługi application insights][3]

    <span data-ttu-id="e10c2-118">Po dodaniu zasobu usługi Application Insights klucza instrumentacji dla tego zasobu jest przechowywana jako ustawienia konfiguracji usługi o nazwie **APPINSIGHTS_INSTRUMENTATIONKEY**.</span><span class="sxs-lookup"><span data-stu-id="e10c2-118">Once you have added the Application Insights resource, the instrumentation key for that resource is stored as a service configuration setting with the name **APPINSIGHTS_INSTRUMENTATIONKEY**.</span></span> <span data-ttu-id="e10c2-119">Można zmienić tego ustawienia konfiguracji dla każdej konfiguracji usługi lub środowiska.</span><span class="sxs-lookup"><span data-stu-id="e10c2-119">You can change this configuration setting for each service configuration or environment.</span></span> <span data-ttu-id="e10c2-120">Aby to zrobić, wybierz inną konfigurację z **konfiguracji usługi** listę i określenie nowego klucza Instrumentacji w takiej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-120">To do so, select a different configuration from the **Service Configuration** list and specify a new instrumentation key for that configuration.</span></span>

    ![Wybierz konfigurację usługi][4]

    <span data-ttu-id="e10c2-122">**APPINSIGHTS_INSTRUMENTATIONKEY** ustawienie konfiguracji jest używany przez program Visual Studio do konfigurowania rozszerzenia diagnostyki odpowiednie informacje zasobu usługi Application Insights podczas publikowania.</span><span class="sxs-lookup"><span data-stu-id="e10c2-122">The **APPINSIGHTS_INSTRUMENTATIONKEY** configuration setting is used by Visual Studio to configure the diagnostics extension with the appropriate Application Insights resource information during publishing.</span></span> <span data-ttu-id="e10c2-123">Ustawienie konfiguracji jest to wygodny sposób definiowania różnych Instrumentacji kluczy w przypadku konfiguracji z innej usługi.</span><span class="sxs-lookup"><span data-stu-id="e10c2-123">The configuration setting is a convenient way of defining different instrumentation keys for different service configurations.</span></span> <span data-ttu-id="e10c2-124">Programu Visual Studio będzie Przetłumacz ustawienie i wstawić je do diagnostyki publiczna Konfiguracja rozszerzenia podczas procesu publikowania.</span><span class="sxs-lookup"><span data-stu-id="e10c2-124">Visual Studio will translate that setting and insert it into the diagnostics extension public configuration during the publish process.</span></span> <span data-ttu-id="e10c2-125">Aby uprościć proces konfigurowania rozszerzenia diagnostyki przy użyciu programu PowerShell, dane wyjściowe pakietu z programu Visual Studio zawiera publicznej konfiguracji XML przy użyciu odpowiedniego klucza Instrumentacji usługi Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-125">To simplify the process of configuring the diagnostics extension with PowerShell, the package output from Visual Studio also contains the public configuration XML with the appropriate Application Insights instrumentation key.</span></span> <span data-ttu-id="e10c2-126">Pliki konfiguracji publicznego są tworzone w folderze rozszerzenia i postępuj zgodnie ze wzorcem *PaaSDiagnostics.&lt; RoleName&gt;. PubConfig.xml*.</span><span class="sxs-lookup"><span data-stu-id="e10c2-126">The public config files are created in the Extensions folder and follow the pattern *PaaSDiagnostics.&lt;RoleName&gt;.PubConfig.xml*.</span></span> <span data-ttu-id="e10c2-127">Wszystkie wdrożenia oparte na środowisku PowerShell można używać tego wzorca do mapowania każdej konfiguracji do roli.</span><span class="sxs-lookup"><span data-stu-id="e10c2-127">Any PowerShell-based deployments can use this pattern to map each configuration to a role.</span></span>

4) <span data-ttu-id="e10c2-128">Aby skonfigurować diagnostycznych platformy Azure, aby wysłać wszystkie dzienniki poziom błędu zbieranych przez agenta diagnostyki Azure do usługi Application Insights i liczniki wydajności, należy włączyć **Wyślij dane diagnostyczne do usługi Application Insights** opcji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-128">To configure Azure diagnostics to send all performance counters and error-level logs collected by the Azure diagnostics agent to Application Insights, enable the **Send diagnostics data to Application Insights** option.</span></span> 

    <span data-ttu-id="e10c2-129">Jeśli chcesz dodatkowo skonfigurować, jakie dane są wysyłane do usługi Application Insights, należy ręcznie zmienić *diagnostics.wadcfgx* plik dla każdej roli.</span><span class="sxs-lookup"><span data-stu-id="e10c2-129">If you want to further configure what data is sent to Application Insights, you must manually edit the *diagnostics.wadcfgx* file for each role.</span></span> <span data-ttu-id="e10c2-130">Zobacz [skonfigurować diagnostyki Azure do przesyłania danych do usługi Application Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) Aby dowiedzieć się więcej na temat ręcznego aktualizowania konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-130">See [Configure Azure Diagnostics to send data to Application Insights](#configure-azure-diagnostics-to-send-data-to-application-insights) to learn more about manually updating the configuration.</span></span>

<span data-ttu-id="e10c2-131">Gdy usługa w chmurze jest skonfigurowany do wysyłania danych diagnostycznych platformy Azure do usługi application insights, można wdrożyć go na platformie Azure zazwyczaj zagwarantowanie, że rozszerzenie Azure diagnostics jest włączone.</span><span class="sxs-lookup"><span data-stu-id="e10c2-131">When the cloud service is configured to send Azure diagnostics data to application insights, you can deploy it to Azure normally, making sure the Azure diagnostics extension is enabled.</span></span> <span data-ttu-id="e10c2-132">Aby uzyskać więcej informacji, zobacz [publikowania usługi w chmurze przy użyciu programu Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span><span class="sxs-lookup"><span data-stu-id="e10c2-132">For more information, see  [Publishing a Cloud Service using Visual Studio](../vs-azure-tools-publishing-a-cloud-service.md).</span></span>  

## <a name="viewing-azure-diagnostics-data-in-application-insights"></a><span data-ttu-id="e10c2-133">Wyświetlanie danych diagnostycznych platformy Azure w usłudze Application Insights</span><span class="sxs-lookup"><span data-stu-id="e10c2-133">Viewing Azure diagnostics data in Application Insights</span></span>
<span data-ttu-id="e10c2-134">Azure telemetrii diagnostycznych zostaną wyświetlone w zasobu usługi Application Insights skonfigurowany dla usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="e10c2-134">The Azure diagnostic telemetry shows up in the Application Insights resource configured for your cloud service.</span></span>

<span data-ttu-id="e10c2-135">Mapa typy dziennika diagnostyki Azure do koncepcji usługi Application Insights w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="e10c2-135">Azure diagnostics log types map to Application Insights concepts in these ways:</span></span>

* <span data-ttu-id="e10c2-136">Liczniki wydajności są wyświetlane jako metryki niestandardowe w usłudze Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-136">Performance counters are displayed as Custom Metrics in Application Insights.</span></span>
* <span data-ttu-id="e10c2-137">Dzienniki zdarzeń systemu Windows są wyświetlane jako śladów i zdarzeń niestandardowych w usłudze Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-137">Windows Event Logs are shown as Traces and Custom Events in Application Insights.</span></span>
* <span data-ttu-id="e10c2-138">Dzienniki aplikacji, dzienniki zdarzeń systemu Windows i żadnych dzienników diagnostycznych infrastruktury są wyświetlane jako dane śledzenia w usłudze Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e10c2-138">Application logs, ETW logs, and any Diagnostics Infrastructure logs are shown as Traces in Application Insights.</span></span>

<span data-ttu-id="e10c2-139">Aby wyświetlić dane diagnostyczne platformy Azure w usłudze Application Insights, wykonaj jedną z następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="e10c2-139">To view Azure diagnostics data in Application Insights, do one of the following:</span></span>

* <span data-ttu-id="e10c2-140">Użyj [Eksploratora metryk](../application-insights/app-insights-metrics-explorer.md) do wizualizacji wszelkie niestandardowe liczniki wydajności lub liczby różnych rodzajów zdarzeń w dzienniku zdarzeń systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="e10c2-140">Use [Metrics explorer](../application-insights/app-insights-metrics-explorer.md) to visualize any custom performance counters or counts of different types of Windows Event Log events.</span></span>

    ![Metryki niestandardowe w Eksploratorze metryk][5]

* <span data-ttu-id="e10c2-142">Użyj [wyszukiwania](../application-insights/app-insights-diagnostic-search.md) można przeszukiwać dzienniki śledzenia wysyłane przez diagnostyki Azure.</span><span class="sxs-lookup"><span data-stu-id="e10c2-142">Use [Search](../application-insights/app-insights-diagnostic-search.md) to search across the  trace logs sent by Azure Diagnostics.</span></span> <span data-ttu-id="e10c2-143">Na przykład, jeśli wystąpił nieobsługiwany wyjątek spowodował roli awarii i Odtwórz, informacje o wyjątku zostaną wyświetlone w *aplikacji* kanału *dziennika zdarzeń systemu Windows*.</span><span class="sxs-lookup"><span data-stu-id="e10c2-143">For example, if an unhandled exception has caused the role to crash and recycle, information about the exception shows up in the *Application* channel of *Windows Event Log*.</span></span> <span data-ttu-id="e10c2-144">Wyszukiwania można używać, aby znaleźć w dzienniku zdarzeń systemu Windows i pobranie śladu stosu pełny wyjątek ustalić przyczynę problemu.</span><span class="sxs-lookup"><span data-stu-id="e10c2-144">You can use search to look at the Windows Event Log error and get the full stack trace for the exception to help find the cause of the issue.</span></span>

    ![Ślady wyszukiwania][6]

## <a name="next-steps"></a><span data-ttu-id="e10c2-146">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="e10c2-146">Next Steps</span></span>
* <span data-ttu-id="e10c2-147">[Dodaj zestaw SDK usługi Application Insights do usługi w chmurze](../application-insights/app-insights-cloudservices.md) Aby wysłać dane dotyczące żądań, wyjątków, zależności i wszelkie niestandardowe dane telemetryczne z aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-147">[Add the Application Insights SDK to your cloud service](../application-insights/app-insights-cloudservices.md) to send data about requests, exceptions, dependencies, and any custom telemetry from your application.</span></span> <span data-ttu-id="e10c2-148">W połączeniu z danymi diagnostyki Azure, te informacje można uzyskać pełny widok aplikacji i systemu, w tej samej zasobów szczegółowe informacje o aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e10c2-148">When combined with the Azure Diagnostics data, this information you can get a complete view of your application and system, all in the same Application Insight resource.</span></span>  

<!--Image references-->
[1]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/solution-explorer-properties.png
[2]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-sendtoappinsights.png
[3]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/select-appinsights-resource.png
[4]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/role-designer-appinsights-serviceconfig.png
[5]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/metrics-explorer-custom-metrics.png
[6]: ./media/cloud-services-dotnet-diagnostics-applicationinsights/search-windowseventlog-error.png
