---
title: "zdarzenia cyklu życia usługi w chmurze aaaHandle | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak metod cyklu życia hello roli usługi w chmurze można użyć w .NET"
services: cloud-services
documentationcenter: .net
author: Thraka
manager: timlt
editor: 
ms.assetid: 39b30acd-57b9-48b7-a7c4-40ea3430e451
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: adegeo
ms.openlocfilehash: cc0ccc5f055b965202b6e081a6ab72ad5d39b034
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="customize-hello-lifecycle-of-a-web-or-worker-role-in-net"></a><span data-ttu-id="df985-103">Dostosowywanie hello cyklu życia roli sieci Web lub procesu roboczego w programie .NET</span><span class="sxs-lookup"><span data-stu-id="df985-103">Customize hello Lifecycle of a Web or Worker role in .NET</span></span>
<span data-ttu-id="df985-104">Podczas tworzenia roli procesu roboczego rozszerzyć hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) klasy, która udostępnia metody dla Ciebie toooverride, które umożliwiają odpowiadać toolifecycle zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="df985-104">When you create a worker role, you extend hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class which provides methods for you toooverride that let you respond toolifecycle events.</span></span> <span data-ttu-id="df985-105">Dla ról sieć web ta klasa jest opcjonalne, trzeba używać toorespond toolifecycle zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="df985-105">For web roles this class is optional, so you must use it toorespond toolifecycle events.</span></span>

## <a name="extend-hello-roleentrypoint-class"></a><span data-ttu-id="df985-106">Rozszerzenie klasy RoleEntryPoint hello</span><span class="sxs-lookup"><span data-stu-id="df985-106">Extend hello RoleEntryPoint class</span></span>
<span data-ttu-id="df985-107">Hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) klasa zawiera metody, które są wywoływane przez platformę Azure podczas jego **uruchamia**, **uruchamia**, lub **zatrzymuje** roli sieci web lub procesu roboczego.</span><span class="sxs-lookup"><span data-stu-id="df985-107">hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class includes methods that are called by Azure when it **starts**, **runs**, or **stops** a web or worker role.</span></span> <span data-ttu-id="df985-108">Opcjonalnie można zastąpić te metody toomanage roli inicjowania, roli zamknięcia sekwencji lub wątku wykonawczego hello hello roli.</span><span class="sxs-lookup"><span data-stu-id="df985-108">You can optionally override these methods toomanage role initialization, role shutdown sequences, or hello execution thread of hello role.</span></span> 

<span data-ttu-id="df985-109">Podczas rozszerzania **RoleEntryPoint**, należy zwrócić uwagę hello następujące zachowania hello metod:</span><span class="sxs-lookup"><span data-stu-id="df985-109">When extending **RoleEntryPoint**, you should be aware of hello following behaviors of hello methods:</span></span>

* <span data-ttu-id="df985-110">Witaj [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) i [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) metody zwracać wartość logiczną, dzięki czemu możliwe tooreturn **false** z tych metod.</span><span class="sxs-lookup"><span data-stu-id="df985-110">hello [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) and [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) methods return a boolean value, so it is possible tooreturn **false** from these methods.</span></span>
  
   <span data-ttu-id="df985-111">Jeśli kod zwraca **false**, proces roli hello nagle jest zakończony, bez konieczności uruchamiania żadnych zamykania może być w miejscu.</span><span class="sxs-lookup"><span data-stu-id="df985-111">If your code returns **false**, hello role process is abruptly terminated, without running any shutdown sequence you may have in place.</span></span> <span data-ttu-id="df985-112">Ogólnie rzecz biorąc, należy unikać zwracanie **false** z hello **OnStart** metody.</span><span class="sxs-lookup"><span data-stu-id="df985-112">In general, you should avoid returning **false** from hello **OnStart** method.</span></span>
* <span data-ttu-id="df985-113">Wszelkie nieprzechwycony wyjątek w obrębie przeciążenia **RoleEntryPoint** metoda jest traktowana jako nieobsługiwany wyjątek.</span><span class="sxs-lookup"><span data-stu-id="df985-113">Any uncaught exception within an overload of a **RoleEntryPoint** method is treated as an unhandled exception.</span></span>
  
   <span data-ttu-id="df985-114">Jeśli wystąpi wyjątek w jednej z metod cyklu życia hello, Azure zostanie podniesiony hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) zdarzenia, a następnie hello proces jest zakończony.</span><span class="sxs-lookup"><span data-stu-id="df985-114">If an exception occurs within one of hello lifecycle methods, Azure will raise hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event, and then hello process is terminated.</span></span> <span data-ttu-id="df985-115">Po roli użytkownika został przełączony w tryb offline, zostanie ono uruchomione na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="df985-115">After your role has been taken offline, it will be restarted by Azure.</span></span> <span data-ttu-id="df985-116">Gdy wystąpił nieobsługiwany wyjątek wystąpi, hello [zatrzymywanie](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) zdarzenie nie jest wywoływane i hello **OnStop** nie jest wywoływana metoda.</span><span class="sxs-lookup"><span data-stu-id="df985-116">When an unhandled exception occurs, hello [Stopping](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) event is not raised, and hello **OnStop** method is not called.</span></span>

<span data-ttu-id="df985-117">Roli użytkownika nie uruchamia się, czy jest odtwarzania między hello inicjowania stanów zajęty i zatrzymywanie, kod może zgłaszanie nieobsługiwany wyjątek w ramach jednej zdarzenia cyklu życia hello każdej roli hello czasu ponownym uruchomieniem.</span><span class="sxs-lookup"><span data-stu-id="df985-117">If your role does not start, or is recycling between hello initializing, busy, and stopping states, your code may be throwing an unhandled exception within one of hello lifecycle events each time hello role restarts.</span></span> <span data-ttu-id="df985-118">W takim przypadku należy użyć hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) toodetermine zdarzeń hello przyczyną hello wyjątku i odpowiednią obsługę.</span><span class="sxs-lookup"><span data-stu-id="df985-118">In this case, use hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event toodetermine hello cause of hello exception and handle it appropriately.</span></span> <span data-ttu-id="df985-119">Roli użytkownika może być również zwracanie z hello [Uruchom](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) metodę, która powoduje, że hello toorestart roli.</span><span class="sxs-lookup"><span data-stu-id="df985-119">Your role may also be returning from hello [Run](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) method, which causes hello role toorestart.</span></span> <span data-ttu-id="df985-120">Aby uzyskać więcej informacji na temat stanów wdrożenia, zobacz [tooRecycle typowe problemy z którego przyczyna role](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span><span class="sxs-lookup"><span data-stu-id="df985-120">For more information about deployment states, see [Common Issues Which Cause Roles tooRecycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span></span>

> [!NOTE]
> <span data-ttu-id="df985-121">Jeśli używasz hello **Azure Tools dla programu Microsoft Visual Studio** toodevelop aplikacji, szablony projektu roli hello automatyczne rozszerzanie hello **RoleEntryPoint** klasy, w hello *WebRole.cs* i *WorkerRole.cs* plików.</span><span class="sxs-lookup"><span data-stu-id="df985-121">If you are using hello **Azure Tools for Microsoft Visual Studio** toodevelop your application, hello role project templates automatically extend hello **RoleEntryPoint** class for you, in hello *WebRole.cs* and *WorkerRole.cs* files.</span></span>
> 
> 

## <a name="onstart-method"></a><span data-ttu-id="df985-122">OnStart — metoda</span><span class="sxs-lookup"><span data-stu-id="df985-122">OnStart method</span></span>
<span data-ttu-id="df985-123">Witaj **OnStart** metoda jest wywoływana, gdy wystąpienie roli w tryb online na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="df985-123">hello **OnStart** method is called when your role instance is brought online by Azure.</span></span> <span data-ttu-id="df985-124">Podczas wykonywania hello kodu OnStart wystąpienia roli hello jest oznaczony jako **zajęty** i nie ruch zewnętrzny zostanie ukierunkowanej tooit przez hello równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="df985-124">While hello OnStart code is executing, hello role instance is marked as **Busy** and no external traffic will be directed tooit by hello load balancer.</span></span> <span data-ttu-id="df985-125">Można zastąpić ten — metoda tooperform inicjowania pracy, takich jak wdrażanie programów obsługi zdarzeń i uruchamianie [diagnostyki Azure](cloud-services-how-to-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="df985-125">You can override this method tooperform initialization work, such as implementing event handlers and starting [Azure Diagnostics](cloud-services-how-to-monitor.md).</span></span>

<span data-ttu-id="df985-126">Jeśli **OnStart** zwraca **true**, pomyślnie zainicjowano wystąpienia hello i wywołuje Azure hello **RoleEntryPoint.Run** metody.</span><span class="sxs-lookup"><span data-stu-id="df985-126">If **OnStart** returns **true**, hello instance is successfully initialized and Azure calls hello **RoleEntryPoint.Run** method.</span></span> <span data-ttu-id="df985-127">Jeśli **OnStart** zwraca **false**, roli hello natychmiast kończy się bez wykonania dowolnego planowanego zamknięcia sekwencji.</span><span class="sxs-lookup"><span data-stu-id="df985-127">If **OnStart** returns **false**, hello role terminates immediately, without executing any planned shutdown sequences.</span></span>

<span data-ttu-id="df985-128">Witaj, jak po przedstawia przykładowy kod toooverride hello **OnStart** metody.</span><span class="sxs-lookup"><span data-stu-id="df985-128">hello following code example shows how toooverride hello **OnStart** method.</span></span> <span data-ttu-id="df985-129">Ta metoda umożliwia skonfigurowanie i rozpoczyna się monitora diagnostycznego w momencie wystąpienia roli hello uruchamia i konfiguruje transfer rejestrowania konta magazynu tooa danych:</span><span class="sxs-lookup"><span data-stu-id="df985-129">This method configures and starts a diagnostic monitor when hello role instance starts and sets up a transfer of logging data tooa storage account:</span></span>

```csharp
public override bool OnStart()
{
    var config = DiagnosticMonitor.GetDefaultInitialConfiguration();

    config.DiagnosticInfrastructureLogs.ScheduledTransferLogLevelFilter = LogLevel.Error;
    config.DiagnosticInfrastructureLogs.ScheduledTransferPeriod = TimeSpan.FromMinutes(5);

    DiagnosticMonitor.Start("DiagnosticsConnectionString", config);

    return true;
}
```

## <a name="onstop-method"></a><span data-ttu-id="df985-130">OnStop — metoda</span><span class="sxs-lookup"><span data-stu-id="df985-130">OnStop method</span></span>
<span data-ttu-id="df985-131">Witaj **OnStop** metoda jest wywoływana po wystąpienia roli została podjęta w trybie offline przez platformę Azure i przed hello proces kończy się.</span><span class="sxs-lookup"><span data-stu-id="df985-131">hello **OnStop** method is called after a role instance has been taken offline by Azure and before hello process exits.</span></span> <span data-ttu-id="df985-132">Można zastąpić ten kod toocall metody wymagane dla Twojego toocleanly wystąpienia roli zamknięta.</span><span class="sxs-lookup"><span data-stu-id="df985-132">You can override this method toocall code required for your role instance toocleanly shut down.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="df985-133">Kodu uruchamianego w hello **OnStop** metoda ma toofinish ograniczony czas, gdy jest wywoływana z powodów innych niż zamknięcia zainicjowanego przez użytkownika.</span><span class="sxs-lookup"><span data-stu-id="df985-133">Code running in hello **OnStop** method has a limited time toofinish when it is called for reasons other than a user-initiated shutdown.</span></span> <span data-ttu-id="df985-134">Po upływie tego czasu, hello proces jest zakończony, dlatego należy się upewnić, że kod w hello **OnStop** metody można szybko uruchomić lub zaakceptować toocompletion nie jest uruchomiony.</span><span class="sxs-lookup"><span data-stu-id="df985-134">After this time elapses, hello process is terminated, so you must make sure that code in hello **OnStop** method can run quickly or tolerates not running toocompletion.</span></span> <span data-ttu-id="df985-135">Witaj **OnStop** metoda jest wywoływana po wykonaniu hello **zatrzymywanie** zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="df985-135">hello **OnStop** method is called after hello **Stopping** event is raised.</span></span>
> 
> 

## <a name="run-method"></a><span data-ttu-id="df985-136">Run — metoda</span><span class="sxs-lookup"><span data-stu-id="df985-136">Run method</span></span>
<span data-ttu-id="df985-137">Można zastąpić hello **Uruchom** tooimplement metody wątku długotrwałe dla swojego wystąpienia roli.</span><span class="sxs-lookup"><span data-stu-id="df985-137">You can override hello **Run** method tooimplement a long-running thread for your role instance.</span></span>

<span data-ttu-id="df985-138">Zastępowanie hello **Uruchom** — metoda nie jest wymagana; hello Domyślna implementacja uruchamia wątku, który jest w stanie uśpienia nieskończona.</span><span class="sxs-lookup"><span data-stu-id="df985-138">Overriding hello **Run** method is not required; hello default implementation starts a thread that sleeps forever.</span></span> <span data-ttu-id="df985-139">Jeśli zastąpienie hello **Uruchom** metody kodu powinna zablokować nieskończoność.</span><span class="sxs-lookup"><span data-stu-id="df985-139">If you do override hello **Run** method, your code should block indefinitely.</span></span> <span data-ttu-id="df985-140">Jeśli hello **Uruchom** metoda zwróci wartość, automatycznie bezpiecznie odtworzeniem roli hello; innymi słowy, zgłasza Azure hello **zatrzymywanie** hello zdarzeń i wywołania **OnStop** metody tak czy sekwencjach zamknięcia mogą być wykonywane przed hello roli do trybu offline.</span><span class="sxs-lookup"><span data-stu-id="df985-140">If hello **Run** method returns, hello role is automatically gracefully recycled; in other words, Azure raises hello **Stopping** event and calls hello **OnStop** method so that your shutdown sequences may be executed before hello role is taken offline.</span></span>

### <a name="implementing-hello-aspnet-lifecycle-methods-for-a-web-role"></a><span data-ttu-id="df985-141">Implementacja metody cyklu życia ASP.NET hello roli sieci web</span><span class="sxs-lookup"><span data-stu-id="df985-141">Implementing hello ASP.NET lifecycle methods for a web role</span></span>
<span data-ttu-id="df985-142">Można używać metod cyklu życia ASP.NET hello, oprócz toothose podał hello **RoleEntryPoint** klasy toomanage inicjowania i zamknięcie sekwencji dla roli sieci web.</span><span class="sxs-lookup"><span data-stu-id="df985-142">You can use hello ASP.NET lifecycle methods, in addition toothose provided by hello **RoleEntryPoint** class, toomanage initialization and shutdown sequences for a web role.</span></span> <span data-ttu-id="df985-143">Może to być przydatne do celów zgodności, jeśli są Przenoszenie istniejących tooAzure aplikacji ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="df985-143">This may be useful for compatibility purposes if you are porting an existing ASP.NET application tooAzure.</span></span> <span data-ttu-id="df985-144">metody cyklu życia ASP.NET Hello zostaną wywołane wewnątrz hello **RoleEntryPoint** metody.</span><span class="sxs-lookup"><span data-stu-id="df985-144">hello ASP.NET lifecycle methods are called from within hello **RoleEntryPoint** methods.</span></span> <span data-ttu-id="df985-145">Witaj **aplikacji\_Start** metoda jest wywoływana po wykonaniu hello **RoleEntryPoint.OnStart** zakończeniu działania metody.</span><span class="sxs-lookup"><span data-stu-id="df985-145">hello **Application\_Start** method is called after hello **RoleEntryPoint.OnStart** method finishes.</span></span> <span data-ttu-id="df985-146">Witaj **aplikacji\_zakończenia** metoda jest wywoływana przed hello **RoleEntryPoint.OnStop** metoda jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="df985-146">hello **Application\_End** method is called before hello **RoleEntryPoint.OnStop** method is called.</span></span>

## <a name="next-steps"></a><span data-ttu-id="df985-147">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="df985-147">Next steps</span></span>
<span data-ttu-id="df985-148">Dowiedz się, jak za[Utwórz pakiet usługi chmury](cloud-services-model-and-package.md).</span><span class="sxs-lookup"><span data-stu-id="df985-148">Learn how too[create a cloud service package](cloud-services-model-and-package.md).</span></span>

