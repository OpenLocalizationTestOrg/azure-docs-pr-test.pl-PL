---
title: "Błąd alokacji usługi w chmurze aaaTroubleshooting | Dokumentacja firmy Microsoft"
description: "Rozwiązywanie problemów z błędami alokacji podczas wdrażania usługi Cloud Services na platformie Azure"
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: dfd5cc4663ccc6ed1b27ca9df579182737363b0e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="b1fed-103">Rozwiązywanie problemów z błędami alokacji podczas wdrażania usługi Cloud Services na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="b1fed-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="b1fed-104">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b1fed-104">Summary</span></span>
<span data-ttu-id="b1fed-105">Podczas wdrażania tooa wystąpień usługi w chmurze lub dodać nową sieć web lub wystąpień roli procesu roboczego, Microsoft Azure przydziela zasoby obliczeniowe.</span><span class="sxs-lookup"><span data-stu-id="b1fed-105">When you deploy instances tooa Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="b1fed-106">Czasami może pojawić błędy podczas przeprowadzania tych operacji nawet zanim przejdziesz hello limity subskrypcji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="b1fed-106">You may occasionally receive errors when performing these operations even before you reach hello Azure subscription limits.</span></span> <span data-ttu-id="b1fed-107">W tym artykule opisano niektóre typowe błędy alokacji hello hello przyczyny, a także sugeruje możliwe korygowania.</span><span class="sxs-lookup"><span data-stu-id="b1fed-107">This article explains hello causes of some of hello common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="b1fed-108">Planując wdrożenie hello usług Hello informacje mogą być również przydatne.</span><span class="sxs-lookup"><span data-stu-id="b1fed-108">hello information may also be useful when you plan hello deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="b1fed-109">Tło — jak działa alokacji</span><span class="sxs-lookup"><span data-stu-id="b1fed-109">Background – How allocation works</span></span>
<span data-ttu-id="b1fed-110">Witaj serwerach w centrach danych platformy Azure są dzielone w klastrach.</span><span class="sxs-lookup"><span data-stu-id="b1fed-110">hello servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="b1fed-111">Nowe żądanie alokacji usługi chmury nastąpiła w wielu klastrach.</span><span class="sxs-lookup"><span data-stu-id="b1fed-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="b1fed-112">Po pierwszym wystąpieniu hello jest tooa wdrożonej usługi w chmurze (w albo tymczasowym czy produkcyjnym), usługa w chmurze pobiera przypiętych tooa klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-112">When hello first instance is deployed tooa cloud service(in either staging or production), that cloud service gets pinned tooa cluster.</span></span> <span data-ttu-id="b1fed-113">Dla usługi w chmurze hello nastąpi w hello sam żadnego dalszego wdrożenia klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-113">Any further deployments for hello cloud service will happen in hello same cluster.</span></span> <span data-ttu-id="b1fed-114">W tym artykule firma Microsoft będzie odwoływać się toothis jako "przypiętych tooa klastra".</span><span class="sxs-lookup"><span data-stu-id="b1fed-114">In this article, we'll refer toothis as "pinned tooa cluster".</span></span> <span data-ttu-id="b1fed-115">Diagram 1 poniżej przedstawia hello przypadku normalnych alokacji, w której nastąpiła w wielu klastrach; Diagram 2 przedstawia przypadku hello alokacji to jest przypięty tooCluster 2 ponieważ, który jest gdzie hello istniejących CS_1 usługi w chmurze jest obsługiwana.</span><span class="sxs-lookup"><span data-stu-id="b1fed-115">Diagram 1 below illustrates hello case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates hello case of an allocation that's pinned tooCluster 2 because that's where hello existing Cloud Service CS_1 is hosted.</span></span>

![Diagram alokacji](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="b1fed-117">Dlaczego sytuacji błąd alokacji</span><span class="sxs-lookup"><span data-stu-id="b1fed-117">Why allocation failure happens</span></span>
<span data-ttu-id="b1fed-118">Żądanie alokacji jest przypięty tooa klastra, ma wyższy stopień niepowodzeniem toofind zwolnić zasoby, ponieważ pula zasobów dostępnych hello jest ograniczona tooa klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-118">When an allocation request is pinned tooa cluster, there's a higher chance of failing toofind free resources since hello available resource pool is limited tooa cluster.</span></span> <span data-ttu-id="b1fed-119">Ponadto jeśli żądanie alokacji jest przypięty tooa klastra, ale hello typ zasobu, która miała nie jest obsługiwany przez ten klaster, żądanie zakończy się niepowodzeniem nawet wtedy, gdy klaster hello ma bezpłatnego zasobu.</span><span class="sxs-lookup"><span data-stu-id="b1fed-119">Furthermore, if your allocation request is pinned tooa cluster but hello type of resource you requested is not supported by that cluster, your request will fail even if hello cluster has free resource.</span></span> <span data-ttu-id="b1fed-120">Diagram 3 poniżej przedstawia przypadku hello gdzie przypiętych alokacja nie powiedzie się, ponieważ hello candidate tylko klastra nie ma wolnego zasobów.</span><span class="sxs-lookup"><span data-stu-id="b1fed-120">Diagram 3 below illustrates hello case where a pinned allocation fails because hello only candidate cluster does not have free resources.</span></span> <span data-ttu-id="b1fed-121">Diagram 4 przedstawia przypadku hello których alokacji przypiętych nie powiedzie się, ponieważ hello tylko candidate klastra nie obsługuje hello żądany rozmiar maszyny Wirtualnej, nawet jeśli klaster hello ma zwolnić zasoby.</span><span class="sxs-lookup"><span data-stu-id="b1fed-121">Diagram 4 illustrates hello case where a pinned allocation fails because hello only candidate cluster does not support hello requested VM size, even though hello cluster has free resources.</span></span>

![Błąd alokacji przypiętych](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="b1fed-123">Rozwiązywanie problemów z błędami alokacji dla usług w chmurze</span><span class="sxs-lookup"><span data-stu-id="b1fed-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="b1fed-124">Komunikat o błędzie</span><span class="sxs-lookup"><span data-stu-id="b1fed-124">Error Message</span></span>
<span data-ttu-id="b1fed-125">Może zostać wyświetlony następujący komunikat o błędzie hello:</span><span class="sxs-lookup"><span data-stu-id="b1fed-125">You may see hello following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable toosatisfy constraints in request. hello requested new service deployment is bound tooan Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains hello new deployment toospecific Azure resources. Please retry later or try reducing hello VM size or number of role instances. Alternatively, if possible, remove hello aforementioned constraints or try deploying tooa different region."

### <a name="common-issues"></a><span data-ttu-id="b1fed-126">Typowe problemy</span><span class="sxs-lookup"><span data-stu-id="b1fed-126">Common Issues</span></span>
<span data-ttu-id="b1fed-127">Poniżej przedstawiono hello typowych alokacji scenariuszy, które powodują alokacji żądania toobe przypiętych tooa jednego klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-127">Here are hello common allocation scenarios that cause an allocation request toobe pinned tooa single cluster.</span></span>

* <span data-ttu-id="b1fed-128">Wdrażanie tooStaging miejsca — Jeśli usługa w chmurze ma wdrożenia w każdym miejscu, następnie usługa w chmurze całego hello jest przypięty tooa konkretnego klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-128">Deploying tooStaging Slot - If a cloud service has a deployment in either slot, then hello entire cloud service is pinned tooa specific cluster.</span></span>  <span data-ttu-id="b1fed-129">Oznacza to, że jeśli wdrożenia już istnieje w gnieździe produkcyjnym hello, następnie nowe wdrożenie przemieszczania może zostać przydzielone tylko w hello sam klastra jako hello miejsca produkcji.</span><span class="sxs-lookup"><span data-stu-id="b1fed-129">This means that if a deployment already exists in hello production slot, then a new staging deployment can only be allocated in hello same cluster as hello production slot.</span></span> <span data-ttu-id="b1fed-130">Jeśli klaster hello zbliża się do pojemności, Żądanie hello może zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="b1fed-130">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="b1fed-131">Skalowanie — Dodawanie nowych wystąpień tooan istniejącą usługę w chmurze musi przydzielić w hello sam klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-131">Scaling - Adding new instances tooan existing cloud service must allocate in hello same cluster.</span></span>  <span data-ttu-id="b1fed-132">Zazwyczaj można przydzielić pomniejszonego skalowanie żądania, ale nie zawsze.</span><span class="sxs-lookup"><span data-stu-id="b1fed-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="b1fed-133">Jeśli klaster hello zbliża się do pojemności, Żądanie hello może zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="b1fed-133">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="b1fed-134">Grupa koligacji — nową usługę chmury pusty tooan wdrożenia mogą zostać przydzieleni przez sieć szkieletowa hello w dowolnego klastra w danym regionie, chyba, że usługa w chmurze hello jest przypięty tooan grupy koligacji.</span><span class="sxs-lookup"><span data-stu-id="b1fed-134">Affinity Group - A new deployment tooan empty cloud service can be allocated by hello fabric in any cluster in that region, unless hello cloud service is pinned tooan affinity group.</span></span> <span data-ttu-id="b1fed-135">Toohello wdrożeń w tej samej grupie koligacji, zostanie podjęta na powitania tego samego klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-135">Deployments toohello same affinity group will be attempted on hello same cluster.</span></span> <span data-ttu-id="b1fed-136">Jeśli klaster hello zbliża się do pojemności, Żądanie hello może zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="b1fed-136">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="b1fed-137">Grupy koligacji vNet - starszych sieci wirtualnych zostały wiązanej tooaffinity grupy zamiast regionów, a usługi w chmurze w tych sieciach wirtualnych będzie przypiętych toohello grupy koligacji klastra.</span><span class="sxs-lookup"><span data-stu-id="b1fed-137">Affinity Group vNet - Older Virtual Networks were tied tooaffinity groups instead of regions, and cloud services in these Virtual Networks would be pinned toohello affinity group cluster.</span></span> <span data-ttu-id="b1fed-138">Sieć wirtualna wdrożeń toothis typu będą podejmowane w klastrze hello przypięty.</span><span class="sxs-lookup"><span data-stu-id="b1fed-138">Deployments toothis type of virtual network will be attempted on hello pinned cluster.</span></span> <span data-ttu-id="b1fed-139">Jeśli klaster hello zbliża się do pojemności, Żądanie hello może zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="b1fed-139">If hello cluster is nearing capacity, hello request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="b1fed-140">Rozwiązania</span><span class="sxs-lookup"><span data-stu-id="b1fed-140">Solutions</span></span>
1. <span data-ttu-id="b1fed-141">Ponownego wdrażania tooa nową usługę w chmurze — to rozwiązanie jest prawdopodobnie toobe najbardziej popularnych umożliwia toochoose platformy hello ze wszystkich klastrów w tym regionie.</span><span class="sxs-lookup"><span data-stu-id="b1fed-141">Redeploy tooa new cloud service - This solution is likely toobe most successful as it allows hello platform toochoose from all clusters in that region.</span></span>

   * <span data-ttu-id="b1fed-142">Wdrażanie hello obciążenia tooa nową usługę w chmurze</span><span class="sxs-lookup"><span data-stu-id="b1fed-142">Deploy hello workload tooa new cloud service</span></span>  
   * <span data-ttu-id="b1fed-143">Zaktualizuj hello CNAME i A rekordów toopoint ruchu toohello nową usługę w chmurze</span><span class="sxs-lookup"><span data-stu-id="b1fed-143">Update hello CNAME or A record toopoint traffic toohello new cloud service</span></span>
   * <span data-ttu-id="b1fed-144">Po zero ruch będzie toohello starej lokacji, możesz usunąć hello starego usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="b1fed-144">Once zero traffic is going toohello old site, you can delete hello old cloud service.</span></span> <span data-ttu-id="b1fed-145">To rozwiązanie powinno spowodować przestojów.</span><span class="sxs-lookup"><span data-stu-id="b1fed-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="b1fed-146">Usuń zarówno produkcyjne i przejściowe miejsc — to rozwiązanie zachowa istniejącą nazwę DNS, ale zostanie utworzona aplikacja tooyour przestoju.</span><span class="sxs-lookup"><span data-stu-id="b1fed-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime tooyour application.</span></span>

   * <span data-ttu-id="b1fed-147">Usuń hello produkcyjne i przejściowe miejsc istniejącą usługę w chmurze, dzięki czemu usługa w chmurze hello jest pusty, a następnie</span><span class="sxs-lookup"><span data-stu-id="b1fed-147">Delete hello production and staging slots of an existing cloud service so that hello cloud service is empty, and then</span></span>
   * <span data-ttu-id="b1fed-148">Utwórz nowe wdrożenie hello istniejących w usłudze w chmurze.</span><span class="sxs-lookup"><span data-stu-id="b1fed-148">Create a new deployment in hello existing cloud service.</span></span> <span data-ttu-id="b1fed-149">Spowoduje to ponowne podjęcie próby tooallocation na wszystkich klastrach w regionie hello.</span><span class="sxs-lookup"><span data-stu-id="b1fed-149">This will re-attempt tooallocation on all clusters in hello region.</span></span> <span data-ttu-id="b1fed-150">Upewnij się, że usługa w chmurze hello nie jest związany tooan grupy koligacji.</span><span class="sxs-lookup"><span data-stu-id="b1fed-150">Ensure hello cloud service is not tied tooan affinity group.</span></span>
3. <span data-ttu-id="b1fed-151">Zastrzeżony adres IP — to rozwiązanie zachowa IP istniejącego rozwiązania, ale zostanie utworzona aplikacja tooyour przestoju.</span><span class="sxs-lookup"><span data-stu-id="b1fed-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime tooyour application.</span></span>  

   * <span data-ttu-id="b1fed-152">Tworzenie zastrzeżonego adresu IP istniejącego wdrożenia przy użyciu programu Powershell</span><span class="sxs-lookup"><span data-stu-id="b1fed-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="b1fed-153">Wykonaj #2 powyższego, co się toospecify hello nowy zastrzeżony adres IP w CSCFG hello usługi.</span><span class="sxs-lookup"><span data-stu-id="b1fed-153">Follow #2 from above, making sure toospecify hello new ReservedIP in hello service's CSCFG.</span></span>
4. <span data-ttu-id="b1fed-154">Usuń grupę koligacji dla nowych wdrożeń - grup koligacji nie są zalecane.</span><span class="sxs-lookup"><span data-stu-id="b1fed-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="b1fed-155">Wykonaj kroki &#1; powyżej toodeploy nową usługę w chmurze.</span><span class="sxs-lookup"><span data-stu-id="b1fed-155">Follow steps for #1 above toodeploy a new cloud service.</span></span> <span data-ttu-id="b1fed-156">Upewnij się, usługa w chmurze nie jest w grupie koligacji.</span><span class="sxs-lookup"><span data-stu-id="b1fed-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="b1fed-157">Konwertuj tooa regionalną sieć wirtualną — zobacz [jak toomigrate z grup koligacji tooa regionalną sieć wirtualną (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="b1fed-157">Convert tooa Regional Virtual Network - See [How toomigrate from Affinity Groups tooa Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
