---
title: "Przewodnik programowania dotyczący usługi Azure Event Hubs | Microsoft Docs"
description: "Pisanie kodu dla usługi Azure Event Hubs przy użyciu zestawu .NET SDK usługi Azure."
services: event-hubs
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 64cbfd3d-4a0e-4455-a90a-7f3d4f080323
ms.service: event-hubs
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 08/17/2017
ms.author: sethm
ms.openlocfilehash: 405ec2b27b488b570c4a5c86e4950ff98233360e
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/18/2017
---
# <a name="event-hubs-programming-guide"></a><span data-ttu-id="3cc6f-103">Przewodnik programowania w usłudze Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3cc6f-103">Event Hubs programming guide</span></span>

<span data-ttu-id="3cc6f-104">W tym artykule opisano kilka typowych scenariuszy w pisanie kodu przy użyciu usługi Azure Event Hubs i zestawu Azure .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-104">This article discusses some common scenarios in writing code using Azure Event Hubs and the Azure .NET SDK.</span></span> <span data-ttu-id="3cc6f-105">Przyjęto założenie, że wstępnie znasz i rozumiesz usługę Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-105">It assumes a preliminary understanding of Event Hubs.</span></span> <span data-ttu-id="3cc6f-106">Omówienie koncepcji usługi Event Hubs można znaleźć w temacie [Przegląd usługi Event Hubs](event-hubs-what-is-event-hubs.md).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-106">For a conceptual overview of Event Hubs, see the [Event Hubs overview](event-hubs-what-is-event-hubs.md).</span></span>

## <a name="event-publishers"></a><span data-ttu-id="3cc6f-107">Wydawcy zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-107">Event publishers</span></span>

<span data-ttu-id="3cc6f-108">Zdarzenia są wysyłane do Centrum zdarzeń za pomocą metody POST protokołu HTTP lub przy użyciu połączenia protokołu AMQP 1.0.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-108">You send events to an event hub either using HTTP POST or via an AMQP 1.0 connection.</span></span> <span data-ttu-id="3cc6f-109">Wybór, który ma zostać użyty, gdy zależy od konkretnego scenariusza.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-109">The choice of which to use and when depends on the specific scenario being addressed.</span></span> <span data-ttu-id="3cc6f-110">Połączenia protokołu AMQP 1.0 są mierzone jako połączenia obsługiwane przez brokera w Service Bus i są bardziej odpowiednie w scenariuszach z częstymi większymi ilościami wiadomości oraz wymaganiami dotyczącymi krótszych opóźnień, ponieważ zapewniają trwały kanał obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-110">AMQP 1.0 connections are metered as brokered connections in Service Bus and are more appropriate in scenarios with frequent higher message volumes and lower latency requirements, as they provide a persistent messaging channel.</span></span>

<span data-ttu-id="3cc6f-111">Centra Event Hubs są tworzone i zarządzane przy użyciu klasy [NamespaceManager][].</span><span class="sxs-lookup"><span data-stu-id="3cc6f-111">You create and manage Event Hubs using the [NamespaceManager][] class.</span></span> <span data-ttu-id="3cc6f-112">W przypadku używania zarządzanych interfejsów API platformy .NET głównymi konstrukcjami na potrzeby publikowania danych w usłudze Event Hubs są klasy [EventHubClient](/dotnet/api/microsoft.servicebus.messaging.eventhubclient) i [EventData][].</span><span class="sxs-lookup"><span data-stu-id="3cc6f-112">When using the .NET managed APIs, the primary constructs for publishing data to Event Hubs are the [EventHubClient](/dotnet/api/microsoft.servicebus.messaging.eventhubclient) and [EventData][] classes.</span></span> <span data-ttu-id="3cc6f-113">[EventHubClient][] udostępnia kanał komunikacji protokołu AMQP, przez który zdarzenia są wysyłane do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-113">[EventHubClient][] provides the AMQP communication channel over which events are sent to the event hub.</span></span> <span data-ttu-id="3cc6f-114">[EventData][] klasy reprezentuje zdarzenie i jest używana do publikowania komunikatów do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-114">The [EventData][] class represents an event, and is used to publish messages to an event hub.</span></span> <span data-ttu-id="3cc6f-115">Ta klasa zawiera treść, niektóre metadane i informacje nagłówka zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-115">This class includes the body, some metadata, and header information about the event.</span></span> <span data-ttu-id="3cc6f-116">Inne właściwości są dodawane do [EventData][] obiektów, kiedy przechodzi on przez Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-116">Other properties are added to the [EventData][] object as it passes through an event hub.</span></span>

## <a name="get-started"></a><span data-ttu-id="3cc6f-117">Rozpoczęcie pracy</span><span class="sxs-lookup"><span data-stu-id="3cc6f-117">Get started</span></span>

<span data-ttu-id="3cc6f-118">Klasy platformy .NET, które obsługują usługę Event Hubs, są udostępniane w zestawie Microsoft.ServiceBus.dll.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-118">The .NET classes that support Event Hubs are provided in the Microsoft.ServiceBus.dll assembly.</span></span> <span data-ttu-id="3cc6f-119">Najprostszym sposobem odwołania do interfejsu API usługi Service Bus i skonfigurowania aplikacji ze wszystkimi zależnościami usługi Service Bus jest pobranie [pakietu NuGet usługi Service Bus](https://www.nuget.org/packages/WindowsAzure.ServiceBus).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-119">The easiest way to reference the Service Bus API and to configure your application with all of the Service Bus dependencies is to download the [Service Bus NuGet package](https://www.nuget.org/packages/WindowsAzure.ServiceBus).</span></span> <span data-ttu-id="3cc6f-120">Alternatywnie można użyć [konsoli menedżera pakietów](http://docs.nuget.org/docs/start-here/using-the-package-manager-console) w programie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-120">Alternatively, you can use the [Package Manager Console](http://docs.nuget.org/docs/start-here/using-the-package-manager-console) in Visual Studio.</span></span> <span data-ttu-id="3cc6f-121">Aby to zrobić, należy wydać następujące polecenie w oknie [konsoli menedżera pakietów](http://docs.nuget.org/docs/start-here/using-the-package-manager-console):</span><span class="sxs-lookup"><span data-stu-id="3cc6f-121">To do so, issue the following command in the [Package Manager Console](http://docs.nuget.org/docs/start-here/using-the-package-manager-console) window:</span></span>

```
Install-Package WindowsAzure.ServiceBus
```

## <a name="create-an-event-hub"></a><span data-ttu-id="3cc6f-122">Tworzenie centrum zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-122">Create an event hub</span></span>
<span data-ttu-id="3cc6f-123">Do tworzenia usług Event Hubs służy klasa [NamespaceManager][].</span><span class="sxs-lookup"><span data-stu-id="3cc6f-123">You can use the [NamespaceManager][] class to create Event Hubs.</span></span> <span data-ttu-id="3cc6f-124">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-124">For example:</span></span>

```csharp
var manager = new Microsoft.ServiceBus.NamespaceManager("mynamespace.servicebus.windows.net");
var description = manager.CreateEventHub("MyEventHub");
```

<span data-ttu-id="3cc6f-125">W większości przypadków zaleca się użycie metody [CreateEventHubIfNotExists][], aby uniknąć generowania wyjątków, jeśli usługa jest uruchamiana ponownie.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-125">In most cases, it is recommended that you use the [CreateEventHubIfNotExists][] methods to avoid generating exceptions if the service restarts.</span></span> <span data-ttu-id="3cc6f-126">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-126">For example:</span></span>

```csharp
var description = manager.CreateEventHubIfNotExists("MyEventHub");
```

<span data-ttu-id="3cc6f-127">Wszystkie operacje tworzenia usług Event Hubs, w tym metoda [CreateEventHubIfNotExists][], wymagają uprawnień **Zarządzania** do danej przestrzeni nazw.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-127">All Event Hubs creation operations, including [CreateEventHubIfNotExists][], require **Manage** permissions on the namespace in question.</span></span> <span data-ttu-id="3cc6f-128">Jeśli chcesz ograniczyć uprawnienia aplikacji wydawcy lub odbiorcy, możesz uniknąć wywołań tych operacji Create w kodzie produkcyjnym, korzystając z poświadczeń z ograniczonymi uprawnieniami.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-128">If you want to limit the permissions of your publisher or consumer applications, you can avoid these create operation calls in production code when you use credentials with limited permissions.</span></span>

<span data-ttu-id="3cc6f-129">[EventHubDescription](/dotnet/api/microsoft.servicebus.messaging.eventhubdescription) klasa zawiera szczegółowe informacje o Centrum zdarzeń, w tym reguły autoryzacji, interwał przechowywania komunikatów, identyfikatory partycji, stan i ścieżkę.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-129">The [EventHubDescription](/dotnet/api/microsoft.servicebus.messaging.eventhubdescription) class contains details about an event hub, including the authorization rules, the message retention interval, partition IDs, status, and path.</span></span> <span data-ttu-id="3cc6f-130">Ta klasa służy do aktualizacji metadanych w Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-130">You can use this class to update the metadata on an event hub.</span></span>

## <a name="create-an-event-hubs-client"></a><span data-ttu-id="3cc6f-131">Tworzenie klienta usługi Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3cc6f-131">Create an Event Hubs client</span></span>
<span data-ttu-id="3cc6f-132">Podstawowe klasy do interakcji z usługą Event Hubs jest [Microsoft.ServiceBus.Messaging.EventHubClient][EventHubClient].</span><span class="sxs-lookup"><span data-stu-id="3cc6f-132">The primary class for interacting with Event Hubs is [Microsoft.ServiceBus.Messaging.EventHubClient][EventHubClient].</span></span> <span data-ttu-id="3cc6f-133">Ta klasa udostępnia zarówno funkcje nadawcy, jak i odbiornika.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-133">This class provides both sender and receiver capabilities.</span></span> <span data-ttu-id="3cc6f-134">Można utworzyć wystąpienie tej klasy przy użyciu metody [Create](/dotnet/api/microsoft.servicebus.messaging.eventhubclient.create), jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-134">You can instantiate this class using the [Create](/dotnet/api/microsoft.servicebus.messaging.eventhubclient.create) method, as shown in the following example.</span></span>

```csharp
var client = EventHubClient.Create(description.Path);
```

<span data-ttu-id="3cc6f-135">Metoda ta wykorzystuje informacje o połączeniu usługi Service Bus w pliku App.config, w sekcji `appSettings`.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-135">This method uses the Service Bus connection information in the App.config file, in the `appSettings` section.</span></span> <span data-ttu-id="3cc6f-136">Przykładowy kod XML sekcji `appSettings` używany do przechowywania informacji o połączeniu usługi Service Bus można znaleźć w  dokumentacji metody [Microsoft.ServiceBus.Messaging.EventHubClient.Create(System.String)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Create_System_String_).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-136">For an example of the `appSettings` XML used to store the Service Bus connection information, see the documentation for the [Microsoft.ServiceBus.Messaging.EventHubClient.Create(System.String)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Create_System_String_) method.</span></span>

<span data-ttu-id="3cc6f-137">Innym rozwiązaniem jest utworzenie klienta na podstawie parametrów połączenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-137">Another option is to create the client from a connection string.</span></span> <span data-ttu-id="3cc6f-138">Ta opcja dobrze działa w przypadku używania ról procesów roboczych platformy Azure, ponieważ ciąg parametrów można przechowywać we właściwości konfiguracji dla procesu roboczego.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-138">This option works well when using Azure worker roles, because you can store the string in the configuration properties for the worker.</span></span> <span data-ttu-id="3cc6f-139">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-139">For example:</span></span>

```csharp
EventHubClient.CreateFromConnectionString("your_connection_string");
```

<span data-ttu-id="3cc6f-140">Parametry połączenia będą w tym samym formacie, w jakim są wyświetlane w pliku App.config dla wcześniejszych metod:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-140">The connection string will be in the same format as it appears in the App.config file for the previous methods:</span></span>

```
Endpoint=sb://[namespace].servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=[key]
```

<span data-ttu-id="3cc6f-141">Na koniec istnieje również możliwość utworzenia obiektu [EventHubClient][] z wystąpienia klasy [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory), jak pokazano w poniższym przykładzie.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-141">Finally, it is also possible to create an [EventHubClient][] object from a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance, as shown in the following example.</span></span>

```csharp
var factory = MessagingFactory.CreateFromConnectionString("your_connection_string");
var client = factory.CreateEventHubClient("MyEventHub");
```

<span data-ttu-id="3cc6f-142">Należy pamiętać, że dodatkowe obiekty [EventHubClient][] utworzone za pomocą wystąpienia fabryki obsługi komunikatów będą ponownie używały tego samego podstawowego połączenia TCP.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-142">It is important to note that additional [EventHubClient][] objects created from a messaging factory instance will reuse the same underlying TCP connection.</span></span> <span data-ttu-id="3cc6f-143">Z tego względu te obiekty mają limit przepływności po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-143">Therefore, these objects have a client-side limit on throughput.</span></span> <span data-ttu-id="3cc6f-144">Metoda [Create](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Create_System_String_) ponownie używa pojedynczej fabryki obsługi wiadomości.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-144">The [Create](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Create_System_String_) method reuses a single messaging factory.</span></span> <span data-ttu-id="3cc6f-145">Jeśli potrzebujesz bardzo wysokiej przepływności od jednego nadawcy, możesz utworzyć wiele fabryk komunikatów i jeden obiekt [EventHubClient][] z każdej fabryki obsługi komunikatów.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-145">If you need very high throughput from a single sender, then you can create multiple message factories and one [EventHubClient][] object from each messaging factory.</span></span>

## <a name="send-events-to-an-event-hub"></a><span data-ttu-id="3cc6f-146">Wysyłanie zdarzeń do Centrum zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-146">Send events to an event hub</span></span>
<span data-ttu-id="3cc6f-147">Wysyłanie zdarzeń do Centrum zdarzeń przez utworzenie [EventData][] wystąpienia i wysłanie go za pomocą [wysyłania](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) metody.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-147">You send events to an event hub by creating an [EventData][] instance and sending it via the [Send](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) method.</span></span> <span data-ttu-id="3cc6f-148">Ta metoda przyjmuje jeden [EventData][] parametru wystąpienia i synchronicznie wysyła go do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-148">This method takes a single [EventData][] instance parameter and synchronously sends it to an event hub.</span></span>

## <a name="event-serialization"></a><span data-ttu-id="3cc6f-149">Serializacja zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-149">Event serialization</span></span>
<span data-ttu-id="3cc6f-150">Klasa [EventData][] ma [cztery przeciążone konstruktory](/dotnet/api/microsoft.servicebus.messaging.eventdata#constructors_), które wymagają różnych parametrów, takich jak obiekt i serializator, tablica bajtów lub strumień.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-150">The [EventData][] class has [four overloaded constructors](/dotnet/api/microsoft.servicebus.messaging.eventdata#constructors_) that take a variety of parameters, such as an object and serializer, a byte array, or a stream.</span></span> <span data-ttu-id="3cc6f-151">Istnieje również możliwość utworzenia wystąpienia klasy [EventData][], a następnie ustawienia strumienia treści.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-151">It is also possible to instantiate the [EventData][] class and set the body stream afterwards.</span></span> <span data-ttu-id="3cc6f-152">W przypadku używania formatu JSON z klasą [EventData][] można użyć funkcji **Encoding.UTF8.GetBytes()** do pobrania tablicy bajtowej dla ciągu zakodowanego w formacie JSON.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-152">When using JSON with [EventData][], you can use **Encoding.UTF8.GetBytes()** to retrieve the byte array for a JSON-encoded string.</span></span>

## <a name="partition-key"></a><span data-ttu-id="3cc6f-153">Klucz partycji</span><span class="sxs-lookup"><span data-stu-id="3cc6f-153">Partition key</span></span>
<span data-ttu-id="3cc6f-154">Klasa [EventData][] ma właściwość [PartitionKey][] umożliwiającą nadawcy określenie wartości, dla której obliczana jest wartość skrótu w celu utworzenia przypisania partycji.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-154">The [EventData][] class has a [PartitionKey][] property that enables the sender to specify a value that is hashed to produce a partition assignment.</span></span> <span data-ttu-id="3cc6f-155">Użycie klucza partycji gwarantuje, że wszystkie zdarzenia z tym samym kluczem są wysyłane do tej samej partycji w zdarzeniu koncentratora.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-155">Using a partition key ensures that all the events with the same key are sent to the same partition in the event hub.</span></span> <span data-ttu-id="3cc6f-156">Wspólne klucze partycji zawierają identyfikatory sesji użytkownika i unikatowe identyfikatory nadawcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-156">Common partition keys include user session IDs and unique sender IDs.</span></span> <span data-ttu-id="3cc6f-157">Właściwość [PartitionKey][] jest opcjonalna i może zostać podana w przypadku użycia metody [Microsoft.ServiceBus.Messaging.EventHubClient.Send(Microsoft.ServiceBus.Messaging.EventData)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) lub [Microsoft.ServiceBus.Messaging.EventHubClient.SendAsync(Microsoft.ServiceBus.Messaging.EventData)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendAsync_Microsoft_ServiceBus_Messaging_EventData_).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-157">The [PartitionKey][] property is optional and can be provided when using the [Microsoft.ServiceBus.Messaging.EventHubClient.Send(Microsoft.ServiceBus.Messaging.EventData)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) or [Microsoft.ServiceBus.Messaging.EventHubClient.SendAsync(Microsoft.ServiceBus.Messaging.EventData)](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendAsync_Microsoft_ServiceBus_Messaging_EventData_) methods.</span></span> <span data-ttu-id="3cc6f-158">Jeśli nie podano wartości dla właściwości [PartitionKey][], wysyłane zdarzenia są dystrybuowane na partycje przy użyciu modelu działania okrężnego.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-158">If you do not provide a value for [PartitionKey][], sent events are distributed to partitions using a round-robin model.</span></span>

### <a name="availability-considerations"></a><span data-ttu-id="3cc6f-159">Zagadnienia dotyczące dostępności</span><span class="sxs-lookup"><span data-stu-id="3cc6f-159">Availability considerations</span></span>

<span data-ttu-id="3cc6f-160">Użycie klucza partycji jest opcjonalne, a użytkownik powinien zastanów się, czy należy użyć jednej.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-160">Using a partition key is optional, and you should consider carefully whether or not to use one.</span></span> <span data-ttu-id="3cc6f-161">W wielu przypadkach przy użyciu klucza partycji jest dobrym rozwiązaniem, jeśli zdarzenie kolejność jest ważna.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-161">In many cases, using a partition key is a good choice if event ordering is important.</span></span> <span data-ttu-id="3cc6f-162">Użycie klucza partycji, partycje wymagają dostępności w jednym węźle, a awarii wraz z upływem czasu; na przykład podczas obliczania ponownego uruchomienia węzłów i poprawki.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-162">When you use a partition key, these partitions require availability on a single node, and outages can occur over time; for example, when compute nodes reboot and patch.</span></span> <span data-ttu-id="3cc6f-163">W efekcie ustawiony identyfikator partycji i tej partycji przestanie być dostępny dla jakiegoś powodu, próba dostępu do danych w tej partycji zakończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-163">As such, if you set a partition ID and that partition becomes unavailable for some reason, an attempt to access the data in that partition will fail.</span></span> <span data-ttu-id="3cc6f-164">Jeśli najważniejszych jest wysoka dostępność, nie należy określać klucz partycji. w takim przypadku zdarzenia zostaną wysłane na partycje przy użyciu modelu okrężnego opisanych powyżej.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-164">If high availability is most important, do not specify a partition key; in that case events will be sent to partitions using the round-robin model described previously.</span></span> <span data-ttu-id="3cc6f-165">W tym scenariuszu utworzysz jawną wyboru między dostępności (Brak Identyfikatora partycji) i spójności (przypinanie zdarzenia do Identyfikatora partycji).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-165">In this scenario, you are making an explicit choice between availability (no partition ID) and consistency (pinning events to a partition ID).</span></span>

<span data-ttu-id="3cc6f-166">Kolejnym zagadnieniem jest obsługa opóźnienia w przetwarzaniu zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-166">Another consideration is handling delays in processing events.</span></span> <span data-ttu-id="3cc6f-167">W niektórych przypadkach może być lepszym rozwiązaniem danych i ponów próbę, niż można spróbować i nadąża z przetwarzaniem, który może powodować opóźnienia dalszego przetwarzania podrzędnego.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-167">In some cases it might be better to drop data and retry than to try and keep up with processing, which can potentially cause further downstream processing delays.</span></span> <span data-ttu-id="3cc6f-168">Na przykład z giełdowych lepiej jest oczekiwania pełną aktualne dane, ale w czatu na żywo lub scenariusza VOIP raczej trzeba danych szybko, nawet jeśli nie jest ukończone.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-168">For example, with a stock ticker it's better to wait for complete up-to-date data, but in a live chat or VOIP scenario you'd rather have the data quickly, even if it isn't complete.</span></span>

<span data-ttu-id="3cc6f-169">Podany w tych scenariuszach te zagadnienia dotyczące dostępności, możesz wybrać jedną z powodu następującego błędu strategii obsługi:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-169">Given these availability considerations, in these scenarios you might choose one of the following error handling strategies:</span></span>

- <span data-ttu-id="3cc6f-170">Stop (Zatrzymaj odczytywania z usługi Event Hubs, dopóki elementy zostały usunięte)</span><span class="sxs-lookup"><span data-stu-id="3cc6f-170">Stop (stop reading from Event Hubs until things are fixed)</span></span>
- <span data-ttu-id="3cc6f-171">Upuść (komunikaty nie są ważne, upuść je)</span><span class="sxs-lookup"><span data-stu-id="3cc6f-171">Drop (messages aren’t important, drop them)</span></span>
- <span data-ttu-id="3cc6f-172">Spróbuj ponownie (ponownych prób, które komunikaty, jak widać umieścić)</span><span class="sxs-lookup"><span data-stu-id="3cc6f-172">Retry (retry the messages as you see fit)</span></span>
- <span data-ttu-id="3cc6f-173">[Utraconych](../service-bus-messaging/service-bus-dead-letter-queues.md) (Użyj kolejki lub innego Centrum zdarzeń, aby wiadomości utraconych tylko komunikatów nie może przetworzyć)</span><span class="sxs-lookup"><span data-stu-id="3cc6f-173">[Dead letter](../service-bus-messaging/service-bus-dead-letter-queues.md) (use a queue or another event hub to dead letter only the messages you couldn’t process)</span></span>

<span data-ttu-id="3cc6f-174">Aby uzyskać więcej informacji i omówienie kompromis między dostępności i spójności zobacz [dostępności i spójności w usłudze Event Hubs](event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-174">For more information and a discussion about the trade-offs between availability and consistency, see [Availability and consistency in Event Hubs](event-hubs-availability-and-consistency.md).</span></span> 

## <a name="batch-event-send-operations"></a><span data-ttu-id="3cc6f-175">Operacje wysyłania partii zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-175">Batch event send operations</span></span>
<span data-ttu-id="3cc6f-176">Wysyłanie zdarzeń w partiach może znacznie zwiększyć przepływność.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-176">Sending events in batches can dramatically increase throughput.</span></span> <span data-ttu-id="3cc6f-177">[SendBatch](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_EventData__) ma metodę **IEnumerable** parametr typu [EventData][] i wysyła całą partię jako operacją niepodzielną do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-177">The [SendBatch](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_EventData__) method takes an **IEnumerable** parameter of type [EventData][] and sends the entire batch as an atomic operation to the event hub.</span></span>

```csharp
public void SendBatch(IEnumerable<EventData> eventDataList);
```

<span data-ttu-id="3cc6f-178">Należy pamiętać, że pojedyncza partia nie może przekraczać limitu 256 KB dla zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-178">Note that a single batch must not exceed the 256 KB limit of an event.</span></span> <span data-ttu-id="3cc6f-179">Ponadto każdy komunikat w partii używa tej samej tożsamości wydawcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-179">Additionally, each message in the batch uses the same publisher identity.</span></span> <span data-ttu-id="3cc6f-180">Nadawca jest odpowiedzialny za upewnienie się, że partia nie przekracza maksymalnego rozmiaru zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-180">It is the responsibility of the sender to ensure that the batch does not exceed the maximum event size.</span></span> <span data-ttu-id="3cc6f-181">Jeśli go przekroczy, zostanie wygenerowany błąd metody **Send** klienta.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-181">If it does, a client **Send** error is generated.</span></span>

## <a name="send-asynchronously-and-send-at-scale"></a><span data-ttu-id="3cc6f-182">Wysyłanie asynchroniczne i wysyłanie na dużą skalę</span><span class="sxs-lookup"><span data-stu-id="3cc6f-182">Send asynchronously and send at scale</span></span>
<span data-ttu-id="3cc6f-183">Możesz również wysłać zdarzenia do Centrum zdarzeń asynchronicznie.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-183">You can also send events to an event hub asynchronously.</span></span> <span data-ttu-id="3cc6f-184">Wysyłanie asynchroniczne może zwiększyć szybkość, z jaką klient jest w stanie wysyłać zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-184">Sending asynchronously can increase the rate at which a client is able to send events.</span></span> <span data-ttu-id="3cc6f-185">Metody [Send](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) i [SendBatch](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_EventData__) są dostępne w wersjach asynchronicznych, które zwracają obiekt [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-185">Both the [Send](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_Send_Microsoft_ServiceBus_Messaging_EventData_) and [SendBatch](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_EventData__) methods are available in asynchronous versions that return a [Task](https://msdn.microsoft.com/library/system.threading.tasks.task.aspx) object.</span></span> <span data-ttu-id="3cc6f-186">Ta technika może zwiększyć przepływność, jednak może również spowodować, że klient będzie kontynuować wysyłanie zdarzeń nawet wtedy, gdy jest ograniczany przez usługę Event Hubs, co może skutkować błędami klienta lub utratą komunikatów, jeśli metoda nie została poprawnie zaimplementowana.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-186">While this technique can increase throughput, it can also cause the client to continue to send events even while it is being throttled by the Event Hubs service and can result in the client experiencing failures or lost messages if not properly implemented.</span></span> <span data-ttu-id="3cc6f-187">Dodatkowo można użyć właściwości [RetryPolicy](/dotnet/api/microsoft.servicebus.messaging.cliententity#Microsoft_ServiceBus_Messaging_ClientEntity_RetryPolicy) na kliencie do sterowania opcjami ponawiania prób klienta.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-187">In addition, you can use the [RetryPolicy](/dotnet/api/microsoft.servicebus.messaging.cliententity#Microsoft_ServiceBus_Messaging_ClientEntity_RetryPolicy) property on the client to control client retry options.</span></span>

## <a name="create-a-partition-sender"></a><span data-ttu-id="3cc6f-188">Tworzenie nadawcy dla partycji</span><span class="sxs-lookup"><span data-stu-id="3cc6f-188">Create a partition sender</span></span>
<span data-ttu-id="3cc6f-189">Najbardziej typowe do wysyłania zdarzeń do Centrum zdarzeń bez klucza partycji, ale w niektórych przypadkach można wysyłać zdarzenia bezpośrednio do danej partycji.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-189">Although it is most common to send events to an event hub without a partition key, in some cases you might want to send events directly to a given partition.</span></span> <span data-ttu-id="3cc6f-190">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-190">For example:</span></span>

```csharp
var partitionedSender = client.CreatePartitionedSender(description.PartitionIds[0]);
```

<span data-ttu-id="3cc6f-191">[CreatePartitionedSender](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_CreatePartitionedSender_System_String_) zwraca [EventHubSender](/dotnet/api/microsoft.servicebus.messaging.eventhubsender) obiekt, czy można użyć do publikowania zdarzeń partycji Centrum konkretnego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-191">[CreatePartitionedSender](/dotnet/api/microsoft.servicebus.messaging.eventhubclient#Microsoft_ServiceBus_Messaging_EventHubClient_CreatePartitionedSender_System_String_) returns an [EventHubSender](/dotnet/api/microsoft.servicebus.messaging.eventhubsender) object that you can use to publish events to a specific event hub partition.</span></span>

## <a name="event-consumers"></a><span data-ttu-id="3cc6f-192">Odbiorcy zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-192">Event consumers</span></span>
<span data-ttu-id="3cc6f-193">Usługa Event Hubs ma dwa podstawowe modele użycia zdarzeń: odbiorniki bezpośrednie i abstrakcje wyższego poziomu, takie jak klasa [EventProcessorHost][].</span><span class="sxs-lookup"><span data-stu-id="3cc6f-193">Event Hubs has two primary models for event consumption: direct receivers and higher-level abstractions, such as [EventProcessorHost][].</span></span> <span data-ttu-id="3cc6f-194">Odbiorniki bezpośrednie są odpowiedzialne za własną koordynację dostępu do partycji w obrębie grupy odbiorców.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-194">Direct receivers are responsible for their own coordination of access to partitions within a consumer group.</span></span>

### <a name="direct-consumer"></a><span data-ttu-id="3cc6f-195">Bezpośredni odbiorca</span><span class="sxs-lookup"><span data-stu-id="3cc6f-195">Direct consumer</span></span>
<span data-ttu-id="3cc6f-196">Najbardziej bezpośrednim sposobem odczytu z partycji w obrębie grupy odbiorców jest użycie klasy [EventHubReceiver](/dotnet/apie/microsoft.servicebus.messaging.eventhubreceiver).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-196">The most direct way to read from a partition within a consumer group is to use the [EventHubReceiver](/dotnet/apie/microsoft.servicebus.messaging.eventhubreceiver) class.</span></span> <span data-ttu-id="3cc6f-197">Aby utworzyć wystąpienie tej klasy, należy użyć wystąpienia klasy [EventHubConsumerGroup](/dotnet/api/microsoft.servicebus.messaging.eventhubconsumergroup).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-197">To create an instance of this class, you must use an instance of the [EventHubConsumerGroup](/dotnet/api/microsoft.servicebus.messaging.eventhubconsumergroup) class.</span></span> <span data-ttu-id="3cc6f-198">W poniższym przykładzie należy określić identyfikator partycji podczas tworzenia odbiornika dla grupy odbiorców.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-198">In the following example, the partition ID must be specified when creating the receiver for the consumer group.</span></span>

```csharp
EventHubConsumerGroup group = client.GetDefaultConsumerGroup();
var receiver = group.CreateReceiver(client.GetRuntimeInformation().PartitionIds[0]);
```

<span data-ttu-id="3cc6f-199">Metoda [CreateReceiver](/dotnet/api/microsoft.servicebus.messaging.eventhubconsumergroup#methods_summary) ma kilka przeciążeń, które ułatwiają kontrolę nad tworzonym czytnikiem.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-199">The [CreateReceiver](/dotnet/api/microsoft.servicebus.messaging.eventhubconsumergroup#methods_summary) method has several overloads that facilitate control over the reader being created.</span></span> <span data-ttu-id="3cc6f-200">Te metody obejmują określanie przesunięcia jako ciągu lub sygnatury czasowej oraz możliwość określenia, czy uwzględniać to określone przesunięcie w zwróconym strumieniu, czy rozpocząć po nim.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-200">These methods include specifying an offset as either a string or timestamp, and the ability to specify whether to include this specified offset in the returned stream, or start after it.</span></span> <span data-ttu-id="3cc6f-201">Po utworzeniu odbiornika można uruchomić odbieranie zdarzeń na zwracanym obiekcie.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-201">After you create the receiver, you can start receiving events on the returned object.</span></span> <span data-ttu-id="3cc6f-202">Metoda [Receive](/dotnet/api/microsoft.servicebus.messaging.eventhubreceiver#methods_summary) ma cztery przeciążenia sterujące parametrami operacji odbierania, takimi jak rozmiar partii i czas oczekiwania.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-202">The [Receive](/dotnet/api/microsoft.servicebus.messaging.eventhubreceiver#methods_summary) method has four overloads that control the receive operation parameters, such as batch size and wait time.</span></span> <span data-ttu-id="3cc6f-203">Używając asynchronicznych wersji tych metod, można zwiększyć przepływność odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-203">You can use the asynchronous versions of these methods to increase the throughput of a consumer.</span></span> <span data-ttu-id="3cc6f-204">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-204">For example:</span></span>

```csharp
bool receive = true;
string myOffset;
while(receive)
{
    var message = receiver.Receive();
    myOffset = message.Offset;
    string body = Encoding.UTF8.GetString(message.GetBytes());
    Console.WriteLine(String.Format("Received message offset: {0} \nbody: {1}", myOffset, body));
}
```

<span data-ttu-id="3cc6f-205">W odniesieniu do określonej partycji komunikaty są odbierane w kolejności, w jakiej zostały wysłane do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-205">With respect to a specific partition, the messages are received in the order in which they were sent to the event hub.</span></span> <span data-ttu-id="3cc6f-206">Przesunięcie jest tokenem ciągu służącym do identyfikowania komunikatów w partycji.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-206">The offset is a string token used to identify a message in a partition.</span></span>

<span data-ttu-id="3cc6f-207">Należy zauważyć, że pojedyncza partycja w obrębie grupy odbiorców w żadnym momencie nie może mieć połączonych więcej niż 5 współbieżnych czytników.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-207">Note that a single partition within a consumer group cannot have more than 5 concurrent readers connected at any time.</span></span> <span data-ttu-id="3cc6f-208">Gdy czytniki nawiązują połączenie lub rozłączają się, ich sesje mogą pozostać aktywne przez kilka minut, zanim usługa rozpozna, że zostały odłączone.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-208">As readers connect or become disconnected, their sessions might stay active for several minutes before the service recognizes that they have disconnected.</span></span> <span data-ttu-id="3cc6f-209">W tym czasie ponowne połączenie się z partycją może zakończyć się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-209">During this time, reconnecting to a partition may fail.</span></span> <span data-ttu-id="3cc6f-210">Aby uzyskać kompletny przykład pisania aplikacji bezpośredniego odbiornika usługi Event hubs, zobacz [odbiorniki bezpośrednie centra zdarzeń](https://code.msdn.microsoft.com/Event-Hub-Direct-Receivers-13fa95c6) próbki.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-210">For a complete example of writing a direct receiver for Event Hubs, see the [Event Hubs Direct Receivers](https://code.msdn.microsoft.com/Event-Hub-Direct-Receivers-13fa95c6) sample.</span></span>

### <a name="event-processor-host"></a><span data-ttu-id="3cc6f-211">Host procesora zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-211">Event processor host</span></span>
<span data-ttu-id="3cc6f-212">Klasa [EventProcessorHost][] przetwarza dane z usługi Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-212">The [EventProcessorHost][] class processes data from Event Hubs.</span></span> <span data-ttu-id="3cc6f-213">Podczas tworzenia czytników zdarzeń na platformie .NET należy używać tej implementacji.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-213">You should use this implementation when building event readers on the .NET platform.</span></span> <span data-ttu-id="3cc6f-214">Klasa [EventProcessorHost][] udostępnia bezpieczne wątkowo, wieloprocesowe, bezpieczne środowisko uruchomieniowe dla implementacji procesora zdarzeń, które umożliwia także tworzenie punktów kontrolnych i zarządzanie dzierżawą partycji.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-214">[EventProcessorHost][] provides a thread-safe, multi-process, safe runtime environment for event processor implementations that also provides checkpointing and partition lease management.</span></span>

<span data-ttu-id="3cc6f-215">Aby używać klasy [EventProcessorHost][], można zaimplementować interfejs [IEventProcessor](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-215">To use the [EventProcessorHost][] class, you can implement [IEventProcessor](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor).</span></span> <span data-ttu-id="3cc6f-216">Ten interfejs zawiera trzy metody:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-216">This interface contains three methods:</span></span>

* [<span data-ttu-id="3cc6f-217">OpenAsync</span><span class="sxs-lookup"><span data-stu-id="3cc6f-217">OpenAsync</span></span>](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor#Microsoft_ServiceBus_Messaging_IEventProcessor_OpenAsync_Microsoft_ServiceBus_Messaging_PartitionContext_)
* [<span data-ttu-id="3cc6f-218">CloseAsync</span><span class="sxs-lookup"><span data-stu-id="3cc6f-218">CloseAsync</span></span>](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor#Microsoft_ServiceBus_Messaging_IEventProcessor_CloseAsync_Microsoft_ServiceBus_Messaging_PartitionContext_Microsoft_ServiceBus_Messaging_CloseReason_)
* [<span data-ttu-id="3cc6f-219">ProcessEventsAsync</span><span class="sxs-lookup"><span data-stu-id="3cc6f-219">ProcessEventsAsync</span></span>](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor#Microsoft_ServiceBus_Messaging_IEventProcessor_ProcessEventsAsync_Microsoft_ServiceBus_Messaging_PartitionContext_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_EventData__)

<span data-ttu-id="3cc6f-220">Aby rozpocząć przetwarzanie zdarzeń, Utwórz wystąpienie [EventProcessorHost][], podając odpowiednie parametry Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-220">To start event processing, instantiate [EventProcessorHost][], providing the appropriate parameters for your event hub.</span></span> <span data-ttu-id="3cc6f-221">Następnie wywołaj metodę [RegisterEventProcessorAsync](/dotnet/api/microsoft.servicebus.messaging.eventprocessorhost#Microsoft_ServiceBus_Messaging_EventProcessorHost_RegisterEventProcessorAsync__1), aby zarejestrować swoją implementację interfejsu [IEventProcessor](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor) w środowisku uruchomieniowym.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-221">Then, call [RegisterEventProcessorAsync](/dotnet/api/microsoft.servicebus.messaging.eventprocessorhost#Microsoft_ServiceBus_Messaging_EventProcessorHost_RegisterEventProcessorAsync__1) to register your [IEventProcessor](/dotnet/api/microsoft.servicebus.messaging.ieventprocessor) implementation with the runtime.</span></span> <span data-ttu-id="3cc6f-222">W tym momencie host będzie podejmować próby uzyskania dzierżawy na każdej partycji w Centrum zdarzeń za pomocą "zachłannego" algorytmu.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-222">At this point, the host will attempt to acquire a lease on every partition in the event hub using a "greedy" algorithm.</span></span> <span data-ttu-id="3cc6f-223">Te dzierżawy będą trwać przez dany przedział czasu, a następnie muszą być odnowione.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-223">These leases will last for a given timeframe and must then be renewed.</span></span> <span data-ttu-id="3cc6f-224">W miarę jak nowe węzły, w tym przypadku wystąpienia procesów roboczych, przechodzą w tryb online, umieszczają rezerwacje dzierżawy i z czasem obciążenie przesuwa się między węzłami, ponieważ każdy próbuje uzyskać więcej dzierżaw.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-224">As new nodes, worker instances in this case, come online, they place lease reservations and over time the load shifts between nodes as each attempts to acquire more leases.</span></span>

![Host procesora zdarzeń](./media/event-hubs-programming-guide/IC759863.png)

<span data-ttu-id="3cc6f-226">W miarę upływu czasu zostaje ustalona równowaga.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-226">Over time, an equilibrium is established.</span></span> <span data-ttu-id="3cc6f-227">Ta dynamiczna funkcja umożliwia zastosowanie skalowania automatycznego na podstawie procesora CPU do odbiorców, zarówno w celu skalowania w górę, jak i w dół.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-227">This dynamic capability enables CPU-based autoscaling to be applied to consumers for both scale-up and scale-down.</span></span> <span data-ttu-id="3cc6f-228">Ponieważ usługa Event Hubs nie obsługuje bezpośredniej koncepcji liczby komunikatów, średnie wykorzystanie procesora CPU jest często najlepszym mechanizmem mierzenia skali zaplecza lub odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-228">Because Event Hubs do not have a direct concept of message counts, average CPU utilization is often the best mechanism to measure back end or consumer scale.</span></span> <span data-ttu-id="3cc6f-229">Jeśli wydawcy zaczną publikować więcej zdarzeń, niż odbiorcy mogą przetworzyć, zwiększenie użycia procesora CPU przez odbiorców może służyć do powodowania automatycznego skalowania liczby wystąpień procesu roboczego.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-229">If publishers begin to publish more events than consumers can process, the CPU increase on consumers can be used to cause an auto-scale on worker instance count.</span></span>

<span data-ttu-id="3cc6f-230">Klasa [EventProcessorHost][] implementuje również mechanizm tworzenia punktów kontrolnych oparty na usłudze Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-230">The [EventProcessorHost][] class also implements an Azure storage-based checkpointing mechanism.</span></span> <span data-ttu-id="3cc6f-231">Ten mechanizm przechowuje przesunięcie na podstawie partycji, dzięki czemu każdy odbiorca może określić, jaki był ostatni punkt kontrolny od poprzedniego odbiorcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-231">This mechanism stores the offset on a per partition basis, so that each consumer can determine what the last checkpoint from the previous consumer was.</span></span> <span data-ttu-id="3cc6f-232">Ponieważ partycje przechodzą między węzłami za pośrednictwem dzierżaw, jest to mechanizm synchronizacji, który ułatwia przesunięcie obciążenia.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-232">As partitions transition between nodes via leases, this is the synchronization mechanism that facilitates load shifting.</span></span>

## <a name="publisher-revocation"></a><span data-ttu-id="3cc6f-233">Odwołanie wydawcy</span><span class="sxs-lookup"><span data-stu-id="3cc6f-233">Publisher revocation</span></span>
<span data-ttu-id="3cc6f-234">Oprócz zaawansowanych funkcji środowiska wykonawczego [EventProcessorHost][], usługa Event Hubs umożliwia odwołanie wydawcy w celu zablokowania dostępu określonych wydawców do wysyłania zdarzeń do Centrum zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-234">In addition to the advanced run-time features of [EventProcessorHost][], Event Hubs enables publisher revocation in order to block specific publishers from sending event to an event hub.</span></span> <span data-ttu-id="3cc6f-235">Te funkcje są szczególnie przydatne, jeśli zostały naruszone zabezpieczenia tokenu wydawcy lub aktualizacja oprogramowania powoduje nieuprawnione zachowanie wydawcy.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-235">These features are particularly useful if a publisher token has been compromised, or a software update is causing them to behave inappropriately.</span></span> <span data-ttu-id="3cc6f-236">W takich sytuacjach dla tożsamości wydawcy, która jest częścią jego tokenu sygnatury dostępu współdzielonego, można zablokować dostęp do publikowania zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="3cc6f-236">In these situations, the publisher's identity, which is part of their SAS token, can be blocked from publishing events.</span></span>

<span data-ttu-id="3cc6f-237">Aby uzyskać więcej informacji o odwołaniu wydawcy i sposobie wysyłania zdarzeń do usługi Event Hubs jako wydawca, zobacz przykład [Event Hubs Large Scale Secure Publishing](https://code.msdn.microsoft.com/Service-Bus-Event-Hub-99ce67ab) (Bezpieczne publikowanie na dużą skalę w usłudze Event Hubs).</span><span class="sxs-lookup"><span data-stu-id="3cc6f-237">For more information about publisher revocation and how to send to Event Hubs as a publisher, see the [Event Hubs Large Scale Secure Publishing](https://code.msdn.microsoft.com/Service-Bus-Event-Hub-99ce67ab) sample.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3cc6f-238">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="3cc6f-238">Next steps</span></span>
<span data-ttu-id="3cc6f-239">Aby dowiedzieć się więcej o scenariuszach usługi Event Hubs, skorzystaj z następujących linków:</span><span class="sxs-lookup"><span data-stu-id="3cc6f-239">To learn more about Event Hubs scenarios, visit these links:</span></span>

* [<span data-ttu-id="3cc6f-240">Omówienie interfejsu API usługi Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3cc6f-240">Event Hubs API overview</span></span>](event-hubs-api-overview.md)
* [<span data-ttu-id="3cc6f-241">Co to jest usługa Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3cc6f-241">What is Event Hubs</span></span>](event-hubs-what-is-event-hubs.md)
* <span data-ttu-id="3cc6f-242">[Availability and consistency in Event Hubs](event-hubs-availability-and-consistency.md) (Dostępność i spójność w usłudze Event Hubs)</span><span class="sxs-lookup"><span data-stu-id="3cc6f-242">[Availability and consistency in Event Hubs](event-hubs-availability-and-consistency.md)</span></span>
* [<span data-ttu-id="3cc6f-243">Dokumentacja interfejsu API hosta procesora zdarzeń</span><span class="sxs-lookup"><span data-stu-id="3cc6f-243">Event processor host API reference</span></span>](/dotnet/api/microsoft.servicebus.messaging.eventprocessorhost)

<span data-ttu-id="3cc6f-244">[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager</span><span class="sxs-lookup"><span data-stu-id="3cc6f-244">[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager</span></span>
<span data-ttu-id="3cc6f-245">[EventHubClient]: /dotnet/api/microsoft.servicebus.messaging.eventhubclient</span><span class="sxs-lookup"><span data-stu-id="3cc6f-245">[EventHubClient]: /dotnet/api/microsoft.servicebus.messaging.eventhubclient</span></span>
<span data-ttu-id="3cc6f-246">[EventData]: /dotnet/api/microsoft.servicebus.messaging.eventdata</span><span class="sxs-lookup"><span data-stu-id="3cc6f-246">[EventData]: /dotnet/api/microsoft.servicebus.messaging.eventdata</span></span>
<span data-ttu-id="3cc6f-247">[CreateEventHubIfNotExists]: /dotnet/api/microsoft.servicebus.namespacemanager.createeventhubifnotexists</span><span class="sxs-lookup"><span data-stu-id="3cc6f-247">[CreateEventHubIfNotExists]: /dotnet/api/microsoft.servicebus.namespacemanager.createeventhubifnotexists</span></span>
<span data-ttu-id="3cc6f-248">[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.eventdata#Microsoft_ServiceBus_Messaging_EventData_PartitionKey</span><span class="sxs-lookup"><span data-stu-id="3cc6f-248">[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.eventdata#Microsoft_ServiceBus_Messaging_EventData_PartitionKey</span></span>
<span data-ttu-id="3cc6f-249">[EventProcessorHost]: /dotnet/api/microsoft.servicebus.messaging.eventprocessorhost</span><span class="sxs-lookup"><span data-stu-id="3cc6f-249">[EventProcessorHost]: /dotnet/api/microsoft.servicebus.messaging.eventprocessorhost</span></span>
