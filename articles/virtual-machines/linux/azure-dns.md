---
title: Opcje rozpoznawania nazw DNS dla maszyn wirtualnych systemu Linux na platformie Azure
description: "Nazwa usługi DNS dla maszyn wirtualnych systemu Linux IaaS platformy Azure, w tym scenariuszy, pod warunkiem rozpoznawania, hybrydowego zewnętrznego serwera DNS i Przenieś swój własny DNS."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: cc06ee9305b4d3034154a0825c1aea53fe446f80
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="6b433-103">Opcje rozpoznawania nazw DNS dla maszyn wirtualnych systemu Linux na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="6b433-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="6b433-104">Platforma Azure udostępnia rozpoznawanie nazw DNS domyślnie dla wszystkich maszyn wirtualnych, które znajdują się w jednej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="6b433-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="6b433-105">Można zaimplementować własne rozwiązania rozpoznawania nazw DNS przez skonfigurowanie usługi DNS na maszynach wirtualnych obsługującego platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="6b433-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="6b433-106">Następujące scenariusze powinna ułatwić wybierz jedną, która działa w danej sytuacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-106">The following scenarios should help you choose the one that works for your situation.</span></span>

* [<span data-ttu-id="6b433-107">Rozpoznawanie nazw, która udostępnia usługi Azure</span><span class="sxs-lookup"><span data-stu-id="6b433-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="6b433-108">Rozpoznawanie nazw przy użyciu serwera DNS</span><span class="sxs-lookup"><span data-stu-id="6b433-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="6b433-109">Rodzaj rozpoznawania nazw, którego używasz, zależy od tego, jak sieci maszyn wirtualnych i wystąpień ról muszą komunikować się ze sobą.</span><span class="sxs-lookup"><span data-stu-id="6b433-109">The type of name resolution that you use depends on how your virtual machines and role instances need to communicate with each other.</span></span>

<span data-ttu-id="6b433-110">W poniższej tabeli przedstawiono scenariusze i odpowiedniego rozwiązania rozpoznawania nazwy:</span><span class="sxs-lookup"><span data-stu-id="6b433-110">The following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="6b433-111">**Scenariusz**</span><span class="sxs-lookup"><span data-stu-id="6b433-111">**Scenario**</span></span> | <span data-ttu-id="6b433-112">**Rozwiązania**</span><span class="sxs-lookup"><span data-stu-id="6b433-112">**Solution**</span></span> | <span data-ttu-id="6b433-113">**Sufiks**</span><span class="sxs-lookup"><span data-stu-id="6b433-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="6b433-114">Rozpoznawanie nazw między wystąpień roli lub maszyn wirtualnych w tej samej sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="6b433-114">Name resolution between role instances or virtual machines in the same virtual network</span></span> |[<span data-ttu-id="6b433-115">Rozpoznawanie nazw, która udostępnia usługi Azure</span><span class="sxs-lookup"><span data-stu-id="6b433-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="6b433-116">Nazwa hosta lub w pełni kwalifikowaną nazwę domeny (FQDN)</span><span class="sxs-lookup"><span data-stu-id="6b433-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="6b433-117">Rozpoznawanie nazw między wystąpień roli lub maszyn wirtualnych w różnych sieciach wirtualnych</span><span class="sxs-lookup"><span data-stu-id="6b433-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="6b433-118">Zarządzany przez klienta serwerów DNS, które przekazywania kwerend między sieciami wirtualnymi rozpoznanie przez platformę Azure (serwer proxy DNS).</span><span class="sxs-lookup"><span data-stu-id="6b433-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="6b433-119">Zobacz [rozpoznawanie nazw przy użyciu serwera DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="6b433-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="6b433-120">Tylko nazwa FQDN</span><span class="sxs-lookup"><span data-stu-id="6b433-120">FQDN only</span></span> |
| <span data-ttu-id="6b433-121">Rozpoznawanie nazwy usługi z wystąpień roli lub maszynach wirtualnych platformy Azure i komputerów lokalnych</span><span class="sxs-lookup"><span data-stu-id="6b433-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="6b433-122">Zarządzany przez klienta z serwerów DNS (na przykład lokalnego kontrolera domeny, kontrolera domeny tylko do odczytu lokalnej lub zsynchronizowane za pomocą transferów stref DNS dodatkowej).</span><span class="sxs-lookup"><span data-stu-id="6b433-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="6b433-123">Zobacz [rozpoznawanie nazw przy użyciu serwera DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="6b433-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="6b433-124">Tylko nazwa FQDN</span><span class="sxs-lookup"><span data-stu-id="6b433-124">FQDN only</span></span> |
| <span data-ttu-id="6b433-125">Rozpoznawanie nazwy Azure hostów z komputerów lokalnych</span><span class="sxs-lookup"><span data-stu-id="6b433-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="6b433-126">Przesłać zapytań do serwera proxy DNS zarządzany przez klienta w odpowiedniej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="6b433-126">Forward queries to a customer-managed DNS proxy server in the corresponding virtual network.</span></span> <span data-ttu-id="6b433-127">Serwer proxy przekazuje zapytania do platformy Azure do rozpoznania.</span><span class="sxs-lookup"><span data-stu-id="6b433-127">The proxy server forwards queries to Azure for resolution.</span></span> <span data-ttu-id="6b433-128">Zobacz [rozpoznawanie nazw przy użyciu serwera DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="6b433-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="6b433-129">Tylko nazwa FQDN</span><span class="sxs-lookup"><span data-stu-id="6b433-129">FQDN only</span></span> |
| <span data-ttu-id="6b433-130">Reverse DNS wewnętrznych adresów IP</span><span class="sxs-lookup"><span data-stu-id="6b433-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="6b433-131">Rozpoznawanie nazw przy użyciu serwera DNS</span><span class="sxs-lookup"><span data-stu-id="6b433-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="6b433-132">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="6b433-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="6b433-133">Rozpoznawanie nazw, która udostępnia usługi Azure</span><span class="sxs-lookup"><span data-stu-id="6b433-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="6b433-134">Wraz z rozpoznawanie publicznej nazwy DNS platforma Azure udostępnia rozpoznawania nazw wewnętrznych dla maszyn wirtualnych i wystąpień ról, które znajdują się w tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="6b433-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in the same virtual network.</span></span> <span data-ttu-id="6b433-135">W sieciach wirtualnych, które są oparte na usłudze Azure Resource Manager sufiks DNS jest spójne w ramach sieci wirtualnej; Nazwa FQDN nie jest wymagana.</span><span class="sxs-lookup"><span data-stu-id="6b433-135">In virtual networks that are based on Azure Resource Manager, the DNS suffix is consistent across the virtual network; the FQDN is not needed.</span></span> <span data-ttu-id="6b433-136">Można przypisać nazwy DNS dla maszyn wirtualnych i kart interfejsu sieciowego (NIC).</span><span class="sxs-lookup"><span data-stu-id="6b433-136">DNS names can be assigned to both network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="6b433-137">Mimo że platforma Azure udostępnia rozpoznawanie nazw nie wymaga żadnej konfiguracji, nie jest odpowiednim wyborem w przypadku wszystkich scenariuszy wdrożenia w powyższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="6b433-137">Although the name resolution that Azure provides does not require any configuration, it is not the appropriate choice for all deployment scenarios, as seen on the preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="6b433-138">Funkcje i zagadnienia</span><span class="sxs-lookup"><span data-stu-id="6b433-138">Features and considerations</span></span>
<span data-ttu-id="6b433-139">**Funkcje:**</span><span class="sxs-lookup"><span data-stu-id="6b433-139">**Features:**</span></span>

* <span data-ttu-id="6b433-140">Aby użyć rozpoznawania nazw, które platforma Azure udostępnia jest wymagana żadna konfiguracja.</span><span class="sxs-lookup"><span data-stu-id="6b433-140">No configuration is required to use name resolution that Azure provides.</span></span>
* <span data-ttu-id="6b433-141">Usługa rozpoznawania nazw, które platforma Azure udostępnia ma wysoką dostępność.</span><span class="sxs-lookup"><span data-stu-id="6b433-141">The name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="6b433-142">Nie potrzebujesz do tworzenia i zarządzania klastrami serwerów DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-142">You don't need to create and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="6b433-143">Usługi rozpoznawania nazw, która udostępnia usługi Azure może służyć wraz z serwerami DNS do rozpoznawania zarówno lokalnie, jak i nazwy hostów Azure.</span><span class="sxs-lookup"><span data-stu-id="6b433-143">The name resolution service that Azure provides can be used along with your own DNS servers to resolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="6b433-144">Rozpoznawanie nazw są udostępniane między maszynami wirtualnymi w sieci wirtualnych bez konieczności dla nazwy FQDN.</span><span class="sxs-lookup"><span data-stu-id="6b433-144">Name resolution is provided between virtual machines in virtual networks without need for the FQDN.</span></span>
* <span data-ttu-id="6b433-145">Można użyć nazwy hostów, które najlepiej opisują wdrożeń zamiast Praca z nazwami wygenerowany automatycznie.</span><span class="sxs-lookup"><span data-stu-id="6b433-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="6b433-146">**Kwestie do rozważenia:**</span><span class="sxs-lookup"><span data-stu-id="6b433-146">**Considerations:**</span></span>

* <span data-ttu-id="6b433-147">Nie można zmodyfikować sufiks DNS, który tworzy Azure.</span><span class="sxs-lookup"><span data-stu-id="6b433-147">The DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="6b433-148">Nie można ręcznie zarejestrować własnych.</span><span class="sxs-lookup"><span data-stu-id="6b433-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="6b433-149">Usługa WINS i NetBIOS są nieobsługiwane.</span><span class="sxs-lookup"><span data-stu-id="6b433-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="6b433-150">Nazwy hostów musi być zgodny z DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="6b433-151">Nazwy musi zawierać tylko 0-9, a-z, i "-", i ich nie może zaczynać się ani kończyć "-".</span><span class="sxs-lookup"><span data-stu-id="6b433-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="6b433-152">Zobacz dokument RFC 3696 sekcji 2.</span><span class="sxs-lookup"><span data-stu-id="6b433-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="6b433-153">Ruch zapytanie DNS jest ograniczenie dla każdej maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="6b433-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="6b433-154">Ograniczanie nie powinny mieć wpływ na większości aplikacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="6b433-155">Ograniczanie żądań zaobserwowano, upewnij się, że włączone jest buforowanie po stronie klienta.</span><span class="sxs-lookup"><span data-stu-id="6b433-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="6b433-156">Aby uzyskać więcej informacji, zobacz [wprowadzenie w pełni wykorzystać możliwości rozpoznawania nazw, które platforma Azure udostępnia](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="6b433-156">For more information, see [Getting the most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-the-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="6b433-157">Zapewnia pełne wykorzystanie rozpoznawania nazw z tym Azure</span><span class="sxs-lookup"><span data-stu-id="6b433-157">Getting the most from name resolution that Azure provides</span></span>
<span data-ttu-id="6b433-158">**Buforowanie po stronie klienta:**</span><span class="sxs-lookup"><span data-stu-id="6b433-158">**Client-side caching:**</span></span>

<span data-ttu-id="6b433-159">Niektóre zapytania DNS nie są wysyłane przez sieć.</span><span class="sxs-lookup"><span data-stu-id="6b433-159">Some DNS queries are not sent across the network.</span></span> <span data-ttu-id="6b433-160">Buforowanie po stronie klienta pomaga zmniejszenia opóźnienia i poprawy odporności na niespójności w sieci przez przetłumaczenie cyklicznego zapytania DNS z lokalnej pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="6b433-160">Client-side caching helps reduce latency and improve resilience to network inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="6b433-161">Rekordy DNS zawierają Time To Live (TTL), która włącza pamięć podręczną do przechowywania bez wpływania na rekordów świeżości rekordu tak długo, jak to możliwe.</span><span class="sxs-lookup"><span data-stu-id="6b433-161">DNS records contain a Time-To-Live (TTL), which enables the cache to store the record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="6b433-162">W związku z tym buforowanie po stronie klienta jest odpowiednia dla większości sytuacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="6b433-163">Niektóre dystrybucje systemu Linux nie dołączaj buforowanie domyślnie.</span><span class="sxs-lookup"><span data-stu-id="6b433-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="6b433-164">Firma Microsoft zaleca dodanie pamięci podręcznej do każdej maszyny wirtualnej systemu Linux po sprawdzeniu, że nie ma lokalnej pamięci podręcznej już.</span><span class="sxs-lookup"><span data-stu-id="6b433-164">We recommend that you add a cache to each Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="6b433-165">Dostępnych jest kilka różnych buforowanie pakiety, takie jak dnsmasq, DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="6b433-166">Poniżej przedstawiono kroki, aby zainstalować dnsmasq na najczęściej używane dystrybucje:</span><span class="sxs-lookup"><span data-stu-id="6b433-166">Here are the steps to install dnsmasq on the most common distributions:</span></span>

<span data-ttu-id="6b433-167">**Ubuntu (używa resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="6b433-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="6b433-168">Zainstaluj pakiet dnsmasq ("get stanie instalacji dnsmasq sudo").</span><span class="sxs-lookup"><span data-stu-id="6b433-168">Install the dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="6b433-169">**SUSE (używa netconf)**:</span><span class="sxs-lookup"><span data-stu-id="6b433-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="6b433-170">Zainstaluj pakiet dnsmasq ("sudo zypper instalacji dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="6b433-170">Install the dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="6b433-171">Włącz usługę dnsmasq ("Włącz dnsmasq.service systemctl").</span><span class="sxs-lookup"><span data-stu-id="6b433-171">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="6b433-172">Uruchom usługę dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="6b433-172">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="6b433-173">Edytuj "/ etc/sysconfig/sieci/konfiguracji" i zmień NETCONFIG_DNS_FORWARDER = "" do "dnsmasq".</span><span class="sxs-lookup"><span data-stu-id="6b433-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" to ”dnsmasq”.</span></span>
5. <span data-ttu-id="6b433-174">Zaktualizuj resolv.conf ("netconfig update") można ustawić pamięci podręcznej jako lokalnego rozpoznawania nazw DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-174">Update resolv.conf ("netconfig update") to set the cache as the local DNS resolver.</span></span>

<span data-ttu-id="6b433-175">**CentOS przez oprogramowanie Wave nieautoryzowanego (dawniej OpenLogic; używa NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="6b433-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="6b433-176">Zainstaluj pakiet dnsmasq ("sudo yum instalacji dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="6b433-176">Install the dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="6b433-177">Włącz usługę dnsmasq ("Włącz dnsmasq.service systemctl").</span><span class="sxs-lookup"><span data-stu-id="6b433-177">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="6b433-178">Uruchom usługę dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="6b433-178">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="6b433-179">Dodaj "dołączy domeny nazwy serwerów 127.0.0.1;" do "/etc/dhclient-eth0.conf".</span><span class="sxs-lookup"><span data-stu-id="6b433-179">Add “prepend domain-name-servers 127.0.0.1;” to “/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="6b433-180">Uruchom ponownie usługi sieciowej ("usługi sieciowej restart"), można ustawić pamięci podręcznej jako lokalnego rozpoznawania nazw DNS</span><span class="sxs-lookup"><span data-stu-id="6b433-180">Restart the network service (“service network restart”) to set the cache as the local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="6b433-181">: Pakiet "dnsmasq" jest tylko jeden z wielu pamięci podręcznych DNS, które są dostępne dla systemu Linux.</span><span class="sxs-lookup"><span data-stu-id="6b433-181">: The 'dnsmasq' package is only one of the many DNS caches that are available for Linux.</span></span> <span data-ttu-id="6b433-182">Przed użyciem go, sprawdź jego przydatności do potrzeb i zainstalowanym nie pamięci podręcznej.</span><span class="sxs-lookup"><span data-stu-id="6b433-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="6b433-183">**Ponownych prób po stronie klienta**</span><span class="sxs-lookup"><span data-stu-id="6b433-183">**Client-side retries**</span></span>

<span data-ttu-id="6b433-184">Usługa DNS jest głównie protokołu UDP.</span><span class="sxs-lookup"><span data-stu-id="6b433-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="6b433-185">Ponieważ protokół UDP nie gwarantuje dostarczanie komunikatów, samego protokołu DNS obsługuje logiki ponawiania próby.</span><span class="sxs-lookup"><span data-stu-id="6b433-185">Because the UDP protocol doesn't guarantee message delivery, the DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="6b433-186">Każdy klient DNS (systemu operacyjnego) może mieć Logika ponawiania różne w zależności od preferencji twórcy:</span><span class="sxs-lookup"><span data-stu-id="6b433-186">Each DNS client (operating system) can exhibit different retry logic depending on the creator's preference:</span></span>

* <span data-ttu-id="6b433-187">Systemy operacyjne Windows ponów próbę po jednej drugi, a następnie ponownie po drugim dwa, cztery i innego cztery sekundy.</span><span class="sxs-lookup"><span data-stu-id="6b433-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="6b433-188">Domyślne Linux Instalatora ponownych prób po 5 sekund.</span><span class="sxs-lookup"><span data-stu-id="6b433-188">The default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="6b433-189">Należy zmienić, aby ponowić próbę pięć razy na sekundę.</span><span class="sxs-lookup"><span data-stu-id="6b433-189">You should change this to retry five times at one-second intervals.</span></span>  

<span data-ttu-id="6b433-190">Aby sprawdzić bieżące ustawienia na maszynie wirtualnej systemu Linux, "/etc/resolv.conf cat" i znajduje się w wierszu "Opcje", na przykład:</span><span class="sxs-lookup"><span data-stu-id="6b433-190">To check the current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at the 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="6b433-191">Plik resolv.conf został wygenerowany automatycznie i nie można edytować.</span><span class="sxs-lookup"><span data-stu-id="6b433-191">The resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="6b433-192">Wykonania określonych kroków, które Dodaj wiersz "Opcje" różnią się dystrybucji:</span><span class="sxs-lookup"><span data-stu-id="6b433-192">The specific steps that add the 'options' line vary by distribution:</span></span>

<span data-ttu-id="6b433-193">**Ubuntu** (używa resolvconf)</span><span class="sxs-lookup"><span data-stu-id="6b433-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="6b433-194">Dodaj linię opcji "/ etc/resolveconf/resolv.conf.d/head".</span><span class="sxs-lookup"><span data-stu-id="6b433-194">Add the options line to '/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="6b433-195">Uruchom 'resolvconf -u' do aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-195">Run 'resolvconf -u' to update.</span></span>

<span data-ttu-id="6b433-196">**SUSE** (używa netconf)</span><span class="sxs-lookup"><span data-stu-id="6b433-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="6b433-197">Dodaj do NETCONFIG_DNS_RESOLVER_OPTIONS "timeout:1 prób: 5" = "" parametru w "/ etc/sysconfig/sieci/konfiguracji".</span><span class="sxs-lookup"><span data-stu-id="6b433-197">Add 'timeout:1 attempts:5' to the NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="6b433-198">Uruchom "netconfig update" do aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-198">Run 'netconfig update' to update.</span></span>

<span data-ttu-id="6b433-199">**CentOS przez nieautoryzowanego oprogramowania Wave (dawniej OpenLogic)** (używa NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="6b433-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="6b433-200">Dodaj "echo"Opcje timeout:1 prób: 5"" do "/ etc/NetworkManager/dispatcher.d/11-dhclient".</span><span class="sxs-lookup"><span data-stu-id="6b433-200">Add 'echo "options timeout:1 attempts:5"' to '/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="6b433-201">Uruchom "sieci po ponownym uruchomieniu usługi" do aktualizacji.</span><span class="sxs-lookup"><span data-stu-id="6b433-201">Run 'service network restart' to update.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="6b433-202">Rozpoznawanie nazw przy użyciu serwera DNS</span><span class="sxs-lookup"><span data-stu-id="6b433-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="6b433-203">Twoje potrzeby rozpoznawania nazw może wykracza poza platforma Azure udostępnia funkcje.</span><span class="sxs-lookup"><span data-stu-id="6b433-203">Your name resolution needs may go beyond the features that Azure provides.</span></span> <span data-ttu-id="6b433-204">Na przykład może wymagać rozpoznawania nazw DNS między sieciami wirtualnymi.</span><span class="sxs-lookup"><span data-stu-id="6b433-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="6b433-205">Aby pokrywał się w tym scenariuszu, używając serwery DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-205">To cover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="6b433-206">Serwery DNS w sieci wirtualnej można przekazywać zapytań DNS do rozpoznawania nazw cykliczne platformy Azure do rozpoznania nazwy hostów, które znajdują się w tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="6b433-206">DNS servers within a virtual network can forward DNS queries to recursive resolvers of Azure to resolve hostnames that are in the same virtual network.</span></span> <span data-ttu-id="6b433-207">Na przykład serwer DNS, który działa na platformie Azure można odpowiedzi na zapytania DNS dotyczące własne pliki strefy DNS i przesyła inne zapytania do usługi Azure.</span><span class="sxs-lookup"><span data-stu-id="6b433-207">For example, a DNS server that runs in Azure can respond to DNS queries for its own DNS zone files and forward all other queries to Azure.</span></span> <span data-ttu-id="6b433-208">Ta funkcja umożliwia maszyn wirtualnych, aby wyświetlić obie pozycje w plikach strefy i nazwy hostów, które platforma Azure udostępnia (za pośrednictwem usługi przesyłania dalej).</span><span class="sxs-lookup"><span data-stu-id="6b433-208">This functionality enables virtual machines to see both your entries in your zone files and hostnames that Azure provides (via the forwarder).</span></span> <span data-ttu-id="6b433-209">Dostęp do rozpoznawania nazw cykliczne Azure zostaną przekazane za pośrednictwem wirtualnego adresu IP 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="6b433-209">Access to the recursive resolvers of Azure is provided via the virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="6b433-210">Przesyłanie dalej DNS również umożliwia rozpoznawanie nazw DNS między sieciami wirtualnymi i umożliwia maszyny lokalnej do rozpoznania nazwy hostów, które platforma Azure udostępnia.</span><span class="sxs-lookup"><span data-stu-id="6b433-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines to resolve hostnames that Azure provides.</span></span> <span data-ttu-id="6b433-211">Można rozpoznać nazwy hosta maszyny wirtualnej, maszyna wirtualna serwera DNS musi znajdować się w tej samej sieci wirtualnej i umożliwiać zapytania do przodu nazwy hosta Azure.</span><span class="sxs-lookup"><span data-stu-id="6b433-211">To resolve a virtual machine's hostname, the DNS server virtual machine must reside in the same virtual network and be configured to forward hostname queries to Azure.</span></span> <span data-ttu-id="6b433-212">Sufiks DNS różni się w każdej sieci wirtualnej, można użyć zasady warunkowego przesyłania dalej do wysyłania zapytań DNS do odpowiedniej sieci wirtualnych do rozpoznania.</span><span class="sxs-lookup"><span data-stu-id="6b433-212">Because the DNS suffix is different in each virtual network, you can use conditional forwarding rules to send DNS queries to the correct virtual network for resolution.</span></span> <span data-ttu-id="6b433-213">Na poniższej ilustracji przedstawiono dwie sieci wirtualne i sieć lokalną podczas rozpoznawania nazw DNS między sieciami wirtualnymi za pomocą tej metody:</span><span class="sxs-lookup"><span data-stu-id="6b433-213">The following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![Rozpoznawanie nazw DNS między sieciami wirtualnymi](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="6b433-215">Gdy używasz rozpoznawania nazw, które platforma Azure udostępnia wewnętrzny sufiks DNS podano do każdej maszyny wirtualnej przy użyciu protokołu DHCP.</span><span class="sxs-lookup"><span data-stu-id="6b433-215">When you use name resolution that Azure provides, the internal DNS suffix is provided to each virtual machine by using DHCP.</span></span> <span data-ttu-id="6b433-216">Korzystając z własnych rozwiązań rozpoznawania nazwy, ponieważ sufiks koliduje z innych architektur DNS ten sufiks nie podano do maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="6b433-216">When you use your own name resolution solution, this suffix is not supplied to virtual machines because the suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="6b433-217">Aby odwołać się do maszyn za pomocą nazwy FQDN lub skonfigurować sufiks na maszynach wirtualnych, umożliwia programu PowerShell lub interfejsu API określić sufiks:</span><span class="sxs-lookup"><span data-stu-id="6b433-217">To refer to machines by FQDN or to configure the suffix on your virtual machines, you can use PowerShell or the API to determine the suffix:</span></span>

* <span data-ttu-id="6b433-218">Dla sieci wirtualnych, które są zarządzane przez Menedżera zasobów Azure, jest dostępny za pośrednictwem sufiks [karty interfejsu sieciowego](https://msdn.microsoft.com/library/azure/mt163668.aspx) zasobów.</span><span class="sxs-lookup"><span data-stu-id="6b433-218">For virtual networks that are managed by Azure Resource Manager, the suffix is available via the [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="6b433-219">Można również uruchomić `azure network public-ip show <resource group> <pip name>` polecenie, aby wyświetlić szczegóły dotyczące Twojego publicznego adresu IP, która zawiera nazwę FQDN karty sieciowej.</span><span class="sxs-lookup"><span data-stu-id="6b433-219">You can also run the `azure network public-ip show <resource group> <pip name>` command to display the details of your public IP, which includes the FQDN of the NIC.</span></span>

<span data-ttu-id="6b433-220">Jeśli przekazywanie zapytań na platformie Azure nie własnych potrzeb, musisz podać rozwiązania DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-220">If forwarding queries to Azure doesn't suit your needs, you need to provide your own DNS solution.</span></span>  <span data-ttu-id="6b433-221">Rozwiązania DNS musi:</span><span class="sxs-lookup"><span data-stu-id="6b433-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="6b433-222">Podaj rozpoznawania odpowiedniej nazwy hosta, na przykład za pomocą [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="6b433-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="6b433-223">Jeśli używasz DDNS, może być konieczne wyłączenie oczyszczanie rekordów DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-223">If you use DDNS, you might need to disable DNS record scavenging.</span></span> <span data-ttu-id="6b433-224">Dzierżawy DHCP platformy Azure są bardzo długie i oczyszczania może usunąć rekordy DNS przedwcześnie.</span><span class="sxs-lookup"><span data-stu-id="6b433-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="6b433-225">Podaj odpowiednie rekursywnego rozpoznawania zezwalająca na rozpoznawanie nazw domen zewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="6b433-225">Provide appropriate recursive resolution to allow resolution of external domain names.</span></span>
* <span data-ttu-id="6b433-226">Być dostępny (TCP i UDP na porcie 53) od klientów, które służy ona i mieć możliwość uzyskania dostępu do Internetu.</span><span class="sxs-lookup"><span data-stu-id="6b433-226">Be accessible (TCP and UDP on port 53) from the clients it serves and be able to access the Internet.</span></span>
* <span data-ttu-id="6b433-227">Być zabezpieczony przed dostępu z Internetu, aby zminimalizować zagrożenia powodowanego przez czynników zewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="6b433-227">Be secured against access from the Internet to mitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="6b433-228">Aby uzyskać najlepszą wydajność, korzystając z maszyn wirtualnych na serwerach DNS platformy Azure, wyłącz protokół IPv6 i przypisz [publiczny adres IP na poziomie wystąpienia](../../virtual-network/virtual-networks-instance-level-public-ip.md) do każdej maszyny wirtualnej serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="6b433-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) to each DNS server virtual machine.</span></span>  
>
>
