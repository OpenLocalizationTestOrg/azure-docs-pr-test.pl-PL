---
title: Uruchom Cassandra z systemem Linux na platformie Azure | Dokumentacja firmy Microsoft
description: "Jak uruchomić Cassandra klastra w systemie Linux w maszynach wirtualnych platformy Azure z poziomu aplikacji Node.js"
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 1ff3d77ced6c9d90029b251490c05e52d9b43515
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/29/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="84b67-103">Uruchamianie rozwiązania Cassandra w systemie Linux na platformie Azure i uzyskiwanie do niej dostępu na platformie Node.js</span><span class="sxs-lookup"><span data-stu-id="84b67-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="84b67-104">Platforma Azure ma dwa różne modele wdrażania do tworzenia i pracy z zasobami: [Resource Manager i Model Klasyczny](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="84b67-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="84b67-105">W tym artykule omówiono przy użyciu klasycznego modelu wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="84b67-105">This article covers using the Classic deployment model.</span></span> <span data-ttu-id="84b67-106">Firma Microsoft zaleca, aby w przypadku większości nowych wdrożeń korzystać z modelu opartego na programie Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="84b67-106">Microsoft recommends that most new deployments use the Resource Manager model.</span></span> <span data-ttu-id="84b67-107">Zobacz szablony Menedżera zasobów dla [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) i [Spark klastra i Cassandra na CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="84b67-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="84b67-108">Omówienie</span><span class="sxs-lookup"><span data-stu-id="84b67-108">Overview</span></span>
<span data-ttu-id="84b67-109">Microsoft Azure to platforma chmury Otwórz uruchamianego zarówno do firmy Microsoft jako oprogramowania również w innych niż Microsoft, w tym systemów operacyjnych, serwerów aplikacji, oprogramowanie pośredniczące obsługi wiadomości, a także baz danych SQL i NoSQL z obu modeli handlowych i otwórz źródła.</span><span class="sxs-lookup"><span data-stu-id="84b67-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="84b67-110">Tworzenie usług odporne na chmur publicznych, w tym na platformie Azure wymaga staranne planowanie i architektura zamierzonego dla obu serwerów aplikacji jako warstwy dobrze magazynu.</span><span class="sxs-lookup"><span data-stu-id="84b67-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="84b67-111">Naturalnie Cassandra w magazynie rozproszonym architektura ułatwia tworzenie wysokiej dostępności systemów, które są odporne na uszkodzenia w przypadku awarii klastra.</span><span class="sxs-lookup"><span data-stu-id="84b67-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="84b67-112">Cassandra jest skali chmury bazy danych NoSQL utrzymywana przez Foundation oprogramowania Apache cassandra.apache.org; Cassandra jest napisany w języku Java i dlatego działa zarówno na system Windows, jak i Linux platformy.</span><span class="sxs-lookup"><span data-stu-id="84b67-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="84b67-113">Ten artykuł koncentruje się pokazanie Cassandra wdrożenia na Ubuntu jako klaster pojedynczych i wielu danych Centrum wykorzystaniu maszyny wirtualne Microsoft Azure i sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="84b67-113">The focus of this article is to show Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="84b67-114">Wdrażanie klastra, w przypadku obciążeń produkcyjnych zoptymalizowanych pod kątem jest poza zakres tego artykułu, ponieważ wymaga ona konfiguracji węzła wielu dysków, projekt topologia pierścienia odpowiednie i danych modelowania do obsługi replikacji potrzebne, spójność danych, przepływności i wysoki wymagania dotyczące dostępności.</span><span class="sxs-lookup"><span data-stu-id="84b67-114">The cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling to support the needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="84b67-115">Ten artykuł ma podstawowych podejście do wyświetlenia, co jest zaangażowane w tworzenie klastra Cassandra porównywany Docker, Chef lub Puppet, które mogą ułatwić wdrożenie infrastruktury partii.</span><span class="sxs-lookup"><span data-stu-id="84b67-115">This article takes a fundamental approach to show what is involved in building the Cassandra cluster compared Docker, Chef or Puppet which can make the infrastructure deployment a lot easier.</span></span>  

## <a name="the-deployment-models"></a><span data-ttu-id="84b67-116">Modele wdrażania</span><span class="sxs-lookup"><span data-stu-id="84b67-116">The Deployment Models</span></span>
<span data-ttu-id="84b67-117">Sieci Microsoft Azure umożliwia wdrożenie izolowanego prywatnej klastrów, dostępu do których może być ograniczone do osiągnięcia zabezpieczenia sieci szczegółowe.</span><span class="sxs-lookup"><span data-stu-id="84b67-117">Microsoft Azure networking allows the deployment of isolated private clusters, the access of which can be restricted to attain fine grained network security.</span></span>  <span data-ttu-id="84b67-118">Ponieważ ten artykuł dotyczy przedstawiający wdrażanie Cassandra na poziomie podstawowym, firma Microsoft nie koncentruje się na poziomu spójności i projektu pamięci masowej optymalnej przepływności.</span><span class="sxs-lookup"><span data-stu-id="84b67-118">Since this article is about showing the Cassandra deployment at a fundamental level, we will not focus on the consistency level and the optimal storage design for throughput.</span></span> <span data-ttu-id="84b67-119">Poniżej przedstawiono listę wymagań sieciowych dotyczących naszych hipotetyczny klastra:</span><span class="sxs-lookup"><span data-stu-id="84b67-119">Here is the list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="84b67-120">Systemy zewnętrzne nie może uzyskać dostępu Cassandra bazy danych z lub poza Azure</span><span class="sxs-lookup"><span data-stu-id="84b67-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="84b67-121">Cassandra klastra musi być za modułem równoważenia obciążenia dla ruchu thrift</span><span class="sxs-lookup"><span data-stu-id="84b67-121">Cassandra cluster has to be behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="84b67-122">Wdrażanie węzłów Cassandra na dwie grupy w każdej centrum danych dostępności klastra rozszerzone</span><span class="sxs-lookup"><span data-stu-id="84b67-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="84b67-123">Zablokowanie klastra tak że tylko do farmy serwerów aplikacji ma dostęp do bazy danych bezpośrednio</span><span class="sxs-lookup"><span data-stu-id="84b67-123">Lock down the cluster so that only application server farm has access to the database directly</span></span>
* <span data-ttu-id="84b67-124">Brak publicznego punktów końcowych sieci innych niż SSH</span><span class="sxs-lookup"><span data-stu-id="84b67-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="84b67-125">Każdy węzeł Cassandra musi stałym wewnętrznego adresu IP</span><span class="sxs-lookup"><span data-stu-id="84b67-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="84b67-126">Cassandra można wdrożyć jeden region platformy Azure lub wielu regionach, oparte na Rozproszony charakter obciążenia.</span><span class="sxs-lookup"><span data-stu-id="84b67-126">Cassandra can be deployed to a single Azure region or to multiple regions based on the distributed nature of the workload.</span></span> <span data-ttu-id="84b67-127">Model wdrażania w przypadku nadającego się do obsługi użytkowników końcowych bliżej do określonej lokalizacji geograficznej, za pomocą tej samej infrastrukturze Cassandra.</span><span class="sxs-lookup"><span data-stu-id="84b67-127">Multi-region deployment model can be leveraged to serve end users closer to a particular geography through the same Cassandra infrastructure.</span></span> <span data-ttu-id="84b67-128">Cassandra dla wbudowanego węzła replikacji ma opieki synchronizacji wielu wzorca zapisuje pochodzących z wielu centrów danych i przedstawia widok spójności danych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="84b67-128">Cassandra’s built-in node replication takes care of the synchronization of multi-master writes originating from multiple data centers and presents a consistent view of the data to applications.</span></span> <span data-ttu-id="84b67-129">W przypadku wdrożenia może również pomóc z umożliwiają ograniczenie ryzyka związanego z szerszych awarie usługi Azure.</span><span class="sxs-lookup"><span data-stu-id="84b67-129">Multi-region deployment can also help with the risk mitigation of the broader Azure service outages.</span></span> <span data-ttu-id="84b67-130">Topologii replikacji i spójności dostosowywalne w Cassandra pomoże spełnia zróżnicowane potrzeby RPO aplikacji.</span><span class="sxs-lookup"><span data-stu-id="84b67-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="84b67-131">Wdrażanie jednego regionu</span><span class="sxs-lookup"><span data-stu-id="84b67-131">Single Region Deployment</span></span>
<span data-ttu-id="84b67-132">Firma Microsoft uruchomi z wdrożeniem pojedynczego regionu i podłączono learnings modelu w przypadku tworzenia.</span><span class="sxs-lookup"><span data-stu-id="84b67-132">We will start with a single region deployment and harvest the learnings in creating a multi-region model.</span></span> <span data-ttu-id="84b67-133">Sieci wirtualne platformy Azure będzie używany do utworzenia izolowanego podsieci spełnienia wymagań bezpieczeństwa sieci wymienione powyżej.</span><span class="sxs-lookup"><span data-stu-id="84b67-133">Azure virtual networking will be used to create isolated subnets so that the network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="84b67-134">Używa procesu opisanego w tworzeniu wdrożenia jeden region, Ubuntu 14.04 LTS i Cassandra 2.08; Jednak proces można łatwo przyjąć innych wariantów systemu Linux.</span><span class="sxs-lookup"><span data-stu-id="84b67-134">The process described in creating the single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, the process can easily be adopted to the other Linux variants.</span></span> <span data-ttu-id="84b67-135">Poniżej przedstawiono niektóre właściwości systemowych wdrożenia w pojedynczym regionie.</span><span class="sxs-lookup"><span data-stu-id="84b67-135">The following are some of the systemic characteristics of the single region deployment.</span></span>  

<span data-ttu-id="84b67-136">**Wysoka dostępność:** węzłów Cassandra pokazany na rysunku 1 są wdrażane dwa zestawy dostępności, aby węzły są rozkładane między wiele domen błędów w celu zapewnienia wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="84b67-136">**High Availability:** The Cassandra nodes shown in the Figure 1 are deployed to two availability sets so that the nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="84b67-137">Maszyny wirtualne adnotowany przy każdym zestawie dostępności jest mapowana na 2 domen błędów.</span><span class="sxs-lookup"><span data-stu-id="84b67-137">VMs annotated with each availability set is mapped to 2 fault domains.</span></span>  <span data-ttu-id="84b67-138">Microsoft Azure wykorzystuje pojęcie domeny błędów do zarządzania a koncepcji uaktualniania domeny (np. hosta lub gościa systemu operacyjnego stosowanie poprawek/uaktualnień, uaktualnień aplikacji) nieplanowanego wyłączenia jednocześnie (np. awarii sprzętu lub oprogramowania) służy do zarządzania zaplanowany czas przestoju.</span><span class="sxs-lookup"><span data-stu-id="84b67-138">Microsoft Azure uses the concept of fault domain to manage unplanned down time (e.g. hardware or software failures) while the concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="84b67-139">Zobacz [odzyskiwania po awarii i wysoką dostępność aplikacji Azure](http://msdn.microsoft.com/library/dn251004.aspx) roli domenach awarii i uaktualniania w celu osiągnięcia wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="84b67-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for the role of fault and upgrade domains in attaining high availability.</span></span>

![Wdrażanie jednego regionu](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="84b67-141">Rysunek 1: Wdrożenie pojedynczy region</span><span class="sxs-lookup"><span data-stu-id="84b67-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="84b67-142">Zauważ, że w momencie pisania tego Azure nie zezwalają jawne mapowanie grupy maszyn wirtualnych do domeny określonych błędów; w związku z tym nawet w przypadku modelu wdrażania pokazany na rysunku 1, jest statystycznie prawdopodobne, że wszystkie maszyny wirtualne mogą być mapowane na dwóch domen błędów zamiast cztery.</span><span class="sxs-lookup"><span data-stu-id="84b67-142">Note that at the time of this writing, Azure doesn’t allow the explicit mapping of a group of VMs to a specific fault domain; consequently, even with the deployment model shown in Figure 1, it is statistically probable that all the virtual machines may be mapped to two fault domains instead of four.</span></span>

<span data-ttu-id="84b67-143">**Ruch Thrift równoważenia obciążenia:** bibliotek klienckich Thrift wewnątrz serwera sieci web Połącz się z klastrem za pośrednictwem wewnętrznego modułu równoważenia obciążenia.</span><span class="sxs-lookup"><span data-stu-id="84b67-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside the web server connect to the cluster through an internal load balancer.</span></span> <span data-ttu-id="84b67-144">Wymaga to proces dodawania wewnętrznego modułu równoważenia obciążenia z podsiecią "data" (zobacz rysunek 1) w kontekście klastra Cassandra hosting usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="84b67-144">This requires the process of adding the internal load balancer to the “data” subnet (refer Figure 1) in the context of the cloud service hosting the Cassandra cluster.</span></span> <span data-ttu-id="84b67-145">Po zdefiniowaniu jest wewnętrzny moduł równoważenia obciążenia, każdy węzeł wymaga punktu końcowego równoważenia obciążenia ma zostać dodana z adnotacji o nazwie usługi równoważenia obciążenia wcześniej zdefiniowanego zestawu o zrównoważonym obciążeniu.</span><span class="sxs-lookup"><span data-stu-id="84b67-145">Once the internal load balancer is defined, each node requires the load balanced endpoint to be added with the annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="84b67-146">Zobacz [wewnętrzny równoważenia obciążenia Azure ](../../../load-balancer/load-balancer-internal-overview.md)więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="84b67-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="84b67-147">**Ziarna klastra:** ważne jest, aby wybrać większości węzłów wysokiej dostępności DS, jak nowe węzły będą komunikować się z węzłów inicjatora umożliwia odnalezienie topologii klastra.</span><span class="sxs-lookup"><span data-stu-id="84b67-147">**Cluster Seeds:** It is important to select the most highly available nodes for seeds as the new nodes will communicate with seed nodes to discover the topology of the cluster.</span></span> <span data-ttu-id="84b67-148">Jeden węzeł z każdym zestawie dostępności jest wyznaczony jako węzłów inicjatora, aby uniknąć pojedynczego punktu awarii.</span><span class="sxs-lookup"><span data-stu-id="84b67-148">One node from each availability set is designated as seed nodes to avoid single point of failure.</span></span>

<span data-ttu-id="84b67-149">**Współczynnik replikacji i poziomu spójności:** Cassandra w kompilacji w wysokiej dostępności i danych trwałości charakteryzuje się współczynnik replikacji (RF - liczby kopii każdego wiersza przechowywane w klastrze) i poziomu spójności (liczba replik być odczytana/zapisana przed zwróceniem wyniku do obiektu wywołującego).</span><span class="sxs-lookup"><span data-stu-id="84b67-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by the Replication Factor (RF - number of copies of each row stored on the cluster) and Consistency Level (number of replicas to be read/written before returning the result to the caller).</span></span> <span data-ttu-id="84b67-150">Współczynnik replikacji jest określone podczas tworzenia przestrzeni KLUCZY (podobnie jak relacyjna baza danych), określić poziom spójności podczas CRUD zapytania.</span><span class="sxs-lookup"><span data-stu-id="84b67-150">Replication factor is specified during the KEYSPACE (similar to a relational database) creation whereas the consistency level is specified while issuing the CRUD query.</span></span> <span data-ttu-id="84b67-151">W dokumentacji Cassandra [Konfigurowanie spójności](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) szczegóły spójności i formułę obliczenia kworum.</span><span class="sxs-lookup"><span data-stu-id="84b67-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and the formula for quorum computation.</span></span>

<span data-ttu-id="84b67-152">Cassandra obsługuje dwa typy modeli integralności danych — spójność i spójność ostateczna; Współczynnik replikacji i poziomu spójności ze sobą określi, czy dane będą zgodne natychmiast po zakończeniu operacji zapisu lub będą zgodne po pewnym czasie.</span><span class="sxs-lookup"><span data-stu-id="84b67-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; the Replication Factor and Consistency Level will together determine if the data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="84b67-153">Na przykład określenie KWORUM, zgodnie z poziomu spójności będzie zawsze gwarantuje spójności danych dowolnego poziomu spójności, poniżej liczba replik do zapisania w celu osiągnięcia KWORUM (np. jeden) powoduje ostatecznie spójności danych.</span><span class="sxs-lookup"><span data-stu-id="84b67-153">For example, specifying QUORUM as the Consistency Level will always ensures data Consistency while any consistency level, below the number of replicas to be written as needed to attain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="84b67-154">Powyższy współczynnik replikacji 3 i KWORUM klastra 8 węzłów (2 węzły są odczytywane lub zapisywane spójności) poziomu spójności odczytu/zapisu, przełączniki teoretycznego utraty najwyżej 1 węzła dla grupy replikacji przed powiadamiania uruchamiania aplikacji Wystąpił błąd.</span><span class="sxs-lookup"><span data-stu-id="84b67-154">The 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive the theoretical loss of at the most 1 node per replication group before the application start noticing the failure.</span></span> <span data-ttu-id="84b67-155">Przy założeniu, że wszystkie spacje klucza również mieć równoważony odczytu/zapisu żądania.</span><span class="sxs-lookup"><span data-stu-id="84b67-155">This assumes that all the key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="84b67-156">Parametry, które będą używane dla klastra wdrożone są następujące:</span><span class="sxs-lookup"><span data-stu-id="84b67-156">The following are the parameters we will use for the deployed cluster:</span></span>

<span data-ttu-id="84b67-157">Konfiguracja klastra Cassandra jednego regionu:</span><span class="sxs-lookup"><span data-stu-id="84b67-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="84b67-158">Parametr klastra</span><span class="sxs-lookup"><span data-stu-id="84b67-158">Cluster Parameter</span></span> | <span data-ttu-id="84b67-159">Wartość</span><span class="sxs-lookup"><span data-stu-id="84b67-159">Value</span></span> | <span data-ttu-id="84b67-160">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="84b67-161">Liczba węzłów (N)</span><span class="sxs-lookup"><span data-stu-id="84b67-161">Number of Nodes (N)</span></span> |<span data-ttu-id="84b67-162">8</span><span class="sxs-lookup"><span data-stu-id="84b67-162">8</span></span> |<span data-ttu-id="84b67-163">Całkowita liczba węzłów w klastrze</span><span class="sxs-lookup"><span data-stu-id="84b67-163">Total number of nodes in the cluster</span></span> |
| <span data-ttu-id="84b67-164">Współczynnik replikacji (RF)</span><span class="sxs-lookup"><span data-stu-id="84b67-164">Replication Factor (RF)</span></span> |<span data-ttu-id="84b67-165">3</span><span class="sxs-lookup"><span data-stu-id="84b67-165">3</span></span> |<span data-ttu-id="84b67-166">Liczba replik danego wiersza</span><span class="sxs-lookup"><span data-stu-id="84b67-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="84b67-167">Poziom zgodności (Zapisz)</span><span class="sxs-lookup"><span data-stu-id="84b67-167">Consistency Level (Write)</span></span> |<span data-ttu-id="84b67-168">QUORUM[(RF/2) +1) = 2 wynik formuły zostać zaokrąglona w dół</span><span class="sxs-lookup"><span data-stu-id="84b67-168">QUORUM[(RF/2) +1) = 2] The result of the formula is rounded down</span></span> |<span data-ttu-id="84b67-169">Zapisuje najwyżej 2 replik przed wysłaniem odpowiedzi do wywołującego 3 repliki są zapisywane w sposób spójny po pewnym czasie.</span><span class="sxs-lookup"><span data-stu-id="84b67-169">Writes at the most 2 replicas before the response is sent to the caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="84b67-170">Poziom zgodności (odczyt)</span><span class="sxs-lookup"><span data-stu-id="84b67-170">Consistency Level (Read)</span></span> |<span data-ttu-id="84b67-171">KWORUM [(RF/2) + 1 = 2] jest zaokrąglana wynik formuły</span><span class="sxs-lookup"><span data-stu-id="84b67-171">QUORUM [(RF/2) +1= 2] The result of the formula is rounded down</span></span> |<span data-ttu-id="84b67-172">Odczytuje 2 replik przed wysłaniem odpowiedzi do obiektu wywołującego.</span><span class="sxs-lookup"><span data-stu-id="84b67-172">Reads 2 replicas before sending response to the caller.</span></span> |
| <span data-ttu-id="84b67-173">Strategii replikacji</span><span class="sxs-lookup"><span data-stu-id="84b67-173">Replication Strategy</span></span> |<span data-ttu-id="84b67-174">Zobacz NetworkTopologyStrategy [replikacji danych](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) w Cassandra dokumentacji, aby uzyskać więcej informacji</span><span class="sxs-lookup"><span data-stu-id="84b67-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="84b67-175">Rozumie topologii wdrożenia i umieszcza replik w węzłach, tak, aby wszystkie repliki nie trafiają do tej samej stojak</span><span class="sxs-lookup"><span data-stu-id="84b67-175">Understands the deployment topology and places replicas on nodes so that all the replicas don’t end up on the same rack</span></span> |
| <span data-ttu-id="84b67-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="84b67-176">Snitch</span></span> |<span data-ttu-id="84b67-177">Zobacz GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) w Cassandra dokumentacji, aby uzyskać więcej informacji</span><span class="sxs-lookup"><span data-stu-id="84b67-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="84b67-178">NetworkTopologyStrategy używa pojęcie snitch zrozumienie topologii.</span><span class="sxs-lookup"><span data-stu-id="84b67-178">NetworkTopologyStrategy uses a concept of snitch to understand the topology.</span></span> <span data-ttu-id="84b67-179">GossipingPropertyFileSnitch zapewnia lepszą kontrolę w mapowaniu każdego węzła do centrum danych i stojaku.</span><span class="sxs-lookup"><span data-stu-id="84b67-179">GossipingPropertyFileSnitch gives better control in mapping each node to data center and rack.</span></span> <span data-ttu-id="84b67-180">Klaster używa następnie plotki propagację te informacje.</span><span class="sxs-lookup"><span data-stu-id="84b67-180">The cluster then uses gossip to propagate this information.</span></span> <span data-ttu-id="84b67-181">To jest znacznie prostsza w dynamicznej ustawienie adresu IP względem PropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="84b67-181">This is much simpler in dynamic IP setting relative to PropertyFileSnitch</span></span> |

<span data-ttu-id="84b67-182">**Azure zagadnienia dotyczące klastra Cassandra:** możliwości maszyny wirtualne Microsoft Azure korzysta z magazynu obiektów Blob platformy Azure dysku trwałości; Usługa Azure Storage zapisuje 3 replik każdego dysku, aby uzyskać wysoką trwałością.</span><span class="sxs-lookup"><span data-stu-id="84b67-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="84b67-183">Oznacza to, każdy wiersz danych wstawione do tabeli Cassandra jest już zapisana w 3 repliki i dlatego spójność danych jest już wykonane obsługę nawet, jeśli współczynnik replikacji (RF) wynosi 1.</span><span class="sxs-lookup"><span data-stu-id="84b67-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if the Replication Factor (RF) is 1.</span></span> <span data-ttu-id="84b67-184">Główny problem z współczynnik replikacji jest 1 jest aplikacji wystąpi przestój nawet w przypadku awarii jednego węzła Cassandra.</span><span class="sxs-lookup"><span data-stu-id="84b67-184">The main problem with Replication Factor being 1 is that the application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="84b67-185">Jednak jeśli węzeł nie działa dla problemów (np. sprzętu, błędów oprogramowania systemu) rozpoznawany przez kontroler sieci szkieletowej Azure, będzie dostarczać nowego węzła w tym miejscu przy użyciu tego samego dysków.</span><span class="sxs-lookup"><span data-stu-id="84b67-185">However, if a node is down for the problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using the same storage drives.</span></span> <span data-ttu-id="84b67-186">Inicjowanie obsługi nowego węzła do zastąpi stare hasło może potrwać kilka minut.</span><span class="sxs-lookup"><span data-stu-id="84b67-186">Provisioning a new node to replace the old one may take a few minutes.</span></span>  <span data-ttu-id="84b67-187">Podobnie czynności zaplanowanej konserwacji, jak zmiany systemu operacyjnego gościa, uaktualnia Cassandra, i zmian w aplikacji Kontroler sieci szkieletowej Azure wykonuje wprowadzanie uaktualnień węzłów w klastrze.</span><span class="sxs-lookup"><span data-stu-id="84b67-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of the nodes in the cluster.</span></span>  <span data-ttu-id="84b67-188">Również uaktualnień stopniowych może potrwać kilka węzłów w dół w czasie, a tym samym klastrze może wystąpić krótki przestój w przypadku kilku partycji.</span><span class="sxs-lookup"><span data-stu-id="84b67-188">Rolling upgrades also may take down a few nodes at a time and hence the cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="84b67-189">Jednak dane nie zostaną utracone z powodu wbudowane funkcje nadmiarowości usługi Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="84b67-189">However, the data will not be lost due to the built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="84b67-190">Dla systemów wdrożeniu na platformie Azure, która nie wymaga wysokiej dostępności (np. około 99,9 który jest odpowiednikiem 8.76 godzin na rok, zobacz [wysokiej dostępności](http://en.wikipedia.org/wiki/High_availability) szczegółowe informacje) można uruchamiać z RF = 1 i poziom spójności równej ONE.</span><span class="sxs-lookup"><span data-stu-id="84b67-190">For systems deployed to Azure that doesn’t require high availability (e.g. around 99.9 which is equivalent to 8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able to run with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="84b67-191">W przypadku aplikacji o wysokiej dostępności wymagania, RF = 3 i poziomu spójności = KWORUM będą tolerować czas przestoju jednego z węzłów z replik.</span><span class="sxs-lookup"><span data-stu-id="84b67-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate the down time of one of the nodes one of the replicas.</span></span> <span data-ttu-id="84b67-192">RF = 1 w przypadku tradycyjnych wdrożeń (np. lokalnego) nie można używać z powodu możliwej utracie danych wynikające z problemów, takich jak awarii dysku.</span><span class="sxs-lookup"><span data-stu-id="84b67-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due to the possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="84b67-193">W przypadku wdrożenia</span><span class="sxs-lookup"><span data-stu-id="84b67-193">Multi-region Deployment</span></span>
<span data-ttu-id="84b67-194">W Cassandra data center rozpoznają replikacji i spójność model opisane powyżej pomaga przy użyciu wdrażania w przypadku fabrycznej bez konieczności stosowania żadnych narzędzi zewnętrznych.</span><span class="sxs-lookup"><span data-stu-id="84b67-194">Cassandra’s data-center-aware replication and consistency model described above helps with the multi-region deployment out of the box without the need for any external tooling.</span></span> <span data-ttu-id="84b67-195">Jest to całkowicie różnią się od tradycyjnych relacyjnych baz danych, gdzie instalację na potrzeby dublowania bazy danych dla wielu wzorców operacji zapisu może być dość złożone.</span><span class="sxs-lookup"><span data-stu-id="84b67-195">This is quite different from the traditional relational databases where the setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="84b67-196">Cassandra w regionie wielu — konfiguracja może ułatwić scenariusze użycia, takie jak następujące:</span><span class="sxs-lookup"><span data-stu-id="84b67-196">Cassandra in a multi-region set up can help with the usage scenarios including the following:</span></span>

<span data-ttu-id="84b67-197">**Wdrożenia na podstawie bliskości:** aplikacje wielodostępne, wyczyść mapowania użytkowników dzierżawy-do-region, można korzystali przez klaster w przypadku małych opóźnień.</span><span class="sxs-lookup"><span data-stu-id="84b67-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by the multi-region cluster’s low latencies.</span></span> <span data-ttu-id="84b67-198">Na przykład zarządzanie learning systemów dla instytucji edukacyjnych można wdrożyć klaster rozproszonych w regionach wschodnie stany USA i zachodnie stany USA do obsługi odpowiednich szkoły wyższe dla transakcyjnego, a także analizy.</span><span class="sxs-lookup"><span data-stu-id="84b67-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions to serve the respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="84b67-199">Dane mogą być lokalnie spójne w czasie odczyty i zapisy i może być ostatecznie spójne w obu regionach.</span><span class="sxs-lookup"><span data-stu-id="84b67-199">The data can be locally consistent at the time reads and writes and can be eventually consistent across both the regions.</span></span> <span data-ttu-id="84b67-200">Istnieją inne przykłady takich jak dystrybucji nośnika, handlu elektronicznego i niczego i wszystko, co służy geograficznie skoncentrowanego użytkownika podstawowego jest przypadek użycia dobrej dla tego modelu wdrażania.</span><span class="sxs-lookup"><span data-stu-id="84b67-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="84b67-201">**Wysoka dostępność:** nadmiarowość jest kluczowym czynnikiem w celu osiągnięcia wysokiej dostępności sprzętu i oprogramowania; więcej szczegółów, zobacz Tworzenie niezawodnej systemy chmur w systemie Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="84b67-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="84b67-202">W systemie Microsoft Azure tylko niezawodny sposób realizacji nadmiarowość wartość true, jest wdrażanie klastra w przypadku.</span><span class="sxs-lookup"><span data-stu-id="84b67-202">On Microsoft Azure, the only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="84b67-203">Aplikacje można wdrażać w trybie aktywny aktywny lub aktywny / pasywny, a jeśli jeden z regionów działa, usługi Azure Traffic Manager można przekierowywania ruchu sieciowego na aktywnym regionem.</span><span class="sxs-lookup"><span data-stu-id="84b67-203">Applications can be deployed in an active-active or active-passive mode and if one of the regions is down, Azure Traffic Manager can redirect traffic to the active region.</span></span>  <span data-ttu-id="84b67-204">Przy użyciu wdrażania jednego regionu, w przypadku dostępności 99,9, region dwa wdrożenia może osiągnąć dostępności 99.9999 obliczone przez formułę: (1-(1-0.999) * (1-0.999)) * 100); zobacz dokument powyżej, aby uzyskać szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="84b67-204">With the single region deployment, if the availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by the formula: (1-(1-0.999) * (1-0.999))*100); see the above paper for details.</span></span>

<span data-ttu-id="84b67-205">**Odzyskiwanie po awarii:** Cassandra w przypadku klastra, jeśli przeznaczony prawidłowo, może wytrzymać przestojami centrum danych w wyniku katastrofy.</span><span class="sxs-lookup"><span data-stu-id="84b67-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="84b67-206">Jeśli działa jeden region, można uruchomić aplikacji wdrożone do innych regionów obsługująca użytkowników końcowych.</span><span class="sxs-lookup"><span data-stu-id="84b67-206">If one region is down, the application deployed to other regions can start serving the end users.</span></span> <span data-ttu-id="84b67-207">Podobnie jak wszelkie innych firm ciągłości implementacji aplikacja musi być odporny na błędy na utratę danych, na podstawie danych w potoku asynchroniczne.</span><span class="sxs-lookup"><span data-stu-id="84b67-207">Like any other business continuity implementations, the application has to be tolerant for some data loss resulting from the data in the asynchronous pipeline.</span></span> <span data-ttu-id="84b67-208">Jednak Cassandra sprawia, że odzyskiwania znacznie usprawnić niż czas trwania procesów odzyskiwania tradycyjne bazy danych.</span><span class="sxs-lookup"><span data-stu-id="84b67-208">However, Cassandra makes the recovery much swifter than the time taken by traditional database recovery processes.</span></span> <span data-ttu-id="84b67-209">Na rysunku 2 przedstawiono typowe wdrożenie w przypadku modelu o ośmiu węzłów w każdym regionie.</span><span class="sxs-lookup"><span data-stu-id="84b67-209">Figure 2 shows the typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="84b67-210">Zarówno regiony są dublowane obrazy wzajemnie dla tego samego symetrycznego; projekty rzeczywistych zależy od tego, typu obciążenia (np. transakcyjnej lub analitycznych), RPO, RTO, spójności danych oraz wymagań dotyczących dostępności.</span><span class="sxs-lookup"><span data-stu-id="84b67-210">Both regions are mirror images of each other for the same of symmetry; real world designs depend on the workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Obsługa wielu region wdrożenia](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="84b67-212">Rysunek 2: W przypadku Cassandra wdrożenia</span><span class="sxs-lookup"><span data-stu-id="84b67-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="84b67-213">Integracja sieci</span><span class="sxs-lookup"><span data-stu-id="84b67-213">Network Integration</span></span>
<span data-ttu-id="84b67-214">Ustawia maszyn wirtualnych wdrożonych na sieciach prywatnych, znajduje się na dwóch regionach komunikuje się ze sobą przy użyciu tunelu VPN.</span><span class="sxs-lookup"><span data-stu-id="84b67-214">Sets of virtual machines deployed to private networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="84b67-215">Tunel VPN łączy dwie bramy oprogramowanie udostępniane w trakcie procesu wdrażania sieci.</span><span class="sxs-lookup"><span data-stu-id="84b67-215">The VPN tunnel connects two software gateways provisioned during the network deployment process.</span></span> <span data-ttu-id="84b67-216">Zarówno regiony mają podobną architekturę sieci pod względem podsieci "web" i "dane"; Sieć platformy Azure umożliwia tworzenie tyle podsieci zgodnie z potrzebami i stosować listy ACL, odpowiednio do potrzeb zabezpieczeń sieci.</span><span class="sxs-lookup"><span data-stu-id="84b67-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows the creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="84b67-217">Podczas projektowania topologii klastra między opóźnienie komunikacji centrum danych i ekonomiczne wpływu na ruch sieciowy należy wziąć pod uwagę.</span><span class="sxs-lookup"><span data-stu-id="84b67-217">While designing the cluster topology inter data center communication latency and the economic impact of the network traffic need to be considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="84b67-218">Spójność danych wdrożenia Centrum usługi danych</span><span class="sxs-lookup"><span data-stu-id="84b67-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="84b67-219">Rozproszone wdrożeń muszą być świadome wpływu Topologia klastra na przepływność i wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="84b67-219">Distributed deployments need to be aware of the cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="84b67-220">Należy wybrać w taki sposób, że kworum nie zależy od dostępności wszystkich centrów danych, należy RF i poziomu spójności.</span><span class="sxs-lookup"><span data-stu-id="84b67-220">The RF and Consistency Level need to be selected in such way that the quorum doesn’t depend on the availability of all the data centers.</span></span>
<span data-ttu-id="84b67-221">Wymagające wysokiej spójności systemu LOCAL_QUORUM spójności poziomu (odczyty i zapisy) będzie upewnij się, że lokalne odczyty i zapisy są spełnione z lokalnych węzłów podczas, gdy dane są replikowane asynchronicznie w centrach danych zdalnych.</span><span class="sxs-lookup"><span data-stu-id="84b67-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that the local reads and writes are satisfied from the local nodes while data is replicated asynchronously to the remote data centers.</span></span>  <span data-ttu-id="84b67-222">Tabela 2 zawiera podsumowanie szczegółów konfiguracji klastra w przypadku opisane w dalszej części zapisu w górę.</span><span class="sxs-lookup"><span data-stu-id="84b67-222">Table 2 summarizes the configuration details for the multi-region cluster outlined later in the write up.</span></span>

<span data-ttu-id="84b67-223">**Konfiguracja klastra Cassandra dwa regionu**</span><span class="sxs-lookup"><span data-stu-id="84b67-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="84b67-224">Parametr klastra</span><span class="sxs-lookup"><span data-stu-id="84b67-224">Cluster Parameter</span></span> | <span data-ttu-id="84b67-225">Wartość</span><span class="sxs-lookup"><span data-stu-id="84b67-225">Value</span></span> | <span data-ttu-id="84b67-226">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="84b67-227">Liczba węzłów (N)</span><span class="sxs-lookup"><span data-stu-id="84b67-227">Number of Nodes (N)</span></span> |<span data-ttu-id="84b67-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="84b67-228">8 + 8</span></span> |<span data-ttu-id="84b67-229">Całkowita liczba węzłów w klastrze</span><span class="sxs-lookup"><span data-stu-id="84b67-229">Total number of nodes in the cluster</span></span> |
| <span data-ttu-id="84b67-230">Współczynnik replikacji (RF)</span><span class="sxs-lookup"><span data-stu-id="84b67-230">Replication Factor (RF)</span></span> |<span data-ttu-id="84b67-231">3</span><span class="sxs-lookup"><span data-stu-id="84b67-231">3</span></span> |<span data-ttu-id="84b67-232">Liczba replik danego wiersza</span><span class="sxs-lookup"><span data-stu-id="84b67-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="84b67-233">Poziom zgodności (Zapisz)</span><span class="sxs-lookup"><span data-stu-id="84b67-233">Consistency Level (Write)</span></span> |<span data-ttu-id="84b67-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] wynik formuły zostać zaokrąglona w dół</span><span class="sxs-lookup"><span data-stu-id="84b67-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] The result of the formula is rounded down</span></span> |<span data-ttu-id="84b67-235">węzły 2 pierwszego centrum danych będą zapisywane synchronicznie; dodatkowe węzły 2 potrzebne do kworum będą zapisywane asynchronicznie 2 centrum danych.</span><span class="sxs-lookup"><span data-stu-id="84b67-235">2 nodes will be written to the first data center synchronously; the additional 2 nodes needed for quorum will be written asynchronously to the 2nd data center.</span></span> |
| <span data-ttu-id="84b67-236">Poziom zgodności (odczyt)</span><span class="sxs-lookup"><span data-stu-id="84b67-236">Consistency Level (Read)</span></span> |<span data-ttu-id="84b67-237">LOCAL_QUORUM ((RF/2) + 1) = 2, wynik formuły zostać zaokrąglona w dół</span><span class="sxs-lookup"><span data-stu-id="84b67-237">LOCAL_QUORUM ((RF/2) +1) = 2 The result of the formula is rounded down</span></span> |<span data-ttu-id="84b67-238">Żądań odczytu są spełnione przy tylko jeden region; 2 węzły są odczytywane przed wysłaniem odpowiedzi do klienta.</span><span class="sxs-lookup"><span data-stu-id="84b67-238">Read requests are satisfied from only one region; 2 nodes are read before the response is sent back to the client.</span></span> |
| <span data-ttu-id="84b67-239">Strategii replikacji</span><span class="sxs-lookup"><span data-stu-id="84b67-239">Replication Strategy</span></span> |<span data-ttu-id="84b67-240">Zobacz NetworkTopologyStrategy [replikacji danych](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) w Cassandra dokumentacji, aby uzyskać więcej informacji</span><span class="sxs-lookup"><span data-stu-id="84b67-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="84b67-241">Rozumie topologii wdrożenia i umieszcza replik w węzłach, tak, aby wszystkie repliki nie trafiają do tej samej stojak</span><span class="sxs-lookup"><span data-stu-id="84b67-241">Understands the deployment topology and places replicas on nodes so that all the replicas don’t end up on the same rack</span></span> |
| <span data-ttu-id="84b67-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="84b67-242">Snitch</span></span> |<span data-ttu-id="84b67-243">Zobacz GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) w Cassandra dokumentacji, aby uzyskać więcej informacji</span><span class="sxs-lookup"><span data-stu-id="84b67-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="84b67-244">NetworkTopologyStrategy używa pojęcie snitch zrozumienie topologii.</span><span class="sxs-lookup"><span data-stu-id="84b67-244">NetworkTopologyStrategy uses a concept of snitch to understand the topology.</span></span> <span data-ttu-id="84b67-245">GossipingPropertyFileSnitch zapewnia lepszą kontrolę w mapowaniu każdego węzła do centrum danych i stojaku.</span><span class="sxs-lookup"><span data-stu-id="84b67-245">GossipingPropertyFileSnitch gives better control in mapping each node to data center and rack.</span></span> <span data-ttu-id="84b67-246">Klaster używa następnie plotki propagację te informacje.</span><span class="sxs-lookup"><span data-stu-id="84b67-246">The cluster then uses gossip to propagate this information.</span></span> <span data-ttu-id="84b67-247">To jest znacznie prostsza w dynamicznej ustawienie adresu IP względem PropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="84b67-247">This is much simpler in dynamic IP setting relative to PropertyFileSnitch</span></span> |

## <a name="the-software-configuration"></a><span data-ttu-id="84b67-248">KONFIGURACJA OPROGRAMOWANIA</span><span class="sxs-lookup"><span data-stu-id="84b67-248">THE SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="84b67-249">Następujące wersje oprogramowania są używane podczas wdrażania:</span><span class="sxs-lookup"><span data-stu-id="84b67-249">The following software versions are used during the deployment:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-250">Oprogramowanie</span><span class="sxs-lookup"><span data-stu-id="84b67-250">Software</span></span></th><th><span data-ttu-id="84b67-251">Element źródłowy</span><span class="sxs-lookup"><span data-stu-id="84b67-251">Source</span></span></th><th><span data-ttu-id="84b67-252">Wersja</span><span class="sxs-lookup"><span data-stu-id="84b67-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-253">ŚRODOWISKA JRE</span><span class="sxs-lookup"><span data-stu-id="84b67-253">JRE</span></span>    </td><td><span data-ttu-id="84b67-254">[ŚRODOWISKA JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="84b67-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="84b67-255">8U5</span><span class="sxs-lookup"><span data-stu-id="84b67-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-256">JNA</span><span class="sxs-lookup"><span data-stu-id="84b67-256">JNA</span></span>    </td><td><span data-ttu-id="84b67-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="84b67-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="84b67-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="84b67-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="84b67-259">Cassandra</span></span></td><td>[<span data-ttu-id="84b67-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="84b67-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="84b67-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="84b67-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="84b67-262">Ubuntu</span></span>    </td><td><span data-ttu-id="84b67-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="84b67-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="84b67-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="84b67-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="84b67-265">Ponieważ pobieranie środowiska JRE wymaga ręcznego akceptacji licencji Oracle, można uprościć wdrażanie, Pobierz wymagane oprogramowanie do pulpitu na przekazywanie dalej do obrazu szablonu Ubuntu, firma Microsoft będzie tworzony jako macierzystych do wdrożenia klastra.</span><span class="sxs-lookup"><span data-stu-id="84b67-265">Since downloading of JRE requires manual acceptance of Oracle license, to simplify the deployment, download all the required software to the desktop for later uploading into the Ubuntu template image we will be creating as a precursor to the cluster deployment.</span></span>

<span data-ttu-id="84b67-266">Pobierz powyższego oprogramowania w katalogu pobierania dobrze znanego (np. %TEMP%/downloads w systemie Windows lub ~/Downloads na większości dystrybucje systemu Linux lub Mac.) na komputerze lokalnym.</span><span class="sxs-lookup"><span data-stu-id="84b67-266">Download the above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on the local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="84b67-267">TWORZENIE MASZYNY WIRTUALNEJ SYSTEMU UBUNTU</span><span class="sxs-lookup"><span data-stu-id="84b67-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="84b67-268">W tym kroku procesu zostanie utworzony obraz Ubuntu z wstępnie wymagane oprogramowanie, aby obraz mogą być ponownie używane do inicjowania obsługi kilka węzłów Cassandra.</span><span class="sxs-lookup"><span data-stu-id="84b67-268">In this step of the process we will create Ubuntu image with the pre-requisite software so that the image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="84b67-269">Krok 1: Generuje parę kluczy SSH</span><span class="sxs-lookup"><span data-stu-id="84b67-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="84b67-270">Platforma Azure wymaga X509 klucza publicznego, który jest PEM lub DER zakodowane w czasie inicjowania obsługi administracyjnej.</span><span class="sxs-lookup"><span data-stu-id="84b67-270">Azure needs an X509 public key that is either PEM or DER encoded at the provisioning time.</span></span> <span data-ttu-id="84b67-271">Generowanie pary kluczy publiczny/prywatny, korzystając z instrukcji znajdujący się w sposób używanie SSH z systemem Linux na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="84b67-271">Generate a public/private key pair using the instructions located at How to Use SSH with Linux on Azure.</span></span> <span data-ttu-id="84b67-272">Jeśli planujesz użyć putty.exe jako klienta SSH w systemie Windows lub Linux, należy przekonwertować PEM zakodowane RSA klucz prywatny do formatu PPK, używając puttygen.exe; odpowiednie instrukcje znajdują się w powyższym strony sieci web.</span><span class="sxs-lookup"><span data-stu-id="84b67-272">If you plan to use putty.exe as an SSH client either on Windows or Linux, you have to convert the PEM encoded RSA private key to PPK format using puttygen.exe; the instructions for this can be found in the above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="84b67-273">Krok 2: Tworzenie Ubuntu szablonu maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="84b67-274">Aby utworzyć szablon maszyny Wirtualnej, zaloguj się do klasycznego portalu Azure i użyj następującej procedury: kliknij przycisk Nowy, obliczeń, maszyny WIRTUALNEJ, z GALERII, UBUNTU, Ubuntu Server 14.04 LTS, a następnie kliknij strzałkę w prawo.</span><span class="sxs-lookup"><span data-stu-id="84b67-274">To create the template VM, log into the Azure classic portal and use the following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click the right arrow.</span></span> <span data-ttu-id="84b67-275">Samouczek, który opisuje metodę utworzyć Maszynę wirtualną systemu Linux, zobacz Tworzenie maszyny wirtualnej systemem Linux.</span><span class="sxs-lookup"><span data-stu-id="84b67-275">For a tutorial that describes how to create a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="84b67-276">Na ekranie "konfiguracja maszyny wirtualnej" #1, wprowadź następujące informacje:</span><span class="sxs-lookup"><span data-stu-id="84b67-276">Enter the following information on the “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-277">NAZWA POLA</span><span class="sxs-lookup"><span data-stu-id="84b67-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="84b67-278">WARTOŚĆ POLA</span><span class="sxs-lookup"><span data-stu-id="84b67-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="84b67-279">UWAGI</span><span class="sxs-lookup"><span data-stu-id="84b67-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="84b67-280">DATA WYDANIA WERSJI</span><span class="sxs-lookup"><span data-stu-id="84b67-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="84b67-281">Wybierz datę z listy rozwijanej</span><span class="sxs-lookup"><span data-stu-id="84b67-281">Select a date from the drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="84b67-282">NAZWA MASZYNY WIRTUALNEJ</span><span class="sxs-lookup"><span data-stu-id="84b67-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="84b67-283">Szablon przypadku</span><span class="sxs-lookup"><span data-stu-id="84b67-283">cass-template</span></span>                   </td><td> <span data-ttu-id="84b67-284">Jest to nazwa hosta maszyny wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-284">This is the hostname of the VM</span></span> </td><tr>
<tr><td><span data-ttu-id="84b67-285">WARSTWY</span><span class="sxs-lookup"><span data-stu-id="84b67-285">TIER</span></span>                     </td><td> <span data-ttu-id="84b67-286">STANDARDOWA</span><span class="sxs-lookup"><span data-stu-id="84b67-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="84b67-287">Pozostaw wartość domyślną</span><span class="sxs-lookup"><span data-stu-id="84b67-287">Leave the default</span></span>              </td><tr>
<tr><td><span data-ttu-id="84b67-288">ROZMIAR</span><span class="sxs-lookup"><span data-stu-id="84b67-288">SIZE</span></span>                     </td><td> <span data-ttu-id="84b67-289">A1</span><span class="sxs-lookup"><span data-stu-id="84b67-289">A1</span></span>                              </td><td><span data-ttu-id="84b67-290">Wybierz maszynę Wirtualną, w zależności od potrzeb operacji We/Wy; w tym celu pozostaw wartość domyślną</span><span class="sxs-lookup"><span data-stu-id="84b67-290">Select the VM based on the IO needs; for this purpose leave the default</span></span> </td><tr>
<tr><td> <span data-ttu-id="84b67-291">NOWĄ NAZWĘ UŻYTKOWNIKA</span><span class="sxs-lookup"><span data-stu-id="84b67-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="84b67-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="84b67-292">localadmin</span></span>                       </td><td> <span data-ttu-id="84b67-293">"Administrator" jest zastrzeżoną nazwą użytkownika w xx 12 Ubuntu i po</span><span class="sxs-lookup"><span data-stu-id="84b67-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="84b67-294">UWIERZYTELNIANIE</span><span class="sxs-lookup"><span data-stu-id="84b67-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="84b67-295">Kliknij pole wyboru</span><span class="sxs-lookup"><span data-stu-id="84b67-295">Click check box</span></span>                 </td><td><span data-ttu-id="84b67-296">Sprawdź, czy chcesz zabezpieczyć za pomocą klucza SSH</span><span class="sxs-lookup"><span data-stu-id="84b67-296">Check if you want to secure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="84b67-297">CERTYFIKAT</span><span class="sxs-lookup"><span data-stu-id="84b67-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="84b67-298">Nazwa pliku certyfikatu klucza publicznego</span><span class="sxs-lookup"><span data-stu-id="84b67-298">file name of the public key certificate</span></span> </td><td> <span data-ttu-id="84b67-299">Użyj klucza publicznego, wcześniej wygenerowany</span><span class="sxs-lookup"><span data-stu-id="84b67-299">Use the public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="84b67-300">Nowe hasło</span><span class="sxs-lookup"><span data-stu-id="84b67-300">New Password</span></span>    </td><td> <span data-ttu-id="84b67-301">Silne hasło</span><span class="sxs-lookup"><span data-stu-id="84b67-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="84b67-302">Potwierdź hasło</span><span class="sxs-lookup"><span data-stu-id="84b67-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="84b67-303">Silne hasło</span><span class="sxs-lookup"><span data-stu-id="84b67-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="84b67-304">Na ekranie "konfiguracja maszyny wirtualnej" #2, wprowadź następujące informacje:</span><span class="sxs-lookup"><span data-stu-id="84b67-304">Enter the following information on the “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-305">NAZWA POLA</span><span class="sxs-lookup"><span data-stu-id="84b67-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="84b67-306">WARTOŚĆ POLA</span><span class="sxs-lookup"><span data-stu-id="84b67-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="84b67-307">UWAGI</span><span class="sxs-lookup"><span data-stu-id="84b67-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="84b67-308">USŁUGI W CHMURZE</span><span class="sxs-lookup"><span data-stu-id="84b67-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="84b67-309">Utwórz nową usługę w chmurze</span><span class="sxs-lookup"><span data-stu-id="84b67-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="84b67-310">Usługa w chmurze jest zasoby obliczeniowe kontenera, takich jak maszyny wirtualne</span><span class="sxs-lookup"><span data-stu-id="84b67-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="84b67-311">NAZWA DNS USŁUGI W CHMURZE</span><span class="sxs-lookup"><span data-stu-id="84b67-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="84b67-312">ubuntu template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="84b67-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="84b67-313">Nadaj nazwę modułu równoważenia obciążenia o niesprecyzowanym maszyny</span><span class="sxs-lookup"><span data-stu-id="84b67-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="84b67-314">REGION/GRUPY KOLIGACJI/SIECI WIRTUALNEJ</span><span class="sxs-lookup"><span data-stu-id="84b67-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="84b67-315">Zachodnie stany USA</span><span class="sxs-lookup"><span data-stu-id="84b67-315">West US</span></span>    </td><td> <span data-ttu-id="84b67-316">Wybierz region, z której uzyskują dostęp do klastra Cassandra aplikacji sieci web</span><span class="sxs-lookup"><span data-stu-id="84b67-316">Select a region from which your web applications access the Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-317">KONTO MAGAZYNU</span><span class="sxs-lookup"><span data-stu-id="84b67-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="84b67-318">Użyj domyślnej</span><span class="sxs-lookup"><span data-stu-id="84b67-318">Use default</span></span>    </td><td><span data-ttu-id="84b67-319">Użyj domyślnego konta magazynu lub wstępnie utworzone konto magazynu w określonym regionie</span><span class="sxs-lookup"><span data-stu-id="84b67-319">Use the default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-320">ZESTAW DOSTĘPNOŚCI</span><span class="sxs-lookup"><span data-stu-id="84b67-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="84b67-321">Brak</span><span class="sxs-lookup"><span data-stu-id="84b67-321">None</span></span> </td><td>    <span data-ttu-id="84b67-322">Pozostaw to pole puste</span><span class="sxs-lookup"><span data-stu-id="84b67-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-323">PUNKTY KOŃCOWE</span><span class="sxs-lookup"><span data-stu-id="84b67-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="84b67-324">Użyj domyślnej</span><span class="sxs-lookup"><span data-stu-id="84b67-324">Use default</span></span> </td><td>    <span data-ttu-id="84b67-325">Użyj domyślnej konfiguracji SSH</span><span class="sxs-lookup"><span data-stu-id="84b67-325">Use the default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="84b67-326">Kliknij strzałkę w prawo, pozostaw wartości domyślne na ekranie #3 i kliknij przycisk "Sprawdź", aby ukończyć proces tworzenia maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="84b67-326">Click right arrow, leave the defaults on the screen #3 and click the “check” button to complete the VM provisioning process.</span></span> <span data-ttu-id="84b67-327">Po kilku minutach maszyny Wirtualnej o nazwie "ubuntu-template" powinna być w stanie "uruchomiona".</span><span class="sxs-lookup"><span data-stu-id="84b67-327">After a few minutes, the VM with the name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-the-necessary-software"></a><span data-ttu-id="84b67-328">ZAINSTALUJ OPROGRAMOWANIE NIEZBĘDNE</span><span class="sxs-lookup"><span data-stu-id="84b67-328">INSTALL THE NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="84b67-329">Krok 1: Przekazywanie tarballs</span><span class="sxs-lookup"><span data-stu-id="84b67-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="84b67-330">Przy użyciu protokołu scp lub pscp, skopiuj pobrane wcześniej oprogramowanie do katalogu ~/downloads w następującym formacie polecenia:</span><span class="sxs-lookup"><span data-stu-id="84b67-330">Using scp or pscp, copy the previously downloaded software to ~/downloads directory using the following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="84b67-331">pscp server-środowiska jre-8u5-linux-x64.tar.gzlocaladmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="84b67-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="84b67-332">Powtórz powyższe polecenie dla środowiska JRE również podobnie jak w przypadku Cassandra usługi bits.</span><span class="sxs-lookup"><span data-stu-id="84b67-332">Repeat the above command for JRE as well as for the Cassandra bits.</span></span>

#### <a name="step-2-prepare-the-directory-structure-and-extract-the-archives"></a><span data-ttu-id="84b67-333">Krok 2: Przygotowanie strukturę katalogów i wyodrębniać archiwum</span><span class="sxs-lookup"><span data-stu-id="84b67-333">STEP 2: Prepare the directory structure and extract the archives</span></span>
<span data-ttu-id="84b67-334">Zaloguj się do maszyny Wirtualnej i Utwórz strukturę katalogów i Wyodrębnij oprogramowania jako superużytkownika przy użyciu poniższego skryptu bash:</span><span class="sxs-lookup"><span data-stu-id="84b67-334">Log into the VM and create the directory structure and extract software as a super user using the bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change the ownership to the service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile to add JRE to the PATH"
    echo "installation is complete"


<span data-ttu-id="84b67-335">Po wklejeniu tego skryptu do okna vim upewnij się usunąć powrotu karetki ("\r") przy użyciu następującego polecenia:</span><span class="sxs-lookup"><span data-stu-id="84b67-335">If you paste this script into vim window, make sure to remove the carriage return (‘\r”) using the following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="84b67-336">Krok 3: Edytowanie profilu itp.</span><span class="sxs-lookup"><span data-stu-id="84b67-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="84b67-337">Dołącz na końcu następujących:</span><span class="sxs-lookup"><span data-stu-id="84b67-337">Append the following at the end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="84b67-338">Krok 4: Instalacja JNA dla systemów produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="84b67-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="84b67-339">Użyj poniższej sekwencji poleceń: następujące polecenie zainstaluje jna 3.2.7.jar i jna platformy 3.2.7.jar do katalogu /usr/share.java sudo stanie get zainstalować libjna java</span><span class="sxs-lookup"><span data-stu-id="84b67-339">Use the following command sequence: The following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar to /usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="84b67-340">Utwórz łącza symbolicznego w katalogu CASS_HOME/lib $ tak, aby Cassandra uruchamiania skryptu można znaleźć te słoików:</span><span class="sxs-lookup"><span data-stu-id="84b67-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="84b67-341">Krok 5: Konfigurowanie cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="84b67-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="84b67-342">Edytuj cassandra.yaml na każdej maszynie Wirtualnej w celu uwzględnienia konfiguracji wymagane przez wszystkich maszyn wirtualnych [firma Microsoft będzie dostosować to podczas udostępniania rzeczywistego]:</span><span class="sxs-lookup"><span data-stu-id="84b67-342">Edit cassandra.yaml on each VM to reflect configuration needed by all the virtual machines [we will tweak this during the actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-343">Nazwa pola</span><span class="sxs-lookup"><span data-stu-id="84b67-343">Field Name</span></span>   </th><th> <span data-ttu-id="84b67-344">Wartość</span><span class="sxs-lookup"><span data-stu-id="84b67-344">Value</span></span>  </th><th>    <span data-ttu-id="84b67-345">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="84b67-346">nazwa_klastra</span><span class="sxs-lookup"><span data-stu-id="84b67-346">cluster_name</span></span> </td><td>    <span data-ttu-id="84b67-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="84b67-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="84b67-348">Użyj nazwy, która odzwierciedla wdrożenia</span><span class="sxs-lookup"><span data-stu-id="84b67-348">Use the name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="84b67-349">listen_address</span></span>    </td><td><span data-ttu-id="84b67-350">[pozostaw to pole puste]</span><span class="sxs-lookup"><span data-stu-id="84b67-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="84b67-351">Usuń "localhost"</span><span class="sxs-lookup"><span data-stu-id="84b67-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="84b67-352">rpc_addres</span></span>   </td><td><span data-ttu-id="84b67-353">[pozostaw to pole puste]</span><span class="sxs-lookup"><span data-stu-id="84b67-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="84b67-354">Usuń "localhost"</span><span class="sxs-lookup"><span data-stu-id="84b67-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-355">ziarna</span><span class="sxs-lookup"><span data-stu-id="84b67-355">seeds</span></span>    </td><td><span data-ttu-id="84b67-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="84b67-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="84b67-357">Lista wszystkich adresów IP, które są oznaczone jako dane.</span><span class="sxs-lookup"><span data-stu-id="84b67-357">List of  all the IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="84b67-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="84b67-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="84b67-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="84b67-360">To jest używany przez NetworkTopologyStrateg dla wnioskowanie centrum danych i stojaku maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-360">This is used by the NetworkTopologyStrateg for inferring the data center and the rack of the VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-the-vm-image"></a><span data-ttu-id="84b67-361">Krok 6: Przechwytywanie obrazu maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-361">Step 6: Capture the VM image</span></span>
<span data-ttu-id="84b67-362">Zaloguj się do maszyny wirtualnej przy użyciu nazwy hosta (hk-urzędów certyfikacji template.cloudapp.net) i klucz prywatny SSH wcześniej utworzony.</span><span class="sxs-lookup"><span data-stu-id="84b67-362">Log into the virtual machine using the hostname (hk-cas-template.cloudapp.net) and the SSH private key previously created.</span></span> <span data-ttu-id="84b67-363">Zobacz temat jak używanie SSH z systemem Linux na platformie Azure, aby uzyskać więcej informacji na temat sposobu Zaloguj się za pomocą polecenia ssh lub putty.exe.</span><span class="sxs-lookup"><span data-stu-id="84b67-363">See How to Use SSH with Linux on Azure for details on how to log in using the command ssh or putty.exe.</span></span>

<span data-ttu-id="84b67-364">Wykonania następującej akcji w celu przechwycenia obrazu:</span><span class="sxs-lookup"><span data-stu-id="84b67-364">Execute the following sequence of actions to capture the image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="84b67-365">1. Deprovision</span><span class="sxs-lookup"><span data-stu-id="84b67-365">1. Deprovision</span></span>
<span data-ttu-id="84b67-366">Użyj polecenia "sudo agenta waagent — deprovision + użytkownika" Aby usunąć określone informacje o wystąpieniu maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="84b67-366">Use the command “sudo waagent –deprovision+user” to remove Virtual Machine instance specific information.</span></span> <span data-ttu-id="84b67-367">Zobacz dla [Przechwytywanie maszyny wirtualnej systemu Linux](capture-image.md) do użycia jako szablon więcej szczegółów na temat procesu przechwytywania obrazu.</span><span class="sxs-lookup"><span data-stu-id="84b67-367">See for [How to Capture a Linux Virtual Machine](capture-image.md) to Use as a Template more details on the image capture process.</span></span>

##### <a name="2-shutdown-the-vm"></a><span data-ttu-id="84b67-368">2: Zamknij maszynę Wirtualną</span><span class="sxs-lookup"><span data-stu-id="84b67-368">2: Shutdown the VM</span></span>
<span data-ttu-id="84b67-369">Upewnij się, że maszyna wirtualna zostanie wyróżniona, a następnie kliknij łącze zamknięcia z dolnym pasku poleceń.</span><span class="sxs-lookup"><span data-stu-id="84b67-369">Make sure that the virtual machine is highlighted and click the SHUTDOWN link from the bottom command bar.</span></span>

##### <a name="3-capture-the-image"></a><span data-ttu-id="84b67-370">3: Przechwytywanie obrazu</span><span class="sxs-lookup"><span data-stu-id="84b67-370">3: Capture the image</span></span>
<span data-ttu-id="84b67-371">Upewnij się, że maszyna wirtualna zostanie wyróżniona, a następnie kliknij łącze PRZECHWYTYWANIA z dolnym pasku poleceń.</span><span class="sxs-lookup"><span data-stu-id="84b67-371">Make sure that the virtual machine is highlighted and click the CAPTURE link from the bottom command bar.</span></span> <span data-ttu-id="84b67-372">Na następnym ekranie nadaj nazwę obrazu (np. hk-cas-2-08-ub-14-04-2014071), odpowiednich opis obrazu, a następnie kliknij znacznik "wyboru", aby zakończyć proces PRZECHWYTYWANIA.</span><span class="sxs-lookup"><span data-stu-id="84b67-372">In the next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click the “check” mark to finish the CAPTURE process.</span></span>

<span data-ttu-id="84b67-373">To może zająć kilka sekund i obraz powinien być dostępny w sekcji Moje obrazy Galeria obrazów.</span><span class="sxs-lookup"><span data-stu-id="84b67-373">This will take a few seconds and the image should be available in MY IMAGES section of the image gallery.</span></span> <span data-ttu-id="84b67-374">Źródłowej maszyny Wirtualnej zostaną automatycznie usunięte pomyślnie przechwycony obraz.</span><span class="sxs-lookup"><span data-stu-id="84b67-374">The source VM will be automatically deleted after the image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="84b67-375">Proces wdrażania pojedynczy Region</span><span class="sxs-lookup"><span data-stu-id="84b67-375">Single Region Deployment Process</span></span>
<span data-ttu-id="84b67-376">**Krok 1: Utwórz sieć wirtualną** Zaloguj się do portalu Azure i utworzyć sieć wirtualną (klasyczne) z atrybutami pokazano w poniższej tabeli.</span><span class="sxs-lookup"><span data-stu-id="84b67-376">**Step 1: Create the Virtual Network** Log into the Azure portal and create a virtual network (classic) with the attributes shown in the following table.</span></span> <span data-ttu-id="84b67-377">Zobacz [Utwórz sieć wirtualną (klasyczne) przy użyciu portalu Azure](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) szczegółowy opis kroków procesu.</span><span class="sxs-lookup"><span data-stu-id="84b67-377">See [Create a virtual network (classic) using the Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of the process.</span></span>      

<table>
<tr><th><span data-ttu-id="84b67-378">Nazwa atrybutu maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-378">VM Attribute Name</span></span></th><th><span data-ttu-id="84b67-379">Wartość</span><span class="sxs-lookup"><span data-stu-id="84b67-379">Value</span></span></th><th><span data-ttu-id="84b67-380">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-381">Nazwa</span><span class="sxs-lookup"><span data-stu-id="84b67-381">Name</span></span></td><td><span data-ttu-id="84b67-382">sieć wirtualna — przypadku zachód nam</span><span class="sxs-lookup"><span data-stu-id="84b67-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="84b67-383">Region</span><span class="sxs-lookup"><span data-stu-id="84b67-383">Region</span></span></td><td><span data-ttu-id="84b67-384">Zachodnie stany USA</span><span class="sxs-lookup"><span data-stu-id="84b67-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="84b67-385">Serwery DNS</span><span class="sxs-lookup"><span data-stu-id="84b67-385">DNS Servers</span></span></td><td><span data-ttu-id="84b67-386">Brak</span><span class="sxs-lookup"><span data-stu-id="84b67-386">None</span></span></td><td><span data-ttu-id="84b67-387">Zignoruj ten komunikat, ponieważ nie używamy serwera DNS</span><span class="sxs-lookup"><span data-stu-id="84b67-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-388">Przestrzeń adresów</span><span class="sxs-lookup"><span data-stu-id="84b67-388">Address Space</span></span></td><td><span data-ttu-id="84b67-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="84b67-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="84b67-390">Uruchamianie adresu IP</span><span class="sxs-lookup"><span data-stu-id="84b67-390">Starting IP</span></span></td><td><span data-ttu-id="84b67-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="84b67-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="84b67-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="84b67-392">CIDR</span></span> </td><td><span data-ttu-id="84b67-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="84b67-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="84b67-394">Dodaj następujące podsieci:</span><span class="sxs-lookup"><span data-stu-id="84b67-394">Add the following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-395">Nazwa</span><span class="sxs-lookup"><span data-stu-id="84b67-395">Name</span></span></th><th><span data-ttu-id="84b67-396">Uruchamianie adresu IP</span><span class="sxs-lookup"><span data-stu-id="84b67-396">Starting IP</span></span></th><th><span data-ttu-id="84b67-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="84b67-397">CIDR</span></span></th><th><span data-ttu-id="84b67-398">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-399">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-399">web</span></span></td><td><span data-ttu-id="84b67-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="84b67-400">10.1.1.0</span></span></td><td><span data-ttu-id="84b67-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="84b67-401">/24 (251)</span></span></td><td><span data-ttu-id="84b67-402">Podsieć dla kolektywu serwerów sieci web</span><span class="sxs-lookup"><span data-stu-id="84b67-402">Subnet for the web farm</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-403">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-403">data</span></span></td><td><span data-ttu-id="84b67-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="84b67-404">10.1.2.0</span></span></td><td><span data-ttu-id="84b67-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="84b67-405">/24 (251)</span></span></td><td><span data-ttu-id="84b67-406">Podsieć dla węzłów bazy danych</span><span class="sxs-lookup"><span data-stu-id="84b67-406">Subnet for the database nodes</span></span></td></tr>
</table>

<span data-ttu-id="84b67-407">Dane i podsieci w sieci Web mogą być chronione przy użyciu grup zabezpieczeń sieci zakres wykracza poza zakres tego artykułu.</span><span class="sxs-lookup"><span data-stu-id="84b67-407">Data and Web subnets can be protected through network security groups the coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="84b67-408">**Krok 2: Maszyny wirtualne należy** przy użyciu obrazu utworzonego wcześniej, firma Microsoft utworzy następujące maszyny wirtualne na serwerze chmury "hk-c-svc Zachód" i powiązać je do odpowiednich podsieci, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="84b67-408">**Step 2: Provision Virtual Machines** Using the image created previously, we will create the following virtual machines in the cloud server “hk-c-svc-west” and bind them to the respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-409">Nazwa komputera</span><span class="sxs-lookup"><span data-stu-id="84b67-409">Machine Name</span></span>    </th><th><span data-ttu-id="84b67-410">Podsieć</span><span class="sxs-lookup"><span data-stu-id="84b67-410">Subnet</span></span>    </th><th><span data-ttu-id="84b67-411">Adres IP</span><span class="sxs-lookup"><span data-stu-id="84b67-411">IP Address</span></span>    </th><th><span data-ttu-id="84b67-412">Zestaw dostępności</span><span class="sxs-lookup"><span data-stu-id="84b67-412">Availability set</span></span></th><th><span data-ttu-id="84b67-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="84b67-413">DC/Rack</span></span></th><th><span data-ttu-id="84b67-414">Inicjatora?</span><span class="sxs-lookup"><span data-stu-id="84b67-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-415">HK-c1-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="84b67-416">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-416">data</span></span>    </td><td><span data-ttu-id="84b67-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="84b67-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="84b67-418">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="84b67-419">DC = stojak WESTUS = szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="84b67-420">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-421">HK-c2-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="84b67-422">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-422">data</span></span>    </td><td><span data-ttu-id="84b67-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="84b67-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="84b67-424">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="84b67-425">DC = stojak WESTUS = szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="84b67-426">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-427">HK-c3-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="84b67-428">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-428">data</span></span>    </td><td><span data-ttu-id="84b67-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="84b67-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="84b67-430">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="84b67-431">DC = stojak WESTUS = szafa2</span><span class="sxs-lookup"><span data-stu-id="84b67-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="84b67-432">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-433">HK-c4-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="84b67-434">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-434">data</span></span>    </td><td><span data-ttu-id="84b67-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="84b67-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="84b67-436">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="84b67-437">DC = stojak WESTUS = szafa2</span><span class="sxs-lookup"><span data-stu-id="84b67-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="84b67-438">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-439">HK-c5-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="84b67-440">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-440">data</span></span>    </td><td><span data-ttu-id="84b67-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="84b67-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="84b67-442">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="84b67-443">DC = stojak WESTUS = szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="84b67-444">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-445">HK-c6-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="84b67-446">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-446">data</span></span>    </td><td><span data-ttu-id="84b67-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="84b67-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="84b67-448">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="84b67-449">DC = stojak WESTUS = szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="84b67-450">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-451">HK-c7-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="84b67-452">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-452">data</span></span>    </td><td><span data-ttu-id="84b67-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="84b67-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="84b67-454">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="84b67-455">DC = stojak WESTUS = rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="84b67-456">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-457">HK-c8-zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="84b67-458">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-458">data</span></span>    </td><td><span data-ttu-id="84b67-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="84b67-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="84b67-460">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="84b67-461">DC = stojak WESTUS = rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="84b67-462">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="84b67-463">HK-w1 — zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="84b67-464">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-464">web</span></span>    </td><td><span data-ttu-id="84b67-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="84b67-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="84b67-466">HK p-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="84b67-467">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-468">HK-w2 — zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="84b67-469">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-469">web</span></span>    </td><td><span data-ttu-id="84b67-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="84b67-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="84b67-471">HK p-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="84b67-472">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="84b67-473">Utworzenie powyższej listy maszyn wirtualnych wymaga następujący proces:</span><span class="sxs-lookup"><span data-stu-id="84b67-473">Creation of the above list of VMs requires the following process:</span></span>

1. <span data-ttu-id="84b67-474">Tworzenie usługi w chmurze pusta w określonym regionie</span><span class="sxs-lookup"><span data-stu-id="84b67-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="84b67-475">Utwórz maszynę Wirtualną z wcześniej przechwycony obraz i dołączenie go do sieci wirtualnej utworzone wcześniej; Powtórz tę czynność dla wszystkich maszyn wirtualnych</span><span class="sxs-lookup"><span data-stu-id="84b67-475">Create a VM from the previously captured image and attach it to the virtual network created previously; repeat this for all the VMs</span></span>
3. <span data-ttu-id="84b67-476">Dodawanie wewnętrznego modułu równoważenia obciążenia do usługi w chmurze i dołącz je do podsieci "dane"</span><span class="sxs-lookup"><span data-stu-id="84b67-476">Add an internal load balancer to the cloud service and attach it to the “data” subnet</span></span>
4. <span data-ttu-id="84b67-477">Dla każdej maszyny Wirtualnej utworzone wcześniej Dodaj punkt końcowy równoważenia obciążenia dla ruchu thrift za pomocą zestawu o zrównoważonym obciążeniu podłączone do utworzonej wcześniej wewnętrznego modułu równoważenia obciążenia</span><span class="sxs-lookup"><span data-stu-id="84b67-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected to the previously created internal load balancer</span></span>

<span data-ttu-id="84b67-478">Proces powyżej mogą być wykonywane przy użyciu klasycznego portalu Azure; Użyj maszynę z systemem Windows (Użyj maszyny Wirtualnej na platformie Azure, jeśli nie masz dostępu do komputera z systemem Windows), umożliwia automatycznie udostępnić wszystkich maszyn wirtualnych 8 następujący skrypt programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="84b67-478">The above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access to a Windows machine), use the following PowerShell script to provision all 8 VMs automatically.</span></span>

<span data-ttu-id="84b67-479">**Lista 1: Skrypt programu PowerShell do obsługi maszyn wirtualnych**</span><span class="sxs-lookup"><span data-stu-id="84b67-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into the current Powershell session before proceeding
        #The process: 1. create Azure Storage account, 2. create virtual network, 3.create the VM template, 2. crate a list of VMs from the template

        #fundamental variables - change these to reflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores the list of azure vm configuration objects
        #create the list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add the thrift endpoint to the internal load balancer for all the VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="84b67-480">**Krok 3: Konfigurowanie Cassandra na każdej maszynie Wirtualnej**</span><span class="sxs-lookup"><span data-stu-id="84b67-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="84b67-481">Zaloguj się do maszyny Wirtualnej i wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="84b67-481">Log into the VM and perform the following:</span></span>

* <span data-ttu-id="84b67-482">Edytuj $CASS_HOME/conf/cassandra-rackdc.properties do określania właściwości stojaku i centrum danych:</span><span class="sxs-lookup"><span data-stu-id="84b67-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties to specify the data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="84b67-483">Edytuj cassandra.yaml do konfiguracji węzłów inicjatora, jak pokazano poniżej:</span><span class="sxs-lookup"><span data-stu-id="84b67-483">Edit cassandra.yaml to configure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="84b67-484">**Krok 4: Uruchom maszyn wirtualnych i przetestowanie klastra**</span><span class="sxs-lookup"><span data-stu-id="84b67-484">**Step 4: Start the VMs and test the cluster**</span></span>

<span data-ttu-id="84b67-485">Zaloguj się do jednego z węzłów (np. hk-c1-zachód us) i uruchom następujące polecenie, aby wyświetlić stan klastra:</span><span class="sxs-lookup"><span data-stu-id="84b67-485">Log into one of the nodes (e.g. hk-c1-west-us) and run the following command to see the status of the cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="84b67-486">Powinien zostać wyświetlony ekran podobny do przedstawionego poniżej 8 węzłów klastra:</span><span class="sxs-lookup"><span data-stu-id="84b67-486">You should see the display similar to the one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-487">Stan</span><span class="sxs-lookup"><span data-stu-id="84b67-487">Status</span></span></th><th><span data-ttu-id="84b67-488">Adres</span><span class="sxs-lookup"><span data-stu-id="84b67-488">Address</span></span>    </th><th><span data-ttu-id="84b67-489">Ładowanie</span><span class="sxs-lookup"><span data-stu-id="84b67-489">Load</span></span>    </th><th><span data-ttu-id="84b67-490">Tokeny</span><span class="sxs-lookup"><span data-stu-id="84b67-490">Tokens</span></span>    </th><th><span data-ttu-id="84b67-491">Właścicielem</span><span class="sxs-lookup"><span data-stu-id="84b67-491">Owns</span></span> </th><th><span data-ttu-id="84b67-492">Identyfikator hosta</span><span class="sxs-lookup"><span data-stu-id="84b67-492">Host ID</span></span>    </th><th><span data-ttu-id="84b67-493">Stojak</span><span class="sxs-lookup"><span data-stu-id="84b67-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="84b67-494">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-494">UN</span></span>    </td><td><span data-ttu-id="84b67-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="84b67-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="84b67-496">87.81 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-496">87.81 KB</span></span>    </td><td><span data-ttu-id="84b67-497">256</span><span class="sxs-lookup"><span data-stu-id="84b67-497">256</span></span>    </td><td><span data-ttu-id="84b67-498">38.0%</span><span class="sxs-lookup"><span data-stu-id="84b67-498">38.0%</span></span>    </td><td><span data-ttu-id="84b67-499">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-499">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-500">szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-501">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-501">UN</span></span>    </td><td><span data-ttu-id="84b67-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="84b67-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="84b67-503">41.08 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-503">41.08 KB</span></span>    </td><td><span data-ttu-id="84b67-504">256</span><span class="sxs-lookup"><span data-stu-id="84b67-504">256</span></span>    </td><td><span data-ttu-id="84b67-505">68.9%</span><span class="sxs-lookup"><span data-stu-id="84b67-505">68.9%</span></span>    </td><td><span data-ttu-id="84b67-506">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-506">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-507">szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-508">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-508">UN</span></span>    </td><td><span data-ttu-id="84b67-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="84b67-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="84b67-510">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-510">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-511">256</span><span class="sxs-lookup"><span data-stu-id="84b67-511">256</span></span>    </td><td><span data-ttu-id="84b67-512">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-512">68.8%</span></span>    </td><td><span data-ttu-id="84b67-513">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-513">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-514">szafa2</span><span class="sxs-lookup"><span data-stu-id="84b67-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-515">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-515">UN</span></span>    </td><td><span data-ttu-id="84b67-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="84b67-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="84b67-517">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-517">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-518">256</span><span class="sxs-lookup"><span data-stu-id="84b67-518">256</span></span>    </td><td><span data-ttu-id="84b67-519">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-519">68.8%</span></span>    </td><td><span data-ttu-id="84b67-520">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-520">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-521">szafa2</span><span class="sxs-lookup"><span data-stu-id="84b67-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-522">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-522">UN</span></span>    </td><td><span data-ttu-id="84b67-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="84b67-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="84b67-524">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-524">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-525">256</span><span class="sxs-lookup"><span data-stu-id="84b67-525">256</span></span>    </td><td><span data-ttu-id="84b67-526">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-526">68.8%</span></span>    </td><td><span data-ttu-id="84b67-527">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-527">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-528">szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-529">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-529">UN</span></span>    </td><td><span data-ttu-id="84b67-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="84b67-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="84b67-531">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-531">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-532">256</span><span class="sxs-lookup"><span data-stu-id="84b67-532">256</span></span>    </td><td><span data-ttu-id="84b67-533">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-533">68.8%</span></span>    </td><td><span data-ttu-id="84b67-534">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-534">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-535">szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-536">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-536">UN</span></span>    </td><td><span data-ttu-id="84b67-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="84b67-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="84b67-538">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-538">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-539">256</span><span class="sxs-lookup"><span data-stu-id="84b67-539">256</span></span>    </td><td><span data-ttu-id="84b67-540">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-540">68.8%</span></span>    </td><td><span data-ttu-id="84b67-541">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-541">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-542">rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="84b67-543">WYREJESTRUJ</span><span class="sxs-lookup"><span data-stu-id="84b67-543">UN</span></span>    </td><td><span data-ttu-id="84b67-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="84b67-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="84b67-545">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="84b67-545">55.29 KB</span></span>    </td><td><span data-ttu-id="84b67-546">256</span><span class="sxs-lookup"><span data-stu-id="84b67-546">256</span></span>    </td><td><span data-ttu-id="84b67-547">68.8%</span><span class="sxs-lookup"><span data-stu-id="84b67-547">68.8%</span></span>    </td><td><span data-ttu-id="84b67-548">Identyfikator GUID (usunięte)</span><span class="sxs-lookup"><span data-stu-id="84b67-548">Guid (removed)</span></span></td><td><span data-ttu-id="84b67-549">rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-549">rack4</span></span></td></tr>
</table>

## <a name="test-the-single-region-cluster"></a><span data-ttu-id="84b67-550">Przetestowanie klastra pojedynczy Region</span><span class="sxs-lookup"><span data-stu-id="84b67-550">Test the Single Region Cluster</span></span>
<span data-ttu-id="84b67-551">Aby przetestować klastra, wykonaj następujące kroki:</span><span class="sxs-lookup"><span data-stu-id="84b67-551">Use the following steps to test the cluster:</span></span>

1. <span data-ttu-id="84b67-552">Za pomocą polecenia Get-AzureInternalLoadbalancer polecenia programu Powershell, Uzyskaj adres IP wewnętrznego modułu równoważenia obciążenia (np.  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="84b67-552">Using the Powershell command Get-AzureInternalLoadbalancer commandlet, obtain the IP address of the internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="84b67-553">Poniżej przedstawiono składnię polecenia: Get-AzureLoadbalancer — ServiceName "hk — c-svc zachód us" [Wyświetla szczegóły wewnętrznego modułu równoważenia obciążenia oraz adres IP]</span><span class="sxs-lookup"><span data-stu-id="84b67-553">The syntax of the command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays the details of the internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="84b67-554">Zaloguj się do maszyny Wirtualnej (np. hk-w1 — zachód us) kolektywu serwerów sieci web przy użyciu programu Putty lub ssh</span><span class="sxs-lookup"><span data-stu-id="84b67-554">Log into the web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="84b67-555">Wykonanie $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="84b67-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="84b67-556">Aby sprawdzić, czy klaster działa, należy użyć następujących poleceń CQL:</span><span class="sxs-lookup"><span data-stu-id="84b67-556">Use the following CQL commands to verify if the cluster is working:</span></span>
   
     <span data-ttu-id="84b67-557">TWORZENIE przestrzeni KLUCZY customers_ks z REPLIKACJĄ = {"class": "SimpleStrategy", "replication_factor": 3};   UŻYJ customers_ks;   Tworzenie tabeli Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Wstaw do Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Wstaw do Customers(customer_id, firstname, lastname) wartości 2, 'Magdalena', 'Nowak';</span><span class="sxs-lookup"><span data-stu-id="84b67-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="84b67-558">Wybierz * od klientów.</span><span class="sxs-lookup"><span data-stu-id="84b67-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="84b67-559">Powinien zostać wyświetlony ekran, tak jak poniżej:</span><span class="sxs-lookup"><span data-stu-id="84b67-559">You should see a display like the one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="84b67-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="84b67-560">customer_id</span></span> </th><th> <span data-ttu-id="84b67-561">Imię</span><span class="sxs-lookup"><span data-stu-id="84b67-561">firstname</span></span> </th><th> <span data-ttu-id="84b67-562">nazwisko</span><span class="sxs-lookup"><span data-stu-id="84b67-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="84b67-563">1</span><span class="sxs-lookup"><span data-stu-id="84b67-563">1</span></span> </td><td> <span data-ttu-id="84b67-564">Jan</span><span class="sxs-lookup"><span data-stu-id="84b67-564">John</span></span> </td><td> <span data-ttu-id="84b67-565">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="84b67-566">2</span><span class="sxs-lookup"><span data-stu-id="84b67-566">2</span></span> </td><td> <span data-ttu-id="84b67-567">Magdalena</span><span class="sxs-lookup"><span data-stu-id="84b67-567">Jane</span></span> </td><td> <span data-ttu-id="84b67-568">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="84b67-569">Należy pamiętać, że przestrzeni kluczy, utworzony w kroku 4 używa SimpleStrategy z replication_factor 3.</span><span class="sxs-lookup"><span data-stu-id="84b67-569">Please note that the keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="84b67-570">SimpleStrategy jest zalecane dla pojedynczego wdrożenia Centrum natomiast NetworkTopologyStrategy danych z wielu centrów.</span><span class="sxs-lookup"><span data-stu-id="84b67-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="84b67-571">Replication_factor 3 zapewni tolerancji na wypadek awarii węzła.</span><span class="sxs-lookup"><span data-stu-id="84b67-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="84b67-572"><a id="tworegion"></a>Proces w przypadku wdrażania</span><span class="sxs-lookup"><span data-stu-id="84b67-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="84b67-573">Zostanie korzystaj z wdrożenia pojedynczego obszaru ukończone i powtórz ten sam proces instalacji drugiego region.</span><span class="sxs-lookup"><span data-stu-id="84b67-573">Will leverage the single region deployment completed and repeat the same process for installing the second region.</span></span> <span data-ttu-id="84b67-574">Klucza różnica między wdrażania jednego lub wielu region jest instalację tunelu sieci VPN na potrzeby komunikacji między regionu; Firma Microsoft będzie rozpoczynać się od instalacji sieciowej, obsługi administracyjnej maszyn wirtualnych i skonfiguruj Cassandra.</span><span class="sxs-lookup"><span data-stu-id="84b67-574">The key difference between the single and multiple region deployment is the VPN tunnel setup for inter-region communication; we will start with the network installation, provision the VMs and configure Cassandra.</span></span>

### <a name="step-1-create-the-virtual-network-at-the-2nd-region"></a><span data-ttu-id="84b67-575">Krok 1: Utwórz sieć wirtualną w regionie 2</span><span class="sxs-lookup"><span data-stu-id="84b67-575">Step 1: Create the Virtual Network at the 2nd Region</span></span>
<span data-ttu-id="84b67-576">Zaloguj się do klasycznego portalu Azure i utworzyć sieć wirtualną z programem atrybutów w tabeli.</span><span class="sxs-lookup"><span data-stu-id="84b67-576">Log into the Azure classic portal and create a Virtual Network with the attributes show in the table.</span></span> <span data-ttu-id="84b67-577">Zobacz [skonfigurować sieć wirtualną Cloud-Only w klasycznym portalu Azure](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) szczegółowy opis kroków procesu.</span><span class="sxs-lookup"><span data-stu-id="84b67-577">See [Configure a Cloud-Only Virtual Network in the Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of the process.</span></span>      

<table>
<tr><th><span data-ttu-id="84b67-578">Nazwa atrybutu</span><span class="sxs-lookup"><span data-stu-id="84b67-578">Attribute Name</span></span>    </th><th><span data-ttu-id="84b67-579">Wartość</span><span class="sxs-lookup"><span data-stu-id="84b67-579">Value</span></span>    </th><th><span data-ttu-id="84b67-580">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-581">Nazwa</span><span class="sxs-lookup"><span data-stu-id="84b67-581">Name</span></span>    </td><td><span data-ttu-id="84b67-582">sieci wirtualnej przypadku wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="84b67-583">Region</span><span class="sxs-lookup"><span data-stu-id="84b67-583">Region</span></span>    </td><td><span data-ttu-id="84b67-584">Wschodnie stany USA</span><span class="sxs-lookup"><span data-stu-id="84b67-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="84b67-585">Serwery DNS</span><span class="sxs-lookup"><span data-stu-id="84b67-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="84b67-586">Zignoruj ten komunikat, ponieważ nie używamy serwera DNS</span><span class="sxs-lookup"><span data-stu-id="84b67-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-587">Konfigurowanie sieci VPN punkt lokacja</span><span class="sxs-lookup"><span data-stu-id="84b67-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="84b67-588">Zignoruj ten komunikat</span><span class="sxs-lookup"><span data-stu-id="84b67-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-589">Konfiguracja tunelu sieci VPN łączącego lokacje</span><span class="sxs-lookup"><span data-stu-id="84b67-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="84b67-590">Zignoruj ten komunikat</span><span class="sxs-lookup"><span data-stu-id="84b67-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-591">Przestrzeń adresów</span><span class="sxs-lookup"><span data-stu-id="84b67-591">Address Space</span></span>    </td><td><span data-ttu-id="84b67-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="84b67-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="84b67-593">Uruchamianie adresu IP</span><span class="sxs-lookup"><span data-stu-id="84b67-593">Starting IP</span></span>    </td><td><span data-ttu-id="84b67-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="84b67-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="84b67-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="84b67-595">CIDR</span></span>    </td><td><span data-ttu-id="84b67-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="84b67-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="84b67-597">Dodaj następujące podsieci:</span><span class="sxs-lookup"><span data-stu-id="84b67-597">Add the following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-598">Nazwa</span><span class="sxs-lookup"><span data-stu-id="84b67-598">Name</span></span>    </th><th><span data-ttu-id="84b67-599">Uruchamianie adresu IP</span><span class="sxs-lookup"><span data-stu-id="84b67-599">Starting IP</span></span>    </th><th><span data-ttu-id="84b67-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="84b67-600">CIDR</span></span>    </th><th><span data-ttu-id="84b67-601">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-602">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-602">web</span></span>    </td><td><span data-ttu-id="84b67-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="84b67-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="84b67-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="84b67-604">/24 (251)</span></span>    </td><td><span data-ttu-id="84b67-605">Podsieć dla kolektywu serwerów sieci web</span><span class="sxs-lookup"><span data-stu-id="84b67-605">Subnet for the web farm</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-606">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-606">data</span></span>    </td><td><span data-ttu-id="84b67-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="84b67-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="84b67-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="84b67-608">/24 (251)</span></span>    </td><td><span data-ttu-id="84b67-609">Podsieć dla węzłów bazy danych</span><span class="sxs-lookup"><span data-stu-id="84b67-609">Subnet for the database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="84b67-610">Krok 2: Tworzenie sieci lokalne</span><span class="sxs-lookup"><span data-stu-id="84b67-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="84b67-611">Sieci lokalnej w sieci wirtualnej platformy Azure jest przestrzeń adresów serwera proxy, która mapuje z lokacją zdalną, w tym chmurę prywatną lub inny region platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="84b67-611">A Local Network in Azure virtual networking is a proxy address space that maps to a remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="84b67-612">Ta przestrzeń adresowa serwera proxy jest powiązany z bramy zdalnego routingu sieci do prawej sieci miejsc docelowych.</span><span class="sxs-lookup"><span data-stu-id="84b67-612">This proxy address space is bound to a remote gateway for routing network to the right networking destinations.</span></span> <span data-ttu-id="84b67-613">Zobacz [Konfigurowanie sieci wirtualnej do sieci wirtualnej połączenia](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) instrukcje dotyczące nawiązywania połączenia do Wirtualnymi.</span><span class="sxs-lookup"><span data-stu-id="84b67-613">See [Configure a VNet to VNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for the instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="84b67-614">Utwórz dwie sieci lokalne na następujące informacje:</span><span class="sxs-lookup"><span data-stu-id="84b67-614">Create two local networks per the following details:</span></span>

| <span data-ttu-id="84b67-615">Nazwa sieci</span><span class="sxs-lookup"><span data-stu-id="84b67-615">Network Name</span></span> | <span data-ttu-id="84b67-616">Adres bramy sieci VPN</span><span class="sxs-lookup"><span data-stu-id="84b67-616">VPN Gateway Address</span></span> | <span data-ttu-id="84b67-617">Przestrzeń adresów</span><span class="sxs-lookup"><span data-stu-id="84b67-617">Address Space</span></span> | <span data-ttu-id="84b67-618">Uwagi</span><span class="sxs-lookup"><span data-stu-id="84b67-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="84b67-619">HK-lnet-map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="84b67-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="84b67-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="84b67-620">23.1.1.1</span></span> |<span data-ttu-id="84b67-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="84b67-621">10.2.0.0/16</span></span> |<span data-ttu-id="84b67-622">Podczas tworzenia sieci lokalnej do symbolu zastępczego adres bramy.</span><span class="sxs-lookup"><span data-stu-id="84b67-622">While creating the Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="84b67-623">Adres bramy rzeczywistych jest wypełniony, po utworzeniu bramy.</span><span class="sxs-lookup"><span data-stu-id="84b67-623">The real gateway address is filled once the gateway is created.</span></span> <span data-ttu-id="84b67-624">Upewnij się, że przestrzeń adresowa dokładnie odpowiada odpowiednich zdalna sieć wirtualna; w takim przypadku w regionie wschodnie stany USA utworzona sieć wirtualna.</span><span class="sxs-lookup"><span data-stu-id="84b67-624">Make sure the address space exactly matches the respective remote VNET; in this case the VNET created in the East US region.</span></span> |
| <span data-ttu-id="84b67-625">HK-lnet-map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="84b67-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="84b67-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="84b67-626">23.2.2.2</span></span> |<span data-ttu-id="84b67-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="84b67-627">10.1.0.0/16</span></span> |<span data-ttu-id="84b67-628">Podczas tworzenia sieci lokalnej do symbolu zastępczego adres bramy.</span><span class="sxs-lookup"><span data-stu-id="84b67-628">While creating the Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="84b67-629">Adres bramy rzeczywistych jest wypełniony, po utworzeniu bramy.</span><span class="sxs-lookup"><span data-stu-id="84b67-629">The real gateway address is filled once the gateway is created.</span></span> <span data-ttu-id="84b67-630">Upewnij się, że przestrzeń adresowa dokładnie odpowiada odpowiednich zdalna sieć wirtualna; w takim przypadku utworzona sieć wirtualna regionu zachodnie stany USA.</span><span class="sxs-lookup"><span data-stu-id="84b67-630">Make sure the address space exactly matches the respective remote VNET; in this case the VNET created in the West US region.</span></span> |

### <a name="step-3-map-local-network-to-the-respective-vnets"></a><span data-ttu-id="84b67-631">Krok 3: Sieć "Lokalnie" mapy do odpowiednich sieci wirtualnych</span><span class="sxs-lookup"><span data-stu-id="84b67-631">Step 3: Map “Local” network to the respective VNETs</span></span>
<span data-ttu-id="84b67-632">W klasycznym portalu Azure wybierz każdej sieci wirtualnej, kliknij przycisk "Konfiguruj" Sprawdź "Połącz z sieci lokalnej" i wybierz sieci lokalnej na następujące informacje:</span><span class="sxs-lookup"><span data-stu-id="84b67-632">From the Azure classic portal, select each vnet, click “Configure”, check “Connect to the local network”, and select the Local Networks per the following details:</span></span>

| <span data-ttu-id="84b67-633">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="84b67-633">Virtual Network</span></span> | <span data-ttu-id="84b67-634">Sieci lokalnej</span><span class="sxs-lookup"><span data-stu-id="84b67-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="84b67-635">HK — sieci wirtualnej zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-635">hk-vnet-west-us</span></span> |<span data-ttu-id="84b67-636">HK-lnet-map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="84b67-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="84b67-637">HK — sieci wirtualnej wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-637">hk-vnet-east-us</span></span> |<span data-ttu-id="84b67-638">HK-lnet-map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="84b67-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="84b67-639">Krok 4: Tworzenie bramy na VNET1 i VNET2</span><span class="sxs-lookup"><span data-stu-id="84b67-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="84b67-640">Z poziomu pulpitu nawigacyjnego sieci wirtualnych kliknij przycisk Utwórz bramy, które wyzwoli bramy sieci VPN, w procesie inicjowania obsługi.</span><span class="sxs-lookup"><span data-stu-id="84b67-640">From the dashboard of both the virtual networks, click CREATE GATEWAY which will trigger the VPN gateway provisioning process.</span></span> <span data-ttu-id="84b67-641">Po kilku minutach adres bramy rzeczywiste powinien być wyświetlany pulpit nawigacyjny w każdej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="84b67-641">After a few minutes the dashboard of each virtual network should display the actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-the-respective-gateway-addresses"></a><span data-ttu-id="84b67-642">Krok 5: Aktualizacji "Lokalnie" sieci z adresami odpowiednich "brama"</span><span class="sxs-lookup"><span data-stu-id="84b67-642">Step 5: Update “Local” networks with the respective “Gateway” addresses</span></span>
<span data-ttu-id="84b67-643">Edytuj zarówno lokalnej sieci należy zastąpić adres IP bramy symbol zastępczy adres IP rzeczywista właśnie elastycznie bramy.</span><span class="sxs-lookup"><span data-stu-id="84b67-643">Edit both the local networks to replace the placeholder gateway IP address with the real IP address of the just provisioned gateways.</span></span> <span data-ttu-id="84b67-644">Użyj następującego mapowania:</span><span class="sxs-lookup"><span data-stu-id="84b67-644">Use the following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="84b67-645">Sieci lokalnej</span><span class="sxs-lookup"><span data-stu-id="84b67-645">Local Network</span></span>    </th><th><span data-ttu-id="84b67-646">Brama sieci wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="84b67-647">HK-lnet-map-to-East-US</span><span class="sxs-lookup"><span data-stu-id="84b67-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="84b67-648">Brama hk — sieci wirtualnej zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="84b67-649">HK-lnet-map-to-West-US</span><span class="sxs-lookup"><span data-stu-id="84b67-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="84b67-650">Brama hk — sieci wirtualnej wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-the-shared-key"></a><span data-ttu-id="84b67-651">Krok 6: Zaktualizuj klucza wspólnego</span><span class="sxs-lookup"><span data-stu-id="84b67-651">Step 6: Update the shared key</span></span>
<span data-ttu-id="84b67-652">Użyj następującego skryptu programu Powershell można zaktualizować klucza IPSec każdej bramy sieci VPN [Użyj klucza sake dla obu bram]: Set AzureVNetGatewayKey - VNetName hk — sieci wirtualnej wschód us - LocalNetworkSiteName hk-lnet-map-to-west-us - SharedKey D9E76BKK Zestaw AzureVNetGatewayKey - VNetName hk — sieci wirtualnej zachód us - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="84b67-652">Use the following Powershell script to update the IPSec key of each VPN gateway [use the sake key for both the gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-the-vnet-to-vnet-connection"></a><span data-ttu-id="84b67-653">Krok 7: Nawiązania połączenia do Wirtualnymi</span><span class="sxs-lookup"><span data-stu-id="84b67-653">Step 7: Establish the VNET-to-VNET connection</span></span>
<span data-ttu-id="84b67-654">Z klasycznego portalu Azure użyj menu "Pulpitu NAWIGACYJNEGO" sieci wirtualnej do ustanawiania połączenia brama brama.</span><span class="sxs-lookup"><span data-stu-id="84b67-654">From the Azure classic portal, use the “DASHBOARD” menu of both the virtual networks to establish gateway-to-gateway connection.</span></span> <span data-ttu-id="84b67-655">Używanie elementów menu "POŁĄCZ" w dolnym pasku narzędzi.</span><span class="sxs-lookup"><span data-stu-id="84b67-655">Use the “CONNECT” menu items in the bottom toolbar.</span></span> <span data-ttu-id="84b67-656">Po kilku minutach pulpitu nawigacyjnego powinien być wyświetlany szczegóły połączenia graficznie.</span><span class="sxs-lookup"><span data-stu-id="84b67-656">After a few minutes the dashboard should display the connection details graphically.</span></span>

### <a name="step-8-create-the-virtual-machines-in-region-2"></a><span data-ttu-id="84b67-657">Krok 8: Tworzenie maszyn wirtualnych w regionie #2</span><span class="sxs-lookup"><span data-stu-id="84b67-657">Step 8: Create the virtual machines in region #2</span></span>
<span data-ttu-id="84b67-658">Utwórz obraz Ubuntu zgodnie z opisem w regionie #1 wdrożenia, wykonując kroki tego samego lub kopiowania pliku obrazu dysku VHD do konta magazynu Azure znajduje się w regionie #2 a obrazu.</span><span class="sxs-lookup"><span data-stu-id="84b67-658">Create the Ubuntu image as described in region #1 deployment by following the same steps or copy the image VHD file to the Azure storage account located in region #2 and create the image.</span></span> <span data-ttu-id="84b67-659">Skorzystaj z tego obrazu i Utwórz następującą listę maszyn wirtualnych do nowej usługi w chmurze hk-c-svc wschód nam:</span><span class="sxs-lookup"><span data-stu-id="84b67-659">Use this image and create the following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="84b67-660">Nazwa komputera</span><span class="sxs-lookup"><span data-stu-id="84b67-660">Machine Name</span></span> | <span data-ttu-id="84b67-661">Podsieć</span><span class="sxs-lookup"><span data-stu-id="84b67-661">Subnet</span></span> | <span data-ttu-id="84b67-662">Adres IP</span><span class="sxs-lookup"><span data-stu-id="84b67-662">IP Address</span></span> | <span data-ttu-id="84b67-663">Zestaw dostępności</span><span class="sxs-lookup"><span data-stu-id="84b67-663">Availability set</span></span> | <span data-ttu-id="84b67-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="84b67-664">DC/Rack</span></span> | <span data-ttu-id="84b67-665">Inicjatora?</span><span class="sxs-lookup"><span data-stu-id="84b67-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="84b67-666">HK-c1-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-666">hk-c1-east-us</span></span> |<span data-ttu-id="84b67-667">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-667">data</span></span> |<span data-ttu-id="84b67-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="84b67-668">10.2.2.4</span></span> |<span data-ttu-id="84b67-669">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-669">hk-c-aset-1</span></span> |<span data-ttu-id="84b67-670">DC = stojak EASTUS = szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="84b67-671">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-671">Yes</span></span> |
| <span data-ttu-id="84b67-672">HK-c2-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-672">hk-c2-east-us</span></span> |<span data-ttu-id="84b67-673">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-673">data</span></span> |<span data-ttu-id="84b67-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="84b67-674">10.2.2.5</span></span> |<span data-ttu-id="84b67-675">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-675">hk-c-aset-1</span></span> |<span data-ttu-id="84b67-676">DC = stojak EASTUS = szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="84b67-677">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-677">No</span></span> |
| <span data-ttu-id="84b67-678">HK-c3-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-678">hk-c3-east-us</span></span> |<span data-ttu-id="84b67-679">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-679">data</span></span> |<span data-ttu-id="84b67-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="84b67-680">10.2.2.6</span></span> |<span data-ttu-id="84b67-681">HK-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-681">hk-c-aset-1</span></span> |<span data-ttu-id="84b67-682">DC = stojak EASTUS = szafa2</span><span class="sxs-lookup"><span data-stu-id="84b67-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="84b67-683">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-683">Yes</span></span> |
| <span data-ttu-id="84b67-684">HK-c5-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-684">hk-c5-east-us</span></span> |<span data-ttu-id="84b67-685">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-685">data</span></span> |<span data-ttu-id="84b67-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="84b67-686">10.2.2.8</span></span> |<span data-ttu-id="84b67-687">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-687">hk-c-aset-2</span></span> |<span data-ttu-id="84b67-688">DC = stojak EASTUS = szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="84b67-689">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-689">Yes</span></span> |
| <span data-ttu-id="84b67-690">HK-c6-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-690">hk-c6-east-us</span></span> |<span data-ttu-id="84b67-691">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-691">data</span></span> |<span data-ttu-id="84b67-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="84b67-692">10.2.2.9</span></span> |<span data-ttu-id="84b67-693">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-693">hk-c-aset-2</span></span> |<span data-ttu-id="84b67-694">DC = stojak EASTUS = szafa3</span><span class="sxs-lookup"><span data-stu-id="84b67-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="84b67-695">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-695">No</span></span> |
| <span data-ttu-id="84b67-696">HK-c7-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-696">hk-c7-east-us</span></span> |<span data-ttu-id="84b67-697">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-697">data</span></span> |<span data-ttu-id="84b67-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="84b67-698">10.2.2.10</span></span> |<span data-ttu-id="84b67-699">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-699">hk-c-aset-2</span></span> |<span data-ttu-id="84b67-700">DC = stojak EASTUS = rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="84b67-701">Tak</span><span class="sxs-lookup"><span data-stu-id="84b67-701">Yes</span></span> |
| <span data-ttu-id="84b67-702">HK-c8-wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-702">hk-c8-east-us</span></span> |<span data-ttu-id="84b67-703">Dane</span><span class="sxs-lookup"><span data-stu-id="84b67-703">data</span></span> |<span data-ttu-id="84b67-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="84b67-704">10.2.2.11</span></span> |<span data-ttu-id="84b67-705">HK-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="84b67-705">hk-c-aset-2</span></span> |<span data-ttu-id="84b67-706">DC = stojak EASTUS = rack4</span><span class="sxs-lookup"><span data-stu-id="84b67-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="84b67-707">Nie</span><span class="sxs-lookup"><span data-stu-id="84b67-707">No</span></span> |
| <span data-ttu-id="84b67-708">HK-w1 — wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-708">hk-w1-east-us</span></span> |<span data-ttu-id="84b67-709">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-709">web</span></span> |<span data-ttu-id="84b67-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="84b67-710">10.2.1.4</span></span> |<span data-ttu-id="84b67-711">HK p-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-711">hk-w-aset-1</span></span> |<span data-ttu-id="84b67-712">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-712">N/A</span></span> |<span data-ttu-id="84b67-713">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-713">N/A</span></span> |
| <span data-ttu-id="84b67-714">HK-w2 — wschód us</span><span class="sxs-lookup"><span data-stu-id="84b67-714">hk-w2-east-us</span></span> |<span data-ttu-id="84b67-715">sieci Web</span><span class="sxs-lookup"><span data-stu-id="84b67-715">web</span></span> |<span data-ttu-id="84b67-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="84b67-716">10.2.1.5</span></span> |<span data-ttu-id="84b67-717">HK p-aset-1</span><span class="sxs-lookup"><span data-stu-id="84b67-717">hk-w-aset-1</span></span> |<span data-ttu-id="84b67-718">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-718">N/A</span></span> |<span data-ttu-id="84b67-719">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="84b67-719">N/A</span></span> |

<span data-ttu-id="84b67-720">Postępuj zgodnie z instrukcjami region #1, ale użyj 10.2.xxx.xxx przestrzeni adresowej.</span><span class="sxs-lookup"><span data-stu-id="84b67-720">Follow the same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="84b67-721">Krok 9: Konfigurowanie Cassandra na każdej maszynie Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="84b67-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="84b67-722">Zaloguj się do maszyny Wirtualnej i wykonaj następujące czynności:</span><span class="sxs-lookup"><span data-stu-id="84b67-722">Log into the VM and perform the following:</span></span>

1. <span data-ttu-id="84b67-723">Edytuj $CASS_HOME/conf/cassandra-rackdc.properties do określania właściwości stojaku i centrum danych w formacie: dc = stojak EASTUS = szafa1</span><span class="sxs-lookup"><span data-stu-id="84b67-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties to specify the data center and rack properties in the format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="84b67-724">Edytuj cassandra.yaml do konfigurowania węzłów inicjatora: ziarna: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="84b67-724">Edit cassandra.yaml to configure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="84b67-725">Krok 10: Uruchom Cassandra</span><span class="sxs-lookup"><span data-stu-id="84b67-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="84b67-726">Zaloguj się do każdej maszyny Wirtualnej i uruchom Cassandra w tle, uruchamiając następujące polecenie: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="84b67-726">Log into each VM and start Cassandra in the background by running the following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-the-multi-region-cluster"></a><span data-ttu-id="84b67-727">Przetestowanie klastra w przypadku</span><span class="sxs-lookup"><span data-stu-id="84b67-727">Test the Multi-Region Cluster</span></span>
<span data-ttu-id="84b67-728">Już Cassandra została wdrożona do 16 węzłów o 8 węzłów w każdym regionie Azure.</span><span class="sxs-lookup"><span data-stu-id="84b67-728">By now Cassandra has been deployed to 16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="84b67-729">Te węzły znajdują się w tym samym klastrze z wspólnej nazwy klastra i konfiguracja węzła inicjatora.</span><span class="sxs-lookup"><span data-stu-id="84b67-729">These nodes are in the same cluster by virtue of the common cluster name and the seed node configuration.</span></span> <span data-ttu-id="84b67-730">Aby przetestować klastra, należy wykonać poniższe czynności:</span><span class="sxs-lookup"><span data-stu-id="84b67-730">Use the following process to test the cluster:</span></span>

### <a name="step-1-get-the-internal-load-balancer-ip-for-both-the-regions-using-powershell"></a><span data-ttu-id="84b67-731">Krok 1: Uzyskiwanie adresu IP usługi równoważenia obciążenia wewnętrznego dla regionów przy użyciu programu PowerShell</span><span class="sxs-lookup"><span data-stu-id="84b67-731">Step 1: Get the internal load balancer IP for both the regions using PowerShell</span></span>
* <span data-ttu-id="84b67-732">Get-AzureInternalLoadbalancer - ServiceName "hk — c-svc zachód us"</span><span class="sxs-lookup"><span data-stu-id="84b67-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="84b67-733">Get-AzureInternalLoadbalancer - ServiceName "hk — c-svc wschód us"</span><span class="sxs-lookup"><span data-stu-id="84b67-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="84b67-734">Należy zwrócić uwagę na adresy IP (np. - 10.1.2.101, wschód - zachód 10.2.2.101) wyświetlane.</span><span class="sxs-lookup"><span data-stu-id="84b67-734">Note the IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-the-following-in-the-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="84b67-735">Krok 2: Wykonaj następujące czynności w regionie Zachód po zalogowaniu w hk-w1 — zachód us</span><span class="sxs-lookup"><span data-stu-id="84b67-735">Step 2: Execute the following in the west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="84b67-736">Wykonanie $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="84b67-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="84b67-737">Uruchom następujące polecenia CQL:</span><span class="sxs-lookup"><span data-stu-id="84b67-737">Execute the following CQL commands:</span></span>
   
     <span data-ttu-id="84b67-738">TWORZENIE przestrzeni KLUCZY customers_ks z REPLIKACJĄ = {"class": "NetworkToplogyStrategy", "WESTUS": 3, EASTUS: 3};   UŻYJ customers_ks;   Tworzenie tabeli Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Wstaw do Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Wstaw do Customers(customer_id, firstname, lastname) wartości 2, 'Magdalena', 'Nowak';   Wybierz * od klientów.</span><span class="sxs-lookup"><span data-stu-id="84b67-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="84b67-739">Powinien zostać wyświetlony ekran, tak jak poniżej:</span><span class="sxs-lookup"><span data-stu-id="84b67-739">You should see a display like the one below:</span></span>

| <span data-ttu-id="84b67-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="84b67-740">customer_id</span></span> | <span data-ttu-id="84b67-741">Imię</span><span class="sxs-lookup"><span data-stu-id="84b67-741">firstname</span></span> | <span data-ttu-id="84b67-742">nazwisko</span><span class="sxs-lookup"><span data-stu-id="84b67-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="84b67-743">1</span><span class="sxs-lookup"><span data-stu-id="84b67-743">1</span></span> |<span data-ttu-id="84b67-744">Jan</span><span class="sxs-lookup"><span data-stu-id="84b67-744">John</span></span> |<span data-ttu-id="84b67-745">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-745">Doe</span></span> |
| <span data-ttu-id="84b67-746">2</span><span class="sxs-lookup"><span data-stu-id="84b67-746">2</span></span> |<span data-ttu-id="84b67-747">Magdalena</span><span class="sxs-lookup"><span data-stu-id="84b67-747">Jane</span></span> |<span data-ttu-id="84b67-748">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-748">Doe</span></span> |

### <a name="step-3-execute-the-following-in-the-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="84b67-749">Krok 3: Wykonaj następujące czynności w regionie wschodnie po zalogowaniu w hk-w1 — wschód us:</span><span class="sxs-lookup"><span data-stu-id="84b67-749">Step 3: Execute the following in the east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="84b67-750">Wykonanie $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="84b67-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="84b67-751">Uruchom następujące polecenia CQL:</span><span class="sxs-lookup"><span data-stu-id="84b67-751">Execute the following CQL commands:</span></span>
   
     <span data-ttu-id="84b67-752">UŻYJ customers_ks;   Tworzenie tabeli Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Wstaw do Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   Wstaw do Customers(customer_id, firstname, lastname) wartości 2, 'Magdalena', 'Nowak';   Wybierz * od klientów.</span><span class="sxs-lookup"><span data-stu-id="84b67-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="84b67-753">Wyświetlanie tego samego powinny być widoczne, widziany dla regionu zachodnie:</span><span class="sxs-lookup"><span data-stu-id="84b67-753">You should see the same display as seen for the West region:</span></span>

| <span data-ttu-id="84b67-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="84b67-754">customer_id</span></span> | <span data-ttu-id="84b67-755">Imię</span><span class="sxs-lookup"><span data-stu-id="84b67-755">firstname</span></span> | <span data-ttu-id="84b67-756">nazwisko</span><span class="sxs-lookup"><span data-stu-id="84b67-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="84b67-757">1</span><span class="sxs-lookup"><span data-stu-id="84b67-757">1</span></span> |<span data-ttu-id="84b67-758">Jan</span><span class="sxs-lookup"><span data-stu-id="84b67-758">John</span></span> |<span data-ttu-id="84b67-759">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-759">Doe</span></span> |
| <span data-ttu-id="84b67-760">2</span><span class="sxs-lookup"><span data-stu-id="84b67-760">2</span></span> |<span data-ttu-id="84b67-761">Magdalena</span><span class="sxs-lookup"><span data-stu-id="84b67-761">Jane</span></span> |<span data-ttu-id="84b67-762">Nowak</span><span class="sxs-lookup"><span data-stu-id="84b67-762">Doe</span></span> |

<span data-ttu-id="84b67-763">Wykonaj kilka więcej operacji wstawienia i zobacz, czy te replikowane Zachodnie-us, które są częścią klastra.</span><span class="sxs-lookup"><span data-stu-id="84b67-763">Execute a few more inserts and see that those get replicated to west-us part of the cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="84b67-764">Testowanie Cassandra klastra w oprogramowaniu Node.js</span><span class="sxs-lookup"><span data-stu-id="84b67-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="84b67-765">Przy użyciu jednej z maszyn wirtualnych systemu Linux utworzone w "web" warstwy wcześniej, firma Microsoft będzie wykonywał prostego skryptu Node.js odczytać wcześniej wstawionych danych</span><span class="sxs-lookup"><span data-stu-id="84b67-765">Using one of the Linux VMs crated in the "web" tier previously, we will execute a simple Node.js script to read the previously inserted data</span></span>

<span data-ttu-id="84b67-766">**Krok 1: Instalacja klienta Cassandra i Node.js**</span><span class="sxs-lookup"><span data-stu-id="84b67-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="84b67-767">Instalowanie środowiska Node.js i npm</span><span class="sxs-lookup"><span data-stu-id="84b67-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="84b67-768">Instalowanie pakietu "cassandra klienta w węźle" za pomocą programu npm</span><span class="sxs-lookup"><span data-stu-id="84b67-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="84b67-769">Uruchom następujący skrypt w wierszu polecenia powłoki, który zawiera ciąg json pobrane dane:</span><span class="sxs-lookup"><span data-stu-id="84b67-769">Execute the following script at the shell prompt which displays the json string of the retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed to create Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed to create column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert the record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read the two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue the code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="84b67-770">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="84b67-770">Conclusion</span></span>
<span data-ttu-id="84b67-771">Microsoft Azure to elastyczna platforma, która umożliwia uruchamianie zarówno firmy Microsoft, jak i oprogramowanie typu open source, jak zostało to pokazane w tym ćwiczeniu.</span><span class="sxs-lookup"><span data-stu-id="84b67-771">Microsoft Azure is a flexible platform that allows the running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="84b67-772">Klastry Cassandra wysokiej dostępności można wdrożyć na jednego centrum danych przez rozłożenie węzły klastra w wielu domenach awarii.</span><span class="sxs-lookup"><span data-stu-id="84b67-772">Highly available Cassandra clusters can be deployed on a single data center through the spreading of the cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="84b67-773">Klastry Cassandra można także wdrożyć w różnych regionach platformy Azure odległymi geograficznie systemów potwierdzającego po awarii.</span><span class="sxs-lookup"><span data-stu-id="84b67-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="84b67-774">Azure i Cassandra razem umożliwia konstruowanie wysoce skalowalną, wysokiej dostępności i usługi w chmurze możliwych do odzyskania po awarii wymagane przez internet współczesnych skalowania usług.</span><span class="sxs-lookup"><span data-stu-id="84b67-774">Azure and Cassandra together enables the construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="84b67-775">Dokumentacja</span><span class="sxs-lookup"><span data-stu-id="84b67-775">References</span></span>
* [<span data-ttu-id="84b67-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="84b67-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="84b67-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="84b67-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="84b67-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="84b67-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

