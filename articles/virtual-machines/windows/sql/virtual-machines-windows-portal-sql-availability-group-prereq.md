---
title: "Grupy dostępności programu SQL Server — maszyn wirtualnych platformy Azure — wymagania wstępne | Dokumentacja firmy Microsoft"
description: "W tym samouczku przedstawiono sposób konfigurowania wymagań wstępnych dotyczących tworzenia grupy dostępności programu SQL Server AlwaysOn na maszynach wirtualnych Azure."
services: virtual-machines
documentationCenter: na
authors: MikeRayMSFT
manager: jhubbard
editor: monicar
tags: azure-service-management
ms.assetid: c492db4c-3faa-4645-849f-5a1a663be55a
ms.service: virtual-machines-sql
ms.devlang: na
ms.custom: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/09/2017
ms.author: mikeray
ms.openlocfilehash: 3d508877928e033f24dae62c1042745ea7250033
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 08/29/2017
---
# <a name="complete-the-prerequisites-for-creating-always-on-availability-groups-on-azure-virtual-machines"></a><span data-ttu-id="ba780-103">Spełnić wymagania wstępne dotyczące tworzenia zawsze włączonych grup dostępności na maszynach wirtualnych Azure</span><span class="sxs-lookup"><span data-stu-id="ba780-103">Complete the prerequisites for creating Always On availability groups on Azure virtual machines</span></span>

<span data-ttu-id="ba780-104">W tym samouczku przedstawiono sposób spełnić wymagania wstępne dotyczące tworzenia [programu SQL Server zawsze włączone grupy dostępności na maszynach wirtualnych platformy Azure (VM)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="ba780-104">This tutorial shows how to complete the prerequisites for creating a [SQL Server Always On availability group on Azure virtual machines (VMs)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span></span> <span data-ttu-id="ba780-105">Po zakończeniu wymagania wstępne są kontrolera domeny, dwóch maszyn wirtualnych programu SQL Server i serwer monitora w pojedynczej grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-105">When you've finished the prerequisites, you have a domain controller, two SQL Server VMs, and a witness server in a single resource group.</span></span>

<span data-ttu-id="ba780-106">**Szacowanie czasu**: może potrwać kilka godzin, aby spełnić wymagania wstępne.</span><span class="sxs-lookup"><span data-stu-id="ba780-106">**Time estimate**: It might take a couple of hours to complete the prerequisites.</span></span> <span data-ttu-id="ba780-107">Większość tego czasu jest spędzana na tworzenie maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="ba780-107">Much of this time is spent creating virtual machines.</span></span>

<span data-ttu-id="ba780-108">Na poniższym diagramie przedstawiono kompilacji w samouczku.</span><span class="sxs-lookup"><span data-stu-id="ba780-108">The following diagram illustrates what you build in the tutorial.</span></span>

![Grupy dostępności](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/00-EndstateSampleNoELB.png)

## <a name="review-availability-group-documentation"></a><span data-ttu-id="ba780-110">Przejrzyj dokumentację grupy dostępności</span><span class="sxs-lookup"><span data-stu-id="ba780-110">Review availability group documentation</span></span>

<span data-ttu-id="ba780-111">Ten samouczek zakłada, że masz podstawową wiedzę na temat programu SQL Server zawsze włączonych grup dostępności.</span><span class="sxs-lookup"><span data-stu-id="ba780-111">This tutorial assumes that you have a basic understanding of SQL Server Always On availability groups.</span></span> <span data-ttu-id="ba780-112">Jeśli nie masz doświadczenia w obsłudze tej technologii, zobacz [Omówienie programu zawsze włączonych grup dostępności (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span><span class="sxs-lookup"><span data-stu-id="ba780-112">If you're not familiar with this technology, see [Overview of Always On Availability Groups (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span></span>


## <a name="create-an-azure-account"></a><span data-ttu-id="ba780-113">Utwórz konto systemu Azure</span><span class="sxs-lookup"><span data-stu-id="ba780-113">Create an Azure account</span></span>
<span data-ttu-id="ba780-114">Musisz mieć konto platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-114">You need an Azure account.</span></span> <span data-ttu-id="ba780-115">Możesz [Załóż bezpłatne konto platformy Azure](/pricing/free-trial/?WT.mc_id=A261C142F) lub [aktywować korzyści dla subskrybentów programu Visual Studio](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span><span class="sxs-lookup"><span data-stu-id="ba780-115">You can [open a free Azure account](/pricing/free-trial/?WT.mc_id=A261C142F) or [activate Visual Studio subscriber benefits](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span></span>

## <a name="create-a-resource-group"></a><span data-ttu-id="ba780-116">Tworzenie grupy zasobów</span><span class="sxs-lookup"><span data-stu-id="ba780-116">Create a resource group</span></span>
1. <span data-ttu-id="ba780-117">Zaloguj się w witrynie [Azure Portal](http://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="ba780-117">Sign in to the [Azure portal](http://portal.azure.com).</span></span>
2. <span data-ttu-id="ba780-118">Kliknij przycisk  **+**  można utworzyć nowego obiektu w portalu.</span><span class="sxs-lookup"><span data-stu-id="ba780-118">Click **+** to create a new object in the portal.</span></span>

   ![Nowy obiekt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-portalplus.png)

3. <span data-ttu-id="ba780-120">Typ **grupy zasobów** w **Marketplace** okno wyszukiwania.</span><span class="sxs-lookup"><span data-stu-id="ba780-120">Type **resource group** in the **Marketplace** search window.</span></span>

   ![Grupa zasobów](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroupsymbol.png)
4. <span data-ttu-id="ba780-122">Kliknij przycisk **grupy zasobów**.</span><span class="sxs-lookup"><span data-stu-id="ba780-122">Click **Resource group**.</span></span>
5. <span data-ttu-id="ba780-123">Kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-123">Click **Create**.</span></span>
6. <span data-ttu-id="ba780-124">Na **grupy zasobów** bloku, w obszarze **Nazwa grupy zasobów**, wpisz nazwę grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-124">On the **Resource group** blade, under **Resource group name**, type a name for the resource group.</span></span> <span data-ttu-id="ba780-125">Na przykład wpisz **sql-ha-zarządcy zasobów**.</span><span class="sxs-lookup"><span data-stu-id="ba780-125">For example, type **sql-ha-rg**.</span></span>
7. <span data-ttu-id="ba780-126">Jeśli masz wiele subskrypcji Azure, sprawdź, czy subskrypcja jest subskrypcja platformy Azure, który chcesz utworzyć grupy dostępności w.</span><span class="sxs-lookup"><span data-stu-id="ba780-126">If you have multiple Azure subscriptions, verify that the subscription is the Azure subscription that you want to create the availability group in.</span></span>
8. <span data-ttu-id="ba780-127">Wybierz lokalizację.</span><span class="sxs-lookup"><span data-stu-id="ba780-127">Select a location.</span></span> <span data-ttu-id="ba780-128">Lokalizacja jest region platformy Azure, której chcesz utworzyć grupy dostępności.</span><span class="sxs-lookup"><span data-stu-id="ba780-128">The location is the Azure region where you want to create the availability group.</span></span> <span data-ttu-id="ba780-129">W tym samouczku zamierzamy utworzyć wszystkie zasoby w jednej lokalizacji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-129">For this tutorial, we're going to build all resources in one Azure location.</span></span>
9. <span data-ttu-id="ba780-130">Sprawdź, czy **Przypnij do pulpitu nawigacyjnego** jest zaznaczony.</span><span class="sxs-lookup"><span data-stu-id="ba780-130">Verify that **Pin to dashboard** is checked.</span></span> <span data-ttu-id="ba780-131">To ustawienie opcjonalne umieszcza skrót dla grupy zasobów na pulpicie nawigacyjnym portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-131">This optional setting places a shortcut for the resource group on the Azure portal dashboard.</span></span>

   ![Grupa zasobów](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroup.png)

10. <span data-ttu-id="ba780-133">Kliknij przycisk **Utwórz** do utworzenia grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-133">Click **Create** to create the resource group.</span></span>

<span data-ttu-id="ba780-134">Azure tworzy grupę zasobów i numerów PIN skrót do grupy zasobów w portalu.</span><span class="sxs-lookup"><span data-stu-id="ba780-134">Azure creates the resource group and pins a shortcut to the resource group in the portal.</span></span>

## <a name="create-the-network-and-subnets"></a><span data-ttu-id="ba780-135">Tworzenie sieci i podsieci</span><span class="sxs-lookup"><span data-stu-id="ba780-135">Create the network and subnets</span></span>
<span data-ttu-id="ba780-136">Następnym krokiem jest można utworzyć sieci i podsieci w grupie zasobów platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-136">The next step is to create the networks and subnets in the Azure resource group.</span></span>

<span data-ttu-id="ba780-137">W tym rozwiązaniu zastosowano jedną sieć wirtualną z dwiema podsieciami.</span><span class="sxs-lookup"><span data-stu-id="ba780-137">The solution uses one virtual network with two subnets.</span></span> <span data-ttu-id="ba780-138">[Omówienie sieci wirtualnej](../../../virtual-network/virtual-networks-overview.md) zawiera więcej informacji dotyczących sieci na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-138">The [Virtual network overview](../../../virtual-network/virtual-networks-overview.md) provides more information about networks in Azure.</span></span>

<span data-ttu-id="ba780-139">Aby utworzyć sieć wirtualną:</span><span class="sxs-lookup"><span data-stu-id="ba780-139">To create the virtual network:</span></span>

1. <span data-ttu-id="ba780-140">W portalu Azure, w grupie zasobów, kliknij przycisk **+ Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-140">In the Azure portal, in your resource group, click **+ Add**.</span></span> <span data-ttu-id="ba780-141">Otwiera Azure **wszystko** bloku.</span><span class="sxs-lookup"><span data-stu-id="ba780-141">Azure opens the **Everything** blade.</span></span>

   ![Nowy element](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/02-newiteminrg.png)
2. <span data-ttu-id="ba780-143">Wyszukaj **sieci wirtualnej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-143">Search for **virtual network**.</span></span>

     ![Sieć wirtualna wyszukiwania](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/04-findvirtualnetwork.png)
3. <span data-ttu-id="ba780-145">Kliknij przycisk **sieci wirtualnej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-145">Click **Virtual network**.</span></span>
4. <span data-ttu-id="ba780-146">Na **sieci wirtualnej** bloku, kliknij przycisk **Resource Manager** model wdrażania, a następnie kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-146">On the **Virtual network** blade, click the **Resource Manager** deployment model, and then click **Create**.</span></span>

    <span data-ttu-id="ba780-147">W poniższej tabeli przedstawiono ustawienia dla sieci wirtualnej:</span><span class="sxs-lookup"><span data-stu-id="ba780-147">The following table shows the settings for the virtual network:</span></span>

   | <span data-ttu-id="ba780-148">**Pole**</span><span class="sxs-lookup"><span data-stu-id="ba780-148">**Field**</span></span> | <span data-ttu-id="ba780-149">Wartość</span><span class="sxs-lookup"><span data-stu-id="ba780-149">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="ba780-150">**Nazwa**</span><span class="sxs-lookup"><span data-stu-id="ba780-150">**Name**</span></span> |<span data-ttu-id="ba780-151">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="ba780-151">autoHAVNET</span></span> |
   | <span data-ttu-id="ba780-152">**Przestrzeń adresowa**</span><span class="sxs-lookup"><span data-stu-id="ba780-152">**Address space**</span></span> |<span data-ttu-id="ba780-153">10.33.0.0/24</span><span class="sxs-lookup"><span data-stu-id="ba780-153">10.33.0.0/24</span></span> |
   | <span data-ttu-id="ba780-154">**Nazwa podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-154">**Subnet name**</span></span> |<span data-ttu-id="ba780-155">Administrator</span><span class="sxs-lookup"><span data-stu-id="ba780-155">Admin</span></span> |
   | <span data-ttu-id="ba780-156">**Zakres adresów podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-156">**Subnet address range**</span></span> |<span data-ttu-id="ba780-157">10.33.0.0/29</span><span class="sxs-lookup"><span data-stu-id="ba780-157">10.33.0.0/29</span></span> |
   | <span data-ttu-id="ba780-158">**Subskrypcja**</span><span class="sxs-lookup"><span data-stu-id="ba780-158">**Subscription**</span></span> |<span data-ttu-id="ba780-159">Określ subskrypcję, która ma być używana.</span><span class="sxs-lookup"><span data-stu-id="ba780-159">Specify the subscription that you intend to use.</span></span> <span data-ttu-id="ba780-160">**Subskrypcja** jest puste, jeśli masz tylko jedną subskrypcję.</span><span class="sxs-lookup"><span data-stu-id="ba780-160">**Subscription** is blank if you only have one subscription.</span></span> |
   | <span data-ttu-id="ba780-161">**Grupa zasobów**</span><span class="sxs-lookup"><span data-stu-id="ba780-161">**Resource group**</span></span> |<span data-ttu-id="ba780-162">Wybierz **Użyj istniejącego** i wybierz nazwę grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-162">Choose **Use existing** and pick the name of the resource group.</span></span> |
   | <span data-ttu-id="ba780-163">**Lokalizacja**</span><span class="sxs-lookup"><span data-stu-id="ba780-163">**Location**</span></span> |<span data-ttu-id="ba780-164">Określ lokalizację platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-164">Specify the Azure location.</span></span> |

   <span data-ttu-id="ba780-165">Zakres adresów miejsca i podsieć adresu mogą się różnić od tabeli.</span><span class="sxs-lookup"><span data-stu-id="ba780-165">Your address space and subnet address range might be different from the table.</span></span> <span data-ttu-id="ba780-166">W zależności od subskrypcji portalu sugeruje przestrzeni adresów dostępne i odpowiedni zakres adresów podsieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-166">Depending on your subscription, the portal suggests an available address space and corresponding subnet address range.</span></span> <span data-ttu-id="ba780-167">Jeśli nie ma wystarczającej przestrzeni adresów dostępne, użyj innej subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-167">If no sufficient address space is available, use a different subscription.</span></span>

   <span data-ttu-id="ba780-168">W przykładzie użyto nazwy podsieci **Admin**. Ta podsieć jest dla kontrolerów domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-168">The example uses the subnet name **Admin**. This subnet is for the domain controllers.</span></span>

5. <span data-ttu-id="ba780-169">Kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-169">Click **Create**.</span></span>

   ![Skonfiguruj sieć wirtualną](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/06-configurevirtualnetwork.png)

<span data-ttu-id="ba780-171">Azure powrót do pulpitu nawigacyjnego portalu i powiadamia użytkownika, podczas tworzenia nowej sieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-171">Azure returns you to the portal dashboard and notifies you when the new network is created.</span></span>

### <a name="create-a-second-subnet"></a><span data-ttu-id="ba780-172">Tworzenie drugiej podsieci</span><span class="sxs-lookup"><span data-stu-id="ba780-172">Create a second subnet</span></span>
<span data-ttu-id="ba780-173">Nowa sieć wirtualna ma jedną podsieć o nazwie **Admin**. Kontrolery domeny używają tej podsieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-173">The new virtual network has one subnet, named **Admin**. The domain controllers use this subnet.</span></span> <span data-ttu-id="ba780-174">Użyj maszyn wirtualnych programu SQL Server o nazwie drugiej podsieci **SQL**.</span><span class="sxs-lookup"><span data-stu-id="ba780-174">The SQL Server VMs use a second subnet named **SQL**.</span></span> <span data-ttu-id="ba780-175">Aby skonfigurować tej podsieci:</span><span class="sxs-lookup"><span data-stu-id="ba780-175">To configure this subnet:</span></span>

1. <span data-ttu-id="ba780-176">Na pulpicie nawigacyjnym kliknij grupę zasobów, która została utworzona, **SQL-HA-zarządcy zasobów**.</span><span class="sxs-lookup"><span data-stu-id="ba780-176">On your dashboard, click the resource group that you created, **SQL-HA-RG**.</span></span> <span data-ttu-id="ba780-177">Zlokalizuj sieci w grupie zasobów w obszarze **zasobów**.</span><span class="sxs-lookup"><span data-stu-id="ba780-177">Locate the network in the resource group under **Resources**.</span></span>

    <span data-ttu-id="ba780-178">Jeśli **SQL-HA-zarządcy zasobów** nie jest widoczny, znaleźć, klikając **grup zasobów** i filtrowanie według nazwy grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-178">If **SQL-HA-RG** isn't visible, find it by clicking **Resource Groups** and filtering by the resource group name.</span></span>
2. <span data-ttu-id="ba780-179">Kliknij przycisk **autoHAVNET** na liście zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-179">Click **autoHAVNET** on the list of resources.</span></span> <span data-ttu-id="ba780-180">Azure spowoduje otwarcie bloku konfiguracji sieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-180">Azure opens the network configuration blade.</span></span>
3. <span data-ttu-id="ba780-181">Na **autoHAVNET** bloku sieci wirtualnej, w obszarze **ustawienia** , kliknij przycisk **podsieci**.</span><span class="sxs-lookup"><span data-stu-id="ba780-181">On the **autoHAVNET** virtual network blade, under **Settings** , click **Subnets**.</span></span>

    <span data-ttu-id="ba780-182">Należy pamiętać, podsieci, które już utworzone.</span><span class="sxs-lookup"><span data-stu-id="ba780-182">Note the subnet that you already created.</span></span>

   ![Skonfiguruj sieć wirtualną](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/07-addsubnet.png)
5. <span data-ttu-id="ba780-184">Tworzenie drugiej podsieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-184">Create a second subnet.</span></span> <span data-ttu-id="ba780-185">Kliknij przycisk **+ podsieci**.</span><span class="sxs-lookup"><span data-stu-id="ba780-185">Click **+ Subnet**.</span></span>
6. <span data-ttu-id="ba780-186">Na **Dodaj podsieć** bloku, skonfiguruj podsieci, wpisując **sqlsubnet** w obszarze **nazwa**.</span><span class="sxs-lookup"><span data-stu-id="ba780-186">On the **Add subnet** blade, configure the subnet by typing **sqlsubnet** under **Name**.</span></span> <span data-ttu-id="ba780-187">Azure automatycznie określa prawidłową **zakres adresów**.</span><span class="sxs-lookup"><span data-stu-id="ba780-187">Azure automatically specifies a valid **Address range**.</span></span> <span data-ttu-id="ba780-188">Sprawdź, czy ten zakres adresów ma co najmniej 10 adresów w nim.</span><span class="sxs-lookup"><span data-stu-id="ba780-188">Verify that this address range has at least 10 addresses in it.</span></span> <span data-ttu-id="ba780-189">W środowisku produkcyjnym może wymagać więcej adresów.</span><span class="sxs-lookup"><span data-stu-id="ba780-189">In a production environment, you might require more addresses.</span></span>
7. <span data-ttu-id="ba780-190">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-190">Click **OK**.</span></span>

    ![Skonfiguruj sieć wirtualną](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/08-configuresubnet.png)

<span data-ttu-id="ba780-192">Poniższa tabela zawiera podsumowanie ustawień konfiguracji sieci:</span><span class="sxs-lookup"><span data-stu-id="ba780-192">The following table summarizes the network configuration settings:</span></span>

| <span data-ttu-id="ba780-193">**Pole**</span><span class="sxs-lookup"><span data-stu-id="ba780-193">**Field**</span></span> | <span data-ttu-id="ba780-194">Wartość</span><span class="sxs-lookup"><span data-stu-id="ba780-194">Value</span></span> |
| --- | --- |
| <span data-ttu-id="ba780-195">**Nazwa**</span><span class="sxs-lookup"><span data-stu-id="ba780-195">**Name**</span></span> |<span data-ttu-id="ba780-196">**autoHAVNET**</span><span class="sxs-lookup"><span data-stu-id="ba780-196">**autoHAVNET**</span></span> |
| <span data-ttu-id="ba780-197">**Przestrzeń adresowa**</span><span class="sxs-lookup"><span data-stu-id="ba780-197">**Address space**</span></span> |<span data-ttu-id="ba780-198">Ta wartość zależy od przestrzeni adresowych dostępne w ramach subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-198">This value depends on the available address spaces in your subscription.</span></span> <span data-ttu-id="ba780-199">Typowe wartości to 10.0.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="ba780-199">A typical value is 10.0.0.0/16.</span></span> |
| <span data-ttu-id="ba780-200">**Nazwa podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-200">**Subnet name**</span></span> |<span data-ttu-id="ba780-201">**Administrator**</span><span class="sxs-lookup"><span data-stu-id="ba780-201">**admin**</span></span> |
| <span data-ttu-id="ba780-202">**Zakres adresów podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-202">**Subnet address range**</span></span> |<span data-ttu-id="ba780-203">Ta wartość zależy od zakresy adresów dostępne w ramach subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-203">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="ba780-204">Typowe wartości to 10.0.0.0/24.</span><span class="sxs-lookup"><span data-stu-id="ba780-204">A typical value is 10.0.0.0/24.</span></span> |
| <span data-ttu-id="ba780-205">**Nazwa podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-205">**Subnet name**</span></span> |<span data-ttu-id="ba780-206">**sqlsubnet**</span><span class="sxs-lookup"><span data-stu-id="ba780-206">**sqlsubnet**</span></span> |
| <span data-ttu-id="ba780-207">**Zakres adresów podsieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-207">**Subnet address range**</span></span> |<span data-ttu-id="ba780-208">Ta wartość zależy od zakresy adresów dostępne w ramach subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-208">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="ba780-209">Typowe wartości to 10.0.1.0/24.</span><span class="sxs-lookup"><span data-stu-id="ba780-209">A typical value is 10.0.1.0/24.</span></span> |
| <span data-ttu-id="ba780-210">**Subskrypcja**</span><span class="sxs-lookup"><span data-stu-id="ba780-210">**Subscription**</span></span> |<span data-ttu-id="ba780-211">Określ subskrypcję, która ma być używana.</span><span class="sxs-lookup"><span data-stu-id="ba780-211">Specify the subscription that you intend to use.</span></span> |
| <span data-ttu-id="ba780-212">**Grupa zasobów**</span><span class="sxs-lookup"><span data-stu-id="ba780-212">**Resource Group**</span></span> |<span data-ttu-id="ba780-213">**SQL-HA-ZARZĄDCY ZASOBÓW**</span><span class="sxs-lookup"><span data-stu-id="ba780-213">**SQL-HA-RG**</span></span> |
| <span data-ttu-id="ba780-214">**Lokalizacja**</span><span class="sxs-lookup"><span data-stu-id="ba780-214">**Location**</span></span> |<span data-ttu-id="ba780-215">Określenie tej samej lokalizacji, który został wybrany dla grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-215">Specify the same location that you chose for the resource group.</span></span> |

## <a name="create-availability-sets"></a><span data-ttu-id="ba780-216">Tworzenie zestawów dostępności</span><span class="sxs-lookup"><span data-stu-id="ba780-216">Create availability sets</span></span>

<span data-ttu-id="ba780-217">Przed utworzeniem maszyny wirtualnej, musisz utworzyć zestawy dostępności.</span><span class="sxs-lookup"><span data-stu-id="ba780-217">Before you create virtual machines, you need to create availability sets.</span></span> <span data-ttu-id="ba780-218">Zestawy dostępności skrócić czas przestojów planowana lub nieplanowana konserwacja zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="ba780-218">Availability sets reduce the downtime for planned or unplanned maintenance events.</span></span> <span data-ttu-id="ba780-219">Zestaw dostępności Azure jest logiczną grupa zasobów Azure umieszcza w fizycznych domenach awarii i Aktualizacja domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-219">An Azure availability set is a logical group of resources that Azure places on physical fault domains and update domains.</span></span> <span data-ttu-id="ba780-220">Domeny błędów gwarantuje, że elementy członkowskie w zestawie dostępności oddzielne zasilania i zasobów sieciowych.</span><span class="sxs-lookup"><span data-stu-id="ba780-220">A fault domain ensures that the members of the availability set have separate power and network resources.</span></span> <span data-ttu-id="ba780-221">Domeny aktualizacji gwarantuje, że członkowie zestawu dostępności nie są obniżył konserwacji w tym samym czasie.</span><span class="sxs-lookup"><span data-stu-id="ba780-221">An update domain ensures that members of the availability set aren't brought down for maintenance at the same time.</span></span> <span data-ttu-id="ba780-222">Aby uzyskać więcej informacji, zobacz [Zarządzaj dostępnością maszyn wirtualnych](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="ba780-222">For more information, see [Manage the availability of virtual machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="ba780-223">Należy dwóch zestawów dostępności.</span><span class="sxs-lookup"><span data-stu-id="ba780-223">You need two availability sets.</span></span> <span data-ttu-id="ba780-224">Jedna jest dla kontrolerów domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-224">One is for the domain controllers.</span></span> <span data-ttu-id="ba780-225">Druga jest przeznaczona dla maszyn wirtualnych serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-225">The second is for the SQL Server VMs.</span></span>

<span data-ttu-id="ba780-226">Aby utworzyć zbiór dostępności, przejdź do grupy zasobów, a następnie kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-226">To create an availability set, go to the resource group and click **Add**.</span></span> <span data-ttu-id="ba780-227">Filtrowanie wyników, wpisując **zestawu dostępności**.</span><span class="sxs-lookup"><span data-stu-id="ba780-227">Filter the results by typing **availability set**.</span></span> <span data-ttu-id="ba780-228">Kliknij przycisk **zestawu dostępności** wyników, a następnie kliknij polecenie **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-228">Click **Availability Set** in the results, and then click **Create**.</span></span>

<span data-ttu-id="ba780-229">W poniższej tabeli, należy skonfigurować dwa zestawy dostępności zgodnie z parametrami:</span><span class="sxs-lookup"><span data-stu-id="ba780-229">Configure two availability sets according to the parameters in the following table:</span></span>

| <span data-ttu-id="ba780-230">**Pole**</span><span class="sxs-lookup"><span data-stu-id="ba780-230">**Field**</span></span> | <span data-ttu-id="ba780-231">Zestaw dostępności kontrolera domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-231">Domain controller availability set</span></span> | <span data-ttu-id="ba780-232">Zestaw dostępności programu SQL Server</span><span class="sxs-lookup"><span data-stu-id="ba780-232">SQL Server availability set</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ba780-233">**Nazwa**</span><span class="sxs-lookup"><span data-stu-id="ba780-233">**Name**</span></span> |<span data-ttu-id="ba780-234">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="ba780-234">adavailabilityset</span></span> |<span data-ttu-id="ba780-235">sqlavailabilityset</span><span class="sxs-lookup"><span data-stu-id="ba780-235">sqlavailabilityset</span></span> |
| <span data-ttu-id="ba780-236">**Grupa zasobów**</span><span class="sxs-lookup"><span data-stu-id="ba780-236">**Resource group**</span></span> |<span data-ttu-id="ba780-237">SQL-HA-ZARZĄDCY ZASOBÓW</span><span class="sxs-lookup"><span data-stu-id="ba780-237">SQL-HA-RG</span></span> |<span data-ttu-id="ba780-238">SQL-HA-ZARZĄDCY ZASOBÓW</span><span class="sxs-lookup"><span data-stu-id="ba780-238">SQL-HA-RG</span></span> |
| <span data-ttu-id="ba780-239">**Domen błędów**</span><span class="sxs-lookup"><span data-stu-id="ba780-239">**Fault domains**</span></span> |<span data-ttu-id="ba780-240">3</span><span class="sxs-lookup"><span data-stu-id="ba780-240">3</span></span> |<span data-ttu-id="ba780-241">3</span><span class="sxs-lookup"><span data-stu-id="ba780-241">3</span></span> |
| <span data-ttu-id="ba780-242">**Aktualizowanie domeny**</span><span class="sxs-lookup"><span data-stu-id="ba780-242">**Update domains**</span></span> |<span data-ttu-id="ba780-243">5</span><span class="sxs-lookup"><span data-stu-id="ba780-243">5</span></span> |<span data-ttu-id="ba780-244">3</span><span class="sxs-lookup"><span data-stu-id="ba780-244">3</span></span> |

<span data-ttu-id="ba780-245">Po utworzeniu zestawów dostępności, wróć do grupy zasobów w portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-245">After you create the availability sets, return to the resource group in the Azure portal.</span></span>

## <a name="create-domain-controllers"></a><span data-ttu-id="ba780-246">Utworzyć kontrolerów domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-246">Create domain controllers</span></span>
<span data-ttu-id="ba780-247">Po utworzeniu sieci, podsieci, zestawów dostępności i równoważenia obciążenia internetowy, możesz przystąpić do tworzenia maszyn wirtualnych kontrolerów domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-247">After you've created the network, subnets, availability sets, and an Internet-facing load balancer, you're ready to create the virtual machines for the domain controllers.</span></span>

### <a name="create-virtual-machines-for-the-domain-controllers"></a><span data-ttu-id="ba780-248">Tworzenie maszyn wirtualnych kontrolerów domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-248">Create virtual machines for the domain controllers</span></span>
<span data-ttu-id="ba780-249">Aby utworzyć i skonfigurować na kontrolerach domeny, wróć do **SQL-HA-zarządcy zasobów** grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-249">To create and configure the domain controllers, return to the **SQL-HA-RG** resource group.</span></span>

1. <span data-ttu-id="ba780-250">Kliknij pozycję **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-250">Click **Add**.</span></span> <span data-ttu-id="ba780-251">**Wszystko** zostanie otwarty blok.</span><span class="sxs-lookup"><span data-stu-id="ba780-251">The **Everything** blade opens.</span></span>
2. <span data-ttu-id="ba780-252">Typ **systemu Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="ba780-252">Type **Windows Server 2016 Datacenter**.</span></span>
3. <span data-ttu-id="ba780-253">Kliknij przycisk **systemu Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="ba780-253">Click **Windows Server 2016 Datacenter**.</span></span> <span data-ttu-id="ba780-254">W **systemu Windows Server Datacenter 2016** bloku, sprawdź, czy model wdrażania **Menedżera zasobów**, a następnie kliknij przycisk **Utwórz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-254">In the **Windows Server 2016 Datacenter** blade, verify that the deployment model is **Resource Manager**, and then click **Create**.</span></span> <span data-ttu-id="ba780-255">Otwiera Azure **tworzenia maszyny wirtualnej** bloku.</span><span class="sxs-lookup"><span data-stu-id="ba780-255">Azure opens the **Create virtual machine** blade.</span></span>

<span data-ttu-id="ba780-256">Powtórz poprzednie kroki, aby utworzyć dwie maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="ba780-256">Repeat the preceding steps to create two virtual machines.</span></span> <span data-ttu-id="ba780-257">Nazwa dwóch maszyn wirtualnych:</span><span class="sxs-lookup"><span data-stu-id="ba780-257">Name the two virtual machines:</span></span>

* <span data-ttu-id="ba780-258">kontrolerów domeny podstawowej AD</span><span class="sxs-lookup"><span data-stu-id="ba780-258">ad-primary-dc</span></span>
* <span data-ttu-id="ba780-259">kontrolerów domeny pomocniczy AD</span><span class="sxs-lookup"><span data-stu-id="ba780-259">ad-secondary-dc</span></span>

  > [!NOTE]
  > <span data-ttu-id="ba780-260">**Kontrolerów domeny pomocniczy ad** maszyny wirtualnej jest opcjonalne zapewnić wysoką dostępność usług domenowych w usłudze Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ba780-260">The **ad-secondary-dc** virtual machine is optional, to provide high availability for Active Directory Domain Services.</span></span>
  >
  >

<span data-ttu-id="ba780-261">W poniższej tabeli przedstawiono ustawienia dla tych dwóch maszyn:</span><span class="sxs-lookup"><span data-stu-id="ba780-261">The following table shows the settings for these two machines:</span></span>

| <span data-ttu-id="ba780-262">**Pole**</span><span class="sxs-lookup"><span data-stu-id="ba780-262">**Field**</span></span> | <span data-ttu-id="ba780-263">Wartość</span><span class="sxs-lookup"><span data-stu-id="ba780-263">Value</span></span> |
| --- | --- |
| <span data-ttu-id="ba780-264">**Nazwa**</span><span class="sxs-lookup"><span data-stu-id="ba780-264">**Name**</span></span> |<span data-ttu-id="ba780-265">Pierwszy kontroler domeny: *kontrolerów domeny podstawowej ad*.</span><span class="sxs-lookup"><span data-stu-id="ba780-265">First domain controller: *ad-primary-dc*.</span></span></br><span data-ttu-id="ba780-266">Drugi kontroler domeny *kontrolerów domeny pomocniczy ad*.</span><span class="sxs-lookup"><span data-stu-id="ba780-266">Second domain controller *ad-secondary-dc*.</span></span> |
| <span data-ttu-id="ba780-267">**Typ dysku maszyny wirtualnej**</span><span class="sxs-lookup"><span data-stu-id="ba780-267">**VM disk type**</span></span> |<span data-ttu-id="ba780-268">SSD</span><span class="sxs-lookup"><span data-stu-id="ba780-268">SSD</span></span> |
| <span data-ttu-id="ba780-269">**Nazwa użytkownika**</span><span class="sxs-lookup"><span data-stu-id="ba780-269">**User name**</span></span> |<span data-ttu-id="ba780-270">Administrator domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-270">DomainAdmin</span></span> |
| <span data-ttu-id="ba780-271">**Hasło**</span><span class="sxs-lookup"><span data-stu-id="ba780-271">**Password**</span></span> |<span data-ttu-id="ba780-272">Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-272">Contoso!0000</span></span> |
| <span data-ttu-id="ba780-273">**Subskrypcja**</span><span class="sxs-lookup"><span data-stu-id="ba780-273">**Subscription**</span></span> |<span data-ttu-id="ba780-274">*Twoja subskrypcja*</span><span class="sxs-lookup"><span data-stu-id="ba780-274">*Your subscription*</span></span> |
| <span data-ttu-id="ba780-275">**Grupa zasobów**</span><span class="sxs-lookup"><span data-stu-id="ba780-275">**Resource group**</span></span> |<span data-ttu-id="ba780-276">SQL-HA-ZARZĄDCY ZASOBÓW</span><span class="sxs-lookup"><span data-stu-id="ba780-276">SQL-HA-RG</span></span> |
| <span data-ttu-id="ba780-277">**Lokalizacja**</span><span class="sxs-lookup"><span data-stu-id="ba780-277">**Location**</span></span> |<span data-ttu-id="ba780-278">*Lokalizacja*</span><span class="sxs-lookup"><span data-stu-id="ba780-278">*Your location*</span></span> |
| <span data-ttu-id="ba780-279">**Rozmiar**</span><span class="sxs-lookup"><span data-stu-id="ba780-279">**Size**</span></span> |<span data-ttu-id="ba780-280">DS1_V2</span><span class="sxs-lookup"><span data-stu-id="ba780-280">DS1_V2</span></span> |
| <span data-ttu-id="ba780-281">**Storage**</span><span class="sxs-lookup"><span data-stu-id="ba780-281">**Storage**</span></span> | <span data-ttu-id="ba780-282">**Użyj zarządzanego dysków** - **tak**</span><span class="sxs-lookup"><span data-stu-id="ba780-282">**Use managed disks** - **Yes**</span></span> |
| <span data-ttu-id="ba780-283">**Sieć wirtualna**</span><span class="sxs-lookup"><span data-stu-id="ba780-283">**Virtual network**</span></span> |<span data-ttu-id="ba780-284">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="ba780-284">autoHAVNET</span></span> |
| <span data-ttu-id="ba780-285">**Podsieć**</span><span class="sxs-lookup"><span data-stu-id="ba780-285">**Subnet**</span></span> |<span data-ttu-id="ba780-286">Administrator</span><span class="sxs-lookup"><span data-stu-id="ba780-286">admin</span></span> |
| <span data-ttu-id="ba780-287">**Publiczny adres IP**</span><span class="sxs-lookup"><span data-stu-id="ba780-287">**Public IP address**</span></span> |<span data-ttu-id="ba780-288">*Tej samej nazwy co maszyna wirtualna*</span><span class="sxs-lookup"><span data-stu-id="ba780-288">*Same name as the VM*</span></span> |
| <span data-ttu-id="ba780-289">**Grupy zabezpieczeń sieci**</span><span class="sxs-lookup"><span data-stu-id="ba780-289">**Network security group**</span></span> |<span data-ttu-id="ba780-290">*Tej samej nazwy co maszyna wirtualna*</span><span class="sxs-lookup"><span data-stu-id="ba780-290">*Same name as the VM*</span></span> |
| <span data-ttu-id="ba780-291">**Zestaw dostępności**</span><span class="sxs-lookup"><span data-stu-id="ba780-291">**Availability set**</span></span> |<span data-ttu-id="ba780-292">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="ba780-292">adavailabilityset</span></span> </br><span data-ttu-id="ba780-293">**Odporność domen**: 2</span><span class="sxs-lookup"><span data-stu-id="ba780-293">**Fault domains**:2</span></span></br><span data-ttu-id="ba780-294">**Aktualizowanie domeny**: 2</span><span class="sxs-lookup"><span data-stu-id="ba780-294">**Update domains**:2</span></span>|
| <span data-ttu-id="ba780-295">**Diagnostyka**</span><span class="sxs-lookup"><span data-stu-id="ba780-295">**Diagnostics**</span></span> |<span data-ttu-id="ba780-296">Enabled (Włączony)</span><span class="sxs-lookup"><span data-stu-id="ba780-296">Enabled</span></span> |
| <span data-ttu-id="ba780-297">**Konto magazynu diagnostyki**</span><span class="sxs-lookup"><span data-stu-id="ba780-297">**Diagnostics storage account**</span></span> |<span data-ttu-id="ba780-298">*Automatycznie utworzone*</span><span class="sxs-lookup"><span data-stu-id="ba780-298">*Automatically created*</span></span> |

   >[!IMPORTANT]
   ><span data-ttu-id="ba780-299">Maszyny Wirtualnej można umieścić tylko w dostępności po jego utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="ba780-299">You can only place a VM in an availability set when you create it.</span></span> <span data-ttu-id="ba780-300">Nie można zmienić dostępności ustawić po utworzeniu maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ba780-300">You can't change the availability set after a VM is created.</span></span> <span data-ttu-id="ba780-301">Zobacz [Zarządzaj dostępnością maszyn wirtualnych](../manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="ba780-301">See [Manage the availability of virtual machines](../manage-availability.md).</span></span>

<span data-ttu-id="ba780-302">Platforma Azure tworzy maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="ba780-302">Azure creates the virtual machines.</span></span>

<span data-ttu-id="ba780-303">Po utworzeniu maszyny wirtualnej, należy skonfigurować kontroler domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-303">After the virtual machines are created, configure the domain controller.</span></span>

### <a name="configure-the-domain-controller"></a><span data-ttu-id="ba780-304">Konfiguracja kontrolera domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-304">Configure the domain controller</span></span>
<span data-ttu-id="ba780-305">W poniższych krokach, należy skonfigurować **kontrolerów domeny podstawowej ad** komputera jako kontroler domeny corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="ba780-305">In the following steps, configure the **ad-primary-dc** machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="ba780-306">W portalu, otwórz **SQL-HA-zarządcy zasobów** zasobu, grupy i wybierz **kontrolerów domeny podstawowej ad** maszyny.</span><span class="sxs-lookup"><span data-stu-id="ba780-306">In the portal, open the **SQL-HA-RG** resource group and select the **ad-primary-dc** machine.</span></span> <span data-ttu-id="ba780-307">Na **kontrolerów domeny podstawowej ad** bloku, kliknij przycisk **Connect** można otworzyć pliku RDP do dostępu do pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="ba780-307">On the **ad-primary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>

    ![Połącz z maszyną wirtualną](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/20-connectrdp.png)
2. <span data-ttu-id="ba780-309">Zaloguj się przy użyciu konta administratora skonfigurowane (**\DomainAdmin**) i hasło (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="ba780-309">Sign in with your configured administrator account (**\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="ba780-310">Domyślnie **Menedżera serwera** powinien zostać wyświetlony pulpit nawigacyjny.</span><span class="sxs-lookup"><span data-stu-id="ba780-310">By default, the **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="ba780-311">Kliknij przycisk **Dodaj role i funkcje** łącza na pulpicie nawigacyjnym.</span><span class="sxs-lookup"><span data-stu-id="ba780-311">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Menedżer serwera — Dodawanie ról](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
5. <span data-ttu-id="ba780-313">Wybierz **dalej** aż do **ról serwera** sekcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-313">Select **Next** until you get to the **Server Roles** section.</span></span>
6. <span data-ttu-id="ba780-314">Wybierz **usług domenowych w usłudze Active Directory** i **serwera DNS** ról.</span><span class="sxs-lookup"><span data-stu-id="ba780-314">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="ba780-315">Po wyświetleniu monitu, Dodaj wszelkie dodatkowe funkcje, które są wymagane przez tych ról.</span><span class="sxs-lookup"><span data-stu-id="ba780-315">When you're prompted, add any additional features that are required by these roles.</span></span>

   > [!NOTE]
   > <span data-ttu-id="ba780-316">System Windows wyświetli ostrzeżenie, że nie istnieje żaden adres IP.</span><span class="sxs-lookup"><span data-stu-id="ba780-316">Windows warns you that there is no static IP address.</span></span> <span data-ttu-id="ba780-317">W przypadku testowania konfiguracji, kliknij przycisk **Kontynuuj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-317">If you're testing the configuration, click **Continue**.</span></span> <span data-ttu-id="ba780-318">W scenariuszach produkcji, należy ustawić adres IP statyczne w portalu Azure lub [ustawić statyczny adres IP komputera kontrolera domeny przy użyciu programu PowerShell](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="ba780-318">For production scenarios, set the IP address to static in the Azure portal, or [use PowerShell to set the static IP address of the domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   >
   >

    ![Dodawanie ról okna dialogowego](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/23-addroles.png)
7. <span data-ttu-id="ba780-320">Kliknij przycisk **dalej** aż **potwierdzenie** sekcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-320">Click **Next** until you reach the **Confirmation** section.</span></span> <span data-ttu-id="ba780-321">Wybierz **automatycznie ponownie uruchom serwer docelowy, jeśli jest to wymagane** pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="ba780-321">Select the **Restart the destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="ba780-322">Kliknij pozycję **Zainstaluj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-322">Click **Install**.</span></span>
9. <span data-ttu-id="ba780-323">Po funkcji zakończyć instalację, wróć do **Menedżera serwera** pulpitu nawigacyjnego.</span><span class="sxs-lookup"><span data-stu-id="ba780-323">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="ba780-324">Wybierz nową **usług AD DS** opcji w okienku po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="ba780-324">Select the new **AD DS** option on the left-hand pane.</span></span>
11. <span data-ttu-id="ba780-325">Kliknij przycisk **więcej** łącze na żółty pasek ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="ba780-325">Click the **More** link on the yellow warning bar.</span></span>

    ![Usługi AD DS z okna dialogowego na maszynie Wirtualnej z serwera DNS](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/24-addsmore.png)
12. <span data-ttu-id="ba780-327">W **akcji** kolumny **wszystkie szczegóły zadania serwera** okna dialogowego, kliknij przycisk **podwyższyć ten serwer do poziomu kontrolera domeny**.</span><span class="sxs-lookup"><span data-stu-id="ba780-327">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
13. <span data-ttu-id="ba780-328">W **Kreator konfiguracji usług domenowych Active Directory**, użyj następujących wartości:</span><span class="sxs-lookup"><span data-stu-id="ba780-328">In the **Active Directory Domain Services Configuration Wizard**, use the following values:</span></span>

    | <span data-ttu-id="ba780-329">**Strona**</span><span class="sxs-lookup"><span data-stu-id="ba780-329">**Page**</span></span> | <span data-ttu-id="ba780-330">Ustawienie</span><span class="sxs-lookup"><span data-stu-id="ba780-330">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="ba780-331">**Konfiguracja wdrażania**</span><span class="sxs-lookup"><span data-stu-id="ba780-331">**Deployment Configuration**</span></span> |<span data-ttu-id="ba780-332">**Dodaj nowy las**</span><span class="sxs-lookup"><span data-stu-id="ba780-332">**Add a new forest**</span></span><br/> <span data-ttu-id="ba780-333">**Nazwa domeny głównej** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="ba780-333">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="ba780-334">**Opcje kontrolera domeny**</span><span class="sxs-lookup"><span data-stu-id="ba780-334">**Domain Controller Options**</span></span> |<span data-ttu-id="ba780-335">**Hasło trybu DSRM** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-335">**DSRM Password** = Contoso!0000</span></span><br/><span data-ttu-id="ba780-336">**Potwierdź hasło** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-336">**Confirm Password** = Contoso!0000</span></span> |
14. <span data-ttu-id="ba780-337">Kliknij przycisk **dalej** przechodzić przez innych stron w kreatorze.</span><span class="sxs-lookup"><span data-stu-id="ba780-337">Click **Next** to go through the other pages in the wizard.</span></span> <span data-ttu-id="ba780-338">Na **Sprawdzanie wymagań wstępnych** upewnij się, że zostanie wyświetlony następujący komunikat: **sprawdzanie wszystkich wymagań wstępnych zakończyło się pomyślnie**.</span><span class="sxs-lookup"><span data-stu-id="ba780-338">On the **Prerequisites Check** page, verify that you see the following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="ba780-339">Możesz przejrzeć wszystkie odpowiednie komunikaty ostrzegawcze, ale można kontynuować instalację.</span><span class="sxs-lookup"><span data-stu-id="ba780-339">You can review any applicable warning messages, but it's possible to continue with the installation.</span></span>
15. <span data-ttu-id="ba780-340">Kliknij pozycję **Zainstaluj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-340">Click **Install**.</span></span> <span data-ttu-id="ba780-341">**Kontrolerów domeny podstawowej ad** maszyny wirtualnej zostanie automatycznie uruchomiony ponownie.</span><span class="sxs-lookup"><span data-stu-id="ba780-341">The **ad-primary-dc** virtual machine automatically reboots.</span></span>

### <a name="note-the-ip-address-of-the-primary-domain-controller"></a><span data-ttu-id="ba780-342">Należy pamiętać, adres IP podstawowego kontrolera domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-342">Note the IP address of the primary domain controller</span></span>

<span data-ttu-id="ba780-343">Użyj podstawowego kontrolera domeny dla serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="ba780-343">Use the primary domain controller for DNS.</span></span> <span data-ttu-id="ba780-344">Zanotuj adres IP kontrolera domeny głównej.</span><span class="sxs-lookup"><span data-stu-id="ba780-344">Note the primary domain controller IP address.</span></span>

<span data-ttu-id="ba780-345">Jednym ze sposobów uzyskać adres IP kontrolera domeny jest za pośrednictwem portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-345">One way to get the primary domain controller IP address is through the Azure portal.</span></span>

1. <span data-ttu-id="ba780-346">W portalu Azure Otwórz grupę zasobów.</span><span class="sxs-lookup"><span data-stu-id="ba780-346">On the Azure portal, open the resource group.</span></span>

2. <span data-ttu-id="ba780-347">Kliknij przycisk z podstawowym kontrolerem domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-347">Click the primary domain controller.</span></span>

3. <span data-ttu-id="ba780-348">W bloku kontrolera domeny, kliknij **interfejsy sieciowe**.</span><span class="sxs-lookup"><span data-stu-id="ba780-348">On the primary domain controller blade, click **Network interfaces**.</span></span>

![Interfejsy sieciowe](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/25-primarydcip.png)

<span data-ttu-id="ba780-350">Należy pamiętać, prywatnego adresu IP dla tego serwera.</span><span class="sxs-lookup"><span data-stu-id="ba780-350">Note the private IP address for this server.</span></span>

### <a name="configure-the-virtual-network-dns"></a><span data-ttu-id="ba780-351">Skonfiguruj sieć wirtualną DNS</span><span class="sxs-lookup"><span data-stu-id="ba780-351">Configure the virtual network DNS</span></span>
<span data-ttu-id="ba780-352">Po utworzeniu pierwszego kontrolera domeny i włączyć na pierwszym serwerze DNS, należy skonfigurować wirtualnej sieci do używania tego serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="ba780-352">After you create the first domain controller and enable DNS on the first server, configure the virtual network to use this server for DNS.</span></span>

1. <span data-ttu-id="ba780-353">W portalu Azure kliknij w sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ba780-353">In the Azure portal, click on the virtual network.</span></span>

2. <span data-ttu-id="ba780-354">W obszarze **ustawienia**, kliknij przycisk **serwera DNS**.</span><span class="sxs-lookup"><span data-stu-id="ba780-354">Under **Settings**, click **DNS Server**.</span></span>

3. <span data-ttu-id="ba780-355">Kliknij przycisk **niestandardowe**i wpisz prywatny adres IP podstawowego kontrolera domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-355">Click **Custom**, and type the private IP address of the primary domain controller.</span></span>

4. <span data-ttu-id="ba780-356">Kliknij pozycję **Zapisz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-356">Click **Save**.</span></span>

### <a name="configure-the-second-domain-controller"></a><span data-ttu-id="ba780-357">Konfigurowanie kontrolera domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-357">Configure the second domain controller</span></span>
<span data-ttu-id="ba780-358">Po ponownym uruchomieniu podstawowego kontrolera domeny, można skonfigurować kontrolera domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-358">After the primary domain controller reboots, you can configure the second domain controller.</span></span> <span data-ttu-id="ba780-359">Jest to krok opcjonalny wysokiej dostępności.</span><span class="sxs-lookup"><span data-stu-id="ba780-359">This optional step is for high availability.</span></span> <span data-ttu-id="ba780-360">Wykonaj następujące kroki, aby skonfigurować kontrolera domeny:</span><span class="sxs-lookup"><span data-stu-id="ba780-360">Follow these steps to configure the second domain controller:</span></span>

1. <span data-ttu-id="ba780-361">W portalu, otwórz **SQL-HA-zarządcy zasobów** zasobu, grupy i wybierz **kontrolerów domeny pomocniczy ad** maszyny.</span><span class="sxs-lookup"><span data-stu-id="ba780-361">In the portal, open the **SQL-HA-RG** resource group and select the **ad-secondary-dc** machine.</span></span> <span data-ttu-id="ba780-362">Na **kontrolerów domeny pomocniczy ad** bloku, kliknij przycisk **Connect** można otworzyć pliku RDP do dostępu do pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="ba780-362">On the **ad-secondary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>
2. <span data-ttu-id="ba780-363">Zaloguj się do maszyny Wirtualnej przy użyciu konta administratora skonfigurowane (**BUILTIN\DomainAdmin**) i hasło (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="ba780-363">Sign in to the VM by using your configured administrator account (**BUILTIN\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="ba780-364">Zmienianie adresu preferowanego serwera DNS na adres kontrolera domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-364">Change the preferred DNS server address to the address of the domain controller.</span></span>
4. <span data-ttu-id="ba780-365">W **Centrum sieci i udostępniania**, kliknij przycisk interfejsu sieciowego.</span><span class="sxs-lookup"><span data-stu-id="ba780-365">In **Network and Sharing Center**, click the network interface.</span></span>
   <span data-ttu-id="ba780-366">![Interfejs sieciowy](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span><span class="sxs-lookup"><span data-stu-id="ba780-366">![Network interface](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span></span>

5. <span data-ttu-id="ba780-367">Kliknij pozycję **Właściwości**.</span><span class="sxs-lookup"><span data-stu-id="ba780-367">Click **Properties**.</span></span>
6. <span data-ttu-id="ba780-368">Wybierz **protokół internetowy w wersji 4 (TCP/IPv4)** i kliknij przycisk **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="ba780-368">Select **Internet Protocol Version 4 (TCP/IPv4)** and click **Properties**.</span></span>
7. <span data-ttu-id="ba780-369">Wybierz **Użyj następujących adresów serwerów DNS** i określenie adresu podstawowego kontrolera domeny w **preferowany serwer DNS**.</span><span class="sxs-lookup"><span data-stu-id="ba780-369">Select **Use the following DNS server addresses** and specify the address of the primary domain controller in **Preferred DNS server**.</span></span>
8. <span data-ttu-id="ba780-370">Kliknij przycisk **OK**, a następnie **Zamknij** aby zatwierdzić zmiany.</span><span class="sxs-lookup"><span data-stu-id="ba780-370">Click **OK**, and then **Close** to commit the changes.</span></span> <span data-ttu-id="ba780-371">Jesteś teraz maszyny Wirtualnej, aby przyłączyć się do **corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="ba780-371">You are now able to join the VM to **corp.contoso.com**.</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="ba780-372">W przypadku utraty połączenia z pulpitem zdalnym po zmianie ustawienia DNS, przejdź do portalu Azure i uruchom ponownie maszynę wirtualną.</span><span class="sxs-lookup"><span data-stu-id="ba780-372">If you lose the connection to your remote desktop after changing the DNS setting, go to the Azure portal and restart the virtual machine.</span></span>

9. <span data-ttu-id="ba780-373">Korzystając z pulpitu zdalnego na kontrolerze domeny dodatkowej, otwórz **pulpitu nawigacyjnego Menedżera serwera**.</span><span class="sxs-lookup"><span data-stu-id="ba780-373">From the remote desktop to the secondary domain controller, open **Server Manager Dashboard**.</span></span>
10. <span data-ttu-id="ba780-374">Kliknij przycisk **Dodaj role i funkcje** łącza na pulpicie nawigacyjnym.</span><span class="sxs-lookup"><span data-stu-id="ba780-374">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Menedżer serwera — Dodawanie ról](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
11. <span data-ttu-id="ba780-376">Wybierz **dalej** aż do **ról serwera** sekcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-376">Select **Next** until you get to the **Server Roles** section.</span></span>
12. <span data-ttu-id="ba780-377">Wybierz **usług domenowych w usłudze Active Directory** i **serwera DNS** ról.</span><span class="sxs-lookup"><span data-stu-id="ba780-377">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="ba780-378">Po wyświetleniu monitu, Dodaj wszelkie dodatkowe funkcje, które są wymagane przez tych ról.</span><span class="sxs-lookup"><span data-stu-id="ba780-378">When you're prompted, add any additional features that are required by these roles.</span></span>
13. <span data-ttu-id="ba780-379">Po funkcji zakończyć instalację, wróć do **Menedżera serwera** pulpitu nawigacyjnego.</span><span class="sxs-lookup"><span data-stu-id="ba780-379">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
14. <span data-ttu-id="ba780-380">Wybierz nową **usług AD DS** opcji w okienku po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="ba780-380">Select the new **AD DS** option on the left-hand pane.</span></span>
15. <span data-ttu-id="ba780-381">Kliknij przycisk **więcej** łącze na żółty pasek ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="ba780-381">Click the **More** link on the yellow warning bar.</span></span>
16. <span data-ttu-id="ba780-382">W **akcji** kolumny **wszystkie szczegóły zadania serwera** okna dialogowego, kliknij przycisk **podwyższyć ten serwer do poziomu kontrolera domeny**.</span><span class="sxs-lookup"><span data-stu-id="ba780-382">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
17. <span data-ttu-id="ba780-383">W obszarze **konfiguracji wdrożenia**, wybierz pozycję **dodać kontroler domeny do istniejącej domeny**.</span><span class="sxs-lookup"><span data-stu-id="ba780-383">Under **Deployment Configuration**, select **Add a domain controller to an existing domain**.</span></span>
   <span data-ttu-id="ba780-384">![Konfiguracja wdrażania](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span><span class="sxs-lookup"><span data-stu-id="ba780-384">![Deployment configuration](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span></span>
18. <span data-ttu-id="ba780-385">Kliknij pozycję **Wybierz**.</span><span class="sxs-lookup"><span data-stu-id="ba780-385">Click **Select**.</span></span>
19. <span data-ttu-id="ba780-386">Połącz przy użyciu konta administratora (**CORP. CONTOSO.COM\domainadmin**) i hasło (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="ba780-386">Connect by using the administrator account (**CORP.CONTOSO.COM\domainadmin**) and password (**Contoso!0000**).</span></span>
20. <span data-ttu-id="ba780-387">W **wybierz domenę z lasu**, kliknij swoją domenę, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-387">In **Select a domain from the forest**, click your domain, and then click **OK**.</span></span>
21. <span data-ttu-id="ba780-388">W **opcje kontrolera domeny**, użyj wartości domyślnych i ustaw hasło DSRM.</span><span class="sxs-lookup"><span data-stu-id="ba780-388">In **Domain Controller Options**, use the default values and set a DSRM password.</span></span>

   >[!NOTE]
   ><span data-ttu-id="ba780-389">**Opcje DNS** strony może ostrzeżenie, że nie można utworzyć delegowania dla tego serwera DNS.</span><span class="sxs-lookup"><span data-stu-id="ba780-389">The **DNS Options** page might warn you that a delegation for this DNS server can't be created.</span></span> <span data-ttu-id="ba780-390">Można zignorować to ostrzeżenie w środowiskach nieprodukcyjnych.</span><span class="sxs-lookup"><span data-stu-id="ba780-390">You can ignore this warning in non-production environments.</span></span>
22. <span data-ttu-id="ba780-391">Kliknij przycisk **dalej** do momentu osiągnięcia okna dialogowego **wymagania wstępne** Sprawdź.</span><span class="sxs-lookup"><span data-stu-id="ba780-391">Click **Next** until the dialog reaches the **Prerequisites** check.</span></span> <span data-ttu-id="ba780-392">Następnie kliknij pozycję **Zainstaluj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-392">Then click **Install**.</span></span>

<span data-ttu-id="ba780-393">Po zakończeniu zmiany konfiguracji, uruchom ponownie serwer.</span><span class="sxs-lookup"><span data-stu-id="ba780-393">After the server finishes the configuration changes, restart the server.</span></span>

### <a name="add-the-private-ip-address-to-the-second-domain-controller-to-the-vpn-dns-server"></a><span data-ttu-id="ba780-394">Dodaj prywatny adres IP do kontrolera domeny na serwerze DNS sieci VPN</span><span class="sxs-lookup"><span data-stu-id="ba780-394">Add the Private IP Address to the second domain controller to the VPN DNS Server</span></span>

<span data-ttu-id="ba780-395">W portalu Azure w ramach sieci wirtualnej należy zmienić obejmują adres IP kontrolera domeny pomocniczy serwer DNS.</span><span class="sxs-lookup"><span data-stu-id="ba780-395">In the Azure portal, under virtual network, change the DNS Server to include the IP address of the secondary domain controller.</span></span> <span data-ttu-id="ba780-396">Dzięki temu nadmiarowości usługi DNS.</span><span class="sxs-lookup"><span data-stu-id="ba780-396">This allows the DNS service redundancy.</span></span>

### <span data-ttu-id="ba780-397"><a name=DomainAccounts></a>Konfigurowanie kont domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-397"><a name=DomainAccounts></a> Configure the domain accounts</span></span>

<span data-ttu-id="ba780-398">W następnych krokach konfigurowania kont usługi Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ba780-398">In the next steps, you configure the Active Directory accounts.</span></span> <span data-ttu-id="ba780-399">W poniższej tabeli przedstawiono kont:</span><span class="sxs-lookup"><span data-stu-id="ba780-399">The following table shows the accounts:</span></span>

| |<span data-ttu-id="ba780-400">Konto instalacji</span><span class="sxs-lookup"><span data-stu-id="ba780-400">Installation account</span></span><br/> |<span data-ttu-id="ba780-401">SQLServer 0</span><span class="sxs-lookup"><span data-stu-id="ba780-401">sqlserver-0</span></span> <br/><span data-ttu-id="ba780-402">Konto programu SQL Server i usługi agenta SQL</span><span class="sxs-lookup"><span data-stu-id="ba780-402">SQL Server and SQL Agent Service account</span></span> |<span data-ttu-id="ba780-403">SQLServer-1</span><span class="sxs-lookup"><span data-stu-id="ba780-403">sqlserver-1</span></span><br/><span data-ttu-id="ba780-404">Konto programu SQL Server i usługi agenta SQL</span><span class="sxs-lookup"><span data-stu-id="ba780-404">SQL Server and SQL Agent Service account</span></span>
| --- | --- | --- | ---
|<span data-ttu-id="ba780-405">**Imię**</span><span class="sxs-lookup"><span data-stu-id="ba780-405">**First Name**</span></span> |<span data-ttu-id="ba780-406">Instalowanie</span><span class="sxs-lookup"><span data-stu-id="ba780-406">Install</span></span> |<span data-ttu-id="ba780-407">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="ba780-407">SQLSvc1</span></span> | <span data-ttu-id="ba780-408">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="ba780-408">SQLSvc2</span></span>
|<span data-ttu-id="ba780-409">**SamAccountName użytkownika**</span><span class="sxs-lookup"><span data-stu-id="ba780-409">**User SamAccountName**</span></span> |<span data-ttu-id="ba780-410">Instalowanie</span><span class="sxs-lookup"><span data-stu-id="ba780-410">Install</span></span> |<span data-ttu-id="ba780-411">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="ba780-411">SQLSvc1</span></span> | <span data-ttu-id="ba780-412">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="ba780-412">SQLSvc2</span></span>

<span data-ttu-id="ba780-413">Poniższe kroki umożliwiają utworzenie poszczególnych kont.</span><span class="sxs-lookup"><span data-stu-id="ba780-413">Use the following steps to create each account.</span></span>

1. <span data-ttu-id="ba780-414">Zaloguj się do **kontrolerów domeny podstawowej ad** maszyny.</span><span class="sxs-lookup"><span data-stu-id="ba780-414">Sign in to the **ad-primary-dc** machine.</span></span>
2. <span data-ttu-id="ba780-415">W **Menedżera serwera**, wybierz pozycję **narzędzia**, a następnie kliknij przycisk **Centrum administracyjne usługi Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="ba780-415">In **Server Manager**, select **Tools**, and then click **Active Directory Administrative Center**.</span></span>   
3. <span data-ttu-id="ba780-416">Wybierz **corp (lokalna)** w lewym okienku.</span><span class="sxs-lookup"><span data-stu-id="ba780-416">Select **corp (local)** from the left pane.</span></span>
4. <span data-ttu-id="ba780-417">Po prawej stronie **zadania** okienku wybierz **nowy**, a następnie kliknij przycisk **użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="ba780-417">On the right **Tasks** pane, select **New**, and then click **User**.</span></span>
   <span data-ttu-id="ba780-418">![Centrum administracyjne usługi Active Directory](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span><span class="sxs-lookup"><span data-stu-id="ba780-418">![Active Directory Administrative Center](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span></span>

   >[!TIP]
   ><span data-ttu-id="ba780-419">Ustaw złożone hasło dla poszczególnych kont.</span><span class="sxs-lookup"><span data-stu-id="ba780-419">Set a complex password for each account.</span></span><br/> <span data-ttu-id="ba780-420">W środowiskach nieprodukcyjnych ustawić konta użytkownika nigdy nie wygasa.</span><span class="sxs-lookup"><span data-stu-id="ba780-420">For non-production environments, set the user account to never expire.</span></span>

5. <span data-ttu-id="ba780-421">Kliknij przycisk **OK** do utworzenia użytkownika.</span><span class="sxs-lookup"><span data-stu-id="ba780-421">Click **OK** to create the user.</span></span>
6. <span data-ttu-id="ba780-422">Powtórz poprzednie kroki dla każdego z trzech kont.</span><span class="sxs-lookup"><span data-stu-id="ba780-422">Repeat the preceding steps for each of the three accounts.</span></span>

### <a name="grant-the-required-permissions-to-the-installation-account"></a><span data-ttu-id="ba780-423">Udzielanie uprawnień wymaganych do konta instalacji</span><span class="sxs-lookup"><span data-stu-id="ba780-423">Grant the required permissions to the installation account</span></span>
1. <span data-ttu-id="ba780-424">W **Centrum administracyjne usługi Active Directory**, wybierz pozycję **corp (lokalna)** w okienku po lewej stronie.</span><span class="sxs-lookup"><span data-stu-id="ba780-424">In the **Active Directory Administrative Center**, select **corp (local)** in the left pane.</span></span> <span data-ttu-id="ba780-425">Następnie w prawej **zadania** okienku, kliknij przycisk **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="ba780-425">Then in the right-hand **Tasks** pane, click **Properties**.</span></span>

    ![Właściwości użytkownika CORP](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/31-addcproperties.png)
2. <span data-ttu-id="ba780-427">Wybierz **rozszerzenia**, a następnie kliknij przycisk **zaawansowane** znajdującego się na **zabezpieczeń** kartę.</span><span class="sxs-lookup"><span data-stu-id="ba780-427">Select **Extensions**, and then click the **Advanced** button on the **Security** tab.</span></span>
3. <span data-ttu-id="ba780-428">W **Zaawansowane ustawienia zabezpieczeń dla corp** okna dialogowego, kliknij przycisk **Dodaj**.</span><span class="sxs-lookup"><span data-stu-id="ba780-428">In the **Advanced Security Settings for corp** dialog, click **Add**.</span></span>
4. <span data-ttu-id="ba780-429">Kliknij przycisk **Wybierz podmiot zabezpieczeń**, wyszukaj **CORP\Install**, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-429">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
5. <span data-ttu-id="ba780-430">Wybierz **odczytywanie wszystkich właściwości** pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="ba780-430">Select the **Read all properties** check box.</span></span>

6. <span data-ttu-id="ba780-431">Wybierz **Tworzenie obiektów komputerów** pole wyboru.</span><span class="sxs-lookup"><span data-stu-id="ba780-431">Select the **Create Computer objects** check box.</span></span>

     ![Uprawnienia użytkownika Corp](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/33-addpermissions.png)
7. <span data-ttu-id="ba780-433">Kliknij przycisk **OK**, a następnie kliknij przycisk **OK** ponownie.</span><span class="sxs-lookup"><span data-stu-id="ba780-433">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="ba780-434">Zamknij **corp** okna właściwości.</span><span class="sxs-lookup"><span data-stu-id="ba780-434">Close the **corp** properties window.</span></span>

<span data-ttu-id="ba780-435">Teraz, po zakończeniu konfigurowania usługi Active Directory i obiektów użytkowników, Utwórz dwie maszyny wirtualne z serwera SQL i serwera monitora maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ba780-435">Now that you've finished configuring Active Directory and the user objects, create two SQL Server VMs and a witness server VM.</span></span> <span data-ttu-id="ba780-436">Następnie dołącz wszystkie trzy do domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-436">Then join all three to the domain.</span></span>

## <a name="create-sql-server-vms"></a><span data-ttu-id="ba780-437">Tworzenie maszyn wirtualnych programu SQL Server</span><span class="sxs-lookup"><span data-stu-id="ba780-437">Create SQL Server VMs</span></span>

<span data-ttu-id="ba780-438">Utwórz trzy dodatkowe maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="ba780-438">Create three additional virtual machines.</span></span> <span data-ttu-id="ba780-439">Rozwiązanie wymaga dwóch maszyn wirtualnych z wystąpień programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-439">The solution requires two virtual machines with SQL Server instances.</span></span> <span data-ttu-id="ba780-440">Trzeci maszyny wirtualnej będą działać jako monitor.</span><span class="sxs-lookup"><span data-stu-id="ba780-440">A third virtual machine will function as a witness.</span></span> <span data-ttu-id="ba780-441">Można użyć systemu Windows Server 2016 [chmury monitora](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), jednak zgodności ze starszymi systemami operacyjnymi niniejszym dokumencie użyto maszyny wirtualnej dla monitora.</span><span class="sxs-lookup"><span data-stu-id="ba780-441">Windows Server 2016 can use a [cloud witness](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), however for consistency with previous operating systems this document uses a virtual machine for a witness.</span></span>  

<span data-ttu-id="ba780-442">Przed kontynuowaniem należy wziąć pod uwagę następujące decyzje dotyczące deisign.</span><span class="sxs-lookup"><span data-stu-id="ba780-442">Before you proceed consider the following deisign decisions.</span></span>

* <span data-ttu-id="ba780-443">**Magazyn — dyskach zarządzanych Azure**</span><span class="sxs-lookup"><span data-stu-id="ba780-443">**Storage - Azure Managed Disks**</span></span>

   <span data-ttu-id="ba780-444">Do przechowywania maszyn wirtualnych dysków Azure zarządzanych.</span><span class="sxs-lookup"><span data-stu-id="ba780-444">For the virtual machine storage, use Azure Managed Disks.</span></span> <span data-ttu-id="ba780-445">Firma Microsoft zaleca zarządzane dyski dla maszyn wirtualnych programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-445">Microsoft recommends Managed Disks for SQL Server virtual machines.</span></span> <span data-ttu-id="ba780-446">Usługa Managed Disks obsługuje magazyn w tle.</span><span class="sxs-lookup"><span data-stu-id="ba780-446">Managed Disks handles storage behind the scenes.</span></span> <span data-ttu-id="ba780-447">Ponadto jeśli maszyny wirtualne z usługą Managed Disks znajdują się w tym samym zestawie dostępności, platforma Azure dystrybuuje zasoby magazynu w celu zapewnienia odpowiedniej nadmiarowości.</span><span class="sxs-lookup"><span data-stu-id="ba780-447">In addition, when virtual machines with Managed Disks are in the same availability set, Azure distributes the storage resources to provide appropriate redundancy.</span></span> <span data-ttu-id="ba780-448">Aby uzyskać więcej informacji, zobacz [Omówienie usługi Azure Managed Disks](../managed-disks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ba780-448">For additional information, see [Azure Managed Disks Overview](../managed-disks-overview.md).</span></span> <span data-ttu-id="ba780-449">Aby uzyskać szczegóły dotyczące dysków zarządzanych w zestawie dostępności, zobacz [używać dysków zarządzanych maszyn wirtualnych w zestawie dostępności](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="ba780-449">For specifics about managed disks in an availability set, see [Use Managed Disks for VMs in an availability set](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span>

* <span data-ttu-id="ba780-450">**Adresy IP prywatnej sieci — w środowisku produkcyjnym**</span><span class="sxs-lookup"><span data-stu-id="ba780-450">**Network - Private IP addresses in production**</span></span>

   <span data-ttu-id="ba780-451">W przypadku maszyn wirtualnych w tym samouczku korzysta z publicznych adresów IP.</span><span class="sxs-lookup"><span data-stu-id="ba780-451">For the virtual machines, this tutorial uses public IP addresses.</span></span> <span data-ttu-id="ba780-452">Dzięki temu połączenia zdalnego bezpośrednio do maszyny wirtualnej za pośrednictwem Internetu — ułatwia czynności konfiguracyjne.</span><span class="sxs-lookup"><span data-stu-id="ba780-452">This enables remote connection directly to the virtual machine over the internet - it makes configuration steps easier.</span></span> <span data-ttu-id="ba780-453">W środowiskach produkcyjnych firma Microsoft zaleca tylko prywatnych adresów IP w celu zmniejszenia luk wystąpienia programu SQL Server zasobu maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="ba780-453">In production environments, Microsoft recommends only private IP addresses in order to reduce the vulnerability footprint of the SQL Server instance VM resource.</span></span>

### <a name="create-and-configure-the-sql-server-vms"></a><span data-ttu-id="ba780-454">Tworzenie i konfigurowanie maszyn wirtualnych serwera SQL</span><span class="sxs-lookup"><span data-stu-id="ba780-454">Create and configure the SQL Server VMs</span></span>
<span data-ttu-id="ba780-455">Następnie należy utworzyć trzy maszyny wirtualne — dwóch maszyn wirtualnych serwera SQL i maszyny Wirtualnej na dodatkowym węźle klastra.</span><span class="sxs-lookup"><span data-stu-id="ba780-455">Next, create three VMs--two SQL Server VMs and a VM for an additional cluster node.</span></span> <span data-ttu-id="ba780-456">Do tworzenia poszczególnych maszyn wirtualnych, przejdź wstecz do **SQL-HA-zarządcy zasobów** grupy zasobów, kliknij przycisk **Dodaj**, Wyszukiwanie elementu galerii odpowiednie, kliknij przycisk **maszyny wirtualnej**, a następnie kliknij przycisk  **Z galerii**.</span><span class="sxs-lookup"><span data-stu-id="ba780-456">To create each of the VMs, go back to the **SQL-HA-RG** resource group, click **Add**, search for the appropriate gallery item, click **Virtual Machine**, and then click **From Gallery**.</span></span> <span data-ttu-id="ba780-457">Użyj informacji w poniższej tabeli ułatwiają tworzenie maszyn wirtualnych:</span><span class="sxs-lookup"><span data-stu-id="ba780-457">Use the information in the following table to help you create the VMs:</span></span>


| <span data-ttu-id="ba780-458">Strona</span><span class="sxs-lookup"><span data-stu-id="ba780-458">Page</span></span> | <span data-ttu-id="ba780-459">VM1</span><span class="sxs-lookup"><span data-stu-id="ba780-459">VM1</span></span> | <span data-ttu-id="ba780-460">MASZYNY VM2</span><span class="sxs-lookup"><span data-stu-id="ba780-460">VM2</span></span> | <span data-ttu-id="ba780-461">VM3</span><span class="sxs-lookup"><span data-stu-id="ba780-461">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="ba780-462">Wybierz element galerii odpowiednie</span><span class="sxs-lookup"><span data-stu-id="ba780-462">Select the appropriate gallery item</span></span> |<span data-ttu-id="ba780-463">**Windows Server 2016 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="ba780-463">**Windows Server 2016 Datacenter**</span></span> |<span data-ttu-id="ba780-464">**SQL Server 2016 SP1 Enterprise w systemie Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="ba780-464">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |<span data-ttu-id="ba780-465">**SQL Server 2016 SP1 Enterprise w systemie Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="ba780-465">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |
| <span data-ttu-id="ba780-466">Konfiguracja maszyny wirtualnej **podstawy**</span><span class="sxs-lookup"><span data-stu-id="ba780-466">Virtual machine configuration **Basics**</span></span> |<span data-ttu-id="ba780-467">**Nazwa** = fsw klastra</span><span class="sxs-lookup"><span data-stu-id="ba780-467">**Name** = cluster-fsw</span></span><br/><span data-ttu-id="ba780-468">**Nazwa użytkownika** = administrator domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-468">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="ba780-469">**Hasło** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-469">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="ba780-470">**Subskrypcja** = subskrypcji</span><span class="sxs-lookup"><span data-stu-id="ba780-470">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="ba780-471">**Grupa zasobów** = SQL-HA-zarządcy zasobów</span><span class="sxs-lookup"><span data-stu-id="ba780-471">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="ba780-472">**Lokalizacja** = Twojej lokalizacji platformy azure</span><span class="sxs-lookup"><span data-stu-id="ba780-472">**Location** = Your azure location</span></span> |<span data-ttu-id="ba780-473">**Nazwa** sqlserver-0 =</span><span class="sxs-lookup"><span data-stu-id="ba780-473">**Name** = sqlserver-0</span></span><br/><span data-ttu-id="ba780-474">**Nazwa użytkownika** = administrator domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-474">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="ba780-475">**Hasło** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-475">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="ba780-476">**Subskrypcja** = subskrypcji</span><span class="sxs-lookup"><span data-stu-id="ba780-476">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="ba780-477">**Grupa zasobów** = SQL-HA-zarządcy zasobów</span><span class="sxs-lookup"><span data-stu-id="ba780-477">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="ba780-478">**Lokalizacja** = Twojej lokalizacji platformy azure</span><span class="sxs-lookup"><span data-stu-id="ba780-478">**Location** = Your azure location</span></span> |<span data-ttu-id="ba780-479">**Nazwa** sqlserver-1</span><span class="sxs-lookup"><span data-stu-id="ba780-479">**Name** = sqlserver-1</span></span><br/><span data-ttu-id="ba780-480">**Nazwa użytkownika** = administrator domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-480">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="ba780-481">**Hasło** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="ba780-481">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="ba780-482">**Subskrypcja** = subskrypcji</span><span class="sxs-lookup"><span data-stu-id="ba780-482">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="ba780-483">**Grupa zasobów** = SQL-HA-zarządcy zasobów</span><span class="sxs-lookup"><span data-stu-id="ba780-483">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="ba780-484">**Lokalizacja** = Twojej lokalizacji platformy azure</span><span class="sxs-lookup"><span data-stu-id="ba780-484">**Location** = Your azure location</span></span> |
| <span data-ttu-id="ba780-485">Konfiguracja maszyny wirtualnej **rozmiaru**</span><span class="sxs-lookup"><span data-stu-id="ba780-485">Virtual machine configuration **Size**</span></span> |<span data-ttu-id="ba780-486">**ROZMIAR** = DS1\_V2 (1 rdzeń, 3.5 GB)</span><span class="sxs-lookup"><span data-stu-id="ba780-486">**SIZE** = DS1\_V2 (1 core, 3.5 GB)</span></span> |<span data-ttu-id="ba780-487">**ROZMIAR** = DS2\_V2 (2 rdzenie, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="ba780-487">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span></br><span data-ttu-id="ba780-488">Rozmiar musi obsługiwać magazynu SSD (obsługi dysków Premium.</span><span class="sxs-lookup"><span data-stu-id="ba780-488">The size must support SSD storage (Premium disk support.</span></span> <span data-ttu-id="ba780-489">))</span><span class="sxs-lookup"><span data-stu-id="ba780-489">))</span></span> |<span data-ttu-id="ba780-490">**ROZMIAR** = DS2\_V2 (2 rdzenie, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="ba780-490">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span> |
| <span data-ttu-id="ba780-491">Konfiguracja maszyny wirtualnej **ustawienia**</span><span class="sxs-lookup"><span data-stu-id="ba780-491">Virtual machine configuration **Settings**</span></span> |<span data-ttu-id="ba780-492">**Magazyn**: Użyj zarządzanego dysków.</span><span class="sxs-lookup"><span data-stu-id="ba780-492">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="ba780-493">**Sieć wirtualna** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="ba780-493">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="ba780-494">**Podsieci** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="ba780-494">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="ba780-495">**Publiczny adres IP** wygenerowanej automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ba780-495">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="ba780-496">**Grupy zabezpieczeń sieci** = Brak</span><span class="sxs-lookup"><span data-stu-id="ba780-496">**Network security group** = None</span></span><br/><span data-ttu-id="ba780-497">**Monitorowanie diagnostyki** = włączone</span><span class="sxs-lookup"><span data-stu-id="ba780-497">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="ba780-498">**Konto magazynu diagnostyki** = Użyj konta usługi storage automatycznie generowanych</span><span class="sxs-lookup"><span data-stu-id="ba780-498">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="ba780-499">**Zestaw dostępności** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="ba780-499">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="ba780-500">**Magazyn**: Użyj zarządzanego dysków.</span><span class="sxs-lookup"><span data-stu-id="ba780-500">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="ba780-501">**Sieć wirtualna** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="ba780-501">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="ba780-502">**Podsieci** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="ba780-502">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="ba780-503">**Publiczny adres IP** wygenerowanej automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ba780-503">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="ba780-504">**Grupy zabezpieczeń sieci** = Brak</span><span class="sxs-lookup"><span data-stu-id="ba780-504">**Network security group** = None</span></span><br/><span data-ttu-id="ba780-505">**Monitorowanie diagnostyki** = włączone</span><span class="sxs-lookup"><span data-stu-id="ba780-505">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="ba780-506">**Konto magazynu diagnostyki** = Użyj konta usługi storage automatycznie generowanych</span><span class="sxs-lookup"><span data-stu-id="ba780-506">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="ba780-507">**Zestaw dostępności** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="ba780-507">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="ba780-508">**Magazyn**: Użyj zarządzanego dysków.</span><span class="sxs-lookup"><span data-stu-id="ba780-508">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="ba780-509">**Sieć wirtualna** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="ba780-509">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="ba780-510">**Podsieci** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="ba780-510">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="ba780-511">**Publiczny adres IP** wygenerowanej automatycznie.</span><span class="sxs-lookup"><span data-stu-id="ba780-511">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="ba780-512">**Grupy zabezpieczeń sieci** = Brak</span><span class="sxs-lookup"><span data-stu-id="ba780-512">**Network security group** = None</span></span><br/><span data-ttu-id="ba780-513">**Monitorowanie diagnostyki** = włączone</span><span class="sxs-lookup"><span data-stu-id="ba780-513">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="ba780-514">**Konto magazynu diagnostyki** = Użyj konta usługi storage automatycznie generowanych</span><span class="sxs-lookup"><span data-stu-id="ba780-514">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="ba780-515">**Zestaw dostępności** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="ba780-515">**Availability set** = sqlAvailabilitySet</span></span><br/> |
| <span data-ttu-id="ba780-516">Konfiguracja maszyny wirtualnej **ustawienia programu SQL Server**</span><span class="sxs-lookup"><span data-stu-id="ba780-516">Virtual machine configuration **SQL Server settings**</span></span> |<span data-ttu-id="ba780-517">Nie dotyczy</span><span class="sxs-lookup"><span data-stu-id="ba780-517">Not applicable</span></span> |<span data-ttu-id="ba780-518">**Łączność z serwerem SQL** = Private (w ramach sieci wirtualnej)</span><span class="sxs-lookup"><span data-stu-id="ba780-518">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="ba780-519">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="ba780-519">**Port** = 1433</span></span><br/><span data-ttu-id="ba780-520">**Uwierzytelnianie SQL** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-520">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="ba780-521">**Konfiguracja magazynu** = ogólne</span><span class="sxs-lookup"><span data-stu-id="ba780-521">**Storage configuration** = General</span></span><br/><span data-ttu-id="ba780-522">**Automatyczne stosowanie poprawek** = niedziela, 2:00</span><span class="sxs-lookup"><span data-stu-id="ba780-522">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="ba780-523">**Automatyczne kopie zapasowe** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-523">**Automated backup** = Disabled</span></span></br><span data-ttu-id="ba780-524">**Integracja magazynu kluczy Azure** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-524">**Azure Key Vault integration** = Disabled</span></span> |<span data-ttu-id="ba780-525">**Łączność z serwerem SQL** = Private (w ramach sieci wirtualnej)</span><span class="sxs-lookup"><span data-stu-id="ba780-525">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="ba780-526">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="ba780-526">**Port** = 1433</span></span><br/><span data-ttu-id="ba780-527">**Uwierzytelnianie SQL** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-527">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="ba780-528">**Konfiguracja magazynu** = ogólne</span><span class="sxs-lookup"><span data-stu-id="ba780-528">**Storage configuration** = General</span></span><br/><span data-ttu-id="ba780-529">**Automatyczne stosowanie poprawek** = niedziela, 2:00</span><span class="sxs-lookup"><span data-stu-id="ba780-529">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="ba780-530">**Automatyczne kopie zapasowe** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-530">**Automated backup** = Disabled</span></span></br><span data-ttu-id="ba780-531">**Integracja magazynu kluczy Azure** = wyłączone</span><span class="sxs-lookup"><span data-stu-id="ba780-531">**Azure Key Vault integration** = Disabled</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="ba780-532">Rozmiary sugerowane tutaj są przeznaczone do testowania grup dostępności w maszynach wirtualnych platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="ba780-532">The machine sizes suggested here are meant for testing availability groups in Azure VMs.</span></span> <span data-ttu-id="ba780-533">Aby uzyskać najlepszą wydajność w przypadku obciążeń produkcyjnych, zobacz zalecenia dotyczące programu SQL Server rozmiary i konfiguracji [wydajności najlepsze rozwiązania dotyczące programu SQL Server na maszynach wirtualnych Azure](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="ba780-533">For the best performance on production workloads, see the recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure virtual machines](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
>
>

<span data-ttu-id="ba780-534">Po trzy maszyny wirtualne są w pełni zaaprowizowanym, należy połączyć je **corp.contoso.com** domeny i przyznać prawa administracyjne CORP\Install maszyn.</span><span class="sxs-lookup"><span data-stu-id="ba780-534">After the three VMs are fully provisioned, you need to join them to the **corp.contoso.com** domain and grant CORP\Install administrative rights to the machines.</span></span>

### <span data-ttu-id="ba780-535"><a name="joinDomain"></a>Przyłącz serwer do domeny</span><span class="sxs-lookup"><span data-stu-id="ba780-535"><a name="joinDomain"></a>Join the servers to the domain</span></span>

<span data-ttu-id="ba780-536">Teraz możesz dołączyć maszyn wirtualnych do **corp.contoso.com**. Wykonaj następujące czynności dla maszyn wirtualnych serwera SQL i serwera monitora udziału plików:</span><span class="sxs-lookup"><span data-stu-id="ba780-536">You're now able to join the VMs to **corp.contoso.com**. Do the following for both the SQL Server VMs and the file share witness server:</span></span>

1. <span data-ttu-id="ba780-537">Zdalne połączenia z maszyną wirtualną o **BUILTIN\DomainAdmin**.</span><span class="sxs-lookup"><span data-stu-id="ba780-537">Remotely connect to the virtual machine with **BUILTIN\DomainAdmin**.</span></span>
2. <span data-ttu-id="ba780-538">W **Menedżera serwera**, kliknij przycisk **lokalnego serwera**.</span><span class="sxs-lookup"><span data-stu-id="ba780-538">In **Server Manager**, click **Local Server**.</span></span>
3. <span data-ttu-id="ba780-539">Kliknij przycisk **grupy roboczej** łącza.</span><span class="sxs-lookup"><span data-stu-id="ba780-539">Click the **WORKGROUP** link.</span></span>
4. <span data-ttu-id="ba780-540">W **nazwy komputera** kliknij **zmiany**.</span><span class="sxs-lookup"><span data-stu-id="ba780-540">In the **Computer Name** section, click **Change**.</span></span>
5. <span data-ttu-id="ba780-541">Wybierz **domeny** pole wyboru i wpisz **corp.contoso.com** w polu tekstowym.</span><span class="sxs-lookup"><span data-stu-id="ba780-541">Select the **Domain** check box and type **corp.contoso.com** in the text box.</span></span> <span data-ttu-id="ba780-542">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-542">Click **OK**.</span></span>
6. <span data-ttu-id="ba780-543">W **zabezpieczenia systemu Windows** okno podręczne, podaj poświadczenia dla konta administratora domeny domyślnej (**CORP\DomainAdmin**) i hasło (**Contoso! 0000**) .</span><span class="sxs-lookup"><span data-stu-id="ba780-543">In the **Windows Security** popup dialog, specify the credentials for the default domain administrator account (**CORP\DomainAdmin**) and the password (**Contoso!0000**).</span></span>
7. <span data-ttu-id="ba780-544">Gdy zostanie wyświetlony komunikat "Zapraszamy do domeny corp.contoso.com", kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-544">When you see the "Welcome to the corp.contoso.com domain" message, click **OK**.</span></span>
8. <span data-ttu-id="ba780-545">Kliknij przycisk **Zamknij**, a następnie kliknij przycisk **Uruchom ponownie teraz** w oknie podręcznym.</span><span class="sxs-lookup"><span data-stu-id="ba780-545">Click **Close**, and then click **Restart Now** in the popup dialog.</span></span>

### <a name="add-the-corpinstall-user-as-an-administrator-on-each-cluster-vm"></a><span data-ttu-id="ba780-546">Dodaj użytkownika Corp\Install jako administrator na każdym klastrze maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="ba780-546">Add the Corp\Install user as an administrator on each cluster VM</span></span>

<span data-ttu-id="ba780-547">Po uruchomieniu każdej maszyny wirtualnej jest członkiem domeny, Dodaj **CORP\Install** jako członek lokalnej grupy administratorów.</span><span class="sxs-lookup"><span data-stu-id="ba780-547">After each virtual machine restarts as a member of the domain, add **CORP\Install** as a member of the local administrators group.</span></span>

1. <span data-ttu-id="ba780-548">Poczekaj, aż do ponownego uruchomienia maszyny Wirtualnej, a następnie uruchom ponownie z podstawowego kontrolera domeny do logowania się w pliku RDP **sqlserver 0** za pomocą **CORP\DomainAdmin** konta.</span><span class="sxs-lookup"><span data-stu-id="ba780-548">Wait until the VM is restarted, then launch the RDP file again from the primary domain controller to sign in to **sqlserver-0** by using the **CORP\DomainAdmin** account.</span></span>
   >[!TIP]
   ><span data-ttu-id="ba780-549">Upewnij się, że zalogujesz się przy użyciu konta administratora domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-549">Make sure that you sign in with the domain administrator account.</span></span> <span data-ttu-id="ba780-550">W poprzednich krokach zostały przy użyciu konta administratora w SKOMPILOWANY.</span><span class="sxs-lookup"><span data-stu-id="ba780-550">In the previous steps, you were using the BUILT IN administrator account.</span></span> <span data-ttu-id="ba780-551">Teraz, że serwer jest w domenie, należy użyć konta domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-551">Now that the server is in the domain, use the domain account.</span></span> <span data-ttu-id="ba780-552">W sesji protokołu RDP, określ *domeny*\\*username*.</span><span class="sxs-lookup"><span data-stu-id="ba780-552">In your RDP session, specify *DOMAIN*\\*username*.</span></span>

2. <span data-ttu-id="ba780-553">W **Menedżera serwera**, wybierz pozycję **narzędzia**, a następnie kliknij przycisk **Zarządzanie komputerem**.</span><span class="sxs-lookup"><span data-stu-id="ba780-553">In **Server Manager**, select **Tools**, and then click **Computer Management**.</span></span>
3. <span data-ttu-id="ba780-554">W **Zarządzanie komputerem** okna, rozwiń węzeł **lokalnych użytkowników i grup**, a następnie wybierz **grup**.</span><span class="sxs-lookup"><span data-stu-id="ba780-554">In the **Computer Management** window, expand **Local Users and Groups**, and then select **Groups**.</span></span>
4. <span data-ttu-id="ba780-555">Kliknij dwukrotnie **Administratorzy** grupy.</span><span class="sxs-lookup"><span data-stu-id="ba780-555">Double-click the **Administrators** group.</span></span>
5. <span data-ttu-id="ba780-556">W **właściwości Administratorzy** okna dialogowego, kliknij przycisk **Dodaj** przycisku.</span><span class="sxs-lookup"><span data-stu-id="ba780-556">In the **Administrators Properties** dialog, click the **Add** button.</span></span>
6. <span data-ttu-id="ba780-557">Wprowadź nazwę danego użytkownika **CORP\Install**, a następnie kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-557">Enter the user **CORP\Install**, and then click **OK**.</span></span>
7. <span data-ttu-id="ba780-558">Kliknij przycisk **OK** zamknąć **właściwości administratora** okna dialogowego.</span><span class="sxs-lookup"><span data-stu-id="ba780-558">Click **OK** to close the **Administrator Properties** dialog.</span></span>
8. <span data-ttu-id="ba780-559">Powtórz poprzednie kroki na **sqlserver 1** i **fsw klastra**.</span><span class="sxs-lookup"><span data-stu-id="ba780-559">Repeat the previous steps on **sqlserver-1** and **cluster-fsw**.</span></span>

### <span data-ttu-id="ba780-560"><a name="setServiceAccount"></a>Ustawianie konta usługi programu SQL Server</span><span class="sxs-lookup"><span data-stu-id="ba780-560"><a name="setServiceAccount"></a>Set the SQL Server service accounts</span></span>

<span data-ttu-id="ba780-561">Na każdej maszynie Wirtualnej serwera SQL ustawić konto usługi programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-561">On each SQL Server VM, set the SQL Server service account.</span></span> <span data-ttu-id="ba780-562">Użyj konta, które zostały utworzone podczas obliczania możesz [skonfigurowane konta domeny](#DomainAccounts).</span><span class="sxs-lookup"><span data-stu-id="ba780-562">Use the accounts that you created when you [configured the domain accounts](#DomainAccounts).</span></span>

1. <span data-ttu-id="ba780-563">Otwórz **programu SQL Server Configuration Manager**.</span><span class="sxs-lookup"><span data-stu-id="ba780-563">Open **SQL Server Configuration Manager**.</span></span>
2. <span data-ttu-id="ba780-564">Kliknij prawym przyciskiem myszy usługę programu SQL Server, a następnie kliknij przycisk **właściwości**.</span><span class="sxs-lookup"><span data-stu-id="ba780-564">Right-click the SQL Server service, and then click **Properties**.</span></span>
3. <span data-ttu-id="ba780-565">Ustaw nazwę konta i hasło.</span><span class="sxs-lookup"><span data-stu-id="ba780-565">Set the account and password.</span></span>
4. <span data-ttu-id="ba780-566">Powtórz te kroki dla innych maszyn wirtualnych serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-566">Repeat these steps on the other SQL Server VM.</span></span>  

<span data-ttu-id="ba780-567">Dla grup dostępności programu SQL Server każda z maszyn wirtualnych serwera SQL musi być uruchamiane jako konto domeny.</span><span class="sxs-lookup"><span data-stu-id="ba780-567">For SQL Server availability groups, each SQL Server VM needs to run as a domain account.</span></span>

### <a name="create-a-sign-in-on-each-sql-server-vm-for-the-installation-account"></a><span data-ttu-id="ba780-568">Utwórz logowanie na każdej maszynie Wirtualnej serwera SQL dla konta instalacji</span><span class="sxs-lookup"><span data-stu-id="ba780-568">Create a sign-in on each SQL Server VM for the installation account</span></span>

<span data-ttu-id="ba780-569">Aby skonfigurować grupę dostępności, należy użyć konta instalacji (CORP\install).</span><span class="sxs-lookup"><span data-stu-id="ba780-569">Use the installation account (CORP\install) to configure the availability group.</span></span> <span data-ttu-id="ba780-570">To konto musi być członkiem **sysadmin** stałej roli serwera na każdej maszynie Wirtualnej serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-570">This account needs to be a member of the **sysadmin** fixed server role on each SQL Server VM.</span></span> <span data-ttu-id="ba780-571">Poniższe kroki tworzenia logowanie dla konta instalacji:</span><span class="sxs-lookup"><span data-stu-id="ba780-571">The following steps create a sign-in for the installation account:</span></span>

1. <span data-ttu-id="ba780-572">Połączyć się z serwerem za pośrednictwem protokołu RDP (Remote Desktop) przy użyciu  *\<MachineName\>\DomainAdmin* konta.</span><span class="sxs-lookup"><span data-stu-id="ba780-572">Connect to the server through the Remote Desktop Protocol (RDP) by using the *\<MachineName\>\DomainAdmin* account.</span></span>

1. <span data-ttu-id="ba780-573">Otwórz program SQL Server Management Studio i Połącz z lokalnym wystąpieniem programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-573">Open SQL Server Management Studio and connect to the local instance of SQL Server.</span></span>

1. <span data-ttu-id="ba780-574">W **Eksplorator obiektów**, kliknij przycisk **zabezpieczeń**.</span><span class="sxs-lookup"><span data-stu-id="ba780-574">In **Object Explorer**, click **Security**.</span></span>

1. <span data-ttu-id="ba780-575">Kliknij prawym przyciskiem myszy **logowania**.</span><span class="sxs-lookup"><span data-stu-id="ba780-575">Right-click **Logins**.</span></span> <span data-ttu-id="ba780-576">Kliknij przycisk **nowe dane logowania**.</span><span class="sxs-lookup"><span data-stu-id="ba780-576">Click **New Login**.</span></span>

1. <span data-ttu-id="ba780-577">W **nowe dane logowania -**, kliknij przycisk **wyszukiwania**.</span><span class="sxs-lookup"><span data-stu-id="ba780-577">In **Login - New**, click **Search**.</span></span>

1. <span data-ttu-id="ba780-578">Kliknij przycisk **lokalizacje**.</span><span class="sxs-lookup"><span data-stu-id="ba780-578">Click **Locations**.</span></span>

1. <span data-ttu-id="ba780-579">Wprowadź poświadczenia domeny administratora sieci.</span><span class="sxs-lookup"><span data-stu-id="ba780-579">Enter the domain administrator network credentials.</span></span>

1. <span data-ttu-id="ba780-580">Użyj konta instalacji.</span><span class="sxs-lookup"><span data-stu-id="ba780-580">Use the installation account.</span></span>

1. <span data-ttu-id="ba780-581">Ustaw Logowanie jako członek **sysadmin** stałej roli serwera.</span><span class="sxs-lookup"><span data-stu-id="ba780-581">Set the sign-in to be a member of the **sysadmin** fixed server role.</span></span>

1. <span data-ttu-id="ba780-582">Kliknij przycisk **OK**.</span><span class="sxs-lookup"><span data-stu-id="ba780-582">Click **OK**.</span></span>

<span data-ttu-id="ba780-583">Powtórz te czynności na innych maszyn wirtualnych serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-583">Repeat the preceding steps on the other SQL Server VM.</span></span>

## <a name="add-failover-clustering-features-to-both-sql-server-vms"></a><span data-ttu-id="ba780-584">Dodawanie funkcji klastra trybu Failover na obu maszynach wirtualnych serwera SQL</span><span class="sxs-lookup"><span data-stu-id="ba780-584">Add Failover Clustering features to both SQL Server VMs</span></span>

<span data-ttu-id="ba780-585">Aby dodać funkcje klaster trybu Failover, wykonaj następujące czynności na obu maszynach wirtualnych serwera SQL:</span><span class="sxs-lookup"><span data-stu-id="ba780-585">To add Failover Clustering features, do the following on both SQL Server VMs:</span></span>

1. <span data-ttu-id="ba780-586">Połączenie z maszyną wirtualną programu SQL Server za pośrednictwem protokołu RDP (Remote Desktop) przy użyciu *CORP\install* konta.</span><span class="sxs-lookup"><span data-stu-id="ba780-586">Connect to the SQL Server virtual machine through the Remote Desktop Protocol (RDP) by using the *CORP\install* account.</span></span> <span data-ttu-id="ba780-587">Otwórz **pulpitu nawigacyjnego Menedżera serwera**.</span><span class="sxs-lookup"><span data-stu-id="ba780-587">Open **Server Manager Dashboard**.</span></span>
2. <span data-ttu-id="ba780-588">Kliknij przycisk **Dodaj role i funkcje** łącza na pulpicie nawigacyjnym.</span><span class="sxs-lookup"><span data-stu-id="ba780-588">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Menedżer serwera — Dodawanie ról](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
3. <span data-ttu-id="ba780-590">Wybierz **dalej** aż do **funkcji serwera** sekcji.</span><span class="sxs-lookup"><span data-stu-id="ba780-590">Select **Next** until you get to the **Server Features** section.</span></span>
4. <span data-ttu-id="ba780-591">W **funkcje**, wybierz pozycję **klaster pracy awaryjnej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-591">In **Features**, select **Failover Clustering**.</span></span>
5. <span data-ttu-id="ba780-592">Dodaj wszelkie dodatkowe funkcje wymagane.</span><span class="sxs-lookup"><span data-stu-id="ba780-592">Add any additional required features.</span></span>
6. <span data-ttu-id="ba780-593">Kliknij przycisk **zainstalować** Aby dodać funkcje.</span><span class="sxs-lookup"><span data-stu-id="ba780-593">Click **Install** to add the features.</span></span>

<span data-ttu-id="ba780-594">Powtórz kroki na inne maszyny Wirtualnej serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-594">Repeat the steps on the other SQL Server VM.</span></span>

## <a name="a-nameendpoint-firewall-configure-the-firewall-on-each-sql-server-vm"></a><span data-ttu-id="ba780-595"><a name="endpoint-firewall">Skonfigurować zaporę na każdej maszynie Wirtualnej serwera SQL</span><span class="sxs-lookup"><span data-stu-id="ba780-595"><a name="endpoint-firewall"> Configure the firewall on each SQL Server VM</span></span>

<span data-ttu-id="ba780-596">Rozwiązanie wymaga następujące porty TCP, aby być otwarty w zaporze:</span><span class="sxs-lookup"><span data-stu-id="ba780-596">The solution requires the following TCP ports to be open in the firewall:</span></span>

- <span data-ttu-id="ba780-597">**Program SQL Server wirtualna**:</span><span class="sxs-lookup"><span data-stu-id="ba780-597">**SQL Server VM**:</span></span><br/>
   <span data-ttu-id="ba780-598">Port 1433 dla domyślnego wystąpienia programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-598">Port 1433 for a default instance of SQL Server.</span></span>
- <span data-ttu-id="ba780-599">**Sondę modułu równoważenia obciążenia Azure:**</span><span class="sxs-lookup"><span data-stu-id="ba780-599">**Azure load balancer probe:**</span></span><br/>
   <span data-ttu-id="ba780-600">Dowolny dostępny port.</span><span class="sxs-lookup"><span data-stu-id="ba780-600">Any available port.</span></span> <span data-ttu-id="ba780-601">Przykłady często używają 59999.</span><span class="sxs-lookup"><span data-stu-id="ba780-601">Examples frequently use 59999.</span></span>
- <span data-ttu-id="ba780-602">**Punktu końcowego dublowania bazy danych:**</span><span class="sxs-lookup"><span data-stu-id="ba780-602">**Database mirroring endpoint:**</span></span> <br/>
   <span data-ttu-id="ba780-603">Dowolny dostępny port.</span><span class="sxs-lookup"><span data-stu-id="ba780-603">Any available port.</span></span> <span data-ttu-id="ba780-604">Przykłady często używają 5022.</span><span class="sxs-lookup"><span data-stu-id="ba780-604">Examples frequently use 5022.</span></span>

<span data-ttu-id="ba780-605">Porty zapory muszą być otwarte na obu maszynach wirtualnych serwera SQL.</span><span class="sxs-lookup"><span data-stu-id="ba780-605">The firewall ports need to be open on both SQL Server VMs.</span></span>

<span data-ttu-id="ba780-606">Metoda otwarcia portów zależy od zaporę, którego używasz.</span><span class="sxs-lookup"><span data-stu-id="ba780-606">The method of opening the ports depends on the firewall solution that you use.</span></span> <span data-ttu-id="ba780-607">W następnej sekcji objaśniono sposób otwierania portów w Zaporze systemu Windows.</span><span class="sxs-lookup"><span data-stu-id="ba780-607">The next section explains how to open the ports in Windows Firewall.</span></span> <span data-ttu-id="ba780-608">Otwórz wymagane porty dla wszystkich maszyn wirtualnych programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-608">Open the required ports on each of your SQL Server VMs.</span></span>

### <a name="open-a-tcp-port-in-the-firewall"></a><span data-ttu-id="ba780-609">Otwórz TCP port w zaporze</span><span class="sxs-lookup"><span data-stu-id="ba780-609">Open a TCP port in the firewall</span></span>

1. <span data-ttu-id="ba780-610">Na pierwszym serwerze SQL **Start** ekranu, uruchom **Zapora systemu Windows z zabezpieczeniami zaawansowanymi**.</span><span class="sxs-lookup"><span data-stu-id="ba780-610">On the first SQL Server **Start** screen, launch **Windows Firewall with Advanced Security**.</span></span>
2. <span data-ttu-id="ba780-611">W lewym okienku wybierz **reguły ruchu przychodzącego**.</span><span class="sxs-lookup"><span data-stu-id="ba780-611">On the left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="ba780-612">W okienku po prawej stronie, kliknij polecenie **nową regułę**.</span><span class="sxs-lookup"><span data-stu-id="ba780-612">On the right pane, click **New Rule**.</span></span>
3. <span data-ttu-id="ba780-613">Aby uzyskać **typ reguły**, wybierz **portu**.</span><span class="sxs-lookup"><span data-stu-id="ba780-613">For **Rule Type**, choose **Port**.</span></span>
4. <span data-ttu-id="ba780-614">Dla portu, określ **TCP** i wpisz numery odpowiedni port.</span><span class="sxs-lookup"><span data-stu-id="ba780-614">For the port, specify **TCP** and type the appropriate port numbers.</span></span> <span data-ttu-id="ba780-615">Zobacz poniższy przykład:</span><span class="sxs-lookup"><span data-stu-id="ba780-615">See the following example:</span></span>

   ![Zapory SQL](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/35-tcpports.png)

5. <span data-ttu-id="ba780-617">Kliknij przycisk **Dalej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-617">Click **Next**.</span></span>
6. <span data-ttu-id="ba780-618">Na **akcji** Zachowaj **zezwalały na połączenie** zaznaczone, a następnie kliknij przycisk **dalej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-618">On the **Action** page, keep **Allow the connection** selected, and then click **Next**.</span></span>
7. <span data-ttu-id="ba780-619">Na **profilu** Zaakceptuj ustawienia domyślne, a następnie kliknij pozycję **dalej**.</span><span class="sxs-lookup"><span data-stu-id="ba780-619">On the **Profile** page, accept the default settings, and then click **Next**.</span></span>
8. <span data-ttu-id="ba780-620">Na **nazwa** Określ nazwę reguły (takich jak **Azure LB sondowania**) w **nazwa** polu tekstowym, a następnie kliknij przycisk **Zakończ**.</span><span class="sxs-lookup"><span data-stu-id="ba780-620">On the **Name** page, specify a rule name (such as **Azure LB Probe**) in the **Name** text box, and then click **Finish**.</span></span>

<span data-ttu-id="ba780-621">Powtórz te kroki dla drugiej maszyny Wirtualnej programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ba780-621">Repeat these steps on the second SQL Server VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ba780-622">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="ba780-622">Next steps</span></span>

* [<span data-ttu-id="ba780-623">Utwórz grupę dostępności programu SQL Server AlwaysOn na maszynach wirtualnych Azure</span><span class="sxs-lookup"><span data-stu-id="ba780-623">Create a SQL Server Always On availability group on Azure virtual machines</span></span>](virtual-machines-windows-portal-sql-availability-group-tutorial.md)
