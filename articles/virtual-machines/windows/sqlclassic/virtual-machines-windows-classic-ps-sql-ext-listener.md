---
title: "aaaConfigure odbiornik zewnętrzny dla zawsze włączonych grup dostępności | Dokumentacja firmy Microsoft"
description: "Ten samouczek przeszukiwań hello użytkownika przez kroki tworzenia zawsze na odbiornik grupy dostępności na platformie Azure, który jest dostępny zewnętrznie przy użyciu publicznego adresu IP wirtualnej hello usługi skojarzonej chmury."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: a2453032-94ab-4775-b976-c74d24716728
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/31/2017
ms.author: mikeray
ms.openlocfilehash: f8e2110bcc25d9cb7653675cb4ae5c8d717b6902
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="configure-an-external-listener-for-always-on-availability-groups-in-azure"></a><span data-ttu-id="98d0f-103">Skonfiguruj odbiornik zewnętrzny dla zawsze włączonych grup dostępności w systemie Azure</span><span class="sxs-lookup"><span data-stu-id="98d0f-103">Configure an external listener for Always On Availability Groups in Azure</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="98d0f-104">Odbiornik wewnętrzny</span><span class="sxs-lookup"><span data-stu-id="98d0f-104">Internal Listener</span></span>](../classic/ps-sql-int-listener.md)
> * [<span data-ttu-id="98d0f-105">Odbiornik zewnętrzny</span><span class="sxs-lookup"><span data-stu-id="98d0f-105">External Listener</span></span>](../classic/ps-sql-ext-listener.md)
> 
> 

<span data-ttu-id="98d0f-106">W tym temacie opisano sposób tooconfigure odbiornika dla zawsze włączonej grupy dostępności, która jest dostępna zewnętrznie w hello internet.</span><span class="sxs-lookup"><span data-stu-id="98d0f-106">This topic shows you how tooconfigure a listener for an Always On Availability Group that is externally accessible on hello internet.</span></span> <span data-ttu-id="98d0f-107">Jest to możliwe, kojarząc usługi chmury hello **publiczny wirtualnego adresu IP (VIP)** adres hello odbiornika.</span><span class="sxs-lookup"><span data-stu-id="98d0f-107">This is made possible by associating hello cloud service's **public Virtual IP (VIP)** address with hello listener.</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="98d0f-108">Platforma Azure ma dwa różne modele wdrażania do tworzenia i pracy z zasobami: [Resource Manager i Model Klasyczny](../../../azure-resource-manager/resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="98d0f-108">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="98d0f-109">W tym artykule omówiono przy użyciu klasycznego modelu wdrożenia hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-109">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="98d0f-110">Firma Microsoft zaleca, aby większości nowych wdrożeń korzystać hello modelu Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="98d0f-110">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span>

<span data-ttu-id="98d0f-111">Grupy dostępności mogą zawierać replik, które są lokalne, Azure, lub obejmować zarówno lokalnych, jak i Azure dla konfiguracji hybrydowego.</span><span class="sxs-lookup"><span data-stu-id="98d0f-111">Your Availability Group can contain replicas that are on-premises only, Azure only, or span both on-premises and Azure for hybrid configurations.</span></span> <span data-ttu-id="98d0f-112">Azure replik może znajdować się w obrębie hello sam region lub w wielu regionach, przy użyciu wielu sieci wirtualnych (sieci wirtualne).</span><span class="sxs-lookup"><span data-stu-id="98d0f-112">Azure replicas can reside within hello same region or across multiple regions using multiple virtual networks (VNets).</span></span> <span data-ttu-id="98d0f-113">Poniższe kroki Hello założono, że masz już [skonfigurowane grupy dostępności](../classic/portal-sql-alwayson-availability-groups.md) , ale nie skonfigurowano odbiornik.</span><span class="sxs-lookup"><span data-stu-id="98d0f-113">hello steps below assume you have already [configured an availability group](../classic/portal-sql-alwayson-availability-groups.md) but have not configured a listener.</span></span>

## <a name="guidelines-and-limitations-for-external-listeners"></a><span data-ttu-id="98d0f-114">Zasady i ograniczenia dotyczące odbiorników zewnętrznych</span><span class="sxs-lookup"><span data-stu-id="98d0f-114">Guidelines and limitations for external listeners</span></span>
<span data-ttu-id="98d0f-115">Należy zwrócić uwagę następujące wskazówki dotyczące hello odbiornika grupy dostępności na platformie Azure, w przypadku wdrażania za pomocą hello chmury usługi siła adresu VIP hello:</span><span class="sxs-lookup"><span data-stu-id="98d0f-115">Note hello following guidelines about hello availability group listener in Azure when you are deploying using hello cloud service pubic VIP address:</span></span>

* <span data-ttu-id="98d0f-116">odbiornik grupy dostępności Hello jest obsługiwana w systemie Windows Server 2008 R2, Windows Server 2012 i Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="98d0f-116">hello availability group listener is supported on Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2.</span></span>
* <span data-ttu-id="98d0f-117">Aplikacja kliencka Hello musi znajdować się na innej usługi chmury niż hello zawierających grupy dostępności maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="98d0f-117">hello client application must reside on a different cloud service than hello one that contains your availability group VMs.</span></span> <span data-ttu-id="98d0f-118">Usługi w chmurze Azure nie obsługuje bezpośredniego zwrotu serwera z klienta i serwera w hello takie same.</span><span class="sxs-lookup"><span data-stu-id="98d0f-118">Azure does not support direct server return with client and server in hello same cloud service.</span></span>
* <span data-ttu-id="98d0f-119">Domyślnie hello opisanych w tym artykule pokazują, jak tooconfigure jednego odbiornika toouse hello chmury adres wirtualnego adresu IP (VIP) usługi.</span><span class="sxs-lookup"><span data-stu-id="98d0f-119">By default, hello steps in this article show how tooconfigure one listener toouse hello cloud service Virtual IP (VIP) address.</span></span> <span data-ttu-id="98d0f-120">Jednak jest możliwe tooreserve i utworzenia wielu adresów VIP dla usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="98d0f-120">However, it is possible tooreserve and create multiple VIP addresses for your cloud service.</span></span> <span data-ttu-id="98d0f-121">Dzięki temu toouse hello etapami toocreate tego artykułu, wiele odbiorników, z których każda skojarzone z różnych adresów VIP.</span><span class="sxs-lookup"><span data-stu-id="98d0f-121">This enables you toouse hello steps in this article toocreate multiple listeners that are each associated with a different VIP.</span></span> <span data-ttu-id="98d0f-122">Aby uzyskać informacje dotyczące toocreate wielu adresów VIP, zobacz temat [wieloma wirtualnymi adresami IP dla danej usługi chmury](../../../load-balancer/load-balancer-multivip.md).</span><span class="sxs-lookup"><span data-stu-id="98d0f-122">For information on how toocreate multiple VIP addresses, see [Multiple VIPs per cloud service](../../../load-balancer/load-balancer-multivip.md).</span></span>
* <span data-ttu-id="98d0f-123">W przypadku tworzenia odbiornika dla środowiska hybrydowego, w sieci lokalnej hello musi mieć toohello łączności publicznej sieci Internet w toohello dodanie sieć VPN lokacja lokacja z hello sieci wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="98d0f-123">If you are creating a listener for a hybrid environment, hello on-premises network must have connectivity toohello public Internet in addition toohello site-to-site VPN with hello Azure virtual network.</span></span> <span data-ttu-id="98d0f-124">W przypadku hello podsieci platformy Azure, odbiornika grupy dostępności hello jest dostępny tylko za pomocą publicznego adresu IP hello hello odpowiedniej chmury usługi.</span><span class="sxs-lookup"><span data-stu-id="98d0f-124">When in hello Azure subnet, hello availability group listener is reachable only by hello public IP address of hello respective cloud service.</span></span>
* <span data-ttu-id="98d0f-125">Nie jest obsługiwana toocreate odbiornik zewnętrzny w hello takie same w chmurze, gdzie masz również odbiornik wewnętrznej przy użyciu usługi hello wewnętrznego modułu równoważenia obciążenia (ILB).</span><span class="sxs-lookup"><span data-stu-id="98d0f-125">It is not supported toocreate an external listener in hello same cloud service where you also have an internal listener using hello Internal Load Balancer (ILB).</span></span>

## <a name="determine-hello-accessibility-of-hello-listener"></a><span data-ttu-id="98d0f-126">Ustalić dostępność hello hello odbiornika</span><span class="sxs-lookup"><span data-stu-id="98d0f-126">Determine hello accessibility of hello listener</span></span>
[!INCLUDE [ag-listener-accessibility](../../../../includes/virtual-machines-ag-listener-determine-accessibility.md)]

<span data-ttu-id="98d0f-127">Ten artykuł skupia się na utworzenie odbiornika, który używa **równoważenia obciążenia zewnętrznych**.</span><span class="sxs-lookup"><span data-stu-id="98d0f-127">This article focuses on creating a listener that uses **external load balancing**.</span></span> <span data-ttu-id="98d0f-128">Jeśli odbiornik, który jest wirtualnej sieci prywatnej tooyour, zobacz hello wersję tego artykułu, który zawiera kroki tworzenia [odbiornik o ILB](../classic/ps-sql-int-listener.md)</span><span class="sxs-lookup"><span data-stu-id="98d0f-128">If you want a listener that is private tooyour virtual network, see hello version of this article that provides steps for setting up an [listener with ILB](../classic/ps-sql-int-listener.md)</span></span>

## <a name="create-load-balanced-vm-endpoints-with-direct-server-return"></a><span data-ttu-id="98d0f-129">Tworzyć równoważeniem obciążenia punkty końcowe maszyny Wirtualnej z serwerem bezpośredniego zwrotu</span><span class="sxs-lookup"><span data-stu-id="98d0f-129">Create load-balanced VM endpoints with direct server return</span></span>
<span data-ttu-id="98d0f-130">Równoważenie obciążenia zewnętrznych używa hello hello wirtualnej publiczny wirtualny adres IP usługi w chmurze hello hostujący maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="98d0f-130">External load balancing uses hello virtual hello public Virtual IP address of hello cloud service that hosts your VMs.</span></span> <span data-ttu-id="98d0f-131">Nie należy toocreate ani w takim przypadku skonfigurowania funkcji równoważenia obciążenia hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-131">So you do not need toocreate or configure hello load balancer in this case.</span></span>

<span data-ttu-id="98d0f-132">Punkt końcowy z równoważeniem obciążenia należy utworzyć dla każdej maszyny Wirtualnej obsługuje replikę Azure.</span><span class="sxs-lookup"><span data-stu-id="98d0f-132">You must create a load-balanced endpoint for each VM hosting an Azure replica.</span></span> <span data-ttu-id="98d0f-133">Jeśli masz repliki w wielu regionach, każdej repliki dla tego regionu musi być w hello takie same usługi w chmurze hello tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="98d0f-133">If you have replicas in multiple regions, each replica for that region must be in hello same cloud service in hello same VNet.</span></span> <span data-ttu-id="98d0f-134">Repliki tworzenia grupy dostępności, obejmujące wiele regionów platformy Azure wymaga konfigurowania wielu sieci wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="98d0f-134">Creating Availability Group replicas that span multiple Azure regions requires configuring multiple VNets.</span></span> <span data-ttu-id="98d0f-135">Aby uzyskać więcej informacji na temat konfigurowania krzyżowego łączność sieci wirtualnej, zobacz [tooVNet Konfigurowanie sieci wirtualnej łączności](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md).</span><span class="sxs-lookup"><span data-stu-id="98d0f-135">For more information on configuring cross VNet connectivity, see  [Configure VNet tooVNet Connectivity](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md).</span></span>

1. <span data-ttu-id="98d0f-136">W hello portalu Azure Przejdź tooeach maszyny Wirtualnej repliki i widoku szczegółów hello hosting.</span><span class="sxs-lookup"><span data-stu-id="98d0f-136">In hello Azure portal, navigate tooeach VM hosting a replica and view hello details.</span></span>
2. <span data-ttu-id="98d0f-137">Kliknij przycisk hello **punkty końcowe** kartę hello maszyn wirtualnych.</span><span class="sxs-lookup"><span data-stu-id="98d0f-137">Click hello **Endpoints** tab for each of hello VMs.</span></span>
3. <span data-ttu-id="98d0f-138">Sprawdź, że hello **nazwa** i **Port publiczny** punktu końcowego odbiornika hello ma toouse nie jest już używany.</span><span class="sxs-lookup"><span data-stu-id="98d0f-138">Verify that hello **Name** and **Public Port** of hello listener endpoint you want toouse is not already in use.</span></span> <span data-ttu-id="98d0f-139">W poniższym przykładzie hello nazwa hello "MyEndpoint" i hello port jest "1433".</span><span class="sxs-lookup"><span data-stu-id="98d0f-139">In hello example below, hello name is “MyEndpoint” and hello port is “1433”.</span></span>
4. <span data-ttu-id="98d0f-140">Na kliencie lokalnym, Pobierz i zainstaluj [hello najnowsze modułu PowerShell](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="98d0f-140">On your local client, download and install [hello latest PowerShell module](https://azure.microsoft.com/downloads/).</span></span>
5. <span data-ttu-id="98d0f-141">Uruchom **programu Azure PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="98d0f-141">Launch **Azure PowerShell**.</span></span> <span data-ttu-id="98d0f-142">Nowe środowisko PowerShell otwarciu sesji z hello Azure administracyjne moduły załadowane.</span><span class="sxs-lookup"><span data-stu-id="98d0f-142">A new PowerShell session is opened with hello Azure administrative modules loaded.</span></span>
6. <span data-ttu-id="98d0f-143">Uruchom **Get-AzurePublishSettingsFile**.</span><span class="sxs-lookup"><span data-stu-id="98d0f-143">Run **Get-AzurePublishSettingsFile**.</span></span> <span data-ttu-id="98d0f-144">To polecenie cmdlet kieruje tooa przeglądarki toodownload publikowania ustawienia pliku tooa katalogiem lokalnym.</span><span class="sxs-lookup"><span data-stu-id="98d0f-144">This cmdlet directs you tooa browser toodownload a publish settings file tooa local directory.</span></span> <span data-ttu-id="98d0f-145">Może pojawić się prośba o podanie poświadczeń logowania dla subskrypcji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="98d0f-145">You may be prompted for your log-in credentials for your Azure subscription.</span></span>
7. <span data-ttu-id="98d0f-146">Uruchom hello **AzurePublishSettingsFile importu** pobranego pliku ustawień publikowania polecenie z hello ścieżka hello:</span><span class="sxs-lookup"><span data-stu-id="98d0f-146">Run hello **Import-AzurePublishSettingsFile** command with hello path of hello publish settings file that you downloaded:</span></span>
   
        Import-AzurePublishSettingsFile -PublishSettingsFile <PublishSettingsFilePath>
   
    <span data-ttu-id="98d0f-147">Gdy publikowanie hello jest importowany plik ustawień, można zarządzać subskrypcją platformy Azure w sesji programu PowerShell hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-147">Once hello publish settings file is imported, you can manage your Azure subscription in hello PowerShell session.</span></span>
    
1. <span data-ttu-id="98d0f-148">Skopiuj poniższy skrypt programu PowerShell hello w edytorze tekstu i ustaw hello toosuit wartości zmiennych środowiska (wartości domyślne zostały dołączone dla niektórych parametrów).</span><span class="sxs-lookup"><span data-stu-id="98d0f-148">Copy hello PowerShell script below into a text editor and set hello variable values toosuit your environment (defaults have been provided for some parameters).</span></span> <span data-ttu-id="98d0f-149">Należy pamiętać, że grupy dostępności obejmuje regiony platformy Azure, należy uruchomić skrypt hello raz w każdym centrum danych dla usługi w chmurze hello i węzły, które znajdują się w tym centrum danych.</span><span class="sxs-lookup"><span data-stu-id="98d0f-149">Note that if your availability group spans Azure regions, you must run hello script once in each datacenter for hello cloud service and nodes that reside in that datacenter.</span></span>
   
        # Define variables
        $ServiceName = "<MyCloudService>" # hello name of hello cloud service that contains hello availability group nodes
        $AGNodes = "<VM1>","<VM2>","<VM3>" # all availability group nodes containing replicas in hello same cloud service, separated by commas
   
        # Configure a load balanced endpoint for each node in $AGNodes, with direct server return enabled
        ForEach ($node in $AGNodes)
        {
            Get-AzureVM -ServiceName $ServiceName -Name $node | Add-AzureEndpoint -Name "ListenerEndpoint" -Protocol "TCP" -PublicPort 1433 -LocalPort 1433 -LBSetName "ListenerEndpointLB" -ProbePort 59999 -ProbeProtocol "TCP" -DirectServerReturn $true | Update-AzureVM
        }

2. <span data-ttu-id="98d0f-150">Po ustawieniu zmienne hello hello kopii skryptu w edytorze tekstu hello do programu Azure PowerShell toorun sesji go.</span><span class="sxs-lookup"><span data-stu-id="98d0f-150">Once you have set hello variables, copy hello script from hello text editor into your Azure PowerShell session toorun it.</span></span> <span data-ttu-id="98d0f-151">Jeśli nadal wyświetlany jest monit hello >>, wpisz ponownie wprowadź, czy skrypt hello toomake zacznie działać.</span><span class="sxs-lookup"><span data-stu-id="98d0f-151">If hello prompt still shows >>, type ENTER again toomake sure hello script starts running.</span></span>

## <a name="verify-that-kb2854082-is-installed-if-necessary"></a><span data-ttu-id="98d0f-152">Sprawdź, czy KB2854082 jest zainstalowana w razie potrzeby</span><span class="sxs-lookup"><span data-stu-id="98d0f-152">Verify that KB2854082 is installed if necessary</span></span>
[!INCLUDE [kb2854082](../../../../includes/virtual-machines-ag-listener-kb2854082.md)]

## <a name="open-hello-firewall-ports-in-availability-group-nodes"></a><span data-ttu-id="98d0f-153">Otworzyć porty zapory hello w węzłach grupy dostępności</span><span class="sxs-lookup"><span data-stu-id="98d0f-153">Open hello firewall ports in availability group nodes</span></span>
[!INCLUDE [firewall](../../../../includes/virtual-machines-ag-listener-open-firewall.md)]

## <a name="create-hello-availability-group-listener"></a><span data-ttu-id="98d0f-154">Tworzenie odbiornika grupy dostępności hello</span><span class="sxs-lookup"><span data-stu-id="98d0f-154">Create hello availability group listener</span></span>

<span data-ttu-id="98d0f-155">Tworzenie odbiornika grupy dostępności hello w dwóch krokach.</span><span class="sxs-lookup"><span data-stu-id="98d0f-155">Create hello availability group listener in two steps.</span></span> <span data-ttu-id="98d0f-156">Najpierw należy utworzyć zasobu klastra punktu dostępu klienta hello i skonfigurować zależności.</span><span class="sxs-lookup"><span data-stu-id="98d0f-156">First, create hello client access point cluster resource and configure  dependencies.</span></span> <span data-ttu-id="98d0f-157">Po drugie Skonfiguruj zasoby klastra hello przy użyciu programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="98d0f-157">Second, configure hello cluster resources with PowerShell.</span></span>

### <a name="create-hello-client-access-point-and-configure-hello-cluster-dependencies"></a><span data-ttu-id="98d0f-158">Tworzenie punktu dostępu klienta hello i konfigurowanie hello zależności klastra</span><span class="sxs-lookup"><span data-stu-id="98d0f-158">Create hello client access point and configure hello cluster dependencies</span></span>
[!INCLUDE [firewall](../../../../includes/virtual-machines-ag-listener-create-listener.md)]

### <a name="configure-hello-cluster-resources-in-powershell"></a><span data-ttu-id="98d0f-159">Konfigurowanie zasobów klastra hello w programie PowerShell</span><span class="sxs-lookup"><span data-stu-id="98d0f-159">Configure hello cluster resources in PowerShell</span></span>
1. <span data-ttu-id="98d0f-160">W programie Równoważenie obciążenia zewnętrznej, należy uzyskać hello publiczny wirtualnego adresu IP usługi w chmurze hello zawierający repliki.</span><span class="sxs-lookup"><span data-stu-id="98d0f-160">For external load balancing, you must obtain hello public virtual IP address of hello cloud service that contains your replicas.</span></span> <span data-ttu-id="98d0f-161">Zaloguj się do hello portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="98d0f-161">Log into hello Azure portal.</span></span> <span data-ttu-id="98d0f-162">Przejdź toohello usługi w chmurze zawiera grupy dostępności maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="98d0f-162">Navigate toohello cloud service that contains your availability group VM.</span></span> <span data-ttu-id="98d0f-163">Otwórz hello **pulpitu nawigacyjnego** widoku.</span><span class="sxs-lookup"><span data-stu-id="98d0f-163">Open hello **Dashboard** view.</span></span>
2. <span data-ttu-id="98d0f-164">Należy zwrócić uwagę hello adres wyświetlany w obszarze **adres publiczny wirtualnego adresu IP (VIP)**.</span><span class="sxs-lookup"><span data-stu-id="98d0f-164">Note hello address shown under **Public Virtual IP (VIP) Address**.</span></span> <span data-ttu-id="98d0f-165">Jeśli rozwiązanie obejmuje sieci wirtualne, powtórz ten krok dla każdej usługi w chmurze zawiera maszyny Wirtualnej, który hostuje replikę.</span><span class="sxs-lookup"><span data-stu-id="98d0f-165">If your solution spans VNets, repeat this step for each cloud service that contains a VM that hosts a replica.</span></span>
3. <span data-ttu-id="98d0f-166">Na jednym z hello maszyn wirtualnych Skopiuj poniższy skrypt programu PowerShell hello w edytorze tekstu i ustaw zmienne hello toohello wartości, które wcześniej zapisany.</span><span class="sxs-lookup"><span data-stu-id="98d0f-166">On one of hello VMs, copy hello PowerShell script below into a text editor and set hello variables toohello values you noted earlier.</span></span>
   
        # Define variables
        $ClusterNetworkName = "<ClusterNetworkName>" # hello cluster network name (Use Get-ClusterNetwork on Windows Server 2012 of higher toofind hello name)
        $IPResourceName = "<IPResourceName>" # hello IP Address resource name
        $CloudServiceIP = "<X.X.X.X>" # Public Virtual IP (VIP) address of your cloud service
   
        Import-Module FailoverClusters
   
        # If you are using Windows Server 2012 or higher, use hello Get-Cluster Resource command. If you are using Windows Server 2008 R2, use hello cluster res command. Both commands are commented out. Choose hello one applicable tooyour environment and remove hello # at hello beginning of hello line tooconvert hello comment tooan executable line of code.
   
        # Get-ClusterResource $IPResourceName | Set-ClusterParameter -Multiple @{"Address"="$CloudServiceIP";"ProbePort"="59999";"SubnetMask"="255.255.255.255";"Network"="$ClusterNetworkName";"OverrideAddressMatch"=1;"EnableDhcp"=0}
        # cluster res $IPResourceName /priv enabledhcp=0 overrideaddressmatch=1 address=$CloudServiceIP probeport=59999  subnetmask=255.255.255.255
4. <span data-ttu-id="98d0f-167">Po ustawiono hello zmienne, Otwórz okno programu Windows PowerShell z podwyższonym poziomem uprawnień, a następnie skopiuj skrypt hello w edytorze tekstu hello oraz wkleić do programu Azure PowerShell toorun sesji.</span><span class="sxs-lookup"><span data-stu-id="98d0f-167">Once you have set hello variables, open an elevated Windows PowerShell window, then copy hello script from hello text editor and paste into your Azure PowerShell session toorun it.</span></span> <span data-ttu-id="98d0f-168">Jeśli nadal wyświetlany jest monit hello >>, wpisz ponownie wprowadź, czy skrypt hello toomake zacznie działać.</span><span class="sxs-lookup"><span data-stu-id="98d0f-168">If hello prompt still shows >>, type ENTER again toomake sure hello script starts running.</span></span>
5. <span data-ttu-id="98d0f-169">Powtórz te czynności na każdej maszynie Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="98d0f-169">Repeat this on each VM.</span></span> <span data-ttu-id="98d0f-170">Ten skrypt konfiguruje hello adresu IP zasobu z adresem IP hello hello usługi w chmurze i ustawia innych parametrów, takich jak port sondy hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-170">This script configures hello IP Address resource with hello IP address of hello cloud service and sets other parameters like hello probe port.</span></span> <span data-ttu-id="98d0f-171">Gdy hello zasobu adres IP jest przełączany w tryb online, mogą następnie odpowiedzieć toohello sondowania na port sondy hello z hello równoważeniem obciążenia punktu końcowego utworzonej wcześniej w tym samouczku.</span><span class="sxs-lookup"><span data-stu-id="98d0f-171">When hello IP Address resource is brought online, it can then respond toohello polling on hello probe port from hello load-balanced endpoint created earlier in this tutorial.</span></span>

## <a name="bring-hello-listener-online"></a><span data-ttu-id="98d0f-172">Przełącz odbiornika hello w trybie online</span><span class="sxs-lookup"><span data-stu-id="98d0f-172">Bring hello listener online</span></span>
[!INCLUDE [Bring-Listener-Online](../../../../includes/virtual-machines-ag-listener-bring-online.md)]

## <a name="follow-up-items"></a><span data-ttu-id="98d0f-173">Elementy monitowania</span><span class="sxs-lookup"><span data-stu-id="98d0f-173">Follow-up items</span></span>
[!INCLUDE [Follow-up](../../../../includes/virtual-machines-ag-listener-follow-up.md)]

## <a name="test-hello-availability-group-listener-within-hello-same-vnet"></a><span data-ttu-id="98d0f-174">Odbiornik grupy dostępności hello testu (poziomu hello sam sieci wirtualnej)</span><span class="sxs-lookup"><span data-stu-id="98d0f-174">Test hello availability group listener (within hello same VNet)</span></span>
[!INCLUDE [Test-Listener-Within-VNET](../../../../includes/virtual-machines-ag-listener-test.md)]

## <a name="test-hello-availability-group-listener-over-hello-internet"></a><span data-ttu-id="98d0f-175">Odbiornik grupy dostępności hello testu (za pośrednictwem hello internet)</span><span class="sxs-lookup"><span data-stu-id="98d0f-175">Test hello availability group listener (over hello internet)</span></span>
<span data-ttu-id="98d0f-176">Kolejność tooaccess hello odbiornika z hello poza siecią wirtualną, należy korzystać z równoważenia obciążenia zewnętrznego/public, (opisanej w tym temacie) zamiast ILB, która jest tylko do niej dostępu w ramach hello tej samej sieci wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="98d0f-176">In order tooaccess hello listener from outside hello virtual network, you must be using external/public load balancing (described in this topic) rather than ILB, which is only accesible within hello same VNet.</span></span> <span data-ttu-id="98d0f-177">W parametrach połączenia hello możesz określić hello nazwa usługi w chmurze.</span><span class="sxs-lookup"><span data-stu-id="98d0f-177">In hello connection string, you specify hello cloud service name.</span></span> <span data-ttu-id="98d0f-178">Na przykład, jeśli masz usługi w chmurze o nazwie hello *mycloudservice*, instrukcja sqlcmd hello będzie następujące:</span><span class="sxs-lookup"><span data-stu-id="98d0f-178">For example, if you had a cloud service with hello name *mycloudservice*, hello sqlcmd statement would be as follows:</span></span>

    sqlcmd -S "mycloudservice.cloudapp.net,<EndpointPort>" -d "<DatabaseName>" -U "<LoginId>" -P "<Password>"  -Q "select @@servername, db_name()" -l 15

<span data-ttu-id="98d0f-179">Inaczej niż w poprzednim przykładzie hello uwierzytelnianie SQL musi można użyć, ponieważ wywołujący hello nie można używać uwierzytelniania systemu windows za pośrednictwem hello internet.</span><span class="sxs-lookup"><span data-stu-id="98d0f-179">Unlike hello previous example, SQL authentication must be used, because hello caller cannot use windows authentication over hello internet.</span></span> <span data-ttu-id="98d0f-180">Aby uzyskać więcej informacji, zobacz [zawsze włączonej grupy dostępności w maszynie Wirtualnej platformy Azure: scenariusze łączności klienta](http://blogs.msdn.com/b/sqlcat/archive/2014/02/03/alwayson-availability-group-in-windows-azure-vm-client-connectivity-scenarios.aspx).</span><span class="sxs-lookup"><span data-stu-id="98d0f-180">For more information, see [Always On Availability Group in Azure VM: Client Connectivity Scenarios](http://blogs.msdn.com/b/sqlcat/archive/2014/02/03/alwayson-availability-group-in-windows-azure-vm-client-connectivity-scenarios.aspx).</span></span> <span data-ttu-id="98d0f-181">Podczas korzystania z uwierzytelniania SQL, upewnij się, że utworzyć hello tej samej nazwy logowania w obu replikach.</span><span class="sxs-lookup"><span data-stu-id="98d0f-181">When using SQL authentication, make sure that you create hello same login on both replicas.</span></span> <span data-ttu-id="98d0f-182">Aby uzyskać więcej informacji dotyczących rozwiązywania problemów z logowania z użyciem grup dostępności, zobacz [jak toomap logowania lub użyj zawarte SQL użytkownika tooconnect tooother replik bazy danych i bazy danych tooavailability map](http://blogs.msdn.com/b/alwaysonpro/archive/2014/02/19/how-to-map-logins-or-use-contained-sql-database-user-to-connect-to-other-replicas-and-map-to-availability-databases.aspx).</span><span class="sxs-lookup"><span data-stu-id="98d0f-182">For more information about troubleshooting logins with Availability Groups, see [How toomap logins or use contained SQL database user tooconnect tooother replicas and map tooavailability databases](http://blogs.msdn.com/b/alwaysonpro/archive/2014/02/19/how-to-map-logins-or-use-contained-sql-database-user-to-connect-to-other-replicas-and-map-to-availability-databases.aspx).</span></span>

<span data-ttu-id="98d0f-183">Jeśli hello zawsze na repliki są w różnych podsieciach, klienci muszą określić **MultisubnetFailover = True** w parametrach połączenia hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-183">If hello Always On replicas are in different subnets, clients must specify **MultisubnetFailover=True** in hello connection string.</span></span> <span data-ttu-id="98d0f-184">Powoduje to tooreplicas prób połączenia równoległego w różnych podsieciach hello.</span><span class="sxs-lookup"><span data-stu-id="98d0f-184">This results in parallel connection attempts tooreplicas in hello different subnets.</span></span> <span data-ttu-id="98d0f-185">Należy pamiętać, że taki scenariusz obejmuje między region wdrożenia zawsze włączonej grupy dostępności.</span><span class="sxs-lookup"><span data-stu-id="98d0f-185">Note that this scenario includes a cross-region Always On Availability Group deployment.</span></span>

## <a name="next-steps"></a><span data-ttu-id="98d0f-186">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="98d0f-186">Next steps</span></span>
[!INCLUDE [Listener-Next-Steps](../../../../includes/virtual-machines-ag-listener-next-steps.md)]

