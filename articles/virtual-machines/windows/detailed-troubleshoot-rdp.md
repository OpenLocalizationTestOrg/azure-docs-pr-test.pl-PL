---
title: "Pulpit zdalny aaaDetailed rozwiązywania problemów na platformie Azure | Dokumentacja firmy Microsoft"
description: "Przeglądanie szczegółowe kroki rozwiązywania problemów dla zdalnego pulpitu błędy, którym nie tooa maszyn wirtualnych systemu Windows na platformie Azure"
services: virtual-machines-windows
documentationcenter: 
author: genlin
manager: timlt
editor: 
tags: top-support-issue,azure-service-management,azure-resource-manager
keywords: "Nie można połączyć z tooremote pulpitu, rozwiązywanie problemów z pulpitu zdalnego pulpitu zdalnego nie może połączyć błędy usług pulpitu zdalnego, rozwiązywania problemów pulpitu zdalnego, problemy z pulpitu zdalnego"
ms.assetid: 9da36f3d-30dd-44af-824b-8ce5ef07e5e0
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: support-article
ms.date: 07/25/2017
ms.author: genli
ms.openlocfilehash: fcb0d06aa66b748f3ebbbbe3431471d3cbe7c60d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="detailed-troubleshooting-steps-for-remote-desktop-connection-issues-toowindows-vms-in-azure"></a><span data-ttu-id="d7ec2-104">Szczegółowe kroki rozwiązywania problemów dla usługi Podłączanie pulpitu zdalnego wystawia tooWindows maszyn wirtualnych na platformie Azure</span><span class="sxs-lookup"><span data-stu-id="d7ec2-104">Detailed troubleshooting steps for remote desktop connection issues tooWindows VMs in Azure</span></span>
<span data-ttu-id="d7ec2-105">Ten artykuł zawiera szczegółowe kroki rozwiązywania problemów toodiagnose i popraw błędy złożonych pulpitu zdalnego dla systemu Windows Azure maszyny wirtualne.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-105">This article provides detailed troubleshooting steps toodiagnose and fix complex Remote Desktop errors for Windows-based Azure virtual machines.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d7ec2-106">tooeliminate hello rozwiązywać typowe błędy pulpitu zdalnego, upewnij się, że tooread [hello podstawowe artykuł dotyczący rozwiązywania problemów dla pulpitu zdalnego](troubleshoot-rdp-connection.md) przed kontynuowaniem.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-106">tooeliminate hello more common Remote Desktop errors, make sure tooread [hello basic troubleshooting article for Remote Desktop](troubleshoot-rdp-connection.md) before proceeding.</span></span>

<span data-ttu-id="d7ec2-107">Pulpit zdalny objęte komunikat o błędzie, który wygląda inaczej żadnego hello określone komunikaty o błędach mogą wystąpić [hello podstawowych pulpitem zdalnym przewodnik rozwiązywania problemów](troubleshoot-rdp-connection.md).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-107">You may encounter a Remote Desktop error message that does not resemble any of hello specific error messages covered in [hello basic Remote Desktop troubleshooting guide](troubleshoot-rdp-connection.md).</span></span> <span data-ttu-id="d7ec2-108">Wykonaj te kroki toodetermine, dlaczego powitania klienta usług pulpitu zdalnego (RDP) jest tooconnect toohello RDP usługi na powitania maszyny Wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-108">Follow these steps toodetermine why hello Remote Desktop (RDP) client is unable tooconnect toohello RDP service on hello Azure VM.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../includes/learn-about-deployment-models-both-include.md)]

<span data-ttu-id="d7ec2-109">Jeśli potrzebujesz więcej pomocy w dowolnym momencie, w tym artykule, możesz skontaktować się hello ekspertów platformy Azure na [hello MSDN Azure i hello przepełnienie stosu fora](https://azure.microsoft.com/support/forums/).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-109">If you need more help at any point in this article, you can contact hello Azure experts on [hello MSDN Azure and hello Stack Overflow forums](https://azure.microsoft.com/support/forums/).</span></span> <span data-ttu-id="d7ec2-110">Alternatywnie można również pliku zdarzenia pomocy technicznej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-110">Alternatively, you can also file an Azure support incident.</span></span> <span data-ttu-id="d7ec2-111">Przejdź toohello [witrynę pomocy technicznej platformy Azure](https://azure.microsoft.com/support/options/) i kliknij przycisk **Get Support**.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-111">Go toohello [Azure Support site](https://azure.microsoft.com/support/options/) and click **Get Support**.</span></span> <span data-ttu-id="d7ec2-112">Aby uzyskać informacje o korzystaniu z pomocą techniczną platformy Azure, przeczytaj hello [często zadawane pytania dotyczące programu Microsoft Azure Obsługa](https://azure.microsoft.com/support/faq/).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-112">For information about using Azure Support, read hello [Microsoft Azure Support FAQ](https://azure.microsoft.com/support/faq/).</span></span>

## <a name="components-of-a-remote-desktop-connection"></a><span data-ttu-id="d7ec2-113">Składniki połączenia pulpitu zdalnego</span><span class="sxs-lookup"><span data-stu-id="d7ec2-113">Components of a Remote Desktop connection</span></span>
<span data-ttu-id="d7ec2-114">połączenie RDP obejmuje Hello następujące składniki:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-114">hello following components are involved in an RDP connection:</span></span>

![](./media/detailed-troubleshoot-rdp/tshootrdp_0.png)

<span data-ttu-id="d7ec2-115">Przed kontynuowaniem ułatwieniem może być toomentally Przejrzyj co zmienił się od hello ostatniego pomyślnego pulpitu zdalnego połączenia toohello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-115">Before proceeding, it might help toomentally review what has changed since hello last successful Remote Desktop connection toohello VM.</span></span> <span data-ttu-id="d7ec2-116">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-116">For example:</span></span>

* <span data-ttu-id="d7ec2-117">Witaj publicznego adresu IP hello maszyny Wirtualnej lub hello usługi w chmurze zawierających hello maszyny Wirtualnej (nazywane również hello wirtualnego adresu IP [VIP](https://en.wikipedia.org/wiki/Virtual_IP_address)) została zmieniona.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-117">hello public IP address of hello VM or hello cloud service containing hello VM (also called hello virtual IP address [VIP](https://en.wikipedia.org/wiki/Virtual_IP_address)) has changed.</span></span> <span data-ttu-id="d7ec2-118">Hello RDP awarii może być spowodowane pamięć podręczną klienta DNS nadal ma hello *stary adres IP* zarejestrowany dla hello nazwy DNS.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-118">hello RDP failure could be because your DNS client cache still has hello *old IP address* registered for hello DNS name.</span></span> <span data-ttu-id="d7ec2-119">Opróżnienia pamięci podręcznej klienta DNS, a następnie spróbuj ponownie połączyć hello maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-119">Flush your DNS client cache and try connecting hello VM again.</span></span> <span data-ttu-id="d7ec2-120">Lub spróbuj połączyć się bezpośrednio z hello nowego adresu VIP.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-120">Or try connecting directly with hello new VIP.</span></span>
* <span data-ttu-id="d7ec2-121">Używasz toomanage aplikacji innych firm połączeń pulpitu zdalnego zamiast przy użyciu połączenia hello generowane przez hello portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-121">You are using a third-party application toomanage your Remote Desktop connections instead of using hello connection generated by hello Azure portal.</span></span> <span data-ttu-id="d7ec2-122">Sprawdź, czy w tej konfiguracji aplikacja hello obejmuje hello poprawne port TCP dla hello ruchu pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-122">Verify that hello application configuration includes hello correct TCP port for hello Remote Desktop traffic.</span></span> <span data-ttu-id="d7ec2-123">Możesz sprawdzić tego portu klasyczne maszyny wirtualnej w hello [portalu Azure](https://portal.azure.com), klikając ustawienia hello maszyny Wirtualnej > punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-123">You can check this port for a classic virtual machine in hello [Azure portal](https://portal.azure.com), by clicking hello VM's Settings > Endpoints.</span></span>

## <a name="preliminary-steps"></a><span data-ttu-id="d7ec2-124">Czynności wstępne</span><span class="sxs-lookup"><span data-stu-id="d7ec2-124">Preliminary steps</span></span>
<span data-ttu-id="d7ec2-125">Przed kontynuowaniem toohello szczegółowe Rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="d7ec2-125">Before proceeding toohello detailed troubleshooting,</span></span>

* <span data-ttu-id="d7ec2-126">Sprawdź stan hello hello maszyny wirtualnej w hello portal Azure oczywiste problemy.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-126">Check hello status of hello virtual machine in hello Azure portal for any obvious issues.</span></span>
* <span data-ttu-id="d7ec2-127">Wykonaj hello [przewodnik kroki szybkiej poprawki typowych błędów protokołu RDP podstawowe rozwiązywaniu hello](troubleshoot-rdp-connection.md#quick-troubleshooting-steps).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-127">Follow hello [quick fix steps for common RDP errors in hello basic troubleshooting guide](troubleshoot-rdp-connection.md#quick-troubleshooting-steps).</span></span>

<span data-ttu-id="d7ec2-128">Spróbuj połączyć się ponownie po wykonaniu tych kroków toohello maszyny Wirtualnej za pośrednictwem pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-128">Try reconnecting toohello VM via Remote Desktop after these steps.</span></span>

## <a name="detailed-troubleshooting-steps"></a><span data-ttu-id="d7ec2-129">Szczegółowe kroki rozwiązywania problemów</span><span class="sxs-lookup"><span data-stu-id="d7ec2-129">Detailed troubleshooting steps</span></span>
<span data-ttu-id="d7ec2-130">powitania klienta pulpitu zdalnego nie może być możliwe tooreach usługi pulpitu zdalnego hello na powitania maszyny Wirtualnej platformy Azure z powodu tooissues na powitania następujące źródła:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-130">hello Remote Desktop client may not be able tooreach hello Remote Desktop service on hello Azure VM due tooissues at hello following sources:</span></span>

* [<span data-ttu-id="d7ec2-131">Komputer klienta usług pulpitu zdalnego</span><span class="sxs-lookup"><span data-stu-id="d7ec2-131">Remote Desktop client computer</span></span>](#source-1-remote-desktop-client-computer)
* [<span data-ttu-id="d7ec2-132">Urządzenie brzegowe intranetowych w organizacji</span><span class="sxs-lookup"><span data-stu-id="d7ec2-132">Organization intranet edge device</span></span>](#source-2-organization-intranet-edge-device)
* [<span data-ttu-id="d7ec2-133">Punkt końcowy usługi w chmurze i uzyskiwać dostęp do listy kontroli (ACL)</span><span class="sxs-lookup"><span data-stu-id="d7ec2-133">Cloud service endpoint and access control list (ACL)</span></span>](#source-3-cloud-service-endpoint-and-acl)
* [<span data-ttu-id="d7ec2-134">Sieciowe grupy zabezpieczeń</span><span class="sxs-lookup"><span data-stu-id="d7ec2-134">Network security groups</span></span>](#source-4-network-security-groups)
* [<span data-ttu-id="d7ec2-135">Oparte na systemie Windows Azure maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="d7ec2-135">Windows-based Azure VM</span></span>](#source-5-windows-based-azure-vm)

## <a name="source-1-remote-desktop-client-computer"></a><span data-ttu-id="d7ec2-136">Źródło 1: Komputer klienta usług pulpitu zdalnego</span><span class="sxs-lookup"><span data-stu-id="d7ec2-136">Source 1: Remote Desktop client computer</span></span>
<span data-ttu-id="d7ec2-137">Sprawdź, czy komputer można utworzyć pulpitu zdalnego połączenia tooanother lokalnie, komputer z systemem Windows.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-137">Verify that your computer can make Remote Desktop connections tooanother on-premises, Windows-based computer.</span></span>

![](./media/detailed-troubleshoot-rdp/tshootrdp_1.png)

<span data-ttu-id="d7ec2-138">Jeśli nie możesz sprawdzić hello następujące ustawienia na komputerze:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-138">If you cannot, check for hello following settings on your computer:</span></span>

* <span data-ttu-id="d7ec2-139">Ustawienia zapory lokalnej, która blokuje ruch pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-139">A local firewall setting that is blocking Remote Desktop traffic.</span></span>
* <span data-ttu-id="d7ec2-140">Lokalnie zainstalowane oprogramowanie serwera proxy klienta, który uniemożliwia połączeń pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-140">Locally installed client proxy software that is preventing Remote Desktop connections.</span></span>
* <span data-ttu-id="d7ec2-141">Lokalnie zainstalować oprogramowania, który uniemożliwia połączeń pulpitu zdalnego do monitorowania sieci.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-141">Locally installed network monitoring software that is preventing Remote Desktop connections.</span></span>
* <span data-ttu-id="d7ec2-142">Inne rodzaje oprogramowania zabezpieczającego które monitorowania ruchu lub Zezwalaj/nie zezwalaj na określone typy ruchu, który uniemożliwia połączeń pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-142">Other types of security software that either monitor traffic or allow/disallow specific types of traffic that is preventing Remote Desktop connections.</span></span>

<span data-ttu-id="d7ec2-143">W takich przypadkach tymczasowo wyłączyć hello oprogramowania i spróbuj tooconnect tooan na komputerze lokalnym za pośrednictwem pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-143">In all these cases, temporarily disable hello software and try tooconnect tooan on-premises computer via Remote Desktop.</span></span> <span data-ttu-id="d7ec2-144">Jeśli można znaleźć rzeczywista Przyczyna hello w ten sposób, współpracować z administratora toocorrect hello oprogramowania ustawienia tooallow pulpitu zdalnego połączenia sieciowe.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-144">If you can find out hello actual cause this way, work with your network administrator toocorrect hello software settings tooallow Remote Desktop connections.</span></span>

## <a name="source-2-organization-intranet-edge-device"></a><span data-ttu-id="d7ec2-145">Źródło 2: Urządzenie brzegowe intranetu organizacji</span><span class="sxs-lookup"><span data-stu-id="d7ec2-145">Source 2: Organization intranet edge device</span></span>
<span data-ttu-id="d7ec2-146">Sprawdź, czy komputer bezpośrednio połączony toohello przez Internet tooyour połączeń usług pulpitu zdalnego maszyny wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-146">Verify that a computer directly connected toohello Internet can make Remote Desktop connections tooyour Azure virtual machine.</span></span>

![](./media/detailed-troubleshoot-rdp/tshootrdp_2.png)

<span data-ttu-id="d7ec2-147">Jeśli nie masz komputera podłączonego bezpośrednio toohello Internet, tworzenie i testowanie z nowej maszyny wirtualnej platformy Azure w usłudze chmury lub grupy zasobów.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-147">If you do not have a computer that is directly connected toohello Internet, create and test with a new Azure virtual machine in a resource group or cloud service.</span></span> <span data-ttu-id="d7ec2-148">Aby uzyskać więcej informacji, zobacz [Utwórz maszynę wirtualną z systemem Windows na platformie Azure](../virtual-machines-windows-hero-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-148">For more information, see [Create a virtual machine running Windows in Azure](../virtual-machines-windows-hero-tutorial.md).</span></span> <span data-ttu-id="d7ec2-149">Można usunąć maszyny wirtualnej hello i hello grupy zasobów lub usługi w chmurze hello, po hello testu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-149">You can delete hello virtual machine and hello resource group or hello cloud service, after hello test.</span></span>

<span data-ttu-id="d7ec2-150">Jeśli można utworzyć połączenia pulpitu zdalnego z komputerem podłączony bezpośrednio toohello internetowe, sprawdź urządzenie krawędzi intranetu organizacji dla:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-150">If you can create a Remote Desktop connection with a computer directly attached toohello Internet, check your organization intranet edge device for:</span></span>

* <span data-ttu-id="d7ec2-151">Wewnętrzny Zapora blokuje HTTPS toohello połączeń internetowych.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-151">An internal firewall blocking HTTPS connections toohello Internet.</span></span>
* <span data-ttu-id="d7ec2-152">Serwer proxy uniemożliwia połączeń pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-152">A proxy server preventing Remote Desktop connections.</span></span>
* <span data-ttu-id="d7ec2-153">Włamań lub oprogramowanie na urządzeniach w sieci krawędzi, która uniemożliwia połączeń pulpitu zdalnego do monitorowania sieci.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-153">Intrusion detection or network monitoring software running on devices in your edge network that is preventing Remote Desktop connections.</span></span>

<span data-ttu-id="d7ec2-154">Współpraca z ustawień sieci administrator toocorrect hello z Twojej organizacji intranet krawędzi urządzenia tooallow oparty na protokole HTTPS pulpitu zdalnego połączenia toohello Internet.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-154">Work with your network administrator toocorrect hello settings of your organization intranet edge device tooallow HTTPS-based Remote Desktop connections toohello Internet.</span></span>

## <a name="source-3-cloud-service-endpoint-and-acl"></a><span data-ttu-id="d7ec2-155">Źródło 3: Punkt końcowy usługi w chmurze i listy ACL</span><span class="sxs-lookup"><span data-stu-id="d7ec2-155">Source 3: Cloud service endpoint and ACL</span></span>
<span data-ttu-id="d7ec2-156">Maszyny wirtualne utworzone przy użyciu klasycznego modelu wdrożenia hello, sprawdź innej maszyny Wirtualnej platformy Azure, która jest w hello sama usługa w chmurze lub sieci wirtualnej można wprowadzać tooyour połączeń usług pulpitu zdalnego maszyny Wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-156">For VMs created using hello Classic deployment model, verify that another Azure VM that is in hello same cloud service or virtual network can make Remote Desktop connections tooyour Azure VM.</span></span>

![](./media/detailed-troubleshoot-rdp/tshootrdp_3.png)

> [!NOTE]
> <span data-ttu-id="d7ec2-157">Dla maszyn wirtualnych utworzonych w Menedżerze zasobów, Pomiń zbyt[źródła 4: grup zabezpieczeń sieci](#source-4-network-security-groups).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-157">For virtual machines created in Resource Manager, skip too[Source 4: Network Security Groups](#source-4-network-security-groups).</span></span>

<span data-ttu-id="d7ec2-158">Jeśli nie masz inną maszynę wirtualną w hello tej samej usługi w chmurze lub sieci wirtualnej, utwórz je.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-158">If you do not have another virtual machine in hello same cloud service or virtual network, create one.</span></span> <span data-ttu-id="d7ec2-159">Wykonaj kroki hello w [Utwórz maszynę wirtualną z systemem Windows na platformie Azure](../virtual-machines-windows-hero-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-159">Follow hello steps in [Create a virtual machine running Windows in Azure](../virtual-machines-windows-hero-tutorial.md).</span></span> <span data-ttu-id="d7ec2-160">Po zakończeniu testu hello, należy usunąć hello testowej maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-160">Delete hello test virtual machine after hello test is completed.</span></span>

<span data-ttu-id="d7ec2-161">Jeśli można połączyć za pośrednictwem pulpitu zdalnego maszyny wirtualnej tooa hello takie same w chmurze, usługi lub wirtualnych sieci, sprawdź, czy te ustawienia:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-161">If you can connect via Remote Desktop tooa virtual machine in hello same cloud service or virtual network, check for these settings:</span></span>

* <span data-ttu-id="d7ec2-162">Witaj konfiguracji punktu końcowego dla ruchu pulpitu zdalnego w celu hello maszyny Wirtualnej: port prywatny TCP hello hello punktu końcowego musi być zgodna hello port TCP, na które hello nasłuchuje usługa Pulpit zdalny maszyny Wirtualnej (wartość domyślna to 3389).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-162">hello endpoint configuration for Remote Desktop traffic on hello target VM: hello private TCP port of hello endpoint must match hello TCP port on which hello VM's Remote Desktop service is listening (default is 3389).</span></span>
* <span data-ttu-id="d7ec2-163">Witaj listy ACL punktu końcowego ruchu pulpitu zdalnego hello w celu hello maszyny Wirtualnej: listy ACL umożliwiają toospecify dozwolony lub niedozwolony ruch przychodzący z hello Internet na podstawie źródłowego adresu IP.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-163">hello ACL for hello Remote Desktop traffic endpoint on hello target VM: ACLs allow you toospecify allowed or denied incoming traffic from hello Internet based on its source IP address.</span></span> <span data-ttu-id="d7ec2-164">Nieprawidłowo skonfigurowane listy kontroli dostępu można zapobiec toohello ruchu przychodzącego usług pulpitu zdalnego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-164">Misconfigured ACLs can prevent incoming Remote Desktop traffic toohello endpoint.</span></span> <span data-ttu-id="d7ec2-165">Sprawdź tooensure Twojego listy ACL, ruch przychodzący z publicznych adresów IP, serwer proxy lub inny serwer krawędzi jest dozwolony.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-165">Check your ACLs tooensure that incoming traffic from your public IP addresses of your proxy or other edge server is allowed.</span></span> <span data-ttu-id="d7ec2-166">Aby uzyskać więcej informacji, zobacz [co to jest sieć listy kontroli dostępu (ACL)?](../../virtual-network/virtual-networks-acl.md)</span><span class="sxs-lookup"><span data-stu-id="d7ec2-166">For more information, see [What is a Network Access Control List (ACL)?](../../virtual-network/virtual-networks-acl.md)</span></span>

<span data-ttu-id="d7ec2-167">toocheck Jeśli hello punkt końcowy jest źródłem hello hello problemu, Usuń hello bieżący punkt końcowy i utworzyć nową, wybierając losowego portu hello zakresu 49152 – 65535 hello numeru portu zewnętrznego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-167">toocheck if hello endpoint is hello source of hello problem, remove hello current endpoint and create a new one, choosing a random port in hello range 49152–65535 for hello external port number.</span></span> <span data-ttu-id="d7ec2-168">Aby uzyskać więcej informacji, zobacz [jak tooset maszyny wirtualnej tooa punkty końcowe](classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-168">For more information, see [How tooset up endpoints tooa virtual machine](classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span></span>

## <a name="source-4-network-security-groups"></a><span data-ttu-id="d7ec2-169">Źródła 4: Grupy zabezpieczeń sieci</span><span class="sxs-lookup"><span data-stu-id="d7ec2-169">Source 4: Network Security Groups</span></span>
<span data-ttu-id="d7ec2-170">Grupy zabezpieczeń sieci umożliwiają większą kontrolę nad dozwolonego ruchu przychodzącego i wychodzącego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-170">Network Security Groups allow more granular control of allowed inbound and outbound traffic.</span></span> <span data-ttu-id="d7ec2-171">Można utworzyć zasady obejmujące podsieci i usług w sieci wirtualnej platformy Azure w chmurze.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-171">You can create rules spanning subnets and cloud services in an Azure virtual network.</span></span>

<span data-ttu-id="d7ec2-172">Użyj [Sprawdź przepływ IP](../../network-watcher/network-watcher-check-ip-flow-verify-portal.md) tooconfirm, jeśli zasada grupy zabezpieczeń sieci blokuje tooor ruch z maszyny wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-172">Use [IP flow verify](../../network-watcher/network-watcher-check-ip-flow-verify-portal.md) tooconfirm if a rule in a Network Security Group is blocking traffic tooor from a virtual machine.</span></span> <span data-ttu-id="d7ec2-173">Można również przejrzeć grupy efektywnym elementem systemu zabezpieczeń, które reguły tooensure ruchu przychodzącego "Zezwalaj" NSG reguły istnieje i jest priorytety dla portu protokołu RDP (ustawienie domyślne 3389).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-173">You can also review effective security group rules tooensure inbound "Allow" NSG rule exists and is prioritized for RDP port(default 3389).</span></span> <span data-ttu-id="d7ec2-174">Aby uzyskać więcej informacji, zobacz [przepływu ruchu przy użyciu reguł zabezpieczeń skuteczne tootroubleshoot maszyny Wirtualnej](../../virtual-network/virtual-network-nsg-troubleshoot-portal.md#using-effective-security-rules-to-troubleshoot-vm-traffic-flow).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-174">For more information, see [Using Effective Security Rules tootroubleshoot VM traffic flow](../../virtual-network/virtual-network-nsg-troubleshoot-portal.md#using-effective-security-rules-to-troubleshoot-vm-traffic-flow).</span></span>

## <a name="source-5-windows-based-azure-vm"></a><span data-ttu-id="d7ec2-175">Źródło 5: Opartych na systemie Windows Azure maszyny Wirtualnej</span><span class="sxs-lookup"><span data-stu-id="d7ec2-175">Source 5: Windows-based Azure VM</span></span>
![](./media/detailed-troubleshoot-rdp/tshootrdp_5.png)

<span data-ttu-id="d7ec2-176">Postępuj zgodnie z instrukcjami hello [w tym artykule](reset-rdp.md).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-176">Follow hello instructions in [this article](reset-rdp.md).</span></span> <span data-ttu-id="d7ec2-177">W tym artykule resetuje hello usługi pulpitu zdalnego na maszynie wirtualnej hello:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-177">This article resets hello Remote Desktop service on hello virtual machine:</span></span>

* <span data-ttu-id="d7ec2-178">Włącz regułę domyślną "Pulpit zdalny" Zapora systemu Windows hello (port 3389 protokołu TCP).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-178">Enable hello "Remote Desktop" Windows Firewall default rule (TCP port 3389).</span></span>
* <span data-ttu-id="d7ec2-179">Włączenie połączeń pulpitu zdalnego przez ustawienie too0 wartość rejestru HKLM\System\CurrentControlSet\Control\Terminal Server\fDenyTSConnections hello.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-179">Enable Remote Desktop connections by setting hello HKLM\System\CurrentControlSet\Control\Terminal Server\fDenyTSConnections registry value too0.</span></span>

<span data-ttu-id="d7ec2-180">Spróbuj hello ponownie nawiązać połączenie z komputera.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-180">Try hello connection from your computer again.</span></span> <span data-ttu-id="d7ec2-181">Jeśli nadal nie możesz tooconnect za pośrednictwem pulpitu zdalnego, sprawdź powitania po możliwych problemów:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-181">If you are still not able tooconnect via Remote Desktop, check for hello following possible problems:</span></span>

* <span data-ttu-id="d7ec2-182">Witaj usługi pulpitu zdalnego nie jest uruchomiona na powitania docelowej maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-182">hello Remote Desktop service is not running on hello target VM.</span></span>
* <span data-ttu-id="d7ec2-183">Hello usługi Pulpit zdalny nie nasłuchuje portu 3389 protokołu TCP.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-183">hello Remote Desktop service is not listening on TCP port 3389.</span></span>
* <span data-ttu-id="d7ec2-184">Zapora systemu Windows lub innej zapory lokalnej ma wychodzącą regułę, która uniemożliwia ruchu pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-184">Windows Firewall or another local firewall has an outbound rule that is preventing Remote Desktop traffic.</span></span>
* <span data-ttu-id="d7ec2-185">Włamań lub oprogramowania uruchomionego na powitania maszyny wirtualnej platformy Azure do monitorowania sieci uniemożliwia połączeń pulpitu zdalnego.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-185">Intrusion detection or network monitoring software running on hello Azure virtual machine is preventing Remote Desktop connections.</span></span>

<span data-ttu-id="d7ec2-186">Dla maszyn wirtualnych utworzonych przy użyciu hello klasycznego modelu wdrażania można użyć zdalnego toohello sesji programu Azure PowerShell maszyny wirtualnej platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-186">For VMs created using hello classic deployment model, you can use a remote Azure PowerShell session toohello Azure virtual machine.</span></span> <span data-ttu-id="d7ec2-187">Najpierw należy tooinstall certyfikatu dla maszyny wirtualnej hello usługi hostingu w chmurze.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-187">First, you need tooinstall a certificate for hello virtual machine's hosting cloud service.</span></span> <span data-ttu-id="d7ec2-188">Przejdź za[tooAzure skonfigurować bezpiecznego środowiska PowerShell dostępu zdalnego maszyn wirtualnych](http://gallery.technet.microsoft.com/scriptcenter/Configures-Secure-Remote-b137f2fe) i Pobierz hello **InstallWinRMCertAzureVM.ps1** komputera lokalnego tooyour pliku skryptu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-188">Go too[Configure Secure Remote PowerShell Access tooAzure Virtual Machines](http://gallery.technet.microsoft.com/scriptcenter/Configures-Secure-Remote-b137f2fe) and download hello **InstallWinRMCertAzureVM.ps1** script file tooyour local computer.</span></span>

<span data-ttu-id="d7ec2-189">Następnie zainstaluj programu Azure PowerShell, jeśli nie jest jeszcze.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-189">Next, install Azure PowerShell if you haven't already.</span></span> <span data-ttu-id="d7ec2-190">Zobacz [jak tooinstall i konfigurowanie programu Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-190">See [How tooinstall and configure Azure PowerShell](/powershell/azure/overview).</span></span>

<span data-ttu-id="d7ec2-191">Następnie otwórz wiersz polecenia programu PowerShell systemu Azure i zmienić hello bieżącego toohello lokalizację folderu hello **InstallWinRMCertAzureVM.ps1** pliku skryptu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-191">Next, open an Azure PowerShell command prompt and change hello current folder toohello location of hello **InstallWinRMCertAzureVM.ps1** script file.</span></span> <span data-ttu-id="d7ec2-192">toorun skryptu programu Azure PowerShell, należy ustawić zasady wykonywania poprawne hello.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-192">toorun an Azure PowerShell script, you must set hello correct execution policy.</span></span> <span data-ttu-id="d7ec2-193">Uruchom hello **Get-ExecutionPolicy** polecenia toodetermine aktualny poziom zasad.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-193">Run hello **Get-ExecutionPolicy** command toodetermine your current policy level.</span></span> <span data-ttu-id="d7ec2-194">Informacje o ustawianiu hello odpowiedni poziom, zobacz [Set-ExecutionPolicy](https://technet.microsoft.com/library/hh849812.aspx).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-194">For information about setting hello appropriate level, see [Set-ExecutionPolicy](https://technet.microsoft.com/library/hh849812.aspx).</span></span>

<span data-ttu-id="d7ec2-195">Następnie wypełnij nazwę subskrypcji platformy Azure, nazwa usługi w chmurze hello i nazwy maszyny wirtualnej (usuwanie hello < i > znaków), a następnie uruchom następujące polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-195">Next, fill in your Azure subscription name, hello cloud service name, and your virtual machine name (removing hello < and > characters), and then run these commands.</span></span>

```powershell
$subscr="<Name of your Azure subscription>"
$serviceName="<Name of hello cloud service that contains hello target virtual machine>"
$vmName="<Name of hello target virtual machine>"
.\InstallWinRMCertAzureVM.ps1 -SubscriptionName $subscr -ServiceName $serviceName -Name $vmName
```

<span data-ttu-id="d7ec2-196">Nazwa subskrypcji poprawne hello można pobrać z hello *Nazwa subskrypcji* właściwości wyświetlania hello hello **Get-AzureSubscription** polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-196">You can get hello correct subscription name from hello *SubscriptionName* property of hello display of hello **Get-AzureSubscription** command.</span></span> <span data-ttu-id="d7ec2-197">Nazwa usługi w chmurze hello hello maszyny wirtualnej można uzyskać z hello *ServiceName* kolumny w hello wyświetlanie hello **Get-AzureVM** polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-197">You can get hello cloud service name for hello virtual machine from hello *ServiceName* column in hello display of hello **Get-AzureVM** command.</span></span>

<span data-ttu-id="d7ec2-198">Sprawdź, czy masz hello nowego certyfikatu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-198">Check if you have hello new certificate.</span></span> <span data-ttu-id="d7ec2-199">Otwórz przystawkę Certyfikaty dla bieżącego użytkownika hello i Znajdź hello **zaufany główny Certification Authorities\Certificates** folderu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-199">Open a Certificates snap-in for hello current user and look in hello **Trusted Root Certification Authorities\Certificates** folder.</span></span> <span data-ttu-id="d7ec2-200">Powinny pojawić się certyfikatu z nazwą DNS hello usługi w chmurze w hello toocolumn wydany (przykład: cloudservice4testing.cloudapp.net).</span><span class="sxs-lookup"><span data-stu-id="d7ec2-200">You should see a certificate with hello DNS name of your cloud service in hello Issued toocolumn (example: cloudservice4testing.cloudapp.net).</span></span>

<span data-ttu-id="d7ec2-201">Następnie zainicjować sesję zdalną programu Azure PowerShell przy użyciu tych poleceń.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-201">Next, initiate a remote Azure PowerShell session by using these commands.</span></span>

```powershell
$uri = Get-AzureWinRMUri -ServiceName $serviceName -Name $vmName
$creds = Get-Credential
Enter-PSSession -ConnectionUri $uri -Credential $creds
```

<span data-ttu-id="d7ec2-202">Po wprowadzeniu poświadczeń administratora prawidłowe, powinny być widoczne coś podobnego toohello po wierszu programu Azure PowerShell:</span><span class="sxs-lookup"><span data-stu-id="d7ec2-202">After entering valid administrator credentials, you should see something similar toohello following Azure PowerShell prompt:</span></span>

```powershell
[cloudservice4testing.cloudapp.net]: PS C:\Users\User1\Documents>
```

<span data-ttu-id="d7ec2-203">Pierwsza część tego monitu Hello jest nazwę usługi w chmurze zawierającego hello docelowej maszyny Wirtualnej, może być inny niż "cloudservice4testing.cloudapp.net".</span><span class="sxs-lookup"><span data-stu-id="d7ec2-203">hello first part of this prompt is your cloud service name that contains hello target VM, which could be different from "cloudservice4testing.cloudapp.net".</span></span> <span data-ttu-id="d7ec2-204">Teraz można wydać polecenia programu PowerShell systemu Azure dla tej chmury usługi tooinvestigate hello problemy wspomniane i popraw konfigurację hello.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-204">You can now issue Azure PowerShell commands for this cloud service tooinvestigate hello problems mentioned and correct hello configuration.</span></span>

### <a name="toomanually-correct-hello-remote-desktop-services-listening-tcp-port"></a><span data-ttu-id="d7ec2-205">toomanually Popraw hello usług pulpitu zdalnego nasłuchiwania na porcie TCP</span><span class="sxs-lookup"><span data-stu-id="d7ec2-205">toomanually correct hello Remote Desktop Services listening TCP port</span></span>
<span data-ttu-id="d7ec2-206">W wierszu hello zdalnego programu Azure PowerShell sesji Uruchom to polecenie.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-206">At hello remote Azure PowerShell session prompt, run this command.</span></span>

```powershell
Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"
```

<span data-ttu-id="d7ec2-207">Właściwość PortNumber Hello pokazuje hello bieżący numer portu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-207">hello PortNumber property shows hello current port number.</span></span> <span data-ttu-id="d7ec2-208">W razie potrzeby zmień hello pulpitu zdalnego portu numer wstecz tooits wartość domyślna (3389) za pomocą tego polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-208">If needed, change hello Remote Desktop port number back tooits default value (3389) by using this command.</span></span>

```powershell
Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber" -Value 3389
```

<span data-ttu-id="d7ec2-209">Upewnij się, że hello port zostało zmienione too3389 za pomocą tego polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-209">Verify that hello port has been changed too3389 by using this command.</span></span>

```powershell
Get-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" -Name "PortNumber"
```

<span data-ttu-id="d7ec2-210">Zamknąć sesji zdalnej programu Azure PowerShell hello za pomocą tego polecenia.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-210">Exit hello remote Azure PowerShell session by using this command.</span></span>

```powershell
Exit-PSSession
```

<span data-ttu-id="d7ec2-211">Sprawdź, czy tego punktu końcowego pulpitu zdalnego dla maszyny Wirtualnej Azure hello hello również używa portu TCP 3398 jako wewnętrznego portu.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-211">Verify that hello Remote Desktop endpoint for hello Azure VM is also using TCP port 3398 as its internal port.</span></span> <span data-ttu-id="d7ec2-212">Uruchom ponownie hello maszyny Wirtualnej platformy Azure, a następnie spróbuj ponownie Podłączanie pulpitu zdalnego hello.</span><span class="sxs-lookup"><span data-stu-id="d7ec2-212">Restart hello Azure VM and try hello Remote Desktop connection again.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="d7ec2-213">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="d7ec2-213">Additional resources</span></span>
[<span data-ttu-id="d7ec2-214">Jak usługa tooreset hasła lub hello pulpitu zdalnego dla maszyn wirtualnych systemu Windows</span><span class="sxs-lookup"><span data-stu-id="d7ec2-214">How tooreset a password or hello Remote Desktop service for Windows virtual machines</span></span>](reset-rdp.md)

[<span data-ttu-id="d7ec2-215">Jak tooinstall i konfigurowanie programu Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="d7ec2-215">How tooinstall and configure Azure PowerShell</span></span>](/powershell/azure/overview)

[<span data-ttu-id="d7ec2-216">Rozwiązywanie problemów z Secure Shell (SSH) połączeń tooa opartych na systemie Linux maszyny wirtualnej platformy Azure</span><span class="sxs-lookup"><span data-stu-id="d7ec2-216">Troubleshoot Secure Shell (SSH) connections tooa Linux-based Azure virtual machine</span></span>](../linux/troubleshoot-ssh-connection.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

[<span data-ttu-id="d7ec2-217">Rozwiązywanie problemów z dostępu tooan aplikacji uruchomionych na maszynie wirtualnej platformy Azure</span><span class="sxs-lookup"><span data-stu-id="d7ec2-217">Troubleshoot access tooan application running on an Azure virtual machine</span></span>](../linux/troubleshoot-app-connection.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)

