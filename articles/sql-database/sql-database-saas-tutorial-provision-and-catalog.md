---
title: "aaaProvision nowych dzierżaw w aplikacji wielodostępnych, który używa usługi Azure SQL Database | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak tooprovision i wykaz nowej dzierżawy w hello aplikacji Wingtip SaaS"
keywords: "samouczek usługi sql database"
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: sstein
ms.openlocfilehash: eb26f523305650c2124e36707d187dfcdad06fcc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="provision-new-tenants-and-register-them-in-hello-catalog"></a><span data-ttu-id="fe334-104">Udostępnić nowi dzierżawcy i zarejestruj je w katalogu hello</span><span class="sxs-lookup"><span data-stu-id="fe334-104">Provision new tenants and register them in hello catalog</span></span>

<span data-ttu-id="fe334-105">W tym samouczku informacje o hello udostępniania i wzorce SaaS katalogu i ich implementacji w hello aplikacji Wingtip SaaS.</span><span class="sxs-lookup"><span data-stu-id="fe334-105">In this tutorial, you learn about hello provision and catalog SaaS patterns, and how they are implemented in hello Wingtip SaaS application.</span></span> <span data-ttu-id="fe334-106">Tworzenie i zainicjować nowe dzierżawy bazy danych oraz zarejestrować je w katalogu dzierżawcy hello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fe334-106">You create and initialize new tenant databases, and register them in hello application’s tenant catalog.</span></span> <span data-ttu-id="fe334-107">katalog Hello to bazy danych, która przechowuje hello mapowanie między swoich danych i aplikacji SaaS hello wiele dzierżaw.</span><span class="sxs-lookup"><span data-stu-id="fe334-107">hello catalog is a database that maintains hello mapping between hello SaaS application's many tenants and their data.</span></span> <span data-ttu-id="fe334-108">wykaz Hello odgrywa ważną rolę w kierowanie aplikacji żądań toohello poprawną bazą danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-108">hello catalog plays an important role directing application requests toohello correct database.</span></span>  

<span data-ttu-id="fe334-109">Ten samouczek zawiera informacje na temat wykonywania następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="fe334-109">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="fe334-110">Udostępnianie jednej nowej dzierżawy, tym krokowe to implementowania</span><span class="sxs-lookup"><span data-stu-id="fe334-110">Provision a single new tenant, including stepping through how this is implemented</span></span>
> * <span data-ttu-id="fe334-111">Aprowizowanie partii dodatkowych dzierżaw</span><span class="sxs-lookup"><span data-stu-id="fe334-111">Provision a batch of additional tenants</span></span>


<span data-ttu-id="fe334-112">toocomplete ukończenia tego samouczka, Utwórz hello się, że następujące wymagania wstępne:</span><span class="sxs-lookup"><span data-stu-id="fe334-112">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="fe334-113">Aplikacja Wingtip SaaS Hello jest wdrażana.</span><span class="sxs-lookup"><span data-stu-id="fe334-113">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="fe334-114">Zobacz toodeploy w mniej niż pięć minut [wdrażania i aplikacji Wingtip SaaS hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="fe334-114">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="fe334-115">Zainstalowany jest program Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="fe334-115">Azure PowerShell is installed.</span></span> <span data-ttu-id="fe334-116">Aby uzyskać szczegółowe informacje, zobacz [Rozpoczynanie pracy z programem Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="fe334-116">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toohello-saas-catalog-pattern"></a><span data-ttu-id="fe334-117">Wprowadzenie toohello wzorzec katalogu SaaS</span><span class="sxs-lookup"><span data-stu-id="fe334-117">Introduction toohello SaaS Catalog pattern</span></span>

<span data-ttu-id="fe334-118">Kopie bazy danych wielodostępnych aplikacji SaaS jest ważne tooknow, w którym przechowywane są informacje dla każdego dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fe334-118">In a database-backed multi-tenant SaaS application, it's important tooknow where information for each tenant is stored.</span></span> <span data-ttu-id="fe334-119">We wzorcu katalogu SaaS hello katalog bazy danych jest używane toohold hello mapowanie między każdego dzierżawcy i gdzie są przechowywane ich dane.</span><span class="sxs-lookup"><span data-stu-id="fe334-119">In hello SaaS catalog pattern, a catalog database is used toohold hello mapping between each tenant and where their data is stored.</span></span> <span data-ttu-id="fe334-120">Aplikacja Wingtip SaaS Hello używa pojedynczego dzierżawcy na Architektura bazy danych, ale hello podstawowy wzorzec przechowywania mapowania dzierżawcy w bazie danych w katalogu ma zastosowanie, czy ma być używana w wielu dzierżawców lub pojedynczej dzierżawy bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-120">hello Wingtip SaaS app uses a single-tenant per database architecture, but hello basic pattern of storing tenant-to-database mapping in a catalog applies whether a multi-tenant or single-tenant database is used.</span></span>

<span data-ttu-id="fe334-121">Każdej dzierżawy jest przypisywana klucz identyfikujący je w katalogu hello, który jest mapowany toohello lokalizacji hello odpowiednie bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-121">Each tenant is assigned a key that identifies them in hello catalog and which is mapped toohello location of hello appropriate database.</span></span> <span data-ttu-id="fe334-122">W aplikacji Wingtip SaaS hello klucza hello powstała z wyznaczania wartości skrótu o nazwie hello dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fe334-122">In hello Wingtip SaaS app, hello key is formed from a hash of hello tenant’s name.</span></span> <span data-ttu-id="fe334-123">Dzięki temu hello dzierżawy część nazwy toobe adres URL aplikacji hello używanych tooconstruct hello klucza.</span><span class="sxs-lookup"><span data-stu-id="fe334-123">This allows hello tenant name portion of hello application URL toobe used tooconstruct hello key.</span></span> <span data-ttu-id="fe334-124">Można użyć innych systemów klucza dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fe334-124">Other tenant key schemes could be used.</span></span>  

<span data-ttu-id="fe334-125">wykaz Hello umożliwia hello nazwę lub lokalizację hello toobe bazy danych, zmienić przy minimalnym wpływie na powitania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fe334-125">hello catalog allows hello name or location of hello database toobe changed with minimal impact on hello application.</span></span>  <span data-ttu-id="fe334-126">W modelu wielodostępnym bazy danych to również bierze pod uwagę "przenoszenia" dzierżawa między bazami danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-126">In a multi-tenant database model, this also accommodates ‘moving’ a tenant between databases.</span></span>  <span data-ttu-id="fe334-127">Hello katalogu mogą być również używane tooindicate, czy dzierżawcy lub baza danych jest w trybie offline z powodu konserwacji lub innych działań.</span><span class="sxs-lookup"><span data-stu-id="fe334-127">hello catalog can also be used tooindicate whether a tenant or database is offline for maintenance or other actions.</span></span> <span data-ttu-id="fe334-128">Jest to przedstawione w hello [Przywracanie pojedynczej dzierżawy samouczek](sql-database-saas-tutorial-restore-single-tenant.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-128">This is explored in hello [restore single tenant tutorial](sql-database-saas-tutorial-restore-single-tenant.md).</span></span>

<span data-ttu-id="fe334-129">Ponadto hello katalog, który jest włączone zarządzanie bazy danych dla aplikacji SaaS, można przechowywać dodatkowe metadane dzierżawy lub bazy danych, takich jak hello warstwy lub wersja bazy danych, wersji schematu, plan usługi lub umów SLA oferowanych tootenants i innych informacji o który Umożliwia zarządzanie aplikacjami, dział obsługi klienta lub procesów opracowywania oprogramowania.</span><span class="sxs-lookup"><span data-stu-id="fe334-129">In addition, hello catalog, which is in effect a management database for a SaaS application, can store additional tenant or database metadata, such as hello tier or edition of a database, schema version, service plan, or SLAs offered tootenants, and other info that enables application management, customer support, or devops processes.</span></span>  

<span data-ttu-id="fe334-130">Poza hello aplikacji SaaS hello katalogu można włączyć narzędzi bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-130">Beyond hello SaaS application, hello catalog can enable database tools.</span></span>  <span data-ttu-id="fe334-131">W przykładzie Wingtip SaaS hello katalogu hello jest używane tooenable dzierżawy między zapytania, przedstawione w hello [samouczek analizy ad hoc](sql-database-saas-tutorial-adhoc-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-131">In hello Wingtip SaaS sample, hello catalog is used tooenable cross-tenant query, explored in hello [ad hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md).</span></span> <span data-ttu-id="fe334-132">Zarządzanie zadaniami między bazami danych jest przedstawione w hello [Zarządzanie schematami](sql-database-saas-tutorial-schema-management.md) i [dzierżawy analytics](sql-database-saas-tutorial-tenant-analytics.md) samouczki.</span><span class="sxs-lookup"><span data-stu-id="fe334-132">Cross-database job management is explored in hello [schema management](sql-database-saas-tutorial-schema-management.md) and [tenant analytics](sql-database-saas-tutorial-tenant-analytics.md) tutorials.</span></span> 

<span data-ttu-id="fe334-133">W aplikacji Wingtip SaaS hello katalogu hello jest implementowane za pomocą funkcji zarządzania niezależnego fragmentu hello hello [elastycznej bazy danych klienta biblioteki (EDCL)](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-133">In hello Wingtip SaaS app, hello catalog is implemented using hello Shard Management features of hello [Elastic Database Client Library (EDCL)](sql-database-elastic-database-client-library.md).</span></span> <span data-ttu-id="fe334-134">Witaj EDCL umożliwia toocreate aplikacji, zarządzanie i użyć mapy niezależnych kopii bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-134">hello EDCL enables an application toocreate, manage, and use a database-backed shard map.</span></span> <span data-ttu-id="fe334-135">Mapy niezależnego fragmentu zawiera listę odłamków (bazy danych) i hello mapowanie między kluczy (dzierżawcami) i baz danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-135">A shard map contains a list of shards (databases) and hello mapping between keys (tenants) and databases.</span></span>  <span data-ttu-id="fe334-136">Funkcje EDCL mogą być używane z aplikacji i skryptów programu PowerShell podczas inicjowania obsługi administracyjnej toocreate hello wpisów w mapie niezależnego fragmentu hello dzierżawy i z aplikacji tooefficiently połączyć toohello poprawną bazą danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-136">EDCL functions can be used from applications or PowerShell scripts during tenant provisioning toocreate hello entries in hello shard map, and from applications tooefficiently connect toohello correct database.</span></span> <span data-ttu-id="fe334-137">EDCL buforuje połączenia informacji toominimize hello ruchu toohello katalogu bazy danych i poprawę szybkości działania aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-137">EDCL caches connection information toominimize hello traffic toohello catalog database and speed up hello application.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="fe334-138">dane mapowania Hello jest dostępny w bazie danych katalogu hello, ale *nie go edytować*!</span><span class="sxs-lookup"><span data-stu-id="fe334-138">hello mapping data is accessible in hello catalog database, but *don't edit it*!</span></span> <span data-ttu-id="fe334-139">Dane mapowania można edytować wyłącznie za pomocą interfejsu API biblioteki klienckiej Elastic Database.</span><span class="sxs-lookup"><span data-stu-id="fe334-139">Edit mapping data using Elastic Database Client Library APIs only.</span></span> <span data-ttu-id="fe334-140">Bezpośrednie manipulowanie danych mapowania hello ryzyko uszkodzenia hello wykazu i nie jest obsługiwany.</span><span class="sxs-lookup"><span data-stu-id="fe334-140">Directly manipulating hello mapping data risks corrupting hello catalog and is not supported.</span></span>


## <a name="introduction-toohello-saas-provisioning-pattern"></a><span data-ttu-id="fe334-141">Wzorzec SaaS inicjowania obsługi administracyjnej toohello wprowadzenie</span><span class="sxs-lookup"><span data-stu-id="fe334-141">Introduction toohello SaaS Provisioning pattern</span></span>

<span data-ttu-id="fe334-142">Podczas przechodzenia do nowego dzierżawcy w aplikacji SaaS, która używa modelu bazy danych z pojedynczej dzierżawy nową bazę danych dzierżawcy należy udostępnić.</span><span class="sxs-lookup"><span data-stu-id="fe334-142">When onboarding a new tenant in a SaaS application that uses a single-tenant database model a new tenant database must be provisioned.</span></span>  <span data-ttu-id="fe334-143">Muszą być tworzone w hello odpowiednią lokalizację i warstwy usług, zainicjować przy użyciu odpowiedniego schematu i danych referencyjnych, a następnie rejestrowane w katalogu hello klucza dzierżawy odpowiednie hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-143">It must be created in hello appropriate location and service tier, initialized with appropriate schema and reference data, and then registered in hello catalog under hello appropriate tenant key.</span></span>  

<span data-ttu-id="fe334-144">Różne podejścia mogą być używane toodatabase inicjowania obsługi, które mogą obejmować wykonywanie skryptów SQL, wdrażanie pliku bacpac lub kopiowania bazy danych "złotego" szablonu.</span><span class="sxs-lookup"><span data-stu-id="fe334-144">Different approaches can be used toodatabase provisioning, which could include executing SQL scripts, deploying a bacpac, or copying a 'golden' template database.</span></span>  

<span data-ttu-id="fe334-145">Witaj inicjowania obsługi administracyjnej podejście, którego używasz musi comprehended w strategii zarządzania ogólny schemat, który musi zapewnić, że nowych baz danych są udostępniane z hello najnowsze schematu.</span><span class="sxs-lookup"><span data-stu-id="fe334-145">hello provisioning approach you use must be comprehended in your overall schema management strategy, which must ensure that new databases are provisioned with hello latest schema.</span></span>  <span data-ttu-id="fe334-146">Jest to przedstawione w hello [Samouczek zarządzania schematu](sql-database-saas-tutorial-schema-management.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-146">This is explored in hello [schema management tutorial](sql-database-saas-tutorial-schema-management.md).</span></span>  

<span data-ttu-id="fe334-147">Witaj Wingtip SaaS aplikacji przepisy nowi dzierżawcy przez skopiowanie złotego bazy danych o nazwie basetenantdb wdrożone na serwerze wykazu hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-147">hello Wingtip SaaS app provisions new tenants by copying a golden database named basetenantdb, deployed on hello catalog server.</span></span>  <span data-ttu-id="fe334-148">Inicjowanie obsługi administracyjnej można zintegrowana aplikacja hello jako część środowisko tworzenia konta, i/lub być obsługiwane w trybie offline za pomocą skryptów.</span><span class="sxs-lookup"><span data-stu-id="fe334-148">Provisioning could be integrated into hello application as part of a sign-up experience, and/or supported offline using scripts.</span></span> <span data-ttu-id="fe334-149">W tym samouczku może zapoznać się inicjowanie obsługi przy użyciu programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="fe334-149">This tutorial will explore provisioning using PowerShell.</span></span> <span data-ttu-id="fe334-150">skrypty inicjowania obsługi administracyjnej Hello skopiuj toocreate basetenantdb hello nowej dzierżawy bazy danych w puli elastycznej, a następnie go zainicjować z użyciem informacji specyficznych dla dzierżawy i zarejestrować ją w hello katalogu niezależnych mapy.</span><span class="sxs-lookup"><span data-stu-id="fe334-150">hello provisioning scripts copy hello basetenantdb toocreate a new tenant database in an elastic pool, then initialize it with tenant-specific info and register it in hello catalog shard map.</span></span>  <span data-ttu-id="fe334-151">W hello przykładowej aplikacji, baz danych są podane nazwy na podstawie nazwy dzierżawy hello, ale nie jest krytyczną częścią wzorzec hello — hello katalogu hello umożliwiają dowolnej nazwy bazy danych toohello toobe przypisane. +</span><span class="sxs-lookup"><span data-stu-id="fe334-151">In hello sample app, databases are given names based on hello tenant name, but this is not a critical part of hello pattern – hello use of hello catalog allows any name toobe assigned toohello database.+</span></span> 


## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="fe334-152">Pobierz skrypty aplikacji hello Wingtip</span><span class="sxs-lookup"><span data-stu-id="fe334-152">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="fe334-153">Witaj Wingtip SaaS skrypty i kod źródłowy aplikacji są dostępne w hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repozytorium github.</span><span class="sxs-lookup"><span data-stu-id="fe334-153">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="fe334-154">[Kroki skrypty Wingtip SaaS hello toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="fe334-154">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>


## <a name="provision-and-catalog-detailed-walkthrough"></a><span data-ttu-id="fe334-155">Szczegółowy przewodnik po aprowizacji i wykazie</span><span class="sxs-lookup"><span data-stu-id="fe334-155">Provision and catalog detailed walkthrough</span></span>

<span data-ttu-id="fe334-156">toounderstand jak hello Wingtip aplikacji implementuje nowej dzierżawy inicjowania obsługi, Dodaj punkt przerwania i krok za pomocą przepływu pracy hello podczas inicjowania obsługi administracyjnej dzierżawcy:</span><span class="sxs-lookup"><span data-stu-id="fe334-156">toounderstand how hello Wingtip application implements new tenant provisioning, add a breakpoint and step through hello workflow while provisioning a tenant:</span></span>

1. <span data-ttu-id="fe334-157">Otwórz... \\Modułów uczenia\\ProvisionAndCatalog\\_ProvisionAndCatalog.ps1 pokaz_ i hello ustaw następujące parametry:</span><span class="sxs-lookup"><span data-stu-id="fe334-157">Open ...\\Learning Modules\\ProvisionAndCatalog\\_Demo-ProvisionAndCatalog.ps1_ and set hello following parameters:</span></span>
   * <span data-ttu-id="fe334-158">**$TenantName** = nazwa hello nowe miejsce hello (na przykład *niebieskie Bushwillow*).</span><span class="sxs-lookup"><span data-stu-id="fe334-158">**$TenantName** = hello name of hello new venue (for example, *Bushwillow Blues*).</span></span>
   * <span data-ttu-id="fe334-159">**$VenueType** = jednego z typów wstępnie zdefiniowanych miejscową hello: *niebieskie*, classicalmusic, tańca, jazz, judo, motorracing uniwersalne, opera, rockmusic, nożną.</span><span class="sxs-lookup"><span data-stu-id="fe334-159">**$VenueType** = one of hello pre-defined venue types: *blues*, classicalmusic, dance, jazz, judo, motorracing, multipurpose, opera, rockmusic, soccer.</span></span>
   * <span data-ttu-id="fe334-160">**$DemoScenario** = **1**zbyt ustaw**1** za*udostępnić pojedynczej dzierżawy*.</span><span class="sxs-lookup"><span data-stu-id="fe334-160">**$DemoScenario** = **1**, Set too**1** too*Provision a single tenant*.</span></span>

1. <span data-ttu-id="fe334-161">Dodaj punkt przerwania umieszczając kursor dowolne miejsce w 48, hello wiersz informacją: *nowej dzierżawy "*i naciśnij klawisz **F9**.</span><span class="sxs-lookup"><span data-stu-id="fe334-161">Add a breakpoint by putting your cursor anywhere on line 48, hello line that says: *New-Tenant \`*, and press **F9**.</span></span>

   ![punkt przerwania](media/sql-database-saas-tutorial-provision-and-catalog/breakpoint.png)

1. <span data-ttu-id="fe334-163">Naciśnij klawisz skryptu hello toorun **F5**.</span><span class="sxs-lookup"><span data-stu-id="fe334-163">toorun hello script press **F5**.</span></span>

1. <span data-ttu-id="fe334-164">Po zatrzymaniu wykonywania skryptu hello na powitania punkt przerwania, naciśnij klawisz **F11** toostep hello kodu.</span><span class="sxs-lookup"><span data-stu-id="fe334-164">After hello script execution stops at hello breakpoint, press **F11** toostep into hello code.</span></span>

   ![punkt przerwania](media/sql-database-saas-tutorial-provision-and-catalog/debug.png)



<span data-ttu-id="fe334-166">Wykonanie skryptu hello hello śledzenia **debugowania** menu Opcje - **F10** i **F11** toostep za pośrednictwem lub hello wywołuje funkcje.</span><span class="sxs-lookup"><span data-stu-id="fe334-166">Trace hello script's execution using hello **Debug** menu options - **F10** and **F11** toostep over or into hello called functions.</span></span> <span data-ttu-id="fe334-167">Aby uzyskać więcej informacji na temat debugowania skryptów programu PowerShell, zobacz [porady dotyczące pracy z i debugowania skryptów programu PowerShell](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span><span class="sxs-lookup"><span data-stu-id="fe334-167">For more information about debugging PowerShell scripts, see [Tips on working with and debugging PowerShell scripts](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span></span>


<span data-ttu-id="fe334-168">następujące Hello nie są tooexplicitly wykonaj kroki, ale wyjaśnienie przepływu pracy hello krokowo podczas debugowania skryptu hello:</span><span class="sxs-lookup"><span data-stu-id="fe334-168">hello following are not steps tooexplicitly follow, but an explanation of hello workflow you step through while debugging hello script:</span></span>

1. <span data-ttu-id="fe334-169">**Importuj hello SubscriptionManagement.psm1** moduł, który zawiera funkcje logowania tooAzure i wyboru hello pracy z subskrypcją platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="fe334-169">**Import hello SubscriptionManagement.psm1** module that contains functions for signing in tooAzure and selecting hello Azure subscription you are working with.</span></span>
1. <span data-ttu-id="fe334-170">**Importuj hello CatalogAndDatabaseManagement.psm1** moduł, który udostępnia katalog i poziomie dzierżawy abstrakcji za pośrednictwem hello [zarządzania niezależnego fragmentu](sql-database-elastic-scale-shard-map-management.md) funkcji.</span><span class="sxs-lookup"><span data-stu-id="fe334-170">**Import hello CatalogAndDatabaseManagement.psm1** module that provides a catalog and tenant-level abstraction over hello [Shard Management](sql-database-elastic-scale-shard-map-management.md) functions.</span></span> <span data-ttu-id="fe334-171">Jest to ważne moduł, który hermetyzuje znacznie hello katalogu wzorca i warto eksploracji.</span><span class="sxs-lookup"><span data-stu-id="fe334-171">This is an important module that encapsulates much of hello catalog pattern and is worth exploring.</span></span>
1. <span data-ttu-id="fe334-172">**Uzyskaj szczegółowe informacje o konfiguracji**.</span><span class="sxs-lookup"><span data-stu-id="fe334-172">**Get configuration details**.</span></span> <span data-ttu-id="fe334-173">Wkrocz Get-konfiguracji (z F11) i zobacz, jak określono hello konfiguracji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fe334-173">Step into Get-Configuration (with F11) and see how hello app config is specified.</span></span> <span data-ttu-id="fe334-174">Nazwy zasobów i inne wartości specyficzny dla aplikacji są zdefiniowane w tym miejscu, ale nie należy zmieniać tych wartości do momentu znasz hello skryptów.</span><span class="sxs-lookup"><span data-stu-id="fe334-174">Resource names and other app-specific values are defined here, but do not change any of these values until you are familiar with hello scripts.</span></span>
1. <span data-ttu-id="fe334-175">**Pobierz obiekt katalogu hello**.</span><span class="sxs-lookup"><span data-stu-id="fe334-175">**Get hello catalog object**.</span></span> <span data-ttu-id="fe334-176">Krok do katalogu Get, która Redaguj i zwraca obiekt katalogu, który jest używany w skrypcie wyższego poziomu hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-176">Step into Get-Catalog which composes and returns a catalog object that is used in hello higher-level script.</span></span>  <span data-ttu-id="fe334-177">Ta funkcja korzysta z funkcji zarządzania niezależnego fragmentu, które są importowane z **AzureShardManagement.psm1**.</span><span class="sxs-lookup"><span data-stu-id="fe334-177">This function uses Shard Management functions that are imported from **AzureShardManagement.psm1**.</span></span> <span data-ttu-id="fe334-178">obiekt katalogu Hello składa się z następujących hello:</span><span class="sxs-lookup"><span data-stu-id="fe334-178">hello catalog object is composed of hello following:</span></span>
   * <span data-ttu-id="fe334-179">$catalogServerFullyQualifiedName jest tworzony przy użyciu standardowych stem hello oraz nazwę użytkownika: _katalogu -\<użytkownika\>. database.windows.net_.</span><span class="sxs-lookup"><span data-stu-id="fe334-179">$catalogServerFullyQualifiedName is constructed using hello standard stem plus your User name: _catalog-\<user\>.database.windows.net_.</span></span>
   * <span data-ttu-id="fe334-180">$catalogDatabaseName są pobierane z konfiguracji hello: *tenantcatalog*.</span><span class="sxs-lookup"><span data-stu-id="fe334-180">$catalogDatabaseName is retrieved from hello config: *tenantcatalog*.</span></span>
   * <span data-ttu-id="fe334-181">Obiekt $shardMapManager został zainicjowany z bazy danych katalogu hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-181">$shardMapManager object is initialized from hello catalog database.</span></span>
   * <span data-ttu-id="fe334-182">Obiekt $shardMap został zainicjowany z hello *tenantcatalog* mapy niezależnego fragmentu w hello katalogu w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-182">$shardMap object is initialized from hello *tenantcatalog* shard map in hello catalog database.</span></span>
   <span data-ttu-id="fe334-183">Obiekcie wykazu jest złożony i zwrócił i używany w hello skryptu wyższego poziomu.</span><span class="sxs-lookup"><span data-stu-id="fe334-183">A catalog object is composed and returned, and used in hello higher-level script.</span></span>
1. <span data-ttu-id="fe334-184">**Oblicz hello nowego klucza dzierżawy**.</span><span class="sxs-lookup"><span data-stu-id="fe334-184">**Calculate hello new tenant key**.</span></span> <span data-ttu-id="fe334-185">Funkcja wyznaczania wartości skrótu jest klucz dzierżawy hello używane toocreate hello nazwa dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fe334-185">A hash function is used toocreate hello tenant key from hello tenant name.</span></span>
1. <span data-ttu-id="fe334-186">**Sprawdź, czy klucz dzierżawy hello już istnieje**.</span><span class="sxs-lookup"><span data-stu-id="fe334-186">**Check if hello tenant key already exists**.</span></span> <span data-ttu-id="fe334-187">wykaz Hello jest wyewidencjonowywany tooensure hello klucz jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="fe334-187">hello catalog is checked tooensure hello key is available.</span></span>
1. <span data-ttu-id="fe334-188">**Witaj dzierżawcy z bazy danych jest udostępniane z TenantDatabase nowy.**</span><span class="sxs-lookup"><span data-stu-id="fe334-188">**hello tenant database is provisioned with New-TenantDatabase.**</span></span> <span data-ttu-id="fe334-189">Użyj **F11** toostep w i zobacz, jak baza danych hello jest udostępnione za pomocą [szablonu usługi Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-189">Use **F11** toostep in and see how hello database is provisioned using an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md).</span></span>

<span data-ttu-id="fe334-190">Nazwa bazy danych Hello jest tworzony z hello dzierżawy nazwa toomake go wyczyścić niezależnych, które należy toowhich dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fe334-190">hello database name is constructed from hello tenant name toomake it clear which shard belongs toowhich tenant.</span></span> <span data-ttu-id="fe334-191">(Inne strategie nazewnictwa bazy danych może być wykorzystane.) + Szablon Menedżera zasobów jest używane toocreate dzierżawy bazy danych przez skopiowanie złotego bazy danych (baseTenantDB) na serwerze wykazu hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-191">(Other strategies for database naming could easily be used.)+ A Resource Manager template is used toocreate a tenant database by copying a golden database (baseTenantDB) on hello catalog server.</span></span> <span data-ttu-id="fe334-192">O innym podejściu może być toocreate pustej bazy danych, a następnie Zainicjuj go przez zaimportowanie pliku bacpac lub tooexecute skrypt inicjacji z dobrze znanej lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="fe334-192">An alternative approach could be toocreate an empty database and then initialize it by importing a bacpac, or tooexecute an initialization script from a well-known location.</span></span>  

<span data-ttu-id="fe334-193">Szablon usługi Resource Manager Hello znajduje się w folderze Modules\Common\ ...\Learning hello: *tenantdatabasecopytemplate.json*</span><span class="sxs-lookup"><span data-stu-id="fe334-193">hello Resource Manager template is in hello …\Learning Modules\Common\ folder: *tenantdatabasecopytemplate.json*</span></span>

<span data-ttu-id="fe334-194">Po utworzeniu bazy danych dzierżawy hello jest następnie dalsze **zainicjowany przy użyciu hello miejscową (dzierżawcy) nazwę i typ miejscową hello**.</span><span class="sxs-lookup"><span data-stu-id="fe334-194">After hello tenant database is created, it is then further **initialized with hello venue (tenant) name and hello venue type**.</span></span> <span data-ttu-id="fe334-195">Można również stosować inne metody inicjowania.</span><span class="sxs-lookup"><span data-stu-id="fe334-195">Other initialization could also be done here.</span></span>

<span data-ttu-id="fe334-196">Witaj **dzierżawy bazy danych jest zarejestrowany w wykazie hello** z *TenantDatabaseToCatalog Dodaj* przy użyciu klucza dzierżawy hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-196">hello **tenant database is registered in hello catalog** with *Add-TenantDatabaseToCatalog* using hello tenant key.</span></span> <span data-ttu-id="fe334-197">Użyj **F11** toostep hello uzyskać szczegółowe informacje:</span><span class="sxs-lookup"><span data-stu-id="fe334-197">Use **F11** toostep into hello details:</span></span>

* <span data-ttu-id="fe334-198">Baza danych katalogu Hello jest dodawana toohello mapy niezależnego fragmentu (hello listę znanych baz danych).</span><span class="sxs-lookup"><span data-stu-id="fe334-198">hello catalog database is added toohello shard map (hello list of known databases).</span></span>
* <span data-ttu-id="fe334-199">Mapowanie niezależnych toohello tego łącza hello wartość klucza Hello jest tworzony.</span><span class="sxs-lookup"><span data-stu-id="fe334-199">hello mapping that links hello key value toohello shard is created.</span></span>
* <span data-ttu-id="fe334-200">Dodatkowe dane meta (nazwa miejscową hello) dotyczące dzierżawy hello jest dodawany toohello dzierżaw tabeli w katalogu hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-200">Additional meta data (hello venue's name) about hello tenant is added toohello Tenants table in hello catalog.</span></span>  <span data-ttu-id="fe334-201">Witaj dzierżaw tabeli nie jest częścią hello ShardManagement schematu i nie jest instalowany przez hello EDCL.</span><span class="sxs-lookup"><span data-stu-id="fe334-201">hello Tenants table is not part of hello ShardManagement schema and is not installed by hello EDCL.</span></span>  <span data-ttu-id="fe334-202">W tej tabeli przedstawiono, jak baza danych katalogu hello można rozszerzyć toosupport dodatkowe dane specyficzne dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fe334-202">This table illustrates how hello Catalog database can be extended toosupport additional application-specific data.</span></span>   


<span data-ttu-id="fe334-203">Po zakończeniu inicjowania obsługi administracyjnej wykonywania zwraca toohello oryginalnego *ProvisionAndCatalog pokaz* skryptu, który otwiera hello **zdarzenia** strony dla nowej dzierżawy hello w przeglądarce hello:</span><span class="sxs-lookup"><span data-stu-id="fe334-203">After provisioning completes, execution returns toohello original *Demo-ProvisionAndCatalog* script, which opens hello **Events** page for hello new tenant in hello browser:</span></span>

   ![zdarzenia](media/sql-database-saas-tutorial-provision-and-catalog/new-tenant.png)


## <a name="provision-a-batch-of-tenants"></a><span data-ttu-id="fe334-205">Zainicjuj obsługę partii dzierżawcy</span><span class="sxs-lookup"><span data-stu-id="fe334-205">Provision a batch of tenants</span></span>

<span data-ttu-id="fe334-206">Tego ćwiczenia inicjuje partii 17 dzierżaw.</span><span class="sxs-lookup"><span data-stu-id="fe334-206">This exercise provisions a batch of 17 tenants.</span></span> <span data-ttu-id="fe334-207">Zaleca się, że udostępnieniem tej partii dzierżaw przed rozpoczęciem samouczków Wingtip SaaS, więc ma więcej niż kilka toowork baz danych z.</span><span class="sxs-lookup"><span data-stu-id="fe334-207">It’s recommended you provision this batch of tenants before starting other Wingtip SaaS tutorials, so there's more than just a few databases toowork with.</span></span>

1. <span data-ttu-id="fe334-208">Otwórz... \\Modułów uczenia\\ProvisionAndCatalog\\*ProvisionAndCatalog.ps1 pokaz* w hello *PowerShell ISE* i zmień hello *$ DemoScenario* too3 parametru:</span><span class="sxs-lookup"><span data-stu-id="fe334-208">Open ...\\Learning Modules\\ProvisionAndCatalog\\*Demo-ProvisionAndCatalog.ps1* in hello *PowerShell ISE* and change hello *$DemoScenario* parameter too3:</span></span>
   * <span data-ttu-id="fe334-209">**$DemoScenario** = **3**, zmień zbyt**3** za*udostępnić partii dzierżaw*.</span><span class="sxs-lookup"><span data-stu-id="fe334-209">**$DemoScenario** = **3**, change too**3** too*Provision a batch of tenants*.</span></span>
1. <span data-ttu-id="fe334-210">Naciśnij klawisz **F5** i uruchom skrypt hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-210">Press **F5** and run hello script.</span></span>

<span data-ttu-id="fe334-211">skrypt Hello wdraża partii dodatkowi dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="fe334-211">hello script deploys a batch of additional tenants.</span></span> <span data-ttu-id="fe334-212">Używa [szablonu usługi Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md) steruje hello partii i następnie deleguje inicjowania obsługi każdego szablonu połączonego tooa bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fe334-212">It uses an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md) that controls hello batch and then delegates provisioning of each database tooa linked template.</span></span> <span data-ttu-id="fe334-213">Za pomocą szablonów w ten sposób umożliwia inicjowanie obsługi procesów dla skryptu hello toobroker usługi Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="fe334-213">Using templates in this way allows Azure Resource Manager toobroker hello provisioning process for your script.</span></span> <span data-ttu-id="fe334-214">Szablony udostępniania bazy danych równolegle, gdzie można i obsługuje ponownych prób w razie potrzeby optymalizacji hello ogólny proces.</span><span class="sxs-lookup"><span data-stu-id="fe334-214">Templates provision databases in parallel where it can, and handles retries if needed, optimizing hello overall process.</span></span> <span data-ttu-id="fe334-215">Witaj skryptu jest idempotentności więc jeśli nie powiedzie się lub zatrzymuje się z jakiegokolwiek powodu, uruchom go ponownie.</span><span class="sxs-lookup"><span data-stu-id="fe334-215">hello script is idempotent so if it fails or stops for any reason, run it again.</span></span>

### <a name="verify-hello-batch-of-tenants-successfully-deployed"></a><span data-ttu-id="fe334-216">Sprawdź hello partii dzierżaw pomyślnie wdrożona</span><span class="sxs-lookup"><span data-stu-id="fe334-216">Verify hello batch of tenants successfully deployed</span></span>

* <span data-ttu-id="fe334-217">Otwórz hello *tenants1* serwer, przechodząc tooyour listę serwerów w hello [portalu Azure](https://portal.azure.com), kliknij przycisk **baz danych**i sprawdź partii hello 17 dodatkowych baz danych są teraz na liście hello:</span><span class="sxs-lookup"><span data-stu-id="fe334-217">Open hello *tenants1* server by browsing tooyour list of servers in hello [Azure portal](https://portal.azure.com), click **SQL databases**, and verify hello batch of 17 additional databases are now in hello list:</span></span>

   ![lista baz danych](media/sql-database-saas-tutorial-provision-and-catalog/database-list.png)



## <a name="other-provisioning-patterns"></a><span data-ttu-id="fe334-219">Inne wzorce aprowizacji</span><span class="sxs-lookup"><span data-stu-id="fe334-219">Other provisioning patterns</span></span>

<span data-ttu-id="fe334-220">Inne wzorce aprowizacji, których nie uwzględniono w tym samouczku, obejmują:</span><span class="sxs-lookup"><span data-stu-id="fe334-220">Other provisioning patterns not included in this tutorial include:</span></span>

<span data-ttu-id="fe334-221">**Wstępne aprowizowanie baz danych.**</span><span class="sxs-lookup"><span data-stu-id="fe334-221">**Pre-provisioning databases.**</span></span> <span data-ttu-id="fe334-222">Hello wstępnego inicjowania obsługi administracyjnej wzorzec wykorzystuje hello fakt, że bazy danych w puli elastycznej nie należy dodawać z żadnymi dodatkowymi kosztami.</span><span class="sxs-lookup"><span data-stu-id="fe334-222">hello pre-provisioning pattern exploits hello fact that databases in an elastic pool do not add extra cost.</span></span> <span data-ttu-id="fe334-223">Rozliczenia jest przeznaczony dla puli elastycznej hello nie hello baz danych i baz danych w stanie bezczynności korzystać z żadnych zasobów.</span><span class="sxs-lookup"><span data-stu-id="fe334-223">Billing is for hello elastic pool, not hello databases, and idle databases consume no resources.</span></span> <span data-ttu-id="fe334-224">Wstępne inicjowanie obsługi baz danych w puli i przydzielanie je w razie potrzeby, można znacznie zmniejszyć czasu dołączenia do dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fe334-224">By pre-provisioning databases in a pool and allocating them when needed, tenant onboarding time can be reduced significantly.</span></span> <span data-ttu-id="fe334-225">Hello liczba baz danych wstępnie tworzyć można dostosować do własnych tookeep wymagane odpowiednie dla hello buforu zakładano inicjowania obsługi administracyjnej szybkości.</span><span class="sxs-lookup"><span data-stu-id="fe334-225">hello number of databases pre-provisioned could be adjusted as needed tookeep a buffer suitable for hello anticipated provisioning rate.</span></span>

<span data-ttu-id="fe334-226">**Automatyczne aprowizowanie.**</span><span class="sxs-lookup"><span data-stu-id="fe334-226">**Auto-provisioning.**</span></span> <span data-ttu-id="fe334-227">We wzorcu automatycznego inicjowania obsługi administracyjnej hello dedykowanych usługa inicjowania obsługi administracyjnej jest tooprovision używanych serwerów, pul i baz danych automatycznie w razie potrzeby — tym wstępnego inicjowania obsługi administracyjnej baz danych w pule elastyczne, w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="fe334-227">In hello auto-provisioning pattern, a dedicated provisioning service is used tooprovision servers, pools, and databases automatically as needed – including pre-provisioning databases in elastic pools if desired.</span></span> <span data-ttu-id="fe334-228">A jeśli bazy danych są zlecone wyłączyć i usunąć, luk w pule elastyczne może zostać wypełniony przez hello świadczenie usługi zgodnie z potrzebami.</span><span class="sxs-lookup"><span data-stu-id="fe334-228">And if databases are de-commissioned and deleted, gaps in elastic pools can be filled by hello provisioning service as desired.</span></span> <span data-ttu-id="fe334-229">Takie usługi może być prostymi lub złożonymi — na przykład obsługa inicjowania obsługi administracyjnej na wielu różnych obszarach geograficznych i można skonfigurować replikację geograficzną automatycznie Jeśli tej strategii jest używana dla odzyskiwania po awarii.</span><span class="sxs-lookup"><span data-stu-id="fe334-229">Such a service could be simple or complex – for example, handling provisioning across multiple geographies, and could set up geo-replication automatically if that strategy is being used for disaster recovery.</span></span> <span data-ttu-id="fe334-230">Z wzorcem automatycznego inicjowania obsługi administracyjnej hello aplikacji klienckiej lub skryptu czy przesłać inicjowania obsługi administracyjnej toobe kolejki tooa żądania, na przetworzonych przez program hello inicjowania obsługi usługi, a następnie będzie sondować hello usługi toodetermine ukończenia.</span><span class="sxs-lookup"><span data-stu-id="fe334-230">With hello auto-provisioning pattern, a client application or script would submit a provisioning request tooa queue toobe processed by hello provisioning service, and would then poll hello service toodetermine completion.</span></span> <span data-ttu-id="fe334-231">Jeśli używana jest wstępnie inicjowania obsługi, żądania może szybko obsługiwane z usługą hello Zarządzanie inicjowania obsługi administracyjnej zastąpienia bazy danych działa w tle hello.</span><span class="sxs-lookup"><span data-stu-id="fe334-231">If pre-provisioning is used, requests would be handled quickly with hello service managing provisioning of a replacement database running in hello background.</span></span>



## <a name="next-steps"></a><span data-ttu-id="fe334-232">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="fe334-232">Next steps</span></span>

<span data-ttu-id="fe334-233">W tym samouczku zawarto informacje na temat wykonywania następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="fe334-233">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="fe334-234">Aprowizowanie pojedynczej nowej dzierżawy</span><span class="sxs-lookup"><span data-stu-id="fe334-234">Provision a single new tenant</span></span>
> * <span data-ttu-id="fe334-235">Aprowizowanie partii dodatkowych dzierżaw</span><span class="sxs-lookup"><span data-stu-id="fe334-235">Provision a batch of additional tenants</span></span>
> * <span data-ttu-id="fe334-236">Krok do szczegółów hello udostępnianie dzierżaw i rejestrowania ich do katalogu hello</span><span class="sxs-lookup"><span data-stu-id="fe334-236">Step into hello details of provisioning tenants, and registering them into hello catalog</span></span>

<span data-ttu-id="fe334-237">Spróbuj hello [samouczek monitorowania wydajności](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="fe334-237">Try hello [Performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="fe334-238">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="fe334-238">Additional Resources</span></span>

* <span data-ttu-id="fe334-239">Dodatkowe [samouczki, które zależą od hello aplikacji Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="fe334-239">Additional [tutorials that build upon hello Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="fe334-240">Biblioteka kliencka Elastic Database</span><span class="sxs-lookup"><span data-stu-id="fe334-240">Elastic database client library</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-database-client-library)
* [<span data-ttu-id="fe334-241">Jak tooDebug skrypty w środowisku Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="fe334-241">How tooDebug Scripts in Windows PowerShell ISE</span></span>](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise)
