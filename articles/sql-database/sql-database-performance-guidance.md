---
title: "Dostosowywanie wskazówki dotyczące wydajności bazy danych SQL Azure | Dokumentacja firmy Microsoft"
description: "W tym artykule może pomóc w określeniu warstwy usług, które można wybrać dla aplikacji. Sugeruje również sposób dostrajania aplikacji najefektywniejsze korzystanie z bazy danych SQL Azure."
services: sql-database
documentationcenter: na
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: dd8d95fa-24b2-4233-b3f1-8e8952a7a22b
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 02/09/2017
ms.author: carlrab
ms.openlocfilehash: dc0244f0e0949b172c391825057f5c14893a5158
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="tuning-performance-in-azure-sql-database"></a><span data-ttu-id="1cd2e-104">Dostrajanie wydajności w bazie danych SQL Azure</span><span class="sxs-lookup"><span data-stu-id="1cd2e-104">Tuning performance in Azure SQL Database</span></span>

<span data-ttu-id="1cd2e-105">Baza danych SQL Azure udostępnia [zalecenia](sql-database-advisor.md) czy można użyć do zwiększenia wydajności bazy danych, lub możesz pozwolić, aby baza danych SQL Azure [automatycznie dostosowania do aplikacji](sql-database-automatic-tuning.md) i zastosować zmiany, które poprawią wydajność obciążenia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-105">Azure SQL Database provides [recommendations](sql-database-advisor.md) that you can use to improve performance of your database, or you can let Azure SQL Database [automatically adapt to your application](sql-database-automatic-tuning.md) and apply changes that will improve performance of your workload.</span></span>

<span data-ttu-id="1cd2e-106">W przypadku nie ma żadnych odpowiednich zaleceń i nadal masz problemy z wydajnością, usprawniających wydajność może skorzystać z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-106">In you don't have any applicable recommendations, and you still have performance issues, you might use the following methods to improve performances:</span></span>
1. <span data-ttu-id="1cd2e-107">Zwiększ [warstw usług](sql-database-service-tiers.md) i podaj więcej zasobów w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-107">Increase [service tiers](sql-database-service-tiers.md) and provide more resources to your database.</span></span>
2. <span data-ttu-id="1cd2e-108">Dostrajanie aplikacji i stosować najlepsze rozwiązania, które może poprawić wydajność.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-108">Tune your application and apply some best practices that can improve performance.</span></span> 
3. <span data-ttu-id="1cd2e-109">Dostrajanie bazy danych, zmieniając indeksów i zapytań na bardziej efektywną pracę z danymi.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-109">Tune the database by changing indexes and queries to more efficiently work with data.</span></span>

<span data-ttu-id="1cd2e-110">Są to ręcznej metody, ponieważ potrzebne do podejmowania decyzji [warstw usług](sql-database-service-tiers.md) należy wybrać lub trzeba ponownie pisać kodu aplikacji lub bazy danych i deply zmiany.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-110">These are manual methods because you need to decide what [service tiers](sql-database-service-tiers.md) you would choose or you would need to rewrite application or database code and deply the changes.</span></span>

## <a name="increasing-performance-tier-of-your-database"></a><span data-ttu-id="1cd2e-111">Zwiększenie poziomu wydajności bazy danych</span><span class="sxs-lookup"><span data-stu-id="1cd2e-111">Increasing performance tier of your database</span></span>

<span data-ttu-id="1cd2e-112">Baza danych SQL Azure oferuje cztery [warstw usług](sql-database-service-tiers.md) wybraną z: Basic, Standard, Premium i Premium RS (mierzona jest wydajność w jednostek przepływności bazy danych, lub [Dtu](sql-database-what-is-a-dtu.md).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-112">Azure SQL Database offers four [service tiers](sql-database-service-tiers.md) that you can choose from: Basic, Standard, Premium, and Premium RS (performance is measured in database throughput units, or [DTUs](sql-database-what-is-a-dtu.md).</span></span> <span data-ttu-id="1cd2e-113">Każdej warstwy usług izoluje ściśle zasobów można używać bazy danych SQL i zapewnia przewidywalną wydajność tego poziomu usług.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-113">Each service tier strictly isolates the resources that your SQL database can use, and guarantees predictable performance for that service level.</span></span> <span data-ttu-id="1cd2e-114">W tym artykule firma Microsoft oferuje wskazówki, które ułatwiają wybieranie warstwy usługi dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-114">In this article, we offer guidance that can help you choose the service tier for your application.</span></span> <span data-ttu-id="1cd2e-115">Omówiono także sposoby dostroić aplikacji maksymalne z bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-115">We also discuss ways that you can tune your application to get the most from Azure SQL Database.</span></span>

> [!NOTE]
> <span data-ttu-id="1cd2e-116">Ten artykuł skupia się na wytyczne dotyczące wydajności dla pojedynczej bazy danych w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-116">This article focuses on performance guidance for single databases in Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-117">Aby uzyskać wskazówki dotyczące wydajności związane z pule elastyczne, zobacz [zagadnienia dotyczące cen i wydajności dla pul elastycznych](sql-database-elastic-pool-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-117">For performance guidance related to elastic pools, see [Price and performance considerations for elastic pools](sql-database-elastic-pool-guidance.md).</span></span> <span data-ttu-id="1cd2e-118">Należy pamiętać, jednak wiele dostrajania zaleceń w tym artykule dotyczą baz danych w puli elastycznej i uzyskiwanie podobnego zwiększenia wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-118">Note, though, that you can apply many of the tuning recommendations in this article to databases in an elastic pool, and get similar performance benefits.</span></span>
> 

* <span data-ttu-id="1cd2e-119">**Podstawowe**: podstawowe usługi warstwy oferty dobrą wydajność przewidywalności dla każdej bazy danych, godzinę w ciągu godziny.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-119">**Basic**: The Basic service tier offers good performance predictability for each database, hour over hour.</span></span> <span data-ttu-id="1cd2e-120">W bazie danych podstawowych wystarczające zasoby obsługuje dobrą wydajność w małych baz danych, która nie ma wiele równoczesnych żądań.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-120">In a Basic database, sufficient resources support good performance in a small database that doesn't have multiple concurrent requests.</span></span> <span data-ttu-id="1cd2e-121">Typowe zastosowania, jeśli używasz warstwy podstawowej usługi są:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-121">Typical use cases when you would use Basic service tier are:</span></span>
  * <span data-ttu-id="1cd2e-122">**Po prostu rozpoczniesz pracę z bazą danych SQL Azure**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-122">**You're just getting started with Azure SQL Database**.</span></span> <span data-ttu-id="1cd2e-123">Aplikacje, które są często rozwijany nie ma potrzeby poziomy wysokiej wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-123">Applications that are in development often don't need high-performance levels.</span></span> <span data-ttu-id="1cd2e-124">Podstawowe bazy danych są idealne środowiska do tworzenia bazy danych i testowania, w momencie cen niski.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-124">Basic databases are an ideal environment for database development or testing, at a low price point.</span></span>
  * <span data-ttu-id="1cd2e-125">**Masz bazę danych z jednego użytkownika**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-125">**You have a database with a single user**.</span></span> <span data-ttu-id="1cd2e-126">Aplikacje, które zwykle kojarzenie jednego użytkownika z bazy danych nie mają wysokie wymagania współbieżności i wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-126">Applications that associate a single user with a database typically don’t have high concurrency and performance requirements.</span></span> <span data-ttu-id="1cd2e-127">Te aplikacje nadają się do warstwy usług podstawowa.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-127">These applications are candidates for the Basic service tier.</span></span>
* <span data-ttu-id="1cd2e-128">**Standardowe**: standardowy warstwy usług oferuje lepszą wydajność przewidywalności i zapewnia dobrą wydajność dla baz danych, które mają wiele współbieżnych żądań, takich jak aplikacje sieci web i grupy roboczej.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-128">**Standard**: The Standard service tier offers improved performance predictability and provides good performance for databases that have multiple concurrent requests, like workgroup and web applications.</span></span> <span data-ttu-id="1cd2e-129">Po wybraniu warstwy standardowa usługa bazy danych można rozmiar bazy danych aplikacji w oparciu przewidywalną wydajność, minute w ciągu minuty.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-129">When you choose a Standard service tier database, you can size your database application based on predictable performance, minute over minute.</span></span>
  * <span data-ttu-id="1cd2e-130">**Baza danych zawiera wiele równoczesnych żądań**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-130">**Your database has multiple concurrent requests**.</span></span> <span data-ttu-id="1cd2e-131">Aplikacje, które usługi więcej niż jeden użytkownik naraz zwykle muszą wyższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-131">Applications that service more than one user at a time usually need higher performance levels.</span></span> <span data-ttu-id="1cd2e-132">Na przykład aplikacje grupy roboczej lub sieci web, które muszą niski średnia we/wy ruchu wymagania dotyczące obsługi wielu równoczesnych zapytań nadaje się do warstwy standardowych usług.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-132">For example, workgroup or web applications that have low to medium IO traffic requirements supporting multiple concurrent queries are good candidates for the Standard service tier.</span></span>
* <span data-ttu-id="1cd2e-133">**Premium**: warstwę Premium oferuje przewidywalną wydajność, drugi na drugi, dla każdej bazy danych — warstwa Premium.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-133">**Premium**: The Premium service tier provides predictable performance, second over second, for each Premium database.</span></span> <span data-ttu-id="1cd2e-134">Po wybraniu warstwy usług Premium można rozmiar bazy danych aplikacji w oparciu obciążenia szczytowego dla tej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-134">When you choose the Premium service tier, you can size your database application based on the peak load for that database.</span></span> <span data-ttu-id="1cd2e-135">Plan usuwa przypadków w wydajności, które wariancję może spowodować małych zapytań do trwać dłużej, niż oczekiwano w operacjach wrażliwy na opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-135">The plan removes cases in which performance variance can cause small queries to take longer than expected in latency-sensitive operations.</span></span> <span data-ttu-id="1cd2e-136">Ten model może bardzo uprościć cykli weryfikacji rozwoju i produktu dla aplikacji, które należy podjąć, silne oświadczenia dotyczące szczytowego zapotrzebowania na zasoby, odchylenie wydajności lub opóźnienia zapytania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-136">This model can greatly simplify the development and product validation cycles for applications that need to make strong statements about peak resource needs, performance variance, or query latency.</span></span> <span data-ttu-id="1cd2e-137">Większość przypadków użycia warstwy Premium usługi ma co najmniej jeden z tych właściwości:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-137">Most Premium service tier use cases have one or more of these characteristics:</span></span>
  * <span data-ttu-id="1cd2e-138">**Obciążenia szczytowego wysokiej**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-138">**High peak load**.</span></span> <span data-ttu-id="1cd2e-139">Aplikacja, która wymaga znacznej procesora CPU, pamięć lub wejścia/wyjścia (We/Wy) do ukończenia operacji wymaga poziomu dedykowanego, wysokiej wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-139">An application that requires substantial CPU, memory, or input/output (I/O) to complete its operations requires a dedicated, high-performance level.</span></span> <span data-ttu-id="1cd2e-140">Na przykład znane użycie kilku rdzeni Procesora przez dłuższy czas operacji bazy danych jest kandydatem do warstwy Premium usługi.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-140">For example, a database operation known to consume several CPU cores for an extended time is a candidate for the Premium service tier.</span></span>
  * <span data-ttu-id="1cd2e-141">**Wiele równoczesnych żądań**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-141">**Many concurrent requests**.</span></span> <span data-ttu-id="1cd2e-142">Niektóre aplikacje bazy danych usługi dużo współbieżnych żądań, na przykład gdy obsługująca witryny sieci Web, która ma duże natężenie ruchu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-142">Some database applications service many concurrent requests, for example, when serving a website that has a high traffic volume.</span></span> <span data-ttu-id="1cd2e-143">Podstawowa i standardowa warstwy usług Ogranicz liczbę równoczesnych żądań dla jednej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-143">Basic and Standard service tiers limit the number of concurrent requests per database.</span></span> <span data-ttu-id="1cd2e-144">Aplikacje, które wymagają więcej połączeń należy wybrać rozmiar rezerwacji odpowiednie do obsługi maksymalną liczbę żądań potrzebne.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-144">Applications that require more connections would need to choose an appropriate reservation size to handle the maximum number of needed requests.</span></span>
  * <span data-ttu-id="1cd2e-145">**Małe opóźnienia**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-145">**Low latency**.</span></span> <span data-ttu-id="1cd2e-146">Niektóre aplikacje wymagają do zagwarantowania minimalnego czasu odpowiedzi z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-146">Some applications need to guarantee a response from the database in minimal time.</span></span> <span data-ttu-id="1cd2e-147">Jeśli określone procedury składowanej jest wywoływana w ramach szerszych operacji klienta, może być wymagane są zwracane z tego wywołania w milisekundach nie więcej niż 20 99 procent czasu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-147">If a specific stored procedure is called as part of a broader customer operation, you might have a requirement to have a return from that call in no more than 20 milliseconds, 99 percent of the time.</span></span> <span data-ttu-id="1cd2e-148">Aplikacje tego typu korzysta z warstwę Premium, aby upewnić się, że wymagane mocy obliczeniowej jest dostępny.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-148">This type of application benefits from the Premium service tier, to make sure that the required computing power is available.</span></span>
* <span data-ttu-id="1cd2e-149">**Premium RS**: warstwy Premium RS jest przeznaczona dla obciążeń intensywnie wykonujących operacje We/Wy, które nie wymagają zapewnia najwyższą dostępność.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-149">**Premium RS**: The Premium RS tier is designed for IO-intensive workloads that do not require the highest availability guarantees.</span></span> <span data-ttu-id="1cd2e-150">Przykłady obejmują testowanie obciążeń wysokiej wydajności lub obciążenia analitycznych, gdzie bazy danych nie jest systemem rekordu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-150">Examples include testing high-performance workloads, or an analytical workload where the database is not the system of record.</span></span>

<span data-ttu-id="1cd2e-151">Poziom usług, który należy do bazy danych SQL zależy od wymagań obciążenia szczytowego dla każdego wymiaru zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-151">The service level that you need for your SQL database depends on the peak load requirements for each resource dimension.</span></span> <span data-ttu-id="1cd2e-152">Niektóre aplikacje używane trivial ilość pojedynczego zasobu, ale mieć znaczący wymagania dotyczące innych zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-152">Some applications use a trivial amount of a single resource, but have significant requirements for other resources.</span></span>

### <a name="service-tier-capabilities-and-limits"></a><span data-ttu-id="1cd2e-153">Możliwości warstwy usług i limity</span><span class="sxs-lookup"><span data-stu-id="1cd2e-153">Service tier capabilities and limits</span></span>

<span data-ttu-id="1cd2e-154">W poszczególnych warstwach usług ustawić poziom wydajności, więc możesz swobodnie płacisz tylko za pojemność, które są potrzebne.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-154">At each service tier, you set the performance level, so you have the flexibility to pay only for the capacity you need.</span></span> <span data-ttu-id="1cd2e-155">Możesz [Dostosuj wydajność](sql-database-service-tiers.md), w górę lub w dół, jak zmiany obciążenia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-155">You can [adjust capacity](sql-database-service-tiers.md), up or down, as workload changes.</span></span> <span data-ttu-id="1cd2e-156">Na przykład jeśli obciążenie bazy danych jest wysoka w sezonie zakupów wstecz do służbowych, może zwiększyć poziom wydajności bazy danych na określony czas, lipca za pośrednictwem września.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-156">For example, if your database workload is high during the back-to-school shopping season, you might increase the performance level for the database for a set time, July through September.</span></span> <span data-ttu-id="1cd2e-157">Można zmniejszyć ją po zakończeniu Twojej sezonu godzinami szczytu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-157">You can reduce it when your peak season ends.</span></span> <span data-ttu-id="1cd2e-158">Można zminimalizować płacisz za Optymalizowanie środowiska chmury do sezonowości firmy.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-158">You can minimize what you pay by optimizing your cloud environment to the seasonality of your business.</span></span> <span data-ttu-id="1cd2e-159">Ten model jest również odpowiedni dla oprogramowania produktu cykle.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-159">This model also works well for software product release cycles.</span></span> <span data-ttu-id="1cd2e-160">Zespół może przydzielić pojemności, podczas jej uruchomień testów, a następnie zwolnij wydajność po zakończeniu testowania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-160">A test team might allocate capacity while it does test runs, and then release that capacity when they finish testing.</span></span> <span data-ttu-id="1cd2e-161">W modelu żądania pojemności płacisz za pojemność potrzebny i uniknąć wydatków na dedykowany zasobów, które może być rzadko używane.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-161">In a capacity request model, you pay for capacity as you need it, and avoid spending on dedicated resources that you might rarely use.</span></span>

### <a name="why-service-tiers"></a><span data-ttu-id="1cd2e-162">Dlaczego warstw do usług?</span><span class="sxs-lookup"><span data-stu-id="1cd2e-162">Why service tiers?</span></span>
<span data-ttu-id="1cd2e-163">Mimo że poszczególnych obciążeń bazy danych może się różnić, celem warstwy usług jest zapewnienie przewidywalność wydajności na różnych poziomach wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-163">Although each database workload can differ, the purpose of service tiers is to provide performance predictability at various performance levels.</span></span> <span data-ttu-id="1cd2e-164">Klientów z bazy danych na dużą skalę wymagań dotyczących zasobów można pracować w bardziej dedykowanego środowiska komputerowego.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-164">Customers with large-scale database resource requirements can work in a more dedicated computing environment.</span></span>

## <a name="tune-your-application"></a><span data-ttu-id="1cd2e-165">Dostrajanie aplikacji</span><span class="sxs-lookup"><span data-stu-id="1cd2e-165">Tune your application</span></span>
<span data-ttu-id="1cd2e-166">W tradycyjnych, lokalnie programu SQL Server proces planowania pojemności początkowej jest często oddzielone od proces uruchomienia aplikacji w środowisku produkcyjnym.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-166">In traditional on-premises SQL Server, the process of initial capacity planning often is separated from the process of running an application in production.</span></span> <span data-ttu-id="1cd2e-167">Najpierw zakupionych licencji sprzętu i produktu i dostrajania wydajności odbywają się później.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-167">Hardware and product licenses are purchased first, and performance tuning is done afterward.</span></span> <span data-ttu-id="1cd2e-168">Gdy używasz bazy danych SQL Azure jest dobrym pomysłem jest interweave proces uruchamiania aplikacji i dostrajania go.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-168">When you use Azure SQL Database, it's a good idea to interweave the process of running an application and tuning it.</span></span> <span data-ttu-id="1cd2e-169">W modelu płatniczych pojemności na żądanie można dostosować w aplikacji umożliwiająca użycie minimalne zasoby potrzebne teraz, zamiast nadmiarowe Inicjowanie obsługi administracyjnej na sprzęcie oparte na prób planów przyszłego rozwoju aplikacji, które często są nieprawidłowe.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-169">With the model of paying for capacity on demand, you can tune your application to use the minimum resources needed now, instead of overprovisioning on hardware based on guesses of future growth plans for an application, which often are incorrect.</span></span> <span data-ttu-id="1cd2e-170">Niektórzy klienci mogą wybierz nie dostroić aplikacji, a zamiast tego wybrać overprovision zasobów sprzętowych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-170">Some customers might choose not to tune an application, and instead choose to overprovision hardware resources.</span></span> <span data-ttu-id="1cd2e-171">Takie podejście może być dobrym rozwiązaniem, jeśli nie chcesz zmienić klucza aplikacji okresie zajęty.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-171">This approach might be a good idea if you don't want to change a key application during a busy period.</span></span> <span data-ttu-id="1cd2e-172">Jednak Dostrajanie aplikacji można zminimalizować wymagania dotyczące zasobów i niższe opłaty miesięczne użycie warstw usług w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-172">But, tuning an application can minimize resource requirements and lower monthly bills when you use the service tiers in Azure SQL Database.</span></span>

### <a name="application-characteristics"></a><span data-ttu-id="1cd2e-173">Właściwości aplikacji</span><span class="sxs-lookup"><span data-stu-id="1cd2e-173">Application characteristics</span></span>
<span data-ttu-id="1cd2e-174">Mimo że warstwach usług bazy danych SQL Azure mają na celu poprawę wydajności stabilność i przewidywalności dla aplikacji, najlepsze rozwiązania mogą pomóc dostosować aplikację, aby lepiej wykorzystać zasoby na poziomie wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-174">Although Azure SQL Database service tiers are designed to improve performance stability and predictability for an application, some best practices can help you tune your application to better take advantage of the resources at a performance level.</span></span> <span data-ttu-id="1cd2e-175">Mimo że wiele aplikacji ma znaczący wzrost wydajności, po prostu przełączając na wyższy poziom wydajności lub warstwy usługi, niektóre aplikacje potrzebują dodatkowe dostrojenia, aby korzystać z wyższego poziomu usługi.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-175">Although many applications have significant performance gains simply by switching to a higher performance level or service tier, some applications need additional tuning to benefit from a higher level of service.</span></span> <span data-ttu-id="1cd2e-176">Aby zwiększyć wydajność należy wziąć pod uwagę dostrajania dodatkowych aplikacji dla aplikacji, które mają następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-176">For increased performance, consider additional application tuning for applications that have these characteristics:</span></span>

* <span data-ttu-id="1cd2e-177">**Aplikacje, które mają niską wydajność ze względu na zachowanie "chatty"**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-177">**Applications that have slow performance because of "chatty" behavior**.</span></span> <span data-ttu-id="1cd2e-178">Chatty aplikacji należy operacji dostępu nadmiernej ilości danych, które są wrażliwy na opóźnienia sieci.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-178">Chatty applications make excessive data access operations that are sensitive to network latency.</span></span> <span data-ttu-id="1cd2e-179">Może być konieczne zmodyfikowanie tego rodzaju aplikacji, aby zmniejszyć liczbę operacji uzyskiwania dostępu do danych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-179">You might need to modify these kinds of applications to reduce the number of data access operations to the SQL database.</span></span> <span data-ttu-id="1cd2e-180">Na przykład może zwiększyć wydajność aplikacji przy użyciu technik, takich jak przetwarzanie wsadowe zapytań ad hoc lub przenoszenie zapytania na procedury składowane.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-180">For example, you might improve application performance by using techniques like batching ad-hoc queries or moving the queries to stored procedures.</span></span> <span data-ttu-id="1cd2e-181">Aby uzyskać więcej informacji, zobacz [partii zapytań](#batch-queries).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-181">For more information, see [Batch queries](#batch-queries).</span></span>
* <span data-ttu-id="1cd2e-182">**Bazy danych o znacznym obciążeniem, które nie może być obsługiwana przez cały jednej maszyny**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-182">**Databases with an intensive workload that can't be supported by an entire single machine**.</span></span> <span data-ttu-id="1cd2e-183">Bazy danych, które przekraczają zasobów najwyższego poziomu wydajności Premium mogą korzystać z skalowania obciążenia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-183">Databases that exceed the resources of the highest Premium performance level might benefit from scaling out the workload.</span></span> <span data-ttu-id="1cd2e-184">Aby uzyskać więcej informacji, zobacz [dzielenia na fragmenty między bazami danych](#cross-database-sharding) i [funkcjonalności partycjonowania](#functional-partitioning).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-184">For more information, see [Cross-database sharding](#cross-database-sharding) and [Functional partitioning](#functional-partitioning).</span></span>
* <span data-ttu-id="1cd2e-185">**Aplikacje, które mają zapytania nieoptymalne**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-185">**Applications that have suboptimal queries**.</span></span> <span data-ttu-id="1cd2e-186">Aplikacje, zwłaszcza w warstwie dostępu do danych, które zostały nieprawidłowo dopasowane zapytania rozwiązanie nie mogą korzystać z wyższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-186">Applications, especially those in the data access layer, that have poorly tuned queries might not benefit from a higher performance level.</span></span> <span data-ttu-id="1cd2e-187">W tym zapytań, które nie mają w klauzuli WHERE, brakuje indeksów lub mieć przestarzałe statystyki.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-187">This includes queries that lack a WHERE clause, have missing indexes, or have outdated statistics.</span></span> <span data-ttu-id="1cd2e-188">Te aplikacje korzystają z techniki dostrajania wydajności standardowej kwerendy.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-188">These applications benefit from standard query performance-tuning techniques.</span></span> <span data-ttu-id="1cd2e-189">Aby uzyskać więcej informacji, zobacz [brakujące indeksy](#identifying-and-adding-missing-indexes) i [zapytania dostrajanie i zalecanych](#query-tuning-and-hinting).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-189">For more information, see [Missing indexes](#identifying-and-adding-missing-indexes) and [Query tuning and hinting](#query-tuning-and-hinting).</span></span>
* <span data-ttu-id="1cd2e-190">**Projekt dostęp do aplikacji, które znajdują się dane nieoptymalne**.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-190">**Applications that have suboptimal data access design**.</span></span> <span data-ttu-id="1cd2e-191">Aplikacje, które mają związanego z używaniem danych współbieżności problemy z dostępem, na przykład zakleszczenia, nie mogą korzystać z wyższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-191">Applications that have inherent data access concurrency issues, for example deadlocking, might not benefit from a higher performance level.</span></span> <span data-ttu-id="1cd2e-192">Rozważ zmniejszenie rund w bazie danych SQL Azure przez buforowania danych po stronie klienta z usługą Azure buforowanie lub innej technologii buforowania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-192">Consider reducing round trips against the Azure SQL Database by caching data on the client side with the Azure Caching service or another caching technology.</span></span> <span data-ttu-id="1cd2e-193">Zobacz [buforowanie warstwy aplikacji](#application-tier-caching).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-193">See [Application tier caching](#application-tier-caching).</span></span>

## <a name="tune-your-database"></a><span data-ttu-id="1cd2e-194">Dostrajanie bazy danych</span><span class="sxs-lookup"><span data-stu-id="1cd2e-194">Tune your database</span></span>
<span data-ttu-id="1cd2e-195">W tej sekcji opisano niektóre techniki, które można użyć do dostrajania bazy danych SQL Azure, aby uzyskać najlepszą wydajność aplikacji i uruchom go na najniższym poziomie wydajność.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-195">In this section, we look at some techniques that you can use to tune Azure SQL Database to gain the best performance for your application and run it at the lowest possible performance level.</span></span> <span data-ttu-id="1cd2e-196">Niektóre z tych metod zgodne tradycyjnych dostrajania serwera SQL Server najlepsze rozwiązania, ale inne są specyficzne dla bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-196">Some of these techniques match traditional SQL Server tuning best practices, but others are specific to Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-197">W niektórych przypadkach należy zbadać wykorzystanych zasobów dla bazy danych można znaleźć obszarów dalsze dostrojenie i rozszerzenia tradycyjnych metod programu SQL Server do pracy w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-197">In some cases, you can examine the consumed resources for a database to find areas to further tune and extend traditional SQL Server techniques to work in Azure SQL Database.</span></span>

### <a name="identify-performance-issues-using-azure-portal"></a><span data-ttu-id="1cd2e-198">Identyfikowanie problemów z wydajnością przy użyciu portalu Azure</span><span class="sxs-lookup"><span data-stu-id="1cd2e-198">Identify performance issues using Azure portal</span></span>
<span data-ttu-id="1cd2e-199">Następujące narzędzia w portalu Azure można ułatwić analizowanie i rozwiązywanie problemów z wydajnością z bazy danych SQL:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-199">The following tools in the Azure portal can help you analyze and fix performance issues with your SQL database:</span></span>

* [<span data-ttu-id="1cd2e-200">Szczegółowe informacje o wydajności zapytań</span><span class="sxs-lookup"><span data-stu-id="1cd2e-200">Query Performance Insight</span></span>](sql-database-query-performance.md)
* [<span data-ttu-id="1cd2e-201">SQL Database Advisor</span><span class="sxs-lookup"><span data-stu-id="1cd2e-201">SQL Database Advisor</span></span>](sql-database-advisor.md)

<span data-ttu-id="1cd2e-202">Azure portal ma więcej informacji na temat obu tych narzędzi i sposobu ich używania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-202">The Azure portal has more information about both of these tools and how to use them.</span></span> <span data-ttu-id="1cd2e-203">Aby wydajnie zdiagnozować i rozwiązać problemy, firma Microsoft zaleca, najpierw spróbuj użyć narzędzi dostępnych w portalu Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-203">To efficiently diagnose and correct problems, we recommend that you first try the tools in the Azure portal.</span></span> <span data-ttu-id="1cd2e-204">Firma Microsoft zaleca użycie ręcznego dostrajanie metod, które następnie omówimy brakujących indeksy i dostrajania zapytania, w szczególnych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-204">We recommend that you use the manual tuning approaches that we discuss next, for missing indexes and query tuning, in special cases.</span></span>

<span data-ttu-id="1cd2e-205">Więcej informacji o identyfikowanie problemów w usłudze Azure SQL Database na [monitorowania wydajności](sql-database-single-database-monitor.md) artykułu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-205">Find more information about identifying issues in Azure SQL Database on [performance monitoring](sql-database-single-database-monitor.md) article.</span></span>

### <a name="identifying-and-adding-missing-indexes"></a><span data-ttu-id="1cd2e-206">Identyfikowanie i dodać brakujące indeksy</span><span class="sxs-lookup"><span data-stu-id="1cd2e-206">Identifying and adding missing indexes</span></span>
<span data-ttu-id="1cd2e-207">To powszechny problem, wydajność bazy danych OLTP odnosi się do projektowania fizycznej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-207">A common problem in OLTP database performance relates to the physical database design.</span></span> <span data-ttu-id="1cd2e-208">Często schematów bazy danych są zaprojektowane i wysłane bez testowania na dużą skalę (albo w obciążenia w woluminie danych).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-208">Often, database schemas are designed and shipped without testing at scale (either in load or in data volume).</span></span> <span data-ttu-id="1cd2e-209">Niestety wydajność planu zapytania może być akceptowane na małą skalę, ale znacznie zmniejsza się w obszarze woluminów danych na poziomie produkcji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-209">Unfortunately, the performance of a query plan might be acceptable on a small scale but degrade substantially under production-level data volumes.</span></span> <span data-ttu-id="1cd2e-210">Najbardziej typowe źródło tego problemu jest brak odpowiednich indeksów przez filtry lub inne ograniczenia w zapytaniu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-210">The most common source of this issue is the lack of appropriate indexes to satisfy filters or other restrictions in a query.</span></span> <span data-ttu-id="1cd2e-211">Często brakujące indeksy manifestów jako tabelę skanowania może wystarczyć wyszukiwanie indeksu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-211">Often, missing indexes manifests as a table scan when an index seek could suffice.</span></span>

<span data-ttu-id="1cd2e-212">W tym przykładzie planu wybrane zapytanie używa skanowania podczas wyszukiwania będzie wystarczająca:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-212">In this example, the selected query plan uses a scan when a seek would suffice:</span></span>

    DROP TABLE dbo.missingindex;
    CREATE TABLE dbo.missingindex (col1 INT IDENTITY PRIMARY KEY, col2 INT);
    DECLARE @a int = 0;
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    WHILE @a < 20000
    BEGIN
        INSERT INTO dbo.missingindex(col2) VALUES (@a);
        SET @a += 1;
    END
    COMMIT TRANSACTION;
    GO
    SELECT m1.col1
    FROM dbo.missingindex m1 INNER JOIN dbo.missingindex m2 ON(m1.col1=m2.col1)
    WHERE m1.col2 = 4;

![Planu zapytania z brakujące indeksy](./media/sql-database-performance-guidance/query_plan_missing_indexes.png)

<span data-ttu-id="1cd2e-214">Baza danych SQL Azure może pomóc Znajdź i napraw wspólnej brakujących indeksu warunków.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-214">Azure SQL Database can help you find and fix common missing index conditions.</span></span> <span data-ttu-id="1cd2e-215">Widoków DMV, które są wbudowane w bazie danych SQL Azure przyjrzeć się kompilacje zapytania, w których indeks może znacznie zmniejszyć szacowany koszt, aby uruchomić kwerendę.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-215">DMVs that are built into Azure SQL Database look at query compilations in which an index would significantly reduce the estimated cost to run a query.</span></span> <span data-ttu-id="1cd2e-216">Podczas wykonywania zapytania bazy danych SQL śledzenia, jak często jest wykonywana każdego planu zapytania, a śledzi szacowany odstęp między planu wykonywania kwerend i jeden imagined gdy istniał tego indeksu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-216">During query execution, SQL Database tracks how often each query plan is executed, and tracks the estimated gap between the executing query plan and the imagined one where that index existed.</span></span> <span data-ttu-id="1cd2e-217">Użyj tych widoków DMV szybko odgadnąć które zmiany do projektu bazy danych fizycznych może zwiększyć całkowity koszt obciążenie bazy danych i jego rzeczywistego obciążenia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-217">You can use these DMVs to quickly guess which changes to your physical database design might improve overall workload cost for a database and its real workload.</span></span>

<span data-ttu-id="1cd2e-218">Skorzystaj z tej kwerendy, aby ocenić potencjalne brakujące indeksy:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-218">You can use this query to evaluate potential missing indexes:</span></span>

    SELECT CONVERT (varchar, getdate(), 126) AS runtime,
        mig.index_group_handle, mid.index_handle,
        CONVERT (decimal (28,1), migs.avg_total_user_cost * migs.avg_user_impact *
                (migs.user_seeks + migs.user_scans)) AS improvement_measure,
        'CREATE INDEX missing_index_' + CONVERT (varchar, mig.index_group_handle) + '_' +
                  CONVERT (varchar, mid.index_handle) + ' ON ' + mid.statement + '
                  (' + ISNULL (mid.equality_columns,'')
                  + CASE WHEN mid.equality_columns IS NOT NULL
                              AND mid.inequality_columns IS NOT NULL
                         THEN ',' ELSE '' END + ISNULL (mid.inequality_columns, '')
                  + ')'
                  + ISNULL (' INCLUDE (' + mid.included_columns + ')', '') AS create_index_statement,
        migs.*,
        mid.database_id,
        mid.[object_id]
    FROM sys.dm_db_missing_index_groups AS mig
    INNER JOIN sys.dm_db_missing_index_group_stats AS migs
        ON migs.group_handle = mig.index_group_handle
    INNER JOIN sys.dm_db_missing_index_details AS mid
        ON mig.index_handle = mid.index_handle
    ORDER BY migs.avg_total_user_cost * migs.avg_user_impact * (migs.user_seeks + migs.user_scans) DESC

<span data-ttu-id="1cd2e-219">W tym przykładzie zapytanie spowodowało sugestia ta:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-219">In this example, the query resulted in this suggestion:</span></span>

    CREATE INDEX missing_index_5006_5005 ON [dbo].[missingindex] ([col2])  

<span data-ttu-id="1cd2e-220">Po jego utworzeniu tej samej instrukcji SELECT wybiera innego planu, który używa wyszukiwania zamiast skanowania, a następnie wykonuje wydajniej plan:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-220">After it's created, that same SELECT statement picks a different plan, which uses a seek instead of a scan, and then executes the plan more efficiently:</span></span>

![Planu zapytania z indeksami poprawiony](./media/sql-database-performance-guidance/query_plan_corrected_indexes.png)

<span data-ttu-id="1cd2e-222">Wiedzę klucza jest bardziej ograniczony niż maszyny dedykowanego serwera wydajność We/Wy systemu udostępnionego, zwykłych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-222">The key insight is that the I/O capacity of a shared, commodity system is more limited than that of a dedicated server machine.</span></span> <span data-ttu-id="1cd2e-223">Na minimalizując niepotrzebnych operacji We/Wy przeprowadzać maksymalną systemu w DTU poziomu wydajności poszczególnych warstwach usług bazy danych SQL Azure jest premium.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-223">There's a premium on minimizing unnecessary I/O to take maximum advantage of the system in the DTU of each performance level of the Azure SQL Database service tiers.</span></span> <span data-ttu-id="1cd2e-224">Odpowiednie fizyczna baza danych projektu opcji może znacznie zwiększyć czas oczekiwania dla poszczególnych zapytań, poprawienia przepływności równoczesnych żądań obsługi na jednostkę skalowania i zminimalizować koszty, wymaganych do spełnienia zapytania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-224">Appropriate physical database design choices can significantly improve the latency for individual queries, improve the throughput of concurrent requests handled per scale unit, and minimize the costs required to satisfy the query.</span></span> <span data-ttu-id="1cd2e-225">Aby uzyskać więcej informacji o indeksie Brak widoków DMV, zobacz [sys.dm_db_missing_index_details](https://msdn.microsoft.com/library/ms345434.aspx).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-225">For more information about the missing index DMVs, see [sys.dm_db_missing_index_details](https://msdn.microsoft.com/library/ms345434.aspx).</span></span>

### <a name="query-tuning-and-hinting"></a><span data-ttu-id="1cd2e-226">Dostrajanie zapytania i zalecanych</span><span class="sxs-lookup"><span data-stu-id="1cd2e-226">Query tuning and hinting</span></span>
<span data-ttu-id="1cd2e-227">Optymalizator zapytań w bazie danych SQL Azure jest podobny do tradycyjnych Optymalizator zapytań programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-227">The query optimizer in Azure SQL Database is similar to the traditional SQL Server query optimizer.</span></span> <span data-ttu-id="1cd2e-228">Większość najlepsze rozwiązania dotyczące dostrajania zapytania i zrozumienie uzasadnienie modelu ograniczenia dotyczące Optymalizator zapytań mają zastosowanie również do bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-228">Most of the best practices for tuning queries and understanding the reasoning model limitations for the query optimizer also apply to Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-229">Jeśli dostroić kwerendy w bazie danych SQL Azure, można otrzymać dodatkowe korzyści, zmniejszenie zapotrzebowania na zasoby agregacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-229">If you tune queries in Azure SQL Database, you might get the additional benefit of reducing aggregate resource demands.</span></span> <span data-ttu-id="1cd2e-230">Aplikację można uruchomić niższe koszty niż niewyregulowanym równoważną, ponieważ można uruchomić na niższym poziomie wydajności.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-230">Your application might be able to run at a lower cost than an untuned equivalent because it can run at a lower performance level.</span></span>

<span data-ttu-id="1cd2e-231">Na przykład typowe w programie SQL Server i które mają zastosowanie również do bazy danych SQL Azure jak optymalizator zapytań "sniffs" parametrów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-231">An example that is common in SQL Server and which also applies to Azure SQL Database is how the query optimizer "sniffs" parameters.</span></span> <span data-ttu-id="1cd2e-232">Podczas kompilacji Optymalizator zapytań oblicza bieżącą wartość parametru, aby określić, czy można generować bardziej optymalne planu zapytania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-232">During compilation, the query optimizer evaluates the current value of a parameter to determine whether it can generate a more optimal query plan.</span></span> <span data-ttu-id="1cd2e-233">Mimo że ta strategia często może prowadzić do planu zapytania, który jest znacznie szybsze niż planu, który został skompilowany bez wartości parametrów znane, obecnie działa imperfectly zarówno w programie SQL Server i w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-233">Although this strategy often can lead to a query plan that is significantly faster than a plan compiled without known parameter values, currently it works imperfectly both in SQL Server and in Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-234">Czasami parametr jest nie ten sposób i czasami ten parametr w sposób, ale wygenerowanego planu jest nieoptymalne pełny zestaw wartości parametrów obciążenia pracą.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-234">Sometimes the parameter is not sniffed, and sometimes the parameter is sniffed but the generated plan is suboptimal for the full set of parameter values in a workload.</span></span> <span data-ttu-id="1cd2e-235">Firma Microsoft udostępnia wskazówki zapytania (dyrektywy), dzięki czemu można określić więcej celowo zamiar i zastąpić domyślne zachowanie wykrywanie parametrów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-235">Microsoft includes query hints (directives) so that you can specify intent more deliberately and override the default behavior of parameter sniffing.</span></span> <span data-ttu-id="1cd2e-236">Często Jeśli używasz wskazówek, można naprawić przypadkach domyślne zachowanie serwera SQL lub bazy danych SQL Azure jest niedoskonała dla obciążenia określonego klienta.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-236">Often, if you use hints, you can fix cases in which the default SQL Server or Azure SQL Database behavior is imperfect for a specific customer workload.</span></span>

<span data-ttu-id="1cd2e-237">W następnym przykładzie pokazano, jak procesor zapytań może wygenerować planu, który jest nieoptymalne, wydajności i wymagań dotyczących zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-237">The next example demonstrates how the query processor can generate a plan that is suboptimal both for performance and resource requirements.</span></span> <span data-ttu-id="1cd2e-238">W tym przykładzie przedstawiono również, że jeśli używasz wskazówki zapytania, można zmniejszyć wymagania dotyczące czasu i zasobów uruchomienie zapytania bazy danych SQL:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-238">This example also shows that if you use a query hint, you can reduce query run time and resource requirements for your SQL database:</span></span>

    DROP TABLE psptest1;
    CREATE TABLE psptest1(col1 int primary key identity, col2 int, col3 binary(200));

    DECLARE @a int = 0;
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    WHILE @a < 20000
    BEGIN
        INSERT INTO psptest1(col2) values (1);
        INSERT INTO psptest1(col2) values (@a);
        SET @a += 1;
    END
    COMMIT TRANSACTION
    CREATE INDEX i1 on psptest1(col2);
    GO

    CREATE PROCEDURE psp1 (@param1 int)
    AS
    BEGIN
        INSERT INTO t1 SELECT * FROM psptest1
        WHERE col2 = @param1
        ORDER BY col2;
    END
    GO

    CREATE PROCEDURE psp2 (@param2 int)
    AS
    BEGIN
        INSERT INTO t1 SELECT * FROM psptest1 WHERE col2 = @param2
        ORDER BY col2
        OPTION (OPTIMIZE FOR (@param2 UNKNOWN))
    END
    GO

    CREATE TABLE t1 (col1 int primary key, col2 int, col3 binary(200));
    GO

<span data-ttu-id="1cd2e-239">Kod instalacji tworzy tabelę, która ma niesymetryczna danych dystrybucji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-239">The setup code creates a table that has skewed data distribution.</span></span> <span data-ttu-id="1cd2e-240">Plan zapytania optymalne różni się pod względem którego parametr jest wybrany.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-240">The optimal query plan differs based on which parameter is selected.</span></span> <span data-ttu-id="1cd2e-241">Niestety ten plan zachowanie buforowania nie zawsze Skompiluj ponownie kwerendy na podstawie wartości typowych parametrów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-241">Unfortunately, the plan caching behavior doesn't always recompile the query based on the most common parameter value.</span></span> <span data-ttu-id="1cd2e-242">Tak prawdopodobnie nieoptymalne planu w pamięci podręcznej i używany dla wielu wartości, nawet wtedy, gdy inny plan może być lepszym rozwiązaniem planu średnia.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-242">So, it's possible for a suboptimal plan to be cached and used for many values, even when a different plan might be a better plan choice on average.</span></span> <span data-ttu-id="1cd2e-243">Następnie planu zapytania tworzy dwie procedury składowanej, które są identyczne, z wyjątkiem tego, że ma jedną wskazówkę zapytania specjalnych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-243">Then the query plan creates two stored procedures that are identical, except that one has a special query hint.</span></span>

<span data-ttu-id="1cd2e-244">**Przykład, część 1**</span><span class="sxs-lookup"><span data-stu-id="1cd2e-244">**Example, part 1**</span></span>

    -- Prime Procedure Cache with scan plan
    EXEC psp1 @param1=1;
    TRUNCATE TABLE t1;

    -- Iterate multiple times to show the performance difference
    DECLARE @i int = 0;
    WHILE @i < 1000
    BEGIN
        EXEC psp1 @param1=2;
        TRUNCATE TABLE t1;
        SET @i += 1;
    END

<span data-ttu-id="1cd2e-245">**Przykład część 2**</span><span class="sxs-lookup"><span data-stu-id="1cd2e-245">**Example, part 2**</span></span>

<span data-ttu-id="1cd2e-246">(Zaleca się poczekanie co najmniej 10 minut przed rozpoczęciem część 2 przykładzie tak, że wyniki są unikatowe w danych telemetrycznych.)</span><span class="sxs-lookup"><span data-stu-id="1cd2e-246">(We recommend that you wait at least 10 minutes before you begin part 2 of the example, so that the results are distinct in the resulting telemetry data.)</span></span>

    EXEC psp2 @param2=1;
    TRUNCATE TABLE t1;

    DECLARE @i int = 0;
    WHILE @i < 1000
    BEGIN
        EXEC psp2 @param2=2;
        TRUNCATE TABLE t1;
        SET @i += 1;
    END

<span data-ttu-id="1cd2e-247">W tym przykładzie każda część podejmie próbę uruchomienia sparametryzowane instrukcję 1000 razy (Aby wygenerować obciążenie wystarczające do użycia jako testowego zestawu danych).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-247">Each part of this example attempts to run a parameterized insert statement 1,000 times (to generate a sufficient load to use as a test data set).</span></span> <span data-ttu-id="1cd2e-248">Podczas wykonywania procedur składowanych, procesor zapytań sprawdza, czy wartość parametru przekazywana do procedury podczas swojej pierwszej kompilacji ("wykrywanie parametrów").</span><span class="sxs-lookup"><span data-stu-id="1cd2e-248">When it executes stored procedures, the query processor examines the parameter value that is passed to the procedure during its first compilation (parameter "sniffing").</span></span> <span data-ttu-id="1cd2e-249">Procesor buforuje Wynikowy plan i używa go do nowszej wywołań, nawet wtedy, gdy wartość parametru jest inny.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-249">The processor caches the resulting plan and uses it for later invocations, even if the parameter value is different.</span></span> <span data-ttu-id="1cd2e-250">Optymalne planu nie mogą być używane we wszystkich przypadkach.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-250">The optimal plan might not be used in all cases.</span></span> <span data-ttu-id="1cd2e-251">Czasami trzeba przewodnik Optymalizator wybierz plan, który jest lepszym rozwiązaniem dla średnia wielkość liter, a nie konkretnego przypadku od kiedy najpierw skompilowanego zapytania.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-251">Sometimes you need to guide the optimizer to pick a plan that is better for the average case rather than the specific case from when the query was first compiled.</span></span> <span data-ttu-id="1cd2e-252">W tym przykładzie wstępny plan generuje planu "skanowanie", który odczytuje wszystkie wiersze, aby znaleźć wartości, który odpowiada parametrowi:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-252">In this example, the initial plan generates a "scan" plan that reads all rows to find each value that matches the parameter:</span></span>

![Zapytanie dostrajanie przy użyciu planu skanowania](./media/sql-database-performance-guidance/query_tuning_1.png)

<span data-ttu-id="1cd2e-254">Ponieważ możemy wykonać procedurę przy użyciu wartości 1, Wynikowy plan został optymalne dla wartości 1, ale został nieoptymalne dla wszystkich wartości w tabeli.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-254">Because we executed the procedure by using the value 1, the resulting plan was optimal for the value 1 but was suboptimal for all other values in the table.</span></span> <span data-ttu-id="1cd2e-255">Prawdopodobnie wynik nie, co powinno, gdyby losowo, wybierz każdego planu, ponieważ plan wykonuje wolniej i wykorzystuje więcej zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-255">The result likely isn't what you would want if you were to pick each plan randomly, because the plan performs more slowly and uses more resources.</span></span>

<span data-ttu-id="1cd2e-256">Po uruchomieniu testu z `SET STATISTICS IO` ustawioną `ON`, pracy logicznej skanowania w tym przykładzie jest wykonywane w tle.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-256">If you run the test with `SET STATISTICS IO` set to `ON`, the logical scan work in this example is done behind the scenes.</span></span> <span data-ttu-id="1cd2e-257">Aby sprawdzić, czy 1,148 odczyty programach planu (która jest nieefektywne, jeśli średnia wielkość liter ma zwrócić tylko jeden wiersz):</span><span class="sxs-lookup"><span data-stu-id="1cd2e-257">You can see that there are 1,148 reads done by the plan (which is inefficient, if the average case is to return just one row):</span></span>

![Zapytanie dostrajanie przy użyciu logicznej skanowania](./media/sql-database-performance-guidance/query_tuning_2.png)

<span data-ttu-id="1cd2e-259">Druga część przykładzie używa wskazówki zapytania mówić Optymalizator można użyć określonej wartości podczas procesu kompilacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-259">The second part of the example uses a query hint to tell the optimizer to use a specific value during the compilation process.</span></span> <span data-ttu-id="1cd2e-260">W takim przypadku wymusi procesor zapytań, aby zignorować wartość, która została przekazana jako parametr, a zamiast tego do wniosku `UNKNOWN`.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-260">In this case, it forces the query processor to ignore the value that is passed as the parameter, and instead to assume `UNKNOWN`.</span></span> <span data-ttu-id="1cd2e-261">Dotyczy to wartość, która ma średnia częstotliwość w tabeli (Ignorowanie zegara).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-261">This refers to a value that has the average frequency in the table (ignoring skew).</span></span> <span data-ttu-id="1cd2e-262">Wynikowy plan jest na podstawie wyszukiwania plan, który jest szybsze i wykorzystuje mniej zasobów, średnio niż planu w część 1 w tym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="1cd2e-262">The resulting plan is a seek-based plan that is faster and uses fewer resources, on average, than the plan in part 1 of this example:</span></span>

![Dostrajanie zapytania za pomocą wskazówki zapytania](./media/sql-database-performance-guidance/query_tuning_3.png)

<span data-ttu-id="1cd2e-264">Można zobaczyć efekt **sys.resource_stats** tabeli (jest wyświetlony z pewnym opóźnieniem od czasu wykonywania testu i kiedy dane wypełnienie tabeli).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-264">You can see the effect in the **sys.resource_stats** table (there is a delay from the time that you execute the test and when the data populates the table).</span></span> <span data-ttu-id="1cd2e-265">Dla tego przykładu, część 1 wykonywanego w przedział czasu 22:25:00 i część 2 wykonywane 22:35:00.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-265">For this example, part 1 executed during the 22:25:00 time window, and part 2 executed at 22:35:00.</span></span> <span data-ttu-id="1cd2e-266">Przedział czasu wcześniej używane więcej zasobów w danym przedziale czasu niż nowszej (ze względu na ulepszenia wydajności plan).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-266">The earlier time window used more resources in that time window than the later one (because of plan efficiency improvements).</span></span>

    SELECT TOP 1000 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![Dostrajanie przykład wyniki zapytania](./media/sql-database-performance-guidance/query_tuning_4.png)

> [!NOTE]
> <span data-ttu-id="1cd2e-268">Chociaż wolumin w tym przykładzie jest celowo mały, efekt nieoptymalne parametry mogą być istotne, szczególnie w przypadku większych baz danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-268">Although the volume in this example is intentionally small, the effect of suboptimal parameters can be substantial, especially on larger databases.</span></span> <span data-ttu-id="1cd2e-269">Różnica, w ekstremalnych przypadkach mogą należeć do zakresu od sekund w przypadku szybkiego i godziny wolne przypadków.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-269">The difference, in extreme cases, can be between seconds for fast cases and hours for slow cases.</span></span>
> 
> 

<span data-ttu-id="1cd2e-270">Można sprawdzić **sys.resource_stats** ustalenie, czy zasób dla testu używa więcej lub mniej zasobów niż innego testu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-270">You can examine **sys.resource_stats** to determine whether the resource for a test uses more or fewer resources than another test.</span></span> <span data-ttu-id="1cd2e-271">Podczas porównywania danych oddzielenia czasu testów tak, aby nie były w tym samym oknie 5-minutowy w **sys.resource_stats** widoku.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-271">When you compare data, separate the timing of tests so that they are not in the same 5-minute window in the **sys.resource_stats** view.</span></span> <span data-ttu-id="1cd2e-272">Celem wykonywania jest zminimalizować łączną ilość zasobów używanych i nie, aby zminimalizować zasobów godzinami szczytu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-272">The goal of the exercise is to minimize the total amount of resources used, and not to minimize the peak resources.</span></span> <span data-ttu-id="1cd2e-273">Ogólnie rzecz biorąc Optymalizacja fragment kodu dla opóźnienia zmniejsza zużycie zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-273">Generally, optimizing a piece of code for latency also reduces resource consumption.</span></span> <span data-ttu-id="1cd2e-274">Upewnij się, że niezbędne są zmiany wprowadzone do aplikacji i że zmiany nie mieć negatywny wpływ na wrażenia osobie, która może stosować wskazówki zapytania w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-274">Make sure that the changes you make to an application are necessary, and that the changes don't negatively affect the customer experience for someone who might be using query hints in the application.</span></span>

<span data-ttu-id="1cd2e-275">Jeśli obciążenie zawiera zestaw powtarzania zapytań, często dobrym rozwiązaniem jest przechwycenie i zweryfikować optymalizacji z wybranych planu, ponieważ jego przebieg jednostki rozmiar minimalny zasobu wymaganego do obsługi bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-275">If a workload has a set of repeating queries, often it makes sense to capture and validate the optimality of your plan choices because it drives the minimum resource size unit required to host the database.</span></span> <span data-ttu-id="1cd2e-276">Po utworzeniu zweryfikować, czasami reexamine planuje daje pewność, że nie ma obniżoną.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-276">After you validate it, occasionally reexamine the plans to help you make sure that they have not degraded.</span></span> <span data-ttu-id="1cd2e-277">Użytkownik może dowiedzieć się więcej o [zapytania wskazówki (Transact-SQL)](https://msdn.microsoft.com/library/ms181714.aspx).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-277">You can learn more about [query hints (Transact-SQL)](https://msdn.microsoft.com/library/ms181714.aspx).</span></span>

### <a name="cross-database-sharding"></a><span data-ttu-id="1cd2e-278">Dzielenia na fragmenty między bazami danych</span><span class="sxs-lookup"><span data-stu-id="1cd2e-278">Cross-database sharding</span></span>
<span data-ttu-id="1cd2e-279">Ponieważ baza danych SQL Azure jest uruchamiana na standardowym sprzęcie, limity pojemności dla pojedynczej bazy danych są niższe niż w przypadku tradycyjnych, lokalnie instalacji programu SQL Server.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-279">Because Azure SQL Database runs on commodity hardware, the capacity limits for a single database are lower than for a traditional on-premises SQL Server installation.</span></span> <span data-ttu-id="1cd2e-280">Niektórzy klienci użyciu technik dzielenia na fragmenty rozprzestrzeniać się operacje bazy danych wielu baz danych podczas operacji nie mieści się w granicach pojedynczej bazy danych w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-280">Some customers use sharding techniques to spread database operations over multiple databases when the operations don't fit inside the limits of a single database in Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-281">Większość klientów korzystających z techniki dzielenia na fragmenty w bazie danych SQL Azure podzielone swoje dane na jednym wymiarze między wieloma bazami danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-281">Most customers who use sharding techniques in Azure SQL Database split their data on a single dimension across multiple databases.</span></span> <span data-ttu-id="1cd2e-282">Takie podejście należy zrozumieć, że aplikacje OLTP często wykonywać transakcje, które dotyczą tylko jeden wiersz lub dla niewielkiej liczby wierszy w schemacie.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-282">For this approach, you need to understand that OLTP applications often perform transactions that apply to only one row or to a small group of rows in the schema.</span></span>

> [!NOTE]
> <span data-ttu-id="1cd2e-283">Baza danych SQL zawiera teraz bibliotekę z dzielenia na fragmenty.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-283">SQL Database now provides a library to assist with sharding.</span></span> <span data-ttu-id="1cd2e-284">Aby uzyskać więcej informacji, zobacz [omówienie biblioteki klienta elastycznej bazy danych](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-284">For more information, see [Elastic Database client library overview](sql-database-elastic-database-client-library.md).</span></span>
> 
> 

<span data-ttu-id="1cd2e-285">Na przykład jeśli bazy danych ma nazwę odbiorcy, kolejność i szczegółów zamówienia (np. przykład tradycyjne bazy danych Northwind dostarczaną z programem SQL Server), to można podzielić te dane na wiele baz danych przez grupowanie klientowi kolejności pokrewne i szczegółowe informacje o zamówieniu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-285">For example, if a database has customer name, order, and order details (like the traditional example Northwind database that ships with SQL Server), you could split this data into multiple databases by grouping a customer with the related order and order detail information.</span></span> <span data-ttu-id="1cd2e-286">Aby zagwarantować, że odbiorcy danych pozostaje w pojedynczej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-286">You can guarantee that the customer's data stays in a single database.</span></span> <span data-ttu-id="1cd2e-287">Aplikacja będzie podziału różnych klientów dla baz danych, efektywnie rozłożenie obciążenia wielu baz danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-287">The application would split different customers across databases, effectively spreading the load across multiple databases.</span></span> <span data-ttu-id="1cd2e-288">Z dzielenia na fragmenty klienci nie tylko można uniknąć limitu rozmiaru maksymalnego bazy danych, ale baza danych SQL Azure także można przetwarzać obciążeń, które są znacznie większe niż limity poziomów wydajności różnych tak długo, jak długo każdy jedna baza danych jest dopasowywana do jego jednostek dtu w warstwie.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-288">With sharding, customers not only can avoid the maximum database size limit, but Azure SQL Database also can process workloads that are significantly larger than the limits of the different performance levels, as long as each individual database fits into its DTU.</span></span>

<span data-ttu-id="1cd2e-289">Chociaż dzielenia na fragmenty bazy danych nie zmniejszyć pojemność zagregowanych danych zasobu dla rozwiązania, jest wysoce efektywne Obsługa bardzo dużych rozwiązań, które rozprzestrzeniają się przez wiele baz danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-289">Although database sharding doesn't reduce the aggregate resource capacity for a solution, it's highly effective at supporting very large solutions that are spread over multiple databases.</span></span> <span data-ttu-id="1cd2e-290">Każda baza danych można uruchomić na poziomie różnych wydajności do obsługi bardzo duży, "skuteczne" bazy danych o wysokich wymaganiach dotyczących zasobów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-290">Each database can run at a different performance level to support very large, "effective" databases with high resource requirements.</span></span>

### <a name="functional-partitioning"></a><span data-ttu-id="1cd2e-291">Partycje funkcjonalne</span><span class="sxs-lookup"><span data-stu-id="1cd2e-291">Functional partitioning</span></span>
<span data-ttu-id="1cd2e-292">Użytkownicy programu SQL Server często łączyć wiele funkcji w jednej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-292">SQL Server users often combine many functions in a single database.</span></span> <span data-ttu-id="1cd2e-293">Na przykład jeśli aplikacja ma logikę umożliwiającą zarządzanie zapasami magazynu, tej bazy danych może być logiki skojarzonej z magazynu śledzenia zakupów, procedury składowane i indeksowanych lub zmaterializowanych widoków, które Zarządzanie raportowaniem koniec miesiąca.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-293">For example, if an application has logic to manage inventory for a store, that database might have logic associated with inventory, tracking purchase orders, stored procedures, and indexed or materialized views that manage end-of-month reporting.</span></span> <span data-ttu-id="1cd2e-294">Ta metoda ułatwia administrowanie operacje, takie jak Kopia zapasowa bazy danych, ale również wymaga rozmiaru sprzętu do obsługi obciążenia szczytowego we wszystkich funkcji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-294">This technique makes it easier to administer the database for operations like backup, but it also requires you to size the hardware to handle the peak load across all functions of an application.</span></span>

<span data-ttu-id="1cd2e-295">Jeśli używasz skalowalność architektury w bazie danych SQL Azure jest dobrym rozwiązaniem jest podział różne funkcje aplikacji do różnych baz danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-295">If you use a scale-out architecture in Azure SQL Database, it's a good idea to split different functions of an application into different databases.</span></span> <span data-ttu-id="1cd2e-296">Korzystając z tej techniki, każda aplikacja skaluje niezależnie.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-296">By using this technique, each application scales independently.</span></span> <span data-ttu-id="1cd2e-297">Aplikacji staje się coraz bardziej zajęty (i zwiększa obciążenie bazy danych), administrator może wybrać poziomy wydajności niezależne dla każdej funkcji aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-297">As an application becomes busier (and the load on the database increases), the administrator can choose independent performance levels for each function in the application.</span></span> <span data-ttu-id="1cd2e-298">Na granicy, z tej architektury aplikacji może być większy niż maszyny pojedynczego towaru może obsłużyć, ponieważ obciążenie pracą rozkłada się na wielu komputerach.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-298">At the limit, with this architecture, an application can be larger than a single commodity machine can handle because the load is spread across multiple machines.</span></span>

### <a name="batch-queries"></a><span data-ttu-id="1cd2e-299">Partii zapytań</span><span class="sxs-lookup"><span data-stu-id="1cd2e-299">Batch queries</span></span>
<span data-ttu-id="1cd2e-300">Dla aplikacji, które uzyskują dostęp do danych przy użyciu dużych częste zapytań ad hoc, znacznej ilości czasu odpowiedzi odbywa się na komunikację sieciową między warstwą aplikacji i warstwy bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-300">For applications that access data by using high-volume, frequent, ad hoc querying, a substantial amount of response time is spent on network communication between the application tier and the Azure SQL Database tier.</span></span> <span data-ttu-id="1cd2e-301">Nawet w przypadku aplikacji i bazy danych SQL Azure znajdują się w tym samym centrum danych, opóźnienie sieci między nimi może być powiększony przez dużą ilością danych, operacje związane z dostępem.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-301">Even when both the application and Azure SQL Database are in the same data center, the network latency between the two might be magnified by a large number of data access operations.</span></span> <span data-ttu-id="1cd2e-302">Aby zmniejszyć sieci round podróży dla operacji dostępu do danych, należy wziąć pod uwagę przy użyciu opcji albo partii zapytań ad hoc lub kompilowania ich jak przechowywane procedury.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-302">To reduce the network round trips for the data access operations, consider using the option to either batch the ad hoc queries, or to compile them as stored procedures.</span></span> <span data-ttu-id="1cd2e-303">Jeśli partii zapytań ad hoc, możesz wysłać wiele zapytań jako jedna duża partia w podróży jednego z bazą danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-303">If you batch the ad hoc queries, you can send multiple queries as one large batch in a single trip to Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-304">Jeśli kompilacja zapytań ad hoc w procedurze składowanej tak, jakby ich partii można osiągnąć ten sam rezultat.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-304">If you compile ad hoc queries in a stored procedure, you could achieve the same result as if you batch them.</span></span> <span data-ttu-id="1cd2e-305">Za pomocą procedury składowanej zapewnia również korzyści zwiększa prawdopodobieństwo buforowania plany zapytań w bazie danych SQL Azure, dzięki czemu można ponownie użyć procedury składowanej.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-305">Using a stored procedure also gives you the benefit of increasing the chances of caching the query plans in Azure SQL Database so you can use the stored procedure again.</span></span>

<span data-ttu-id="1cd2e-306">Niektóre aplikacje intensywnie zapisu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-306">Some applications are write-intensive.</span></span> <span data-ttu-id="1cd2e-307">Czasami można zmniejszyć całkowitego obciążenia We/Wy w bazie danych, biorąc pod uwagę sposób przetwarzania wsadowego zapisów.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-307">Sometimes you can reduce the total I/O load on a database by considering how to batch writes together.</span></span> <span data-ttu-id="1cd2e-308">Często jest tak proste, jak przy użyciu jawnych transakcji zamiast automatycznego zatwierdzania transakcji w procedur składowanych i partie ad hoc.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-308">Often, this is as simple as using explicit transactions instead of auto-commit transactions in stored procedures and ad hoc batches.</span></span> <span data-ttu-id="1cd2e-309">Do oceny różnych technik można użyć, zobacz [przetwarzanie wsadowe techniki dla aplikacji bazy danych SQL na platformie Azure](https://msdn.microsoft.com/library/windowsazure/dn132615.aspx).</span><span class="sxs-lookup"><span data-stu-id="1cd2e-309">For an evaluation of different techniques you can use, see [Batching techniques for SQL Database applications in Azure](https://msdn.microsoft.com/library/windowsazure/dn132615.aspx).</span></span> <span data-ttu-id="1cd2e-310">Wypróbuj obciążenia można znaleźć modelu prawo do przetwarzania wsadowego.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-310">Experiment with your own workload to find the right model for batching.</span></span> <span data-ttu-id="1cd2e-311">Pamiętaj zrozumieć, że model może mieć gwarancje spójności transakcyjnej nieco inne.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-311">Be sure to understand that a model might have slightly different transactional consistency guarantees.</span></span> <span data-ttu-id="1cd2e-312">Znajdowanie prawo obciążenia, który minimalizuje wykorzystanie zasobów wymaga znajdowanie odpowiednie połączenie kompromisy wydajnością a spójnością.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-312">Finding the right workload that minimizes resource use requires finding the right combination of consistency and performance trade-offs.</span></span>

### <a name="application-tier-caching"></a><span data-ttu-id="1cd2e-313">Buforowanie warstwy aplikacji</span><span class="sxs-lookup"><span data-stu-id="1cd2e-313">Application-tier caching</span></span>
<span data-ttu-id="1cd2e-314">Niektóre aplikacje bazy danych mają obciążeń intensywnie odczytu.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-314">Some database applications have read-heavy workloads.</span></span> <span data-ttu-id="1cd2e-315">Buforowanie warstwy może zmniejszyć obciążenie bazy danych i może zmniejszyć poziom wydajności, wymagany do obsługi bazy danych przy użyciu bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-315">Caching layers might reduce the load on the database and might potentially reduce the performance level required to support a database by using Azure SQL Database.</span></span> <span data-ttu-id="1cd2e-316">Z [pamięć podręczna Redis Azure](https://azure.microsoft.com/services/cache/), jeśli masz obciążenie intensywnie odczytu danych może odczytywać raz (lub raz na maszynie warstwy aplikacji, w zależności od sposobu skonfigurowania) i następnie przechowywania tych danych spoza Twojej bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-316">With [Azure Redis Cache](https://azure.microsoft.com/services/cache/), if you have a read-heavy workload, you can read the data once (or perhaps once per application-tier machine, depending on how it is configured), and then store that data outside your SQL database.</span></span> <span data-ttu-id="1cd2e-317">Jest to sposób, aby zmniejszyć obciążenie bazy danych (CPU i odczytu We/Wy), ale nie wpływa na spójności transakcyjnej, ponieważ odczytywane z pamięci podręcznej dane mogą być zsynchronizowane z danymi w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-317">This is a way to reduce database load (CPU and read I/O), but there is an effect on transactional consistency because the data being read from the cache might be out of sync with the data in the database.</span></span> <span data-ttu-id="1cd2e-318">Chociaż w wielu aplikacjach pewnego poziomu niespójności jest dopuszczalna, który nie jest spełniony dla wszystkich obciążeń.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-318">Although in many applications some level of inconsistency is acceptable, that's not true for all workloads.</span></span> <span data-ttu-id="1cd2e-319">Wszelkie wymagania aplikacji należy zapoznać się przed zaimplementowaniem strategii buforowania warstwy aplikacji.</span><span class="sxs-lookup"><span data-stu-id="1cd2e-319">You should fully understand any application requirements before you implement an application-tier caching strategy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1cd2e-320">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="1cd2e-320">Next steps</span></span>
* <span data-ttu-id="1cd2e-321">Aby uzyskać więcej informacji na temat warstwy usług, zobacz [opcje bazy danych SQL i wydajność](sql-database-service-tiers.md)</span><span class="sxs-lookup"><span data-stu-id="1cd2e-321">For more information about service tiers, see [SQL Database options and performance](sql-database-service-tiers.md)</span></span>
* <span data-ttu-id="1cd2e-322">Aby uzyskać więcej informacji na temat pule elastyczne, zobacz [co to jest puli elastycznej platformy Azure?](sql-database-elastic-pool.md)</span><span class="sxs-lookup"><span data-stu-id="1cd2e-322">For more information about elastic pools, see [What is an Azure elastic pool?](sql-database-elastic-pool.md)</span></span>
* <span data-ttu-id="1cd2e-323">Aby uzyskać informacje o wydajności i elastyczne pule, zobacz [kiedy należy wziąć pod uwagę puli elastycznej](sql-database-elastic-pool-guidance.md)</span><span class="sxs-lookup"><span data-stu-id="1cd2e-323">For information about performance and elastic pools, see [When to consider an elastic pool](sql-database-elastic-pool-guidance.md)</span></span>

