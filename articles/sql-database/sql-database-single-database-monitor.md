---
title: "aaaMonitoring wydajność bazy danych w usłudze Azure SQL Database | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat hello opcje monitorowania bazy danych za pomocą narzędzi Azure i dynamicznych widoków zarządzania."
keywords: "monitorowanie bazy danych, wydajność bazy danych w chmurze"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: a2e47475-c955-4a8d-a65c-cbef9a6d9b9f
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/10/2017
ms.author: carlrab
ms.openlocfilehash: b13771183d4ccf37f58e2fc518b9b14de38212dc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="monitoring-database-performance-in-azure-sql-database"></a><span data-ttu-id="013f3-104">Monitorowanie wydajności bazy danych w usłudze Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="013f3-104">Monitoring database performance in Azure SQL Database</span></span>
<span data-ttu-id="013f3-105">Monitorowanie wydajności hello bazy danych SQL na platformie Azure rozpoczyna się od monitorowania hello zasobów wykorzystania względną toohello poziomu wydajności bazy danych, wybranych.</span><span class="sxs-lookup"><span data-stu-id="013f3-105">Monitoring hello performance of a SQL database in Azure starts with monitoring hello resource utilization relative toohello level of database performance you choose.</span></span> <span data-ttu-id="013f3-106">Monitorowanie pomaga ustalić, czy baza danych ma nadmiarowej pojemności lub czy nie występują problemy, ponieważ limit maksymalnego wykorzystania zasobów, a następnie zdecydować, czy poziom wydajności hello tooadjust czasu i [warstwy usług](sql-database-service-tiers.md) bazy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-106">Monitoring helps you  determine whether your database has excess capacity or is having trouble because resources are maxed out, and then decide whether it's time tooadjust hello performance level and [service tier](sql-database-service-tiers.md) of your database.</span></span> <span data-ttu-id="013f3-107">Można monitorować bazy danych za pomocą narzędzi graficznych w hello [portalu Azure](https://portal.azure.com) lub przy użyciu programu SQL [dynamicznych widoków zarządzania](https://msdn.microsoft.com/library/ms188754.aspx).</span><span class="sxs-lookup"><span data-stu-id="013f3-107">You can monitor your database using graphical tools in hello [Azure portal](https://portal.azure.com) or using SQL [dynamic management views](https://msdn.microsoft.com/library/ms188754.aspx).</span></span>

## <a name="monitor-databases-using-hello-azure-portal"></a><span data-ttu-id="013f3-108">Monitorowanie baz danych przy użyciu hello portalu Azure</span><span class="sxs-lookup"><span data-stu-id="013f3-108">Monitor databases using hello Azure portal</span></span>
<span data-ttu-id="013f3-109">W hello [portalu Azure](https://portal.azure.com/), można monitorować wykorzystanie pojedynczej bazy danych wybrać bazę danych, a następnie klikając polecenie hello **monitorowanie** wykresu.</span><span class="sxs-lookup"><span data-stu-id="013f3-109">In hello [Azure portal](https://portal.azure.com/), you can monitor a single database’s utilization by selecting your database and clicking hello **Monitoring** chart.</span></span> <span data-ttu-id="013f3-110">Spowoduje to wyświetlenie **Metryka** oknie, w którym można zmienić, klikając hello **Edytuj wykres** przycisku.</span><span class="sxs-lookup"><span data-stu-id="013f3-110">This brings up a **Metric** window that you can change by clicking hello **Edit chart** button.</span></span> <span data-ttu-id="013f3-111">Dodaj następujące metryki hello:</span><span class="sxs-lookup"><span data-stu-id="013f3-111">Add hello following metrics:</span></span>

* <span data-ttu-id="013f3-112">Procent użycia procesora CPU</span><span class="sxs-lookup"><span data-stu-id="013f3-112">CPU percentage</span></span>
* <span data-ttu-id="013f3-113">Procent użycia jednostek DTU</span><span class="sxs-lookup"><span data-stu-id="013f3-113">DTU percentage</span></span>
* <span data-ttu-id="013f3-114">Procent użycia operacji we/wy na danych</span><span class="sxs-lookup"><span data-stu-id="013f3-114">Data IO percentage</span></span>
* <span data-ttu-id="013f3-115">Procent użycia rozmiaru bazy danych</span><span class="sxs-lookup"><span data-stu-id="013f3-115">Database size percentage</span></span>

<span data-ttu-id="013f3-116">Po dodaniu tych metryk możesz nadal tooview je hello **monitorowanie** wykres z bardziej szczegółowymi informacjami na powitania **Metryka** okna.</span><span class="sxs-lookup"><span data-stu-id="013f3-116">Once you’ve added these metrics, you can continue tooview them in hello **Monitoring** chart with more details on hello **Metric** window.</span></span> <span data-ttu-id="013f3-117">Wszystkie cztery metryki pokazują hello średnie wykorzystanie procent względną toohello **jednostek dtu w warstwie** bazy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-117">All four metrics show hello average utilization percentage relative toohello **DTU** of your database.</span></span> <span data-ttu-id="013f3-118">Zobacz hello [warstw usług](sql-database-service-tiers.md) artykułu, aby uzyskać szczegółowe informacje o Dtu.</span><span class="sxs-lookup"><span data-stu-id="013f3-118">See hello [service tiers](sql-database-service-tiers.md) article for details about DTUs.</span></span>

![Monitorowanie warstw usług pod względem wydajności bazy danych.](./media/sql-database-service-tiers/sqldb_service_tier_monitoring.png)

<span data-ttu-id="013f3-120">Można również skonfigurować alerty dotyczące metryk wydajności hello.</span><span class="sxs-lookup"><span data-stu-id="013f3-120">You can also configure alerts on hello performance metrics.</span></span> <span data-ttu-id="013f3-121">Kliknij przycisk hello **Dodaj alert** przycisku na powitania **Metryka** okna.</span><span class="sxs-lookup"><span data-stu-id="013f3-121">Click hello **Add alert** button in hello **Metric** window.</span></span> <span data-ttu-id="013f3-122">Wykonaj tooconfigure kreatora hello alertu.</span><span class="sxs-lookup"><span data-stu-id="013f3-122">Follow hello wizard tooconfigure your alert.</span></span> <span data-ttu-id="013f3-123">Masz hello tooalert opcji, jeśli hello metryki przekroczą określony próg lub hello spadną poniżej określonego progu.</span><span class="sxs-lookup"><span data-stu-id="013f3-123">You have hello option tooalert if hello metrics exceed a certain threshold or if hello metric falls below a certain threshold.</span></span>

<span data-ttu-id="013f3-124">Na przykład jeśli obciążenie hello na toogrow Twojej bazy danych, możesz tooconfigure alerty w wiadomościach e-mail zawsze, gdy baza danych osiągnie 80% na żadnym z hello metryki wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-124">For example, if you expect hello workload on your database toogrow, you can choose tooconfigure an email alert whenever your database reaches 80% on any of hello performance metrics.</span></span> <span data-ttu-id="013f3-125">Możesz użyć tego jako wczesne ostrzeżenie toofigure się, gdy masz tooswitch toohello dalej wyższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-125">You can use this as an early warning toofigure out when you might have tooswitch toohello next higher performance level.</span></span>

<span data-ttu-id="013f3-126">metryki wydajności Hello pomaga ustalić, czy jest możliwe toodowngrade tooa niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-126">hello performance metrics can also help you determine if you are able toodowngrade tooa lower performance level.</span></span> <span data-ttu-id="013f3-127">Załóżmy, w przypadku korzystania z bazy danych standardowa S2 i wszystkie Pokaż metryki wydajności średnio hello bazy danych nie używa więcej niż 10% w danym momencie.</span><span class="sxs-lookup"><span data-stu-id="013f3-127">Assume you are using a Standard S2 database and all performance metrics show that hello database on average does not use more than 10% at any given time.</span></span> <span data-ttu-id="013f3-128">Prawdopodobnie hello bazy danych będzie działać poprawnie w standardowa S1.</span><span class="sxs-lookup"><span data-stu-id="013f3-128">It is likely that hello database will work well in Standard S1.</span></span> <span data-ttu-id="013f3-129">Należy jednak pamiętać o obciążeń, które chwilowo wzrastają lub zmieniają się przed dokonaniem hello decyzji toomove tooa niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-129">However, be aware of workloads that spike or fluctuate before making hello decision toomove tooa lower performance level.</span></span>

## <a name="monitor-databases-using-dmvs"></a><span data-ttu-id="013f3-130">Monitorowanie baz danych przy użyciu widoków DMV</span><span class="sxs-lookup"><span data-stu-id="013f3-130">Monitor databases using DMVs</span></span>
<span data-ttu-id="013f3-131">Witaj same metryki, które są widoczne w portalu hello są również dostępne za pośrednictwem widoków systemowych: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) w hello logicznej **wzorca** bazy danych serwera, i [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) hello bazy danych użytkowników.</span><span class="sxs-lookup"><span data-stu-id="013f3-131">hello same metrics that are exposed in hello portal are also available through system views: [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) in hello logical **master** database of your server, and [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) in hello user database.</span></span> <span data-ttu-id="013f3-132">Użyj **sys.resource_stats** Jeśli potrzebujesz toomonitor mniej szczegółowe dane przez dłuższy okres czasu.</span><span class="sxs-lookup"><span data-stu-id="013f3-132">Use **sys.resource_stats** if you need toomonitor less granular data across a longer period of time.</span></span> <span data-ttu-id="013f3-133">Użyj **sys.dm_db_resource_stats** Jeśli potrzebujesz toomonitor bardziej szczegółowe dane w mniejszych odcinkach czasu.</span><span class="sxs-lookup"><span data-stu-id="013f3-133">Use **sys.dm_db_resource_stats** if you need toomonitor more granular data within a smaller time frame.</span></span> <span data-ttu-id="013f3-134">Aby uzyskać więcej informacji, zobacz [wytyczne dotyczące wydajności usługi Azure SQL Database](sql-database-single-database-monitor.md#monitor-resource-use)</span><span class="sxs-lookup"><span data-stu-id="013f3-134">For more information, see [Azure SQL Database Performance Guidance](sql-database-single-database-monitor.md#monitor-resource-use).</span></span>

> [!NOTE]
> <span data-ttu-id="013f3-135">Widok **sys.dm_db_resource_stats** zwraca pusty zestaw wyników w przypadku używania baz danych w wersjach Web i Business, które zostały wycofane.</span><span class="sxs-lookup"><span data-stu-id="013f3-135">**sys.dm_db_resource_stats** returns an empty result set when used in Web and Business edition databases, which are retired.</span></span>
>
>

### <a name="monitor-resource-use"></a><span data-ttu-id="013f3-136">Monitorowanie użycia zasobów</span><span class="sxs-lookup"><span data-stu-id="013f3-136">Monitor resource use</span></span>

<span data-ttu-id="013f3-137">Można monitorować przy użyciu użycia zasobów [Insight wydajności kwerendy bazy danych SQL](sql-database-query-performance.md) i [magazyn zapytań](https://msdn.microsoft.com/library/dn817826.aspx).</span><span class="sxs-lookup"><span data-stu-id="013f3-137">You can monitor resource usage using [SQL Database Query Performance Insight](sql-database-query-performance.md) and [Query Store](https://msdn.microsoft.com/library/dn817826.aspx).</span></span>

<span data-ttu-id="013f3-138">Można również monitorować za pomocą tych dwóch widoków użycia:</span><span class="sxs-lookup"><span data-stu-id="013f3-138">You can also monitor usage using these two views:</span></span>

* [<span data-ttu-id="013f3-139">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="013f3-139">sys.dm_db_resource_stats</span></span>](https://msdn.microsoft.com/library/dn800981.aspx)
* [<span data-ttu-id="013f3-140">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="013f3-140">sys.resource_stats</span></span>](https://msdn.microsoft.com/library/dn269979.aspx)

#### <a name="sysdmdbresourcestats"></a><span data-ttu-id="013f3-141">sys.dm_db_resource_stats</span><span class="sxs-lookup"><span data-stu-id="013f3-141">sys.dm_db_resource_stats</span></span>
<span data-ttu-id="013f3-142">Można użyć hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) widoku w każdej bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="013f3-142">You can use hello [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) view in every SQL database.</span></span> <span data-ttu-id="013f3-143">Witaj **sys.dm_db_resource_stats** widok pokazuje ostatnie warstwy usług względną toohello danych zasobów użycia.</span><span class="sxs-lookup"><span data-stu-id="013f3-143">hello **sys.dm_db_resource_stats** view shows recent resource use data relative toohello service tier.</span></span> <span data-ttu-id="013f3-144">Średni procent dla procesora CPU, dane We/Wy zapisu dziennika i pamięci są rejestrowane co 15 sekund i mają być przechowywane przez godzinę.</span><span class="sxs-lookup"><span data-stu-id="013f3-144">Average percentages for CPU, data I/O, log writes, and memory are recorded every 15 seconds and are maintained for 1 hour.</span></span>

<span data-ttu-id="013f3-145">Ponieważ ten widok udostępnia szczegółowe przyjrzeć się wykorzystania zasobów, użyj **sys.dm_db_resource_stats** pierwszego dla analizy bieżący stan lub rozwiązywania problemów.</span><span class="sxs-lookup"><span data-stu-id="013f3-145">Because this view provides a more granular look at resource use, use **sys.dm_db_resource_stats** first for any current-state analysis or troubleshooting.</span></span> <span data-ttu-id="013f3-146">Na przykład to zapytanie zawiera hello średnia i maksymalna zasobów przy użyciu hello bieżącej bazy danych za pośrednictwem hello ostatniej godziny:</span><span class="sxs-lookup"><span data-stu-id="013f3-146">For example, this query shows hello average and maximum resource use for hello current database over hello past hour:</span></span>

    SELECT  
        AVG(avg_cpu_percent) AS 'Average CPU use in percent',
        MAX(avg_cpu_percent) AS 'Maximum CPU use in percent',
        AVG(avg_data_io_percent) AS 'Average data I/O in percent',
        MAX(avg_data_io_percent) AS 'Maximum data I/O in percent',
        AVG(avg_log_write_percent) AS 'Average log write use in percent',
        MAX(avg_log_write_percent) AS 'Maximum log write use in percent',
        AVG(avg_memory_usage_percent) AS 'Average memory use in percent',
        MAX(avg_memory_usage_percent) AS 'Maximum memory use in percent'
    FROM sys.dm_db_resource_stats;  

<span data-ttu-id="013f3-147">Dla innych zapytań, zobacz przykłady hello w [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span><span class="sxs-lookup"><span data-stu-id="013f3-147">For other queries, see hello examples in [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx).</span></span>

#### <a name="sysresourcestats"></a><span data-ttu-id="013f3-148">sys.resource_stats</span><span class="sxs-lookup"><span data-stu-id="013f3-148">sys.resource_stats</span></span>
<span data-ttu-id="013f3-149">Witaj [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) widoku w hello **wzorca** bazy danych zawiera dodatkowe informacje, które pomaga monitorować wydajność hello na jego określonej usługi warstwę i poziom wydajności bazy danych SQL .</span><span class="sxs-lookup"><span data-stu-id="013f3-149">hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view in hello **master** database has additional information that can help you monitor hello performance of your SQL database at its specific service tier and performance level.</span></span> <span data-ttu-id="013f3-150">Hello dane są zbierane, co 5 minut, a także jest obsługiwany przez około 35 dni.</span><span class="sxs-lookup"><span data-stu-id="013f3-150">hello data is collected every 5 minutes and is maintained for approximately 35 days.</span></span> <span data-ttu-id="013f3-151">Ten widok jest przydatna do długoterminowego historycznej analizy używaniu zasobów bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="013f3-151">This view is useful for a longer-term historical analysis of how your SQL database uses resources.</span></span>

<span data-ttu-id="013f3-152">Witaj Wykres ukazuje hello użycia zasobów procesora CPU dla bazy danych — warstwa Premium z hello P2 poziom wydajności dla każdej godziny w tygodniu.</span><span class="sxs-lookup"><span data-stu-id="013f3-152">hello following graph shows hello CPU resource use for a Premium database with hello P2 performance level for each hour in a week.</span></span> <span data-ttu-id="013f3-153">Ten wykres rozpoczyna się w poniedziałek, pokazuje 5 dni roboczych i następnie przedstawiono weekendy, w przypadku znacznie mniej w aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="013f3-153">This graph starts on a Monday, shows 5 work days, and then shows a weekend, when much less happens on hello application.</span></span>

![Wykorzystanie zasobów bazy danych SQL](./media/sql-database-performance-guidance/sql_db_resource_utilization.png)

<span data-ttu-id="013f3-155">Z danych hello ta baza danych ma obecnie szczytowego obciążenia procesora CPU około 50 procent względną toohello P2 poziom wydajności (południe wtorek) użycie procesora CPU.</span><span class="sxs-lookup"><span data-stu-id="013f3-155">From hello data, this database currently has a peak CPU load of just over 50 percent CPU use relative toohello P2 performance level (midday on Tuesday).</span></span> <span data-ttu-id="013f3-156">Jeśli procesora CPU jest czynnikiem dominującą hello profilu zasobów aplikacji hello, następnie można zdecydować, czy P2 jest hello prawo dopasowanie tooguarantee poziomu wydajności, która zawsze hello obciążenia.</span><span class="sxs-lookup"><span data-stu-id="013f3-156">If CPU is hello dominant factor in hello application’s resource profile, then you might decide that P2 is hello right performance level tooguarantee that hello workload always fits.</span></span> <span data-ttu-id="013f3-157">Jeśli toogrow aplikacji w czasie, jest dobrym rozwiązaniem toohave buforu dodatkowym zasobem tak, aby aplikacja hello nigdy nie osiągnięto limitu hello poziom wydajności liczby.</span><span class="sxs-lookup"><span data-stu-id="013f3-157">If you expect an application toogrow over time, it's a good idea toohave an extra resource buffer so that hello application doesn't ever reach hello performance-level limit.</span></span> <span data-ttu-id="013f3-158">Jeśli zwiększysz hello poziom wydajności, może pomóc uniknąć błędów widoczne klienta, które mogą wystąpić, gdy baza danych nie ma wystarczającej liczby żądań tooprocess power skutecznie, szczególnie w środowiskach wrażliwy na opóźnienia.</span><span class="sxs-lookup"><span data-stu-id="013f3-158">If you increase hello performance level, you can help avoid customer-visible errors that might occur when a database doesn't have enough power tooprocess requests effectively, especially in latency-sensitive environments.</span></span> <span data-ttu-id="013f3-159">Przykładem jest bazy danych, która obsługuje aplikację, która umożliwia malowanie stron sieci Web na podstawie wyników hello wywołań bazy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-159">An example is a database that supports an application that paints webpages based on hello results of database calls.</span></span>

<span data-ttu-id="013f3-160">Inne typy aplikacji może zinterpretować hello sam wykres inaczej.</span><span class="sxs-lookup"><span data-stu-id="013f3-160">Other application types might interpret hello same graph differently.</span></span> <span data-ttu-id="013f3-161">Na przykład jeśli aplikacja próbuje danych Lista płac tooprocess każdego dnia i ma hello tego samego wykresu, tego rodzaju modelu "zadania wsadowego" może poradzić na poziom wydajności P1.</span><span class="sxs-lookup"><span data-stu-id="013f3-161">For example, if an application tries tooprocess payroll data each day and has hello same chart, this kind of "batch job" model might do fine at a P1 performance level.</span></span> <span data-ttu-id="013f3-162">Hello poziom wydajności P1 ma 100 Dtu too200 Dtu porównaniu hello P2 poziom wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-162">hello P1 performance level has 100 DTUs compared too200 DTUs at hello P2 performance level.</span></span> <span data-ttu-id="013f3-163">Witaj poziom wydajności P1 zapewnia połowa wydajność hello hello P2 poziom wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-163">hello P1 performance level provides half hello performance of hello P2 performance level.</span></span> <span data-ttu-id="013f3-164">Tak 50 procent użycia procesora CPU w P2 jest równy 100 procent użycia procesora CPU w P1.</span><span class="sxs-lookup"><span data-stu-id="013f3-164">So, 50 percent of CPU use in P2 equals 100 percent CPU use in P1.</span></span> <span data-ttu-id="013f3-165">Jeśli aplikacja hello nie ma przekroczeń limitu czasu, jego może niezależnie od tego, jeśli zadanie ma 2 godziny lub toofinish 2,5 godziny, jeżeli pobiera dzisiaj.</span><span class="sxs-lookup"><span data-stu-id="013f3-165">If hello application does not have timeouts, it might not matter if a job takes 2 hours or 2.5 hours toofinish, if it gets done today.</span></span> <span data-ttu-id="013f3-166">Prawdopodobnie aplikacji w tej kategorii można użyć poziomu wydajności P1.</span><span class="sxs-lookup"><span data-stu-id="013f3-166">An application in this category probably can use a P1 performance level.</span></span> <span data-ttu-id="013f3-167">Można korzystać z hello fakt, że są okresach, podczas gdy wykorzystanie zasobów jest starsza, tak, aby wszelkie "big szczytu" może być zostaną przeniesione za pośrednictwem do jednego z koryta hello później w ciągu dnia hello dzień hello.</span><span class="sxs-lookup"><span data-stu-id="013f3-167">You can take advantage of hello fact that there are periods of time during hello day when resource use is lower, so that any "big peak" might spill over into one of hello troughs later in hello day.</span></span> <span data-ttu-id="013f3-168">Witaj poziom wydajności P1 może być dobrym dla tego typu aplikacji (i Zapisz pieniędzy), tak długo, jak zakończyć zadania hello na czas każdego dnia.</span><span class="sxs-lookup"><span data-stu-id="013f3-168">hello P1 performance level might be good for that kind of application (and save money), as long as hello jobs can finish on time each day.</span></span>

<span data-ttu-id="013f3-169">Informacje o zasobie dla każdej bazy danych dla aktywnej w hello używane ujawnia bazy danych SQL Azure **sys.resource_stats** widoku hello **wzorca** bazy danych w każdym serwerze.</span><span class="sxs-lookup"><span data-stu-id="013f3-169">Azure SQL Database exposes consumed resource information for each active database in hello **sys.resource_stats** view of hello **master** database in each server.</span></span> <span data-ttu-id="013f3-170">Witaj w tabeli hello są agregowane dla 5-minutowy.</span><span class="sxs-lookup"><span data-stu-id="013f3-170">hello data in hello table is aggregated for 5-minute intervals.</span></span> <span data-ttu-id="013f3-171">Z hello podstawowa, standardowa i Premium warstwy usług, hello danych może być więcej niż 5 minut tooappear tabeli hello, tak aby bardziej użyteczna w przypadku historycznej analizy, a nie w pobliżu czasie rzeczywistym analizy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-171">With hello Basic, Standard, and Premium service tiers, hello data can take more than 5 minutes tooappear in hello table, so this data is more useful for historical analysis rather than near-real-time analysis.</span></span> <span data-ttu-id="013f3-172">Zapytanie hello **sys.resource_stats** widoku toosee hello niedawną historię bazy danych i toovalidate czy hello rezerwacji została wybrana opcja dostarczyć wydajności hello ma w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="013f3-172">Query hello **sys.resource_stats** view toosee hello recent history of a database and toovalidate whether hello reservation you chose delivered hello performance you want when needed.</span></span>

> [!NOTE]
> <span data-ttu-id="013f3-173">Musi być połączony toohello **wzorca** bazy danych logicznych tooquery serwera bazy danych SQL **sys.resource_stats** w hello następujące przykłady.</span><span class="sxs-lookup"><span data-stu-id="013f3-173">You must be connected toohello **master** database of your logical SQL database server tooquery **sys.resource_stats** in hello following examples.</span></span>
> 
> 

<span data-ttu-id="013f3-174">Ten przykład przedstawia, jak jest uwidaczniany hello danych w tym widoku:</span><span class="sxs-lookup"><span data-stu-id="013f3-174">This example shows you how hello data in this view is exposed:</span></span>

    SELECT TOP 10 *
    FROM sys.resource_stats
    WHERE database_name = 'resource1'
    ORDER BY start_time DESC

![widoku wykazu sys.resource_stats Hello](./media/sql-database-performance-guidance/sys_resource_stats.png)

<span data-ttu-id="013f3-176">Witaj dalej przykładzie przedstawiono różne sposoby, w których można używać hello **sys.resource_stats** widoku tooget informacji o używaniu zasobów w bazie danych SQL w katalogu:</span><span class="sxs-lookup"><span data-stu-id="013f3-176">hello next example shows you different ways that you can use hello **sys.resource_stats** catalog view tooget information about how your SQL database uses resources:</span></span>

1. <span data-ttu-id="013f3-177">toolook na powitania po tygodniu zasobów dla hello userdb1 bazy danych, można uruchomić tego zapytania:</span><span class="sxs-lookup"><span data-stu-id="013f3-177">toolook at hello past week’s resource use for hello database userdb1, you can run this query:</span></span>
   
        SELECT *
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND
              start_time > DATEADD(day, -7, GETDATE())
        ORDER BY start_time DESC;
2. <span data-ttu-id="013f3-178">jak dobrze obciążenie pasuje do poziomu wydajności hello tooevaluate, należy toodrill w dół do każdego aspektu hello zasobu metryki: procesora CPU, odczyty zapisy, liczbę procesów roboczych i liczba sesji.</span><span class="sxs-lookup"><span data-stu-id="013f3-178">tooevaluate how well your workload fits hello performance level, you need toodrill down into each aspect of hello resource metrics: CPU, reads, writes, number of workers, and number of sessions.</span></span> <span data-ttu-id="013f3-179">Oto poprawione zapytań przy użyciu **sys.resource_stats** tooreport hello średniego i maksymalnego wartości tych metryk zasobów:</span><span class="sxs-lookup"><span data-stu-id="013f3-179">Here's a revised query using **sys.resource_stats** tooreport hello average and maximum values of these resource metrics:</span></span>
   
        SELECT
            avg(avg_cpu_percent) AS 'Average CPU use in percent',
            max(avg_cpu_percent) AS 'Maximum CPU use in percent',
            avg(avg_data_io_percent) AS 'Average physical data I/O use in percent',
            max(avg_data_io_percent) AS 'Maximum physical data I/O use in percent',
            avg(avg_log_write_percent) AS 'Average log write use in percent',
            max(avg_log_write_percent) AS 'Maximum log write use in percent',
            avg(max_session_percent) AS 'Average % of sessions',
            max(max_session_percent) AS 'Maximum % of sessions',
            avg(max_worker_percent) AS 'Average % of workers',
            max(max_worker_percent) AS 'Maximum % of workers'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
3. <span data-ttu-id="013f3-180">Dzięki tym informacjom o wartości średnia i maksymalna hello każdego zasobu metryki można ocenić, jak obciążenie pasuje do poziomu wydajności hello wybrana.</span><span class="sxs-lookup"><span data-stu-id="013f3-180">With this information about hello average and maximum values of each resource metric, you can assess how well your workload fits into hello performance level you chose.</span></span> <span data-ttu-id="013f3-181">Zazwyczaj średnie wartości z **sys.resource_stats** zapewniają toouse dobrej linii bazowej, przed hello rozmiar docelowy.</span><span class="sxs-lookup"><span data-stu-id="013f3-181">Usually, average values from **sys.resource_stats** give you a good baseline toouse against hello target size.</span></span> <span data-ttu-id="013f3-182">Należy go z dysku podstawowego miary.</span><span class="sxs-lookup"><span data-stu-id="013f3-182">It should be your primary measurement stick.</span></span> <span data-ttu-id="013f3-183">Na przykład być może używasz hello warstwie usług standardowa S2 poziom wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-183">For an example, you might be using hello Standard service tier with S2 performance level.</span></span> <span data-ttu-id="013f3-184">Średnia Hello Użyj wartości procentowe dla procesora CPU i we/wy odczyty i zapisy są poniżej 40 procent, hello średnia liczba procesów roboczych jest poniżej 50 i hello średnią liczbę sesji jest poniżej 200.</span><span class="sxs-lookup"><span data-stu-id="013f3-184">hello average use percentages for CPU and I/O reads and writes are below 40 percent, hello average number of workers is below 50, and hello average number of sessions is below 200.</span></span> <span data-ttu-id="013f3-185">Obciążenie może pasuje do hello poziomie wydajności S1.</span><span class="sxs-lookup"><span data-stu-id="013f3-185">Your workload might fit into hello S1 performance level.</span></span> <span data-ttu-id="013f3-186">Jest łatwy toosee czy bazy danych mieści się w hello procesu roboczego i limity sesji.</span><span class="sxs-lookup"><span data-stu-id="013f3-186">It's easy toosee whether your database fits in hello worker and session limits.</span></span> <span data-ttu-id="013f3-187">czy bazy danych jest dopasowywana do niższej wydajności o zakresie tooCPU, odczyty i zapisy, toosee Podziel hello niższego poziomu wydajności liczba jednostek dtu w warstwie hello hello liczbę jednostek dtu w warstwie aktualny poziom wydajności i następnie pomnożenia wyniku hello 100:</span><span class="sxs-lookup"><span data-stu-id="013f3-187">toosee whether a database fits into a lower performance level with regards tooCPU, reads, and writes, divide hello DTU number of hello lower performance level by hello DTU number of your current performance level, and then multiply hello result by 100:</span></span>
   
    <span data-ttu-id="013f3-188">**S1 DTU / S2 JEDNOSTEK DTU W WARSTWIE * 100 = 20 / 50 * 100 = 40**</span><span class="sxs-lookup"><span data-stu-id="013f3-188">**S1 DTU / S2 DTU * 100 = 20 / 50 * 100 = 40**</span></span>
   
    <span data-ttu-id="013f3-189">wynik Hello jest hello względną wydajność różnica między hello dwa poziomy wydajności w procentach.</span><span class="sxs-lookup"><span data-stu-id="013f3-189">hello result is hello relative performance difference between hello two performance levels in percentage.</span></span> <span data-ttu-id="013f3-190">Jeśli Twoje użycie zasobów nie przekracza tę wartość, obciążenie może pasuje do hello niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-190">If your resource use doesn't exceed this amount, your workload might fit into hello lower performance level.</span></span> <span data-ttu-id="013f3-191">Jednak muszą toolook na wszystkie zakresy wartości użycia zasobów, a określenia wartości procentowej, jak często obciążenie bazy danych mieści się w hello niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-191">However, you need toolook at all ranges of resource use values, and determine, by percentage, how often your database workload would fit into hello lower performance level.</span></span> <span data-ttu-id="013f3-192">Witaj następujące zapytanie wyświetla się, że hello Dopasuj procent na wymiarze zasobów na powitania progu 40 procent, możemy obliczona w tym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="013f3-192">hello following query outputs hello fit percentage per resource dimension, based on hello threshold of 40 percent that we calculated in this example:</span></span>
   
        SELECT
            (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log Write Fit Percent'
            ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 40 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical Data IO Fit Percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="013f3-193">Oparty na celu poziomu usługi (SLO) bazy danych, można zdecydować, czy obciążenie jest dopasowywana do hello niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-193">Based on your database service level objective (SLO), you can decide whether your workload fits into hello lower performance level.</span></span> <span data-ttu-id="013f3-194">Jeśli SLO obciążenie bazy danych jest 99,9 procent hello poprzedniego zapytanie zwraca wartości większe niż 99,9% dla wszystkich wymiarów zasobów, obciążenie może pasuje do hello niższego poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-194">If your database workload SLO is 99.9 percent and hello preceding query returns values greater than 99.9 percent for all three resource dimensions, your workload likely fits into hello lower performance level.</span></span>
   
    <span data-ttu-id="013f3-195">Spojrzenie na powitania Dopasuj procent daje również wgląd w Określa, czy należy przenieść toohello dalej wyższej wydajności poziomu toomeet Twojego SLO.</span><span class="sxs-lookup"><span data-stu-id="013f3-195">Looking at hello fit percentage also gives you insight into whether you should move toohello next higher performance level toomeet your SLO.</span></span> <span data-ttu-id="013f3-196">Na przykład userdb1 przedstawia powitania po użycia procesora CPU dla hello zeszłym tygodniu:</span><span class="sxs-lookup"><span data-stu-id="013f3-196">For example, userdb1 shows hello following CPU use for hello past week:</span></span>
   
   | <span data-ttu-id="013f3-197">Średni procent procesora CPU</span><span class="sxs-lookup"><span data-stu-id="013f3-197">Average CPU percent</span></span> | <span data-ttu-id="013f3-198">Maksymalny procent procesora CPU</span><span class="sxs-lookup"><span data-stu-id="013f3-198">Maximum CPU percent</span></span> |
   | --- | --- |
   | <span data-ttu-id="013f3-199">24.5</span><span class="sxs-lookup"><span data-stu-id="013f3-199">24.5</span></span> |<span data-ttu-id="013f3-200">100.00</span><span class="sxs-lookup"><span data-stu-id="013f3-200">100.00</span></span> |
   
    <span data-ttu-id="013f3-201">średnie wykorzystanie Procesora Hello jest o kwartału hello limit hello poziom wydajności, który będzie pasują do poziomu wydajności hello hello bazy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-201">hello average CPU is about a quarter of hello limit of hello performance level, which would fit well into hello performance level of hello database.</span></span> <span data-ttu-id="013f3-202">Jednak wartość maksymalna hello pokazuje hello bazy danych osiągnie limit hello hello poziomu wydajności.</span><span class="sxs-lookup"><span data-stu-id="013f3-202">But, hello maximum value shows that hello database reaches hello limit of hello performance level.</span></span> <span data-ttu-id="013f3-203">Potrzebujesz toomove toohello dalej wyższego poziomu wydajności?</span><span class="sxs-lookup"><span data-stu-id="013f3-203">Do you need toomove toohello next higher performance level?</span></span> <span data-ttu-id="013f3-204">Zobacz, jak wiele razy z osiągnie obciążenia 100 procent, a następnie porównaj jej obciążenie bazy danych tooyour SLO.</span><span class="sxs-lookup"><span data-stu-id="013f3-204">Look at how many times your workload reaches 100 percent, and then compare it tooyour database workload SLO.</span></span>
   
        SELECT
        (COUNT(database_name) - SUM(CASE WHEN avg_cpu_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'CPU fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_log_write_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Log write fit percent'
        ,(COUNT(database_name) - SUM(CASE WHEN avg_data_io_percent >= 100 THEN 1 ELSE 0 END) * 1.0) / COUNT(database_name) AS 'Physical data I/O fit percent'
        FROM sys.resource_stats
        WHERE database_name = 'userdb1' AND start_time > DATEADD(day, -7, GETDATE());
   
    <span data-ttu-id="013f3-205">Jeśli ta kwerenda zwraca wartość mniej niż 99,9% dla każdego hello trzech wymiarów zasobu, należy wziąć pod uwagę albo przenoszenie toohello dalej wyższego poziomu wydajności lub użyj Dostrajanie aplikacji techniki tooreduce hello obciążenia na powitania bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="013f3-205">If this query returns a value less than 99.9 percent for any of hello three resource dimensions, consider either moving toohello next higher performance level or use application-tuning techniques tooreduce hello load on hello SQL database.</span></span>
4. <span data-ttu-id="013f3-206">Tego ćwiczenia również uwzględnia Twojej planowane obciążenie wzrost hello przyszłych.</span><span class="sxs-lookup"><span data-stu-id="013f3-206">This exercise also considers your projected workload increase in hello future.</span></span>

<span data-ttu-id="013f3-207">Dla pul elastycznych można monitorować pojedyncze bazy danych w puli hello hello techniki opisane w tej sekcji.</span><span class="sxs-lookup"><span data-stu-id="013f3-207">For elastic pools, you can monitor individual databases in hello pool with hello techniques described in this section.</span></span> <span data-ttu-id="013f3-208">Ale można również monitorować pulę hello jako całość.</span><span class="sxs-lookup"><span data-stu-id="013f3-208">But you can also monitor hello pool as a whole.</span></span> <span data-ttu-id="013f3-209">Informacje na ten temat znajdziesz w artykule [Monitor and manage an elastic pool](sql-database-elastic-pool-manage-portal.md) (Monitorowanie puli elastycznej i zarządzanie nią).</span><span class="sxs-lookup"><span data-stu-id="013f3-209">For information, see [Monitor and manage an elastic pool](sql-database-elastic-pool-manage-portal.md).</span></span>


### <a name="maximum-concurrent-requests"></a><span data-ttu-id="013f3-210">Maksymalna liczba równoczesnych żądań</span><span class="sxs-lookup"><span data-stu-id="013f3-210">Maximum concurrent requests</span></span>
<span data-ttu-id="013f3-211">toosee hello liczbę jednoczesnych żądań, uruchom to zapytanie języka Transact-SQL w bazie danych SQL:</span><span class="sxs-lookup"><span data-stu-id="013f3-211">toosee hello number of concurrent requests, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R

<span data-ttu-id="013f3-212">tooanalyze hello obciążenia lokalnej bazy danych SQL Server, zmodyfikuj ten toofilter zapytania na powitania określonej bazy danych ma tooanalyze.</span><span class="sxs-lookup"><span data-stu-id="013f3-212">tooanalyze hello workload of an on-premises SQL Server database, modify this query toofilter on hello specific database you want tooanalyze.</span></span> <span data-ttu-id="013f3-213">Na przykład jeśli masz lokalną bazą danych o nazwie mojabazadanych tego zapytania języka Transact-SQL zwraca hello liczbę jednoczesnych żądań w tej bazie danych:</span><span class="sxs-lookup"><span data-stu-id="013f3-213">For example, if you have an on-premises database named MyDatabase, this Transact-SQL query returns hello count of concurrent requests in that database:</span></span>

    SELECT COUNT(*) AS [Concurrent_Requests]
    FROM sys.dm_exec_requests R
    INNER JOIN sys.databases D ON D.database_id = R.database_id
    AND D.name = 'MyDatabase'

<span data-ttu-id="013f3-214">To właśnie migawki w jednym punkcie w czasie.</span><span class="sxs-lookup"><span data-stu-id="013f3-214">This is just a snapshot at a single point in time.</span></span> <span data-ttu-id="013f3-215">tooget lepiej zrozumieć obciążenia i wymagania równoczesnych żądań, będziesz potrzebować toocollect wiele próbek w czasie.</span><span class="sxs-lookup"><span data-stu-id="013f3-215">tooget a better understanding of your workload and concurrent request requirements, you'll need toocollect many samples over time.</span></span>

### <a name="maximum-concurrent-logins"></a><span data-ttu-id="013f3-216">Maksymalna równoczesnych logowania</span><span class="sxs-lookup"><span data-stu-id="013f3-216">Maximum concurrent logins</span></span>
<span data-ttu-id="013f3-217">Można analizować sieci użytkownika i aplikacji wzorce tooget wyobrażenie o częstotliwości hello logowania.</span><span class="sxs-lookup"><span data-stu-id="013f3-217">You can analyze your user and application patterns tooget an idea of hello frequency of logins.</span></span> <span data-ttu-id="013f3-218">Można również uruchomić rzeczywistych obciążeń w toomake środowiska testowego się upewnić, że użytkownik jest nie naciśnięcie to lub inne ograniczenia, które omówiono w tym artykule.</span><span class="sxs-lookup"><span data-stu-id="013f3-218">You also can run real-world loads in a test environment toomake sure that you're not hitting this or other limits we discuss in this article.</span></span> <span data-ttu-id="013f3-219">Nie ma jednego zapytania lub widoku dynamicznego zarządzania (DMV), który można wyświetlić równoczesnych się, że liczba logowania lub historii.</span><span class="sxs-lookup"><span data-stu-id="013f3-219">There isn’t a single query or dynamic management view (DMV) that can show you concurrent login counts or history.</span></span>

<span data-ttu-id="013f3-220">Użycie wielu klientom Witaj tych samych parametrach połączenia hello usługa uwierzytelnia każdego logowania.</span><span class="sxs-lookup"><span data-stu-id="013f3-220">If multiple clients use hello same connection string, hello service authenticates each login.</span></span> <span data-ttu-id="013f3-221">Jeśli 10 użytkowników jednocześnie połączyć hello tooa bazy danych, przy użyciu tej samej nazwy użytkownika i hasła, będzie 10 równoczesnych logowania.</span><span class="sxs-lookup"><span data-stu-id="013f3-221">If 10 users simultaneously connect tooa database by using hello same username and password, there would be 10 concurrent logins.</span></span> <span data-ttu-id="013f3-222">Ten limit dotyczy tylko toohello czas trwania hello logowania i uwierzytelniania.</span><span class="sxs-lookup"><span data-stu-id="013f3-222">This limit applies only toohello duration of hello login and authentication.</span></span> <span data-ttu-id="013f3-223">Hello tego samego 10 użytkowników połączyć toohello bazy danych po kolei, hello liczba równoczesnych logowań nigdy nie będzie większa niż 1.</span><span class="sxs-lookup"><span data-stu-id="013f3-223">If hello same 10 users connect toohello database sequentially, hello number of concurrent logins would never be greater than 1.</span></span>

> [!NOTE]
> <span data-ttu-id="013f3-224">Obecnie ten limit nie ma zastosowania toodatabases w pule elastyczne.</span><span class="sxs-lookup"><span data-stu-id="013f3-224">Currently, this limit does not apply toodatabases in elastic pools.</span></span>
> 
> 

### <a name="maximum-sessions"></a><span data-ttu-id="013f3-225">Maksymalna liczba sesji</span><span class="sxs-lookup"><span data-stu-id="013f3-225">Maximum sessions</span></span>
<span data-ttu-id="013f3-226">Bieżące aktywne sesje, liczba hello toosee wykonania tego zapytania języka Transact-SQL w bazie danych SQL:</span><span class="sxs-lookup"><span data-stu-id="013f3-226">toosee hello number of current active sessions, run this Transact-SQL query on your SQL database:</span></span>

    SELECT COUNT(*) AS [Sessions]
    FROM sys.dm_exec_connections

<span data-ttu-id="013f3-227">Jeśli czasie analizowania lokalnymi obciążenie serwera SQL, zmodyfikuj toofocus zapytania hello na określonej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="013f3-227">If you're analyzing an on-premises SQL Server workload, modify hello query toofocus on a specific database.</span></span> <span data-ttu-id="013f3-228">To zapytanie ułatwia określenie sesji możliwych potrzeb hello bazy danych, planując przeniesieniem tooAzure bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="013f3-228">This query helps you determine possible session needs for hello database if you are considering moving it tooAzure SQL Database.</span></span>

    SELECT COUNT(*)  AS [Sessions]
    FROM sys.dm_exec_connections C
    INNER JOIN sys.dm_exec_sessions S ON (S.session_id = C.session_id)
    INNER JOIN sys.databases D ON (D.database_id = S.database_id)
    WHERE D.name = 'MyDatabase'

<span data-ttu-id="013f3-229">Ponownie tych zapytań Zwróć liczba punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="013f3-229">Again, these queries return a point-in-time count.</span></span> <span data-ttu-id="013f3-230">W przypadku zebrania wielu próbkach wraz z upływem czasu, będziesz mieć hello jest opis najlepszych sesji, użyj.</span><span class="sxs-lookup"><span data-stu-id="013f3-230">If you collect multiple samples over time, you’ll have hello best understanding of your session use.</span></span>

<span data-ttu-id="013f3-231">Analizy bazy danych SQL można uzyskać statystyki historycznych na sesji badając hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) widoku i przeglądanie hello **active_session_count** kolumny.</span><span class="sxs-lookup"><span data-stu-id="013f3-231">For SQL Database analysis, you can get historical statistics on sessions by querying hello [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) view and reviewing hello **active_session_count** column.</span></span> 
