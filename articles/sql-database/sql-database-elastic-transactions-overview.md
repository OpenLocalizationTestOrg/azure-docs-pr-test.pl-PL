---
title: Transakcje rozproszone w bazach danych w chmurze
description: "Omówienie transakcji elastycznej bazy danych z bazy danych Azure SQL"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: f7f1ad3f1933b39a0030a784cae40521254037d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="93ecb-103">Transakcje rozproszone w bazach danych w chmurze</span><span class="sxs-lookup"><span data-stu-id="93ecb-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="93ecb-104">Transakcji elastycznej bazy danych dla usługi Azure SQL Database (baza danych SQL) pozwala na uruchamianie transakcje obejmujące wiele baz danych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you to run transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="93ecb-105">Transakcji elastycznej bazy danych dla bazy danych SQL są dostępne dla aplikacji .NET przy użyciu ADO .NET oraz integrują się z znanych programowania środowisko przy użyciu [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) klasy.</span><span class="sxs-lookup"><span data-stu-id="93ecb-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with the familiar programming experience using the [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="93ecb-106">Aby pobrać bibliotekę, zobacz [.NET Framework 4.6.1 (Instalator internetowy)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="93ecb-106">To get the library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="93ecb-107">Lokalnie takiej sytuacji są zwykle wymagane systemem koordynatora transakcji rozproszonych (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="93ecb-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="93ecb-108">Ponieważ usługa MSDTC nie jest dostępna dla aplikacji platformy jako usługa na platformie Azure, może koordynować transakcje rozproszone teraz zostało bezpośrednio zintegrowane bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, the ability to coordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="93ecb-109">Aplikacje mogą łączyć się z dowolną bazą danych SQL, można uruchomić transakcji rozproszonych, a jedna baza danych niewidocznie będzie koordynować z transakcji rozproszonych, jak pokazano na poniższej ilustracji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-109">Applications can connect to any SQL Database to launch distributed transactions, and one of the databases will transparently coordinate the distributed transaction, as shown in the following figure.</span></span> 

  ![<span data-ttu-id="93ecb-110">Transakcje rozproszone w usłudze Azure SQL Database przy użyciu transakcji elastycznej bazy danych</span><span class="sxs-lookup"><span data-stu-id="93ecb-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="93ecb-111">Typowe scenariusze</span><span class="sxs-lookup"><span data-stu-id="93ecb-111">Common scenarios</span></span>
<span data-ttu-id="93ecb-112">Transakcji elastycznej bazy danych dla bazy danych SQL umożliwiają aplikacjom atomic zmiany danych przechowywanych w wielu różnych baz danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-112">Elastic database transactions for SQL DB enable applications to make atomic changes to data stored in several different SQL Databases.</span></span> <span data-ttu-id="93ecb-113">Wersja zapoznawcza koncentruje się na procesy programowanie po stronie klienta w C# i platformy .NET.</span><span class="sxs-lookup"><span data-stu-id="93ecb-113">The preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="93ecb-114">Czynności po stronie serwera, za pomocą T-SQL jest zaplanowane na później.</span><span class="sxs-lookup"><span data-stu-id="93ecb-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="93ecb-115">Transakcji elastycznej bazy danych jest przeznaczony dla następujących scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="93ecb-115">Elastic database transactions targets the following scenarios:</span></span>

* <span data-ttu-id="93ecb-116">Bazy danych wielu aplikacji na platformie Azure: W tym scenariuszu danych jest pionowo podzielonym na partycje w kilku baz danych w bazie danych SQL tak, aby różne rodzaje danych znajdują się na różnych baz danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="93ecb-117">Niektóre operacje wymagają zmiany danych, który jest przechowywany w dwóch lub więcej baz danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-117">Some operations require changes to data which is kept in two or more databases.</span></span> <span data-ttu-id="93ecb-118">Aplikacja używa transakcji elastycznej bazy danych do koordynowania zmiany dla baz danych i zapewnienia niepodzielność.</span><span class="sxs-lookup"><span data-stu-id="93ecb-118">The application uses elastic database transactions to coordinate the changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="93ecb-119">Aplikacje bazy danych podzielonej na platformie Azure: W tym scenariuszu warstwy danych użyto [biblioteki klienta elastycznej bazy danych](sql-database-elastic-database-client-library.md) lub podanie samoobsługowego na poziomie partycji danych przez wiele baz danych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-119">Sharded database applications in Azure: With this scenario, the data tier uses the [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding to horizontally partition the data across many databases in SQL DB.</span></span> <span data-ttu-id="93ecb-120">Jeden przypadek użycia poświęcone jest potrzeba dokonać zmian atomic dla podzielonej aplikacji wielodostępnych podczas zmiany span dzierżaw.</span><span class="sxs-lookup"><span data-stu-id="93ecb-120">One prominent use case is the need to perform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="93ecb-121">Traktować dla wystąpienia transfer z jednej dzierżawy do innej, zarówno znajdującej się na różnych baz danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-121">Think for instance of a transfer from one tenant to another, both residing on different databases.</span></span> <span data-ttu-id="93ecb-122">Drugim przypadku jest szczegółowych dzielenia na fragmenty do uwzględnienia wymagań wydajności dla dużych dzierżawy, co z kolei zwykle oznacza, że niektóre operacje atomic musi rozciągnąć na kilka bazy danych używane do tej samej dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="93ecb-122">A second case is fine-grained sharding to accommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs to stretch across several databases used for the same tenant.</span></span> <span data-ttu-id="93ecb-123">Trzeci zdarza się atomic aktualizacje odwołują się dane, które są replikowane między bazami danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-123">A third case is atomic updates to reference data that are replicated across databases.</span></span> <span data-ttu-id="93ecb-124">Niepodzielne, transakcyjne, operacje na te wiersze można teraz koordynowane przez wiele baz danych przy użyciu wersji zapoznawczej.</span><span class="sxs-lookup"><span data-stu-id="93ecb-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using the preview.</span></span>
  <span data-ttu-id="93ecb-125">Transakcji elastycznej bazy danych użyj dwufazowe w celu zapewnienia niepodzielności transakcji dla baz danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-125">Elastic database transactions use two-phase commit to ensure transaction atomicity across databases.</span></span> <span data-ttu-id="93ecb-126">Należy dobrze dla transakcji, które obejmują mniej niż 100 baz danych w czasie w ramach jednej transakcji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="93ecb-127">Ograniczenia te nie są wymuszane, ale jeden oczekiwać wydajności i odsetka pomyślnych dla transakcji elastycznej bazy danych to obniżenie po przekroczeniu tych limitów.</span><span class="sxs-lookup"><span data-stu-id="93ecb-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions to suffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="93ecb-128">Instalacja i migracji</span><span class="sxs-lookup"><span data-stu-id="93ecb-128">Installation and migration</span></span>
<span data-ttu-id="93ecb-129">Za pomocą funkcji Aktualizacje do bibliotek .NET System.Data.dll i Biblioteka System.Transactions.dll dostępne stają się funkcje dla transakcji elastycznej bazy danych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-129">The capabilities for elastic database transactions in SQL DB are provided through updates to the .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="93ecb-130">Biblioteki DLL upewnij się, że w tym dwufazowe jest używany w przypadku, gdy jest to niezbędne do zapewnienia niepodzielność.</span><span class="sxs-lookup"><span data-stu-id="93ecb-130">The DLLs ensure that two-phase commit is used where necessary to ensure atomicity.</span></span> <span data-ttu-id="93ecb-131">Aby rozpocząć tworzenie aplikacji przy użyciu transakcji elastycznej bazy danych, należy zainstalować [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="93ecb-131">To start developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="93ecb-132">Podczas uruchamiania w starszej wersji programu .NET framework, transakcje zakończy się niepowodzeniem podwyższyć poziom do transakcji rozproszonej i zostanie zgłoszony wyjątek.</span><span class="sxs-lookup"><span data-stu-id="93ecb-132">When running on an earlier version of the .NET framework, transactions will fail to promote to a distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="93ecb-133">Po instalacji można transakcji rozproszonej interfejsów API w System.Transactions z połączeniami z bazą danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-133">After installation, you can use the distributed transaction APIs in System.Transactions with connections to SQL DB.</span></span> <span data-ttu-id="93ecb-134">Jeśli masz istniejące aplikacje usługi MSDTC za pomocą tych interfejsów API, po zainstalowaniu wersji 4.6.1 po prostu odbudować istniejące aplikacje dla .NET 4.6 Framework.</span><span class="sxs-lookup"><span data-stu-id="93ecb-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing the 4.6.1 Framework.</span></span> <span data-ttu-id="93ecb-135">Projekty skierowania .NET 4.6, automatycznie używają zaktualizowanej biblioteki dll z nowej wersji Framework i transakcji rozproszonej, którą wywołania interfejsu API w połączeniu z połączeniami z bazą danych SQL teraz powiedzie się..</span><span class="sxs-lookup"><span data-stu-id="93ecb-135">If your projects target .NET 4.6, they will automatically use the updated DLLs from the new Framework version and distributed transaction API calls in combination with connections to SQL DB will now succeed.</span></span>

<span data-ttu-id="93ecb-136">Należy pamiętać, że transakcji elastycznej bazy danych nie wymagają instalowania usługi MSDTC.</span><span class="sxs-lookup"><span data-stu-id="93ecb-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="93ecb-137">Zamiast tego transakcji elastycznej bazy danych są zarządzane bezpośrednio przez i w obrębie bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="93ecb-138">To znacznie upraszcza scenariusze chmury, ponieważ wdrożenie usługi MSDTC nie jest konieczne do korzystania z bazy danych SQL z transakcji rozproszonych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary to use distributed transactions with SQL DB.</span></span> <span data-ttu-id="93ecb-139">4 z sekcji omówiono bardziej szczegółowo wdrażanie transakcji elastycznej bazy danych i .NET framework wymagana wraz z aplikacji w chmurze na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="93ecb-139">Section 4 explains in more detail how to deploy elastic database transactions and the required .NET framework together with your cloud applications to Azure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="93ecb-140">Środowisko programistyczne</span><span class="sxs-lookup"><span data-stu-id="93ecb-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="93ecb-141">Aplikacje wielu baz danych</span><span class="sxs-lookup"><span data-stu-id="93ecb-141">Multi-database applications</span></span>
<span data-ttu-id="93ecb-142">Następujący przykładowy kod używa środowisko programowania zapoznać się z .NET System.Transactions.</span><span class="sxs-lookup"><span data-stu-id="93ecb-142">The following sample code uses the familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="93ecb-143">Klasa elementu TransactionScope ustanawia transakcja otoczenia w .NET.</span><span class="sxs-lookup"><span data-stu-id="93ecb-143">The TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="93ecb-144">("Transakcja otoczenia" jest taki, który znajduje się w bieżącym wątku). Wszystkie połączenia otworzyć wewnątrz elementu TransactionScope uczestniczyć w transakcji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-144">(An “ambient transaction” is one that lives in the current thread.) All connections opened within the TransactionScope participate in the transaction.</span></span> <span data-ttu-id="93ecb-145">Jeśli udział różnych baz danych, transakcji jest automatycznie podwyższony do transakcji rozproszonej.</span><span class="sxs-lookup"><span data-stu-id="93ecb-145">If different databases participate, the transaction is automatically elevated to a distributed transaction.</span></span> <span data-ttu-id="93ecb-146">Wynik transakcji jest kontrolowany przez ustawienie zakresu wykonać, aby wskazać na zatwierdzenie.</span><span class="sxs-lookup"><span data-stu-id="93ecb-146">The outcome of the transaction is controlled by setting the scope to complete to indicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="93ecb-147">Aplikacje baz danych podzielonej</span><span class="sxs-lookup"><span data-stu-id="93ecb-147">Sharded database applications</span></span>
<span data-ttu-id="93ecb-148">Transakcji elastycznej bazy danych dla bazy danych SQL obsługuje również koordynowanie transakcji rozproszonych, gdy używana jest metoda OpenConnectionForKey biblioteki klienta elastycznej bazy danych można otworzyć połączenia danych skalowanej warstwy.</span><span class="sxs-lookup"><span data-stu-id="93ecb-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use the OpenConnectionForKey method of the elastic database client library to open connections for a scaled out data tier.</span></span> <span data-ttu-id="93ecb-149">Należy wziąć pod uwagę przypadków, w których należy zagwarantować spójności transakcyjnej zmiany na kilka różnych dzielenia na fragmenty wartości klucza.</span><span class="sxs-lookup"><span data-stu-id="93ecb-149">Consider cases where you need to guarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="93ecb-150">Połączenia odłamków hosting dzielenia na fragmenty różnych wartości klucza są obsługiwane przez brokera przy użyciu OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="93ecb-150">Connections to the shards hosting the different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="93ecb-151">W przypadku ogólnych połączenia może być inny odłamków tak, aby zapewnienie transakcyjne gwarancje wymaga transakcji rozproszonej.</span><span class="sxs-lookup"><span data-stu-id="93ecb-151">In the general case, the connections can be to different shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="93ecb-152">Poniższy przykładowy kod przedstawia tej metody.</span><span class="sxs-lookup"><span data-stu-id="93ecb-152">The following code sample illustrates this approach.</span></span> <span data-ttu-id="93ecb-153">Zakłada się, że zmienna o nazwie shardmap jest używana do reprezentowania mapy niezależnego fragmentu z biblioteki klienta elastycznej bazy danych:</span><span class="sxs-lookup"><span data-stu-id="93ecb-153">It assumes that a variable called shardmap is used to represent a shard map from the elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="93ecb-154">Instalacja środowiska .NET dla usługi w chmurze Azure</span><span class="sxs-lookup"><span data-stu-id="93ecb-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="93ecb-155">Platforma Azure udostępnia kilka ofert umożliwia obsługę aplikacji programu .NET.</span><span class="sxs-lookup"><span data-stu-id="93ecb-155">Azure provides several offerings to host .NET applications.</span></span> <span data-ttu-id="93ecb-156">Porównanie różnych ofert jest dostępna w [porównanie usługi Azure App Service, usługi w chmurze i maszyn wirtualnych](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="93ecb-156">A comparison of the different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="93ecb-157">Jeśli system operacyjny gościa oferty jest mniejsza niż .NET 4.6.1 wymagane dla transakcji elastycznej, należy uaktualnić system operacyjny gościa do wersji 4.6.1.</span><span class="sxs-lookup"><span data-stu-id="93ecb-157">If the guest OS of the offering is smaller than .NET 4.6.1 required for elastic transactions, you need to upgrade the guest OS to 4.6.1.</span></span> 

<span data-ttu-id="93ecb-158">Usługi aplikacji Azure z systemem operacyjnym gościa obecnie nie są obsługiwane uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="93ecb-158">For Azure App Services, upgrades to the guest OS are currently not supported.</span></span> <span data-ttu-id="93ecb-159">Maszyn wirtualnych platformy Azure, wystarczy zalogować się do maszyny Wirtualnej i uruchom Instalatora programu .NET framework najnowsze.</span><span class="sxs-lookup"><span data-stu-id="93ecb-159">For Azure Virtual Machines, simply log into the VM and run the installer for the latest .NET framework.</span></span> <span data-ttu-id="93ecb-160">Usługi w chmurze Azure muszą obejmować instalację nowszej wersji platformy .NET do uruchamiania zadań wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="93ecb-160">For Azure Cloud Services, you need to include the installation of a newer .NET version into the startup tasks of your deployment.</span></span> <span data-ttu-id="93ecb-161">Pojęcia i kroki opisano w [zainstalować .NET dla roli usługi chmury](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="93ecb-161">The concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="93ecb-162">Należy pamiętać, Instalator programu .NET 4.6.1 może wymagać więcej magazyn tymczasowy podczas procesu bootstrapping na usług w chmurze Azure niż Instalator dla .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="93ecb-162">Note that the installer for .NET 4.6.1 may require more temporary storage during the bootstrapping process on Azure cloud services than the installer for .NET 4.6.</span></span> <span data-ttu-id="93ecb-163">W celu zapewnienia pomyślnej instalacji, należy zwiększyć tymczasowego magazynu dla usługi w chmurze platformy Azure w pliku ServiceDefinition.csdef w sekcji LocalResources i ustawienia środowiska uruchamiania zadania, jak pokazano w poniższym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="93ecb-163">To ensure a successful installation, you need to increase temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in the LocalResources section and the environment settings of your startup task, as shown in the following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="93ecb-164">Transakcje na wielu serwerach</span><span class="sxs-lookup"><span data-stu-id="93ecb-164">Transactions across multiple servers</span></span>
<span data-ttu-id="93ecb-165">Transakcji elastycznej bazy danych są obsługiwane na różnych serwerach logicznych w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="93ecb-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="93ecb-166">Gdy transakcje przekraczają granice serwer logiczny, serwerów najpierw należy można wprowadzić w relacji wzajemnego komunikacji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-166">When transactions cross logical server boundaries, the participating servers first need to be entered into a mutual communication relationship.</span></span> <span data-ttu-id="93ecb-167">Po ustanowieniu relacji komunikacji, wszystkie bazy danych w jednym z dwóch serwerów mogą uczestniczyć w transakcji elastycznej z bazami danych z innego serwera.</span><span class="sxs-lookup"><span data-stu-id="93ecb-167">Once the communication relationship has been established, any database in any of the two servers can participate in elastic transactions with databases from the other server.</span></span> <span data-ttu-id="93ecb-168">Z transakcjami obejmujące więcej niż dwa serwery logiczne relację komunikacji musi być w miejscu dla każdej pary serwerów logicznych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-168">With transactions spanning more than two logical servers, a communication relationship needs to be in place for any pair of logical servers.</span></span>

<span data-ttu-id="93ecb-169">Użyj następujących poleceń cmdlet programu PowerShell do zarządzania relacjami między serwerami komunikacji dla transakcji elastycznej bazy danych:</span><span class="sxs-lookup"><span data-stu-id="93ecb-169">Use the following PowerShell cmdlets to manage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="93ecb-170">**Nowy AzureRmSqlServerCommunicationLink**: Użyj tego polecenia cmdlet, aby utworzyć nową relację komunikacji między dwoma serwerami logicznych w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="93ecb-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet to create a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="93ecb-171">Relacja jest symetrycznego, co oznacza, że oba serwery mogą inicjować transakcji z innego serwera.</span><span class="sxs-lookup"><span data-stu-id="93ecb-171">The relationship is symmetric which means both servers can initiate transactions with the other server.</span></span>
* <span data-ttu-id="93ecb-172">**Get-AzureRmSqlServerCommunicationLink**: Użyj tego polecenia cmdlet można pobrać istniejące relacje komunikacji oraz ich właściwości.</span><span class="sxs-lookup"><span data-stu-id="93ecb-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet to retrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="93ecb-173">**Usuń AzureRmSqlServerCommunicationLink**: Użyj tego polecenia cmdlet, aby usunąć istniejącą relację, która komunikacji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet to remove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="93ecb-174">Monitorowanie stanu transakcji</span><span class="sxs-lookup"><span data-stu-id="93ecb-174">Monitoring transaction status</span></span>
<span data-ttu-id="93ecb-175">Użyj dynamicznych widoków zarządzania (widoków DMV) w bazie danych SQL do monitorowania stanu i postępu transakcji trwającą elastycznej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-175">Use Dynamic Management Views (DMVs) in SQL DB to monitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="93ecb-176">Wszystkie widoków DMV powiązane z transakcjami są odpowiednie dla transakcji rozproszonych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-176">All DMVs related to transactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="93ecb-177">Można znaleźć odpowiedniej liście widoków DMV tutaj: [powiązane dynamicznych widoków zarządzania transakcji i funkcji (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="93ecb-177">You can find the corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="93ecb-178">Tych widoków DMV jest szczególnie przydatna:</span><span class="sxs-lookup"><span data-stu-id="93ecb-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="93ecb-179">**sys.DM\_tran\_active\_transakcji**: Wyświetla listę obecnie aktywnych transakcji i ich stan.</span><span class="sxs-lookup"><span data-stu-id="93ecb-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="93ecb-180">Kolumna UOW (jednostka pracy) można zidentyfikować transakcji inny podrzędny, które należą do tej samej transakcji rozproszonej.</span><span class="sxs-lookup"><span data-stu-id="93ecb-180">The UOW (Unit Of Work) column can identify the different child transactions that belong to the same distributed transaction.</span></span> <span data-ttu-id="93ecb-181">Wszystkie transakcje w ramach jednej transakcji rozproszonej posiadać taką samą wartość UOW.</span><span class="sxs-lookup"><span data-stu-id="93ecb-181">All transactions within the same distributed transaction carry the same UOW value.</span></span> <span data-ttu-id="93ecb-182">Zobacz [dokumentacji DMV](https://msdn.microsoft.com/library/ms174302.aspx) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="93ecb-182">See the [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="93ecb-183">**sys.DM\_tran\_bazy danych\_transakcji**: udostępnia dodatkowe informacje o transakcji, takich jak umieszczania transakcji w dzienniku.</span><span class="sxs-lookup"><span data-stu-id="93ecb-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of the transaction in the log.</span></span> <span data-ttu-id="93ecb-184">Zobacz [dokumentacji DMV](https://msdn.microsoft.com/library/ms186957.aspx) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="93ecb-184">See the [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="93ecb-185">**sys.DM\_tran\_blokad**: zawiera informacje o blokad, które są obecnie przechowywane w bieżących transakcji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-185">**sys.dm\_tran\_locks**: Provides information about the locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="93ecb-186">Zobacz [dokumentacji DMV](https://msdn.microsoft.com/library/ms190345.aspx) więcej szczegółów.</span><span class="sxs-lookup"><span data-stu-id="93ecb-186">See the [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="93ecb-187">Ograniczenia</span><span class="sxs-lookup"><span data-stu-id="93ecb-187">Limitations</span></span>
<span data-ttu-id="93ecb-188">Do transakcji elastycznej bazy danych w bazie danych SQL obecnie obowiązują następujące ograniczenia:</span><span class="sxs-lookup"><span data-stu-id="93ecb-188">The following limitations currently apply to elastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="93ecb-189">Obsługiwane są tylko transakcje dla baz danych w bazie danych SQL.</span><span class="sxs-lookup"><span data-stu-id="93ecb-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="93ecb-190">Inne [X / Otwórz XA](https://en.wikipedia.org/wiki/X/Open_XA) dostawców zasobów i baz danych poza bazy danych SQL nie może brać udziału w transakcji elastycznej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="93ecb-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="93ecb-191">Oznacza to, że transakcji elastycznej bazy danych nie można rozciągnąć na lokalnie serwer SQL i baz danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="93ecb-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="93ecb-192">Transakcji rozproszonych lokalnie nadal używać usługi MSDTC.</span><span class="sxs-lookup"><span data-stu-id="93ecb-192">For distributed transactions on premises, continue to use MSDTC.</span></span> 
* <span data-ttu-id="93ecb-193">Tylko koordynowane klienta transakcje z aplikacji .NET są obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="93ecb-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="93ecb-194">Obsługa po stronie serwera T-SQL, takich jak rozpocząć transakcji ROZPROSZONYCH jest planowane, ale nie jest jeszcze dostępna.</span><span class="sxs-lookup"><span data-stu-id="93ecb-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="93ecb-195">Transakcje w usługach WCF nie są obsługiwane.</span><span class="sxs-lookup"><span data-stu-id="93ecb-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="93ecb-196">Na przykład masz metody usługi WCF, która wykonuje transakcji.</span><span class="sxs-lookup"><span data-stu-id="93ecb-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="93ecb-197">Otaczający wywołanie w zakresie transakcji nie powiedzie się jako [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="93ecb-197">Enclosing the call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="93ecb-198">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="93ecb-198">Next steps</span></span>
<span data-ttu-id="93ecb-199">Odpowiedzi na pytania, proszę dotrzeć do nas na [forum bazy danych SQL](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) i funkcja żądań, dodaj je do [forum opinii bazy danych SQL](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="93ecb-199">For questions, please reach out to us on the [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them to the [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



