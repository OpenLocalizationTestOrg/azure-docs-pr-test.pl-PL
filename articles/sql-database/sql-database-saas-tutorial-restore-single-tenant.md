---
title: "Przywracanie bazy danych Azure SQL w aplikacji wielodostępnych | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak przywracanie bazy danych SQL pojedynczego dzierżawcy po przypadkowym usunięciu danych"
keywords: "samouczek usługi sql database"
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: billgib;sstein
ms.openlocfilehash: 547851972f13ec69a8f65d01290874ad7d07f192
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="restore-a-wingtip-saas-tenants-sql-database"></a><span data-ttu-id="b09d5-104">Przywracanie bazy danych SQL dzierżaw Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="b09d5-104">Restore a Wingtip SaaS tenants SQL database</span></span>

<span data-ttu-id="b09d5-105">Aplikacja Wingtip SaaS jest utworzony przy użyciu modelu bazy danych dla dzierżawy, którym każdy dzierżawca ma własnych bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-105">The Wingtip SaaS app is built using a database-per-tenant model, where each tenant has their own database.</span></span> <span data-ttu-id="b09d5-106">Jedną z zalet tego modelu jest łatwo przywrócić dane z pojedynczej dzierżawy w izolacji bez wpływu na innych dzierżawców.</span><span class="sxs-lookup"><span data-stu-id="b09d5-106">One of the benefits of this model is that it is easy to restore a single tenant’s data in isolation without impacting other tenants.</span></span>

<span data-ttu-id="b09d5-107">W tym samouczku Dowiedz się dwa wzorce odzyskiwania danych:</span><span class="sxs-lookup"><span data-stu-id="b09d5-107">In this tutorial you learn two data recovery patterns:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="b09d5-108">Przywróć bazę danych do bazy danych równoległej (side-by-side)</span><span class="sxs-lookup"><span data-stu-id="b09d5-108">Restore a database into a parallel database (side-by-side)</span></span>
> * <span data-ttu-id="b09d5-109">Przywracanie bazy danych w miejscu</span><span class="sxs-lookup"><span data-stu-id="b09d5-109">Restore a database in place</span></span>


|||
|:--|:--|
| <span data-ttu-id="b09d5-110">**Przywróć dzierżawy do wcześniejszego punktu w czasie do równoległego bazy danych**</span><span class="sxs-lookup"><span data-stu-id="b09d5-110">**Restore tenant to a prior point in time, into a parallel database**</span></span> | <span data-ttu-id="b09d5-111">Ten wzorzec może służyć przez dzierżawcę do przeglądu, inspekcji, zgodności itd. Oryginalnej bazy danych pozostaje bez zmian i online.</span><span class="sxs-lookup"><span data-stu-id="b09d5-111">This pattern can be used by the tenant for review, auditing, compliance, etc. The original database remains online and unchanged.</span></span> |
| <span data-ttu-id="b09d5-112">**Przywróć dzierżawy w miejscu**</span><span class="sxs-lookup"><span data-stu-id="b09d5-112">**Restore tenant in-place**</span></span> | <span data-ttu-id="b09d5-113">Ten wzorzec jest zwykle używane do odzyskania dzierżawy do wcześniejszego punktu w czasie, po dzierżawcy przypadkowo usunął danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-113">This pattern is typically used to recover a tenant to a prior point in time, after a tenant accidentally deletes data.</span></span> <span data-ttu-id="b09d5-114">Oryginalnej bazy danych jest przełączona w tryb offline i zastąpione przywróconej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-114">The original database is taken offline, and replaced with the restored database.</span></span> |
|||

<span data-ttu-id="b09d5-115">Do wykonania zadań opisanych w tym samouczku niezbędne jest spełnienie następujących wymagań wstępnych:</span><span class="sxs-lookup"><span data-stu-id="b09d5-115">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="b09d5-116">Aplikacja Wingtip SaaS jest wdrażana.</span><span class="sxs-lookup"><span data-stu-id="b09d5-116">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="b09d5-117">Aby wdrożyć w mniej niż 5 minut, zobacz [wdrażania i aplikacji Wingtip SaaS](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="b09d5-117">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="b09d5-118">Zainstalowany jest program Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b09d5-118">Azure PowerShell is installed.</span></span> <span data-ttu-id="b09d5-119">Aby uzyskać szczegółowe informacje, zobacz [Rozpoczynanie pracy z programem Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="b09d5-119">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-to-the-saas-tenant-restore-pattern"></a><span data-ttu-id="b09d5-120">Wprowadzenie do wzorca przywracania dzierżawy SaaS</span><span class="sxs-lookup"><span data-stu-id="b09d5-120">Introduction to the SaaS tenant restore pattern</span></span>

<span data-ttu-id="b09d5-121">Dla dzierżawcy wzorca przywracania istnieją dwa proste wzorce w celu przywrócenia danych dzierżawy usługi.</span><span class="sxs-lookup"><span data-stu-id="b09d5-121">For the tenant restore pattern, there are two simple patterns for restoring an individual tenant's data.</span></span> <span data-ttu-id="b09d5-122">Ponieważ dzierżawy baz danych są od siebie odizolowane, Przywracanie jednego dzierżawcy nie ma wpływu na dane żadnych innych dzierżawców.</span><span class="sxs-lookup"><span data-stu-id="b09d5-122">Because tenant databases are isolated from each other, restoring one tenant has no impact on any other tenant's data.</span></span>

<span data-ttu-id="b09d5-123">We wzorcu pierwsze dane są przywracane do nowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-123">In the first pattern, data is restored into a new database.</span></span> <span data-ttu-id="b09d5-124">Dzierżawca jest następnie uzyskać dostęp do tej bazy danych wraz z ich danych produkcyjnych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-124">The tenant is then given access to this database alongside their production data.</span></span> <span data-ttu-id="b09d5-125">Ten wzorzec umożliwia administratora dzierżawy przejrzeć przywróconych danych i potencjalnie Użyj selektywnie zastąpić bieżące wartości danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-125">This pattern allows a tenant admin to review the restored data and potentially use it to selectively overwrite current data values.</span></span> <span data-ttu-id="b09d5-126">To projektanta aplikacji SaaS, aby określić, jak zaawansowane opcje odzyskiwania danych powinien być.</span><span class="sxs-lookup"><span data-stu-id="b09d5-126">It's up to the SaaS app designer to determine just how sophisticated the data recovery options should be.</span></span> <span data-ttu-id="b09d5-127">Po prostu możliwość sprawdzenia danych w stanie, który znajdował się w danym punkcie w czasie może być wszystko, czego jest wymagany w niektórych scenariuszach.</span><span class="sxs-lookup"><span data-stu-id="b09d5-127">Simply being able to review data in the state it was in at a given point in time may be all that is required in some scenarios.</span></span> <span data-ttu-id="b09d5-128">Jeśli baza danych używa [— replikacja geograficzna](sql-database-geo-replication-overview.md), zaleca się kopiowanie wymaganych danych z przywróconej kopii do oryginalnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-128">If the database uses [geo-replication](sql-database-geo-replication-overview.md), we recommend copying the required data from the restored copy into the original database.</span></span> <span data-ttu-id="b09d5-129">Można zastąpić oryginalnej bazy danych przywróconej bazy danych, musisz skonfigurować ponownie i przeprowadź ponowną synchronizację — replikacja geograficzna.</span><span class="sxs-lookup"><span data-stu-id="b09d5-129">If you replace the original database with the restored database, you need to reconfigure and resynchronize geo-replication.</span></span>

<span data-ttu-id="b09d5-130">W drugim wzorcu przyjęto założenie, że dzierżawy poniosła utraty lub uszkodzenia danych, dzierżawcy w produkcyjnej bazie danych zostanie przywrócona do wcześniejszego punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="b09d5-130">In the second pattern, which assumes that the tenant has suffered a loss or corruption of data, the tenant’s production database is restored to a prior point in time.</span></span> <span data-ttu-id="b09d5-131">W ramach operacji przywracania we wzorcu miejsce dzierżawcy do trybu offline przez krótki czas, gdy baza danych jest przywracane i przywrócony do trybu online.</span><span class="sxs-lookup"><span data-stu-id="b09d5-131">In the restore in place pattern, the tenant is taken offline for a brief time while the database is restored and brought back online.</span></span> <span data-ttu-id="b09d5-132">Oryginalnej bazy danych zostanie usunięty, ale nadal można przywrócić z, aby wrócić do nawet wcześniejszego punktu w czasie.</span><span class="sxs-lookup"><span data-stu-id="b09d5-132">The original database is deleted, but can still be restored from if you need to go back to an even earlier point in time.</span></span> <span data-ttu-id="b09d5-133">Zmiany tego wzorca można zmienić nazwy bazy danych zamiast usuwania, mimo że zmiana nazwy bazy danych oferuje nie dodatkowych zalet pod względem zabezpieczeń danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-133">A variation of this pattern could rename the database instead of deleting it, although renaming the database offers no additional advantage in terms of data security.</span></span>

## <a name="get-the-wingtip-application-scripts"></a><span data-ttu-id="b09d5-134">Pobieranie skryptów aplikacji Wingtip</span><span class="sxs-lookup"><span data-stu-id="b09d5-134">Get the Wingtip application scripts</span></span>

<span data-ttu-id="b09d5-135">Wingtip SaaS skrypty i kod źródłowy aplikacji są dostępne w [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repozytorium github.</span><span class="sxs-lookup"><span data-stu-id="b09d5-135">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="b09d5-136">[Kroki, aby pobrać skrypty Wingtip SaaS](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="b09d5-136">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="simulate-a-tenant-accidentally-deleting-data"></a><span data-ttu-id="b09d5-137">Symulowanie dzierżawcy przypadkowego usunięcia danych</span><span class="sxs-lookup"><span data-stu-id="b09d5-137">Simulate a tenant accidentally deleting data</span></span>

<span data-ttu-id="b09d5-138">Aby zademonstrować tych scenariuszy odzyskiwania, musimy *przypadkowo* usuwać niektóre dane w jednej z baz danych dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="b09d5-138">To demonstrate these recovery scenarios, we need to *accidentally* delete some data in one of the tenant databases.</span></span> <span data-ttu-id="b09d5-139">Podczas gdy można usunąć rekordu, następnym krokiem konfiguruje pokaz do nie pobrać zablokowane przez naruszenie integralności referencyjnej!</span><span class="sxs-lookup"><span data-stu-id="b09d5-139">While you can delete any record, the next step sets up the demo to not get blocked by referential integrity violations!</span></span> <span data-ttu-id="b09d5-140">Dodaje również pewne dane zakupu biletu służy później w *samouczki Wingtip SaaS Analytics*.</span><span class="sxs-lookup"><span data-stu-id="b09d5-140">It also adds some ticket purchase data you can use later in the *Wingtip SaaS Analytics tutorials*.</span></span>

<span data-ttu-id="b09d5-141">Uruchom skrypt generator biletu i utworzyć dodatkowe dane.</span><span class="sxs-lookup"><span data-stu-id="b09d5-141">Run the ticket generator script and create additional data.</span></span> <span data-ttu-id="b09d5-142">Generator biletu nie celowo zakupu biletów dla poszczególnych dzierżawców ostatniego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="b09d5-142">The ticket generator intentionally does not purchase tickets for each tenants last event.</span></span>

1. <span data-ttu-id="b09d5-143">Otwórz... \\Modułów szkoleniowych\\narzędzia\\*TicketGenerator.ps1 pokaz* w *programu PowerShell ISE*</span><span class="sxs-lookup"><span data-stu-id="b09d5-143">Open ...\\Learning Modules\\Utilities\\*Demo-TicketGenerator.ps1* in the *PowerShell ISE*</span></span>
1. <span data-ttu-id="b09d5-144">Naciśnij klawisz **F5** do uruchomienia skryptu i generowania odbiorców i biletu danych sprzedaży.</span><span class="sxs-lookup"><span data-stu-id="b09d5-144">Press **F5** to run the script and generate customers and ticket sales data.</span></span>


### <a name="open-the-events-app-to-review-the-current-events"></a><span data-ttu-id="b09d5-145">Otwórz aplikację zdarzeń do przeglądania zdarzeń bieżącego</span><span class="sxs-lookup"><span data-stu-id="b09d5-145">Open the Events app to review the current events</span></span>

1. <span data-ttu-id="b09d5-146">Otwórz *Centrum zdarzeń* (http://events.wtp.&lt; Użytkownik&gt;. trafficmanager.net) i kliknij przycisk **Hall porozumieniu Contoso**:</span><span class="sxs-lookup"><span data-stu-id="b09d5-146">Open the *Events Hub* (http://events.wtp.&lt;user&gt;.trafficmanager.net) and click **Contoso Concert Hall**:</span></span>

   ![centrum zdarzeń](media/sql-database-saas-tutorial-restore-single-tenant/events-hub.png)

1. <span data-ttu-id="b09d5-148">Przewiń listę zdarzeń i zanotuj ostatnie zdarzenie na liście:</span><span class="sxs-lookup"><span data-stu-id="b09d5-148">Scroll the list of events and make a note of the last event in the list:</span></span>

   ![Ostatnie zdarzenie](media/sql-database-saas-tutorial-restore-single-tenant/last-event.png)


### <a name="run-the-demo-scenario-to-accidentally-delete-the-last-event"></a><span data-ttu-id="b09d5-150">Uruchom scenariusz pokaz przypadkowo usunął ostatniego zdarzenia</span><span class="sxs-lookup"><span data-stu-id="b09d5-150">Run the demo scenario to accidentally delete the last event</span></span>

1. <span data-ttu-id="b09d5-151">Otwórz... \\Modułów szkoleniowych\\ciągłość prowadzenia działalności biznesowej i odzyskiwania po awarii\\RestoreTenant\\*RestoreTenant.ps1 pokaz* w *programu PowerShell ISE*i ustawić następującą wartość:</span><span class="sxs-lookup"><span data-stu-id="b09d5-151">Open ...\\Learning Modules\\Business Continuity and Disaster Recovery\\RestoreTenant\\*Demo-RestoreTenant.ps1* in the *PowerShell ISE*, and set the following value:</span></span>
   * <span data-ttu-id="b09d5-152">**$DemoScenario** = **1**, ustawioną **1** -Usuń zdarzenia bez sprzedaży biletów.</span><span class="sxs-lookup"><span data-stu-id="b09d5-152">**$DemoScenario** = **1**, Set to **1** - Delete events with no ticket sales.</span></span>
1. <span data-ttu-id="b09d5-153">Naciśnij klawisz **F5** Uruchom skrypt i usunąć ostatniego zdarzenia.</span><span class="sxs-lookup"><span data-stu-id="b09d5-153">Press **F5** to run the script and delete the last event.</span></span> <span data-ttu-id="b09d5-154">Powinien zostać wyświetlony komunikat potwierdzający podobny do następującego:</span><span class="sxs-lookup"><span data-stu-id="b09d5-154">You should see a confirmation message similar to the following:</span></span>

   ```Console
   Deleting unsold events from Contoso Concert Hall ...
   Deleted event 'Seriously Strauss' from Contoso Concert Hall venue.
   ```

1. <span data-ttu-id="b09d5-155">Zostanie otwarta strona zdarzenia Contoso.</span><span class="sxs-lookup"><span data-stu-id="b09d5-155">The Contoso events page opens.</span></span> <span data-ttu-id="b09d5-156">Przewiń w dół i sprawdź, czy zdarzenie został usunięty.</span><span class="sxs-lookup"><span data-stu-id="b09d5-156">Scroll down and verify the event is gone.</span></span> <span data-ttu-id="b09d5-157">Jeśli zdarzenie jest nadal na liście, kliknij przycisk Odśwież i sprawdź, czy został on usunięty.</span><span class="sxs-lookup"><span data-stu-id="b09d5-157">If the event is still in the list, click refresh and verify it is gone.</span></span>

   ![Ostatnie zdarzenie](media/sql-database-saas-tutorial-restore-single-tenant/last-event-deleted.png)


## <a name="restore-a-tenant-database-in-parallel-with-the-production-database"></a><span data-ttu-id="b09d5-159">Przywróć bazę danych dzierżawy równolegle z produkcyjną bazę danych</span><span class="sxs-lookup"><span data-stu-id="b09d5-159">Restore a tenant database in parallel with the production database</span></span>

<span data-ttu-id="b09d5-160">Tego ćwiczenia przywraca bazę danych Hall porozumieniu Contoso do punktu w czasie, zanim zdarzenie zostało usunięte.</span><span class="sxs-lookup"><span data-stu-id="b09d5-160">This exercise restores the Contoso Concert Hall database to a point in time before the event was deleted.</span></span> <span data-ttu-id="b09d5-161">Po usunięciu zdarzenia w poprzednich krokach chcesz odzyskać, a następnie zobacz usunięte dane.</span><span class="sxs-lookup"><span data-stu-id="b09d5-161">After the event is deleted in the previous steps, you want to recover and see the deleted data.</span></span> <span data-ttu-id="b09d5-162">Nie trzeba przywrócić bazę danych produkcyjnych z usunięty rekord, ale należy przywrócić bazę danych starego dostęp do starych danych z innych powodów biznesowych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-162">You don't need to restore your production database with the deleted record, but you need to recover the old database to access the old data for other business reasons.</span></span>

 <span data-ttu-id="b09d5-163">*TenantInParallel.ps1 przywracania* skrypt tworzy równoległych dzierżawy bazy danych i równoległych wpisu katalogu zarówno o nazwie *ContosoConcertHall\_starego*.</span><span class="sxs-lookup"><span data-stu-id="b09d5-163">The *Restore-TenantInParallel.ps1* script creates a parallel tenant database, and a parallel catalog entry both named *ContosoConcertHall\_old*.</span></span> <span data-ttu-id="b09d5-164">Ten wzorzec przywracania jest najodpowiedniejsze do odzyskiwania danych po utracie danych drobne lub zgodności i inspekcji scenariuszy odzyskiwania.</span><span class="sxs-lookup"><span data-stu-id="b09d5-164">This pattern of restore is best suited for recovering from a minor data loss or for compliance and auditing recovery scenarios.</span></span> <span data-ttu-id="b09d5-165">Jest również zalecane podejście gdy używasz [— replikacja geograficzna](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b09d5-165">It is also the recommended approach when you are using [geo-replication](sql-database-geo-replication-overview.md).</span></span>

1. <span data-ttu-id="b09d5-166">Zakończenie [symulować użytkownika przypadkowego usunięcia danych](#simulate-a-tenant-accidentally-deleting-data) sekcji.</span><span class="sxs-lookup"><span data-stu-id="b09d5-166">Complete the [simulate a user accidentally deleting data](#simulate-a-tenant-accidentally-deleting-data) section.</span></span>
1. <span data-ttu-id="b09d5-167">Otwórz... \\Modułów szkoleniowych\\ciągłość prowadzenia działalności biznesowej i odzyskiwania po awarii\\RestoreTenant\\_RestoreTenant.ps1 pokaz_ w *programu PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="b09d5-167">Open ...\\Learning Modules\\Business Continuity and Disaster Recovery\\RestoreTenant\\_Demo-RestoreTenant.ps1_ in the *PowerShell ISE*.</span></span>
1. <span data-ttu-id="b09d5-168">Ustaw **$DemoScenario** = **2**, ustaw tę wartość na **2** do *dzierżawy przywracania równolegle*.</span><span class="sxs-lookup"><span data-stu-id="b09d5-168">Set **$DemoScenario** = **2**, Set this to **2** to *Restore tenant in parallel*.</span></span>
1. <span data-ttu-id="b09d5-169">Naciśnij klawisz **F5**, aby uruchomić skrypt.</span><span class="sxs-lookup"><span data-stu-id="b09d5-169">Press **F5** to run the script.</span></span>

<span data-ttu-id="b09d5-170">Skrypt przywraca bazę danych dzierżawy (do równoległego bazy danych) do punktu w czasie, aby usunąć zdarzenie w poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="b09d5-170">The script restores the tenant database (to a parallel database) to a point in time before you deleted the event in the previous section.</span></span> <span data-ttu-id="b09d5-171">Tworzy drugi bazę danych, spowoduje usunięcie wszystkich istniejących metadanych katalogu, które istnieje w tej bazie danych i dodaje do katalogu w bazie danych *ContosoConcertHall\_starego* wpisu.</span><span class="sxs-lookup"><span data-stu-id="b09d5-171">It creates a second database, removes any existing catalog metadata that exists in this database, and adds the database to the catalog under the *ContosoConcertHall\_old* entry.</span></span>

<span data-ttu-id="b09d5-172">Pokaz skryptu spowoduje otwarcie strony zdarzeń w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="b09d5-172">The demo script opens the events page in your browser.</span></span> <span data-ttu-id="b09d5-173">Uwaga z adresu URL: ```http://events.wtp.&lt;user&gt;.trafficmanager.net/contosoconcerthall_old``` czy jest to wyświetlanie danych z przywróconej bazy danych gdzie *_old* jest dodawany do nazwy.</span><span class="sxs-lookup"><span data-stu-id="b09d5-173">Note from the URL: ```http://events.wtp.&lt;user&gt;.trafficmanager.net/contosoconcerthall_old``` that this is showing data from the restored database where *_old* is added to the name.</span></span>

<span data-ttu-id="b09d5-174">Przywrócono przewijania zdarzenia wyświetlane w przeglądarce, aby potwierdzić, że zdarzenie usunięte w poprzedniej sekcji.</span><span class="sxs-lookup"><span data-stu-id="b09d5-174">Scroll the events listed in the browser to confirm that the event deleted in the previous section has been restored.</span></span>

<span data-ttu-id="b09d5-175">Należy pamiętać, że udostępnianie przywróconej dzierżawy jako dodatkowe dzierżawy, z własnej aplikacji zdarzeń do przeglądania biletów, jest mało prawdopodobne, aby jak może zapewnić dzierżawcy dostęp do przywrócić dane, może jednak łatwo ilustrujący wzorzec przywracania.</span><span class="sxs-lookup"><span data-stu-id="b09d5-175">Note that exposing the restored tenant as an additional tenant, with its own Events app to browse tickets, is unlikely to be how you would provide a tenant access to restored data, but serves to easily illustrate the restore pattern.</span></span>

<span data-ttu-id="b09d5-176">W rzeczywistości ma prawdopodobnie tylko zachowanie tej przywróconej bazy danych w zdefiniowanym okresie.</span><span class="sxs-lookup"><span data-stu-id="b09d5-176">In reality, you would probably only retain this restored database for a defined period.</span></span> <span data-ttu-id="b09d5-177">Można usunąć wpisu przywróconej dzierżawy, po zakończeniu przez wywołanie metody *RestoredTenant.ps1 Usuń* skryptu.</span><span class="sxs-lookup"><span data-stu-id="b09d5-177">You can delete the restored tenant entry once you are finished by calling the *Remove-RestoredTenant.ps1* script.</span></span>

1. <span data-ttu-id="b09d5-178">Ustaw **$DemoScenario** do **4** wybierz *dzierżawy Usuń przywrócić* scenariusza.</span><span class="sxs-lookup"><span data-stu-id="b09d5-178">Set **$DemoScenario** to **4** to select the *remove restored tenant* scenario.</span></span>
1. <span data-ttu-id="b09d5-179">**Wykonanie** **przy użyciu** **F5**</span><span class="sxs-lookup"><span data-stu-id="b09d5-179">**Execute** **using** **F5**</span></span>
1. <span data-ttu-id="b09d5-180">*ContosoConcertHall\_starego* wpis jest teraz usunięty z katalogu.</span><span class="sxs-lookup"><span data-stu-id="b09d5-180">The *ContosoConcertHall\_old* entry is now deleted from the catalog.</span></span> <span data-ttu-id="b09d5-181">Przejdź dalej i zamknij stronę zdarzeń dla tej dzierżawy w przeglądarce.</span><span class="sxs-lookup"><span data-stu-id="b09d5-181">Go ahead and close the events page for this tenant in your browser.</span></span>


## <a name="restore-a-tenant-in-place-replacing-the-existing-tenant-database"></a><span data-ttu-id="b09d5-182">Przywróć dzierżawcy w miejscu, zastępując istniejące bazy danych dzierżawy</span><span class="sxs-lookup"><span data-stu-id="b09d5-182">Restore a tenant in place, replacing the existing tenant database</span></span>

<span data-ttu-id="b09d5-183">Tego ćwiczenia przywraca dzierżawy Hall porozumieniu Contoso do punktu w czasie, zanim zdarzenie zostało usunięte.</span><span class="sxs-lookup"><span data-stu-id="b09d5-183">This exercise restores the Contoso Concert Hall tenant to a point in time before the event was deleted.</span></span> <span data-ttu-id="b09d5-184">*TenantInPlace przywracania* skryptu przywrócenie bieżącej bazy danych dzierżawy nową bazę danych, wskazując wcześniejszego punktu w czasie i usuwa oryginalnej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-184">The *Restore-TenantInPlace* script restores the current tenant database to a new database pointing to a previous point in time, and deletes the original database.</span></span> <span data-ttu-id="b09d5-185">Ten wzorzec przywracania najlepiej nadaje się do odzyskiwania danych poważne uszkodzenie jako może być utracie dużej ilości danych, które musi obsłużyć dzierżawcy.</span><span class="sxs-lookup"><span data-stu-id="b09d5-185">This pattern of restore is best suited for recovering from serious data corruption as there may be significant data loss that the tenant would have to accommodate.</span></span>

1. <span data-ttu-id="b09d5-186">Otwórz **RestoreTenant.ps1 pokaz** pliku w programie PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="b09d5-186">Open **Demo-RestoreTenant.ps1** file in PowerShell ISE</span></span>
1. <span data-ttu-id="b09d5-187">Ustaw **$DemoScenario** do **5** wybierz *przywrócić dzierżawy w scenariuszu miejscu*.</span><span class="sxs-lookup"><span data-stu-id="b09d5-187">Set **$DemoScenario** to **5** to select the *restore tenant in place scenario*.</span></span>
1. <span data-ttu-id="b09d5-188">Wykonywanie za pomocą **F5**.</span><span class="sxs-lookup"><span data-stu-id="b09d5-188">Execute using **F5**.</span></span>

<span data-ttu-id="b09d5-189">Skrypt przywraca bazę danych dzierżawy do punktu, pięć minut, zanim zdarzenie zostało usunięte.</span><span class="sxs-lookup"><span data-stu-id="b09d5-189">The script restores the tenant database to a point five minutes before the event was deleted.</span></span> <span data-ttu-id="b09d5-190">Robi to wykonując pierwszy dzierżawy Hall porozumieniu firmy Contoso w trybie offline, więc są dostępne żadne dodatkowe aktualizacje danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-190">It does this by first taking the Contoso Concert Hall tenant offline so there are no further updates to the data.</span></span> <span data-ttu-id="b09d5-191">Następnie równoległych bazy danych jest tworzone przez przywrócenie z punktu przywracania i o nazwie z sygnaturą czasową w celu zapewnienia, że nazwa bazy danych nie powoduje konfliktu z istniejącą nazwą bazy danych dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="b09d5-191">Then, a parallel database is created by restoring from the restore point and named with a timestamp to ensure the database name does not conflict with the existing tenant database name.</span></span> <span data-ttu-id="b09d5-192">Następnie utrzymując bazę danych dzierżawy zostanie usunięta, a następnie przywrócona baza danych została zmieniona na oryginalną nazwę bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-192">Next, the old tenant database is deleted, and the restored database is renamed to the original database name.</span></span> <span data-ttu-id="b09d5-193">Na koniec Hall porozumieniu Contoso jest przełączony w tryb online umożliwia aplikacji dostęp do przywróconej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b09d5-193">Finally, Contoso Concert Hall is brought online to allow the app access to the restored database.</span></span>

<span data-ttu-id="b09d5-194">Pomyślnie przywrócono bazy danych do punktu w czasie, zanim zdarzenie zostało usunięte.</span><span class="sxs-lookup"><span data-stu-id="b09d5-194">You successfully restored the database to a point in time before the event was deleted.</span></span> <span data-ttu-id="b09d5-195">Zostanie otwarta strona zdarzeń, dlatego upewnij się, przez ostatnie zdarzenie zostało przywrócone.</span><span class="sxs-lookup"><span data-stu-id="b09d5-195">The Events page opens, so confirm the last event has been restored.</span></span>


## <a name="next-steps"></a><span data-ttu-id="b09d5-196">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="b09d5-196">Next steps</span></span>

<span data-ttu-id="b09d5-197">W niniejszym samouczku zawarto informacje na temat wykonywania następujących czynności:</span><span class="sxs-lookup"><span data-stu-id="b09d5-197">In this tutorial, you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="b09d5-198">Przywróć bazę danych do bazy danych równoległej (side-by-side)</span><span class="sxs-lookup"><span data-stu-id="b09d5-198">Restore a database into a parallel database (side-by-side)</span></span>
> * <span data-ttu-id="b09d5-199">Przywracanie bazy danych w miejscu</span><span class="sxs-lookup"><span data-stu-id="b09d5-199">Restore a database in place</span></span>

[<span data-ttu-id="b09d5-200">Zarządzanie dzierżawy schematu bazy danych</span><span class="sxs-lookup"><span data-stu-id="b09d5-200">Manage tenant database schema</span></span>](sql-database-saas-tutorial-schema-management.md)

## <a name="additional-resources"></a><span data-ttu-id="b09d5-201">Dodatkowe zasoby</span><span class="sxs-lookup"><span data-stu-id="b09d5-201">Additional resources</span></span>

* <span data-ttu-id="b09d5-202">Dodatkowe [samouczków, z którymi aplikacji Wingtip SaaS](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="b09d5-202">Additional [tutorials that build upon the Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="b09d5-203">Omówienie ciągłości działalności biznesowej z bazy danych SQL Azure</span><span class="sxs-lookup"><span data-stu-id="b09d5-203">Overview of business continuity with Azure SQL Database</span></span>](sql-database-business-continuity.md)
* [<span data-ttu-id="b09d5-204">Więcej informacji na temat tworzenia kopii zapasowych bazy danych SQL</span><span class="sxs-lookup"><span data-stu-id="b09d5-204">Learn about SQL Database backups</span></span>](sql-database-automated-backups.md)
