---
title: "Uaktualnianie aplikacji aaaRolling — baza danych SQL Azure | Dokumentacja firmy Microsoft"
description: "Dowiedz się, jak toouse replikacja geograficzna bazy danych SQL Azure toosupport online uaktualnień aplikacji w chmurze."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a><span data-ttu-id="b651a-103">Zarządzanie stopniowe aplikacji w chmurze przy użyciu aktywna replikacja geograficzna bazy danych SQL</span><span class="sxs-lookup"><span data-stu-id="b651a-103">Managing rolling upgrades of cloud applications using SQL Database active geo-replication</span></span>
> [!NOTE]
> <span data-ttu-id="b651a-104">[Aktywna replikacja geograficzna](sql-database-geo-replication-overview.md) jest teraz dostępna dla wszystkich baz danych w warstwach wszystkie.</span><span class="sxs-lookup"><span data-stu-id="b651a-104">[Active geo-replication](sql-database-geo-replication-overview.md) is now available for all databases in all tiers.</span></span>
> 

<span data-ttu-id="b651a-105">Dowiedz się, jak toouse [— replikacja geograficzna](sql-database-geo-replication-overview.md) w tooenable bazy danych SQL wprowadzanie uaktualnień aplikacji w chmurze.</span><span class="sxs-lookup"><span data-stu-id="b651a-105">Learn how toouse [geo-replication](sql-database-geo-replication-overview.md) in SQL Database tooenable rolling upgrades of your cloud application.</span></span> <span data-ttu-id="b651a-106">Ponieważ uaktualnienie jest dużo operacji, należy go części projektowania i planowania ciągłości biznesowej.</span><span class="sxs-lookup"><span data-stu-id="b651a-106">Because upgrade is a disruptive operation, it should be part of your business continuity planning and design.</span></span> <span data-ttu-id="b651a-107">W tym artykule, który opisano dwie różne metody organizowanie hello proces uaktualniania, a omówimy korzyści hello i kompromisy każdej z nich.</span><span class="sxs-lookup"><span data-stu-id="b651a-107">In this article we look at two different methods of orchestrating hello upgrade process, and discuss hello benefits and trade-offs of each option.</span></span> <span data-ttu-id="b651a-108">Dla celów hello w tym artykule używamy prostą aplikację, która składa się z witryny sieci web połączonych tooa pojedynczej bazy danych jako jego warstwy danych.</span><span class="sxs-lookup"><span data-stu-id="b651a-108">For hello purposes of this article we will use a simple application that consists of a web site connected tooa single database as its data tier.</span></span> <span data-ttu-id="b651a-109">Naszym celem jest tooupgrade wersja 1 tooversion aplikacji hello 2 bez znacznego wpływu na środowisko pracy użytkownika końcowego hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-109">Our goal is tooupgrade version 1 of hello application tooversion 2 without any significant impact on hello end-user experience.</span></span> 

<span data-ttu-id="b651a-110">Podczas obliczania hello opcje uaktualniania należy rozważyć hello następujące czynniki:</span><span class="sxs-lookup"><span data-stu-id="b651a-110">When evaluating hello upgrade options you should consider hello following factors:</span></span>

* <span data-ttu-id="b651a-111">Wpływ na dostępność aplikacji podczas uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="b651a-111">Impact on application availability during upgrades.</span></span> <span data-ttu-id="b651a-112">Jak długo funkcja aplikacji hello może być ograniczony lub nieprawidłowego działania.</span><span class="sxs-lookup"><span data-stu-id="b651a-112">How long hello application function may be limited or degraded.</span></span>
* <span data-ttu-id="b651a-113">Możliwość tooroll wstecz na wypadek niepowodzenia uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b651a-113">Ability tooroll back in case of an upgrade failure.</span></span>
* <span data-ttu-id="b651a-114">Luki w zabezpieczeniach aplikacji hello po wystąpieniu błędu krytycznego niepowiązanych podczas uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-114">Vulnerability of hello application if an unrelated catastrophic failure occurs during hello upgrade.</span></span>
* <span data-ttu-id="b651a-115">Dolar całkowity koszt.</span><span class="sxs-lookup"><span data-stu-id="b651a-115">Total dollar cost.</span></span>  <span data-ttu-id="b651a-116">Obejmuje to dodatkowa Redundancja i przyrostowe kosztów składników tymczasowego hello używanych przez proces uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-116">This includes additional redundancy and incremental costs of hello temporary components  used by hello upgrade process.</span></span> 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a><span data-ttu-id="b651a-117">Uaktualnianie aplikacji, które opierają się na kopie zapasowe bazy danych dla odzyskiwania po awarii</span><span class="sxs-lookup"><span data-stu-id="b651a-117">Upgrading applications that rely on database backups for disaster recovery</span></span>
<span data-ttu-id="b651a-118">Jeśli aplikacji opiera się na automatyczne bazy danych kopii zapasowych i używa geograficzne do odzyskiwania po awarii, jest zazwyczaj wdrożonej tooa pojedynczy region platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="b651a-118">If your application relies on automatic database backups and uses geo-restore for disaster recovery, it is usually deployed tooa single Azure region.</span></span> <span data-ttu-id="b651a-119">W takim przypadku proces uaktualniania hello obejmuje utworzenie kopii zapasowej wdrożenia wszystkich składników aplikacji objętego hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b651a-119">In this case hello upgrade process involves creating a backup deployment of all application components involved in hello upgrade.</span></span> <span data-ttu-id="b651a-120">Menedżer ruchu Azure (WATM) będzie korzystać z profilem trybu failover hello zakłóceń użytkownika końcowego hello toominimize.</span><span class="sxs-lookup"><span data-stu-id="b651a-120">toominimize hello end-user disruption you will leverage Azure Traffic Manager (WATM) with hello failover profile.</span></span>  <span data-ttu-id="b651a-121">powitania po diagram ilustruje proces uaktualniania hello środowisko operacyjne wcześniejsze toohello.</span><span class="sxs-lookup"><span data-stu-id="b651a-121">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="b651a-122">Witaj punktu końcowego <i>contoso 1.azurewebsites.net</i> reprezentuje gnieździe produkcyjnym aplikacji hello, która potrzebuje toobe uaktualniony.</span><span class="sxs-lookup"><span data-stu-id="b651a-122">hello endpoint <i>contoso-1.azurewebsites.net</i> represents a production slot of hello application that needs toobe upgraded.</span></span> <span data-ttu-id="b651a-123">ponownie tooroll możliwości hello tooenable hello uaktualnienia, należy Utwórz miejsce etap kopię pełni zsynchronizowanych aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-123">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="b651a-124">Hello poniższe kroki są wymagane tooprepare hello aplikacji hello uaktualnienia:</span><span class="sxs-lookup"><span data-stu-id="b651a-124">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="b651a-125">Utwórz miejsce etap hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b651a-125">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="b651a-126">toodo tworzenie pomocniczej bazy danych (1), a następnie wdrożona identyczne witryny hello tego samego regionu systemu Azure.</span><span class="sxs-lookup"><span data-stu-id="b651a-126">toodo that create a secondary database (1) and deploy an identical web site in hello same Azure region.</span></span> <span data-ttu-id="b651a-127">Monitorowanie toosee dodatkowej hello Jeśli hello wstępne wypełnianie procesu zostało ukończone.</span><span class="sxs-lookup"><span data-stu-id="b651a-127">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="b651a-128">Utwórz profil trybu failover w WATM z <i>contoso 1.azurewebsites.net</i> jako punkt końcowy w trybie online i <i>contoso 2.azurewebsites.net</i> w trybie offline.</span><span class="sxs-lookup"><span data-stu-id="b651a-128">Create a failover profile in WATM with <i>contoso-1.azurewebsites.net</i> as online endpoint and <i>contoso-2.azurewebsites.net</i> as offline.</span></span> 

> [!NOTE]
> <span data-ttu-id="b651a-129">Czynności przygotowujące hello Uwaga nie ma wpływu aplikacji hello w gnieździe produkcyjnym hello i może działać w trybie pełnego dostępu.</span><span class="sxs-lookup"><span data-stu-id="b651a-129">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
>  

![Konfiguracja replikacji Przejdź bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

<span data-ttu-id="b651a-132">Po wykonaniu czynności przygotowujące hello aplikacji hello jest gotowy do uaktualnienia rzeczywiste hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-132">Once hello preparation steps are completed hello application is ready for hello actual upgrade.</span></span> <span data-ttu-id="b651a-133">powitania po diagram ilustruje hello etapy hello procesu uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="b651a-133">hello following diagram illustrates hello steps involved in hello upgrade process.</span></span> 

1. <span data-ttu-id="b651a-134">Ustaw hello podstawowej bazy danych w hello produkcji miejsca tylko tooread tryb [3].</span><span class="sxs-lookup"><span data-stu-id="b651a-134">Set hello primary database in hello production slot tooread-only mode (3).</span></span> <span data-ttu-id="b651a-135">Gwarantuje to, że hello produkcji wystąpienie aplikacji hello (wersja 1) pozostanie tylko do odczytu podczas uaktualniania hello zindeksowanie hello danych rozbieżności między hello V1 i V2 wystąpień bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b651a-135">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="b651a-136">Odłącz dodatkowej bazy danych hello w trybie hello planowane zakończenie (4).</span><span class="sxs-lookup"><span data-stu-id="b651a-136">Disconnect hello secondary database using hello planned termination mode (4).</span></span> <span data-ttu-id="b651a-137">Utworzy on pełni zsynchronizowanej kopii niezależne hello podstawowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b651a-137">It will create a fully synchronized independent copy of hello primary database.</span></span> <span data-ttu-id="b651a-138">Ta baza danych zostanie uaktualniona.</span><span class="sxs-lookup"><span data-stu-id="b651a-138">This database will be upgraded.</span></span>
3. <span data-ttu-id="b651a-139">Włącz tryb zapisu tooread podstawowej bazy danych hello, a następnie uruchom skrypt uaktualnienia hello w gnieździe etap hello [5].</span><span class="sxs-lookup"><span data-stu-id="b651a-139">Turn hello primary database tooread-write mode and run hello upgrade script in hello stage slot  (5).</span></span>     

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

<span data-ttu-id="b651a-142">Jeśli aktualizacja hello zakończyła się pomyślnie wszystko jest teraz gotowy tooswitch hello użytkownicy końcowi toohello przemieszczane kopiowania hello aplikacji.</span><span class="sxs-lookup"><span data-stu-id="b651a-142">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello staged copy hello application.</span></span> <span data-ttu-id="b651a-143">Teraz będzie gotowa do miejsca produkcji hello aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-143">It will now become hello production slot of hello application.</span></span>  <span data-ttu-id="b651a-144">Ten proces obejmuje kilka kroków więcej zgodnie z opisami na powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="b651a-144">This involves a few more steps as illustrated on hello following diagram.</span></span>

1. <span data-ttu-id="b651a-145">Przełącz hello online punktu końcowego w profilu WATM hello zbyt<i>contoso 2.azurewebsites.net</i>, wersji toohello V2 punktów hello witryny sieci web (6).</span><span class="sxs-lookup"><span data-stu-id="b651a-145">Switch hello online endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which points toohello V2 version of hello web site (6).</span></span> <span data-ttu-id="b651a-146">Staje się teraz gniazda produkcyjnego hello z hello aplikacji V2 i ruch przez użytkownika końcowego hello jest tooit bezpośrednie.</span><span class="sxs-lookup"><span data-stu-id="b651a-146">It now becomes hello production slot with hello V2 application and hello end-user traffic is directed tooit.</span></span>  
2. <span data-ttu-id="b651a-147">Jeśli nie są już potrzebne składniki aplikacji hello V1, możesz bezpiecznie usunąć je (7).</span><span class="sxs-lookup"><span data-stu-id="b651a-147">If you no longer need hello V1 application components so you can safely remove them (7).</span></span>   

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

<span data-ttu-id="b651a-150">Jeśli proces uaktualniania hello zakończy się niepowodzeniem, na przykład ze względu na błąd tooan skryptów uaktualniania hello, hello etap miejsca należy traktować jako naruszenia zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="b651a-150">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="b651a-151">tooroll kopii hello toohello przed uaktualnieniem stanu aplikacji po prostu przywrócić aplikacji hello w hello produkcji miejsca toofull dostępu.</span><span class="sxs-lookup"><span data-stu-id="b651a-151">tooroll back hello application toohello pre-upgrade state you simply revert hello application in hello production slot toofull access.</span></span> <span data-ttu-id="b651a-152">etapy Hello są wyświetlane na diagramie dalej hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-152">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="b651a-153">Ustaw hello trybu tooread zapisu kopii bazy danych (8).</span><span class="sxs-lookup"><span data-stu-id="b651a-153">Set hello database copy tooread-write mode (8).</span></span> <span data-ttu-id="b651a-154">Spowoduje to przywrócenie hello pełne V1 funkcjonalnie w gnieździe produkcyjnym hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-154">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="b651a-155">Analiza Przyczyna hello głównego i usunąć składniki hello naruszone w gnieździe etap hello (9).</span><span class="sxs-lookup"><span data-stu-id="b651a-155">Perform hello root cause analysis and remove hello compromised components in hello stage slot (9).</span></span> 

<span data-ttu-id="b651a-156">W tym momencie aplikacji hello jest w pełni funkcjonalny i kroki uaktualniania hello można powtarzać.</span><span class="sxs-lookup"><span data-stu-id="b651a-156">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="b651a-157">Witaj wycofywania nie wymaga zmian w profilu WATM jako już wskazuje zbyt<i>contoso 1.azurewebsites.net</i> jako hello aktywny punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="b651a-157">hello rollback does not require changes in WATM profile as it already points too<i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

<span data-ttu-id="b651a-160">klucz Hello **korzyści** tej opcji jest uaktualnienie aplikacji w pojedynczym regionie przy użyciu zestawu prostych krokach.</span><span class="sxs-lookup"><span data-stu-id="b651a-160">hello key **advantage** of this option is that you can upgrade an application in a single region using a set of simple steps.</span></span> <span data-ttu-id="b651a-161">Koszt dolara Hello uaktualnienia hello jest stosunkowo niska.</span><span class="sxs-lookup"><span data-stu-id="b651a-161">hello dollar cost of hello upgrade is relatively low.</span></span> <span data-ttu-id="b651a-162">Witaj głównego **zależnościami** jest, że jeśli wystąpi błąd krytyczny podczas stan sprzed uaktualnienia toohello hello hello uaktualnienia odzyskiwania będzie obejmować ponownego wdrażania aplikacji hello w innym regionie i przywracania hello bazy danych z Tworzenie kopii zapasowej korzystającej z przywracaniem geograficznym.</span><span class="sxs-lookup"><span data-stu-id="b651a-162">hello main **tradeoff** is that if a catastrophic failure occurs during hello upgrade hello recovery toohello pre-upgrade state will involve re-deployment of hello application in a different region and restoring hello database from backup using geo-restore.</span></span> <span data-ttu-id="b651a-163">Ten proces spowoduje znaczne przestoju.</span><span class="sxs-lookup"><span data-stu-id="b651a-163">This process will result in significant downtime.</span></span>   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a><span data-ttu-id="b651a-164">Uaktualnianie aplikacji, które zależą od bazy danych — replikacja geograficzna odzyskiwania po awarii</span><span class="sxs-lookup"><span data-stu-id="b651a-164">Upgrading applications that rely on database geo-replication for disaster recovery</span></span>
<span data-ttu-id="b651a-165">Jeśli aplikacja korzysta z georeplikacji ciągłość prowadzenia działalności biznesowej, jest tooat wdrożony co najmniej dwóch różnych regionach z aktywnym wdrożeniu w regionie podstawowym i rezerwy wdrożenia w regionie kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="b651a-165">If your application leverages geo-replication for business continuity, it is deployed  tooat least two different regions with an active deployment in Primary region and a standby deployment in Backup region.</span></span> <span data-ttu-id="b651a-166">Ponadto czynniki toohello wspomniano wcześniej, hello procesu uaktualniania należy zagwarantować, że:</span><span class="sxs-lookup"><span data-stu-id="b651a-166">In addition toohello factors mentioned earlier, hello upgrade process must guarantee that:</span></span>

* <span data-ttu-id="b651a-167">Aplikacja Hello pozostaje chroniona przed poważnej awarii przez cały czas podczas procesu uaktualniania hello</span><span class="sxs-lookup"><span data-stu-id="b651a-167">hello application remains protected from catastrophic failures at all times during hello upgrade process</span></span>
* <span data-ttu-id="b651a-168">Witaj geograficznie nadmiarowego składniki aplikacji hello są uaktualniane równolegle ze składnikami active hello</span><span class="sxs-lookup"><span data-stu-id="b651a-168">hello geo-redundant components of hello application are upgraded in parallel with hello active components</span></span>

<span data-ttu-id="b651a-169">tooachieve profilu tych celów, przy użyciu trybu failover hello Azure ruchu Manager (WATM) będzie korzystać z jedna aktualizacja aktywna i trzy punkty końcowe kopii zapasowej.</span><span class="sxs-lookup"><span data-stu-id="b651a-169">tooachieve these goals you will leverage Azure Traffic Manager (WATM) using hello failover profile with one active and three backup endpoints.</span></span>  <span data-ttu-id="b651a-170">powitania po diagram ilustruje proces uaktualniania hello środowisko operacyjne wcześniejsze toohello.</span><span class="sxs-lookup"><span data-stu-id="b651a-170">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="b651a-171">Witaj witryn sieci web <i>contoso 1.azurewebsites.net</i> i <i>contoso dr.azurewebsites.net</i> reprezentują gnieździe produkcyjnym aplikacji hello z nadmiarowością pełnej geograficznych.</span><span class="sxs-lookup"><span data-stu-id="b651a-171">hello web sites <i>contoso-1.azurewebsites.net</i> and <i>contoso-dr.azurewebsites.net</i> represent a production slot of hello application with full geographic redundancy.</span></span> <span data-ttu-id="b651a-172">ponownie tooroll możliwości hello tooenable hello uaktualnienia, należy Utwórz miejsce etap kopię pełni zsynchronizowanych aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-172">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="b651a-173">Ponieważ potrzebna tooensure aplikacji hello Szybkie odzyskiwanie w przypadku, gdy wystąpi błąd krytyczny podczas procesu uaktualniania hello hello etap miejsca musi toobe geograficznie nadmiarowego również.</span><span class="sxs-lookup"><span data-stu-id="b651a-173">Because you need tooensure that hello application can quickly recover in case a catastrophic failure occurs during hello upgrade process, hello stage slot needs toobe geo-redundant as well.</span></span> <span data-ttu-id="b651a-174">Hello poniższe kroki są wymagane tooprepare hello aplikacji hello uaktualnienia:</span><span class="sxs-lookup"><span data-stu-id="b651a-174">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="b651a-175">Utwórz miejsce etap hello uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b651a-175">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="b651a-176">toodo tworzenie pomocniczej bazy danych (1), a następnie wdrożona identyczne kopię hello witryny sieci web w hello tego samego regionu systemu Azure.</span><span class="sxs-lookup"><span data-stu-id="b651a-176">toodo that create a secondary database (1) and deploy an identical copy of hello web site in hello same Azure region.</span></span> <span data-ttu-id="b651a-177">Monitorowanie toosee dodatkowej hello Jeśli hello wstępne wypełnianie procesu zostało ukończone.</span><span class="sxs-lookup"><span data-stu-id="b651a-177">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="b651a-178">Utwórz geograficznie nadmiarowego pomocniczej bazy danych w miejscu etap hello poprzez replikację geograficzną hello dodatkowej bazy danych toohello kopii zapasowej region (jest to nazywane "łańcuchowej — replikacja geograficzna").</span><span class="sxs-lookup"><span data-stu-id="b651a-178">Create a geo-redundant secondary database in hello stage slot by geo-replicating hello secondary database toohello backup region (this is called "chained geo-replication").</span></span> <span data-ttu-id="b651a-179">Monitorowanie kopii zapasowej toosee dodatkowej hello Jeśli hello wstępne wypełnianie procesu jest wypełniony (3).</span><span class="sxs-lookup"><span data-stu-id="b651a-179">Monitor hello backup secondary toosee if hello seeding process is completed (3).</span></span>
3. <span data-ttu-id="b651a-180">Utwórz kopię rezerwy hello witryny sieci web w regionie kopii zapasowej hello, a następnie połącz go toohello pomocniczy geograficznie nadmiarowego (4).</span><span class="sxs-lookup"><span data-stu-id="b651a-180">Create a standby copy of hello web site in hello backup region and link it toohello geo-redundant secondary (4).</span></span>  
4. <span data-ttu-id="b651a-181">Dodaj dodatkowe punkty końcowe hello <i>contoso 2.azurewebsites.net</i> i <i>contoso 3.azurewebsites.net</i> toohello profilu trybu failover w WATM jako punktów końcowych w trybie offline (5).</span><span class="sxs-lookup"><span data-stu-id="b651a-181">Add hello additional endpoints <i>contoso-2.azurewebsites.net</i> and <i>contoso-3.azurewebsites.net</i> toohello failover profile in WATM as offline endpoints (5).</span></span> 

> [!NOTE]
> <span data-ttu-id="b651a-182">Czynności przygotowujące hello Uwaga nie ma wpływu aplikacji hello w gnieździe produkcyjnym hello i może działać w trybie pełnego dostępu.</span><span class="sxs-lookup"><span data-stu-id="b651a-182">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
> 
> 

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

<span data-ttu-id="b651a-185">Po wykonaniu czynności przygotowujące hello miejsca etap hello jest gotowy do uaktualnienia hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-185">Once hello preparation steps are completed, hello stage slot is ready for hello upgrade.</span></span> <span data-ttu-id="b651a-186">powitania po diagram przedstawia kroki uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-186">hello following diagram illustrates hello upgrade steps.</span></span>

1. <span data-ttu-id="b651a-187">Ustaw hello podstawowej bazy danych w hello produkcji miejsca tylko tooread tryb (6).</span><span class="sxs-lookup"><span data-stu-id="b651a-187">Set hello primary database in hello production slot tooread-only mode (6).</span></span> <span data-ttu-id="b651a-188">Gwarantuje to, że hello produkcji wystąpienie aplikacji hello (wersja 1) pozostanie tylko do odczytu podczas uaktualniania hello zindeksowanie hello danych rozbieżności między hello V1 i V2 wystąpień bazy danych.</span><span class="sxs-lookup"><span data-stu-id="b651a-188">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="b651a-189">Odłącz hello dodatkowej bazy danych przy użyciu tego samego regionu w hello hello tryb planowane zakończenie (7).</span><span class="sxs-lookup"><span data-stu-id="b651a-189">Disconnect hello secondary database in hello same region using hello planned termination mode (7).</span></span> <span data-ttu-id="b651a-190">Utworzy on pełni zsynchronizowanej kopii niezależne hello podstawowej bazy danych, które automatycznie stanie się podstawowym po zakończeniu hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-190">It will create a fully synchronized independent copy of hello primary database, which will automatically become a primary after hello termination.</span></span> <span data-ttu-id="b651a-191">Ta baza danych zostanie uaktualniona.</span><span class="sxs-lookup"><span data-stu-id="b651a-191">This database will be upgraded.</span></span>
3. <span data-ttu-id="b651a-192">Włącz hello podstawowej bazy danych w trybie zapisu tooread miejsca etap hello, a następnie uruchom skrypt uaktualnienia hello (8).</span><span class="sxs-lookup"><span data-stu-id="b651a-192">Turn hello primary database in hello stage slot tooread-write mode and run hello upgrade script (8).</span></span>    

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

<span data-ttu-id="b651a-195">Aktualizacja hello zakończyła się pomyślnie są teraz gotowe tooswitch hello użytkownicy końcowi toohello V2 wersję aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-195">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello V2 version of hello application.</span></span> <span data-ttu-id="b651a-196">powitania po diagram ilustruje hello etapy.</span><span class="sxs-lookup"><span data-stu-id="b651a-196">hello following diagram illustrates hello steps involved.</span></span>

1. <span data-ttu-id="b651a-197">Przełącz hello aktywny punkt końcowy w profilu WATM hello zbyt<i>contoso 2.azurewebsites.net</i>, które teraz wskazuje wersję toohello V2 hello witryny sieci web (9).</span><span class="sxs-lookup"><span data-stu-id="b651a-197">Switch hello active endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which now points toohello V2 version of hello web site (9).</span></span> <span data-ttu-id="b651a-198">Staje się teraz gnieździe produkcyjnym z hello aplikacji V2 i ruch przez użytkownika końcowego jest bezpośrednie tooit.</span><span class="sxs-lookup"><span data-stu-id="b651a-198">It now becomes a production slot with hello V2 application and end-user traffic is directed tooit.</span></span> 
2. <span data-ttu-id="b651a-199">Jeśli nie są już potrzebne hello V1 aplikacji, możesz bezpiecznie usunąć go (10 i 11).</span><span class="sxs-lookup"><span data-stu-id="b651a-199">If you no longer need hello V1 application so you can safely remove it (10 and 11).</span></span>  

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

<span data-ttu-id="b651a-202">Jeśli proces uaktualniania hello zakończy się niepowodzeniem, na przykład ze względu na błąd tooan skryptów uaktualniania hello, hello etap miejsca należy traktować jako naruszenia zabezpieczeń.</span><span class="sxs-lookup"><span data-stu-id="b651a-202">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="b651a-203">tooroll kopii hello toohello przed uaktualnieniem stanu aplikacji po prostu przywrócić aplikacji hello toousing w gnieździe produkcyjnym hello z pełnym dostępem.</span><span class="sxs-lookup"><span data-stu-id="b651a-203">tooroll back hello application toohello pre-upgrade state you simply revert toousing hello application in hello production slot with full access.</span></span> <span data-ttu-id="b651a-204">etapy Hello są wyświetlane na diagramie dalej hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-204">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="b651a-205">Zestaw hello kopia podstawowej bazy danych w trybie zapisu tooread miejscem produkcyjnym hello (12).</span><span class="sxs-lookup"><span data-stu-id="b651a-205">Set hello primary database copy in hello production slot tooread-write mode (12).</span></span> <span data-ttu-id="b651a-206">Spowoduje to przywrócenie hello pełne V1 funkcjonalnie w gnieździe produkcyjnym hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-206">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="b651a-207">Analiza Przyczyna hello głównego i usunąć składniki hello naruszone w gnieździe etap hello (13 i 14).</span><span class="sxs-lookup"><span data-stu-id="b651a-207">Perform hello root cause analysis and remove hello compromised components in hello stage slot (13 and 14).</span></span> 

<span data-ttu-id="b651a-208">W tym momencie aplikacji hello jest w pełni funkcjonalny i kroki uaktualniania hello można powtarzać.</span><span class="sxs-lookup"><span data-stu-id="b651a-208">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="b651a-209">Witaj wycofywania nie wymaga zmian w profilu WATM jako już wskazuje zbyt <i>contoso 1.azurewebsites.net</i> jako hello aktywny punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="b651a-209">hello rollback does not require changes in WATM profile as it already points too <i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Konfiguracja — replikacja geograficzna bazy danych SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

<span data-ttu-id="b651a-212">klucz Hello **korzyści** tej opcji jest można uaktualnić zarówno aplikacji hello, jak i jego geograficznie nadmiarowego kopiowania równolegle w bez naruszania ciągłość prowadzenia działalności biznesowej podczas uaktualniania hello.</span><span class="sxs-lookup"><span data-stu-id="b651a-212">hello key **advantage** of this option is that you can upgrade both hello application and its geo-redundant copy in parallel without compromising your business continuity during hello upgrade.</span></span> <span data-ttu-id="b651a-213">Witaj głównego **zależnościami** wymaga nadmiarowości dwa razy każdego składnika aplikacji i w związku z tym generuje wyższy koszt dolara ($).</span><span class="sxs-lookup"><span data-stu-id="b651a-213">hello main **tradeoff** is that it requires double redundancy of each application component and therefore incurs higher dollar cost.</span></span> <span data-ttu-id="b651a-214">Obejmuje ona również bardziej skomplikowanych przepływów pracy.</span><span class="sxs-lookup"><span data-stu-id="b651a-214">It also involves a more complicated workflow.</span></span> 

## <a name="summary"></a><span data-ttu-id="b651a-215">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="b651a-215">Summary</span></span>
<span data-ttu-id="b651a-216">Witaj dwie metody uaktualniania opisane w artykule hello różnią się złożoność i hello dolara kosztów, ale obie skupić się na minimalizując hello czasu, gdy użytkownik końcowy hello jest ograniczony tylko do tooread operacji.</span><span class="sxs-lookup"><span data-stu-id="b651a-216">hello two upgrade methods described in hello article differ in complexity and hello dollar cost but they both focus on minimizing hello time when hello end user is limited tooread-only operations.</span></span> <span data-ttu-id="b651a-217">Tego czasu bezpośrednio jest zdefiniowana przez czas trwania hello hello skryptu uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="b651a-217">That time is directly defined by hello duration of hello upgrade script.</span></span> <span data-ttu-id="b651a-218">Nie jest zależny od rozmiaru bazy danych hello, usługi hello warstwy, wybierz opcję, hello konfiguracji witryny sieci web i innych czynników, które nie można łatwo zarządzać.</span><span class="sxs-lookup"><span data-stu-id="b651a-218">It does not depend on hello database size, hello service tier you chose, hello web site configuration and other factors that you cannot easily control.</span></span> <span data-ttu-id="b651a-219">Jest to spowodowane wszystkie kroki przygotowania hello jest całkowicie niezależna od hello kroki uaktualniania i mogą być przeprowadzane bez wpływu na powitania aplikacji produkcyjnej.</span><span class="sxs-lookup"><span data-stu-id="b651a-219">This is because all hello preparation steps are decoupled from hello upgrade steps and can be done without impacting hello production application.</span></span> <span data-ttu-id="b651a-220">wydajność Hello skryptu uaktualnienia hello jest hello kluczowym czynnikiem, określająca hello środowisko użytkownika końcowego podczas uaktualniania.</span><span class="sxs-lookup"><span data-stu-id="b651a-220">hello efficiency of hello upgrade script is hello key factor that determines hello end-user experience during upgrades.</span></span> <span data-ttu-id="b651a-221">Dlatego najlepiej hello mogła ją udoskonalać jest koncentrujące się wysiłków na tworzenie skryptów uaktualniania hello jak najbardziej efektywne.</span><span class="sxs-lookup"><span data-stu-id="b651a-221">So hello best way you can improve it is by focusing your efforts on making hello upgrade script as efficient as possible.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="b651a-222">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="b651a-222">Next steps</span></span>
* <span data-ttu-id="b651a-223">Omówienie ciągłości działalności biznesowej i scenariuszy, zobacz [omówienie ciągłości działalności biznesowej](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="b651a-223">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="b651a-224">toolearn o bazy danych SQL Azure automatycznego tworzenia kopii zapasowych, zobacz [bazy danych SQL automatycznego tworzenia kopii zapasowych](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="b651a-224">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="b651a-225">toolearn o za pomocą kopie zapasowe automatycznego odzyskiwania, zobacz [przywrócić bazę danych z automatycznych kopii zapasowych](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="b651a-225">toolearn about using automated backups for recovery, see [restore a database from automated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="b651a-226">toolearn o szybsze opcje odzyskiwania, zobacz [aktywna replikacja geograficzna](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="b651a-226">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>


