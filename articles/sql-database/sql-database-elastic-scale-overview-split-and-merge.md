---
title: "Przenoszenie danych między bazami danych w chmurze skalowalnych w poziomie | Dokumentacja firmy Microsoft"
description: "Wyjaśniono, jak do manipulowania odłamków i przenoszenia danych za pośrednictwem usługi hostowania samoobsługowego przy użyciu interfejsów API elastycznej bazy danych."
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 204fd902-0397-4185-985a-dea3ed7c7d9f
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: b41b6d6be686168359a97eb7468351a105b748db
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 07/11/2017
---
# <a name="moving-data-between-scaled-out-cloud-databases"></a><span data-ttu-id="fb0af-103">Przenoszenie danych między skalowanymi bazami danych w chmurze</span><span class="sxs-lookup"><span data-stu-id="fb0af-103">Moving data between scaled-out cloud databases</span></span>
<span data-ttu-id="fb0af-104">Jeśli jesteś oprogramowania jako deweloper usługi, i nagle aplikacji ulega ogromne żądanie, należy uwzględnić rozwój.</span><span class="sxs-lookup"><span data-stu-id="fb0af-104">If you are a Software as a Service developer, and suddenly your app undergoes tremendous demand, you need to accommodate the growth.</span></span> <span data-ttu-id="fb0af-105">Dlatego należy dodać więcej baz danych (odłamków).</span><span class="sxs-lookup"><span data-stu-id="fb0af-105">So you add more databases (shards).</span></span> <span data-ttu-id="fb0af-106">Jak wszystkie dane do nowych baz danych bez zakłócania integralność danych</span><span class="sxs-lookup"><span data-stu-id="fb0af-106">How do you redistribute the data to the new databases without disrupting the data integrity?</span></span> <span data-ttu-id="fb0af-107">Użyj **narzędzia do scalania podziału** do przenoszenia danych z baz danych ograniczone do nowych baz danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-107">Use the **split-merge tool** to move data from constrained databases to the new databases.</span></span>  

<span data-ttu-id="fb0af-108">Narzędzia do scalania podziału działa jako usługa sieci web platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-108">The split-merge tool runs as an Azure web service.</span></span> <span data-ttu-id="fb0af-109">Administratorem lub deweloperem używa narzędzia do przenoszenia shardlets (dane z niezależnego fragmentu) między różnych baz danych (odłamków).</span><span class="sxs-lookup"><span data-stu-id="fb0af-109">An administrator or developer uses the tool to move shardlets (data from a shard) between different databases (shards).</span></span> <span data-ttu-id="fb0af-110">Narzędzie wykorzystuje niezależnego fragmentu mapy zarządzania do obsługi bazy danych metadanych usługi i zapewnić spójne mapowania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-110">The tool uses shard map management to maintain the service metadata database, and ensure consistent mappings.</span></span>

![Omówienie][1]

## <a name="download"></a><span data-ttu-id="fb0af-112">Do pobrania</span><span class="sxs-lookup"><span data-stu-id="fb0af-112">Download</span></span>
[<span data-ttu-id="fb0af-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span><span class="sxs-lookup"><span data-stu-id="fb0af-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span></span>](http://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/)

## <a name="documentation"></a><span data-ttu-id="fb0af-114">Dokumentacja</span><span class="sxs-lookup"><span data-stu-id="fb0af-114">Documentation</span></span>
1. [<span data-ttu-id="fb0af-115">Samouczek narzędzi elastycznej bazy danych scalania podziału</span><span class="sxs-lookup"><span data-stu-id="fb0af-115">Elastic database Split-Merge tool tutorial</span></span>](sql-database-elastic-scale-configure-deploy-split-and-merge.md)
2. [<span data-ttu-id="fb0af-116">Konfiguracja zabezpieczeń scalania podziału</span><span class="sxs-lookup"><span data-stu-id="fb0af-116">Split-Merge security configuration</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
3. [<span data-ttu-id="fb0af-117">Zagadnienia dotyczące zabezpieczeń scalania podziału</span><span class="sxs-lookup"><span data-stu-id="fb0af-117">Split-merge security considerations</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
4. [<span data-ttu-id="fb0af-118">Zarządzanie mapami fragmentów</span><span class="sxs-lookup"><span data-stu-id="fb0af-118">Shard map management</span></span>](sql-database-elastic-scale-shard-map-management.md)
5. [<span data-ttu-id="fb0af-119">Migrowanie istniejących baz danych do skalowalnego w poziomie</span><span class="sxs-lookup"><span data-stu-id="fb0af-119">Migrate existing databases to scale-out</span></span>](sql-database-elastic-convert-to-use-elastic-tools.md)
6. [<span data-ttu-id="fb0af-120">Narzędzi elastycznej bazy danych</span><span class="sxs-lookup"><span data-stu-id="fb0af-120">Elastic database tools</span></span>](sql-database-elastic-scale-introduction.md)
7. [<span data-ttu-id="fb0af-121">Elastyczne słownik Narzędzia bazy danych</span><span class="sxs-lookup"><span data-stu-id="fb0af-121">Elastic Database tools glossary</span></span>](sql-database-elastic-scale-glossary.md)

## <a name="why-use-the-split-merge-tool"></a><span data-ttu-id="fb0af-122">Dlaczego warto używać narzędzia do scalania podziału?</span><span class="sxs-lookup"><span data-stu-id="fb0af-122">Why use the split-merge tool?</span></span>
<span data-ttu-id="fb0af-123">**Elastyczność**</span><span class="sxs-lookup"><span data-stu-id="fb0af-123">**Flexibility**</span></span>

<span data-ttu-id="fb0af-124">Aplikacje muszą stretch elastycznie poza granicami pojedynczej bazy danych bazy danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-124">Applications need to stretch flexibly beyond the limits of a single Azure SQL DB database.</span></span> <span data-ttu-id="fb0af-125">Użyj narzędzia do przenoszenia danych, w razie potrzeby do nowych baz danych, przy zachowaniu integralności.</span><span class="sxs-lookup"><span data-stu-id="fb0af-125">Use the tool to move data as needed to new databases while retaining integrity.</span></span>

<span data-ttu-id="fb0af-126">**Podziel się rozrastać**</span><span class="sxs-lookup"><span data-stu-id="fb0af-126">**Split to grow**</span></span> 

<span data-ttu-id="fb0af-127">Należy zwiększyć ogólną wydajność obsługi dynamiczny rozwój.</span><span class="sxs-lookup"><span data-stu-id="fb0af-127">You need to increase overall capacity to handle explosive growth.</span></span> <span data-ttu-id="fb0af-128">Aby to zrobić, należy utworzyć jej większą pojemność dzielenia na fragmenty danych oraz dystrybucję w przyrostowo więcej baz danych, dopóki nie są spełnione wymagana pojemność.</span><span class="sxs-lookup"><span data-stu-id="fb0af-128">To do so, create additional capacity by sharding the data and by distributing it across incrementally more databases until capacity needs are fulfilled.</span></span> <span data-ttu-id="fb0af-129">To jest przykład głównym funkcji "podział".</span><span class="sxs-lookup"><span data-stu-id="fb0af-129">This is a prime example of the ‘split’ feature.</span></span> 

<span data-ttu-id="fb0af-130">**Scal, aby zmniejszyć rozmiar**</span><span class="sxs-lookup"><span data-stu-id="fb0af-130">**Merge to shrink**</span></span>

<span data-ttu-id="fb0af-131">Pojemność musi zmniejszać ze względu na specyfikę okresach przedsiębiorstwa.</span><span class="sxs-lookup"><span data-stu-id="fb0af-131">Capacity needs shrink due to the seasonal nature of a business.</span></span> <span data-ttu-id="fb0af-132">Narzędzie pozwala skali mniejszej liczby jednostek skalowania podczas spowalnia biznesowych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-132">The tool lets you scale down to fewer scale units when business slows.</span></span> <span data-ttu-id="fb0af-133">Funkcja "merge" w usłudze scalania podziału elastycznego skalowania obejmuje to wymaganie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-133">The ‘merge’ feature in the Elastic Scale split-merge Service covers this requirement.</span></span> 

<span data-ttu-id="fb0af-134">**Zarządzanie punktami HotSpot przenosząc shardlets**</span><span class="sxs-lookup"><span data-stu-id="fb0af-134">**Manage hotspots by moving shardlets**</span></span>

<span data-ttu-id="fb0af-135">Z wieloma dzierżawcami na bazę danych Alokacja shardlets do odłamków może prowadzić do wąskich gardeł wydajności na niektórych fragmentów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-135">With multiple tenants per database, the allocation of shardlets to shards can lead to capacity bottlenecks on some shards.</span></span> <span data-ttu-id="fb0af-136">Wymaga to ponowne przydzielanie shardlets lub przeniesienie zajęty shardlets do nowych lub mniej wykorzystywanych fragmentów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-136">This requires re-allocating shardlets or moving busy shardlets to new or less utilized shards.</span></span> 

## <a name="concepts--key-features"></a><span data-ttu-id="fb0af-137">Pojęcia dotyczące & najważniejsze funkcje</span><span class="sxs-lookup"><span data-stu-id="fb0af-137">Concepts & key features</span></span>
<span data-ttu-id="fb0af-138">**Obsługiwana w środowisku klienta usługi**</span><span class="sxs-lookup"><span data-stu-id="fb0af-138">**Customer-hosted services**</span></span>

<span data-ttu-id="fb0af-139">Scalanie podziału jest dostarczana jako usługa hostowana przez klienta.</span><span class="sxs-lookup"><span data-stu-id="fb0af-139">The split-merge is delivered as a customer-hosted service.</span></span> <span data-ttu-id="fb0af-140">Należy wdrożyć i obsługi usługi w subskrypcji platformy Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-140">You must deploy and host the service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="fb0af-141">Pakiet, który można pobrać z NuGet zawiera szablon konfiguracji do ukończenia wraz z informacjami dla określonego wdrożenia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-141">The package you download from NuGet contains a configuration template to complete with the information for your specific deployment.</span></span> <span data-ttu-id="fb0af-142">Zobacz [samouczek scalania podziału](sql-database-elastic-scale-configure-deploy-split-and-merge.md) szczegółowe informacje.</span><span class="sxs-lookup"><span data-stu-id="fb0af-142">See the [split-merge tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) for details.</span></span> <span data-ttu-id="fb0af-143">Ponieważ usługa jest uruchamiana w Twojej subskrypcji platformy Azure, można kontrolować i skonfigurować większość ustawień zabezpieczeń usługi.</span><span class="sxs-lookup"><span data-stu-id="fb0af-143">Since the service runs in your Azure subscription, you can control and configure most security aspects of the service.</span></span> <span data-ttu-id="fb0af-144">Szablon domyślny zawiera opcje, aby skonfigurować protokół SSL, uwierzytelnianie klienta oparte na certyfikatach, szyfrowania przechowywanych poświadczeń, ochrona systemu DoS i ograniczenia adresów IP.</span><span class="sxs-lookup"><span data-stu-id="fb0af-144">The default template includes the options to configure SSL, certificate-based client authentication, encryption for stored credentials, DoS guarding and IP restrictions.</span></span> <span data-ttu-id="fb0af-145">Więcej informacji na temat aspekty zabezpieczeń można znaleźć w następującym dokumencie [konfiguracji zabezpieczeń scalania podziału](sql-database-elastic-scale-split-merge-security-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="fb0af-145">You can find more information on the security aspects in the following document [split-merge security configuration](sql-database-elastic-scale-split-merge-security-configuration.md).</span></span>

<span data-ttu-id="fb0af-146">Wartość domyślna wdrożona usługa działa z jednego procesu roboczego i jedną rolę sieci web.</span><span class="sxs-lookup"><span data-stu-id="fb0af-146">The default deployed service runs with one worker and one web role.</span></span> <span data-ttu-id="fb0af-147">Rozmiar maszyna wirtualna A1 każdego używa usługi w chmurze Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-147">Each uses the A1 VM size in Azure Cloud Services.</span></span> <span data-ttu-id="fb0af-148">Gdy nie można zmodyfikować te ustawienia podczas wdrażania pakietu, można je zmienić po pomyślnym wdrożeniu w uruchomionej usługi chmury (za pośrednictwem portalu Azure).</span><span class="sxs-lookup"><span data-stu-id="fb0af-148">While you cannot modify these settings when deploying the package, you could change them after a successful deployment in the running cloud service, (through the Azure portal).</span></span> <span data-ttu-id="fb0af-149">Należy pamiętać, że roli proces roboczy nie mogą być skonfigurowane dla więcej niż jednego wystąpienia przyczyn technicznych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-149">Note that the worker role must not be configured for more than a single instance for technical reasons.</span></span> 

<span data-ttu-id="fb0af-150">**Identyfikator niezależnego fragmentu integracji mapy**</span><span class="sxs-lookup"><span data-stu-id="fb0af-150">**Shard map integration**</span></span>

<span data-ttu-id="fb0af-151">Usługa scalania podziału współdziała z mapy niezależnych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-151">The split-merge service interacts with the shard map of the application.</span></span> <span data-ttu-id="fb0af-152">Podczas korzystania z usługi podziału scalania, aby dzielenie i scalanie zakresów lub shardlets między odłamków, usługa automatycznie aktualizuje mapy niezależnego fragmentu aktualne.</span><span class="sxs-lookup"><span data-stu-id="fb0af-152">When using the split-merge service to split or merge ranges or to move shardlets between shards, the service automatically keeps the shard map up to date.</span></span> <span data-ttu-id="fb0af-153">Aby to zrobić, usługa łączy do bazy danych Menedżera mapy niezależnych aplikacji i przechowuje zakresy i mapowania postęp żądań move podziału/merge.</span><span class="sxs-lookup"><span data-stu-id="fb0af-153">To do so, the service connects to the shard map manager database of the application and maintains ranges and mappings as split/merge/move requests progress.</span></span> <span data-ttu-id="fb0af-154">Dzięki temu, że mapy niezależnego fragmentu zawsze przedstawia aktualny widok podczas operacji scalania podziału będą.</span><span class="sxs-lookup"><span data-stu-id="fb0af-154">This ensures that the shard map always presents an up-to-date view when split-merge operations are going on.</span></span> <span data-ttu-id="fb0af-155">Podzielić, operacje przenoszenia scalania i shardlet są implementowane przez przeniesienie partii shardlets z niezależnych źródła do niezależnych docelowej.</span><span class="sxs-lookup"><span data-stu-id="fb0af-155">Split, merge and shardlet movement operations are implemented by moving a batch of shardlets from the source shard to the target shard.</span></span> <span data-ttu-id="fb0af-156">Podczas operacji przenoszenia shardlet shardlets może ulec bieżącej partii są oznaczone w trybie offline w mapie niezależnego fragmentu i są dostępne na potrzeby połączeń routingu zależne od danych za pomocą **OpenConnectionForKey** interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="fb0af-156">During the shardlet movement operation the shardlets subject to the current batch are marked as offline in the shard map and are unavailable for data-dependent routing connections using the **OpenConnectionForKey** API.</span></span> 

<span data-ttu-id="fb0af-157">**Spójne shardlet połączeń**</span><span class="sxs-lookup"><span data-stu-id="fb0af-157">**Consistent shardlet connections**</span></span>

<span data-ttu-id="fb0af-158">Po uruchomieniu przenoszenie danych do nowej partii shardlets wszystkie podane mapowanie niezależnych zależne od danych routingu połączenia niezależnych przechowywania shardlet są zabitych i kolejnych połączeń z mapy niezależnego fragmentu interfejsów API do powyższej shardlets są blokowane podczas przenoszenia danych jest w toku, aby uniknąć niespójności.</span><span class="sxs-lookup"><span data-stu-id="fb0af-158">When data movement starts for a new batch of shardlets, any shard-map provided data-dependent routing connections to the shard storing the shardlet are killed and subsequent connections from the shard map APIs to the these shardlets are blocked while the data movement is in progress in order to avoid inconsistencies.</span></span> <span data-ttu-id="fb0af-159">Połączenia z innymi shardlets na sam identyfikator niezależnego fragmentu również pobrać skasowane, ale powiedzie się ponownie od razu przy ponownej próbie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-159">Connections to other shardlets on the same shard will also get killed, but will succeed again immediately on retry.</span></span> <span data-ttu-id="fb0af-160">Po przeniesieniu partii shardlets oznaczonych jako online ponownie dla niezależnych docelowego, a źródło danych zostanie usunięta z niezależnych źródła.</span><span class="sxs-lookup"><span data-stu-id="fb0af-160">Once the batch is moved, the shardlets are marked online again for the target shard and the source data is removed from the source shard.</span></span> <span data-ttu-id="fb0af-161">Usługa przechodzi przez te czynności dla każdej partii, dopóki wszystkie shardlets zostały przeniesione.</span><span class="sxs-lookup"><span data-stu-id="fb0af-161">The service goes through these steps for every batch until all shardlets have been moved.</span></span> <span data-ttu-id="fb0af-162">To spowoduje kilka operacji kill połączenia w trakcie ukończenia operacji podziału/merge/przeniesienia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-162">This will lead to several connection kill operations during the course of the complete split/merge/move operation.</span></span>  

<span data-ttu-id="fb0af-163">**Zarządzanie shardlet dostępności**</span><span class="sxs-lookup"><span data-stu-id="fb0af-163">**Managing shardlet availability**</span></span>

<span data-ttu-id="fb0af-164">Ograniczanie połączenia skasowanie do bieżącej partii shardlets zgodnie z powyższym opisem ogranicza zakres niedostępności jednej partii shardlets naraz.</span><span class="sxs-lookup"><span data-stu-id="fb0af-164">Limiting the connection killing to the current batch of shardlets as discussed above restricts the scope of unavailability to one batch of shardlets at a time.</span></span> <span data-ttu-id="fb0af-165">Jest to preferowany nad rozwiązaniem gdzie pełny identyfikator niezależnego fragmentu pozostanie w trybie offline dla wszystkich jego shardlets w trakcie operacji dzielenie i scalanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-165">This is preferred over an approach where the complete shard would remain offline for all its shardlets during the course of a split or merge operation.</span></span> <span data-ttu-id="fb0af-166">Rozmiar wsadu zdefiniowany jako liczbę unikatowych shardlets przenosić w czasie, jest parametru konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-166">The size of a batch, defined as the number of distinct shardlets to move at a time, is a configuration parameter.</span></span> <span data-ttu-id="fb0af-167">Może być zdefiniowana dla każdej operacji dzielenie i scalanie w zależności od potrzeb dostępności i wydajności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-167">It can be defined for each split and merge operation depending on the application’s availability and performance needs.</span></span> <span data-ttu-id="fb0af-168">Należy pamiętać, że zakres, który jest zablokowany na mapie niezależnych może być większy niż określony rozmiar partii.</span><span class="sxs-lookup"><span data-stu-id="fb0af-168">Note that the range that is being locked in the shard map may be larger than the batch size specified.</span></span> <span data-ttu-id="fb0af-169">Jest to spowodowane usługi wybiera rozmiar zakresu w taki sposób, że rzeczywista liczba wartości kluczy dzielenia na fragmenty danych około dopasowuje rozmiar partii.</span><span class="sxs-lookup"><span data-stu-id="fb0af-169">This is because the service picks the range size such that the actual number of sharding key values in the data approximately matches the batch size.</span></span> <span data-ttu-id="fb0af-170">Jest to ważne do zapamiętania w szczególności kluczy słabo wypełnione dzielenia na fragmenty.</span><span class="sxs-lookup"><span data-stu-id="fb0af-170">This is important to remember in particular for sparsely populated sharding keys.</span></span> 

<span data-ttu-id="fb0af-171">**Magazynu metadanych**</span><span class="sxs-lookup"><span data-stu-id="fb0af-171">**Metadata storage**</span></span>

<span data-ttu-id="fb0af-172">Usługa scalania podziału korzysta z bazy danych, aby zachować stan i zachować dzienniki podczas przetwarzania żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-172">The split-merge service uses a database to maintain its status and to keep logs during request processing.</span></span> <span data-ttu-id="fb0af-173">Użytkownik tworzy tej bazy danych w swoich subskrypcji i zawiera parametry połączenia dla niego w pliku konfiguracji wdrożenia usługi.</span><span class="sxs-lookup"><span data-stu-id="fb0af-173">The user creates this database in their subscription and provides the connection string for it in the configuration file for the service deployment.</span></span> <span data-ttu-id="fb0af-174">Administratorzy z organizacji użytkownika umożliwia też łączność z tej bazy danych, aby sprawdzić postęp żądania i do sprawdzania, czy szczegółowe informacje dotyczące potencjalnych błędów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-174">Administrators from the user’s organization can also connect to this database to review request progress and to investigate detailed information regarding potential failures.</span></span>

<span data-ttu-id="fb0af-175">**Rozpoznawanie dzielenia na fragmenty**</span><span class="sxs-lookup"><span data-stu-id="fb0af-175">**Sharding-awareness**</span></span>

<span data-ttu-id="fb0af-176">Usługa scalania podziału oddzieli (1) podzielonej tabel, tabele odwołań (2) i (3) normalne tabel.</span><span class="sxs-lookup"><span data-stu-id="fb0af-176">The split-merge service differentiates between (1) sharded tables, (2) reference tables, and (3) normal tables.</span></span> <span data-ttu-id="fb0af-177">Semantyka operacji przenoszenia podziału/merge są zależne od typu tabeli użyte i są zdefiniowane w następujący sposób:</span><span class="sxs-lookup"><span data-stu-id="fb0af-177">The semantics of a split/merge/move operation depend on the type of the table used and are defined as follows:</span></span> 

* <span data-ttu-id="fb0af-178">**Tabele podzielonej**: podziału, scalania i operacji przenoszenia Przenieś shardlets ze źródła do docelowego niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-178">**Sharded tables**: Split, merge, and move operations move shardlets from source to target shard.</span></span> <span data-ttu-id="fb0af-179">Po pomyślnym ukończeniu ogólną żądania shardlets te nie są już dostępne w źródle.</span><span class="sxs-lookup"><span data-stu-id="fb0af-179">After successful completion of the overall request, those shardlets are no longer present on the source.</span></span> <span data-ttu-id="fb0af-180">Należy pamiętać, że tabel docelowych musi istnieć na docelowy identyfikator niezależnego fragmentu i nie może zawierać danych w zakresie docelowego przed wykonania operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-180">Note that the target tables need to exist on the target shard and must not contain data in the target range prior to processing of the operation.</span></span> 
* <span data-ttu-id="fb0af-181">**Tabele odwołań dla**: tabele odwołań, podziału, Scal i przenieść operacje skopiować dane ze źródła do docelowego identyfikator niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-181">**Reference tables**: For reference tables, the split, merge and move operations copy the data from the source to the target shard.</span></span> <span data-ttu-id="fb0af-182">Należy jednak pamiętać, że żadne zmiany wystąpić na niezależnych docelowy dla danej tabeli, jeśli każdy wiersz znajduje się już w tej tabeli w elemencie docelowym.</span><span class="sxs-lookup"><span data-stu-id="fb0af-182">Note, however, that no changes occur on the target shard for a given table if any row is already present in this table on the target.</span></span> <span data-ttu-id="fb0af-183">Tabela ma być puste dla operacji kopiowania tabeli wszelkie odwołania do przetworzenie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-183">The table has to be empty for any reference table copy operation to get processed.</span></span>
* <span data-ttu-id="fb0af-184">**Inne tabele**: inne tabele mogą być obecne na źródłowy lub docelowy operacji dzielenie i scalanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-184">**Other Tables**: Other tables can be present on either the source or the target of a split and merge operation.</span></span> <span data-ttu-id="fb0af-185">Usługa scalania podziału pomija te tabele operacje kopiowania lub przenoszenia danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-185">The split-merge service disregards these tables for any data movement or copy operations.</span></span> <span data-ttu-id="fb0af-186">Należy jednak pamiętać, że może zakłócać te operacje, w przypadku ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-186">Note, however, that they can interfere with these operations in case of constraints.</span></span>

<span data-ttu-id="fb0af-187">Informacje w odwołaniu a podzielonej tabele są udostępniane przez **SchemaInfo** interfejsów API na mapie niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-187">The information on reference vs. sharded tables is provided by the **SchemaInfo** APIs on the shard map.</span></span> <span data-ttu-id="fb0af-188">Poniższy przykład przedstawia użycie tych interfejsów API danego niezależnych Mapa menedżera obiektu smm:</span><span class="sxs-lookup"><span data-stu-id="fb0af-188">The following example illustrates the use of these APIs on a given shard map manager object smm:</span></span> 

    // Create the schema annotations 
    SchemaInfo schemaInfo = new SchemaInfo(); 

    // Reference tables 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "region")); 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "nation")); 

    // Sharded tables 
    schemaInfo.Add(new ShardedTableInfo("dbo", "customer", "C_CUSTKEY")); 
    schemaInfo.Add(new ShardedTableInfo("dbo", "orders", "O_CUSTKEY")); 

    // Publish 
    smm.GetSchemaInfoCollection().Add(Configuration.ShardMapName, schemaInfo); 

<span data-ttu-id="fb0af-189">Tabele "region" i "uprzywilejowania" są zdefiniowane jako tabele odwołań i zostaną skopiowane z operacji przenoszenia podziału/merge.</span><span class="sxs-lookup"><span data-stu-id="fb0af-189">The tables ‘region’ and ‘nation’ are defined as reference tables and will be copied with split/merge/move operations.</span></span> <span data-ttu-id="fb0af-190">"klient" i "zamówienia" z kolei są definiowane jako podzielonej tabel.</span><span class="sxs-lookup"><span data-stu-id="fb0af-190">‘customer’ and ‘orders’ in turn are defined as sharded tables.</span></span> <span data-ttu-id="fb0af-191">C_CUSTKEY i O_CUSTKEY służyć jako klucz dzielenia na fragmenty.</span><span class="sxs-lookup"><span data-stu-id="fb0af-191">C_CUSTKEY and O_CUSTKEY serve as the sharding key.</span></span> 

<span data-ttu-id="fb0af-192">**Integralność referencyjna**</span><span class="sxs-lookup"><span data-stu-id="fb0af-192">**Referential Integrity**</span></span>

<span data-ttu-id="fb0af-193">Usługa scalania podziału analizuje zależności między tabelami i używa relacje klucza obcego klucza podstawowego, aby przemieścić operacji przenoszenia tabele odwołań i shardlets.</span><span class="sxs-lookup"><span data-stu-id="fb0af-193">The split-merge service analyzes dependencies between tables and uses foreign key-primary key relationships to stage the operations for moving reference tables and shardlets.</span></span> <span data-ttu-id="fb0af-194">Ogólnie rzecz biorąc tabele odwołań są kopiowane najpierw w kolejności zależności, a następnie shardlets są kopiowane w kolejności ich zależności w ramach każdej partii.</span><span class="sxs-lookup"><span data-stu-id="fb0af-194">In general, reference tables are copied first in dependency order, then shardlets are copied in order of their dependencies within each batch.</span></span> <span data-ttu-id="fb0af-195">Jest to konieczne, dzięki czemu ograniczenia klucza podstawowego klucza Obcego niezależnych docelowej są honorowane jako nadejścia nowych danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-195">This is necessary so that FK-PK constraints on the target shard are honored as the new data arrives.</span></span> 

<span data-ttu-id="fb0af-196">**Spójność mapy niezależnego fragmentu i ostatecznego zakończenia**</span><span class="sxs-lookup"><span data-stu-id="fb0af-196">**Shard Map Consistency and Eventual Completion**</span></span>

<span data-ttu-id="fb0af-197">Obecności awarie usługi scalania podziału wznawia działania po awarii dowolnego i ma na celu wykonywania w toku żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-197">In the presence of failures, the split-merge service resumes operations after any outage and aims to complete any in progress requests.</span></span> <span data-ttu-id="fb0af-198">Jednak sytuacjach może być nieodwracalny, np. gdy niezależnych docelowy zostanie utracony lub naruszony naprawić.</span><span class="sxs-lookup"><span data-stu-id="fb0af-198">However, there may be unrecoverable situations, e.g., when the target shard is lost or compromised beyond repair.</span></span> <span data-ttu-id="fb0af-199">W tych warunkach niektórych shardlets, które były zaplanowane do przeniesienia może nadal znajdować się na niezależnych źródła.</span><span class="sxs-lookup"><span data-stu-id="fb0af-199">Under those circumstances, some shardlets that were supposed to be moved may continue to reside on the source shard.</span></span> <span data-ttu-id="fb0af-200">Usługę gwarantuje, że shardlet mapowania są aktualizowane wyłącznie po niezbędnych danych zostały pomyślnie skopiowane do obiektu docelowego.</span><span class="sxs-lookup"><span data-stu-id="fb0af-200">The service ensures that shardlet mappings are only updated after the necessary data has been successfully copied to the target.</span></span> <span data-ttu-id="fb0af-201">Shardlets są usuwane tylko w źródle po wszystkich swoich danych został skopiowany do obiektu docelowego i odpowiednie mapowania zostały pomyślnie zaktualizowane.</span><span class="sxs-lookup"><span data-stu-id="fb0af-201">Shardlets are only deleted on the source once all their data has been copied to the target and the corresponding mappings have been updated successfully.</span></span> <span data-ttu-id="fb0af-202">Operacji usuwania odbywa się w tle, gdy zakres jest w trybie online na docelowy identyfikator niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-202">The deletion operation happens in the background while the range is already online on the target shard.</span></span> <span data-ttu-id="fb0af-203">Usługi scalania podziału zawsze zapewnia poprawność mapowania przechowywane w mapie niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-203">The split-merge service always ensures correctness of the mappings stored in the shard map.</span></span>

## <a name="the-split-merge-user-interface"></a><span data-ttu-id="fb0af-204">Interfejs użytkownika scalania podziału</span><span class="sxs-lookup"><span data-stu-id="fb0af-204">The split-merge user interface</span></span>
<span data-ttu-id="fb0af-205">Pakiet usługi scalania podziału obejmuje rolę procesu roboczego oraz roli sieci web.</span><span class="sxs-lookup"><span data-stu-id="fb0af-205">The split-merge service package includes a worker role and a web role.</span></span> <span data-ttu-id="fb0af-206">Rola sieci web jest używana do przesyłania żądań podziału scalania w sposób interaktywny.</span><span class="sxs-lookup"><span data-stu-id="fb0af-206">The web role is used to submit split-merge requests in an interactive way.</span></span> <span data-ttu-id="fb0af-207">Główne składniki interfejsu użytkownika są następujące:</span><span class="sxs-lookup"><span data-stu-id="fb0af-207">The main components of the user interface are as follows:</span></span>

* <span data-ttu-id="fb0af-208">Typ operacji: Typ operacji jest przycisku radiowego, który określa rodzaj operacji wykonywanych przez usługę dla tego żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-208">Operation Type: The operation type is a radio button that controls the kind of operation performed by the service for this request.</span></span> <span data-ttu-id="fb0af-209">Można wybrać podziału, scalanie i Przenieś scenariuszy.</span><span class="sxs-lookup"><span data-stu-id="fb0af-209">You can choose between the split, merge and move scenarios.</span></span> <span data-ttu-id="fb0af-210">Można również anulować operację wcześniej zostało przesłane.</span><span class="sxs-lookup"><span data-stu-id="fb0af-210">You can also cancel a previously submitted operation.</span></span> <span data-ttu-id="fb0af-211">Można użyć podziału, Scal i Przenieś żądania zakresu niezależnego fragmentu mapowania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-211">You can use split, merge and move requests for range shard maps.</span></span> <span data-ttu-id="fb0af-212">Lista niezależnych mapuje tylko operacji przenoszenia pomocy technicznej.</span><span class="sxs-lookup"><span data-stu-id="fb0af-212">List shard maps only support move operations.</span></span>
* <span data-ttu-id="fb0af-213">Mapa niezależnego fragmentu: W następnej sekcji Parametry żądania obejmują informacje dotyczące mapowania niezależnego fragmentu i hosting mapy niezależnego fragmentu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-213">Shard Map: The next section of request parameters cover information about the shard map and the database hosting your shard map.</span></span> <span data-ttu-id="fb0af-214">W szczególności należy podać nazwę serwera bazy danych SQL Azure i obsługi shardmap, poświadczenia do połączenia z bazą danych mapowania niezależnego fragmentu, a na końcu Nazwa mapy niezależnego fragmentu bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-214">In particular, you need to provide the name of the Azure SQL Database server and database hosting the shardmap, credentials to connect to the shard map database, and finally the name of the shard map.</span></span> <span data-ttu-id="fb0af-215">Obecnie operację akceptuje tylko jednego zestawu poświadczeń.</span><span class="sxs-lookup"><span data-stu-id="fb0af-215">Currently, the operation only accepts a single set of credentials.</span></span> <span data-ttu-id="fb0af-216">Wymagane są poświadczenia mają wystarczające uprawnienia do wykonania na odłamków zmiany do mapy niezależnego fragmentu, jak również danych użytkownika.</span><span class="sxs-lookup"><span data-stu-id="fb0af-216">These credentials need to have sufficient permissions to perform changes to the shard map as well as to the user data on the shards.</span></span>
* <span data-ttu-id="fb0af-217">Zakres źródła (dzielenie i scalanie): operacja dzielenie i scalanie przetwarza zakresu, używając swojego klucza niski i wysoki.</span><span class="sxs-lookup"><span data-stu-id="fb0af-217">Source Range (split and merge): A split and merge operation processes a range using its low and high key.</span></span> <span data-ttu-id="fb0af-218">Aby określić operację z niepowiązany wysoka wartość klucza, zaznacz pole wyboru "max jest wysoka wartość klucza" i pozostaw puste pole klucza wysoki.</span><span class="sxs-lookup"><span data-stu-id="fb0af-218">To specify an operation with an unbounded high key value, check the “High key is max” check box and leave the high key field empty.</span></span> <span data-ttu-id="fb0af-219">Podane wartości klucza zakresu musi być dokładnie zgodny mapowania i jego granice na mapie niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-219">The range key values that you specify do not need to precisely match a mapping and its boundaries in your shard map.</span></span> <span data-ttu-id="fb0af-220">Jeśli nie określono żadnych granic zakresu na wszystkich usługi wywnioskuje najbliższego zakresu można automatycznie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-220">If you do not specify any range boundaries at all the service will infer the closest range for you automatically.</span></span> <span data-ttu-id="fb0af-221">Skrypt programu GetMappings.ps1 PowerShell umożliwia pobrać bieżące mapowania na mapie danego niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-221">You can use the GetMappings.ps1 PowerShell script to retrieve the current mappings in a given shard map.</span></span>
* <span data-ttu-id="fb0af-222">Zachowanie źródła podziału (podział): dla operacji podziału zdefiniować punkt podziału zakresu źródła.</span><span class="sxs-lookup"><span data-stu-id="fb0af-222">Split Source Behavior (split): For split operations, define the point to split the source range.</span></span> <span data-ttu-id="fb0af-223">Aby to zrobić, podając klucza dzielenia na fragmenty, w miejscu podziału występuje.</span><span class="sxs-lookup"><span data-stu-id="fb0af-223">You do this by providing the sharding key where you want the split to occur.</span></span> <span data-ttu-id="fb0af-224">Użyj przycisku radiowego Określ, czy chcesz dolnej części zakresu (z wyjątkiem klucza podziału) przenieść lub czy ma górnej części, aby przenieść (w tym kluczu podziału).</span><span class="sxs-lookup"><span data-stu-id="fb0af-224">Use the radio button specify whether you want the lower part of the range (excluding the split key) to move, or whether you want the upper part to move (including the split key).</span></span>
* <span data-ttu-id="fb0af-225">Źródło Shardlet (przenoszenia): Przenieś operacji różnią się od dzielenie i scalanie operacji ponieważ nie wymagają one zakres do opisywania źródła.</span><span class="sxs-lookup"><span data-stu-id="fb0af-225">Source Shardlet (move): Move operations are different from split or merge operations as they do not require a range to describe the source.</span></span> <span data-ttu-id="fb0af-226">Źródło przenoszenia po prostu jest identyfikowany przez wartość klucza dzielenia na fragmenty, który ma zostać przeniesiona.</span><span class="sxs-lookup"><span data-stu-id="fb0af-226">A source for move is simply identified by the sharding key value that you plan to move.</span></span>
* <span data-ttu-id="fb0af-227">Docelowy identyfikator niezależnego fragmentu (podział): po informacji podano w źródle operacji podziału, należy określić, gdzie danych ma zostać skopiowany na, podając nazwę serwera i bazy danych bazy danych SQL Azure dla elementu docelowego.</span><span class="sxs-lookup"><span data-stu-id="fb0af-227">Target Shard (split): Once you have provided the information on the source of your split operation, you need to define where you want the data to be copied to by providing the Azure SQL Db server and database name for the target.</span></span>
* <span data-ttu-id="fb0af-228">Zakres docelowy (scalanie): operacji scalania Przenieś shardlets do istniejących niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-228">Target Range (merge): Merge operations move shardlets to an existing shard.</span></span> <span data-ttu-id="fb0af-229">Należy określić istniejącą niezależnego fragmentu zapewniając granice zakresu istniejących zakresu, który chcesz scalić z.</span><span class="sxs-lookup"><span data-stu-id="fb0af-229">You identify the existing shard by providing the range boundaries of the existing range that you want to merge with.</span></span>
* <span data-ttu-id="fb0af-230">Wielkość partii: Wielkość partii określa liczbę shardlets, które przechodzą w tryb offline w czasie przenoszenia danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-230">Batch Size: The batch size controls the number of shardlets that will go offline at a time during the data movement.</span></span> <span data-ttu-id="fb0af-231">Jest wartością całkowitą, których można użyć mniejsze wartości po wrażliwe na długie okresy przestojów w przypadku shardlets.</span><span class="sxs-lookup"><span data-stu-id="fb0af-231">This is an integer value where you can use smaller values when you are sensitive to long periods of downtime for shardlets.</span></span> <span data-ttu-id="fb0af-232">Większe wartości zwiększy się czas danego shardlet w trybie offline, ale może zwiększyć wydajność.</span><span class="sxs-lookup"><span data-stu-id="fb0af-232">Larger values will increase the time that a given shardlet is offline but may improve performance.</span></span>
* <span data-ttu-id="fb0af-233">Identyfikator operacji (anulować): Jeśli masz wykonywana operacja, która nie jest już potrzebne, można anulować operację, podając jego identyfikator operacji w tym polu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-233">Operation Id (Cancel): If you have an ongoing operation that is no longer needed, you can cancel the operation by providing its operation ID in this field.</span></span> <span data-ttu-id="fb0af-234">Identyfikator operacji można pobrać z tabeli stan żądania (zobacz sekcja 8.1) lub z danych wyjściowych w przeglądarce sieci web, w której zostało przesłane żądanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-234">You can retrieve the operation ID from the request status table (see Section 8.1) or from the output in the web browser where you submitted the request.</span></span>

## <a name="requirements-and-limitations"></a><span data-ttu-id="fb0af-235">Wymagania i ograniczenia</span><span class="sxs-lookup"><span data-stu-id="fb0af-235">Requirements and Limitations</span></span>
<span data-ttu-id="fb0af-236">Bieżąca implementacja usługi scalania podziału podlega następujące wymagania i ograniczenia:</span><span class="sxs-lookup"><span data-stu-id="fb0af-236">The current implementation of the split-merge service is subject to the following requirements and limitations:</span></span> 

* <span data-ttu-id="fb0af-237">Odłamków muszą znajdować i być zarejestrowane w mapie niezależnego fragmentu, zanim będzie można wykonać operacji scalania podziału na tych fragmentów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-237">The shards need to exist and be registered in the shard map before a split-merge operation on these shards can be performed.</span></span> 
* <span data-ttu-id="fb0af-238">Usługa nie tworzy tabele lub inne obiekty bazy danych, które automatycznie w ramach operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-238">The service does not create tables or any other database objects automatically as part of its operations.</span></span> <span data-ttu-id="fb0af-239">To oznacza, że schemat dla podzielonej wszystkie tabele i tabele odwołań muszą istnieć na niezależnych docelowy wyewidencjonowywany przed każdą operacją podziału/merge/przeniesienia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-239">This means that the schema for all sharded tables and reference tables need to exist on the target shard prior to any split/merge/move operation.</span></span> <span data-ttu-id="fb0af-240">Tabele podzielonej w szczególności muszą być w zakresie, gdzie mają być dodawane przez operację podziału/merge/przeniesienia shardlets nowy pusty.</span><span class="sxs-lookup"><span data-stu-id="fb0af-240">Sharded tables in particular are required to be empty in the range where new shardlets are to be added by a split/merge/move operation.</span></span> <span data-ttu-id="fb0af-241">W przeciwnym razie operacja zakończy się niepowodzeniem Sprawdzanie spójności początkowej w niezależnych docelowej.</span><span class="sxs-lookup"><span data-stu-id="fb0af-241">Otherwise, the operation will fail the initial consistency check on the target shard.</span></span> <span data-ttu-id="fb0af-242">Należy również zauważyć tego odwołania, które dane są kopiowane tylko, jeśli odwołanie tabela jest pusta, i czy nie występują żadne gwarancje spójności w odniesieniu do innych równoczesnych operacje zapisu w tabeli odniesienia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-242">Also note that reference data is only copied if the reference table is empty and that there are no consistency guarantees with regard to other concurrent write operations on the reference tables.</span></span> <span data-ttu-id="fb0af-243">Jest to zalecane: podczas uruchamiania operacji podziału/merge, żadne inne operacje zapisu zmianę tabele odwołań.</span><span class="sxs-lookup"><span data-stu-id="fb0af-243">We recommend this: when running split/merge operations, no other write operations make changes to the reference tables.</span></span>
* <span data-ttu-id="fb0af-244">Usługa zależy od tożsamości wiersza unikatowy indeks lub klucz, który zawiera klucz dzielenia na fragmenty, aby zwiększyć wydajność i niezawodność shardlets duże.</span><span class="sxs-lookup"><span data-stu-id="fb0af-244">The service relies on row identity established by a unique index or key that includes the sharding key to improve performance and reliability for large shardlets.</span></span> <span data-ttu-id="fb0af-245">Dzięki temu usługa przenoszenia danych w jeszcze bardziej szczegółowy od tylko wartości klucza dzielenia na fragmenty.</span><span class="sxs-lookup"><span data-stu-id="fb0af-245">This allows the service to move data at an even finer granularity than just the sharding key value.</span></span> <span data-ttu-id="fb0af-246">Pozwala to zmniejszyć maksymalną ilość miejsca w dzienniku blokad, które są wymagane podczas operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-246">This helps to reduce the maximum amount of log space and locks that are required during the operation.</span></span> <span data-ttu-id="fb0af-247">Należy rozważyć utworzenie unikatowego indeksu lub klucza podstawowego, w tym klucz dzielenia na fragmenty w danej tabeli, jeśli chcesz użyć tej tabeli z żądaniami podziału/merge/przeniesienia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-247">Consider creating a unique index or a primary key including the sharding key on a given table if you want to use that table with split/merge/move requests.</span></span> <span data-ttu-id="fb0af-248">Ze względu na wydajność klucz dzielenia na fragmenty powinien być wiodące kolumny klucza lub indeksu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-248">For performance reasons, the sharding key should be the leading column in the key or the index.</span></span>
* <span data-ttu-id="fb0af-249">W trakcie przetwarzania żądania niektóre dane shardlet mogą występować zarówno na serwerze źródłowym i docelowym identyfikator niezależnego fragmentu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-249">During the course of request processing, some shardlet data may be present both on the source and the target shard.</span></span> <span data-ttu-id="fb0af-250">Jest to konieczne chronić przed awariami podczas przemieszczania shardlet.</span><span class="sxs-lookup"><span data-stu-id="fb0af-250">This is necessary to protect against failures during the shardlet movement.</span></span> <span data-ttu-id="fb0af-251">Integracja podziału scalanie z mapą niezależnego fragmentu upewnia się, że połączenia w danych zależnych routingu interfejsów API przy użyciu **OpenConnectionForKey** metody na mapie niezależnego fragmentu nie ma żadnych niespójne pośrednich stanów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-251">The integration of split-merge with the shard map ensures that connections through the data dependent routing APIs using the **OpenConnectionForKey** method on the shard map do not see any inconsistent intermediate states.</span></span> <span data-ttu-id="fb0af-252">Jednak podczas nawiązywania połączenia źródłowy lub docelowy odłamków bez użycia **OpenConnectionForKey** metody niespójne pośrednich stanów mogą być widoczne, gdy będą żądań move podziału/merge.</span><span class="sxs-lookup"><span data-stu-id="fb0af-252">However, when connecting to the source or the target shards without using the **OpenConnectionForKey** method, inconsistent intermediate states might be visible when split/merge/move requests are going on.</span></span> <span data-ttu-id="fb0af-253">Połączenia te mogą być wyświetlane wyniki częściowe lub zduplikowane w zależności od czas lub fragmentacji, połączenie znajdujące się poniżej.</span><span class="sxs-lookup"><span data-stu-id="fb0af-253">These connections may show partial or duplicate results depending on the timing or the shard underlying the connection.</span></span> <span data-ttu-id="fb0af-254">To ograniczenie zawiera obecnie połączeń elastycznego skalowania kilku-Shard-zapytania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-254">This limitation currently includes the connections made by Elastic Scale Multi-Shard-Queries.</span></span>
* <span data-ttu-id="fb0af-255">Bazy danych metadanych dla usługi podziału scalania nie może być udostępniany między różne role.</span><span class="sxs-lookup"><span data-stu-id="fb0af-255">The metadata database for the split-merge service must not be shared between different roles.</span></span> <span data-ttu-id="fb0af-256">Na przykład rola usługi scalania podziału uruchomiona w przejściowym musi wskazywać różnych metadanych bazy danych niż roli produkcji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-256">For example, a role of the split-merge service running in staging needs to point to a different metadata database than the production role.</span></span>

## <a name="billing"></a><span data-ttu-id="fb0af-257">Rozliczenia</span><span class="sxs-lookup"><span data-stu-id="fb0af-257">Billing</span></span>
<span data-ttu-id="fb0af-258">Usługa podziału scalania działa jako usługa w chmurze w ramach subskrypcji Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-258">The split-merge service runs as a cloud service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="fb0af-259">W związku z tym dla usługi w chmurze opłaty do Twojego wystąpienia usługi.</span><span class="sxs-lookup"><span data-stu-id="fb0af-259">Therefore charges for cloud services apply to your instance of the service.</span></span> <span data-ttu-id="fb0af-260">Jeśli często wykonać operacji przenoszenia podziału/merge, zaleca się usunąć usługi w chmurze podziału scalania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-260">Unless you frequently perform split/merge/move operations, we recommend you delete your split-merge cloud service.</span></span> <span data-ttu-id="fb0af-261">Zapisuje kosztów uruchomiona albo wdrożyć wystąpienia usługi chmury.</span><span class="sxs-lookup"><span data-stu-id="fb0af-261">That saves costs for running or deployed cloud service instances.</span></span> <span data-ttu-id="fb0af-262">Można ponownie wdrożyć i rozpocząć konfigurację łatwo do uruchomienia, zawsze, gdy trzeba wykonać dzielenie i scalanie operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-262">You can re-deploy and start your readily runnable configuration whenever you need to perform split or merge operations.</span></span> 

## <a name="monitoring"></a><span data-ttu-id="fb0af-263">Monitorowanie</span><span class="sxs-lookup"><span data-stu-id="fb0af-263">Monitoring</span></span>
### <a name="status-tables"></a><span data-ttu-id="fb0af-264">Stan tabel</span><span class="sxs-lookup"><span data-stu-id="fb0af-264">Status tables</span></span>
<span data-ttu-id="fb0af-265">Udostępnia usługi scalania podziału **stan żądania** tabeli w bazie danych magazynu metadanych do monitorowania została zakończona i bieżących żądań.</span><span class="sxs-lookup"><span data-stu-id="fb0af-265">The split-merge Service provides the **RequestStatus** table in the metadata store database for monitoring of completed and ongoing requests.</span></span> <span data-ttu-id="fb0af-266">W tabeli wymieniono wiersz dla każdego żądania podziału scalania, który został przesłany do tego wystąpienia usługi scalania podziału.</span><span class="sxs-lookup"><span data-stu-id="fb0af-266">The table lists a row for each split-merge request that has been submitted to this instance of the split-merge service.</span></span> <span data-ttu-id="fb0af-267">Udostępnia następujące informacje dla każdego żądania:</span><span class="sxs-lookup"><span data-stu-id="fb0af-267">It gives the following information for each request:</span></span>

* <span data-ttu-id="fb0af-268">**Sygnatura czasowa**: godzinę i datę rozpoczęcia żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-268">**Timestamp**: The time and date when the request was started.</span></span>
* <span data-ttu-id="fb0af-269">**OperationId**: A identyfikator GUID, który unikatowo identyfikuje żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-269">**OperationId**: A GUID that uniquely identifies the request.</span></span> <span data-ttu-id="fb0af-270">To żądanie może również anulować operację, gdy jest nadal uruchomione.</span><span class="sxs-lookup"><span data-stu-id="fb0af-270">This request can also be used to cancel the operation while it is still ongoing.</span></span>
* <span data-ttu-id="fb0af-271">**Stan**: bieżący stan żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-271">**Status**: The current state of the request.</span></span> <span data-ttu-id="fb0af-272">Bieżące żądania również wyświetlane Bieżąca faza, w którym jest żądanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-272">For ongoing requests, it also lists the current phase in which the request is.</span></span>
* <span data-ttu-id="fb0af-273">**CancelRequest**: flagę wskazującą, czy żądanie zostało anulowane.</span><span class="sxs-lookup"><span data-stu-id="fb0af-273">**CancelRequest**: A flag that indicates whether the request has been cancelled.</span></span>
* <span data-ttu-id="fb0af-274">**Postęp**: oszacowanie przez procent wykonania operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-274">**Progress**: A percentage estimate of completion for the operation.</span></span> <span data-ttu-id="fb0af-275">Wartość 50 wskazuje, że operacja jest wykonano około 50%.</span><span class="sxs-lookup"><span data-stu-id="fb0af-275">A value of 50 indicates that the operation is approximately 50% complete.</span></span>
* <span data-ttu-id="fb0af-276">**Szczegóły**: wartości XML, która zapewnia bardziej szczegółowy raport postępu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-276">**Details**: An XML value that provides a more detailed progress report.</span></span> <span data-ttu-id="fb0af-277">Raport dotyczący postępu jest okresowo aktualizowany jako zestawy wierszy są kopiowane z źródłowego do docelowego.</span><span class="sxs-lookup"><span data-stu-id="fb0af-277">The progress report is periodically updated as sets of rows are copied from source to target.</span></span> <span data-ttu-id="fb0af-278">W przypadku awarii lub wyjątki ta kolumna zawiera bardziej szczegółowe informacje o awarii.</span><span class="sxs-lookup"><span data-stu-id="fb0af-278">In case of failures or exceptions, this column also includes more detailed information about the failure.</span></span>

### <a name="azure-diagnostics"></a><span data-ttu-id="fb0af-279">Diagnostyka Azure</span><span class="sxs-lookup"><span data-stu-id="fb0af-279">Azure Diagnostics</span></span>
<span data-ttu-id="fb0af-280">Usługa scalania podziału używa diagnostyki Azure oparte na 2.5 zestawu SDK platformy Azure, monitorowania i diagnostyki.</span><span class="sxs-lookup"><span data-stu-id="fb0af-280">The split-merge service uses Azure Diagnostics based on Azure SDK 2.5 for monitoring and diagnostics.</span></span> <span data-ttu-id="fb0af-281">Konfiguracją diagnostyki opisane tutaj: [Włączanie diagnostyki w usług Azure Cloud Services i maszyn wirtualnych](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="fb0af-281">You control the diagnostics configuration as explained here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> <span data-ttu-id="fb0af-282">Pakiet do pobrania zawiera dwie konfiguracje diagnostyki — jeden dla roli sieci web i jeden dla roli proces roboczy.</span><span class="sxs-lookup"><span data-stu-id="fb0af-282">The download package includes two diagnostics configurations - one for the web role and one for the worker role.</span></span> <span data-ttu-id="fb0af-283">Te konfiguracje diagnostyki dla usługi, postępuj zgodnie ze wskazówkami [podstawy usługi w chmurze w systemie Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span><span class="sxs-lookup"><span data-stu-id="fb0af-283">These diagnostics configurations for the service follow the guidance from [Cloud Service Fundamentals in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="fb0af-284">Zawiera definicje, aby rejestrować liczniki wydajności, dzienniki programu IIS, dzienniki zdarzeń systemu Windows i dzienniki zdarzeń aplikacji podziału scalania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-284">It includes the definitions to log Performance Counters, IIS logs, Windows Event Logs, and split-merge application event logs.</span></span> 

## <a name="deploy-diagnostics"></a><span data-ttu-id="fb0af-285">Wdrażanie diagnostyki</span><span class="sxs-lookup"><span data-stu-id="fb0af-285">Deploy Diagnostics</span></span>
<span data-ttu-id="fb0af-286">Aby włączyć, monitorowania i diagnostyki za pomocą konfiguracji diagnostycznych dla ról sieci web i proces roboczy udostępniane przez pakiet NuGet, uruchom następujące polecenia przy użyciu programu Azure PowerShell:</span><span class="sxs-lookup"><span data-stu-id="fb0af-286">To enable monitoring and diagnostics using the diagnostic configuration for the web and worker roles provided by the NuGet package, run the following commands using Azure PowerShell:</span></span> 

    $storage_name = "<YourAzureStorageAccount>" 

    $key = "<YourAzureStorageAccountKey" 

    $storageContext = New-AzureStorageContext -StorageAccountName $storage_name -StorageAccountKey $key  


    $config_path = "<YourFilePath>\SplitMergeWebContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWeb" 


    $config_path = "<YourFilePath>\SplitMergeWorkerContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWorker" 

<span data-ttu-id="fb0af-287">Można znaleźć więcej informacji na temat Konfigurowanie i wdrażanie ustawień diagnostycznych tutaj: [Włączanie diagnostyki w usług Azure Cloud Services i maszyn wirtualnych](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="fb0af-287">You can find more information on how to configure and deploy diagnostics settings here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> 

## <a name="retrieve-diagnostics"></a><span data-ttu-id="fb0af-288">Pobrać diagnostyki</span><span class="sxs-lookup"><span data-stu-id="fb0af-288">Retrieve diagnostics</span></span>
<span data-ttu-id="fb0af-289">Diagnostycznej mogli łatwo uzyskiwać dostęp z Eksploratora serwera Visual Studio w Azure części drzewa Eksploratora serwera.</span><span class="sxs-lookup"><span data-stu-id="fb0af-289">You can easily access your diagnostics from the Visual Studio Server Explorer in the Azure part of the Server Explorer tree.</span></span> <span data-ttu-id="fb0af-290">Otwórz wystąpienie programu Visual Studio, a na pasku menu kliknij widok i Eksploratora serwera.</span><span class="sxs-lookup"><span data-stu-id="fb0af-290">Open a Visual Studio instance, and in the menu bar click View, and Server Explorer.</span></span> <span data-ttu-id="fb0af-291">Kliknij ikonę platformy Azure, aby nawiązać połączenia z subskrypcją platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-291">Click the Azure icon to connect to your Azure subscription.</span></span> <span data-ttu-id="fb0af-292">Następnie przejdź do usługi Azure -> magazynu -> <your storage account> -> WADLogsTable -> tabel.</span><span class="sxs-lookup"><span data-stu-id="fb0af-292">Then navigate to Azure -> Storage -> <your storage account> -> Tables -> WADLogsTable.</span></span> <span data-ttu-id="fb0af-293">Aby uzyskać więcej informacji, zobacz [przeglądanie zasobami magazynu za pomocą Eksploratora serwera](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="fb0af-293">For more information, see [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span></span> 

![WADLogsTable][2]

<span data-ttu-id="fb0af-295">WADLogsTable wyróżnione na rysunku powyżej zawiera szczegółowe zdarzenia z dziennika aplikacji usługi podziału scalania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-295">The WADLogsTable highlighted in the figure above contains the detailed events from the split-merge service’s application log.</span></span> <span data-ttu-id="fb0af-296">Należy pamiętać, że domyślna konfiguracja pobranego pakietu jest przeznaczone dla wdrożenia produkcyjnego.</span><span class="sxs-lookup"><span data-stu-id="fb0af-296">Note that the default configuration of the downloaded package is geared towards a production deployment.</span></span> <span data-ttu-id="fb0af-297">W związku z tym interwał, jaką dzienniki i liczniki są pobierane z wystąpień usługi jest duża (5 minut).</span><span class="sxs-lookup"><span data-stu-id="fb0af-297">Therefore the interval at which logs and counters are pulled from the service instances is large (5 minutes).</span></span> <span data-ttu-id="fb0af-298">Badań i rozwoju niższym interwał dostosowując ustawienia diagnostyki sieci web lub roli procesu roboczego do własnych potrzeb.</span><span class="sxs-lookup"><span data-stu-id="fb0af-298">For test and development, lower the interval by adjusting the diagnostics settings of the web or the worker role to your needs.</span></span> <span data-ttu-id="fb0af-299">Kliknij prawym przyciskiem myszy rolę w Eksploratorze serwera usługi Visual Studio (zobacz powyżej), a następnie Dostosuj okres transferu w oknie dialogowym ustawień konfiguracji diagnostyki:</span><span class="sxs-lookup"><span data-stu-id="fb0af-299">Right-click on the role in the Visual Studio Server Explorer (see above) and then adjust the Transfer Period in the dialog for the Diagnostics configuration settings:</span></span> 

![Konfiguracja][3]

## <a name="performance"></a><span data-ttu-id="fb0af-301">Wydajność</span><span class="sxs-lookup"><span data-stu-id="fb0af-301">Performance</span></span>
<span data-ttu-id="fb0af-302">Ogólnie rzecz biorąc lepszą wydajność ma z tym wyższy więcej wydajności warstw usług w bazie danych SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="fb0af-302">In general, better performance is to be expected from the higher, more performant service tiers in Azure SQL Database.</span></span> <span data-ttu-id="fb0af-303">Wyższy alokacji we/wy, Procesor i pamięć dla wyższych warstw usługi korzystać kopiowania zbiorczego i usuwanie operacji używane przez usługę podziału scalania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-303">Higher IO, CPU and memory allocations for the higher service tiers benefit the bulk copy and delete operations that the split-merge service uses.</span></span> <span data-ttu-id="fb0af-304">Z tego powodu należy zwiększyć warstwy usługi tylko dla tych baz danych zdefiniowana, ograniczony okres czasu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-304">For that reason, increase the service tier just for those databases for a defined, limited period of time.</span></span>

<span data-ttu-id="fb0af-305">Usługa również wykonuje zapytania weryfikacji w ramach normalnych operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-305">The service also performs validation queries as part of its normal operations.</span></span> <span data-ttu-id="fb0af-306">Te zapytania weryfikacji sprawdzić nieoczekiwany obecności danych w zakresie docelowego i upewnij się, że wszelkie operacje podziału/merge/przeniesienia zaczyna się w spójnym stanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-306">These validation queries check for unexpected presence of data in the target range and ensure that any split/merge/move operation starts from a consistent state.</span></span> <span data-ttu-id="fb0af-307">Te wszystkie zapytania pracować nad dzielenia na fragmenty zakresami kluczy zdefiniowane w zakresie operacji i rozmiar partii w ramach definicji żądania.</span><span class="sxs-lookup"><span data-stu-id="fb0af-307">These queries all work over sharding key ranges defined by the scope of the operation and the batch size provided as part of the request definition.</span></span> <span data-ttu-id="fb0af-308">Te zapytania wykonywane najlepiej, gdy indeks jest obecnie z kluczem dzielenia na fragmenty jako wiodących kolumn.</span><span class="sxs-lookup"><span data-stu-id="fb0af-308">These queries perform best when an index is present that has the sharding key as the leading column.</span></span> 

<span data-ttu-id="fb0af-309">Ponadto przy użyciu klucza wiodące kolumny dzielenia na fragmenty właściwość unikatowości umożliwi usługi do zoptymalizowane metody, która ogranicza zużycie zasobów w zakresie miejsca w dzienniku i pamięci.</span><span class="sxs-lookup"><span data-stu-id="fb0af-309">In addition, a uniqueness property with the sharding key as the leading column will allow the service to use an optimized approach that limits resource consumption in terms of log space and memory.</span></span> <span data-ttu-id="fb0af-310">Ta właściwość unikatowości musi przenieść rozmiary dużej ilości danych (zazwyczaj ponad 1GB).</span><span class="sxs-lookup"><span data-stu-id="fb0af-310">This uniqueness property is required to move large data sizes (typically above 1GB).</span></span> 

## <a name="how-to-upgrade"></a><span data-ttu-id="fb0af-311">Jak uaktualnić</span><span class="sxs-lookup"><span data-stu-id="fb0af-311">How to upgrade</span></span>
1. <span data-ttu-id="fb0af-312">Postępuj zgodnie z instrukcjami [wdrożyć usługę scalania podziału](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="fb0af-312">Follow the steps in [Deploy a split-merge service](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span></span>
2. <span data-ttu-id="fb0af-313">Zmienianie pliku konfiguracji usługi chmury dla danego wdrożenia podziału scalania uwzględnić nowe parametry konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-313">Change your cloud service configuration file for your split-merge deployment to reflect the new configuration parameters.</span></span> <span data-ttu-id="fb0af-314">Informacje o certyfikat używany do szyfrowania jest nowy parametr wymagany.</span><span class="sxs-lookup"><span data-stu-id="fb0af-314">A new required parameter is the information about the certificate used for encryption.</span></span> <span data-ttu-id="fb0af-315">Prosty sposób, w tym celu jest do porównania nowy plik szablonu konfiguracji z pobierania względem istniejącej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-315">An easy way to do this is to compare the new configuration template file from the download against your existing configuration.</span></span> <span data-ttu-id="fb0af-316">Upewnij się, że możesz dodać ustawienia "DataEncryptionPrimaryCertificateThumbprint" i "DataEncryptionPrimary" dla sieci web i roli proces roboczy.</span><span class="sxs-lookup"><span data-stu-id="fb0af-316">Make sure you add the settings for “DataEncryptionPrimaryCertificateThumbprint” and “DataEncryptionPrimary” for both the web and the worker role.</span></span>
3. <span data-ttu-id="fb0af-317">Przed wdrożeniem aktualizacji na platformie Azure, upewnij się, że wszystkie operacje aktualnie uruchomione podziału scalanie zostało ukończone.</span><span class="sxs-lookup"><span data-stu-id="fb0af-317">Before deploying the update to Azure, ensure that all currently running split-merge operations have finished.</span></span> <span data-ttu-id="fb0af-318">Można łatwo tym badając stan żądania i PendingWorkflows tabele w bazie danych metadanych scalania podziału bieżących żądań.</span><span class="sxs-lookup"><span data-stu-id="fb0af-318">You can easily do this by querying the RequestStatus and PendingWorkflows tables in the split-merge metadata database for ongoing requests.</span></span>
4. <span data-ttu-id="fb0af-319">Zaktualizowanie istniejącego wdrożenia usługi podziału scalanie w Twojej subskrypcji platformy Azure chmury o nowy pakiet i zaktualizowany plik konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-319">Update your existing cloud service deployment for split-merge in your Azure subscription with the new package and your updated service configuration file.</span></span>

<span data-ttu-id="fb0af-320">Nie należy do udostępnienia nowej bazy danych metadanych scalania podziału do uaktualnienia.</span><span class="sxs-lookup"><span data-stu-id="fb0af-320">You do not need to provision a new metadata database for split-merge to upgrade.</span></span> <span data-ttu-id="fb0af-321">Nowej wersji automatycznie zaktualizuje istniejące bazy danych metadanych do nowej wersji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-321">The new version will automatically upgrade your existing metadata database to the new version.</span></span> 

## <a name="best-practices--troubleshooting"></a><span data-ttu-id="fb0af-322">Najlepsze rozwiązania i rozwiązywanie problemów</span><span class="sxs-lookup"><span data-stu-id="fb0af-322">Best practices & troubleshooting</span></span>
* <span data-ttu-id="fb0af-323">Zdefiniuj dzierżawcą testowym i wykonuje operacje podziału/merge/przeniesienia najważniejszych z dzierżawcą testowym między kilka fragmentów.</span><span class="sxs-lookup"><span data-stu-id="fb0af-323">Define a test tenant and exercise your most important split/merge/move operations with the test tenant across several shards.</span></span> <span data-ttu-id="fb0af-324">Upewnij się, że wszystkie metadane jest zdefiniowany poprawnie na mapie niezależnego fragmentu i operacje nie naruszają ograniczeń lub klucze obce.</span><span class="sxs-lookup"><span data-stu-id="fb0af-324">Ensure that all metadata is defined correctly in your shard map and that the operations do not violate constraints or foreign keys.</span></span>
* <span data-ttu-id="fb0af-325">Zachowaj dzierżawcą testowym problemy związane z rozmiar danych powyżej maksymalnego rozmiaru danych dzierżawy największy, aby upewnić się, pojawiły się nie rozmiar danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-325">Keep the test tenant data size above the maximum data size of your largest tenant to ensure you are not encountering data size related issues.</span></span> <span data-ttu-id="fb0af-326">Dzięki temu można ocenić górna granica na czas potrzebny do przenoszenia pojedynczej dzierżawy.</span><span class="sxs-lookup"><span data-stu-id="fb0af-326">This helps you assess an upper bound on the time it takes to move a single tenant around.</span></span> 
* <span data-ttu-id="fb0af-327">Upewnij się, że schemat zezwala na usuwanie.</span><span class="sxs-lookup"><span data-stu-id="fb0af-327">Make sure that your schema allows deletions.</span></span> <span data-ttu-id="fb0af-328">Usługa podziału scalania wymaga możliwość usunięcia danych z niezależnych źródła, gdy dane zostały pomyślnie skopiowane do obiektu docelowego.</span><span class="sxs-lookup"><span data-stu-id="fb0af-328">The split-merge service requires the ability to remove data from the source shard once the data has been successfully copied to the target.</span></span> <span data-ttu-id="fb0af-329">Na przykład **Usuwanie wyzwalaczy** można zapobiec usuwania danych w źródle i może spowodować niepowodzenie operacji.</span><span class="sxs-lookup"><span data-stu-id="fb0af-329">For example, **delete triggers** can prevent the service from deleting the data on the source and may cause operations to fail.</span></span>
* <span data-ttu-id="fb0af-330">Klucz dzielenia na fragmenty należy wiodących kolumn w kluczu podstawowym lub definicji unikatowego indeksu.</span><span class="sxs-lookup"><span data-stu-id="fb0af-330">The sharding key should be the leading column in your primary key or unique index definition.</span></span> <span data-ttu-id="fb0af-331">Dzięki temu najlepszą wydajność zapytań weryfikacji dzielenie i scalanie i rzeczywiste dane przenoszenie i usuwanie operacji zawsze działających na zakresami kluczy dzielenia na fragmenty.</span><span class="sxs-lookup"><span data-stu-id="fb0af-331">That ensures the best performance for the split or merge validation queries, and for the actual data movement and deletion operations which always operate on sharding key ranges.</span></span>
* <span data-ttu-id="fb0af-332">W ten sposób rozmieszczać usługi podziału scalania w centrum danych i regionu, gdzie znajdują się bazy danych.</span><span class="sxs-lookup"><span data-stu-id="fb0af-332">Collocate your split-merge service in the region and data center where your databases reside.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-overview-split-and-merge/split-merge-overview.png
[2]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics.png
[3]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics-config.png

