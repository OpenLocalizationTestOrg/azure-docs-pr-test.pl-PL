---
title: "aaaDesign usługi wysokiej dostępności przy użyciu usługi Azure SQL Database | Dokumentacja firmy Microsoft"
description: "Więcej informacji na temat projektowania aplikacji dla usługi wysokiej dostępności przy użyciu bazy danych SQL Azure."
keywords: "w chmurze odzyskiwania po awarii, rozwiązania w zakresie odzyskiwania po awarii, kopia zapasowa danych aplikacji, replikacja geograficzna, planowanie ciągłości biznesowej"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 815f754ba7014cd8a1108a2d84c2a8f71d7030a5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="f7968-104">Projektowanie usługi wysokiej dostępności przy użyciu bazy danych SQL Azure</span><span class="sxs-lookup"><span data-stu-id="f7968-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="f7968-105">Podczas tworzenia i wdrażania usług wysokiej dostępności w bazie danych SQL Azure, użyj [trybu failover grupy i aktywna replikacja geograficzna](sql-database-geo-replication-overview.md) tooprovide odporności tooregional awarie i poważnej awarii i Włącz szybkie odzyskiwanie toohello pomocniczej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) tooprovide resilience tooregional failures and catastrophic outages and enable fast recovery toohello secondary databases.</span></span> <span data-ttu-id="f7968-106">Ten artykuł skupia się na typowe wzorce aplikacji i omówiono hello zalety i możliwości poszczególnych opcji, w zależności od wymagań wdrażania aplikacji hello, hello Umowa dotycząca poziomu usług przeznaczonych, opóźnienia ruchu i koszty.</span><span class="sxs-lookup"><span data-stu-id="f7968-106">This article focuses on common application patterns and discusses hello benefits and trade-offs of each option depending on hello application deployment requirements, hello service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="f7968-107">Informacje aktywna replikacja geograficzna z pule elastyczne, zobacz [strategii odzyskiwania danych w puli elastycznej](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="f7968-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="f7968-108">Wzorzec projektowy 1: aktywny / pasywny wdrożenia do chmury odzyskiwania po awarii z tej samej lokalizacji bazy danych</span><span class="sxs-lookup"><span data-stu-id="f7968-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="f7968-109">Ta opcja jest najbardziej odpowiednie dla aplikacji z hello następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="f7968-109">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="f7968-110">Wystąpienia aktywne w pojedynczym regionie Azure</span><span class="sxs-lookup"><span data-stu-id="f7968-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="f7968-111">Silne zależność od toodata dostępu (RW) do odczytu / zapisu</span><span class="sxs-lookup"><span data-stu-id="f7968-111">Strong dependency on read-write (RW) access toodata</span></span>
* <span data-ttu-id="f7968-112">Łączność między region hello bazy danych i aplikacji sieci web hello nie jest akceptowane powodu kosztów toolatency i ruchu</span><span class="sxs-lookup"><span data-stu-id="f7968-112">Cross-region connectivity between hello web application and hello database is not acceptable due toolatency and traffic cost</span></span>    

<span data-ttu-id="f7968-113">W takim przypadku topologii wdrożenia aplikacji hello jest zoptymalizowany do obsługi regionalnej awarii, gdy wpływ na wszystkie składniki aplikacji i toofailover jako jednostka.</span><span class="sxs-lookup"><span data-stu-id="f7968-113">In this case, hello application deployment topology is optimized for handling regional disasters when all application components are impacted and need toofailover as a unit.</span></span> <span data-ttu-id="f7968-114">W celu zapewnienia nadmiarowości geograficznej logiki aplikacji hello i hello bazy danych są replikowane tooanother region, ale nie są używane dla obciążenia aplikacji hello w normalnych warunkach hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-114">For geographic redundancy, hello application logic and hello database are replicated tooanother region but they are not used for hello application workload under hello normal conditions.</span></span> <span data-ttu-id="f7968-115">Aplikacja Hello w regionie pomocniczym hello powinien być skonfigurowany toouse połączenia ciąg toohello pomocniczej bazy danych SQL.</span><span class="sxs-lookup"><span data-stu-id="f7968-115">hello application in hello secondary region should be configured toouse a SQL connection string toohello secondary database.</span></span> <span data-ttu-id="f7968-116">Menedżer ruchu skonfigurowano toouse [metody routingu dla trybu failover](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="f7968-116">Traffic manager is set up toouse [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="f7968-117">[Menedżer ruchu Azure](../traffic-manager/traffic-manager-overview.md) jest używany w tym artykule wyłącznie dla celów ilustracyjnych.</span><span class="sxs-lookup"><span data-stu-id="f7968-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="f7968-118">Można użyć dowolnego równoważenia obciążenia rozwiązania, które obsługuje metody routingu dla trybu failover.</span><span class="sxs-lookup"><span data-stu-id="f7968-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="f7968-119">powitania po diagramie przedstawiono tę konfigurację przed awarią.</span><span class="sxs-lookup"><span data-stu-id="f7968-119">hello following diagram shows this configuration before an outage.</span></span>

![Konfiguracja — replikacja geograficzna bazy danych SQL.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="f7968-122">Po awarii w regionie podstawowym hello usługi baza danych SQL hello wykrywa głównej bazy danych hello nie jest dostępny i wyzwolić tryb failover toohello pomocniczej bazy danych na podstawie parametrów hello hello zasad automatycznej pracy awaryjnej.</span><span class="sxs-lookup"><span data-stu-id="f7968-122">After an outage in hello primary region, hello SQL Database service detects that hello primary database is not accessible and trigger a failover toohello secondary database based on hello parameters of hello automatic failover policy.</span></span> <span data-ttu-id="f7968-123">W zależności od Twojego umowy SLA dla aplikacji można określić tooconfigure okres prolongaty między hello wykrywania awarii hello i pracy awaryjnej hello, sama.</span><span class="sxs-lookup"><span data-stu-id="f7968-123">Depending on your application SLA, you can decide tooconfigure a grace period between hello detection of hello outage and hello failover itself.</span></span> <span data-ttu-id="f7968-124">Konfigurowanie okresu prolongaty zmniejsza ryzyko hello przypadków gdzie jest poważnej awarii hello i dostępności w regionie hello nie można szybko przywrócić toohello utraty danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-124">Configuring a grace period reduces hello risk of data loss toohello cases where hello outage is catastrophic and availability in hello region cannot be quickly restored.</span></span> <span data-ttu-id="f7968-125">Jeśli hello punktu końcowego w tryb failover jest inicjowane przez Menedżera ruchu hello przed hello trybu failover grupy wyzwalaczy hello trybu failover hello bazy danych, aplikacji sieci web hello nie jest możliwe tooreconnect toohello w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-125">If hello endpoint failover is initiated by hello traffic manager before hello failover group triggers hello failover of hello database, hello web application is not able tooreconnect toohello database.</span></span> <span data-ttu-id="f7968-126">aplikacji Hello tooreconnect próba powiedzie się automatycznie, zaraz po zakończeniu hello trybu failover z bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-126">hello application’s attempt tooreconnect automatically succeeds as soon as hello database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="f7968-127">tooachieve całkowicie koordynowany pracy awaryjnej aplikacji hello i hello baz danych, należy opracować metodę monitorowania i użyć ręcznego przełączania trybu failover hello punktów końcowych z aplikacji sieci web i hello baz danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-127">tooachieve fully coordinated failover of hello application and hello databases, you should devise your own monitoring method and use manual failover of hello web application endpoints and hello databases.</span></span>
>

<span data-ttu-id="f7968-128">Po ukończeniu pracy awaryjnej hello aplikacji hello punktów końcowych i hello bazy danych aplikacji hello ponownie rozpocznie przetwarzanie żądania użytkownika hello w regionie hello B i pozostanie wspólnie z hello bazy danych, ponieważ hello podstawowa baza danych jest teraz w region B. W tym scenariuszu przedstawiono na powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="f7968-128">After hello failover of both hello application’s endpoints and hello database completes, hello application will re-start processing hello user requests in hello region B and will remain co-located with hello database because hello primary database is now in region B. This scenario is illustrated in hello following diagram.</span></span> <span data-ttu-id="f7968-129">W wszystkie diagramy aktywnych połączeń wskazuje linia ciągła, linie przerywana wskazują wstrzymaną połączeń i znaki stop wskazać wyzwalaczy akcji.</span><span class="sxs-lookup"><span data-stu-id="f7968-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Replikacja geograficzna: Baza danych toosecondary trybu Failover.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="f7968-132">W przypadku wystąpienia awarii w regionie pomocniczym hello, hello łącze replikacji między hello głównej i pomocniczej bazy danych hello jest wstrzymana, ale hello trybu failover nie jest uruchamiane, ponieważ nie ma wpływu na powitania podstawowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-132">If an outage happens in hello secondary region, hello replication link between hello primary and hello secondary database is suspended but hello failover is not triggered because hello primary database is not impacted.</span></span> <span data-ttu-id="f7968-133">dostępność aplikacji Hello nie ulega zmianie w takim przypadku, ale aplikacji hello działa narażonych i w związku z tym bardziej narażony w przypadku obu regionów awarii w przedziale czasu.</span><span class="sxs-lookup"><span data-stu-id="f7968-133">hello application's availability is not changed in this case, but hello application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="f7968-134">Do odzyskiwania po awarii zalecamy hello konfiguracji z regionami tootwo ograniczone wdrożenia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f7968-134">For disaster recovery we recommend hello configuration with application deployment limited tootwo regions.</span></span> <span data-ttu-id="f7968-135">Jest to spowodowane większości hello Azure lokalizacji geograficznych mieć tylko dwóch regionach.</span><span class="sxs-lookup"><span data-stu-id="f7968-135">This is because most of hello Azure geographies have only two regions.</span></span> <span data-ttu-id="f7968-136">Ta konfiguracja nie będzie chronić aplikacji z jednoczesnych poważnej awarii obu regionów.</span><span class="sxs-lookup"><span data-stu-id="f7968-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="f7968-137">W przypadku mało prawdopodobnego takiej awarii, można odzyskać bazy danych za pomocą trzeci region [operacji przywracania geograficznie](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="f7968-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="f7968-138">Po awarii hello skuteczność została osłabiona hello dodatkowej bazy danych zostanie automatycznie ponownie wykonywać synchronizację z hello podstawowego.</span><span class="sxs-lookup"><span data-stu-id="f7968-138">Once hello outage is mitigated, hello secondary database will automatically re-synchronize with hello primary.</span></span> <span data-ttu-id="f7968-139">Podczas synchronizacji wydajności hello głównej może dotyczyć nieco w zależności od hello ilości danych wymaga toobe zsynchronizowane.</span><span class="sxs-lookup"><span data-stu-id="f7968-139">During synchronization, performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="f7968-140">Witaj poniższym diagramie przedstawiono awaria w regionie pomocniczym hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-140">hello following diagram illustrates an outage in hello secondary region.</span></span>

![Dodatkowej bazy danych są synchronizowane z podstawowym.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="f7968-143">klucz Hello **zalety** tego wzorca projektu są:</span><span class="sxs-lookup"><span data-stu-id="f7968-143">hello key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="f7968-144">Witaj tej samej aplikacji sieci web jest regionów wdrożonej tooboth bez żadnej konfiguracji określonego regionu i trybu failover toohello tooreact dodatkową logikę.</span><span class="sxs-lookup"><span data-stu-id="f7968-144">hello same web application is deployed tooboth regions without any region-specific configuration and no additional logic tooreact toohello failover.</span></span> 
* <span data-ttu-id="f7968-145">wydajność aplikacji Hello nie ma wpływu na pracy awaryjnej jako hello aplikacji sieci web i bazy danych hello są zawsze wspólnie.</span><span class="sxs-lookup"><span data-stu-id="f7968-145">hello application's performance is not impacted by failover as hello web application and hello database are always co-located.</span></span>

<span data-ttu-id="f7968-146">Witaj głównego **zależnościami** jest to, że nadmiarowe aplikacji hello wystąpienie w regionie pomocniczym hello jest używany tylko do odzyskiwania po awarii.</span><span class="sxs-lookup"><span data-stu-id="f7968-146">hello main **tradeoff** is that hello redundant application instance in hello secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="f7968-147">Wzorzec projektowy 2: Wdrażanie aktywny aktywny w programie Równoważenie obciążenia aplikacji</span><span class="sxs-lookup"><span data-stu-id="f7968-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="f7968-148">Tej opcji odzyskiwania po awarii chmury jest najbardziej odpowiednie dla aplikacji z hello następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="f7968-148">This cloud disaster recovery option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="f7968-149">Wysoki współczynnik bazy danych odczytuje toowrites</span><span class="sxs-lookup"><span data-stu-id="f7968-149">High ratio of database reads toowrites</span></span>
* <span data-ttu-id="f7968-150">Baza danych opóźnienie odczytu jest dla użytkownika końcowego hello ważniejsze niż opóźnienie zapisu na powitania</span><span class="sxs-lookup"><span data-stu-id="f7968-150">Database read latency is more critical for hello end-user experience than hello write latency</span></span> 
* <span data-ttu-id="f7968-151">Logika tylko do odczytu mogą być oddzielone od logiki odczytu i zapisu przy użyciu innego połączenia ciągu</span><span class="sxs-lookup"><span data-stu-id="f7968-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="f7968-152">Logika tylko do odczytu nie zależy od danych pełni synchronizowana z najnowszymi aktualizacjami hello</span><span class="sxs-lookup"><span data-stu-id="f7968-152">Read-only logic does not depend on data being fully synchronized with hello latest updates</span></span>  

<span data-ttu-id="f7968-153">Jeśli aplikacje mają te właściwości, równoważenie obciążenia hello połączeń użytkowników końcowych w wielu wystąpień aplikacji w różnych regionach znacząco poprawić hello środowisko pracy użytkownika końcowego.</span><span class="sxs-lookup"><span data-stu-id="f7968-153">If your applications have these characteristics, load balancing hello end-user connections across multiple application instances in different regions can substantially improve hello overall end-user experience.</span></span> <span data-ttu-id="f7968-154">Dwóch regionach hello należy wybrać jako hello pary odzyskiwania po awarii i hello trybu failover grupa powinna zawierać hello baz danych w tych obszarach.</span><span class="sxs-lookup"><span data-stu-id="f7968-154">Two of hello regions should be selected as hello DR pair and hello failover group should include hello databases in these regions.</span></span> <span data-ttu-id="f7968-155">tooimplement równoważenia obciążenia, każdy region powinien mieć aktywne wystąpienia aplikacji hello z hello odczytu i zapisu (RW) logiki połączone toohello odbiornika odczytu i zapisu punktem końcowym hello trybu failover grupy.</span><span class="sxs-lookup"><span data-stu-id="f7968-155">tooimplement load-balancing, each region should have an active instance of hello application with hello read-write (RW) logic connected toohello read-write listener endpoint of hello failover group.</span></span> <span data-ttu-id="f7968-156">Będzie ona zagwarantować, że czy tryb failover hello zostanie automatycznie rozpoczęte Jeśli podstawowa baza danych: hello jest wpływ awaria.</span><span class="sxs-lookup"><span data-stu-id="f7968-156">It will guarantee that hello failover will be automatically initiated if hello primary database is impacted by an outage.</span></span> <span data-ttu-id="f7968-157">Witaj tylko do odczytu logiki (RO) w aplikacji sieci web hello należy łączyć bezpośrednio toohello bazy danych, w tym regionie.</span><span class="sxs-lookup"><span data-stu-id="f7968-157">hello read-only logic (RO) in hello web application should connect directly toohello database in that region.</span></span> <span data-ttu-id="f7968-158">Usługi Traffic manager można skonfigurować toouse [wydajności routingu](../traffic-manager/traffic-manager-configure-performance-routing-method.md) z [punkt końcowy monitorowania](../traffic-manager/traffic-manager-monitoring.md) włączony dla każdego wystąpienia aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f7968-158">Traffic manager should be set up toouse [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="f7968-159">Jak wzorzec #1 należy rozważyć wdrożenie podobne monitorowania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f7968-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="f7968-160">Ale w przeciwieństwie do wzorca #1 hello monitorowania aplikacji nie będzie odpowiedzialna za wyzwolenie pracy awaryjnej punktu końcowego hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-160">But unlike pattern #1, hello monitoring application will not be responsible for triggering hello end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="f7968-161">Ten wzorzec korzysta z więcej niż jednej pomocniczej bazy danych, tylko hello dodatkowej w regionie B będzie używany na potrzeby trybu failover i powinna być częścią hello trybu failover grupy.</span><span class="sxs-lookup"><span data-stu-id="f7968-161">While this pattern uses more than one secondary database, only hello secondary in Region B  would be used for failover and should be part of hello failover group.</span></span>
>

<span data-ttu-id="f7968-162">Menedżer ruchu należy skonfigurować dla lokalizacji geograficznej wydajności routingu toodirect hello użytkownika połączenia toohello wystąpienia najbliższego toohello użytkownika aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f7968-162">Traffic manager should be configured for performance routing toodirect hello user connections toohello application instance closest toohello user's geographic location.</span></span> <span data-ttu-id="f7968-163">powitania po diagram przedstawia tej konfiguracji przed awarią.</span><span class="sxs-lookup"><span data-stu-id="f7968-163">hello following diagram illustrates this configuration before an outage.</span></span>

![Nie przestoju: wydajności routingu toonearest aplikacji.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="f7968-166">Wykrycie awarii bazy danych w regionie hello A hello trybu failover grupy będą automatycznie Inicjuj tryb failover hello głównej bazy danych w dodatkowej toohello region, A w regionie B. Zostanie również automatycznie zaktualizować hello odbiornika odczytu i zapisu punktu końcowego tooregion B, Odczyt i zapis połączenia w aplikacji sieci web hello nie wpłynie na.</span><span class="sxs-lookup"><span data-stu-id="f7968-166">If a database outage is detected in hello region A, hello failover group will automatically initiate failover of hello primary database in region A toohello secondary in region B. It will also automatically update hello read-write listener endpoint tooregion B so read-write connections in hello web application will not be impacted.</span></span> <span data-ttu-id="f7968-167">Menedżera ruchu Hello powoduje wyłączenie punktu końcowego w trybie offline hello z tabeli routingu hello, ale będzie nadal routingu hello użytkownika końcowego ruchu toohello pozostałych online wystąpień.</span><span class="sxs-lookup"><span data-stu-id="f7968-167">hello traffic manager will exclude hello offline end-point from hello routing table but will continue routing hello end-user traffic toohello remaining online instances.</span></span> <span data-ttu-id="f7968-168">Witaj parametry połączenia SQL tylko do odczytu nie jest ograniczona zgodnie z ich zawsze punktu toohello bazy danych w hello tego samego regionu.</span><span class="sxs-lookup"><span data-stu-id="f7968-168">hello read-only SQL connection strings will not be impacted as they always point toohello database in hello same region.</span></span> 

<span data-ttu-id="f7968-169">powitania po diagram przedstawia hello nowej konfiguracji po hello w tryb failover.</span><span class="sxs-lookup"><span data-stu-id="f7968-169">hello following diagram illustrates hello new configuration after hello failover.</span></span>

![Konfiguracja po pracy awaryjnej.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="f7968-172">W przypadku wystąpienia awarii w dodatkowej regionów hello hello Menedżera ruchu spowoduje automatyczne usunięcie punktu końcowego w trybie offline hello w tym regionie z hello tabeli routingu.</span><span class="sxs-lookup"><span data-stu-id="f7968-172">In case of an outage in one of hello secondary regions, hello traffic manager will automatically remove hello offline end-point in that region from hello routing table.</span></span> <span data-ttu-id="f7968-173">zostanie zawieszony Hello replikacji kanału toohello dodatkowej bazy danych w tym regionie.</span><span class="sxs-lookup"><span data-stu-id="f7968-173">hello replication channel toohello secondary database in that region will be suspended.</span></span> <span data-ttu-id="f7968-174">Ponieważ regiony pozostałych hello dodatkowe ruchu danych w tym scenariuszu, wydajność aplikacji hello jest ograniczona w hello awarii.</span><span class="sxs-lookup"><span data-stu-id="f7968-174">Because hello remaining regions get additional user traffic in this scenario, hello application's performance will be impacted during hello outage.</span></span> <span data-ttu-id="f7968-175">Po awarii hello skuteczność została osłabiona hello dodatkowej bazy danych w regionie wpływ na powitania zostaną natychmiast zsynchronizowane z hello podstawowego.</span><span class="sxs-lookup"><span data-stu-id="f7968-175">Once hello outage is mitigated, hello secondary database in hello impacted region will be immediately synchronized with hello primary.</span></span> <span data-ttu-id="f7968-176">Podczas hello wydajność synchronizacji hello głównej może dotyczyć nieco w zależności od hello ilości danych wymaga toobe zsynchronizowane.</span><span class="sxs-lookup"><span data-stu-id="f7968-176">During hello synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="f7968-177">powitania po diagram ilustruje awaria w regionie B.</span><span class="sxs-lookup"><span data-stu-id="f7968-177">hello following diagram illustrates an outage in region B.</span></span>

![Awaria w regionie pomocniczym.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="f7968-180">klucz Hello **korzyści** projektu tego wzorca jest skalowanie obciążenia aplikacji hello między wiele replik pomocniczych tooachieve hello optymalne wydajności.</span><span class="sxs-lookup"><span data-stu-id="f7968-180">hello key **advantage** of this design pattern is that you can scale hello application workload across multiple secondaries tooachieve hello optimal end-user performance.</span></span> <span data-ttu-id="f7968-181">Witaj **wady i zalety** tej opcji są:</span><span class="sxs-lookup"><span data-stu-id="f7968-181">hello **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="f7968-182">Odczyt i zapis połączeń między wystąpieniami aplikacji hello i bazy danych ma różnych opóźnienia i kosztów</span><span class="sxs-lookup"><span data-stu-id="f7968-182">Read-write connections between hello application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="f7968-183">Wydajność aplikacji jest ograniczona w hello awarii</span><span class="sxs-lookup"><span data-stu-id="f7968-183">Application performance is impacted during hello outage</span></span>

> [!NOTE]
> <span data-ttu-id="f7968-184">Podejście podobne może służyć toooffload specjalizowany obciążeń, takich jak raportowanie zadania, narzędzia do analizy biznesowej lub tworzenie kopii zapasowych.</span><span class="sxs-lookup"><span data-stu-id="f7968-184">A similar approach can be used toooffload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="f7968-185">Zazwyczaj te obciążenia użycie zasobów znaczących bazy danych w związku z tym zaleca się, że wskazanie jednego z hello pomocniczej bazy danych dla nich z hello wydajności poziomu toohello dopasowane przewidywane obciążenia.</span><span class="sxs-lookup"><span data-stu-id="f7968-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of hello secondary databases for them with hello performance level matched toohello anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="f7968-186">Wzorzec projektowy 3: Wdrażanie aktywny / pasywny konserwacji danych</span><span class="sxs-lookup"><span data-stu-id="f7968-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="f7968-187">Ta opcja jest najbardziej odpowiednie dla aplikacji z hello następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="f7968-187">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="f7968-188">Utraty danych jest biznesowych wysokiego ryzyka.</span><span class="sxs-lookup"><span data-stu-id="f7968-188">Any data loss is high business risk.</span></span> <span data-ttu-id="f7968-189">Hello trybu failover z bazy danych można tylko w ostateczności przypadku poważnej awarii hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-189">hello database failover can only be used as a last resort if hello outage is catastrophic.</span></span>
* <span data-ttu-id="f7968-190">Aplikacja Hello obsługuje tylko do odczytu i zapisu i odczytu tryby operacji i może działać w trybie"tylko do odczytu" przez pewien czas.</span><span class="sxs-lookup"><span data-stu-id="f7968-190">hello application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="f7968-191">W tym wzorcu aplikacji hello Przełącza tryb tylko do tooread po rozpoczęciu połączenia odczytu i zapisu hello występują błędy przekroczenia limitu czasu.</span><span class="sxs-lookup"><span data-stu-id="f7968-191">In this pattern, hello application switches tooread-only mode when hello read-write connections start getting time-out errors.</span></span> <span data-ttu-id="f7968-192">Witaj aplikacji sieci Web jest wdrożone tooboth regionów i Dodaj punktu końcowego połączenia toohello odbiornika odczytu i zapisu oraz innego połączenia toohello odbiornika tylko do odczytu z punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="f7968-192">hello Web Application is deployed tooboth regions and include a connection toohello read-write listener endpoint and different connection toohello read-only listener endpoint.</span></span> <span data-ttu-id="f7968-193">Menedżer ruchu Hello powinny zostać skonfigurowane toouse [routingu trybu failover](../traffic-manager/traffic-manager-configure-failover-routing-method.md) z [punkt końcowy monitorowania](../traffic-manager/traffic-manager-monitoring.md) włączone dla punktu końcowego aplikacji hello w każdym regionie.</span><span class="sxs-lookup"><span data-stu-id="f7968-193">hello Traffic manager should be set up toouse [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for hello application endpoint in each region.</span></span>

<span data-ttu-id="f7968-194">powitania po diagram przedstawia tej konfiguracji przed awarią.</span><span class="sxs-lookup"><span data-stu-id="f7968-194">hello following diagram illustrates this configuration before an outage.</span></span>

![Aktywny / pasywny wdrożenia przed trybu failover.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="f7968-197">Menedżer ruchu hello wykrycie tooregion awarii łączności A automatycznie zmienia wystąpienia aplikacji toohello ruchu użytkowników w regionie B. Z tego wzorca ważne jest, aby ustawić okres prolongaty hello z utraty tooa wystarczająco wysoka wartość danych, np. 24 godziny.</span><span class="sxs-lookup"><span data-stu-id="f7968-197">When hello traffic manager detects a connectivity failure tooregion A, it automatically switches user traffic toohello application instance in region B. With this pattern, it is important that you set hello grace period with data loss tooa sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="f7968-198">Zapewni on zapobiec utracie danych w przypadku awarii hello jest skorygowane w tym czasie.</span><span class="sxs-lookup"><span data-stu-id="f7968-198">It will ensure that data loss is prevented if hello outage is mitigated within that time.</span></span> <span data-ttu-id="f7968-199">Po aktywowaniu aplikacji sieci Web w regionie hello B hello operacje odczytu i zapisu hello rozpocznie się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="f7968-199">When hello Web application in hello region B is activated hello read-write operations will start failing.</span></span> <span data-ttu-id="f7968-200">W tym momencie należy go przełącznika toohello trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="f7968-200">At that point, it should switch toohello read-only mode.</span></span> <span data-ttu-id="f7968-201">W tym hello tryb żądania będą automatycznie routingiem toohello dodatkowej bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-201">In this mode hello requests will be automatically routed toohello secondary database.</span></span> <span data-ttu-id="f7968-202">W przypadku hello hello poważnej awarii awarii nie zostaną skorygowane w okresie prolongaty hello i grupy pracy awaryjnej hello wyzwoli hello trybu failover.</span><span class="sxs-lookup"><span data-stu-id="f7968-202">In hello case of a catastrophic failure hello outage will not be mitigated within hello grace period and hello failover group will trigger hello failover.</span></span> <span data-ttu-id="f7968-203">Po tym hello odbiornika odczytu i zapisu będą dostępne i tooit wywołania hello zatrzyma się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="f7968-203">After that hello read-write listener will become available and hello calls tooit will stop failing.</span></span> <span data-ttu-id="f7968-204">Jest to zilustrowane powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="f7968-204">This is illustrated by hello following diagram.</span></span>

![Awaria: Aplikacja w trybie tylko do odczytu.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="f7968-207">Jeśli hello awaria w regionie podstawowym hello jest skorygowane w okresie prolongaty hello, Menedżera ruchu wykrywa hello przywrócenia łączności w regionie podstawowym hello i zmienia wystąpienia aplikacji użytkownika ruchu toohello Wstecz w regionie A. To wystąpienie aplikacji zostanie wznowione, a także działa w trybie odczytu i zapisu przy użyciu hello podstawowej bazy danych w regionie A.</span><span class="sxs-lookup"><span data-stu-id="f7968-207">If hello outage in hello primary region is mitigated within hello grace period, traffic manager detects hello restoration of connectivity in hello primary region and switches user traffic back toohello application instance in region A. That application instance resumes and operates in read-write mode using hello primary database in region A.</span></span>

<span data-ttu-id="f7968-208">W przypadku wystąpienia awarii w regionie hello B hello Menedżera ruchu wykrywa niepowodzenie hello punkt końcowy aplikacji hello w regionie B i hello trybu failover grupy przełączników hello odbiornika tylko do odczytu tooregion A. Ta awaria nie ma wpływu na środowisko pracy użytkownika końcowego hello, ale mają być widoczne hello podstawowej bazy danych podczas awarii hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-208">In case of an outage in hello region B, hello traffic manager detects hello failure of hello application end-point in region B and hello failover group switches hello read-only listener tooregion A. This outage does not impact hello end-user experience but hello primary database will be exposed during hello outage.</span></span> <span data-ttu-id="f7968-209">Jest to zilustrowane powitania po diagramu.</span><span class="sxs-lookup"><span data-stu-id="f7968-209">This is illustrated by hello following diagram.</span></span>

![Awaria: Dodatkowej bazy danych.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="f7968-212">Po awarii hello skuteczność została osłabiona hello dodatkowej bazy danych jest natychmiast synchronizowane z hello podstawowego i odbiornika hello tylko do odczytu jest wyłączone toohello wstecz dodatkowej bazy danych w regionie B. Podczas synchronizacji wydajności hello głównej może dotyczyć nieco w zależności od hello ilości danych wymaga toobe zsynchronizowane.</span><span class="sxs-lookup"><span data-stu-id="f7968-212">Once hello outage is mitigated, hello secondary database is immediately synchronized with hello primary and hello read-only listener is switched back toohello secondary database in region B. During synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span>

<span data-ttu-id="f7968-213">Ten wzorzec projektowy ma kilka **zalety**:</span><span class="sxs-lookup"><span data-stu-id="f7968-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="f7968-214">Pozwala ona na uniknięcie utraty danych podczas hello tymczasowych przestojów.</span><span class="sxs-lookup"><span data-stu-id="f7968-214">It avoids data loss during hello temporary outages.</span></span>
* <span data-ttu-id="f7968-215">Czas przestoju tylko zależy szybkość Menedżera ruchu wykrywa hello awarii łączności, które można skonfigurować.</span><span class="sxs-lookup"><span data-stu-id="f7968-215">Downtime depends only on how quickly traffic manager detects hello connectivity failure, which is configurable.</span></span>

<span data-ttu-id="f7968-216">Witaj **zależnościami** jest:</span><span class="sxs-lookup"><span data-stu-id="f7968-216">hello **tradeoff** is:</span></span>

* <span data-ttu-id="f7968-217">Aplikacja musi być możliwe toooperate w trybie tylko do odczytu.</span><span class="sxs-lookup"><span data-stu-id="f7968-217">Application must be able toooperate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="f7968-218">W przypadku awarii usługi trwałe w regionie hello należy ręcznie uaktywnić trybu failover bazy danych i zaakceptować hello utraty danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-218">In case of a permanent service outage in hello region, you manually activate database failover and accept hello data loss.</span></span> <span data-ttu-id="f7968-219">Aplikacja Hello będzie działać w regionie pomocniczym hello z toohello dostępu odczytu i zapisu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="f7968-219">hello application will be functional in hello secondary region with read-write access toohello database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="f7968-220">Planowanie ciągłości biznesowej: Wybierz projekt aplikacji do chmury odzyskiwania po awarii</span><span class="sxs-lookup"><span data-stu-id="f7968-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="f7968-221">Strategię odzyskiwania po awarii określonej chmury można łączyć lub rozszerzyć te wzorce projektowe toobest hello spełnianie wymagań aplikacji.</span><span class="sxs-lookup"><span data-stu-id="f7968-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns toobest meet hello needs of your application.</span></span>  <span data-ttu-id="f7968-222">Jak wspomniano wcześniej, strategii hello, która zostanie wybrana jest oparta na powitania SLA mają toooffer tooyour klientów i topologii wdrożenia aplikacji hello.</span><span class="sxs-lookup"><span data-stu-id="f7968-222">As mentioned earlier, hello strategy you choose is based on hello SLA you want toooffer tooyour customers and hello application deployment topology.</span></span> <span data-ttu-id="f7968-223">toohelp przewodnik decyzji, hello w poniższej tabeli porównano opcje hello na podstawie hello szacowany danych utracie lub odzyskiwania cel punktu (RPO) i odzyskiwania szacowany czas (Wstaw).</span><span class="sxs-lookup"><span data-stu-id="f7968-223">toohelp guide your decision, hello following table compares hello choices based on hello estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="f7968-224">wzorzec</span><span class="sxs-lookup"><span data-stu-id="f7968-224">Pattern</span></span> | <span data-ttu-id="f7968-225">CEL PUNKTU ODZYSKIWANIA</span><span class="sxs-lookup"><span data-stu-id="f7968-225">RPO</span></span> | <span data-ttu-id="f7968-226">WSTAW</span><span class="sxs-lookup"><span data-stu-id="f7968-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="f7968-227">Aktywny / pasywny wdrożenia dla odzyskiwania po awarii z dostępem do tej samej lokalizacji bazy danych</span><span class="sxs-lookup"><span data-stu-id="f7968-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="f7968-228">Dostęp do odczytu zapisu < 5 s</span><span class="sxs-lookup"><span data-stu-id="f7968-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="f7968-229">Czas wykrywania awarii + czas wygaśnięcia DNS</span><span class="sxs-lookup"><span data-stu-id="f7968-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="f7968-230">Aktywny aktywny wdrożenia aplikacji Równoważenie obciążenia sieciowego</span><span class="sxs-lookup"><span data-stu-id="f7968-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="f7968-231">Dostęp do odczytu zapisu < 5 s</span><span class="sxs-lookup"><span data-stu-id="f7968-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="f7968-232">Czas wykrywania awarii + czas wygaśnięcia DNS</span><span class="sxs-lookup"><span data-stu-id="f7968-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="f7968-233">Aktywny / pasywny wdrożenia do przechowywania danych</span><span class="sxs-lookup"><span data-stu-id="f7968-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="f7968-234">Dostęp tylko do odczytu < 5 s</span><span class="sxs-lookup"><span data-stu-id="f7968-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="f7968-235">Dostęp tylko do odczytu = 0</span><span class="sxs-lookup"><span data-stu-id="f7968-235">Read-only access = 0</span></span> |
||<span data-ttu-id="f7968-236">Dostęp do odczytu zapisu = zero</span><span class="sxs-lookup"><span data-stu-id="f7968-236">Read-write access = zero</span></span> | <span data-ttu-id="f7968-237">Dostęp do odczytu zapisu = czas wykrycia błędu + okres prolongaty przy utracie danych</span><span class="sxs-lookup"><span data-stu-id="f7968-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="f7968-238">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="f7968-238">Next steps</span></span>
* <span data-ttu-id="f7968-239">toolearn o bazy danych SQL Azure automatycznego tworzenia kopii zapasowych, zobacz [bazy danych SQL automatycznego tworzenia kopii zapasowych](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="f7968-239">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="f7968-240">Omówienie ciągłości działalności biznesowej i scenariuszy, zobacz [omówienie ciągłości działalności biznesowej](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="f7968-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="f7968-241">toolearn o za pomocą kopie zapasowe automatycznego odzyskiwania, zobacz [przywrócić bazę danych z kopii zapasowych hello inicjowane przez usługę](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="f7968-241">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="f7968-242">toolearn o szybsze opcje odzyskiwania, zobacz [aktywna replikacja geograficzna](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="f7968-242">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="f7968-243">toolearn o za pomocą automatycznych kopii zapasowej do archiwizacji, zobacz [kopiowanie bazy danych](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="f7968-243">toolearn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="f7968-244">Informacje aktywna replikacja geograficzna z pule elastyczne, zobacz [strategii odzyskiwania danych w puli elastycznej](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="f7968-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
