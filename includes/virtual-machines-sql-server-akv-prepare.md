## <a name="prepare-for-akv-integration"></a><span data-ttu-id="336f4-101">Przygotowanie do Integracja</span><span class="sxs-lookup"><span data-stu-id="336f4-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="336f4-102">toouse tooconfigure integracji magazynu kluczy Azure maszyny Wirtualnej programu SQL Server, istnieje kilka wymagań wstępnych:</span><span class="sxs-lookup"><span data-stu-id="336f4-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="336f4-103">Instalowanie programu Azure Powershell</span><span class="sxs-lookup"><span data-stu-id="336f4-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="336f4-104">Tworzenie usługi Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="336f4-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="336f4-105">Tworzenie magazynu kluczy</span><span class="sxs-lookup"><span data-stu-id="336f4-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="336f4-106">Witaj poniższych sekcjach opisano te warunki wstępne i hello informacje potrzebne toocollect toolater Uruchom hello — poleceń cmdlet programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="336f4-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="336f4-107">Instalowanie programu Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="336f4-107">Install Azure PowerShell</span></span>
<span data-ttu-id="336f4-108">Upewnij się, że zainstalowano najnowszy zestaw Azure PowerShell SDK hello.</span><span class="sxs-lookup"><span data-stu-id="336f4-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="336f4-109">Aby uzyskać więcej informacji, zobacz [jak tooinstall i konfigurowanie programu Azure PowerShell](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="336f4-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="336f4-110">Tworzenie usługi Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="336f4-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="336f4-111">Najpierw należy toohave [usługi Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) w ramach subskrypcji.</span><span class="sxs-lookup"><span data-stu-id="336f4-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="336f4-112">Między wiele korzyści umożliwia magazynu kluczy tooyour uprawnienia toogrant dla niektórych użytkowników i aplikacji.</span><span class="sxs-lookup"><span data-stu-id="336f4-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="336f4-113">Następnie należy zarejestrować aplikację przy użyciu usługi AAD.</span><span class="sxs-lookup"><span data-stu-id="336f4-113">Next, register an application with AAD.</span></span> <span data-ttu-id="336f4-114">Zapewni to konto nazwy głównej usługi, które ma dostęp tooyour magazynu kluczy, które będą potrzebne maszyny Wirtualnej.</span><span class="sxs-lookup"><span data-stu-id="336f4-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="336f4-115">W artykule usługi Azure Key Vault hello, te kroki można znaleźć w hello [zarejestrować aplikację w usłudze Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) sekcji, lub można czynności hello z zrzuty ekranu w hello **uzyskać tożsamości dla aplikacji hello sekcja** z [ten wpis w blogu](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="336f4-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="336f4-116">Przed wykonaniem tych kroków, należy zauważyć, że możesz hello toocollect następujących informacji podczas tej rejestracji, który będzie później potrzebny po włączeniu integracji magazynu kluczy Azure na maszynie Wirtualnej SQL.</span><span class="sxs-lookup"><span data-stu-id="336f4-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="336f4-117">Po dodaniu aplikacji hello Znajdź hello **identyfikator klienta** na powitania **Konfiguruj** kartę.   ![Identyfikator klienta usługi Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="336f4-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="336f4-118">Identyfikator klienta Hello jest przypisany nowsze toohello **$spName** parametr (nazwę główną usługi) w tooenable skrypt programu PowerShell hello integracji magazynu kluczy Azure.</span><span class="sxs-lookup"><span data-stu-id="336f4-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="336f4-119">Ponadto podczas tych czynności podczas tworzenia klucza, skopiować hello klucza tajnego klucza pokazane na powitania po zrzut ekranu.</span><span class="sxs-lookup"><span data-stu-id="336f4-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="336f4-120">Ten klucza klucz tajny jest przypisany nowsze toohello **$spSecret** parametr (klucz tajny nazwy głównej usługi) w hello skrypt programu PowerShell.</span><span class="sxs-lookup"><span data-stu-id="336f4-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="336f4-121">![Klucz tajny usługi Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="336f4-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="336f4-122">Musisz zezwolić tej nowej powitania toohave Identyfikatora klienta, na następujących uprawnień dostępu: **szyfrowania**, **odszyfrować**, **wrapKey**, **unwrapKey**, **znak**, i **Sprawdź**.</span><span class="sxs-lookup"><span data-stu-id="336f4-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="336f4-123">Jest to zrobić za pomocą hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) polecenia cmdlet.</span><span class="sxs-lookup"><span data-stu-id="336f4-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="336f4-124">Aby uzyskać więcej informacji, zobacz [autoryzacji hello aplikacji toouse hello klucza lub klucza tajnego](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="336f4-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="336f4-125">Tworzenie magazynu kluczy</span><span class="sxs-lookup"><span data-stu-id="336f4-125">Create a key vault</span></span>
<span data-ttu-id="336f4-126">W kolejności toouse usługi Azure Key Vault toostore hello kluczy, który będzie używany do szyfrowania maszyny Wirtualnej należy magazynu kluczy tooa dostępu.</span><span class="sxs-lookup"><span data-stu-id="336f4-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="336f4-127">Jeśli magazynu kluczy nie zostały już skonfigurowane, utwórz ją wykonać kroki hello w hello [wprowadzenie do korzystania z usługi Azure Key Vault](../articles/key-vault/key-vault-get-started.md) tematu.</span><span class="sxs-lookup"><span data-stu-id="336f4-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="336f4-128">Przed wykonaniem tych kroków, należy pamiętać, że jest niektóre informacje potrzebne toocollect podczas tego zestawu zapasową, która będzie później potrzebny po włączeniu integracji magazynu kluczy Azure na maszynie Wirtualnej SQL.</span><span class="sxs-lookup"><span data-stu-id="336f4-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="336f4-129">Po wyświetleniu okna toohello Utwórz krok magazynu kluczy, zwrócił hello Uwaga **vaultUri** właściwość, która jest hello adres URL magazynu kluczy.</span><span class="sxs-lookup"><span data-stu-id="336f4-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="336f4-130">W przykładzie hello podane w tym kroku przedstawiony poniżej nazwa magazynu kluczy hello jest ContosoKeyVault, w związku z tym adresem URL magazynu kluczy hello byłoby https://contosokeyvault.vault.azure.net/.</span><span class="sxs-lookup"><span data-stu-id="336f4-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="336f4-131">adres URL magazynu kluczy Hello jest przypisany nowsze toohello **$akvURL** parametru w tooenable skrypt programu PowerShell hello integracji magazynu kluczy Azure.</span><span class="sxs-lookup"><span data-stu-id="336f4-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

